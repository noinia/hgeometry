<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998
-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html"><span class="hs-identifier">GHC.Core.Map.Type</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-11"></span><span>     </span><span class="annot"><span class="hs-comment">-- * Re-export generic interface</span></span><span>
</span><span id="line-12"></span><span>   </span><span class="annot"><a href="GHC.Data.TrieMap.html#TrieMap"><span class="hs-identifier">TrieMap</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#XT"><span class="hs-identifier">XT</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span>     </span><span class="annot"><span class="hs-comment">-- * Maps over 'Type's</span></span><span>
</span><span id="line-15"></span><span>   </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier">TypeMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#emptyTypeMap"><span class="hs-identifier">emptyTypeMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#extendTypeMap"><span class="hs-identifier">extendTypeMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#lookupTypeMap"><span class="hs-identifier">lookupTypeMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#foldTypeMap"><span class="hs-identifier">foldTypeMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>   </span><span class="annot"><a href="GHC.Core.Map.Type.html#LooseTypeMap"><span class="hs-identifier">LooseTypeMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>   </span><span class="annot"><span class="hs-comment">-- ** With explicit scoping</span></span><span>
</span><span id="line-18"></span><span>   </span><span class="annot"><a href="GHC.Core.Map.Type.html#CmEnv"><span class="hs-identifier">CmEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#lookupCME"><span class="hs-identifier">lookupCME</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#extendTypeMapWithScope"><span class="hs-identifier">extendTypeMapWithScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#lookupTypeMapWithScope"><span class="hs-identifier">lookupTypeMapWithScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>   </span><span class="annot"><a href="GHC.Core.Map.Type.html#mkDeBruijnContext"><span class="hs-identifier">mkDeBruijnContext</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#extendCME"><span class="hs-identifier">extendCME</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#extendCMEs"><span class="hs-identifier">extendCMEs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#emptyCME"><span class="hs-identifier">emptyCME</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Utilities for use by friends only</span></span><span>
</span><span id="line-22"></span><span>   </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapG"><span class="hs-identifier">TypeMapG</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapG"><span class="hs-identifier">CoercionMapG</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>   </span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier">DeBruijn</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#deBruijnize"><span class="hs-identifier">deBruijnize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#eqDeBruijnType"><span class="hs-identifier">eqDeBruijnType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#eqDeBruijnVar"><span class="hs-identifier">eqDeBruijnVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>   </span><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier">BndrMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#xtBndr"><span class="hs-identifier">xtBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#lkBndr"><span class="hs-identifier">lkBndr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>   </span><span class="annot"><a href="GHC.Core.Map.Type.html#VarMap"><span class="hs-identifier">VarMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#xtVar"><span class="hs-identifier">xtVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#lkVar"><span class="hs-identifier">lkVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#lkDFreeVar"><span class="hs-identifier">lkDFreeVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#xtDFreeVar"><span class="hs-identifier">xtDFreeVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>   </span><span class="annot"><a href="GHC.Core.Map.Type.html#xtDNamed"><span class="hs-identifier">xtDNamed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#lkDNamed"><span class="hs-identifier">lkDNamed</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- This module is separate from GHC.Core.Map.Expr to avoid a module loop</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- between GHC.Core.Unify (which depends on this module) and GHC.Core</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html"><span class="hs-identifier">GHC.Core.Coercion</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html"><span class="hs-identifier">GHC.Core.TyCo.Rep</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#isForgetfulSynTyCon"><span class="hs-identifier">isForgetfulSynTyCon</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html"><span class="hs-identifier">GHC.Core.TyCo.Compare</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqForAllVis"><span class="hs-identifier">eqForAllVis</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html"><span class="hs-identifier">GHC.Data.TrieMap</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html"><span class="hs-identifier">GHC.Types.Name.Env</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.html"><span class="hs-identifier">GHC.Types.Var</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html"><span class="hs-identifier">GHC.Types.Var.Env</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.FM.html"><span class="hs-identifier">GHC.Types.Unique.FM</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span>    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.html"><span class="hs-identifier">Data.IntMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IntMap</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(&gt;=&gt;)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- NB: Be careful about RULES and type families (#5821).  So we should make sure</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- to specify @Key TypeMapX@ (and not @DeBruijn Type@, the reduced form)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#lkG"><span class="hs-pragma hs-type">lkG</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621682580890"><span class="annot"><a href="GHC.Data.TrieMap.html#Key"><span class="hs-pragma hs-type">Key</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapX"><span class="hs-pragma hs-type">TypeMapX</span></a></span><span>     </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapG"><span class="hs-pragma hs-type">TypeMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580890"><span class="hs-pragma hs-type">a</span></a></span><span>     </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682580890"><span class="hs-pragma hs-type">a</span></a></span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-64"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#lkG"><span class="hs-pragma hs-type">lkG</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621682580891"><span class="annot"><a href="GHC.Data.TrieMap.html#Key"><span class="hs-pragma hs-type">Key</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-pragma hs-type">CoercionMapX</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapG"><span class="hs-pragma hs-type">CoercionMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580891"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682580891"><span class="hs-pragma hs-type">a</span></a></span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#xtG"><span class="hs-pragma hs-type">xtG</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621682580893"><span class="annot"><a href="GHC.Data.TrieMap.html#Key"><span class="hs-pragma hs-type">Key</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapX"><span class="hs-pragma hs-type">TypeMapX</span></a></span><span>     </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#XT"><span class="hs-pragma hs-type">XT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580893"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapG"><span class="hs-pragma hs-type">TypeMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580893"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapG"><span class="hs-pragma hs-type">TypeMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580893"><span class="hs-pragma hs-type">a</span></a></span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-67"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#xtG"><span class="hs-pragma hs-type">xtG</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621682580894"><span class="annot"><a href="GHC.Data.TrieMap.html#Key"><span class="hs-pragma hs-type">Key</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-pragma hs-type">CoercionMapX</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#XT"><span class="hs-pragma hs-type">XT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580894"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapG"><span class="hs-pragma hs-type">CoercionMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580894"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapG"><span class="hs-pragma hs-type">CoercionMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580894"><span class="hs-pragma hs-type">a</span></a></span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#mapG"><span class="hs-pragma hs-type">mapG</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621682580896"><span id="local-6989586621682580897"><span class="hs-pragma">(</span><span class="annot"><a href="#local-6989586621682580896"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580897"><span class="hs-pragma hs-type">b</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapG"><span class="hs-pragma hs-type">TypeMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580896"><span class="hs-pragma hs-type">a</span></a></span><span>     </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapG"><span class="hs-pragma hs-type">TypeMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580897"><span class="hs-pragma hs-type">b</span></a></span></span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-70"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#mapG"><span class="hs-pragma hs-type">mapG</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621682580898"><span id="local-6989586621682580899"><span class="hs-pragma">(</span><span class="annot"><a href="#local-6989586621682580898"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580899"><span class="hs-pragma hs-type">b</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapG"><span class="hs-pragma hs-type">CoercionMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580898"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapG"><span class="hs-pragma hs-type">CoercionMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580899"><span class="hs-pragma hs-type">b</span></a></span></span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#fdG"><span class="hs-pragma hs-type">fdG</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621682580901"><span id="local-6989586621682580902"><span class="hs-pragma">(</span><span class="annot"><a href="#local-6989586621682580901"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580902"><span class="hs-pragma hs-type">b</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580902"><span class="hs-pragma hs-type">b</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapG"><span class="hs-pragma hs-type">TypeMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580901"><span class="hs-pragma hs-type">a</span></a></span><span>     </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580902"><span class="hs-pragma hs-type">b</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580902"><span class="hs-pragma hs-type">b</span></a></span></span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-73"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#fdG"><span class="hs-pragma hs-type">fdG</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621682580903"><span id="local-6989586621682580904"><span class="hs-pragma">(</span><span class="annot"><a href="#local-6989586621682580903"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580904"><span class="hs-pragma hs-type">b</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580904"><span class="hs-pragma hs-type">b</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapG"><span class="hs-pragma hs-type">CoercionMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580903"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580904"><span class="hs-pragma hs-type">b</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580904"><span class="hs-pragma hs-type">b</span></a></span></span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                   Coercions
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">-- We should really never care about the contents of a coercion. Instead,</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- just look up the coercion's type.</span><span>
</span><span id="line-85"></span><span class="hs-keyword">newtype</span><span> </span><span id="CoercionMap"><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMap"><span class="hs-identifier hs-var">CoercionMap</span></a></span></span><span> </span><span id="local-6989586621682580554"><span class="annot"><a href="#local-6989586621682580554"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CoercionMap"><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMap"><span class="hs-identifier hs-var">CoercionMap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapG"><span class="hs-identifier hs-type">CoercionMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580554"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- TODO(22292): derive</span><span>
</span><span id="line-88"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682580908"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMap"><span class="hs-identifier hs-type">CoercionMap</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-89"></span><span>    </span><span id="local-6989586621682580916"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; CoercionMap a -&gt; CoercionMap b
</span><span class="hs-identifier hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621682580917"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682580917"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMap"><span class="hs-identifier hs-type">CoercionMap</span></a></span><span> </span><span id="local-6989586621682580918"><span class="annot"><span class="annottext">CoercionMapG a
</span><a href="#local-6989586621682580918"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoercionMapG b -&gt; CoercionMap b
forall a. CoercionMapG a -&gt; CoercionMap a
</span><a href="GHC.Core.Map.Type.html#CoercionMap"><span class="hs-identifier hs-var">CoercionMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; CoercionMapG a -&gt; CoercionMapG b
forall a b.
(a -&gt; b) -&gt; GenMap CoercionMapX a -&gt; GenMap CoercionMapX b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682580917"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionMapG a
</span><a href="#local-6989586621682580918"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">fmap</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMap"><span class="hs-identifier hs-type">CoercionMap</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-93"></span><span>   </span><span class="hs-keyword">type</span><span> </span><span id="Key"><span class="annot"><a href="GHC.Data.TrieMap.html#Key"><span class="hs-identifier hs-var">Key</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMap"><span class="hs-identifier hs-type">CoercionMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-94"></span><span>   </span><span id="local-6989586621682580935"><span class="annot"><span class="annottext">emptyTM :: forall a. CoercionMap a
</span><a href="#local-6989586621682580935"><span class="hs-identifier hs-var hs-var hs-var">emptyTM</span></a></span></span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoercionMapG a -&gt; CoercionMap a
forall a. CoercionMapG a -&gt; CoercionMap a
</span><a href="GHC.Core.Map.Type.html#CoercionMap"><span class="hs-identifier hs-var">CoercionMap</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionMapG a
forall a. GenMap CoercionMapX a
forall (m :: * -&gt; *) a. TrieMap m =&gt; m a
</span><a href="GHC.Data.TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a></span><span>
</span><span id="line-95"></span><span>   </span><span id="local-6989586621682580941"><span class="annot"><span class="annottext">lookupTM :: forall b. Key CoercionMap -&gt; CoercionMap b -&gt; Maybe b
</span><a href="#local-6989586621682580941"><span class="hs-identifier hs-var hs-var hs-var">lookupTM</span></a></span></span><span> </span><span id="local-6989586621682580943"><span class="annot"><span class="annottext">Key CoercionMap
</span><a href="#local-6989586621682580943"><span class="hs-identifier hs-var">k</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMap"><span class="hs-identifier hs-type">CoercionMap</span></a></span><span> </span><span id="local-6989586621682580944"><span class="annot"><span class="annottext">CoercionMapG b
</span><a href="#local-6989586621682580944"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key (GenMap CoercionMapX) -&gt; CoercionMapG b -&gt; Maybe b
forall b.
Key (GenMap CoercionMapX) -&gt; GenMap CoercionMapX b -&gt; Maybe b
forall (m :: * -&gt; *) b. TrieMap m =&gt; Key m -&gt; m b -&gt; Maybe b
</span><a href="GHC.Data.TrieMap.html#lookupTM"><span class="hs-identifier hs-var">lookupTM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; DeBruijn Coercion
forall a. a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#deBruijnize"><span class="hs-identifier hs-var">deBruijnize</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
Key CoercionMap
</span><a href="#local-6989586621682580943"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoercionMapG b
</span><a href="#local-6989586621682580944"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-96"></span><span>   </span><span id="local-6989586621682580949"><span class="annot"><span class="annottext">alterTM :: forall b. Key CoercionMap -&gt; XT b -&gt; CoercionMap b -&gt; CoercionMap b
</span><a href="#local-6989586621682580949"><span class="hs-identifier hs-var hs-var hs-var">alterTM</span></a></span></span><span> </span><span id="local-6989586621682580951"><span class="annot"><span class="annottext">Key CoercionMap
</span><a href="#local-6989586621682580951"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621682580952"><span class="annot"><span class="annottext">XT b
</span><a href="#local-6989586621682580952"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMap"><span class="hs-identifier hs-type">CoercionMap</span></a></span><span> </span><span id="local-6989586621682580953"><span class="annot"><span class="annottext">CoercionMapG b
</span><a href="#local-6989586621682580953"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoercionMapG b -&gt; CoercionMap b
forall a. CoercionMapG a -&gt; CoercionMap a
</span><a href="GHC.Core.Map.Type.html#CoercionMap"><span class="hs-identifier hs-var">CoercionMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key (GenMap CoercionMapX)
-&gt; XT b -&gt; CoercionMapG b -&gt; CoercionMapG b
forall b.
Key (GenMap CoercionMapX)
-&gt; XT b -&gt; GenMap CoercionMapX b -&gt; GenMap CoercionMapX b
forall (m :: * -&gt; *) b. TrieMap m =&gt; Key m -&gt; XT b -&gt; m b -&gt; m b
</span><a href="GHC.Data.TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; DeBruijn Coercion
forall a. a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#deBruijnize"><span class="hs-identifier hs-var">deBruijnize</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
Key CoercionMap
</span><a href="#local-6989586621682580951"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XT b
</span><a href="#local-6989586621682580952"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionMapG b
</span><a href="#local-6989586621682580953"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>   </span><span id="local-6989586621682580958"><span class="annot"><span class="annottext">foldTM :: forall a b. (a -&gt; b -&gt; b) -&gt; CoercionMap a -&gt; b -&gt; b
</span><a href="#local-6989586621682580958"><span class="hs-identifier hs-var hs-var hs-var">foldTM</span></a></span></span><span> </span><span id="local-6989586621682580960"><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682580960"><span class="hs-identifier hs-var">k</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMap"><span class="hs-identifier hs-type">CoercionMap</span></a></span><span> </span><span id="local-6989586621682580961"><span class="annot"><span class="annottext">CoercionMapG a
</span><a href="#local-6989586621682580961"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; CoercionMapG a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; GenMap CoercionMapX a -&gt; b -&gt; b
forall (m :: * -&gt; *) a b.
TrieMap m =&gt;
(a -&gt; b -&gt; b) -&gt; m a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682580960"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionMapG a
</span><a href="#local-6989586621682580961"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-98"></span><span>   </span><span id="local-6989586621682580966"><span class="annot"><span class="annottext">filterTM :: forall a. (a -&gt; Bool) -&gt; CoercionMap a -&gt; CoercionMap a
</span><a href="#local-6989586621682580966"><span class="hs-identifier hs-var hs-var hs-var">filterTM</span></a></span></span><span> </span><span id="local-6989586621682580968"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682580968"><span class="hs-identifier hs-var">f</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMap"><span class="hs-identifier hs-type">CoercionMap</span></a></span><span> </span><span id="local-6989586621682580969"><span class="annot"><span class="annottext">CoercionMapG a
</span><a href="#local-6989586621682580969"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoercionMapG a -&gt; CoercionMap a
forall a. CoercionMapG a -&gt; CoercionMap a
</span><a href="GHC.Core.Map.Type.html#CoercionMap"><span class="hs-identifier hs-var">CoercionMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; CoercionMapG a -&gt; CoercionMapG a
forall a.
(a -&gt; Bool) -&gt; GenMap CoercionMapX a -&gt; GenMap CoercionMapX a
forall (m :: * -&gt; *) a. TrieMap m =&gt; (a -&gt; Bool) -&gt; m a -&gt; m a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var">filterTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682580968"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionMapG a
</span><a href="#local-6989586621682580969"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">type</span><span> </span><span id="CoercionMapG"><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapG"><span class="hs-identifier hs-var">CoercionMapG</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#GenMap"><span class="hs-identifier hs-type">GenMap</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a></span><span>
</span><span id="line-101"></span><span class="hs-keyword">newtype</span><span> </span><span id="CoercionMapX"><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-var">CoercionMapX</span></a></span></span><span> </span><span id="local-6989586621682580578"><span class="annot"><a href="#local-6989586621682580578"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CoercionMapX"><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-var">CoercionMapX</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580578"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- TODO(22292): derive</span><span>
</span><span id="line-104"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682580973"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-105"></span><span>    </span><span id="local-6989586621682580977"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; CoercionMapX a -&gt; CoercionMapX b
</span><span class="hs-identifier hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621682580978"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682580978"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a></span><span> </span><span id="local-6989586621682580979"><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682580979"><span class="hs-identifier hs-var">core_tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeMapX b -&gt; CoercionMapX b
forall a. TypeMapX a -&gt; CoercionMapX a
</span><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-var">CoercionMapX</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; TypeMapX a -&gt; TypeMapX b
forall a b. (a -&gt; b) -&gt; TypeMapX a -&gt; TypeMapX b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682580978"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682580979"><span class="hs-identifier hs-var">core_tm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">fmap</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Key"><span class="annot"><a href="GHC.Data.TrieMap.html#Key"><span class="hs-identifier hs-var">Key</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621682580989"><span class="annot"><span class="annottext">emptyTM :: forall a. CoercionMapX a
</span><a href="GHC.Data.TrieMap.html#emptyTM"><span class="hs-identifier hs-var hs-var hs-var">emptyTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapX a -&gt; CoercionMapX a
forall a. TypeMapX a -&gt; CoercionMapX a
</span><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-var">CoercionMapX</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapX a
forall a. TypeMapX a
forall (m :: * -&gt; *) a. TrieMap m =&gt; m a
</span><a href="GHC.Data.TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span id="local-6989586621682580990"><span class="annot"><span class="annottext">lookupTM :: forall b. Key CoercionMapX -&gt; CoercionMapX b -&gt; Maybe b
</span><a href="GHC.Data.TrieMap.html#lookupTM"><span class="hs-identifier hs-var hs-var hs-var">lookupTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key CoercionMapX -&gt; CoercionMapX b -&gt; Maybe b
DeBruijn Coercion -&gt; CoercionMapX b -&gt; Maybe b
forall a. DeBruijn Coercion -&gt; CoercionMapX a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkC"><span class="hs-identifier hs-var">lkC</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621682580992"><span class="annot"><span class="annottext">alterTM :: forall b.
Key CoercionMapX -&gt; XT b -&gt; CoercionMapX b -&gt; CoercionMapX b
</span><a href="GHC.Data.TrieMap.html#alterTM"><span class="hs-identifier hs-var hs-var hs-var">alterTM</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key CoercionMapX
-&gt; (Maybe b -&gt; Maybe b) -&gt; CoercionMapX b -&gt; CoercionMapX b
DeBruijn Coercion
-&gt; (Maybe b -&gt; Maybe b) -&gt; CoercionMapX b -&gt; CoercionMapX b
forall a.
DeBruijn Coercion -&gt; XT a -&gt; CoercionMapX a -&gt; CoercionMapX a
</span><a href="GHC.Core.Map.Type.html#xtC"><span class="hs-identifier hs-var">xtC</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span id="local-6989586621682580995"><span class="annot"><span class="annottext">foldTM :: forall a b. (a -&gt; b -&gt; b) -&gt; CoercionMapX a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var hs-var hs-var">foldTM</span></a></span></span><span> </span><span id="local-6989586621682580996"><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682580996"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a></span><span> </span><span id="local-6989586621682580997"><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682580997"><span class="hs-identifier hs-var">core_tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; TypeMapX a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; TypeMapX a -&gt; b -&gt; b
forall (m :: * -&gt; *) a b.
TrieMap m =&gt;
(a -&gt; b -&gt; b) -&gt; m a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682580996"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682580997"><span class="hs-identifier hs-var">core_tm</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span id="local-6989586621682580999"><span class="annot"><span class="annottext">filterTM :: forall a. (a -&gt; Bool) -&gt; CoercionMapX a -&gt; CoercionMapX a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var hs-var hs-var">filterTM</span></a></span></span><span> </span><span id="local-6989586621682581000"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581000"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a></span><span> </span><span id="local-6989586621682581001"><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581001"><span class="hs-identifier hs-var">core_tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapX a -&gt; CoercionMapX a
forall a. TypeMapX a -&gt; CoercionMapX a
</span><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-var">CoercionMapX</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; TypeMapX a -&gt; TypeMapX a
forall a. (a -&gt; Bool) -&gt; TypeMapX a -&gt; TypeMapX a
forall (m :: * -&gt; *) a. TrieMap m =&gt; (a -&gt; Bool) -&gt; m a -&gt; m a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var">filterTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581000"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581001"><span class="hs-identifier hs-var">core_tm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682581004"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581010"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581010"><span class="hs-identifier hs-var">env1</span></a></span></span><span> </span><span id="local-6989586621682581011"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682581011"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621682581012"><span class="annot"><span class="annottext">== :: DeBruijn Coercion -&gt; DeBruijn Coercion -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581013"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581013"><span class="hs-identifier hs-var">env2</span></a></span></span><span> </span><span id="local-6989586621682581014"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682581014"><span class="hs-identifier hs-var">co2</span></a></span></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581010"><span class="hs-identifier hs-var">env1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Type
</span><a href="GHC.Core.Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682581011"><span class="hs-identifier hs-var">co1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span>
</span><span id="line-119"></span><span>      </span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581013"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Type
</span><a href="GHC.Core.Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682581014"><span class="hs-identifier hs-var">co2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span id="local-6989586621682580581"><span class="annot"><a href="GHC.Core.Map.Type.html#lkC"><span class="hs-identifier hs-type">lkC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580581"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682580581"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-122"></span><span id="lkC"><span class="annot"><span class="annottext">lkC :: forall a. DeBruijn Coercion -&gt; CoercionMapX a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkC"><span class="hs-identifier hs-var hs-var">lkC</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581016"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581016"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682581017"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682581017"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a></span><span> </span><span id="local-6989586621682581018"><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581018"><span class="hs-identifier hs-var">core_tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; TypeMapX a -&gt; Maybe a
forall a. DeBruijn Type -&gt; TypeMapX a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkT"><span class="hs-identifier hs-var">lkT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581016"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; DeBruijn Type) -&gt; Type -&gt; DeBruijn Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Type
</span><a href="GHC.Core.Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682581017"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>                                        </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581018"><span class="hs-identifier hs-var">core_tm</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span id="local-6989586621682580583"><span class="annot"><a href="GHC.Core.Map.Type.html#xtC"><span class="hs-identifier hs-type">xtC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580583"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580583"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580583"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-126"></span><span id="xtC"><span class="annot"><span class="annottext">xtC :: forall a.
DeBruijn Coercion -&gt; XT a -&gt; CoercionMapX a -&gt; CoercionMapX a
</span><a href="GHC.Core.Map.Type.html#xtC"><span class="hs-identifier hs-var hs-var">xtC</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581020"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581020"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682581021"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682581021"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682581022"><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581022"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-type">CoercionMapX</span></a></span><span> </span><span id="local-6989586621682581023"><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581023"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapX a -&gt; CoercionMapX a
forall a. TypeMapX a -&gt; CoercionMapX a
</span><a href="GHC.Core.Map.Type.html#CoercionMapX"><span class="hs-identifier hs-var">CoercionMapX</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DeBruijn Type -&gt; XT a -&gt; TypeMapX a -&gt; TypeMapX a
forall a. DeBruijn Type -&gt; XT a -&gt; TypeMapX a -&gt; TypeMapX a
</span><a href="GHC.Core.Map.Type.html#xtT"><span class="hs-identifier hs-var">xtT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581020"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; DeBruijn Type) -&gt; Type -&gt; DeBruijn Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Type
</span><a href="GHC.Core.Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682581021"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581022"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581023"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                   Types
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- | @TypeMapG a@ is a map from @DeBruijn Type@ to @a@.  The extended</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- key makes it suitable for recursive traversal, since it can track binders,</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- but it is strictly internal to this module.  If you are including a 'TypeMap'</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- inside another 'TrieMap', this is the type you want. Note that this</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- lookup does not do a kind-check. Thus, all keys in this map must have</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- the same kind. Also note that this map respects the distinction between</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- @Type@ and @Constraint@, despite the fact that they are equivalent type</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- synonyms in Core.</span><span>
</span><span id="line-145"></span><span class="hs-keyword">type</span><span> </span><span id="TypeMapG"><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapG"><span class="hs-identifier hs-var">TypeMapG</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#GenMap"><span class="hs-identifier hs-type">GenMap</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- | @TypeMapX a@ is the base map from @DeBruijn Type@ to @a@, but without the</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- 'GenMap' optimization. See Note [Computing equality on types] in GHC.Core.Type.</span><span>
</span><span id="line-149"></span><span class="hs-keyword">data</span><span> </span><span id="TypeMapX"><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapX"><span class="hs-identifier hs-var">TypeMapX</span></a></span></span><span> </span><span id="local-6989586621682580599"><span class="annot"><a href="#local-6989586621682580599"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TM"><span class="annot"><a href="GHC.Core.Map.Type.html#TM"><span class="hs-identifier hs-var">TM</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="tm_var"><span class="annot"><span class="annottext">forall a. TypeMapX a -&gt; VarMap a
</span><a href="GHC.Core.Map.Type.html#tm_var"><span class="hs-identifier hs-var hs-var">tm_var</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580599"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-151"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="tm_app"><span class="annot"><span class="annottext">forall a. TypeMapX a -&gt; TypeMapG (TypeMapG a)
</span><a href="GHC.Core.Map.Type.html#tm_app"><span class="hs-identifier hs-var hs-var">tm_app</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580599"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Note [Equality on AppTys] in GHC.Core.Type</span><span>
</span><span id="line-152"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="tm_tycon"><span class="annot"><span class="annottext">forall a. TypeMapX a -&gt; DNameEnv a
</span><a href="GHC.Core.Map.Type.html#tm_tycon"><span class="hs-identifier hs-var hs-var">tm_tycon</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#DNameEnv"><span class="hs-identifier hs-type">DNameEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580599"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-153"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="tm_forall"><span class="annot"><span class="annottext">forall a. TypeMapX a -&gt; TypeMapG (BndrMap a)
</span><a href="GHC.Core.Map.Type.html#tm_forall"><span class="hs-identifier hs-var hs-var">tm_forall</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580599"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- See Note [Binders] in GHC.Core.Map.Expr</span><span>
</span><span id="line-154"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="tm_tylit"><span class="annot"><span class="annottext">forall a. TypeMapX a -&gt; TyLitMap a
</span><a href="GHC.Core.Map.Type.html#tm_tylit"><span class="hs-identifier hs-var hs-var">tm_tylit</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580599"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-155"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="tm_coerce"><span class="annot"><span class="annottext">forall a. TypeMapX a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#tm_coerce"><span class="hs-identifier hs-var hs-var">tm_coerce</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682580599"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-156"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-comment">-- Note that there is no tyconapp case; see Note [Equality on AppTys] in GHC.Core.Type</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- | Squeeze out any synonyms, and change TyConApps to nested AppTys. Why the</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- last one? See Note [Equality on AppTys] in GHC.Core.Type</span><span>
</span><span id="line-161"></span><span class="hs-comment">--</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- We also keep (Eq a =&gt; a) as a FunTy, distinct from ((-&gt;) (Eq a) a).</span><span>
</span><span id="line-163"></span><span class="annot"><a href="GHC.Core.Map.Type.html#trieMapView"><span class="hs-identifier hs-type">trieMapView</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-164"></span><span id="trieMapView"><span class="annot"><span class="annottext">trieMapView :: Type -&gt; Maybe Type
</span><a href="GHC.Core.Map.Type.html#trieMapView"><span class="hs-identifier hs-var hs-var">trieMapView</span></a></span></span><span> </span><span id="local-6989586621682581034"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581034"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-comment">-- First check for TyConApps that need to be expanded to</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-comment">-- AppTy chains.  This includes eliminating FunTy entirely.</span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682581035"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682581035"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682581036"><span class="annot"><span class="annottext">tys :: [Type]
</span><a href="#local-6989586621682581036"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581034"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe Type) -&gt; Type -&gt; Maybe Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#mkTyConTy"><span class="hs-identifier hs-var">mkTyConTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682581035"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682581036"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-comment">-- Then resolve any remaining nullary synonyms.</span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682581041"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581041"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581034"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581041"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="annot"><a href="GHC.Core.Map.Type.html#trieMapView"><span class="hs-identifier hs-var">trieMapView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- TODO(22292): derive</span><span>
</span><span id="line-177"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682581045"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621682581061"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; TypeMapX a -&gt; TypeMapX b
</span><span class="hs-identifier hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621682581062"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581062"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TM"><span class="hs-identifier hs-type">TM</span></a></span><span>
</span><span id="line-179"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tm_var :: forall a. TypeMapX a -&gt; VarMap a
</span><a href="GHC.Core.Map.Type.html#tm_var"><span class="hs-identifier hs-var">tm_var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581063"><span class="annot"><span class="annottext">VarMap a
</span><a href="#local-6989586621682581063"><span class="hs-identifier hs-var">tvar</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_app :: forall a. TypeMapX a -&gt; TypeMapG (TypeMapG a)
</span><a href="GHC.Core.Map.Type.html#tm_app"><span class="hs-identifier hs-var">tm_app</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581064"><span class="annot"><span class="annottext">TypeMapG (TypeMapG a)
</span><a href="#local-6989586621682581064"><span class="hs-identifier hs-var">tapp</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_tycon :: forall a. TypeMapX a -&gt; DNameEnv a
</span><a href="GHC.Core.Map.Type.html#tm_tycon"><span class="hs-identifier hs-var">tm_tycon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581065"><span class="annot"><span class="annottext">DNameEnv a
</span><a href="#local-6989586621682581065"><span class="hs-identifier hs-var">ttycon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_forall :: forall a. TypeMapX a -&gt; TypeMapG (BndrMap a)
</span><a href="GHC.Core.Map.Type.html#tm_forall"><span class="hs-identifier hs-var">tm_forall</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581066"><span class="annot"><span class="annottext">TypeMapG (BndrMap a)
</span><a href="#local-6989586621682581066"><span class="hs-identifier hs-var">tforall</span></a></span></span><span>
</span><span id="line-180"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_tylit :: forall a. TypeMapX a -&gt; TyLitMap a
</span><a href="GHC.Core.Map.Type.html#tm_tylit"><span class="hs-identifier hs-var">tm_tylit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581067"><span class="annot"><span class="annottext">TyLitMap a
</span><a href="#local-6989586621682581067"><span class="hs-identifier hs-var">tlit</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_coerce :: forall a. TypeMapX a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#tm_coerce"><span class="hs-identifier hs-var">tm_coerce</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581068"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621682581068"><span class="hs-identifier hs-var">tcoerce</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TM"><span class="hs-identifier hs-type">TM</span></a></span><span>
</span><span id="line-181"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tm_var :: VarMap b
</span><a href="GHC.Core.Map.Type.html#tm_var"><span class="hs-identifier hs-var">tm_var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; VarMap a -&gt; VarMap b
forall a b. (a -&gt; b) -&gt; VarMap a -&gt; VarMap b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581062"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">VarMap a
</span><a href="#local-6989586621682581063"><span class="hs-identifier hs-var">tvar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_app :: TypeMapG (TypeMapG b)
</span><a href="GHC.Core.Map.Type.html#tm_app"><span class="hs-identifier hs-var">tm_app</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TypeMapG a -&gt; TypeMapG b)
-&gt; TypeMapG (TypeMapG a) -&gt; TypeMapG (TypeMapG b)
forall a b. (a -&gt; b) -&gt; GenMap TypeMapX a -&gt; GenMap TypeMapX b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; TypeMapG a -&gt; TypeMapG b
forall a b. (a -&gt; b) -&gt; GenMap TypeMapX a -&gt; GenMap TypeMapX b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581062"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMapG (TypeMapG a)
</span><a href="#local-6989586621682581064"><span class="hs-identifier hs-var">tapp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_tycon :: DNameEnv b
</span><a href="GHC.Core.Map.Type.html#tm_tycon"><span class="hs-identifier hs-var">tm_tycon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; DNameEnv a -&gt; DNameEnv b
forall a b. (a -&gt; b) -&gt; UniqDFM Name a -&gt; UniqDFM Name b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581062"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DNameEnv a
</span><a href="#local-6989586621682581065"><span class="hs-identifier hs-var">ttycon</span></a></span><span>
</span><span id="line-182"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_forall :: TypeMapG (BndrMap b)
</span><a href="GHC.Core.Map.Type.html#tm_forall"><span class="hs-identifier hs-var">tm_forall</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BndrMap a -&gt; BndrMap b)
-&gt; TypeMapG (BndrMap a) -&gt; TypeMapG (BndrMap b)
forall a b. (a -&gt; b) -&gt; GenMap TypeMapX a -&gt; GenMap TypeMapX b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; BndrMap a -&gt; BndrMap b
forall a b. (a -&gt; b) -&gt; BndrMap a -&gt; BndrMap b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581062"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMapG (BndrMap a)
</span><a href="#local-6989586621682581066"><span class="hs-identifier hs-var">tforall</span></a></span><span>
</span><span id="line-183"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_tylit :: TyLitMap b
</span><a href="GHC.Core.Map.Type.html#tm_tylit"><span class="hs-identifier hs-var">tm_tylit</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; TyLitMap a -&gt; TyLitMap b
forall a b. (a -&gt; b) -&gt; TyLitMap a -&gt; TyLitMap b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581062"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TyLitMap a
</span><a href="#local-6989586621682581067"><span class="hs-identifier hs-var">tlit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_coerce :: Maybe b
</span><a href="GHC.Core.Map.Type.html#tm_coerce"><span class="hs-identifier hs-var">tm_coerce</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581062"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621682581068"><span class="hs-identifier hs-var">tcoerce</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>   </span><span class="hs-keyword">type</span><span> </span><span id="Key"><span class="annot"><a href="GHC.Data.TrieMap.html#Key"><span class="hs-identifier hs-var">Key</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-187"></span><span>   </span><span id="local-6989586621682581076"><span class="annot"><span class="annottext">emptyTM :: forall a. TypeMapX a
</span><a href="GHC.Data.TrieMap.html#emptyTM"><span class="hs-identifier hs-var hs-var hs-var">emptyTM</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapX a
forall a. TypeMapX a
</span><a href="GHC.Core.Map.Type.html#emptyT"><span class="hs-identifier hs-var">emptyT</span></a></span><span>
</span><span id="line-188"></span><span>   </span><span id="local-6989586621682581078"><span class="annot"><span class="annottext">lookupTM :: forall b. Key TypeMapX -&gt; TypeMapX b -&gt; Maybe b
</span><a href="GHC.Data.TrieMap.html#lookupTM"><span class="hs-identifier hs-var hs-var hs-var">lookupTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key TypeMapX -&gt; TypeMapX b -&gt; Maybe b
DeBruijn Type -&gt; TypeMapX b -&gt; Maybe b
forall a. DeBruijn Type -&gt; TypeMapX a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkT"><span class="hs-identifier hs-var">lkT</span></a></span><span>
</span><span id="line-189"></span><span>   </span><span id="local-6989586621682581079"><span class="annot"><span class="annottext">alterTM :: forall b. Key TypeMapX -&gt; XT b -&gt; TypeMapX b -&gt; TypeMapX b
</span><a href="GHC.Data.TrieMap.html#alterTM"><span class="hs-identifier hs-var hs-var hs-var">alterTM</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key TypeMapX -&gt; (Maybe b -&gt; Maybe b) -&gt; TypeMapX b -&gt; TypeMapX b
DeBruijn Type -&gt; (Maybe b -&gt; Maybe b) -&gt; TypeMapX b -&gt; TypeMapX b
forall a. DeBruijn Type -&gt; XT a -&gt; TypeMapX a -&gt; TypeMapX a
</span><a href="GHC.Core.Map.Type.html#xtT"><span class="hs-identifier hs-var">xtT</span></a></span><span>
</span><span id="line-190"></span><span>   </span><span id="local-6989586621682581080"><span class="annot"><span class="annottext">foldTM :: forall a b. (a -&gt; b -&gt; b) -&gt; TypeMapX a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var hs-var hs-var">foldTM</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; TypeMapX a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; TypeMapX a -&gt; b -&gt; b
</span><a href="GHC.Core.Map.Type.html#fdT"><span class="hs-identifier hs-var">fdT</span></a></span><span>
</span><span id="line-191"></span><span>   </span><span id="local-6989586621682581082"><span class="annot"><span class="annottext">filterTM :: forall a. (a -&gt; Bool) -&gt; TypeMapX a -&gt; TypeMapX a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var hs-var hs-var">filterTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; TypeMapX a -&gt; TypeMapX a
forall a. (a -&gt; Bool) -&gt; TypeMapX a -&gt; TypeMapX a
</span><a href="GHC.Core.Map.Type.html#filterT"><span class="hs-identifier hs-var">filterT</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682581086"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621682581088"><span class="annot"><span class="annottext">== :: DeBruijn Type -&gt; DeBruijn Type -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">(==)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; Bool
</span><a href="GHC.Core.Map.Type.html#eqDeBruijnType"><span class="hs-identifier hs-var">eqDeBruijnType</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | An equality relation between two 'Type's (known below as @t1 :: k2@</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- and @t2 :: k2@)</span><span>
</span><span id="line-198"></span><span class="hs-keyword">data</span><span> </span><span id="TypeEquality"><span class="annot"><a href="GHC.Core.Map.Type.html#TypeEquality"><span class="hs-identifier hs-var">TypeEquality</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TNEQ"><span class="annot"><a href="GHC.Core.Map.Type.html#TNEQ"><span class="hs-identifier hs-var">TNEQ</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ @t1 /= t2@</span></span><span>
</span><span id="line-199"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="TEQ"><span class="annot"><a href="GHC.Core.Map.Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a></span></span><span>  </span><span class="hs-comment">-- ^ @t1 ~ t2@ and there are not casts in either,</span><span>
</span><span id="line-200"></span><span>                         </span><span class="hs-comment">-- therefore we can conclude @k1 ~ k2@</span><span>
</span><span id="line-201"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="TEQX"><span class="annot"><a href="GHC.Core.Map.Type.html#TEQX"><span class="hs-identifier hs-var">TEQX</span></a></span></span><span> </span><span class="hs-comment">-- ^ @t1 ~ t2@ yet one of the types contains a cast so</span><span>
</span><span id="line-202"></span><span>                         </span><span class="hs-comment">-- they may differ in kind</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="annot"><a href="GHC.Core.Map.Type.html#eqDeBruijnType"><span class="hs-identifier hs-type">eqDeBruijnType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-205"></span><span id="eqDeBruijnType"><span class="annot"><span class="annottext">eqDeBruijnType :: DeBruijn Type -&gt; DeBruijn Type -&gt; Bool
</span><a href="GHC.Core.Map.Type.html#eqDeBruijnType"><span class="hs-identifier hs-var hs-var">eqDeBruijnType</span></a></span></span><span> </span><span id="local-6989586621682581092"><span class="annot"><span class="annottext">env_t1 :: DeBruijn Type
</span><a href="#local-6989586621682581092"><span class="hs-identifier hs-var">env_t1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581093"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581093"><span class="hs-identifier hs-var">env1</span></a></span></span><span> </span><span id="local-6989586621682581094"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581094"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682581095"><span class="annot"><span class="annottext">env_t2 :: DeBruijn Type
</span><a href="#local-6989586621682581095"><span class="hs-identifier hs-var">env_t2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581096"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581096"><span class="hs-identifier hs-var">env2</span></a></span></span><span> </span><span id="local-6989586621682581097"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581097"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-comment">-- See Note [Non-trivial definitional equality] in GHC.Core.TyCo.Rep</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-comment">-- See Note [Computing equality on types]</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; TypeEquality
</span><a href="#local-6989586621682581098"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DeBruijn Type
</span><a href="#local-6989586621682581092"><span class="hs-identifier hs-var">env_t1</span></a></span><span> </span><span class="annot"><span class="annottext">DeBruijn Type
</span><a href="#local-6989586621682581095"><span class="hs-identifier hs-var">env_t2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-209"></span><span>      </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="GHC.Core.Map.Type.html#TEQX"><span class="hs-identifier hs-var">TEQX</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeEquality -&gt; Bool
</span><a href="#local-6989586621682581099"><span class="hs-identifier hs-var">toBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; TypeEquality
</span><a href="#local-6989586621682581098"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581093"><span class="hs-identifier hs-var">env1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581100"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581096"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581101"><span class="hs-identifier hs-var">k2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>      </span><span id="local-6989586621682581102"><span class="annot"><span class="annottext">TypeEquality
</span><a href="#local-6989586621682581102"><span class="hs-identifier hs-var">ty_eq</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeEquality -&gt; Bool
</span><a href="#local-6989586621682581099"><span class="hs-identifier hs-var">toBool</span></a></span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="#local-6989586621682581102"><span class="hs-identifier hs-var">ty_eq</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-212"></span><span>    </span><span id="local-6989586621682581100"><span class="annot"><span class="annottext">k1 :: Type
</span><a href="#local-6989586621682581100"><span class="hs-identifier hs-var hs-var">k1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581094"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621682581101"><span class="annot"><span class="annottext">k2 :: Type
</span><a href="#local-6989586621682581101"><span class="hs-identifier hs-var hs-var">k2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581097"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><a href="#local-6989586621682581099"><span class="hs-identifier hs-type">toBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeEquality"><span class="hs-identifier hs-type">TypeEquality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-216"></span><span>    </span><span id="local-6989586621682581099"><span class="annot"><span class="annottext">toBool :: TypeEquality -&gt; Bool
</span><a href="#local-6989586621682581099"><span class="hs-identifier hs-var hs-var">toBool</span></a></span></span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="GHC.Core.Map.Type.html#TNEQ"><span class="hs-identifier hs-var">TNEQ</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><a href="#local-6989586621682581099"><span class="hs-identifier hs-var">toBool</span></a></span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><a href="#local-6989586621682581104"><span class="hs-identifier hs-type">liftEquality</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeEquality"><span class="hs-identifier hs-type">TypeEquality</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621682581104"><span class="annot"><span class="annottext">liftEquality :: Bool -&gt; TypeEquality
</span><a href="#local-6989586621682581104"><span class="hs-identifier hs-var hs-var">liftEquality</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="GHC.Core.Map.Type.html#TNEQ"><span class="hs-identifier hs-var">TNEQ</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><a href="#local-6989586621682581104"><span class="hs-identifier hs-var">liftEquality</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="GHC.Core.Map.Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><a href="#local-6989586621682581105"><span class="hs-identifier hs-type">hasCast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeEquality"><span class="hs-identifier hs-type">TypeEquality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeEquality"><span class="hs-identifier hs-type">TypeEquality</span></a></span><span>
</span><span id="line-224"></span><span>    </span><span id="local-6989586621682581105"><span class="annot"><span class="annottext">hasCast :: TypeEquality -&gt; TypeEquality
</span><a href="#local-6989586621682581105"><span class="hs-identifier hs-var hs-var">hasCast</span></a></span></span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="GHC.Core.Map.Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="GHC.Core.Map.Type.html#TEQX"><span class="hs-identifier hs-var">TEQX</span></a></span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><a href="#local-6989586621682581105"><span class="hs-identifier hs-var">hasCast</span></a></span><span> </span><span id="local-6989586621682581106"><span class="annot"><span class="annottext">TypeEquality
</span><a href="#local-6989586621682581106"><span class="hs-identifier hs-var">eq</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="#local-6989586621682581106"><span class="hs-identifier hs-var">eq</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><a href="#local-6989586621682581107"><span class="hs-identifier hs-type">andEq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeEquality"><span class="hs-identifier hs-type">TypeEquality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeEquality"><span class="hs-identifier hs-type">TypeEquality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeEquality"><span class="hs-identifier hs-type">TypeEquality</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621682581107"><span class="annot"><span class="annottext">andEq :: TypeEquality -&gt; TypeEquality -&gt; TypeEquality
</span><a href="#local-6989586621682581107"><span class="hs-identifier hs-var hs-var">andEq</span></a></span></span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="GHC.Core.Map.Type.html#TNEQ"><span class="hs-identifier hs-var">TNEQ</span></a></span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="GHC.Core.Map.Type.html#TNEQ"><span class="hs-identifier hs-var">TNEQ</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><a href="#local-6989586621682581107"><span class="hs-identifier hs-var">andEq</span></a></span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="GHC.Core.Map.Type.html#TEQX"><span class="hs-identifier hs-var">TEQX</span></a></span><span> </span><span id="local-6989586621682581108"><span class="annot"><span class="annottext">TypeEquality
</span><a href="#local-6989586621682581108"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeEquality -&gt; TypeEquality
</span><a href="#local-6989586621682581105"><span class="hs-identifier hs-var">hasCast</span></a></span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="#local-6989586621682581108"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span class="annot"><a href="#local-6989586621682581107"><span class="hs-identifier hs-var">andEq</span></a></span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="GHC.Core.Map.Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a></span><span>  </span><span id="local-6989586621682581109"><span class="annot"><span class="annottext">TypeEquality
</span><a href="#local-6989586621682581109"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="#local-6989586621682581109"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-comment">-- See Note [Comparing type synonyms] in GHC.Core.TyCo.Compare</span><span>
</span><span id="line-233"></span><span>    </span><span id="local-6989586621682581098"><span class="annot"><span class="annottext">go :: DeBruijn Type -&gt; DeBruijn Type -&gt; TypeEquality
</span><a href="#local-6989586621682581098"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581119"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581119"><span class="hs-identifier hs-var">env1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682581121"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682581121"><span class="hs-identifier hs-var">tc1</span></a></span></span><span> </span><span id="local-6989586621682581122"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682581122"><span class="hs-identifier hs-var">tys1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581123"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581123"><span class="hs-identifier hs-var">env2</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682581124"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682581124"><span class="hs-identifier hs-var">tc2</span></a></span></span><span> </span><span id="local-6989586621682581125"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682581125"><span class="hs-identifier hs-var">tys2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682581121"><span class="hs-identifier hs-var">tc1</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; TyCon -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682581124"><span class="hs-identifier hs-var">tc2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isForgetfulSynTyCon"><span class="hs-identifier hs-var">isForgetfulSynTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682581121"><span class="hs-identifier hs-var">tc1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; CmEnv -&gt; [Type] -&gt; [Type] -&gt; TypeEquality
</span><a href="#local-6989586621682581127"><span class="hs-identifier hs-var">gos</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581119"><span class="hs-identifier hs-var">env1</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581123"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682581122"><span class="hs-identifier hs-var">tys1</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682581125"><span class="hs-identifier hs-var">tys2</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><a href="#local-6989586621682581098"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682581128"><span class="annot"><span class="annottext">env_t :: DeBruijn Type
</span><a href="#local-6989586621682581128"><span class="hs-identifier hs-var">env_t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581129"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682581130"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581130"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682581131"><span class="annot"><span class="annottext">env_t' :: DeBruijn Type
</span><a href="#local-6989586621682581131"><span class="hs-identifier hs-var">env_t'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581132"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581132"><span class="hs-identifier hs-var">env'</span></a></span></span><span> </span><span id="local-6989586621682581133"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581133"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682581134"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581134"><span class="hs-identifier hs-var">new_t</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581130"><span class="hs-identifier hs-var">t</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; TypeEquality
</span><a href="#local-6989586621682581098"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581134"><span class="hs-identifier hs-var">new_t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DeBruijn Type
</span><a href="#local-6989586621682581131"><span class="hs-identifier hs-var">env_t'</span></a></span><span>
</span><span id="line-239"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682581135"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581135"><span class="hs-identifier hs-var">new_t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581133"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; TypeEquality
</span><a href="#local-6989586621682581098"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DeBruijn Type
</span><a href="#local-6989586621682581128"><span class="hs-identifier hs-var">env_t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581132"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581135"><span class="hs-identifier hs-var">new_t'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-241"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581130"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581133"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-242"></span><span>          </span><span class="hs-comment">-- See Note [Non-trivial definitional equality] in GHC.Core.TyCo.Rep</span><span>
</span><span id="line-243"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682581137"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581137"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeEquality -&gt; TypeEquality
</span><a href="#local-6989586621682581105"><span class="hs-identifier hs-var">hasCast</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; TypeEquality
</span><a href="#local-6989586621682581098"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581137"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581133"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682581138"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581138"><span class="hs-identifier hs-var">t1'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeEquality -&gt; TypeEquality
</span><a href="#local-6989586621682581105"><span class="hs-identifier hs-var">hasCast</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; TypeEquality
</span><a href="#local-6989586621682581098"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581130"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581138"><span class="hs-identifier hs-var">t1'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682581140"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581140"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682581141"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581141"><span class="hs-identifier hs-var">v'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TypeEquality
</span><a href="#local-6989586621682581104"><span class="hs-identifier hs-var">liftEquality</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; TypeEquality) -&gt; Bool -&gt; TypeEquality
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DeBruijn Var -&gt; DeBruijn Var -&gt; Bool
</span><a href="GHC.Core.Map.Type.html#eqDeBruijnVar"><span class="hs-identifier hs-var">eqDeBruijnVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Var -&gt; DeBruijn Var
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581140"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Var -&gt; DeBruijn Var
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581132"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581141"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>          </span><span class="hs-comment">-- See Note [Equality on AppTys] in GHC.Core.Type</span><span>
</span><span id="line-249"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682581142"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581142"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682581143"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581143"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682581144"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581144"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682581145"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581145"><span class="hs-identifier hs-var">t1'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682581146"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581146"><span class="hs-identifier hs-var">t2'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (Type, Type)
Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Core.Type.html#splitAppTyNoView_maybe"><span class="hs-identifier hs-var">splitAppTyNoView_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581144"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-250"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; TypeEquality
</span><a href="#local-6989586621682581098"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581142"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581132"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581145"><span class="hs-identifier hs-var">t1'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeEquality -&gt; TypeEquality -&gt; TypeEquality
</span><a href="#local-6989586621682581107"><span class="hs-operator hs-var">`andEq`</span></a></span><span> </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; TypeEquality
</span><a href="#local-6989586621682581098"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581143"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581132"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581146"><span class="hs-identifier hs-var">t2'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682581148"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581148"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682581149"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581149"><span class="hs-identifier hs-var">t1'</span></a></span></span><span> </span><span id="local-6989586621682581150"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581150"><span class="hs-identifier hs-var">t2'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682581151"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581151"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682581152"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581152"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (Type, Type)
Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Core.Type.html#splitAppTyNoView_maybe"><span class="hs-identifier hs-var">splitAppTyNoView_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581148"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-252"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; TypeEquality
</span><a href="#local-6989586621682581098"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581151"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581132"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581149"><span class="hs-identifier hs-var">t1'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeEquality -&gt; TypeEquality -&gt; TypeEquality
</span><a href="#local-6989586621682581107"><span class="hs-operator hs-var">`andEq`</span></a></span><span> </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; TypeEquality
</span><a href="#local-6989586621682581098"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581152"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581132"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581150"><span class="hs-identifier hs-var">t2'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span id="local-6989586621682581154"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682581154"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621682581155"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581155"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span id="local-6989586621682581156"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581156"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682581157"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581157"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span id="local-6989586621682581158"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682581158"><span class="hs-identifier hs-var">v1'</span></a></span></span><span> </span><span id="local-6989586621682581159"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581159"><span class="hs-identifier hs-var">w1'</span></a></span></span><span> </span><span id="local-6989586621682581160"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581160"><span class="hs-identifier hs-var">t1'</span></a></span></span><span> </span><span id="local-6989586621682581161"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581161"><span class="hs-identifier hs-var">t2'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TypeEquality
</span><a href="#local-6989586621682581104"><span class="hs-identifier hs-var">liftEquality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682581154"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; FunTyFlag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682581158"><span class="hs-identifier hs-var">v1'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeEquality -&gt; TypeEquality -&gt; TypeEquality
</span><a href="#local-6989586621682581107"><span class="hs-operator hs-var">`andEq`</span></a></span><span>
</span><span id="line-256"></span><span>                 </span><span class="hs-comment">-- NB: eqDeBruijnType does the kind check requested by</span><span>
</span><span id="line-257"></span><span>                 </span><span class="hs-comment">-- Note [Equality on FunTys] in GHC.Core.TyCo.Rep</span><span>
</span><span id="line-258"></span><span>                 </span><span class="annot"><span class="annottext">Bool -&gt; TypeEquality
</span><a href="#local-6989586621682581104"><span class="hs-identifier hs-var">liftEquality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; Bool
</span><a href="GHC.Core.Map.Type.html#eqDeBruijnType"><span class="hs-identifier hs-var">eqDeBruijnType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581156"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581132"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581160"><span class="hs-identifier hs-var">t1'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeEquality -&gt; TypeEquality -&gt; TypeEquality
</span><a href="#local-6989586621682581107"><span class="hs-operator hs-var">`andEq`</span></a></span><span>
</span><span id="line-259"></span><span>                 </span><span class="annot"><span class="annottext">Bool -&gt; TypeEquality
</span><a href="#local-6989586621682581104"><span class="hs-identifier hs-var">liftEquality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; Bool
</span><a href="GHC.Core.Map.Type.html#eqDeBruijnType"><span class="hs-identifier hs-var">eqDeBruijnType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581157"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581132"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581161"><span class="hs-identifier hs-var">t2'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeEquality -&gt; TypeEquality -&gt; TypeEquality
</span><a href="#local-6989586621682581107"><span class="hs-operator hs-var">`andEq`</span></a></span><span>
</span><span id="line-260"></span><span>                 </span><span class="hs-comment">-- Comparing multiplicities last because the test is usually true</span><span>
</span><span id="line-261"></span><span>                 </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; TypeEquality
</span><a href="#local-6989586621682581098"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581155"><span class="hs-identifier hs-var">w1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581159"><span class="hs-identifier hs-var">w1'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682581162"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682581162"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682581163"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682581163"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682581164"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682581164"><span class="hs-identifier hs-var">tc'</span></a></span></span><span> </span><span id="local-6989586621682581165"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682581165"><span class="hs-identifier hs-var">tys'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TypeEquality
</span><a href="#local-6989586621682581104"><span class="hs-identifier hs-var">liftEquality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682581162"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; TyCon -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682581164"><span class="hs-identifier hs-var">tc'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeEquality -&gt; TypeEquality -&gt; TypeEquality
</span><a href="#local-6989586621682581107"><span class="hs-operator hs-var">`andEq`</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; CmEnv -&gt; [Type] -&gt; [Type] -&gt; TypeEquality
</span><a href="#local-6989586621682581127"><span class="hs-identifier hs-var">gos</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581132"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682581163"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682581165"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-264"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621682581167"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682581167"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621682581168"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682581168"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TypeEquality
</span><a href="#local-6989586621682581104"><span class="hs-identifier hs-var">liftEquality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682581167"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; TyLit -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682581168"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682581171"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581171"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621682581172"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682581172"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682581173"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581173"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682581174"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581174"><span class="hs-identifier hs-var">tv'</span></a></span></span><span> </span><span id="local-6989586621682581175"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682581175"><span class="hs-identifier hs-var">vis'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682581176"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581176"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- See Note [ForAllTy and type equality] in</span><span>
</span><span id="line-268"></span><span>                 </span><span class="hs-comment">-- GHC.Core.TyCo.Compare for why we use `eqForAllVis` here</span><span>
</span><span id="line-269"></span><span>                 </span><span class="annot"><span class="annottext">Bool -&gt; TypeEquality
</span><a href="#local-6989586621682581104"><span class="hs-identifier hs-var">liftEquality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682581172"><span class="hs-identifier hs-var">vis</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; ForAllTyFlag -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqForAllVis"><span class="hs-operator hs-var">`eqForAllVis`</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682581175"><span class="hs-identifier hs-var">vis'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeEquality -&gt; TypeEquality -&gt; TypeEquality
</span><a href="#local-6989586621682581107"><span class="hs-operator hs-var">`andEq`</span></a></span><span>
</span><span id="line-270"></span><span>                 </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; TypeEquality
</span><a href="#local-6989586621682581098"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581171"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581132"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581174"><span class="hs-identifier hs-var">tv'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeEquality -&gt; TypeEquality -&gt; TypeEquality
</span><a href="#local-6989586621682581107"><span class="hs-operator hs-var">`andEq`</span></a></span><span>
</span><span id="line-271"></span><span>                 </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; TypeEquality
</span><a href="#local-6989586621682581098"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Var -&gt; CmEnv
</span><a href="GHC.Core.Map.Type.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581129"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581171"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581173"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Var -&gt; CmEnv
</span><a href="GHC.Core.Map.Type.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581132"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581174"><span class="hs-identifier hs-var">tv'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581176"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="GHC.Core.Map.Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a></span><span>
</span><span id="line-274"></span><span>          </span><span class="annot"><span class="annottext">(Type, Type)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="GHC.Core.Map.Type.html#TNEQ"><span class="hs-identifier hs-var">TNEQ</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-comment">-- These bangs make 'gos' strict in the CMEnv, which in turn</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-comment">-- keeps the CMEnv unboxed across the go/gos mutual recursion</span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-comment">-- (If you want a test case, T9872c really exercises this code.)</span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621682581127"><span class="annot"><span class="annottext">gos :: CmEnv -&gt; CmEnv -&gt; [Type] -&gt; [Type] -&gt; TypeEquality
</span><a href="#local-6989586621682581127"><span class="hs-identifier hs-var hs-var">gos</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="annottext">CmEnv
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">!</span><span class="annot"><span class="annottext">CmEnv
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="GHC.Core.Map.Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><a href="#local-6989586621682581127"><span class="hs-identifier hs-var">gos</span></a></span><span> </span><span id="local-6989586621682581179"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581179"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621682581180"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581180"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682581181"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581181"><span class="hs-identifier hs-var">ty1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682581182"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682581182"><span class="hs-identifier hs-var">tys1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682581183"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581183"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682581184"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682581184"><span class="hs-identifier hs-var">tys2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; DeBruijn Type -&gt; TypeEquality
</span><a href="#local-6989586621682581098"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581179"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581181"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581180"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581183"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeEquality -&gt; TypeEquality -&gt; TypeEquality
</span><a href="#local-6989586621682581107"><span class="hs-operator hs-var">`andEq`</span></a></span><span>
</span><span id="line-281"></span><span>                                      </span><span class="annot"><span class="annottext">CmEnv -&gt; CmEnv -&gt; [Type] -&gt; [Type] -&gt; TypeEquality
</span><a href="#local-6989586621682581127"><span class="hs-identifier hs-var">gos</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581179"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581180"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682581182"><span class="hs-identifier hs-var">tys1</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682581184"><span class="hs-identifier hs-var">tys2</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><a href="#local-6989586621682581127"><span class="hs-identifier hs-var">gos</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">CmEnv
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span>          </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeEquality
</span><a href="GHC.Core.Map.Type.html#TNEQ"><span class="hs-identifier hs-var">TNEQ</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682581187"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>  </span><span id="local-6989586621682581190"><span class="annot"><span class="annottext">== :: DeBruijn Var -&gt; DeBruijn Var -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">(==)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeBruijn Var -&gt; DeBruijn Var -&gt; Bool
</span><a href="GHC.Core.Map.Type.html#eqDeBruijnVar"><span class="hs-identifier hs-var">eqDeBruijnVar</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="annot"><a href="GHC.Core.Map.Type.html#eqDeBruijnVar"><span class="hs-identifier hs-type">eqDeBruijnVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-288"></span><span id="eqDeBruijnVar"><span class="annot"><span class="annottext">eqDeBruijnVar :: DeBruijn Var -&gt; DeBruijn Var -&gt; Bool
</span><a href="GHC.Core.Map.Type.html#eqDeBruijnVar"><span class="hs-identifier hs-var hs-var">eqDeBruijnVar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581191"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581191"><span class="hs-identifier hs-var">env1</span></a></span></span><span> </span><span id="local-6989586621682581192"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581192"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581193"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581193"><span class="hs-identifier hs-var">env2</span></a></span></span><span> </span><span id="local-6989586621682581194"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581194"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Var -&gt; Maybe BoundVar
</span><a href="GHC.Core.Map.Type.html#lookupCME"><span class="hs-identifier hs-var">lookupCME</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581191"><span class="hs-identifier hs-var">env1</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581192"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; Var -&gt; Maybe BoundVar
</span><a href="GHC.Core.Map.Type.html#lookupCME"><span class="hs-identifier hs-var">lookupCME</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581193"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581194"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-290"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682581195"><span class="annot"><span class="annottext">BoundVar
</span><a href="#local-6989586621682581195"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682581196"><span class="annot"><span class="annottext">BoundVar
</span><a href="#local-6989586621682581196"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BoundVar
</span><a href="#local-6989586621682581195"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">BoundVar -&gt; BoundVar -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">BoundVar
</span><a href="#local-6989586621682581196"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-291"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe BoundVar
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe BoundVar
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581192"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581194"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-292"></span><span>        </span><span class="annot"><span class="annottext">(Maybe BoundVar, Maybe BoundVar)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPPING</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-295"></span><span>         </span><span id="local-6989586621682580637"><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580637"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580637"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-296"></span><span>  </span><span id="local-6989586621682581210"><span class="annot"><span class="annottext">ppr :: TypeMapG a -&gt; SDoc
</span><a href="#local-6989586621682581210"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span id="local-6989586621682581212"><span class="annot"><span class="annottext">TypeMapG a
</span><a href="#local-6989586621682581212"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TypeMap elts&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; [a] -&gt; [a]) -&gt; TypeMapG a -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b -&gt; b) -&gt; GenMap TypeMapX a -&gt; b -&gt; b
forall (m :: * -&gt; *) a b.
TrieMap m =&gt;
(a -&gt; b -&gt; b) -&gt; m a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMapG a
</span><a href="#local-6989586621682581212"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span id="local-6989586621682581215"><span class="annot"><a href="GHC.Core.Map.Type.html#emptyT"><span class="hs-identifier hs-type">emptyT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581215"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-299"></span><span id="emptyT"><span class="annot"><span class="annottext">emptyT :: forall a. TypeMapX a
</span><a href="GHC.Core.Map.Type.html#emptyT"><span class="hs-identifier hs-var hs-var">emptyT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TM"><span class="hs-identifier hs-type">TM</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tm_var :: VarMap a
</span><a href="GHC.Core.Map.Type.html#tm_var"><span class="hs-identifier hs-var">tm_var</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarMap a
forall a. VarMap a
forall (m :: * -&gt; *) a. TrieMap m =&gt; m a
</span><a href="GHC.Data.TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a></span><span>
</span><span id="line-300"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_app :: TypeMapG (TypeMapG a)
</span><a href="GHC.Core.Map.Type.html#tm_app"><span class="hs-identifier hs-var">tm_app</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapG (TypeMapG a)
forall a. GenMap TypeMapX a
forall (m :: * -&gt; *) a. TrieMap m =&gt; m a
</span><a href="GHC.Data.TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a></span><span>
</span><span id="line-301"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_tycon :: DNameEnv a
</span><a href="GHC.Core.Map.Type.html#tm_tycon"><span class="hs-identifier hs-var">tm_tycon</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DNameEnv a
forall a. DNameEnv a
</span><a href="GHC.Types.Name.Env.html#emptyDNameEnv"><span class="hs-identifier hs-var">emptyDNameEnv</span></a></span><span>
</span><span id="line-302"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_forall :: TypeMapG (BndrMap a)
</span><a href="GHC.Core.Map.Type.html#tm_forall"><span class="hs-identifier hs-var">tm_forall</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapG (BndrMap a)
forall a. GenMap TypeMapX a
forall (m :: * -&gt; *) a. TrieMap m =&gt; m a
</span><a href="GHC.Data.TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a></span><span>
</span><span id="line-303"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_tylit :: TyLitMap a
</span><a href="GHC.Core.Map.Type.html#tm_tylit"><span class="hs-identifier hs-var">tm_tylit</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLitMap a
forall a. TyLitMap a
</span><a href="GHC.Core.Map.Type.html#emptyTyLitMap"><span class="hs-identifier hs-var">emptyTyLitMap</span></a></span><span>
</span><span id="line-304"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_coerce :: Maybe a
</span><a href="GHC.Core.Map.Type.html#tm_coerce"><span class="hs-identifier hs-var">tm_coerce</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="hs-comment">-----------------</span><span>
</span><span id="line-307"></span><span id="local-6989586621682580592"><span class="annot"><a href="GHC.Core.Map.Type.html#lkT"><span class="hs-identifier hs-type">lkT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580592"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682580592"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-308"></span><span id="lkT"><span class="annot"><span class="annottext">lkT :: forall a. DeBruijn Type -&gt; TypeMapX a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkT"><span class="hs-identifier hs-var hs-var">lkT</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581244"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581244"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682581245"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581245"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682581246"><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581246"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TypeMapX a -&gt; Maybe a
</span><a href="#local-6989586621682581247"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581245"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581246"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-310"></span><span>    </span><span id="local-6989586621682581247"><span class="annot"><span class="annottext">go :: Type -&gt; TypeMapX a -&gt; Maybe a
</span><a href="#local-6989586621682581247"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682581248"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581248"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682581249"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581249"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Map.Type.html#trieMapView"><span class="hs-identifier hs-var">trieMapView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581248"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TypeMapX a -&gt; Maybe a
</span><a href="#local-6989586621682581247"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581249"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><a href="#local-6989586621682581247"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682581250"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581250"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapX a -&gt; VarMap a
forall a. TypeMapX a -&gt; VarMap a
</span><a href="GHC.Core.Map.Type.html#tm_var"><span class="hs-identifier hs-var">tm_var</span></a></span><span>    </span><span class="annot"><span class="annottext">(TypeMapX a -&gt; VarMap a)
-&gt; (VarMap a -&gt; Maybe a) -&gt; TypeMapX a -&gt; Maybe a
forall a b c. (a -&gt; b) -&gt; (b -&gt; c) -&gt; a -&gt; c
</span><a href="GHC.Data.TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; Var -&gt; VarMap a -&gt; Maybe a
forall a. CmEnv -&gt; Var -&gt; VarMap a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkVar"><span class="hs-identifier hs-var">lkVar</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581244"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581250"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><a href="#local-6989586621682581247"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682581252"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581252"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682581253"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581253"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapX a -&gt; TypeMapG (TypeMapG a)
forall a. TypeMapX a -&gt; TypeMapG (TypeMapG a)
</span><a href="GHC.Core.Map.Type.html#tm_app"><span class="hs-identifier hs-var">tm_app</span></a></span><span>    </span><span class="annot"><span class="annottext">(TypeMapX a -&gt; TypeMapG (TypeMapG a))
-&gt; (TypeMapG (TypeMapG a) -&gt; Maybe a) -&gt; TypeMapX a -&gt; Maybe a
forall a b c. (a -&gt; b) -&gt; (b -&gt; c) -&gt; a -&gt; c
</span><a href="GHC.Data.TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Key TypeMapX -&gt; TypeMapG (TypeMapG a) -&gt; Maybe (TypeMapG a)
forall (m :: * -&gt; *) a.
(Eq (Key m), TrieMap m) =&gt;
Key m -&gt; GenMap m a -&gt; Maybe a
</span><a href="GHC.Data.TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581244"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581252"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>                                               </span><span class="annot"><span class="annottext">(TypeMapG (TypeMapG a) -&gt; Maybe (TypeMapG a))
-&gt; (TypeMapG a -&gt; Maybe a) -&gt; TypeMapG (TypeMapG a) -&gt; Maybe a
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">Key TypeMapX -&gt; TypeMapG a -&gt; Maybe a
forall (m :: * -&gt; *) a.
(Eq (Key m), TrieMap m) =&gt;
Key m -&gt; GenMap m a -&gt; Maybe a
</span><a href="GHC.Data.TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581244"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581253"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>    </span><span class="annot"><a href="#local-6989586621682581247"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682581254"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682581254"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapX a -&gt; DNameEnv a
forall a. TypeMapX a -&gt; DNameEnv a
</span><a href="GHC.Core.Map.Type.html#tm_tycon"><span class="hs-identifier hs-var">tm_tycon</span></a></span><span>  </span><span class="annot"><span class="annottext">(TypeMapX a -&gt; DNameEnv a)
-&gt; (DNameEnv a -&gt; Maybe a) -&gt; TypeMapX a -&gt; Maybe a
forall a b c. (a -&gt; b) -&gt; (b -&gt; c) -&gt; a -&gt; c
</span><a href="GHC.Data.TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; DNameEnv a -&gt; Maybe a
forall n a. NamedThing n =&gt; n -&gt; DNameEnv a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkDNamed"><span class="hs-identifier hs-var">lkDNamed</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682581254"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><a href="#local-6989586621682581247"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621682581255"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682581255"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapX a -&gt; TyLitMap a
forall a. TypeMapX a -&gt; TyLitMap a
</span><a href="GHC.Core.Map.Type.html#tm_tylit"><span class="hs-identifier hs-var">tm_tylit</span></a></span><span>  </span><span class="annot"><span class="annottext">(TypeMapX a -&gt; TyLitMap a)
-&gt; (TyLitMap a -&gt; Maybe a) -&gt; TypeMapX a -&gt; Maybe a
forall a b c. (a -&gt; b) -&gt; (b -&gt; c) -&gt; a -&gt; c
</span><a href="GHC.Data.TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; TyLitMap a -&gt; Maybe a
forall a. TyLit -&gt; TyLitMap a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkTyLit"><span class="hs-identifier hs-var">lkTyLit</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682581255"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><a href="#local-6989586621682581247"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682581257"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581257"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682581258"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581258"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapX a -&gt; TypeMapG (BndrMap a)
forall a. TypeMapX a -&gt; TypeMapG (BndrMap a)
</span><a href="GHC.Core.Map.Type.html#tm_forall"><span class="hs-identifier hs-var">tm_forall</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeMapX a -&gt; TypeMapG (BndrMap a))
-&gt; (TypeMapG (BndrMap a) -&gt; Maybe a) -&gt; TypeMapX a -&gt; Maybe a
forall a b c. (a -&gt; b) -&gt; (b -&gt; c) -&gt; a -&gt; c
</span><a href="GHC.Data.TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Key TypeMapX -&gt; TypeMapG (BndrMap a) -&gt; Maybe (BndrMap a)
forall (m :: * -&gt; *) a.
(Eq (Key m), TrieMap m) =&gt;
Key m -&gt; GenMap m a -&gt; Maybe a
</span><a href="GHC.Data.TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Var -&gt; CmEnv
</span><a href="GHC.Core.Map.Type.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581244"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581257"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581258"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>                                               </span><span class="annot"><span class="annottext">(TypeMapG (BndrMap a) -&gt; Maybe (BndrMap a))
-&gt; (BndrMap a -&gt; Maybe a) -&gt; TypeMapG (BndrMap a) -&gt; Maybe a
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; Var -&gt; BndrMap a -&gt; Maybe a
forall a. CmEnv -&gt; Var -&gt; BndrMap a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkBndr"><span class="hs-identifier hs-var">lkBndr</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581244"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581257"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><a href="#local-6989586621682581247"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682581259"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581259"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TypeMapX a -&gt; Maybe a
</span><a href="#local-6989586621682581247"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581259"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><a href="#local-6989586621682581247"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapX a -&gt; Maybe a
forall a. TypeMapX a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#tm_coerce"><span class="hs-identifier hs-var">tm_coerce</span></a></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-comment">-- trieMapView has eliminated non-nullary TyConApp</span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-comment">-- and FunTy into an AppTy chain</span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><a href="#local-6989586621682581247"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682581260"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682581260"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TypeMapX a -&gt; Maybe a
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lkT TyConApp&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581260"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><a href="#local-6989586621682581247"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682581262"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682581262"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TypeMapX a -&gt; Maybe a
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lkT FunTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581262"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="hs-comment">-----------------</span><span>
</span><span id="line-327"></span><span id="local-6989586621682580598"><span class="annot"><a href="GHC.Core.Map.Type.html#xtT"><span class="hs-identifier hs-type">xtT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580598"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580598"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580598"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-328"></span><span id="xtT"><span class="annot"><span class="annottext">xtT :: forall a. DeBruijn Type -&gt; XT a -&gt; TypeMapX a -&gt; TypeMapX a
</span><a href="GHC.Core.Map.Type.html#xtT"><span class="hs-identifier hs-var hs-var">xtT</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581282"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581282"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682581283"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581283"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682581284"><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581284"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682581285"><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581285"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682581286"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581286"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Map.Type.html#trieMapView"><span class="hs-identifier hs-var">trieMapView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581283"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; XT a -&gt; TypeMapX a -&gt; TypeMapX a
forall a. DeBruijn Type -&gt; XT a -&gt; TypeMapX a -&gt; TypeMapX a
</span><a href="GHC.Core.Map.Type.html#xtT"><span class="hs-identifier hs-var">xtT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581282"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581286"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581284"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581285"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="annot"><a href="GHC.Core.Map.Type.html#xtT"><span class="hs-identifier hs-var">xtT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581287"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581287"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682581288"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581288"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><span id="local-6989586621682581289"><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581289"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682581290"><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581290"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#tm_var"><span class="hs-identifier hs-var">tm_var</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#tm_var"><span class="hs-identifier hs-var">tm_var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581290"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#%7C%3E"><span class="hs-operator hs-type">|&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#xtVar"><span class="hs-identifier hs-type">xtVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581287"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581288"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581289"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-331"></span><span class="annot"><a href="GHC.Core.Map.Type.html#xtT"><span class="hs-identifier hs-var">xtT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581292"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581292"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682581293"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581293"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682581294"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581294"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><span id="local-6989586621682581295"><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581295"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682581296"><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581296"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581296"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#tm_app"><span class="hs-identifier hs-var">tm_app</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#tm_app"><span class="hs-identifier hs-var">tm_app</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581296"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#%7C%3E"><span class="hs-operator hs-type">|&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#xtG"><span class="hs-identifier hs-type">xtG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581292"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581293"><span class="hs-identifier hs-type">t1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>                                                            </span><span class="annot"><a href="GHC.Data.TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-type">|&gt;&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#xtG"><span class="hs-identifier hs-type">xtG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581292"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581294"><span class="hs-identifier hs-type">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682581295"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-333"></span><span class="annot"><a href="GHC.Core.Map.Type.html#xtT"><span class="hs-identifier hs-var">xtT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682581298"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682581298"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span id="local-6989586621682581299"><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581299"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682581300"><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581300"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581300"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#tm_tycon"><span class="hs-identifier hs-var">tm_tycon</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#tm_tycon"><span class="hs-identifier hs-var">tm_tycon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581300"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#%7C%3E"><span class="hs-operator hs-type">|&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#xtDNamed"><span class="hs-identifier hs-type">xtDNamed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581298"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581299"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-334"></span><span class="annot"><a href="GHC.Core.Map.Type.html#xtT"><span class="hs-identifier hs-var">xtT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621682581301"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682581301"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>         </span><span id="local-6989586621682581302"><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581302"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682581303"><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581303"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581303"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#tm_tylit"><span class="hs-identifier hs-var">tm_tylit</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#tm_tylit"><span class="hs-identifier hs-var">tm_tylit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581303"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#%7C%3E"><span class="hs-operator hs-type">|&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#xtTyLit"><span class="hs-identifier hs-type">xtTyLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581301"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581302"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-335"></span><span class="annot"><a href="GHC.Core.Map.Type.html#xtT"><span class="hs-identifier hs-var">xtT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581305"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581305"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682581306"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581306"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>      </span><span id="local-6989586621682581307"><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581307"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682581308"><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581308"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; XT a -&gt; TypeMapX a -&gt; TypeMapX a
forall a. DeBruijn Type -&gt; XT a -&gt; TypeMapX a -&gt; TypeMapX a
</span><a href="GHC.Core.Map.Type.html#xtT"><span class="hs-identifier hs-var">xtT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581305"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581306"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581307"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581308"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-336"></span><span class="annot"><a href="GHC.Core.Map.Type.html#xtT"><span class="hs-identifier hs-var">xtT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span id="local-6989586621682581309"><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581309"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682581310"><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581310"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581310"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#tm_coerce"><span class="hs-identifier hs-var">tm_coerce</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#tm_coerce"><span class="hs-identifier hs-var">tm_coerce</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581310"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#%7C%3E"><span class="hs-operator hs-type">|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581309"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-337"></span><span class="annot"><a href="GHC.Core.Map.Type.html#xtT"><span class="hs-identifier hs-var">xtT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581311"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581311"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682581312"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581312"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682581313"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581313"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span id="local-6989586621682581314"><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581314"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682581315"><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581315"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581315"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#tm_forall"><span class="hs-identifier hs-var">tm_forall</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#tm_forall"><span class="hs-identifier hs-var">tm_forall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581315"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#%7C%3E"><span class="hs-operator hs-type">|&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#xtG"><span class="hs-identifier hs-type">xtG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#extendCME"><span class="hs-identifier hs-type">extendCME</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581311"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581312"><span class="hs-identifier hs-type">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682581313"><span class="hs-identifier hs-type">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>                                </span><span class="annot"><a href="GHC.Data.TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-type">|&gt;&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#xtBndr"><span class="hs-identifier hs-type">xtBndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581311"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581312"><span class="hs-identifier hs-type">tv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581314"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-comment">-- trieMapView has eliminated non-nullary TyConApp</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- and FunTy into an AppTy chain</span><span>
</span><span id="line-343"></span><span class="annot"><a href="GHC.Core.Map.Type.html#xtT"><span class="hs-identifier hs-var">xtT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621682581316"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682581316"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XT a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TypeMapX a
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;xtT TyConApp&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581316"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span class="annot"><a href="GHC.Core.Map.Type.html#xtT"><span class="hs-identifier hs-var">xtT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621682581317"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682581317"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>         </span><span class="annot"><span class="annottext">XT a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TypeMapX a
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;xtT FunTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581317"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span id="local-6989586621682581318"><span id="local-6989586621682581319"><span class="annot"><a href="GHC.Core.Map.Type.html#fdT"><span class="hs-identifier hs-type">fdT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682581318"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682581319"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682581319"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581318"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682581319"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682581319"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-347"></span><span id="fdT"><span class="annot"><span class="annottext">fdT :: forall a b. (a -&gt; b -&gt; b) -&gt; TypeMapX a -&gt; b -&gt; b
</span><a href="GHC.Core.Map.Type.html#fdT"><span class="hs-identifier hs-var hs-var">fdT</span></a></span></span><span> </span><span id="local-6989586621682581332"><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581332"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621682581333"><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581333"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; VarMap a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; VarMap a -&gt; b -&gt; b
forall (m :: * -&gt; *) a b.
TrieMap m =&gt;
(a -&gt; b -&gt; b) -&gt; m a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581332"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeMapX a -&gt; VarMap a
forall a. TypeMapX a -&gt; VarMap a
</span><a href="GHC.Core.Map.Type.html#tm_var"><span class="hs-identifier hs-var">tm_var</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581333"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>        </span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; (b -&gt; b) -&gt; b -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(GenMap TypeMapX a -&gt; b -&gt; b)
-&gt; GenMap TypeMapX (GenMap TypeMapX a) -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; GenMap TypeMapX a -&gt; b -&gt; b
forall (m :: * -&gt; *) a b.
TrieMap m =&gt;
(a -&gt; b -&gt; b) -&gt; m a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; GenMap TypeMapX a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; GenMap TypeMapX a -&gt; b -&gt; b
forall (m :: * -&gt; *) a b.
TrieMap m =&gt;
(a -&gt; b -&gt; b) -&gt; m a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581332"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeMapX a -&gt; GenMap TypeMapX (GenMap TypeMapX a)
forall a. TypeMapX a -&gt; TypeMapG (TypeMapG a)
</span><a href="GHC.Core.Map.Type.html#tm_app"><span class="hs-identifier hs-var">tm_app</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581333"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>        </span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; (b -&gt; b) -&gt; b -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; UniqDFM Name a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; UniqDFM Name a -&gt; b -&gt; b
forall (m :: * -&gt; *) a b.
TrieMap m =&gt;
(a -&gt; b -&gt; b) -&gt; m a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581332"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeMapX a -&gt; UniqDFM Name a
forall a. TypeMapX a -&gt; DNameEnv a
</span><a href="GHC.Core.Map.Type.html#tm_tycon"><span class="hs-identifier hs-var">tm_tycon</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581333"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>        </span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; (b -&gt; b) -&gt; b -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(BndrMap a -&gt; b -&gt; b) -&gt; GenMap TypeMapX (BndrMap a) -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; GenMap TypeMapX a -&gt; b -&gt; b
forall (m :: * -&gt; *) a b.
TrieMap m =&gt;
(a -&gt; b -&gt; b) -&gt; m a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; BndrMap a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; BndrMap a -&gt; b -&gt; b
forall (m :: * -&gt; *) a b.
TrieMap m =&gt;
(a -&gt; b -&gt; b) -&gt; m a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581332"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeMapX a -&gt; GenMap TypeMapX (BndrMap a)
forall a. TypeMapX a -&gt; TypeMapG (BndrMap a)
</span><a href="GHC.Core.Map.Type.html#tm_forall"><span class="hs-identifier hs-var">tm_forall</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581333"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>        </span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; (b -&gt; b) -&gt; b -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; TyLitMap a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; TyLitMap a -&gt; b -&gt; b
</span><a href="GHC.Core.Map.Type.html#foldTyLit"><span class="hs-identifier hs-var">foldTyLit</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581332"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeMapX a -&gt; TyLitMap a
forall a. TypeMapX a -&gt; TyLitMap a
</span><a href="GHC.Core.Map.Type.html#tm_tylit"><span class="hs-identifier hs-var">tm_tylit</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581333"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>        </span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; (b -&gt; b) -&gt; b -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; Maybe a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; Maybe a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldMaybe"><span class="hs-identifier hs-var">foldMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581332"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeMapX a -&gt; Maybe a
forall a. TypeMapX a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#tm_coerce"><span class="hs-identifier hs-var">tm_coerce</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapX a
</span><a href="#local-6989586621682581333"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span id="local-6989586621682581337"><span class="annot"><a href="GHC.Core.Map.Type.html#filterT"><span class="hs-identifier hs-type">filterT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682581337"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581337"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapX"><span class="hs-identifier hs-type">TypeMapX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581337"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-355"></span><span id="filterT"><span class="annot"><span class="annottext">filterT :: forall a. (a -&gt; Bool) -&gt; TypeMapX a -&gt; TypeMapX a
</span><a href="GHC.Core.Map.Type.html#filterT"><span class="hs-identifier hs-var hs-var">filterT</span></a></span></span><span> </span><span id="local-6989586621682581351"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581351"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#TM"><span class="hs-identifier hs-type">TM</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tm_var :: forall a. TypeMapX a -&gt; VarMap a
</span><a href="GHC.Core.Map.Type.html#tm_var"><span class="hs-identifier hs-var">tm_var</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581352"><span class="annot"><span class="annottext">VarMap a
</span><a href="#local-6989586621682581352"><span class="hs-identifier hs-var">tvar</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_app :: forall a. TypeMapX a -&gt; TypeMapG (TypeMapG a)
</span><a href="GHC.Core.Map.Type.html#tm_app"><span class="hs-identifier hs-var">tm_app</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581353"><span class="annot"><span class="annottext">TypeMapG (TypeMapG a)
</span><a href="#local-6989586621682581353"><span class="hs-identifier hs-var">tapp</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_tycon :: forall a. TypeMapX a -&gt; DNameEnv a
</span><a href="GHC.Core.Map.Type.html#tm_tycon"><span class="hs-identifier hs-var">tm_tycon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581354"><span class="annot"><span class="annottext">DNameEnv a
</span><a href="#local-6989586621682581354"><span class="hs-identifier hs-var">ttycon</span></a></span></span><span>
</span><span id="line-356"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_forall :: forall a. TypeMapX a -&gt; TypeMapG (BndrMap a)
</span><a href="GHC.Core.Map.Type.html#tm_forall"><span class="hs-identifier hs-var">tm_forall</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581355"><span class="annot"><span class="annottext">TypeMapG (BndrMap a)
</span><a href="#local-6989586621682581355"><span class="hs-identifier hs-var">tforall</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_tylit :: forall a. TypeMapX a -&gt; TyLitMap a
</span><a href="GHC.Core.Map.Type.html#tm_tylit"><span class="hs-identifier hs-var">tm_tylit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581356"><span class="annot"><span class="annottext">TyLitMap a
</span><a href="#local-6989586621682581356"><span class="hs-identifier hs-var">tlit</span></a></span></span><span>
</span><span id="line-357"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_coerce :: forall a. TypeMapX a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#tm_coerce"><span class="hs-identifier hs-var">tm_coerce</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581357"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621682581357"><span class="hs-identifier hs-var">tcoerce</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TM"><span class="hs-identifier hs-type">TM</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tm_var :: VarMap a
</span><a href="GHC.Core.Map.Type.html#tm_var"><span class="hs-identifier hs-var">tm_var</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; VarMap a -&gt; VarMap a
forall a. (a -&gt; Bool) -&gt; VarMap a -&gt; VarMap a
forall (m :: * -&gt; *) a. TrieMap m =&gt; (a -&gt; Bool) -&gt; m a -&gt; m a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var">filterTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581351"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">VarMap a
</span><a href="#local-6989586621682581352"><span class="hs-identifier hs-var">tvar</span></a></span><span>
</span><span id="line-359"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_app :: TypeMapG (TypeMapG a)
</span><a href="GHC.Core.Map.Type.html#tm_app"><span class="hs-identifier hs-var">tm_app</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TypeMapG a -&gt; TypeMapG a)
-&gt; TypeMapG (TypeMapG a) -&gt; TypeMapG (TypeMapG a)
forall a b. (a -&gt; b) -&gt; GenMap TypeMapX a -&gt; GenMap TypeMapX b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; TypeMapG a -&gt; TypeMapG a
forall a. (a -&gt; Bool) -&gt; GenMap TypeMapX a -&gt; GenMap TypeMapX a
forall (m :: * -&gt; *) a. TrieMap m =&gt; (a -&gt; Bool) -&gt; m a -&gt; m a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var">filterTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581351"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMapG (TypeMapG a)
</span><a href="#local-6989586621682581353"><span class="hs-identifier hs-var">tapp</span></a></span><span>
</span><span id="line-360"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_tycon :: DNameEnv a
</span><a href="GHC.Core.Map.Type.html#tm_tycon"><span class="hs-identifier hs-var">tm_tycon</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; DNameEnv a -&gt; DNameEnv a
forall a. (a -&gt; Bool) -&gt; UniqDFM Name a -&gt; UniqDFM Name a
forall (m :: * -&gt; *) a. TrieMap m =&gt; (a -&gt; Bool) -&gt; m a -&gt; m a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var">filterTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581351"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DNameEnv a
</span><a href="#local-6989586621682581354"><span class="hs-identifier hs-var">ttycon</span></a></span><span>
</span><span id="line-361"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_forall :: TypeMapG (BndrMap a)
</span><a href="GHC.Core.Map.Type.html#tm_forall"><span class="hs-identifier hs-var">tm_forall</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BndrMap a -&gt; BndrMap a)
-&gt; TypeMapG (BndrMap a) -&gt; TypeMapG (BndrMap a)
forall a b. (a -&gt; b) -&gt; GenMap TypeMapX a -&gt; GenMap TypeMapX b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; BndrMap a -&gt; BndrMap a
forall a. (a -&gt; Bool) -&gt; BndrMap a -&gt; BndrMap a
forall (m :: * -&gt; *) a. TrieMap m =&gt; (a -&gt; Bool) -&gt; m a -&gt; m a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var">filterTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581351"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMapG (BndrMap a)
</span><a href="#local-6989586621682581355"><span class="hs-identifier hs-var">tforall</span></a></span><span>
</span><span id="line-362"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_tylit :: TyLitMap a
</span><a href="GHC.Core.Map.Type.html#tm_tylit"><span class="hs-identifier hs-var">tm_tylit</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; TyLitMap a -&gt; TyLitMap a
forall a. (a -&gt; Bool) -&gt; TyLitMap a -&gt; TyLitMap a
forall (m :: * -&gt; *) a. TrieMap m =&gt; (a -&gt; Bool) -&gt; m a -&gt; m a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var">filterTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581351"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TyLitMap a
</span><a href="#local-6989586621682581356"><span class="hs-identifier hs-var">tlit</span></a></span><span>
</span><span id="line-363"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm_coerce :: Maybe a
</span><a href="GHC.Core.Map.Type.html#tm_coerce"><span class="hs-identifier hs-var">tm_coerce</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; Maybe a -&gt; Maybe a
forall a. (a -&gt; Bool) -&gt; Maybe a -&gt; Maybe a
</span><a href="GHC.Data.TrieMap.html#filterMaybe"><span class="hs-identifier hs-var">filterMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581351"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621682581357"><span class="hs-identifier hs-var">tcoerce</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="hs-comment">------------------------</span><span>
</span><span id="line-366"></span><span class="hs-keyword">data</span><span> </span><span id="TyLitMap"><span class="annot"><a href="GHC.Core.Map.Type.html#TyLitMap"><span class="hs-identifier hs-var">TyLitMap</span></a></span></span><span> </span><span id="local-6989586621682580688"><span class="annot"><a href="#local-6989586621682580688"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TLM"><span class="annot"><a href="GHC.Core.Map.Type.html#TLM"><span class="hs-identifier hs-var">TLM</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="tlm_number"><span class="annot"><span class="annottext">forall a. TyLitMap a -&gt; Map Integer a
</span><a href="GHC.Core.Map.Type.html#tlm_number"><span class="hs-identifier hs-var hs-var">tlm_number</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="annot"><a href="#local-6989586621682580688"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-367"></span><span>                      </span><span class="hs-special">,</span><span> </span><span id="tlm_string"><span class="annot"><span class="annottext">forall a. TyLitMap a -&gt; UniqFM FastString a
</span><a href="GHC.Core.Map.Type.html#tlm_string"><span class="hs-identifier hs-var hs-var">tlm_string</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.FM.html#UniqFM"><span class="hs-identifier hs-type">UniqFM</span></a></span><span>  </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580688"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-368"></span><span>                      </span><span class="hs-special">,</span><span> </span><span id="tlm_char"><span class="annot"><span class="annottext">forall a. TyLitMap a -&gt; Map Char a
</span><a href="GHC.Core.Map.Type.html#tlm_char"><span class="hs-identifier hs-var hs-var">tlm_char</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="annot"><a href="#local-6989586621682580688"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-369"></span><span>                      </span><span class="hs-special">}</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-comment">-- TODO(22292): derive</span><span>
</span><span id="line-372"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682581365"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-373"></span><span>    </span><span id="local-6989586621682581367"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; TyLitMap a -&gt; TyLitMap b
</span><span class="hs-identifier hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621682581368"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581368"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TLM"><span class="hs-identifier hs-type">TLM</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tlm_number :: forall a. TyLitMap a -&gt; Map Integer a
</span><a href="GHC.Core.Map.Type.html#tlm_number"><span class="hs-identifier hs-var">tlm_number</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581369"><span class="annot"><span class="annottext">Map Integer a
</span><a href="#local-6989586621682581369"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tlm_string :: forall a. TyLitMap a -&gt; UniqFM FastString a
</span><a href="GHC.Core.Map.Type.html#tlm_string"><span class="hs-identifier hs-var">tlm_string</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581370"><span class="annot"><span class="annottext">UniqFM FastString a
</span><a href="#local-6989586621682581370"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tlm_char :: forall a. TyLitMap a -&gt; Map Char a
</span><a href="GHC.Core.Map.Type.html#tlm_char"><span class="hs-identifier hs-var">tlm_char</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581371"><span class="annot"><span class="annottext">Map Char a
</span><a href="#local-6989586621682581371"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TLM"><span class="hs-identifier hs-type">TLM</span></a></span><span>
</span><span id="line-374"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tlm_number :: Map Integer b
</span><a href="GHC.Core.Map.Type.html#tlm_number"><span class="hs-identifier hs-var">tlm_number</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Map Integer a -&gt; Map Integer b
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">Map.map</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581368"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Map Integer a
</span><a href="#local-6989586621682581369"><span class="hs-identifier hs-var">tn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tlm_string :: UniqFM FastString b
</span><a href="GHC.Core.Map.Type.html#tlm_string"><span class="hs-identifier hs-var">tlm_string</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; UniqFM FastString a -&gt; UniqFM FastString b
forall {k} elt1 elt2 (key :: k).
(elt1 -&gt; elt2) -&gt; UniqFM key elt1 -&gt; UniqFM key elt2
</span><a href="GHC.Types.Unique.FM.html#mapUFM"><span class="hs-identifier hs-var">mapUFM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581368"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UniqFM FastString a
</span><a href="#local-6989586621682581370"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tlm_char :: Map Char b
</span><a href="GHC.Core.Map.Type.html#tlm_char"><span class="hs-identifier hs-var">tlm_char</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Map Char a -&gt; Map Char b
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">Map.map</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581368"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Map Char a
</span><a href="#local-6989586621682581371"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-377"></span><span>   </span><span class="hs-keyword">type</span><span> </span><span id="Key"><span class="annot"><a href="GHC.Data.TrieMap.html#Key"><span class="hs-identifier hs-var">Key</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyLit"><span class="hs-identifier hs-type">TyLit</span></a></span><span>
</span><span id="line-378"></span><span>   </span><span id="local-6989586621682581381"><span class="annot"><span class="annottext">emptyTM :: forall a. TyLitMap a
</span><a href="GHC.Data.TrieMap.html#emptyTM"><span class="hs-identifier hs-var hs-var hs-var">emptyTM</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLitMap a
forall a. TyLitMap a
</span><a href="GHC.Core.Map.Type.html#emptyTyLitMap"><span class="hs-identifier hs-var">emptyTyLitMap</span></a></span><span>
</span><span id="line-379"></span><span>   </span><span id="local-6989586621682581382"><span class="annot"><span class="annottext">lookupTM :: forall b. Key TyLitMap -&gt; TyLitMap b -&gt; Maybe b
</span><a href="GHC.Data.TrieMap.html#lookupTM"><span class="hs-identifier hs-var hs-var hs-var">lookupTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; TyLitMap b -&gt; Maybe b
Key TyLitMap -&gt; TyLitMap b -&gt; Maybe b
forall a. TyLit -&gt; TyLitMap a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkTyLit"><span class="hs-identifier hs-var">lkTyLit</span></a></span><span>
</span><span id="line-380"></span><span>   </span><span id="local-6989586621682581383"><span class="annot"><span class="annottext">alterTM :: forall b. Key TyLitMap -&gt; XT b -&gt; TyLitMap b -&gt; TyLitMap b
</span><a href="GHC.Data.TrieMap.html#alterTM"><span class="hs-identifier hs-var hs-var hs-var">alterTM</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; XT b -&gt; TyLitMap b -&gt; TyLitMap b
Key TyLitMap -&gt; XT b -&gt; TyLitMap b -&gt; TyLitMap b
forall a. TyLit -&gt; XT a -&gt; TyLitMap a -&gt; TyLitMap a
</span><a href="GHC.Core.Map.Type.html#xtTyLit"><span class="hs-identifier hs-var">xtTyLit</span></a></span><span>
</span><span id="line-381"></span><span>   </span><span id="local-6989586621682581384"><span class="annot"><span class="annottext">foldTM :: forall a b. (a -&gt; b -&gt; b) -&gt; TyLitMap a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var hs-var hs-var">foldTM</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; TyLitMap a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; TyLitMap a -&gt; b -&gt; b
</span><a href="GHC.Core.Map.Type.html#foldTyLit"><span class="hs-identifier hs-var">foldTyLit</span></a></span><span>
</span><span id="line-382"></span><span>   </span><span id="local-6989586621682581385"><span class="annot"><span class="annottext">filterTM :: forall a. (a -&gt; Bool) -&gt; TyLitMap a -&gt; TyLitMap a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var hs-var hs-var">filterTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; TyLitMap a -&gt; TyLitMap a
forall a. (a -&gt; Bool) -&gt; TyLitMap a -&gt; TyLitMap a
</span><a href="GHC.Core.Map.Type.html#filterTyLit"><span class="hs-identifier hs-var">filterTyLit</span></a></span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span id="local-6989586621682580643"><span class="annot"><a href="GHC.Core.Map.Type.html#emptyTyLitMap"><span class="hs-identifier hs-type">emptyTyLitMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580643"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-385"></span><span id="emptyTyLitMap"><span class="annot"><span class="annottext">emptyTyLitMap :: forall a. TyLitMap a
</span><a href="GHC.Core.Map.Type.html#emptyTyLitMap"><span class="hs-identifier hs-var hs-var">emptyTyLitMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TLM"><span class="hs-identifier hs-type">TLM</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tlm_number :: Map Integer a
</span><a href="GHC.Core.Map.Type.html#tlm_number"><span class="hs-identifier hs-var">tlm_number</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Integer a
forall k a. Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tlm_string :: UniqFM FastString a
</span><a href="GHC.Core.Map.Type.html#tlm_string"><span class="hs-identifier hs-var">tlm_string</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqFM FastString a
forall {k} (key :: k) elt. UniqFM key elt
</span><a href="GHC.Types.Unique.FM.html#emptyUFM"><span class="hs-identifier hs-var">emptyUFM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tlm_char :: Map Char a
</span><a href="GHC.Core.Map.Type.html#tlm_char"><span class="hs-identifier hs-var">tlm_char</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Char a
forall k a. Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span id="local-6989586621682580659"><span class="annot"><a href="GHC.Core.Map.Type.html#lkTyLit"><span class="hs-identifier hs-type">lkTyLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyLit"><span class="hs-identifier hs-type">TyLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580659"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682580659"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-388"></span><span id="lkTyLit"><span class="annot"><span class="annottext">lkTyLit :: forall a. TyLit -&gt; TyLitMap a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkTyLit"><span class="hs-identifier hs-var hs-var">lkTyLit</span></a></span></span><span> </span><span id="local-6989586621682581395"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682581395"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682581395"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-390"></span><span>    </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#NumTyLit"><span class="hs-identifier hs-type">NumTyLit</span></a></span><span> </span><span id="local-6989586621682581397"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682581397"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyLitMap a -&gt; Map Integer a
forall a. TyLitMap a -&gt; Map Integer a
</span><a href="GHC.Core.Map.Type.html#tlm_number"><span class="hs-identifier hs-var">tlm_number</span></a></span><span> </span><span class="annot"><span class="annottext">(TyLitMap a -&gt; Map Integer a)
-&gt; (Map Integer a -&gt; Maybe a) -&gt; TyLitMap a -&gt; Maybe a
forall a b c. (a -&gt; b) -&gt; (b -&gt; c) -&gt; a -&gt; c
</span><a href="GHC.Data.TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Map Integer a -&gt; Maybe a
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682581397"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#StrTyLit"><span class="hs-identifier hs-type">StrTyLit</span></a></span><span> </span><span id="local-6989586621682581400"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682581400"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyLitMap a -&gt; UniqFM FastString a
forall a. TyLitMap a -&gt; UniqFM FastString a
</span><a href="GHC.Core.Map.Type.html#tlm_string"><span class="hs-identifier hs-var">tlm_string</span></a></span><span> </span><span class="annot"><span class="annottext">(TyLitMap a -&gt; UniqFM FastString a)
-&gt; (UniqFM FastString a -&gt; Maybe a) -&gt; TyLitMap a -&gt; Maybe a
forall a b c. (a -&gt; b) -&gt; (b -&gt; c) -&gt; a -&gt; c
</span><a href="GHC.Data.TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqFM FastString a -&gt; FastString -&gt; Maybe a
forall key elt. Uniquable key =&gt; UniqFM key elt -&gt; key -&gt; Maybe elt
</span><a href="GHC.Types.Unique.FM.html#lookupUFM"><span class="hs-operator hs-var">`lookupUFM`</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682581400"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>    </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CharTyLit"><span class="hs-identifier hs-type">CharTyLit</span></a></span><span> </span><span id="local-6989586621682581403"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682581403"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyLitMap a -&gt; Map Char a
forall a. TyLitMap a -&gt; Map Char a
</span><a href="GHC.Core.Map.Type.html#tlm_char"><span class="hs-identifier hs-var">tlm_char</span></a></span><span> </span><span class="annot"><span class="annottext">(TyLitMap a -&gt; Map Char a)
-&gt; (Map Char a -&gt; Maybe a) -&gt; TyLitMap a -&gt; Maybe a
forall a b c. (a -&gt; b) -&gt; (b -&gt; c) -&gt; a -&gt; c
</span><a href="GHC.Data.TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Map Char a -&gt; Maybe a
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682581403"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span id="local-6989586621682580673"><span class="annot"><a href="GHC.Core.Map.Type.html#xtTyLit"><span class="hs-identifier hs-type">xtTyLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyLit"><span class="hs-identifier hs-type">TyLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580673"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580673"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580673"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-395"></span><span id="xtTyLit"><span class="annot"><span class="annottext">xtTyLit :: forall a. TyLit -&gt; XT a -&gt; TyLitMap a -&gt; TyLitMap a
</span><a href="GHC.Core.Map.Type.html#xtTyLit"><span class="hs-identifier hs-var hs-var">xtTyLit</span></a></span></span><span> </span><span id="local-6989586621682581407"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682581407"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682581408"><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581408"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682581409"><span class="annot"><span class="annottext">TyLitMap a
</span><a href="#local-6989586621682581409"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682581407"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-397"></span><span>    </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#NumTyLit"><span class="hs-identifier hs-type">NumTyLit</span></a></span><span> </span><span id="local-6989586621682581410"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682581410"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">TyLitMap a
</span><a href="#local-6989586621682581409"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#tlm_number"><span class="hs-identifier hs-var">tlm_number</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#alter"><span class="hs-identifier hs-type">Map.alter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581408"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581410"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#tlm_number"><span class="hs-identifier hs-var">tlm_number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581409"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-398"></span><span>    </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#StrTyLit"><span class="hs-identifier hs-type">StrTyLit</span></a></span><span> </span><span id="local-6989586621682581412"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682581412"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">TyLitMap a
</span><a href="#local-6989586621682581409"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#tlm_string"><span class="hs-identifier hs-var">tlm_string</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Unique.FM.html#alterUFM"><span class="hs-identifier hs-type">alterUFM</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621682581408"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#tlm_string"><span class="hs-identifier hs-var">tlm_string</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581409"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682581412"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-399"></span><span>    </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CharTyLit"><span class="hs-identifier hs-type">CharTyLit</span></a></span><span> </span><span id="local-6989586621682581414"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682581414"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyLitMap a
</span><a href="#local-6989586621682581409"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#tlm_char"><span class="hs-identifier hs-var">tlm_char</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#alter"><span class="hs-identifier hs-type">Map.alter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581408"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581414"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#tlm_char"><span class="hs-identifier hs-var">tlm_char</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581409"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span id="local-6989586621682580682"><span id="local-6989586621682580683"><span class="annot"><a href="GHC.Core.Map.Type.html#foldTyLit"><span class="hs-identifier hs-type">foldTyLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682580682"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580683"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580683"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580682"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580683"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580683"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-402"></span><span id="foldTyLit"><span class="annot"><span class="annottext">foldTyLit :: forall a b. (a -&gt; b -&gt; b) -&gt; TyLitMap a -&gt; b -&gt; b
</span><a href="GHC.Core.Map.Type.html#foldTyLit"><span class="hs-identifier hs-var hs-var">foldTyLit</span></a></span></span><span> </span><span id="local-6989586621682581415"><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581415"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682581416"><span class="annot"><span class="annottext">TyLitMap a
</span><a href="#local-6989586621682581416"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b -&gt; UniqFM FastString a -&gt; b) -&gt; UniqFM FastString a -&gt; b -&gt; b
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; b -&gt; UniqFM FastString a -&gt; b
forall {k} elt a (key :: k).
(elt -&gt; a -&gt; a) -&gt; a -&gt; UniqFM key elt -&gt; a
</span><a href="GHC.Types.Unique.FM.html#nonDetFoldUFM"><span class="hs-identifier hs-var">nonDetFoldUFM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581415"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyLitMap a -&gt; UniqFM FastString a
forall a. TyLitMap a -&gt; UniqFM FastString a
</span><a href="GHC.Core.Map.Type.html#tlm_string"><span class="hs-identifier hs-var">tlm_string</span></a></span><span> </span><span class="annot"><span class="annottext">TyLitMap a
</span><a href="#local-6989586621682581416"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>              </span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; (b -&gt; b) -&gt; b -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Map Integer a -&gt; b) -&gt; Map Integer a -&gt; b -&gt; b
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; b -&gt; Map Integer a -&gt; b
forall a b k. (a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#foldr"><span class="hs-identifier hs-var">Map.foldr</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581415"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyLitMap a -&gt; Map Integer a
forall a. TyLitMap a -&gt; Map Integer a
</span><a href="GHC.Core.Map.Type.html#tlm_number"><span class="hs-identifier hs-var">tlm_number</span></a></span><span> </span><span class="annot"><span class="annottext">TyLitMap a
</span><a href="#local-6989586621682581416"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>              </span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; (b -&gt; b) -&gt; b -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Map Char a -&gt; b) -&gt; Map Char a -&gt; b -&gt; b
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; b -&gt; Map Char a -&gt; b
forall a b k. (a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#foldr"><span class="hs-identifier hs-var">Map.foldr</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581415"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyLitMap a -&gt; Map Char a
forall a. TyLitMap a -&gt; Map Char a
</span><a href="GHC.Core.Map.Type.html#tlm_char"><span class="hs-identifier hs-var">tlm_char</span></a></span><span> </span><span class="annot"><span class="annottext">TyLitMap a
</span><a href="#local-6989586621682581416"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span id="local-6989586621682581420"><span class="annot"><a href="GHC.Core.Map.Type.html#filterTyLit"><span class="hs-identifier hs-type">filterTyLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682581420"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581420"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TyLitMap"><span class="hs-identifier hs-type">TyLitMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581420"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-407"></span><span id="filterTyLit"><span class="annot"><span class="annottext">filterTyLit :: forall a. (a -&gt; Bool) -&gt; TyLitMap a -&gt; TyLitMap a
</span><a href="GHC.Core.Map.Type.html#filterTyLit"><span class="hs-identifier hs-var hs-var">filterTyLit</span></a></span></span><span> </span><span id="local-6989586621682581421"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581421"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#TLM"><span class="hs-identifier hs-type">TLM</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tlm_number :: forall a. TyLitMap a -&gt; Map Integer a
</span><a href="GHC.Core.Map.Type.html#tlm_number"><span class="hs-identifier hs-var">tlm_number</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581422"><span class="annot"><span class="annottext">Map Integer a
</span><a href="#local-6989586621682581422"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tlm_string :: forall a. TyLitMap a -&gt; UniqFM FastString a
</span><a href="GHC.Core.Map.Type.html#tlm_string"><span class="hs-identifier hs-var">tlm_string</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581423"><span class="annot"><span class="annottext">UniqFM FastString a
</span><a href="#local-6989586621682581423"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tlm_char :: forall a. TyLitMap a -&gt; Map Char a
</span><a href="GHC.Core.Map.Type.html#tlm_char"><span class="hs-identifier hs-var">tlm_char</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581424"><span class="annot"><span class="annottext">Map Char a
</span><a href="#local-6989586621682581424"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TLM"><span class="hs-identifier hs-type">TLM</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tlm_number :: Map Integer a
</span><a href="GHC.Core.Map.Type.html#tlm_number"><span class="hs-identifier hs-var">tlm_number</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; Map Integer a -&gt; Map Integer a
forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#filter"><span class="hs-identifier hs-var">Map.filter</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581421"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Map Integer a
</span><a href="#local-6989586621682581422"><span class="hs-identifier hs-var">tn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tlm_string :: UniqFM FastString a
</span><a href="GHC.Core.Map.Type.html#tlm_string"><span class="hs-identifier hs-var">tlm_string</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; UniqFM FastString a -&gt; UniqFM FastString a
forall {k} elt (key :: k).
(elt -&gt; Bool) -&gt; UniqFM key elt -&gt; UniqFM key elt
</span><a href="GHC.Types.Unique.FM.html#filterUFM"><span class="hs-identifier hs-var">filterUFM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581421"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UniqFM FastString a
</span><a href="#local-6989586621682581423"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tlm_char :: Map Char a
</span><a href="GHC.Core.Map.Type.html#tlm_char"><span class="hs-identifier hs-var">tlm_char</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; Map Char a -&gt; Map Char a
forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#filter"><span class="hs-identifier hs-var">Map.filter</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581421"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Map Char a
</span><a href="#local-6989586621682581424"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="hs-comment">-------------------------------------------------</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- | @TypeMap a@ is a map from 'Type' to @a@.  If you are a client, this</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- is the type you want. The keys in this map may have different kinds.</span><span>
</span><span id="line-413"></span><span class="hs-keyword">newtype</span><span> </span><span id="TypeMap"><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-var">TypeMap</span></a></span></span><span> </span><span id="local-6989586621682580748"><span class="annot"><a href="#local-6989586621682580748"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TypeMap"><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-var">TypeMap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580748"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-comment">-- TODO(22292): derive</span><span>
</span><span id="line-416"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682581429"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-417"></span><span>    </span><span id="local-6989586621682581435"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; TypeMap a -&gt; TypeMap b
</span><span class="hs-identifier hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621682581436"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581436"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span id="local-6989586621682581437"><span class="annot"><span class="annottext">TypeMapG (TypeMapG a)
</span><a href="#local-6989586621682581437"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeMapG (TypeMapG b) -&gt; TypeMap b
forall a. TypeMapG (TypeMapG a) -&gt; TypeMap a
</span><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-var">TypeMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TypeMapG a -&gt; TypeMapG b)
-&gt; TypeMapG (TypeMapG a) -&gt; TypeMapG (TypeMapG b)
forall a b. (a -&gt; b) -&gt; GenMap TypeMapX a -&gt; GenMap TypeMapX b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; TypeMapG a -&gt; TypeMapG b
forall a b. (a -&gt; b) -&gt; GenMap TypeMapX a -&gt; GenMap TypeMapX b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581436"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMapG (TypeMapG a)
</span><a href="#local-6989586621682581437"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">fmap</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span id="local-6989586621682580749"><span class="annot"><a href="GHC.Core.Map.Type.html#lkTT"><span class="hs-identifier hs-type">lkTT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580749"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682580749"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-421"></span><span id="lkTT"><span class="annot"><span class="annottext">lkTT :: forall a. DeBruijn Type -&gt; TypeMap a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkTT"><span class="hs-identifier hs-var hs-var">lkTT</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581446"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581446"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682581447"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581447"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span id="local-6989586621682581448"><span class="annot"><span class="annottext">TypeMapG (TypeMapG a)
</span><a href="#local-6989586621682581448"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key TypeMapX -&gt; TypeMapG (TypeMapG a) -&gt; Maybe (TypeMapG a)
forall (m :: * -&gt; *) a.
(Eq (Key m), TrieMap m) =&gt;
Key m -&gt; GenMap m a -&gt; Maybe a
</span><a href="GHC.Data.TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581446"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; DeBruijn Type) -&gt; Type -&gt; DeBruijn Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581447"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMapG (TypeMapG a)
</span><a href="#local-6989586621682581448"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-422"></span><span>                          </span><span class="annot"><span class="annottext">Maybe (TypeMapG a) -&gt; (TypeMapG a -&gt; Maybe a) -&gt; Maybe a
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Key TypeMapX -&gt; TypeMapG a -&gt; Maybe a
forall (m :: * -&gt; *) a.
(Eq (Key m), TrieMap m) =&gt;
Key m -&gt; GenMap m a -&gt; Maybe a
</span><a href="GHC.Data.TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581446"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581447"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span id="local-6989586621682580754"><span class="annot"><a href="GHC.Core.Map.Type.html#xtTT"><span class="hs-identifier hs-type">xtTT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580754"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580754"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580754"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-425"></span><span id="xtTT"><span class="annot"><span class="annottext">xtTT :: forall a. DeBruijn Type -&gt; XT a -&gt; TypeMap a -&gt; TypeMap a
</span><a href="GHC.Core.Map.Type.html#xtTT"><span class="hs-identifier hs-var hs-var">xtTT</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581459"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581459"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682581460"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581460"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682581461"><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581461"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span id="local-6989586621682581462"><span class="annot"><span class="annottext">TypeMapG (TypeMapG a)
</span><a href="#local-6989586621682581462"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapG (TypeMapG a) -&gt; TypeMap a
forall a. TypeMapG (TypeMapG a) -&gt; TypeMap a
</span><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-var">TypeMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeMapG (TypeMapG a)
</span><a href="#local-6989586621682581462"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapG (TypeMapG a)
-&gt; (TypeMapG (TypeMapG a) -&gt; TypeMapG (TypeMapG a))
-&gt; TypeMapG (TypeMapG a)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="GHC.Data.TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Key TypeMapX
-&gt; XT (TypeMapG a)
-&gt; TypeMapG (TypeMapG a)
-&gt; TypeMapG (TypeMapG a)
forall (m :: * -&gt; *) a.
(Eq (Key m), TrieMap m) =&gt;
Key m -&gt; XT a -&gt; GenMap m a -&gt; GenMap m a
</span><a href="GHC.Data.TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581459"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; DeBruijn Type) -&gt; Type -&gt; DeBruijn Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581460"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>               </span><span class="annot"><span class="annottext">(XT (TypeMapG a) -&gt; TypeMapG (TypeMapG a) -&gt; TypeMapG (TypeMapG a))
-&gt; (TypeMapG a -&gt; TypeMapG a)
-&gt; TypeMapG (TypeMapG a)
-&gt; TypeMapG (TypeMapG a)
forall (m2 :: * -&gt; *) a (m1 :: * -&gt; *).
TrieMap m2 =&gt;
(XT (m2 a) -&gt; m1 (m2 a) -&gt; m1 (m2 a))
-&gt; (m2 a -&gt; m2 a) -&gt; m1 (m2 a) -&gt; m1 (m2 a)
</span><a href="GHC.Data.TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Key TypeMapX -&gt; XT a -&gt; TypeMapG a -&gt; TypeMapG a
forall (m :: * -&gt; *) a.
(Eq (Key m), TrieMap m) =&gt;
Key m -&gt; XT a -&gt; GenMap m a -&gt; GenMap m a
</span><a href="GHC.Data.TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581459"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581460"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581461"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="hs-comment">-- Below are some client-oriented functions which operate on 'TypeMap'.</span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-432"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Key"><span class="annot"><a href="GHC.Data.TrieMap.html#Key"><span class="hs-identifier hs-var">Key</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-433"></span><span>    </span><span id="local-6989586621682581475"><span class="annot"><span class="annottext">emptyTM :: forall a. TypeMap a
</span><a href="GHC.Data.TrieMap.html#emptyTM"><span class="hs-identifier hs-var hs-var hs-var">emptyTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapG (TypeMapG a) -&gt; TypeMap a
forall a. TypeMapG (TypeMapG a) -&gt; TypeMap a
</span><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-var">TypeMap</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapG (TypeMapG a)
forall a. GenMap TypeMapX a
forall (m :: * -&gt; *) a. TrieMap m =&gt; m a
</span><a href="GHC.Data.TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a></span><span>
</span><span id="line-434"></span><span>    </span><span id="local-6989586621682581476"><span class="annot"><span class="annottext">lookupTM :: forall b. Key TypeMap -&gt; TypeMap b -&gt; Maybe b
</span><a href="GHC.Data.TrieMap.html#lookupTM"><span class="hs-identifier hs-var hs-var hs-var">lookupTM</span></a></span></span><span> </span><span id="local-6989586621682581477"><span class="annot"><span class="annottext">Key TypeMap
</span><a href="#local-6989586621682581477"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621682581478"><span class="annot"><span class="annottext">TypeMap b
</span><a href="#local-6989586621682581478"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; TypeMap b -&gt; Maybe b
forall a. DeBruijn Type -&gt; TypeMap a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkTT"><span class="hs-identifier hs-var">lkTT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; DeBruijn Type
forall a. a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#deBruijnize"><span class="hs-identifier hs-var">deBruijnize</span></a></span><span> </span><span class="annot"><span class="annottext">Type
Key TypeMap
</span><a href="#local-6989586621682581477"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMap b
</span><a href="#local-6989586621682581478"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-435"></span><span>    </span><span id="local-6989586621682581479"><span class="annot"><span class="annottext">alterTM :: forall b. Key TypeMap -&gt; XT b -&gt; TypeMap b -&gt; TypeMap b
</span><a href="GHC.Data.TrieMap.html#alterTM"><span class="hs-identifier hs-var hs-var hs-var">alterTM</span></a></span></span><span> </span><span id="local-6989586621682581480"><span class="annot"><span class="annottext">Key TypeMap
</span><a href="#local-6989586621682581480"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621682581481"><span class="annot"><span class="annottext">XT b
</span><a href="#local-6989586621682581481"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682581482"><span class="annot"><span class="annottext">TypeMap b
</span><a href="#local-6989586621682581482"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; XT b -&gt; TypeMap b -&gt; TypeMap b
forall a. DeBruijn Type -&gt; XT a -&gt; TypeMap a -&gt; TypeMap a
</span><a href="GHC.Core.Map.Type.html#xtTT"><span class="hs-identifier hs-var">xtTT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; DeBruijn Type
forall a. a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#deBruijnize"><span class="hs-identifier hs-var">deBruijnize</span></a></span><span> </span><span class="annot"><span class="annottext">Type
Key TypeMap
</span><a href="#local-6989586621682581480"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XT b
</span><a href="#local-6989586621682581481"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMap b
</span><a href="#local-6989586621682581482"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-436"></span><span>    </span><span id="local-6989586621682581488"><span class="annot"><span class="annottext">foldTM :: forall a b. (a -&gt; b -&gt; b) -&gt; TypeMap a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var hs-var hs-var">foldTM</span></a></span></span><span> </span><span id="local-6989586621682581489"><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581489"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span id="local-6989586621682581490"><span class="annot"><span class="annottext">TypeMapG (TypeMapG a)
</span><a href="#local-6989586621682581490"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TypeMapG a -&gt; b -&gt; b) -&gt; TypeMapG (TypeMapG a) -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; GenMap TypeMapX a -&gt; b -&gt; b
forall (m :: * -&gt; *) a b.
TrieMap m =&gt;
(a -&gt; b -&gt; b) -&gt; m a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; TypeMapG a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; GenMap TypeMapX a -&gt; b -&gt; b
forall (m :: * -&gt; *) a b.
TrieMap m =&gt;
(a -&gt; b -&gt; b) -&gt; m a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581489"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMapG (TypeMapG a)
</span><a href="#local-6989586621682581490"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-437"></span><span>    </span><span id="local-6989586621682581497"><span class="annot"><span class="annottext">filterTM :: forall a. (a -&gt; Bool) -&gt; TypeMap a -&gt; TypeMap a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var hs-var hs-var">filterTM</span></a></span></span><span> </span><span id="local-6989586621682581498"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581498"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span id="local-6989586621682581499"><span class="annot"><span class="annottext">TypeMapG (TypeMapG a)
</span><a href="#local-6989586621682581499"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapG (TypeMapG a) -&gt; TypeMap a
forall a. TypeMapG (TypeMapG a) -&gt; TypeMap a
</span><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-var">TypeMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TypeMapG a -&gt; TypeMapG a)
-&gt; TypeMapG (TypeMapG a) -&gt; TypeMapG (TypeMapG a)
forall a b. (a -&gt; b) -&gt; GenMap TypeMapX a -&gt; GenMap TypeMapX b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; TypeMapG a -&gt; TypeMapG a
forall a. (a -&gt; Bool) -&gt; GenMap TypeMapX a -&gt; GenMap TypeMapX a
forall (m :: * -&gt; *) a. TrieMap m =&gt; (a -&gt; Bool) -&gt; m a -&gt; m a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var">filterTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581498"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMapG (TypeMapG a)
</span><a href="#local-6989586621682581499"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span id="local-6989586621682580762"><span id="local-6989586621682580763"><span class="annot"><a href="GHC.Core.Map.Type.html#foldTypeMap"><span class="hs-identifier hs-type">foldTypeMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682580762"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580763"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580763"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580763"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580762"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580763"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-440"></span><span id="foldTypeMap"><span class="annot"><span class="annottext">foldTypeMap :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; TypeMap a -&gt; b
</span><a href="GHC.Core.Map.Type.html#foldTypeMap"><span class="hs-identifier hs-var hs-var">foldTypeMap</span></a></span></span><span> </span><span id="local-6989586621682581501"><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581501"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621682581502"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682581502"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621682581503"><span class="annot"><span class="annottext">TypeMap a
</span><a href="#local-6989586621682581503"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; TypeMap a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; TypeMap a -&gt; b -&gt; b
forall (m :: * -&gt; *) a b.
TrieMap m =&gt;
(a -&gt; b -&gt; b) -&gt; m a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581501"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMap a
</span><a href="#local-6989586621682581503"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682581502"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span id="local-6989586621682581504"><span class="annot"><a href="GHC.Core.Map.Type.html#emptyTypeMap"><span class="hs-identifier hs-type">emptyTypeMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581504"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-443"></span><span id="emptyTypeMap"><span class="annot"><span class="annottext">emptyTypeMap :: forall a. TypeMap a
</span><a href="GHC.Core.Map.Type.html#emptyTypeMap"><span class="hs-identifier hs-var hs-var">emptyTypeMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMap a
forall a. TypeMap a
forall (m :: * -&gt; *) a. TrieMap m =&gt; m a
</span><a href="GHC.Data.TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span id="local-6989586621682580767"><span class="annot"><a href="GHC.Core.Map.Type.html#lookupTypeMap"><span class="hs-identifier hs-type">lookupTypeMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580767"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682580767"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-446"></span><span id="lookupTypeMap"><span class="annot"><span class="annottext">lookupTypeMap :: forall a. TypeMap a -&gt; Type -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lookupTypeMap"><span class="hs-identifier hs-var hs-var">lookupTypeMap</span></a></span></span><span> </span><span id="local-6989586621682581507"><span class="annot"><span class="annottext">TypeMap a
</span><a href="#local-6989586621682581507"><span class="hs-identifier hs-var">cm</span></a></span></span><span> </span><span id="local-6989586621682581508"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581508"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key TypeMap -&gt; TypeMap a -&gt; Maybe a
forall b. Key TypeMap -&gt; TypeMap b -&gt; Maybe b
forall (m :: * -&gt; *) b. TrieMap m =&gt; Key m -&gt; m b -&gt; Maybe b
</span><a href="GHC.Data.TrieMap.html#lookupTM"><span class="hs-identifier hs-var">lookupTM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
Key TypeMap
</span><a href="#local-6989586621682581508"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMap a
</span><a href="#local-6989586621682581507"><span class="hs-identifier hs-var">cm</span></a></span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span id="local-6989586621682580769"><span class="annot"><a href="GHC.Core.Map.Type.html#extendTypeMap"><span class="hs-identifier hs-type">extendTypeMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580769"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580769"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580769"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-449"></span><span id="extendTypeMap"><span class="annot"><span class="annottext">extendTypeMap :: forall a. TypeMap a -&gt; Type -&gt; a -&gt; TypeMap a
</span><a href="GHC.Core.Map.Type.html#extendTypeMap"><span class="hs-identifier hs-var hs-var">extendTypeMap</span></a></span></span><span> </span><span id="local-6989586621682581510"><span class="annot"><span class="annottext">TypeMap a
</span><a href="#local-6989586621682581510"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682581511"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581511"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621682581512"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682581512"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key TypeMap -&gt; XT a -&gt; TypeMap a -&gt; TypeMap a
forall b. Key TypeMap -&gt; XT b -&gt; TypeMap b -&gt; TypeMap b
forall (m :: * -&gt; *) b. TrieMap m =&gt; Key m -&gt; XT b -&gt; m b -&gt; m b
</span><a href="GHC.Data.TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
Key TypeMap
</span><a href="#local-6989586621682581511"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a -&gt; XT a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682581512"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMap a
</span><a href="#local-6989586621682581510"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span id="local-6989586621682580773"><span class="annot"><a href="GHC.Core.Map.Type.html#lookupTypeMapWithScope"><span class="hs-identifier hs-type">lookupTypeMapWithScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580773"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682580773"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-452"></span><span id="lookupTypeMapWithScope"><span class="annot"><span class="annottext">lookupTypeMapWithScope :: forall a. TypeMap a -&gt; CmEnv -&gt; Type -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lookupTypeMapWithScope"><span class="hs-identifier hs-var hs-var">lookupTypeMapWithScope</span></a></span></span><span> </span><span id="local-6989586621682581514"><span class="annot"><span class="annottext">TypeMap a
</span><a href="#local-6989586621682581514"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682581515"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581515"><span class="hs-identifier hs-var">cm</span></a></span></span><span> </span><span id="local-6989586621682581516"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581516"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; TypeMap a -&gt; Maybe a
forall a. DeBruijn Type -&gt; TypeMap a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkTT"><span class="hs-identifier hs-var">lkTT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581515"><span class="hs-identifier hs-var">cm</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581516"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMap a
</span><a href="#local-6989586621682581514"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="hs-comment">-- | Extend a 'TypeMap' with a type in the given context.</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- @extendTypeMapWithScope m (mkDeBruijnContext [a,b,c]) t v@ is equivalent to</span><span>
</span><span id="line-456"></span><span class="hs-comment">-- @extendTypeMap m (forall a b c. t) v@, but allows reuse of the context over</span><span>
</span><span id="line-457"></span><span class="hs-comment">-- multiple insertions.</span><span>
</span><span id="line-458"></span><span id="local-6989586621682580775"><span class="annot"><a href="GHC.Core.Map.Type.html#extendTypeMapWithScope"><span class="hs-identifier hs-type">extendTypeMapWithScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580775"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580775"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMap"><span class="hs-identifier hs-type">TypeMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580775"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-459"></span><span id="extendTypeMapWithScope"><span class="annot"><span class="annottext">extendTypeMapWithScope :: forall a. TypeMap a -&gt; CmEnv -&gt; Type -&gt; a -&gt; TypeMap a
</span><a href="GHC.Core.Map.Type.html#extendTypeMapWithScope"><span class="hs-identifier hs-var hs-var">extendTypeMapWithScope</span></a></span></span><span> </span><span id="local-6989586621682581517"><span class="annot"><span class="annottext">TypeMap a
</span><a href="#local-6989586621682581517"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682581518"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581518"><span class="hs-identifier hs-var">cm</span></a></span></span><span> </span><span id="local-6989586621682581519"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581519"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621682581520"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682581520"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeBruijn Type -&gt; XT a -&gt; TypeMap a -&gt; TypeMap a
forall a. DeBruijn Type -&gt; XT a -&gt; TypeMap a -&gt; TypeMap a
</span><a href="GHC.Core.Map.Type.html#xtTT"><span class="hs-identifier hs-var">xtTT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581518"><span class="hs-identifier hs-var">cm</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682581519"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a -&gt; XT a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682581520"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMap a
</span><a href="#local-6989586621682581517"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span class="hs-comment">-- | Construct a deBruijn environment with the given variables in scope.</span><span>
</span><span id="line-462"></span><span class="hs-comment">-- e.g. @mkDeBruijnEnv [a,b,c]@ constructs a context @forall a b c.@</span><span>
</span><span id="line-463"></span><span class="annot"><a href="GHC.Core.Map.Type.html#mkDeBruijnContext"><span class="hs-identifier hs-type">mkDeBruijnContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a></span><span>
</span><span id="line-464"></span><span id="mkDeBruijnContext"><span class="annot"><span class="annottext">mkDeBruijnContext :: [Var] -&gt; CmEnv
</span><a href="GHC.Core.Map.Type.html#mkDeBruijnContext"><span class="hs-identifier hs-var hs-var">mkDeBruijnContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; [Var] -&gt; CmEnv
</span><a href="GHC.Core.Map.Type.html#extendCMEs"><span class="hs-identifier hs-var">extendCMEs</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="GHC.Core.Map.Type.html#emptyCME"><span class="hs-identifier hs-var">emptyCME</span></a></span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="hs-comment">-- | A 'LooseTypeMap' doesn't do a kind-check. Thus, when lookup up (t |&gt; g),</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- you'll find entries inserted under (t), even if (g) is non-reflexive.</span><span>
</span><span id="line-468"></span><span class="hs-keyword">newtype</span><span> </span><span id="LooseTypeMap"><span class="annot"><a href="GHC.Core.Map.Type.html#LooseTypeMap"><span class="hs-identifier hs-var">LooseTypeMap</span></a></span></span><span> </span><span id="local-6989586621682580780"><span class="annot"><a href="#local-6989586621682580780"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LooseTypeMap"><span class="annot"><a href="GHC.Core.Map.Type.html#LooseTypeMap"><span class="hs-identifier hs-var">LooseTypeMap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580780"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="hs-comment">-- TODO(22292): derive</span><span>
</span><span id="line-471"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682581524"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#LooseTypeMap"><span class="hs-identifier hs-type">LooseTypeMap</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-472"></span><span>    </span><span id="local-6989586621682581529"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; LooseTypeMap a -&gt; LooseTypeMap b
</span><span class="hs-identifier hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621682581530"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581530"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#LooseTypeMap"><span class="hs-identifier hs-type">LooseTypeMap</span></a></span><span> </span><span id="local-6989586621682581531"><span class="annot"><span class="annottext">TypeMapG a
</span><a href="#local-6989586621682581531"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeMapG b -&gt; LooseTypeMap b
forall a. TypeMapG a -&gt; LooseTypeMap a
</span><a href="GHC.Core.Map.Type.html#LooseTypeMap"><span class="hs-identifier hs-var">LooseTypeMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; TypeMapG a -&gt; TypeMapG b
forall a b. (a -&gt; b) -&gt; GenMap TypeMapX a -&gt; GenMap TypeMapX b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581530"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapG a
</span><a href="#local-6989586621682581531"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">fmap</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#LooseTypeMap"><span class="hs-identifier hs-type">LooseTypeMap</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Key"><span class="annot"><a href="GHC.Data.TrieMap.html#Key"><span class="hs-identifier hs-var">Key</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#LooseTypeMap"><span class="hs-identifier hs-type">LooseTypeMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-477"></span><span>  </span><span id="local-6989586621682581544"><span class="annot"><span class="annottext">emptyTM :: forall a. LooseTypeMap a
</span><a href="GHC.Data.TrieMap.html#emptyTM"><span class="hs-identifier hs-var hs-var hs-var">emptyTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapG a -&gt; LooseTypeMap a
forall a. TypeMapG a -&gt; LooseTypeMap a
</span><a href="GHC.Core.Map.Type.html#LooseTypeMap"><span class="hs-identifier hs-var">LooseTypeMap</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapG a
forall a. GenMap TypeMapX a
forall (m :: * -&gt; *) a. TrieMap m =&gt; m a
</span><a href="GHC.Data.TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a></span><span>
</span><span id="line-478"></span><span>  </span><span id="local-6989586621682581549"><span class="annot"><span class="annottext">lookupTM :: forall b. Key LooseTypeMap -&gt; LooseTypeMap b -&gt; Maybe b
</span><a href="GHC.Data.TrieMap.html#lookupTM"><span class="hs-identifier hs-var hs-var hs-var">lookupTM</span></a></span></span><span> </span><span id="local-6989586621682581550"><span class="annot"><span class="annottext">Key LooseTypeMap
</span><a href="#local-6989586621682581550"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#LooseTypeMap"><span class="hs-identifier hs-type">LooseTypeMap</span></a></span><span> </span><span id="local-6989586621682581551"><span class="annot"><span class="annottext">TypeMapG b
</span><a href="#local-6989586621682581551"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key (GenMap TypeMapX) -&gt; TypeMapG b -&gt; Maybe b
forall b. Key (GenMap TypeMapX) -&gt; GenMap TypeMapX b -&gt; Maybe b
forall (m :: * -&gt; *) b. TrieMap m =&gt; Key m -&gt; m b -&gt; Maybe b
</span><a href="GHC.Data.TrieMap.html#lookupTM"><span class="hs-identifier hs-var">lookupTM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; DeBruijn Type
forall a. a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#deBruijnize"><span class="hs-identifier hs-var">deBruijnize</span></a></span><span> </span><span class="annot"><span class="annottext">Type
Key LooseTypeMap
</span><a href="#local-6989586621682581550"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMapG b
</span><a href="#local-6989586621682581551"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-479"></span><span>  </span><span id="local-6989586621682581556"><span class="annot"><span class="annottext">alterTM :: forall b.
Key LooseTypeMap -&gt; XT b -&gt; LooseTypeMap b -&gt; LooseTypeMap b
</span><a href="GHC.Data.TrieMap.html#alterTM"><span class="hs-identifier hs-var hs-var hs-var">alterTM</span></a></span></span><span> </span><span id="local-6989586621682581557"><span class="annot"><span class="annottext">Key LooseTypeMap
</span><a href="#local-6989586621682581557"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621682581558"><span class="annot"><span class="annottext">XT b
</span><a href="#local-6989586621682581558"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#LooseTypeMap"><span class="hs-identifier hs-type">LooseTypeMap</span></a></span><span> </span><span id="local-6989586621682581559"><span class="annot"><span class="annottext">TypeMapG b
</span><a href="#local-6989586621682581559"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapG b -&gt; LooseTypeMap b
forall a. TypeMapG a -&gt; LooseTypeMap a
</span><a href="GHC.Core.Map.Type.html#LooseTypeMap"><span class="hs-identifier hs-var">LooseTypeMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key (GenMap TypeMapX) -&gt; XT b -&gt; TypeMapG b -&gt; TypeMapG b
forall b.
Key (GenMap TypeMapX)
-&gt; XT b -&gt; GenMap TypeMapX b -&gt; GenMap TypeMapX b
forall (m :: * -&gt; *) b. TrieMap m =&gt; Key m -&gt; XT b -&gt; m b -&gt; m b
</span><a href="GHC.Data.TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; DeBruijn Type
forall a. a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#deBruijnize"><span class="hs-identifier hs-var">deBruijnize</span></a></span><span> </span><span class="annot"><span class="annottext">Type
Key LooseTypeMap
</span><a href="#local-6989586621682581557"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XT b
</span><a href="#local-6989586621682581558"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapG b
</span><a href="#local-6989586621682581559"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>  </span><span id="local-6989586621682581564"><span class="annot"><span class="annottext">foldTM :: forall a b. (a -&gt; b -&gt; b) -&gt; LooseTypeMap a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var hs-var hs-var">foldTM</span></a></span></span><span> </span><span id="local-6989586621682581565"><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581565"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#LooseTypeMap"><span class="hs-identifier hs-type">LooseTypeMap</span></a></span><span> </span><span id="local-6989586621682581566"><span class="annot"><span class="annottext">TypeMapG a
</span><a href="#local-6989586621682581566"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; TypeMapG a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; GenMap TypeMapX a -&gt; b -&gt; b
forall (m :: * -&gt; *) a b.
TrieMap m =&gt;
(a -&gt; b -&gt; b) -&gt; m a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581565"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapG a
</span><a href="#local-6989586621682581566"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-481"></span><span>  </span><span id="local-6989586621682581571"><span class="annot"><span class="annottext">filterTM :: forall a. (a -&gt; Bool) -&gt; LooseTypeMap a -&gt; LooseTypeMap a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var hs-var hs-var">filterTM</span></a></span></span><span> </span><span id="local-6989586621682581572"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581572"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#LooseTypeMap"><span class="hs-identifier hs-type">LooseTypeMap</span></a></span><span> </span><span id="local-6989586621682581573"><span class="annot"><span class="annottext">TypeMapG a
</span><a href="#local-6989586621682581573"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapG a -&gt; LooseTypeMap a
forall a. TypeMapG a -&gt; LooseTypeMap a
</span><a href="GHC.Core.Map.Type.html#LooseTypeMap"><span class="hs-identifier hs-var">LooseTypeMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; TypeMapG a -&gt; TypeMapG a
forall a. (a -&gt; Bool) -&gt; GenMap TypeMapX a -&gt; GenMap TypeMapX a
forall (m :: * -&gt; *) a. TrieMap m =&gt; (a -&gt; Bool) -&gt; m a -&gt; m a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var">filterTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581572"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapG a
</span><a href="#local-6989586621682581573"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                   Variables
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="hs-keyword">type</span><span> </span><span id="BoundVar"><span class="annot"><a href="GHC.Core.Map.Type.html#BoundVar"><span class="hs-identifier hs-var">BoundVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>  </span><span class="hs-comment">-- Bound variables are deBruijn numbered</span><span>
</span><span id="line-492"></span><span class="hs-keyword">type</span><span> </span><span id="BoundVarMap"><span class="annot"><a href="GHC.Core.Map.Type.html#BoundVarMap"><span class="hs-identifier hs-var">BoundVarMap</span></a></span></span><span> </span><span id="local-6989586621682581574"><span class="annot"><a href="#local-6989586621682581574"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap.IntMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581574"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="hs-keyword">data</span><span> </span><span id="CmEnv"><span class="annot"><a href="GHC.Core.Map.Type.html#CmEnv"><span class="hs-identifier hs-var">CmEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CME"><span class="annot"><a href="GHC.Core.Map.Type.html#CME"><span class="hs-identifier hs-var">CME</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="cme_next"><span class="annot"><span class="annottext">CmEnv -&gt; BoundVar
</span><a href="GHC.Core.Map.Type.html#cme_next"><span class="hs-identifier hs-var hs-var">cme_next</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Core.Map.Type.html#BoundVar"><span class="hs-identifier hs-type">BoundVar</span></a></span><span>
</span><span id="line-495"></span><span>                 </span><span class="hs-special">,</span><span> </span><span id="cme_env"><span class="annot"><span class="annottext">CmEnv -&gt; VarEnv BoundVar
</span><a href="GHC.Core.Map.Type.html#cme_env"><span class="hs-identifier hs-var hs-var">cme_env</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#VarEnv"><span class="hs-identifier hs-type">VarEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#BoundVar"><span class="hs-identifier hs-type">BoundVar</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span class="annot"><a href="GHC.Core.Map.Type.html#emptyCME"><span class="hs-identifier hs-type">emptyCME</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a></span><span>
</span><span id="line-498"></span><span id="emptyCME"><span class="annot"><span class="annottext">emptyCME :: CmEnv
</span><a href="GHC.Core.Map.Type.html#emptyCME"><span class="hs-identifier hs-var hs-var">emptyCME</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CME"><span class="hs-identifier hs-type">CME</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cme_next :: BoundVar
</span><a href="GHC.Core.Map.Type.html#cme_next"><span class="hs-identifier hs-var">cme_next</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BoundVar
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cme_env :: VarEnv BoundVar
</span><a href="GHC.Core.Map.Type.html#cme_env"><span class="hs-identifier hs-var">cme_env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarEnv BoundVar
forall a. VarEnv a
</span><a href="GHC.Types.Var.Env.html#emptyVarEnv"><span class="hs-identifier hs-var">emptyVarEnv</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span class="annot"><a href="GHC.Core.Map.Type.html#extendCME"><span class="hs-identifier hs-type">extendCME</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a></span><span>
</span><span id="line-501"></span><span id="extendCME"><span class="annot"><span class="annottext">extendCME :: CmEnv -&gt; Var -&gt; CmEnv
</span><a href="GHC.Core.Map.Type.html#extendCME"><span class="hs-identifier hs-var hs-var">extendCME</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#CME"><span class="hs-identifier hs-type">CME</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cme_next :: CmEnv -&gt; BoundVar
</span><a href="GHC.Core.Map.Type.html#cme_next"><span class="hs-identifier hs-var">cme_next</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581579"><span class="annot"><span class="annottext">BoundVar
</span><a href="#local-6989586621682581579"><span class="hs-identifier hs-var">bv</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cme_env :: CmEnv -&gt; VarEnv BoundVar
</span><a href="GHC.Core.Map.Type.html#cme_env"><span class="hs-identifier hs-var">cme_env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581580"><span class="annot"><span class="annottext">VarEnv BoundVar
</span><a href="#local-6989586621682581580"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682581581"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581581"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CME"><span class="hs-identifier hs-type">CME</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cme_next :: BoundVar
</span><a href="GHC.Core.Map.Type.html#cme_next"><span class="hs-identifier hs-var">cme_next</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BoundVar
</span><a href="#local-6989586621682581579"><span class="hs-identifier hs-var">bv</span></a></span><span class="annot"><span class="annottext">BoundVar -&gt; BoundVar -&gt; BoundVar
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">BoundVar
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cme_env :: VarEnv BoundVar
</span><a href="GHC.Core.Map.Type.html#cme_env"><span class="hs-identifier hs-var">cme_env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarEnv BoundVar -&gt; Var -&gt; BoundVar -&gt; VarEnv BoundVar
forall a. VarEnv a -&gt; Var -&gt; a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">VarEnv BoundVar
</span><a href="#local-6989586621682581580"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581581"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">BoundVar
</span><a href="#local-6989586621682581579"><span class="hs-identifier hs-var">bv</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span class="annot"><a href="GHC.Core.Map.Type.html#extendCMEs"><span class="hs-identifier hs-type">extendCMEs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a></span><span>
</span><span id="line-505"></span><span id="extendCMEs"><span class="annot"><span class="annottext">extendCMEs :: CmEnv -&gt; [Var] -&gt; CmEnv
</span><a href="GHC.Core.Map.Type.html#extendCMEs"><span class="hs-identifier hs-var hs-var">extendCMEs</span></a></span></span><span> </span><span id="local-6989586621682581584"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581584"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682581585"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682581585"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CmEnv -&gt; Var -&gt; CmEnv) -&gt; CmEnv -&gt; [Var] -&gt; CmEnv
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; Var -&gt; CmEnv
</span><a href="GHC.Core.Map.Type.html#extendCME"><span class="hs-identifier hs-var">extendCME</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581584"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682581585"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span class="annot"><a href="GHC.Core.Map.Type.html#lookupCME"><span class="hs-identifier hs-type">lookupCME</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#BoundVar"><span class="hs-identifier hs-type">BoundVar</span></a></span><span>
</span><span id="line-508"></span><span id="lookupCME"><span class="annot"><span class="annottext">lookupCME :: CmEnv -&gt; Var -&gt; Maybe BoundVar
</span><a href="GHC.Core.Map.Type.html#lookupCME"><span class="hs-identifier hs-var hs-var">lookupCME</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#CME"><span class="hs-identifier hs-type">CME</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cme_env :: CmEnv -&gt; VarEnv BoundVar
</span><a href="GHC.Core.Map.Type.html#cme_env"><span class="hs-identifier hs-var">cme_env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581586"><span class="annot"><span class="annottext">VarEnv BoundVar
</span><a href="#local-6989586621682581586"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682581587"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581587"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarEnv BoundVar -&gt; Var -&gt; Maybe BoundVar
forall a. VarEnv a -&gt; Var -&gt; Maybe a
</span><a href="GHC.Types.Var.Env.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">VarEnv BoundVar
</span><a href="#local-6989586621682581586"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581587"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="hs-comment">-- | @DeBruijn a@ represents @a@ modulo alpha-renaming.  This is achieved</span><span>
</span><span id="line-511"></span><span class="hs-comment">-- by equipping the value with a 'CmEnv', which tracks an on-the-fly deBruijn</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- numbering.  This allows us to define an 'Eq' instance for @DeBruijn a@, even</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- if this was not (easily) possible for @a@.  Note: we purposely don't</span><span>
</span><span id="line-514"></span><span class="hs-comment">-- export the constructor.  Make a helper function if you find yourself</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- needing it.</span><span>
</span><span id="line-516"></span><span class="hs-keyword">data</span><span> </span><span id="DeBruijn"><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-var">DeBruijn</span></a></span></span><span> </span><span id="local-6989586621682580590"><span class="annot"><a href="#local-6989586621682580590"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="D"><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580590"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span class="hs-comment">-- | Synthesizes a @DeBruijn a@ from an @a@, by assuming that there are no</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- bound binders (an empty 'CmEnv').  This is usually what you want if there</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- isn't already a 'CmEnv' in scope.</span><span>
</span><span id="line-521"></span><span id="local-6989586621682580570"><span class="annot"><a href="GHC.Core.Map.Type.html#deBruijnize"><span class="hs-identifier hs-type">deBruijnize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682580570"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580570"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-522"></span><span id="deBruijnize"><span class="annot"><span class="annottext">deBruijnize :: forall a. a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#deBruijnize"><span class="hs-identifier hs-var hs-var">deBruijnize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; a -&gt; DeBruijn a
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="GHC.Core.Map.Type.html#emptyCME"><span class="hs-identifier hs-var">emptyCME</span></a></span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682580794"><span id="local-6989586621682581592"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580794"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682580794"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-525"></span><span>    </span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span id="local-6989586621682581597"><span class="annot"><span class="annottext">== :: DeBruijn [a] -&gt; DeBruijn [a] -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-526"></span><span>    </span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581598"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581598"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682581599"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682581599"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682581600"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682581600"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581601"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581601"><span class="hs-identifier hs-var">env'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682581602"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682581602"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682581603"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682581603"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; a -&gt; DeBruijn a
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581598"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682581599"><span class="hs-identifier hs-var">x</span></a></span><span>  </span><span class="annot"><span class="annottext">DeBruijn a -&gt; DeBruijn a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; a -&gt; DeBruijn a
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581601"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682581602"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-527"></span><span>                                      </span><span class="annot"><span class="annottext">CmEnv -&gt; [a] -&gt; DeBruijn [a]
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581598"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682581600"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">DeBruijn [a] -&gt; DeBruijn [a] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; [a] -&gt; DeBruijn [a]
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581601"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682581603"><span class="hs-identifier hs-var">xs'</span></a></span><span>
</span><span id="line-528"></span><span>    </span><span class="annot"><span class="annottext">DeBruijn [a]
</span><span class="hs-identifier">_</span></span><span>            </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">DeBruijn [a]
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-529"></span><span>
</span><span id="line-530"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682580796"><span id="local-6989586621682581608"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580796"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#DeBruijn"><span class="hs-identifier hs-type">DeBruijn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682580796"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-531"></span><span>    </span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span id="local-6989586621682581612"><span class="annot"><span class="annottext">== :: DeBruijn (Maybe a) -&gt; DeBruijn (Maybe a) -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><span class="hs-identifier">_</span></span><span>    </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-532"></span><span>    </span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581613"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581613"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682581614"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682581614"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621682581615"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581615"><span class="hs-identifier hs-var">env'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682581616"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682581616"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; a -&gt; DeBruijn a
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581613"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682581614"><span class="hs-identifier hs-var">x</span></a></span><span>  </span><span class="annot"><span class="annottext">DeBruijn a -&gt; DeBruijn a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; a -&gt; DeBruijn a
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581615"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682581616"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-533"></span><span>    </span><span class="annot"><span class="annottext">DeBruijn (Maybe a)
</span><span class="hs-identifier">_</span></span><span>              </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">DeBruijn (Maybe a)
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span class="hs-comment">--------- Variable binders -------------</span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span class="hs-comment">-- | A 'BndrMap' is a 'TypeMapG' which allows us to distinguish between</span><span>
</span><span id="line-538"></span><span class="hs-comment">-- binding forms whose binders have different types.  For example,</span><span>
</span><span id="line-539"></span><span class="hs-comment">-- if we are doing a 'TrieMap' lookup on @\(x :: Int) -&gt; ()@, we should</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- not pick up an entry in the 'TrieMap' for @\(x :: Bool) -&gt; ()@:</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- we can disambiguate this by matching on the type (or kind, if this</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- a binder in a type) of the binder.</span><span>
</span><span id="line-543"></span><span class="hs-comment">--</span><span>
</span><span id="line-544"></span><span class="hs-comment">-- We also need to do the same for multiplicity! Which, since multiplicities are</span><span>
</span><span id="line-545"></span><span class="hs-comment">-- encoded simply as a 'Type', amounts to have a Trie for a pair of types. Tries</span><span>
</span><span id="line-546"></span><span class="hs-comment">-- of pairs are composition.</span><span>
</span><span id="line-547"></span><span class="hs-keyword">data</span><span> </span><span id="BndrMap"><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-var">BndrMap</span></a></span></span><span> </span><span id="local-6989586621682580801"><span class="annot"><a href="#local-6989586621682580801"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BndrMap"><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-var">BndrMap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.TrieMap.html#MaybeMap"><span class="hs-identifier hs-type">MaybeMap</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#TypeMapG"><span class="hs-identifier hs-type">TypeMapG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580801"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>
</span><span id="line-549"></span><span class="hs-comment">-- TODO(22292): derive</span><span>
</span><span id="line-550"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682581620"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-551"></span><span>    </span><span id="local-6989586621682581626"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; BndrMap a -&gt; BndrMap b
</span><span class="hs-identifier hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621682581627"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581627"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a></span><span> </span><span id="local-6989586621682581628"><span class="annot"><span class="annottext">TypeMapG (MaybeMap (GenMap TypeMapX) a)
</span><a href="#local-6989586621682581628"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeMapG (MaybeMap (GenMap TypeMapX) b) -&gt; BndrMap b
forall a. TypeMapG (MaybeMap (GenMap TypeMapX) a) -&gt; BndrMap a
</span><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-var">BndrMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MaybeMap (GenMap TypeMapX) a -&gt; MaybeMap (GenMap TypeMapX) b)
-&gt; TypeMapG (MaybeMap (GenMap TypeMapX) a)
-&gt; TypeMapG (MaybeMap (GenMap TypeMapX) b)
forall a b. (a -&gt; b) -&gt; GenMap TypeMapX a -&gt; GenMap TypeMapX b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b)
-&gt; MaybeMap (GenMap TypeMapX) a -&gt; MaybeMap (GenMap TypeMapX) b
forall a b.
(a -&gt; b)
-&gt; MaybeMap (GenMap TypeMapX) a -&gt; MaybeMap (GenMap TypeMapX) b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581627"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMapG (MaybeMap (GenMap TypeMapX) a)
</span><a href="#local-6989586621682581628"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">fmap</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-553"></span><span>
</span><span id="line-554"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-555"></span><span>   </span><span class="hs-keyword">type</span><span> </span><span id="Key"><span class="annot"><a href="GHC.Data.TrieMap.html#Key"><span class="hs-identifier hs-var">Key</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-556"></span><span>   </span><span id="local-6989586621682581640"><span class="annot"><span class="annottext">emptyTM :: forall a. BndrMap a
</span><a href="GHC.Data.TrieMap.html#emptyTM"><span class="hs-identifier hs-var hs-var hs-var">emptyTM</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapG (MaybeMap (GenMap TypeMapX) a) -&gt; BndrMap a
forall a. TypeMapG (MaybeMap (GenMap TypeMapX) a) -&gt; BndrMap a
</span><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-var">BndrMap</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapG (MaybeMap (GenMap TypeMapX) a)
forall a. GenMap TypeMapX a
forall (m :: * -&gt; *) a. TrieMap m =&gt; m a
</span><a href="GHC.Data.TrieMap.html#emptyTM"><span class="hs-identifier hs-var">emptyTM</span></a></span><span>
</span><span id="line-557"></span><span>   </span><span id="local-6989586621682581641"><span class="annot"><span class="annottext">lookupTM :: forall b. Key BndrMap -&gt; BndrMap b -&gt; Maybe b
</span><a href="GHC.Data.TrieMap.html#lookupTM"><span class="hs-identifier hs-var hs-var hs-var">lookupTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; Var -&gt; BndrMap b -&gt; Maybe b
forall a. CmEnv -&gt; Var -&gt; BndrMap a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkBndr"><span class="hs-identifier hs-var">lkBndr</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="GHC.Core.Map.Type.html#emptyCME"><span class="hs-identifier hs-var">emptyCME</span></a></span><span>
</span><span id="line-558"></span><span>   </span><span id="local-6989586621682581642"><span class="annot"><span class="annottext">alterTM :: forall b. Key BndrMap -&gt; XT b -&gt; BndrMap b -&gt; BndrMap b
</span><a href="GHC.Data.TrieMap.html#alterTM"><span class="hs-identifier hs-var hs-var hs-var">alterTM</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; Var -&gt; (Maybe b -&gt; Maybe b) -&gt; BndrMap b -&gt; BndrMap b
forall a. CmEnv -&gt; Var -&gt; XT a -&gt; BndrMap a -&gt; BndrMap a
</span><a href="GHC.Core.Map.Type.html#xtBndr"><span class="hs-identifier hs-var">xtBndr</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="GHC.Core.Map.Type.html#emptyCME"><span class="hs-identifier hs-var">emptyCME</span></a></span><span>
</span><span id="line-559"></span><span>   </span><span id="local-6989586621682581643"><span class="annot"><span class="annottext">foldTM :: forall a b. (a -&gt; b -&gt; b) -&gt; BndrMap a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var hs-var hs-var">foldTM</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; BndrMap a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; BndrMap a -&gt; b -&gt; b
</span><a href="GHC.Core.Map.Type.html#fdBndrMap"><span class="hs-identifier hs-var">fdBndrMap</span></a></span><span>
</span><span id="line-560"></span><span>   </span><span id="local-6989586621682581645"><span class="annot"><span class="annottext">filterTM :: forall a. (a -&gt; Bool) -&gt; BndrMap a -&gt; BndrMap a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var hs-var hs-var">filterTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; BndrMap a -&gt; BndrMap a
forall a. (a -&gt; Bool) -&gt; BndrMap a -&gt; BndrMap a
</span><a href="GHC.Core.Map.Type.html#ftBndrMap"><span class="hs-identifier hs-var">ftBndrMap</span></a></span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span id="local-6989586621682581647"><span id="local-6989586621682581648"><span class="annot"><a href="GHC.Core.Map.Type.html#fdBndrMap"><span class="hs-identifier hs-type">fdBndrMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682581647"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682581648"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682581648"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581647"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682581648"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682581648"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-563"></span><span id="fdBndrMap"><span class="annot"><span class="annottext">fdBndrMap :: forall a b. (a -&gt; b -&gt; b) -&gt; BndrMap a -&gt; b -&gt; b
</span><a href="GHC.Core.Map.Type.html#fdBndrMap"><span class="hs-identifier hs-var hs-var">fdBndrMap</span></a></span></span><span> </span><span id="local-6989586621682581655"><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581655"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a></span><span> </span><span id="local-6989586621682581656"><span class="annot"><span class="annottext">TypeMapG (MaybeMap (GenMap TypeMapX) a)
</span><a href="#local-6989586621682581656"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MaybeMap (GenMap TypeMapX) a -&gt; b -&gt; b)
-&gt; TypeMapG (MaybeMap (GenMap TypeMapX) a) -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; GenMap TypeMapX a -&gt; b -&gt; b
forall (m :: * -&gt; *) a b.
TrieMap m =&gt;
(a -&gt; b -&gt; b) -&gt; m a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; MaybeMap (GenMap TypeMapX) a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; MaybeMap (GenMap TypeMapX) a -&gt; b -&gt; b
forall (m :: * -&gt; *) a b.
TrieMap m =&gt;
(a -&gt; b -&gt; b) -&gt; m a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581655"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMapG (MaybeMap (GenMap TypeMapX) a)
</span><a href="#local-6989586621682581656"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span class="hs-comment">-- We need to use 'BndrMap' for 'Coercion', 'CoreExpr' AND 'Type', since all</span><span>
</span><span id="line-567"></span><span class="hs-comment">-- of these data types have binding forms.</span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span id="local-6989586621682580660"><span class="annot"><a href="GHC.Core.Map.Type.html#lkBndr"><span class="hs-identifier hs-type">lkBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580660"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682580660"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-570"></span><span id="lkBndr"><span class="annot"><span class="annottext">lkBndr :: forall a. CmEnv -&gt; Var -&gt; BndrMap a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkBndr"><span class="hs-identifier hs-var hs-var">lkBndr</span></a></span></span><span> </span><span id="local-6989586621682581665"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581665"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682581666"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581666"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a></span><span> </span><span id="local-6989586621682581667"><span class="annot"><span class="annottext">TypeMapG (MaybeMap (GenMap TypeMapX) a)
</span><a href="#local-6989586621682581667"><span class="hs-identifier hs-var">tymap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-571"></span><span>  </span><span id="local-6989586621682581668"><span class="annot"><a href="#local-6989586621682581668"><span class="hs-identifier hs-var">multmap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Key TypeMapX
-&gt; TypeMapG (MaybeMap (GenMap TypeMapX) a)
-&gt; Maybe (MaybeMap (GenMap TypeMapX) a)
forall (m :: * -&gt; *) a.
(Eq (Key m), TrieMap m) =&gt;
Key m -&gt; GenMap m a -&gt; Maybe a
</span><a href="GHC.Data.TrieMap.html#lkG"><span class="hs-identifier hs-var">lkG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581665"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581666"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMapG (MaybeMap (GenMap TypeMapX) a)
</span><a href="#local-6989586621682581667"><span class="hs-identifier hs-var">tymap</span></a></span><span>
</span><span id="line-572"></span><span>  </span><span class="annot"><a href="GHC.Data.TrieMap.html#lookupTM"><span class="hs-identifier hs-type">lookupTM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581665"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#varMultMaybe"><span class="hs-identifier hs-type">varMultMaybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581666"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682581668"><span class="hs-identifier hs-type">multmap</span></a></span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span class="annot"><a href="GHC.Core.Map.Type.html#xtBndr"><span class="hs-identifier hs-type">xtBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682580674"><span class="annot"><a href="#local-6989586621682580674"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580674"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580674"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580674"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-576"></span><span id="xtBndr"><span class="annot"><span class="annottext">xtBndr :: forall a. CmEnv -&gt; Var -&gt; XT a -&gt; BndrMap a -&gt; BndrMap a
</span><a href="GHC.Core.Map.Type.html#xtBndr"><span class="hs-identifier hs-var hs-var">xtBndr</span></a></span></span><span> </span><span id="local-6989586621682581680"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581680"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682581681"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581681"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621682581682"><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581682"><span class="hs-identifier hs-var">xt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a></span><span> </span><span id="local-6989586621682581683"><span class="annot"><span class="annottext">TypeMapG (MaybeMap (GenMap TypeMapX) a)
</span><a href="#local-6989586621682581683"><span class="hs-identifier hs-var">tymap</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-577"></span><span>  </span><span class="annot"><span class="annottext">TypeMapG (MaybeMap (GenMap TypeMapX) a) -&gt; BndrMap a
forall a. TypeMapG (MaybeMap (GenMap TypeMapX) a) -&gt; BndrMap a
</span><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-var">BndrMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeMapG (MaybeMap (GenMap TypeMapX) a)
</span><a href="#local-6989586621682581683"><span class="hs-identifier hs-var">tymap</span></a></span><span> </span><span class="annot"><span class="annottext">TypeMapG (MaybeMap (GenMap TypeMapX) a)
-&gt; (TypeMapG (MaybeMap (GenMap TypeMapX) a)
    -&gt; TypeMapG (MaybeMap (GenMap TypeMapX) a))
-&gt; TypeMapG (MaybeMap (GenMap TypeMapX) a)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="GHC.Data.TrieMap.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Key TypeMapX
-&gt; XT (MaybeMap (GenMap TypeMapX) a)
-&gt; TypeMapG (MaybeMap (GenMap TypeMapX) a)
-&gt; TypeMapG (MaybeMap (GenMap TypeMapX) a)
forall (m :: * -&gt; *) a.
(Eq (Key m), TrieMap m) =&gt;
Key m -&gt; XT a -&gt; GenMap m a -&gt; GenMap m a
</span><a href="GHC.Data.TrieMap.html#xtG"><span class="hs-identifier hs-var">xtG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581680"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581681"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XT (MaybeMap (GenMap TypeMapX) a)
 -&gt; TypeMapG (MaybeMap (GenMap TypeMapX) a)
 -&gt; TypeMapG (MaybeMap (GenMap TypeMapX) a))
-&gt; (MaybeMap (GenMap TypeMapX) a -&gt; MaybeMap (GenMap TypeMapX) a)
-&gt; TypeMapG (MaybeMap (GenMap TypeMapX) a)
-&gt; TypeMapG (MaybeMap (GenMap TypeMapX) a)
forall (m2 :: * -&gt; *) a (m1 :: * -&gt; *).
TrieMap m2 =&gt;
(XT (m2 a) -&gt; m1 (m2 a) -&gt; m1 (m2 a))
-&gt; (m2 a -&gt; m2 a) -&gt; m1 (m2 a) -&gt; m1 (m2 a)
</span><a href="GHC.Data.TrieMap.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key (MaybeMap (GenMap TypeMapX))
-&gt; XT a
-&gt; MaybeMap (GenMap TypeMapX) a
-&gt; MaybeMap (GenMap TypeMapX) a
forall b.
Key (MaybeMap (GenMap TypeMapX))
-&gt; XT b
-&gt; MaybeMap (GenMap TypeMapX) b
-&gt; MaybeMap (GenMap TypeMapX) b
forall (m :: * -&gt; *) b. TrieMap m =&gt; Key m -&gt; XT b -&gt; m b -&gt; m b
</span><a href="GHC.Data.TrieMap.html#alterTM"><span class="hs-identifier hs-var">alterTM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmEnv -&gt; Type -&gt; DeBruijn Type
forall a. CmEnv -&gt; a -&gt; DeBruijn a
</span><a href="GHC.Core.Map.Type.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581680"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; DeBruijn Type) -&gt; Maybe Type -&gt; Maybe (DeBruijn Type)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Maybe Type
</span><a href="GHC.Types.Var.html#varMultMaybe"><span class="hs-identifier hs-var">varMultMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581681"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581682"><span class="hs-identifier hs-var">xt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span id="local-6989586621682581684"><span class="annot"><a href="GHC.Core.Map.Type.html#ftBndrMap"><span class="hs-identifier hs-type">ftBndrMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682581684"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581684"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581684"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-580"></span><span id="ftBndrMap"><span class="annot"><span class="annottext">ftBndrMap :: forall a. (a -&gt; Bool) -&gt; BndrMap a -&gt; BndrMap a
</span><a href="GHC.Core.Map.Type.html#ftBndrMap"><span class="hs-identifier hs-var hs-var">ftBndrMap</span></a></span></span><span> </span><span id="local-6989586621682581692"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581692"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-type">BndrMap</span></a></span><span> </span><span id="local-6989586621682581693"><span class="annot"><span class="annottext">TypeMapG (MaybeMap (GenMap TypeMapX) a)
</span><a href="#local-6989586621682581693"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeMapG (MaybeMap (GenMap TypeMapX) a) -&gt; BndrMap a
forall a. TypeMapG (MaybeMap (GenMap TypeMapX) a) -&gt; BndrMap a
</span><a href="GHC.Core.Map.Type.html#BndrMap"><span class="hs-identifier hs-var">BndrMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MaybeMap (GenMap TypeMapX) a -&gt; MaybeMap (GenMap TypeMapX) a)
-&gt; TypeMapG (MaybeMap (GenMap TypeMapX) a)
-&gt; TypeMapG (MaybeMap (GenMap TypeMapX) a)
forall a b. (a -&gt; b) -&gt; GenMap TypeMapX a -&gt; GenMap TypeMapX b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool)
-&gt; MaybeMap (GenMap TypeMapX) a -&gt; MaybeMap (GenMap TypeMapX) a
forall a.
(a -&gt; Bool)
-&gt; MaybeMap (GenMap TypeMapX) a -&gt; MaybeMap (GenMap TypeMapX) a
forall (m :: * -&gt; *) a. TrieMap m =&gt; (a -&gt; Bool) -&gt; m a -&gt; m a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var">filterTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581692"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeMapG (MaybeMap (GenMap TypeMapX) a)
</span><a href="#local-6989586621682581693"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span>
</span><span id="line-582"></span><span class="hs-comment">--------- Variable occurrence -------------</span><span>
</span><span id="line-583"></span><span class="hs-keyword">data</span><span> </span><span id="VarMap"><span class="annot"><a href="GHC.Core.Map.Type.html#VarMap"><span class="hs-identifier hs-var">VarMap</span></a></span></span><span> </span><span id="local-6989586621682580817"><span class="annot"><a href="#local-6989586621682580817"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="VM"><span class="annot"><a href="GHC.Core.Map.Type.html#VM"><span class="hs-identifier hs-var">VM</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="vm_bvar"><span class="annot"><span class="annottext">forall a. VarMap a -&gt; BoundVarMap a
</span><a href="GHC.Core.Map.Type.html#vm_bvar"><span class="hs-identifier hs-var hs-var">vm_bvar</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#BoundVarMap"><span class="hs-identifier hs-type">BoundVarMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580817"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="hs-comment">-- Bound variable</span><span>
</span><span id="line-584"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="vm_fvar"><span class="annot"><span class="annottext">forall a. VarMap a -&gt; DVarEnv a
</span><a href="GHC.Core.Map.Type.html#vm_fvar"><span class="hs-identifier hs-var hs-var">vm_fvar</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#DVarEnv"><span class="hs-identifier hs-type">DVarEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580817"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>      </span><span class="hs-comment">-- Free variable</span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span class="hs-comment">-- TODO(22292): derive</span><span>
</span><span id="line-587"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682581699"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-588"></span><span>    </span><span id="local-6989586621682581704"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; VarMap a -&gt; VarMap b
</span><span class="hs-identifier hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621682581705"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581705"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#VM"><span class="hs-identifier hs-type">VM</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">vm_bvar :: forall a. VarMap a -&gt; BoundVarMap a
</span><a href="GHC.Core.Map.Type.html#vm_bvar"><span class="hs-identifier hs-var">vm_bvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581706"><span class="annot"><span class="annottext">BoundVarMap a
</span><a href="#local-6989586621682581706"><span class="hs-identifier hs-var">bv</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vm_fvar :: forall a. VarMap a -&gt; DVarEnv a
</span><a href="GHC.Core.Map.Type.html#vm_fvar"><span class="hs-identifier hs-var">vm_fvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581707"><span class="annot"><span class="annottext">DVarEnv a
</span><a href="#local-6989586621682581707"><span class="hs-identifier hs-var">fv</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#VM"><span class="hs-identifier hs-type">VM</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">vm_bvar :: BoundVarMap b
</span><a href="GHC.Core.Map.Type.html#vm_bvar"><span class="hs-identifier hs-var">vm_bvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; BoundVarMap a -&gt; BoundVarMap b
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581705"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">BoundVarMap a
</span><a href="#local-6989586621682581706"><span class="hs-identifier hs-var">bv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vm_fvar :: DVarEnv b
</span><a href="GHC.Core.Map.Type.html#vm_fvar"><span class="hs-identifier hs-var">vm_fvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; DVarEnv a -&gt; DVarEnv b
forall a b. (a -&gt; b) -&gt; UniqDFM Var a -&gt; UniqDFM Var b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682581705"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DVarEnv a
</span><a href="#local-6989586621682581707"><span class="hs-identifier hs-var">fv</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-591"></span><span>   </span><span class="hs-keyword">type</span><span> </span><span id="Key"><span class="annot"><a href="GHC.Data.TrieMap.html#Key"><span class="hs-identifier hs-var">Key</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-592"></span><span>   </span><span id="local-6989586621682581715"><span class="annot"><span class="annottext">emptyTM :: forall a. VarMap a
</span><a href="GHC.Data.TrieMap.html#emptyTM"><span class="hs-identifier hs-var hs-var hs-var">emptyTM</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#VM"><span class="hs-identifier hs-type">VM</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">vm_bvar :: BoundVarMap a
</span><a href="GHC.Core.Map.Type.html#vm_bvar"><span class="hs-identifier hs-var">vm_bvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BoundVarMap a
forall a. IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#empty"><span class="hs-identifier hs-var">IntMap.empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vm_fvar :: DVarEnv a
</span><a href="GHC.Core.Map.Type.html#vm_fvar"><span class="hs-identifier hs-var">vm_fvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DVarEnv a
forall a. DVarEnv a
</span><a href="GHC.Types.Var.Env.html#emptyDVarEnv"><span class="hs-identifier hs-var">emptyDVarEnv</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-593"></span><span>   </span><span id="local-6989586621682581718"><span class="annot"><span class="annottext">lookupTM :: forall b. Key VarMap -&gt; VarMap b -&gt; Maybe b
</span><a href="GHC.Data.TrieMap.html#lookupTM"><span class="hs-identifier hs-var hs-var hs-var">lookupTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; Var -&gt; VarMap b -&gt; Maybe b
forall a. CmEnv -&gt; Var -&gt; VarMap a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkVar"><span class="hs-identifier hs-var">lkVar</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="GHC.Core.Map.Type.html#emptyCME"><span class="hs-identifier hs-var">emptyCME</span></a></span><span>
</span><span id="line-594"></span><span>   </span><span id="local-6989586621682581719"><span class="annot"><span class="annottext">alterTM :: forall b. Key VarMap -&gt; XT b -&gt; VarMap b -&gt; VarMap b
</span><a href="GHC.Data.TrieMap.html#alterTM"><span class="hs-identifier hs-var hs-var hs-var">alterTM</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; Var -&gt; (Maybe b -&gt; Maybe b) -&gt; VarMap b -&gt; VarMap b
forall a. CmEnv -&gt; Var -&gt; XT a -&gt; VarMap a -&gt; VarMap a
</span><a href="GHC.Core.Map.Type.html#xtVar"><span class="hs-identifier hs-var">xtVar</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="GHC.Core.Map.Type.html#emptyCME"><span class="hs-identifier hs-var">emptyCME</span></a></span><span>
</span><span id="line-595"></span><span>   </span><span id="local-6989586621682581720"><span class="annot"><span class="annottext">foldTM :: forall a b. (a -&gt; b -&gt; b) -&gt; VarMap a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var hs-var hs-var">foldTM</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; VarMap a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; VarMap a -&gt; b -&gt; b
</span><a href="GHC.Core.Map.Type.html#fdVar"><span class="hs-identifier hs-var">fdVar</span></a></span><span>
</span><span id="line-596"></span><span>   </span><span id="local-6989586621682581722"><span class="annot"><span class="annottext">filterTM :: forall a. (a -&gt; Bool) -&gt; VarMap a -&gt; VarMap a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var hs-var hs-var">filterTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; VarMap a -&gt; VarMap a
forall a. (a -&gt; Bool) -&gt; VarMap a -&gt; VarMap a
</span><a href="GHC.Core.Map.Type.html#ftVar"><span class="hs-identifier hs-var">ftVar</span></a></span><span>
</span><span id="line-597"></span><span>
</span><span id="line-598"></span><span id="local-6989586621682580650"><span class="annot"><a href="GHC.Core.Map.Type.html#lkVar"><span class="hs-identifier hs-type">lkVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580650"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682580650"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-599"></span><span id="lkVar"><span class="annot"><span class="annottext">lkVar :: forall a. CmEnv -&gt; Var -&gt; VarMap a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkVar"><span class="hs-identifier hs-var hs-var">lkVar</span></a></span></span><span> </span><span id="local-6989586621682581726"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581726"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682581727"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581727"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-600"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682581728"><span class="annot"><span class="annottext">BoundVar
</span><a href="#local-6989586621682581728"><span class="hs-identifier hs-var">bv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; Var -&gt; Maybe BoundVar
</span><a href="GHC.Core.Map.Type.html#lookupCME"><span class="hs-identifier hs-var">lookupCME</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581726"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581727"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarMap a -&gt; BoundVarMap a
forall a. VarMap a -&gt; BoundVarMap a
</span><a href="GHC.Core.Map.Type.html#vm_bvar"><span class="hs-identifier hs-var">vm_bvar</span></a></span><span> </span><span class="annot"><span class="annottext">(VarMap a -&gt; BoundVarMap a)
-&gt; (BoundVarMap a -&gt; Maybe a) -&gt; VarMap a -&gt; Maybe a
forall a b c. (a -&gt; b) -&gt; (b -&gt; c) -&gt; a -&gt; c
</span><a href="GHC.Data.TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Key IntMap -&gt; BoundVarMap a -&gt; Maybe a
forall b. Key IntMap -&gt; IntMap b -&gt; Maybe b
forall (m :: * -&gt; *) b. TrieMap m =&gt; Key m -&gt; m b -&gt; Maybe b
</span><a href="GHC.Data.TrieMap.html#lookupTM"><span class="hs-identifier hs-var">lookupTM</span></a></span><span> </span><span class="annot"><span class="annottext">BoundVar
Key IntMap
</span><a href="#local-6989586621682581728"><span class="hs-identifier hs-var">bv</span></a></span><span>
</span><span id="line-601"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarMap a -&gt; DVarEnv a
forall a. VarMap a -&gt; DVarEnv a
</span><a href="GHC.Core.Map.Type.html#vm_fvar"><span class="hs-identifier hs-var">vm_fvar</span></a></span><span> </span><span class="annot"><span class="annottext">(VarMap a -&gt; DVarEnv a)
-&gt; (DVarEnv a -&gt; Maybe a) -&gt; VarMap a -&gt; Maybe a
forall a b c. (a -&gt; b) -&gt; (b -&gt; c) -&gt; a -&gt; c
</span><a href="GHC.Data.TrieMap.html#%3E.%3E"><span class="hs-operator hs-var">&gt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; DVarEnv a -&gt; Maybe a
forall a. Var -&gt; DVarEnv a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkDFreeVar"><span class="hs-identifier hs-var">lkDFreeVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581727"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span id="local-6989586621682580665"><span class="annot"><a href="GHC.Core.Map.Type.html#xtVar"><span class="hs-identifier hs-type">xtVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#CmEnv"><span class="hs-identifier hs-type">CmEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580665"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580665"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580665"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-604"></span><span id="xtVar"><span class="annot"><span class="annottext">xtVar :: forall a. CmEnv -&gt; Var -&gt; XT a -&gt; VarMap a -&gt; VarMap a
</span><a href="GHC.Core.Map.Type.html#xtVar"><span class="hs-identifier hs-var hs-var">xtVar</span></a></span></span><span> </span><span id="local-6989586621682581730"><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581730"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682581731"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581731"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621682581732"><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581732"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682581733"><span class="annot"><span class="annottext">VarMap a
</span><a href="#local-6989586621682581733"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-605"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682581734"><span class="annot"><span class="annottext">BoundVar
</span><a href="#local-6989586621682581734"><span class="hs-identifier hs-var">bv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmEnv -&gt; Var -&gt; Maybe BoundVar
</span><a href="GHC.Core.Map.Type.html#lookupCME"><span class="hs-identifier hs-var">lookupCME</span></a></span><span> </span><span class="annot"><span class="annottext">CmEnv
</span><a href="#local-6989586621682581730"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581731"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarMap a
</span><a href="#local-6989586621682581733"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#vm_bvar"><span class="hs-identifier hs-var">vm_bvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#vm_bvar"><span class="hs-identifier hs-var">vm_bvar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581733"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#%7C%3E"><span class="hs-operator hs-type">|&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#alterTM"><span class="hs-identifier hs-type">alterTM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581734"><span class="hs-identifier hs-type">bv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581732"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-606"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarMap a
</span><a href="#local-6989586621682581733"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#vm_fvar"><span class="hs-identifier hs-var">vm_fvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#vm_fvar"><span class="hs-identifier hs-var">vm_fvar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581733"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#%7C%3E"><span class="hs-operator hs-type">|&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#xtDFreeVar"><span class="hs-identifier hs-type">xtDFreeVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581731"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581732"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span id="local-6989586621682581735"><span id="local-6989586621682581736"><span class="annot"><a href="GHC.Core.Map.Type.html#fdVar"><span class="hs-identifier hs-type">fdVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682581735"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682581736"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682581736"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581735"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682581736"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682581736"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-609"></span><span id="fdVar"><span class="annot"><span class="annottext">fdVar :: forall a b. (a -&gt; b -&gt; b) -&gt; VarMap a -&gt; b -&gt; b
</span><a href="GHC.Core.Map.Type.html#fdVar"><span class="hs-identifier hs-var hs-var">fdVar</span></a></span></span><span> </span><span id="local-6989586621682581741"><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581741"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621682581742"><span class="annot"><span class="annottext">VarMap a
</span><a href="#local-6989586621682581742"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; IntMap a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; IntMap a -&gt; b -&gt; b
forall (m :: * -&gt; *) a b.
TrieMap m =&gt;
(a -&gt; b -&gt; b) -&gt; m a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581741"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarMap a -&gt; IntMap a
forall a. VarMap a -&gt; BoundVarMap a
</span><a href="GHC.Core.Map.Type.html#vm_bvar"><span class="hs-identifier hs-var">vm_bvar</span></a></span><span> </span><span class="annot"><span class="annottext">VarMap a
</span><a href="#local-6989586621682581742"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>          </span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; (b -&gt; b) -&gt; b -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; UniqDFM Var a -&gt; b -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; UniqDFM Var a -&gt; b -&gt; b
forall (m :: * -&gt; *) a b.
TrieMap m =&gt;
(a -&gt; b -&gt; b) -&gt; m a -&gt; b -&gt; b
</span><a href="GHC.Data.TrieMap.html#foldTM"><span class="hs-identifier hs-var">foldTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682581741"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarMap a -&gt; UniqDFM Var a
forall a. VarMap a -&gt; DVarEnv a
</span><a href="GHC.Core.Map.Type.html#vm_fvar"><span class="hs-identifier hs-var">vm_fvar</span></a></span><span> </span><span class="annot"><span class="annottext">VarMap a
</span><a href="#local-6989586621682581742"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span id="local-6989586621682580834"><span class="annot"><a href="GHC.Core.Map.Type.html#lkDFreeVar"><span class="hs-identifier hs-type">lkDFreeVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#DVarEnv"><span class="hs-identifier hs-type">DVarEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580834"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682580834"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-613"></span><span id="lkDFreeVar"><span class="annot"><span class="annottext">lkDFreeVar :: forall a. Var -&gt; DVarEnv a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkDFreeVar"><span class="hs-identifier hs-var hs-var">lkDFreeVar</span></a></span></span><span> </span><span id="local-6989586621682581743"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581743"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682581744"><span class="annot"><span class="annottext">DVarEnv a
</span><a href="#local-6989586621682581744"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DVarEnv a -&gt; Var -&gt; Maybe a
forall a. DVarEnv a -&gt; Var -&gt; Maybe a
</span><a href="GHC.Types.Var.Env.html#lookupDVarEnv"><span class="hs-identifier hs-var">lookupDVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">DVarEnv a
</span><a href="#local-6989586621682581744"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581743"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span id="local-6989586621682580836"><span class="annot"><a href="GHC.Core.Map.Type.html#xtDFreeVar"><span class="hs-identifier hs-type">xtDFreeVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580836"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#DVarEnv"><span class="hs-identifier hs-type">DVarEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580836"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#DVarEnv"><span class="hs-identifier hs-type">DVarEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580836"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-616"></span><span id="xtDFreeVar"><span class="annot"><span class="annottext">xtDFreeVar :: forall a. Var -&gt; XT a -&gt; DVarEnv a -&gt; DVarEnv a
</span><a href="GHC.Core.Map.Type.html#xtDFreeVar"><span class="hs-identifier hs-var hs-var">xtDFreeVar</span></a></span></span><span> </span><span id="local-6989586621682581746"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581746"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621682581747"><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581747"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682581748"><span class="annot"><span class="annottext">DVarEnv a
</span><a href="#local-6989586621682581748"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XT a -&gt; DVarEnv a -&gt; Var -&gt; DVarEnv a
forall a. (Maybe a -&gt; Maybe a) -&gt; DVarEnv a -&gt; Var -&gt; DVarEnv a
</span><a href="GHC.Types.Var.Env.html#alterDVarEnv"><span class="hs-identifier hs-var">alterDVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581747"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DVarEnv a
</span><a href="#local-6989586621682581748"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682581746"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span id="local-6989586621682581750"><span class="annot"><a href="GHC.Core.Map.Type.html#ftVar"><span class="hs-identifier hs-type">ftVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682581750"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581750"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#VarMap"><span class="hs-identifier hs-type">VarMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682581750"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-619"></span><span id="ftVar"><span class="annot"><span class="annottext">ftVar :: forall a. (a -&gt; Bool) -&gt; VarMap a -&gt; VarMap a
</span><a href="GHC.Core.Map.Type.html#ftVar"><span class="hs-identifier hs-var hs-var">ftVar</span></a></span></span><span> </span><span id="local-6989586621682581754"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581754"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Type.html#VM"><span class="hs-identifier hs-type">VM</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">vm_bvar :: forall a. VarMap a -&gt; BoundVarMap a
</span><a href="GHC.Core.Map.Type.html#vm_bvar"><span class="hs-identifier hs-var">vm_bvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581755"><span class="annot"><span class="annottext">BoundVarMap a
</span><a href="#local-6989586621682581755"><span class="hs-identifier hs-var">bv</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vm_fvar :: forall a. VarMap a -&gt; DVarEnv a
</span><a href="GHC.Core.Map.Type.html#vm_fvar"><span class="hs-identifier hs-var">vm_fvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682581756"><span class="annot"><span class="annottext">DVarEnv a
</span><a href="#local-6989586621682581756"><span class="hs-identifier hs-var">fv</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-620"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Map.Type.html#VM"><span class="hs-identifier hs-type">VM</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">vm_bvar :: BoundVarMap a
</span><a href="GHC.Core.Map.Type.html#vm_bvar"><span class="hs-identifier hs-var">vm_bvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; BoundVarMap a -&gt; BoundVarMap a
forall a. (a -&gt; Bool) -&gt; IntMap a -&gt; IntMap a
forall (m :: * -&gt; *) a. TrieMap m =&gt; (a -&gt; Bool) -&gt; m a -&gt; m a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var">filterTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581754"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">BoundVarMap a
</span><a href="#local-6989586621682581755"><span class="hs-identifier hs-var">bv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vm_fvar :: DVarEnv a
</span><a href="GHC.Core.Map.Type.html#vm_fvar"><span class="hs-identifier hs-var">vm_fvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; DVarEnv a -&gt; DVarEnv a
forall a. (a -&gt; Bool) -&gt; UniqDFM Var a -&gt; UniqDFM Var a
forall (m :: * -&gt; *) a. TrieMap m =&gt; (a -&gt; Bool) -&gt; m a -&gt; m a
</span><a href="GHC.Data.TrieMap.html#filterTM"><span class="hs-identifier hs-var">filterTM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682581754"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DVarEnv a
</span><a href="#local-6989586621682581756"><span class="hs-identifier hs-var">fv</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span class="hs-comment">-------------------------------------------------</span><span>
</span><span id="line-623"></span><span id="local-6989586621682580657"><span id="local-6989586621682580658"><span class="annot"><a href="GHC.Core.Map.Type.html#lkDNamed"><span class="hs-identifier hs-type">lkDNamed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580657"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580657"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#DNameEnv"><span class="hs-identifier hs-type">DNameEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580658"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682580658"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-624"></span><span id="lkDNamed"><span class="annot"><span class="annottext">lkDNamed :: forall n a. NamedThing n =&gt; n -&gt; DNameEnv a -&gt; Maybe a
</span><a href="GHC.Core.Map.Type.html#lkDNamed"><span class="hs-identifier hs-var hs-var">lkDNamed</span></a></span></span><span> </span><span id="local-6989586621682581759"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621682581759"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682581760"><span class="annot"><span class="annottext">DNameEnv a
</span><a href="#local-6989586621682581760"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DNameEnv a -&gt; Name -&gt; Maybe a
forall a. DNameEnv a -&gt; Name -&gt; Maybe a
</span><a href="GHC.Types.Name.Env.html#lookupDNameEnv"><span class="hs-identifier hs-var">lookupDNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">DNameEnv a
</span><a href="#local-6989586621682581760"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; Name
forall a. NamedThing a =&gt; a -&gt; Name
</span><a href="GHC.Types.Name.html#getName"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621682581759"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span id="local-6989586621682580671"><span id="local-6989586621682580672"><span class="annot"><a href="GHC.Core.Map.Type.html#xtDNamed"><span class="hs-identifier hs-type">xtDNamed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580671"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682580671"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#XT"><span class="hs-identifier hs-type">XT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580672"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#DNameEnv"><span class="hs-identifier hs-type">DNameEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580672"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#DNameEnv"><span class="hs-identifier hs-type">DNameEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682580672"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-627"></span><span id="xtDNamed"><span class="annot"><span class="annottext">xtDNamed :: forall n a. NamedThing n =&gt; n -&gt; XT a -&gt; DNameEnv a -&gt; DNameEnv a
</span><a href="GHC.Core.Map.Type.html#xtDNamed"><span class="hs-identifier hs-var hs-var">xtDNamed</span></a></span></span><span> </span><span id="local-6989586621682581765"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621682581765"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682581766"><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581766"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682581767"><span class="annot"><span class="annottext">DNameEnv a
</span><a href="#local-6989586621682581767"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XT a -&gt; DNameEnv a -&gt; Name -&gt; DNameEnv a
forall a. (Maybe a -&gt; Maybe a) -&gt; DNameEnv a -&gt; Name -&gt; DNameEnv a
</span><a href="GHC.Types.Name.Env.html#alterDNameEnv"><span class="hs-identifier hs-var">alterDNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">XT a
</span><a href="#local-6989586621682581766"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DNameEnv a
</span><a href="#local-6989586621682581767"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; Name
forall a. NamedThing a =&gt; a -&gt; Name
</span><a href="GHC.Types.Name.html#getName"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621682581765"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-628"></span></pre></body></html>