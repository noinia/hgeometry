<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ApplicativeDo       #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns        #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf          #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">-- | Domain types used in &quot;GHC.HsToCore.Pmc.Solver&quot;.</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- The ultimate goal is to define 'Nabla', which models normalised refinement</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- types from the paper</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- [Lower Your Guards: A Compositional Pattern-Match Coverage Checker&quot;](https://dl.acm.org/doi/abs/10.1145/3408989).</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html"><span class="hs-identifier">GHC.HsToCore.Pmc.Solver.Types</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Normalised refinement types</span></span><span>
</span><span id="line-13"></span><span>        </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#BotInfo"><span class="hs-identifier">BotInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConApp"><span class="hs-identifier">PmAltConApp</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#VarInfo"><span class="hs-identifier">VarInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TmState"><span class="hs-identifier">TmState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TyState"><span class="hs-identifier">TyState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>        </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#Nabla"><span class="hs-identifier">Nabla</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#Nablas"><span class="hs-identifier">Nablas</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#initNablas"><span class="hs-identifier">initNablas</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>        </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#lookupRefuts"><span class="hs-identifier">lookupRefuts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#lookupSolution"><span class="hs-identifier">lookupSolution</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Looking up 'VarInfo'</span></span><span>
</span><span id="line-18"></span><span>        </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#lookupVarInfo"><span class="hs-identifier">lookupVarInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#lookupVarInfoNT"><span class="hs-identifier">lookupVarInfoNT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#trvVarInfo"><span class="hs-identifier">trvVarInfo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Caching residual COMPLETE sets</span></span><span>
</span><span id="line-21"></span><span>        </span><span class="annot"><a href="GHC.Types.CompleteMatch.html#CompleteMatch"><span class="hs-identifier">CompleteMatch</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#ResidualCompleteMatches"><span class="hs-identifier">ResidualCompleteMatches</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#getRcm"><span class="hs-identifier">getRcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#isRcmInitialised"><span class="hs-identifier">isRcmInitialised</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Representations for Literals and AltCons</span></span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier">PmLit</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitValue"><span class="hs-identifier">PmLitValue</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltCon"><span class="hs-identifier">PmAltCon</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmLitType"><span class="hs-identifier">pmLitType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmAltConType"><span class="hs-identifier">pmAltConType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>        </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#isPmAltConMatchStrict"><span class="hs-identifier">isPmAltConMatchStrict</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmAltConImplBangs"><span class="hs-identifier">pmAltConImplBangs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><span class="hs-comment">-- *** PmAltConSet</span></span><span>
</span><span id="line-28"></span><span>        </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConSet"><span class="hs-identifier">PmAltConSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#emptyPmAltConSet"><span class="hs-identifier">emptyPmAltConSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#isEmptyPmAltConSet"><span class="hs-identifier">isEmptyPmAltConSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#elemPmAltConSet"><span class="hs-identifier">elemPmAltConSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>        </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#extendPmAltConSet"><span class="hs-identifier">extendPmAltConSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmAltConSetElems"><span class="hs-identifier">pmAltConSetElems</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>        </span><span class="annot"><span class="hs-comment">-- *** Equality on 'PmAltCon's</span></span><span>
</span><span id="line-32"></span><span>        </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmEquality"><span class="hs-identifier">PmEquality</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#eqPmAltCon"><span class="hs-identifier">eqPmAltCon</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>        </span><span class="annot"><span class="hs-comment">-- *** Operations on 'PmLit'</span></span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#literalToPmLit"><span class="hs-identifier">literalToPmLit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#negatePmLit"><span class="hs-identifier">negatePmLit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#overloadPmLit"><span class="hs-identifier">overloadPmLit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmLitAsStringLit"><span class="hs-identifier">pmLitAsStringLit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#coreExprAsPmLit"><span class="hs-identifier">coreExprAsPmLit</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Bag.html"><span class="hs-identifier">GHC.Data.Bag</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.html"><span class="hs-identifier">GHC.Types.Id</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html"><span class="hs-identifier">GHC.Types.Var.Set</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSet.html"><span class="hs-identifier">GHC.Types.Unique.DSet</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.SDFM.html"><span class="hs-identifier">GHC.Types.Unique.SDFM</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html"><span class="hs-identifier">GHC.Core.DataCon</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.ConLike.html"><span class="hs-identifier">GHC.Core.ConLike</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html"><span class="hs-identifier">GHC.Utils.Panic.Plain</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Misc.html#lastMaybe"><span class="hs-identifier">lastMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.List.SetOps.html"><span class="hs-identifier">GHC.Data.List.SetOps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.List.SetOps.html#unionLists"><span class="hs-identifier">unionLists</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html"><span class="hs-identifier">GHC.Data.Maybe</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html"><span class="hs-identifier">GHC.Types.Literal</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.html"><span class="hs-identifier">GHC.Core</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html"><span class="hs-identifier">GHC.Core.TyCo.Compare</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-identifier">eqType</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Map.Expr.html"><span class="hs-identifier">GHC.Core.Map.Expr</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html"><span class="hs-identifier">GHC.Core.Utils</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier">exprType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html"><span class="hs-identifier">GHC.Builtin.Types</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.Prim.html"><span class="hs-identifier">GHC.Builtin.Types.Prim</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Solver.InertSet.html"><span class="hs-identifier">GHC.Tc.Solver.InertSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Solver.InertSet.html#InertSet"><span class="hs-identifier">InertSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Solver.InertSet.html#emptyInert"><span class="hs-identifier">emptyInert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html"><span class="hs-identifier">GHC.Tc.Utils.TcType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isStringTy"><span class="hs-identifier">isStringTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.CompleteMatch.html"><span class="hs-identifier">GHC.Types.CompleteMatch</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SourceText.html"><span class="hs-identifier">GHC.Types.SourceText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SourceText.html#SourceText"><span class="hs-identifier">SourceText</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SourceText.html#mkFractionalLit"><span class="hs-identifier">mkFractionalLit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SourceText.html#FractionalLit"><span class="hs-identifier">FractionalLit</span></a></span><span>
</span><span id="line-70"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SourceText.html#fractionalLitFromRational"><span class="hs-identifier">fractionalLitFromRational</span></a></span><span>
</span><span id="line-71"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SourceText.html#FractionalExponentBase"><span class="hs-identifier">FractionalExponentBase</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Numeric.html"><span class="hs-identifier">Numeric</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromRat</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Foldable.html"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Ratio.html"><span class="hs-identifier">Data.Ratio</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Real.html"><span class="hs-identifier">GHC.Real</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Ratio</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Semigroup.html"><span class="hs-identifier">Data.Semigroup</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Semi</span></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- import GHC.Driver.Ppr</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">--</span><span>
</span><span id="line-81"></span><span class="annot"><span class="hs-comment">-- * Normalised refinement types</span></span><span>
</span><span id="line-82"></span><span class="hs-comment">--</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- | A normalised refinement type &#8711; (\&quot;nabla\&quot;), comprised of an inert set of</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- canonical (i.e. mutually compatible) term and type constraints that form the</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- refinement type's predicate.</span><span>
</span><span id="line-87"></span><span class="hs-keyword">data</span><span> </span><span id="Nabla"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#Nabla"><span class="hs-identifier hs-var">Nabla</span></a></span></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="MkNabla"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#MkNabla"><span class="hs-identifier hs-var">MkNabla</span></a></span></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="nabla_ty_st"><span class="annot"><span class="annottext">Nabla -&gt; TyState
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#nabla_ty_st"><span class="hs-identifier hs-var hs-var">nabla_ty_st</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TyState"><span class="hs-identifier hs-type">TyState</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Type oracle; things like a~Int</span></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="nabla_tm_st"><span class="annot"><span class="annottext">Nabla -&gt; TmState
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#nabla_tm_st"><span class="hs-identifier hs-var hs-var">nabla_tm_st</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TmState"><span class="hs-identifier hs-type">TmState</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Term oracle; things like x~Nothing</span></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="annot"><span class="hs-comment">-- | An initial nabla that is always satisfiable</span></span><span>
</span><span id="line-96"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#initNabla"><span class="hs-identifier hs-type">initNabla</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#Nabla"><span class="hs-identifier hs-type">Nabla</span></a></span><span>
</span><span id="line-97"></span><span id="initNabla"><span class="annot"><span class="annottext">initNabla :: Nabla
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#initNabla"><span class="hs-identifier hs-var hs-var">initNabla</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyState -&gt; TmState -&gt; Nabla
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#MkNabla"><span class="hs-identifier hs-var">MkNabla</span></a></span><span> </span><span class="annot"><span class="annottext">TyState
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#initTyState"><span class="hs-identifier hs-var">initTyState</span></a></span><span> </span><span class="annot"><span class="annottext">TmState
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#initTmState"><span class="hs-identifier hs-var">initTmState</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#Nabla"><span class="hs-identifier hs-type">Nabla</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>  </span><span id="local-6989586621682726200"><span class="annot"><span class="annottext">ppr :: Nabla -&gt; SDoc
</span><a href="#local-6989586621682726200"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span id="local-6989586621682726202"><span class="annot"><span class="annottext">Nabla
</span><a href="#local-6989586621682726202"><span class="hs-identifier hs-var">nabla</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Nabla&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-101"></span><span>      </span><span class="hs-comment">-- intentionally formatted this way enable the dev to comment in only</span><span>
</span><span id="line-102"></span><span>      </span><span class="hs-comment">-- the info they need</span><span>
</span><span id="line-103"></span><span>      </span><span class="annot"><span class="annottext">TmState -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nabla -&gt; TmState
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#nabla_tm_st"><span class="hs-identifier hs-var">nabla_tm_st</span></a></span><span> </span><span class="annot"><span class="annottext">Nabla
</span><a href="#local-6989586621682726202"><span class="hs-identifier hs-var">nabla</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>      </span><span class="annot"><span class="annottext">TyState -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nabla -&gt; TyState
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#nabla_ty_st"><span class="hs-identifier hs-var">nabla_ty_st</span></a></span><span> </span><span class="annot"><span class="annottext">Nabla
</span><a href="#local-6989586621682726202"><span class="hs-identifier hs-var">nabla</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><span class="hs-comment">-- | A disjunctive bag of 'Nabla's, representing a refinement type.</span></span><span>
</span><span id="line-108"></span><span class="hs-keyword">newtype</span><span> </span><span id="Nablas"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#Nablas"><span class="hs-identifier hs-var">Nablas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MkNablas"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#MkNablas"><span class="hs-identifier hs-var">MkNablas</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#Nabla"><span class="hs-identifier hs-type">Nabla</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#initNablas"><span class="hs-identifier hs-type">initNablas</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#Nablas"><span class="hs-identifier hs-type">Nablas</span></a></span><span>
</span><span id="line-111"></span><span id="initNablas"><span class="annot"><span class="annottext">initNablas :: Nablas
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#initNablas"><span class="hs-identifier hs-var hs-var">initNablas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bag Nabla -&gt; Nablas
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#MkNablas"><span class="hs-identifier hs-var">MkNablas</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nabla -&gt; Bag Nabla
forall a. a -&gt; Bag a
</span><a href="GHC.Data.Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a></span><span> </span><span class="annot"><span class="annottext">Nabla
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#initNabla"><span class="hs-identifier hs-var">initNabla</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#Nablas"><span class="hs-identifier hs-type">Nablas</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>  </span><span id="local-6989586621682726213"><span class="annot"><span class="annottext">ppr :: Nablas -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#MkNablas"><span class="hs-identifier hs-type">MkNablas</span></a></span><span> </span><span id="local-6989586621682726214"><span class="annot"><span class="annottext">Bag Nabla
</span><a href="#local-6989586621682726214"><span class="hs-identifier hs-var">nablas</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bag Nabla -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Bag Nabla
</span><a href="#local-6989586621682726214"><span class="hs-identifier hs-var">nablas</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682726217"><span id="local-6989586621682726221"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#Nablas"><span class="hs-identifier hs-type">Nablas</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#MkNablas"><span class="hs-identifier hs-type">MkNablas</span></a></span><span> </span><span id="local-6989586621682726226"><span class="annot"><span class="annottext">Bag Nabla
</span><a href="#local-6989586621682726226"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682726227"><span class="annot"><span class="annottext">&lt;&gt; :: Nablas -&gt; Nablas -&gt; Nablas
</span><span class="hs-operator hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#MkNablas"><span class="hs-identifier hs-type">MkNablas</span></a></span><span> </span><span id="local-6989586621682726228"><span class="annot"><span class="annottext">Bag Nabla
</span><a href="#local-6989586621682726228"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bag Nabla -&gt; Nablas
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#MkNablas"><span class="hs-identifier hs-var">MkNablas</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bag Nabla
</span><a href="#local-6989586621682726226"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Bag Nabla -&gt; Bag Nabla -&gt; Bag Nabla
forall a. Bag a -&gt; Bag a -&gt; Bag a
</span><a href="GHC.Data.Bag.html#unionBags"><span class="hs-operator hs-var">`unionBags`</span></a></span><span> </span><span class="annot"><span class="annottext">Bag Nabla
</span><a href="#local-6989586621682726228"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682726234"><span id="local-6989586621682726238"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#Nablas"><span class="hs-identifier hs-type">Nablas</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-120"></span><span>  </span><span id="local-6989586621682726241"><span class="annot"><span class="annottext">mempty :: Nablas
</span><span class="hs-identifier hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bag Nabla -&gt; Nablas
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#MkNablas"><span class="hs-identifier hs-var">MkNablas</span></a></span><span> </span><span class="annot"><span class="annottext">Bag Nabla
forall a. Bag a
</span><a href="GHC.Data.Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- | The type oracle state. An 'GHC.Tc.Solver.Monad.InertSet' that we</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- incrementally add local type constraints to, together with a sequence</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- number that counts the number of times we extended it with new facts.</span><span>
</span><span id="line-125"></span><span class="hs-keyword">data</span><span> </span><span id="TyState"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TyState"><span class="hs-identifier hs-var">TyState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TySt"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TySt"><span class="hs-identifier hs-var">TySt</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="ty_st_n"><span class="annot"><span class="annottext">TyState -&gt; Int
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#ty_st_n"><span class="hs-identifier hs-var hs-var">ty_st_n</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span id="ty_st_inert"><span class="annot"><span class="annottext">TyState -&gt; InertSet
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#ty_st_inert"><span class="hs-identifier hs-var hs-var">ty_st_inert</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Tc.Solver.InertSet.html#InertSet"><span class="hs-identifier hs-type">InertSet</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><span class="hs-comment">-- | Not user-facing.</span></span><span>
</span><span id="line-128"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TyState"><span class="hs-identifier hs-type">TyState</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621682726252"><span class="annot"><span class="annottext">ppr :: TyState -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TySt"><span class="hs-identifier hs-type">TySt</span></a></span><span> </span><span id="local-6989586621682726253"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726253"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682726254"><span class="annot"><span class="annottext">InertSet
</span><a href="#local-6989586621682726254"><span class="hs-identifier hs-var">inert</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726253"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">InertSet -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">InertSet
</span><a href="#local-6989586621682726254"><span class="hs-identifier hs-var">inert</span></a></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#initTyState"><span class="hs-identifier hs-type">initTyState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TyState"><span class="hs-identifier hs-type">TyState</span></a></span><span>
</span><span id="line-132"></span><span id="initTyState"><span class="annot"><span class="annottext">initTyState :: TyState
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#initTyState"><span class="hs-identifier hs-var hs-var">initTyState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; InertSet -&gt; TyState
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#TySt"><span class="hs-identifier hs-var">TySt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">InertSet
</span><a href="GHC.Tc.Solver.InertSet.html#emptyInert"><span class="hs-identifier hs-var">emptyInert</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- | The term oracle state. Stores 'VarInfo' for encountered 'Id's. These</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- entries are possibly shared when we figure out that two variables must be</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- equal, thus represent the same set of values.</span><span>
</span><span id="line-137"></span><span class="hs-comment">--</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- See Note [TmState invariants] in &quot;GHC.HsToCore.Pmc.Solver&quot;.</span><span>
</span><span id="line-139"></span><span class="hs-keyword">data</span><span> </span><span id="TmState"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TmState"><span class="hs-identifier hs-var">TmState</span></a></span></span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TmSt"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TmSt"><span class="hs-identifier hs-var">TmSt</span></a></span></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="ts_facts"><span class="annot"><span class="annottext">TmState -&gt; UniqSDFM Id VarInfo
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#ts_facts"><span class="hs-identifier hs-var hs-var">ts_facts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.SDFM.html#UniqSDFM"><span class="hs-identifier hs-type">UniqSDFM</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#VarInfo"><span class="hs-identifier hs-type">VarInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-comment">-- ^ Facts about term variables. Deterministic env, so that we generate</span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-comment">-- deterministic error messages.</span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ts_reps"><span class="annot"><span class="annottext">TmState -&gt; CoreMap Id
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#ts_reps"><span class="hs-identifier hs-var hs-var">ts_reps</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Map.Expr.html#CoreMap"><span class="hs-identifier hs-type">CoreMap</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-comment">-- ^ An environment for looking up whether we already encountered semantically</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-comment">-- equivalent expressions that we want to represent by the same 'Id'</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-comment">-- representative.</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ts_dirty"><span class="annot"><span class="annottext">TmState -&gt; DIdSet
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#ts_dirty"><span class="hs-identifier hs-var hs-var">ts_dirty</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Types.Var.Set.html#DIdSet"><span class="hs-identifier hs-type">DIdSet</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-comment">-- ^ Which 'VarInfo' needs to be checked for inhabitants because of new</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-comment">-- negative constraints (e.g. @x &#8769; &#8869;@ or @x &#8769; K@).</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- | Information about an 'Id'. Stores positive ('vi_pos') facts, like @x ~ Just 42@,</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- and negative ('vi_neg') facts, like &quot;x is not (:)&quot;.</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- Also caches the type ('vi_ty'), the 'ResidualCompleteMatches' of a COMPLETE set</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- ('vi_rcm').</span><span>
</span><span id="line-157"></span><span class="hs-comment">--</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- Subject to Note [The Pos/Neg invariant] in &quot;GHC.HsToCore.Pmc.Solver&quot;.</span><span>
</span><span id="line-159"></span><span class="hs-keyword">data</span><span> </span><span id="VarInfo"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#VarInfo"><span class="hs-identifier hs-var">VarInfo</span></a></span></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="VI"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#VI"><span class="hs-identifier hs-var">VI</span></a></span></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="vi_id"><span class="annot"><span class="annottext">VarInfo -&gt; Id
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#vi_id"><span class="hs-identifier hs-var hs-var">vi_id</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-comment">-- ^ The 'Id' in question. Important for adding new constraints relative to</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-comment">-- this 'VarInfo' when we don't easily have the 'Id' available.</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="vi_pos"><span class="annot"><span class="annottext">VarInfo -&gt; [PmAltConApp]
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#vi_pos"><span class="hs-identifier hs-var hs-var">vi_pos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConApp"><span class="hs-identifier hs-type">PmAltConApp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-comment">-- ^ Positive info: 'PmAltCon' apps it is (i.e. @x ~ [Just y, PatSyn z]@), all</span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-comment">-- at the same time (i.e. conjunctive).  We need a list because of nested</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-comment">-- pattern matches involving pattern synonym</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-comment">--    case x of { Just y -&gt; case x of PatSyn z -&gt; ... }</span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-comment">-- However, no more than one RealDataCon in the list, otherwise contradiction</span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-comment">-- because of generativity.</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="vi_neg"><span class="annot"><span class="annottext">VarInfo -&gt; PmAltConSet
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#vi_neg"><span class="hs-identifier hs-var hs-var">vi_neg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConSet"><span class="hs-identifier hs-type">PmAltConSet</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-comment">-- ^ Negative info: A list of 'PmAltCon's that it cannot match.</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-comment">-- Example, assuming</span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-comment">--     data T = Leaf Int | Branch T T | Node Int T</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-comment">-- then @x &#8769; [Leaf, Node]@ means that @x@ cannot match a @Leaf@ or @Node@,</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-comment">-- and hence can only match @Branch@. Is orthogonal to anything from 'vi_pos',</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-comment">-- in the sense that 'eqPmAltCon' returns @PossiblyOverlap@ for any pairing</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-comment">-- between 'vi_pos' and 'vi_neg'.</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-comment">-- See Note [Why record both positive and negative info?]</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-comment">-- It's worth having an actual set rather than a simple association list,</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-comment">-- because files like Cabal's `LicenseId` define relatively huge enums</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-comment">-- that lead to quadratic or worse behavior.</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="vi_bot"><span class="annot"><span class="annottext">VarInfo -&gt; BotInfo
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#vi_bot"><span class="hs-identifier hs-var hs-var">vi_bot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#BotInfo"><span class="hs-identifier hs-type">BotInfo</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-comment">-- ^ Can this variable be &#8869;? Models (mutually contradicting) @x ~ &#8869;@ and</span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-comment">--   @x &#8769; &#8869;@ constraints. E.g.</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-comment">--    * 'MaybeBot': Don't know; Neither @x ~ &#8869;@ nor @x &#8769; &#8869;@.</span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-comment">--    * 'IsBot': @x ~ &#8869;@</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-comment">--    * 'IsNotBot': @x &#8769; &#8869;@</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="vi_rcm"><span class="annot"><span class="annottext">VarInfo -&gt; ResidualCompleteMatches
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#vi_rcm"><span class="hs-identifier hs-var hs-var">vi_rcm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#ResidualCompleteMatches"><span class="hs-identifier hs-type">ResidualCompleteMatches</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-comment">-- ^ A cache of the associated COMPLETE sets. At any time a superset of</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-comment">-- possible constructors of each COMPLETE set. So, if it's not in here, we</span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-comment">-- can't possibly match on it. Complementary to 'vi_neg'. We still need it</span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-comment">-- to recognise completion of a COMPLETE set efficiently for large enums.</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-keyword">data</span><span> </span><span id="PmAltConApp"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConApp"><span class="hs-identifier hs-var">PmAltConApp</span></a></span></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PACA"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PACA"><span class="hs-identifier hs-var">PACA</span></a></span></span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="paca_con"><span class="annot"><span class="annottext">PmAltConApp -&gt; PmAltCon
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#paca_con"><span class="hs-identifier hs-var hs-var">paca_con</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltCon"><span class="hs-identifier hs-type">PmAltCon</span></a></span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="paca_tvs"><span class="annot"><span class="annottext">PmAltConApp -&gt; [Id]
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#paca_tvs"><span class="hs-identifier hs-var hs-var">paca_tvs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="paca_ids"><span class="annot"><span class="annottext">PmAltConApp -&gt; [Id]
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#paca_ids"><span class="hs-identifier hs-var hs-var">paca_ids</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="annot"><span class="hs-comment">-- | See 'vi_bot'.</span></span><span>
</span><span id="line-213"></span><span class="hs-keyword">data</span><span> </span><span id="BotInfo"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#BotInfo"><span class="hs-identifier hs-var">BotInfo</span></a></span></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="IsBot"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#IsBot"><span class="hs-identifier hs-var">IsBot</span></a></span></span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="IsNotBot"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#IsNotBot"><span class="hs-identifier hs-var">IsNotBot</span></a></span></span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MaybeBot"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#MaybeBot"><span class="hs-identifier hs-var">MaybeBot</span></a></span></span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621682726275"><span id="local-6989586621682726280"><span class="annot"><span class="annottext">BotInfo -&gt; BotInfo -&gt; Bool
(BotInfo -&gt; BotInfo -&gt; Bool)
-&gt; (BotInfo -&gt; BotInfo -&gt; Bool) -&gt; Eq BotInfo
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: BotInfo -&gt; BotInfo -&gt; Bool
== :: BotInfo -&gt; BotInfo -&gt; Bool
$c/= :: BotInfo -&gt; BotInfo -&gt; Bool
/= :: BotInfo -&gt; BotInfo -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConApp"><span class="hs-identifier hs-type">PmAltConApp</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-220"></span><span>  </span><span id="local-6989586621682726294"><span class="annot"><span class="annottext">ppr :: PmAltConApp -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PACA"><span class="hs-identifier hs-type">PACA</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">paca_con :: PmAltConApp -&gt; PmAltCon
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#paca_con"><span class="hs-identifier hs-var">paca_con</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682726295"><span class="annot"><span class="annottext">PmAltCon
</span><a href="#local-6989586621682726295"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">paca_tvs :: PmAltConApp -&gt; [Id]
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#paca_tvs"><span class="hs-identifier hs-var">paca_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682726296"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682726296"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">paca_ids :: PmAltConApp -&gt; [Id]
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#paca_ids"><span class="hs-identifier hs-var">paca_ids</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682726297"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682726297"><span class="hs-identifier hs-var">ids</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PmAltCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">PmAltCon
</span><a href="#local-6989586621682726295"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; [SDoc] -&gt; [SDoc]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(Id -&gt; SDoc) -&gt; [Id] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'@'</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; (Id -&gt; SDoc) -&gt; Id -&gt; SDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Id -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682726296"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; [SDoc] -&gt; [SDoc]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Id -&gt; SDoc) -&gt; [Id] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Id -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682726297"><span class="hs-identifier hs-var">ids</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#BotInfo"><span class="hs-identifier hs-type">BotInfo</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621682726307"><span class="annot"><span class="annottext">ppr :: BotInfo -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="annot"><span class="annottext">BotInfo
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#MaybeBot"><span class="hs-identifier hs-var">MaybeBot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#underscore"><span class="hs-identifier hs-var">underscore</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">BotInfo
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#IsBot"><span class="hs-identifier hs-var">IsBot</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;~&#8869;&quot;</span></span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">BotInfo
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#IsNotBot"><span class="hs-identifier hs-var">IsNotBot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8769;&#8869;&quot;</span></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><span class="hs-comment">-- | Not user-facing.</span></span><span>
</span><span id="line-229"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TmState"><span class="hs-identifier hs-type">TmState</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621682726321"><span class="annot"><span class="annottext">ppr :: TmState -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TmSt"><span class="hs-identifier hs-type">TmSt</span></a></span><span> </span><span id="local-6989586621682726322"><span class="annot"><span class="annottext">UniqSDFM Id VarInfo
</span><a href="#local-6989586621682726322"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span id="local-6989586621682726323"><span class="annot"><span class="annottext">CoreMap Id
</span><a href="#local-6989586621682726323"><span class="hs-identifier hs-var">reps</span></a></span></span><span> </span><span id="local-6989586621682726324"><span class="annot"><span class="annottext">DIdSet
</span><a href="#local-6989586621682726324"><span class="hs-identifier hs-var">dirty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSDFM Id VarInfo -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSDFM Id VarInfo
</span><a href="#local-6989586621682726322"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">CoreMap Id -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreMap Id
</span><a href="#local-6989586621682726323"><span class="hs-identifier hs-var">reps</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">DIdSet -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">DIdSet
</span><a href="#local-6989586621682726324"><span class="hs-identifier hs-var">dirty</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="annot"><span class="hs-comment">-- | Not user-facing.</span></span><span>
</span><span id="line-233"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#VarInfo"><span class="hs-identifier hs-type">VarInfo</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-234"></span><span>  </span><span id="local-6989586621682726353"><span class="annot"><span class="annottext">ppr :: VarInfo -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#VI"><span class="hs-identifier hs-type">VI</span></a></span><span> </span><span id="local-6989586621682726354"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726354"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682726355"><span class="annot"><span class="annottext">[PmAltConApp]
</span><a href="#local-6989586621682726355"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621682726356"><span class="annot"><span class="annottext">PmAltConSet
</span><a href="#local-6989586621682726356"><span class="hs-identifier hs-var">neg</span></a></span></span><span> </span><span id="local-6989586621682726357"><span class="annot"><span class="annottext">BotInfo
</span><a href="#local-6989586621682726357"><span class="hs-identifier hs-var">bot</span></a></span></span><span> </span><span id="local-6989586621682726358"><span class="annot"><span class="annottext">ResidualCompleteMatches
</span><a href="#local-6989586621682726358"><span class="hs-identifier hs-var">cache</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hcat"><span class="hs-identifier hs-var">hcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; [SDoc] -&gt; [SDoc]
forall doc. IsLine doc =&gt; doc -&gt; [doc] -&gt; [doc]
</span><a href="GHC.Utils.Outputable.html#punctuate"><span class="hs-identifier hs-var">punctuate</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682726363"><span class="hs-identifier hs-var">pp_x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682726364"><span class="hs-identifier hs-var">pp_pos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682726365"><span class="hs-identifier hs-var">pp_neg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BotInfo -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">BotInfo
</span><a href="#local-6989586621682726357"><span class="hs-identifier hs-var">bot</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682726366"><span class="hs-identifier hs-var">pp_cache</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-237"></span><span>      </span><span id="local-6989586621682726363"><span class="annot"><span class="annottext">pp_x :: SDoc
</span><a href="#local-6989586621682726363"><span class="hs-identifier hs-var hs-var">pp_x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726354"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Kind
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726354"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>      </span><span id="local-6989586621682726364"><span class="annot"><span class="annottext">pp_pos :: SDoc
</span><a href="#local-6989586621682726364"><span class="hs-identifier hs-var hs-var">pp_pos</span></a></span></span><span>
</span><span id="line-239"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[PmAltConApp]
</span><a href="#local-6989586621682726355"><span class="hs-identifier hs-var">pos</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#underscore"><span class="hs-identifier hs-var">underscore</span></a></span><span>
</span><span id="line-240"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682726369"><span class="annot"><span class="annottext">PmAltConApp
</span><a href="#local-6989586621682726369"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[PmAltConApp]
</span><a href="#local-6989586621682726355"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'~'</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PmAltConApp -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">PmAltConApp
</span><a href="#local-6989586621682726369"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-comment">-- suppress outer [_] if singleton</span><span>
</span><span id="line-241"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'~'</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[PmAltConApp] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[PmAltConApp]
</span><a href="#local-6989586621682726355"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-242"></span><span>      </span><span id="local-6989586621682726365"><span class="annot"><span class="annottext">pp_neg :: SDoc
</span><a href="#local-6989586621682726365"><span class="hs-identifier hs-var hs-var">pp_neg</span></a></span></span><span>
</span><span id="line-243"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PmAltConSet -&gt; Bool
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#isEmptyPmAltConSet"><span class="hs-identifier hs-var">isEmptyPmAltConSet</span></a></span><span> </span><span class="annot"><span class="annottext">PmAltConSet
</span><a href="#local-6989586621682726356"><span class="hs-identifier hs-var">neg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#underscore"><span class="hs-identifier hs-var">underscore</span></a></span><span>
</span><span id="line-244"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#8769;'</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PmAltConSet -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">PmAltConSet
</span><a href="#local-6989586621682726356"><span class="hs-identifier hs-var">neg</span></a></span><span>
</span><span id="line-245"></span><span>      </span><span id="local-6989586621682726366"><span class="annot"><span class="annottext">pp_cache :: SDoc
</span><a href="#local-6989586621682726366"><span class="hs-identifier hs-var hs-var">pp_cache</span></a></span></span><span>
</span><span id="line-246"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#RCM"><span class="hs-identifier hs-type">RCM</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DsCompleteMatch
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe DsCompleteMatches
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ResidualCompleteMatches
</span><a href="#local-6989586621682726358"><span class="hs-identifier hs-var">cache</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#underscore"><span class="hs-identifier hs-var">underscore</span></a></span><span>
</span><span id="line-247"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResidualCompleteMatches -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ResidualCompleteMatches
</span><a href="#local-6989586621682726358"><span class="hs-identifier hs-var">cache</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="annot"><span class="hs-comment">-- | Initial state of the term oracle.</span></span><span>
</span><span id="line-250"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#initTmState"><span class="hs-identifier hs-type">initTmState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TmState"><span class="hs-identifier hs-type">TmState</span></a></span><span>
</span><span id="line-251"></span><span id="initTmState"><span class="annot"><span class="annottext">initTmState :: TmState
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#initTmState"><span class="hs-identifier hs-var hs-var">initTmState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSDFM Id VarInfo -&gt; CoreMap Id -&gt; DIdSet -&gt; TmState
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#TmSt"><span class="hs-identifier hs-var">TmSt</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSDFM Id VarInfo
forall key ele. UniqSDFM key ele
</span><a href="GHC.Types.Unique.SDFM.html#emptyUSDFM"><span class="hs-identifier hs-var">emptyUSDFM</span></a></span><span> </span><span class="annot"><span class="annottext">CoreMap Id
forall a. CoreMap a
</span><a href="GHC.Core.Map.Expr.html#emptyCoreMap"><span class="hs-identifier hs-var">emptyCoreMap</span></a></span><span> </span><span class="annot"><span class="annottext">DIdSet
</span><a href="GHC.Types.Var.Set.html#emptyDVarSet"><span class="hs-identifier hs-var">emptyDVarSet</span></a></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- | A data type that caches for the 'VarInfo' of @x@ the results of querying</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- 'dsGetCompleteMatches' and then striking out all occurrences of @K@ for</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- which we already know @x &#8769; K@ from these sets.</span><span>
</span><span id="line-256"></span><span class="hs-comment">--</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- For motivation, see Section 5.3 in Lower Your Guards.</span><span>
</span><span id="line-258"></span><span class="hs-comment">-- See also Note [Implementation of COMPLETE pragmas]</span><span>
</span><span id="line-259"></span><span class="hs-keyword">data</span><span> </span><span id="ResidualCompleteMatches"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#ResidualCompleteMatches"><span class="hs-identifier hs-var">ResidualCompleteMatches</span></a></span></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="RCM"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#RCM"><span class="hs-identifier hs-var">RCM</span></a></span></span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="rcm_vanilla"><span class="annot"><span class="annottext">ResidualCompleteMatches -&gt; Maybe DsCompleteMatch
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#rcm_vanilla"><span class="hs-identifier hs-var hs-var">rcm_vanilla</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Types.CompleteMatch.html#DsCompleteMatch"><span class="hs-identifier hs-type">DsCompleteMatch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-comment">-- ^ The residual set for the vanilla COMPLETE set from the data defn.</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-comment">-- Tracked separately from 'rcm_pragmas', because it might only be</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-comment">-- known much later (when we have enough type information to see the 'TyCon'</span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-comment">-- of the match), or not at all even. Until that happens, it is 'Nothing'.</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="rcm_pragmas"><span class="annot"><span class="annottext">ResidualCompleteMatches -&gt; Maybe DsCompleteMatches
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#rcm_pragmas"><span class="hs-identifier hs-var hs-var">rcm_pragmas</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Types.CompleteMatch.html#DsCompleteMatches"><span class="hs-identifier hs-type">DsCompleteMatches</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-comment">-- ^ The residual sets for /all/ COMPLETE sets from pragmas that are</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-comment">-- visible when compiling this module. Querying that set with</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-comment">-- 'dsGetCompleteMatches' requires 'DsM', so we initialise it with 'Nothing'</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-comment">-- until first needed in a 'DsM' context.</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#getRcm"><span class="hs-identifier hs-type">getRcm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#ResidualCompleteMatches"><span class="hs-identifier hs-type">ResidualCompleteMatches</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.CompleteMatch.html#DsCompleteMatches"><span class="hs-identifier hs-type">DsCompleteMatches</span></a></span><span>
</span><span id="line-274"></span><span id="getRcm"><span class="annot"><span class="annottext">getRcm :: ResidualCompleteMatches -&gt; DsCompleteMatches
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#getRcm"><span class="hs-identifier hs-var hs-var">getRcm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#RCM"><span class="hs-identifier hs-type">RCM</span></a></span><span> </span><span id="local-6989586621682726376"><span class="annot"><span class="annottext">Maybe DsCompleteMatch
</span><a href="#local-6989586621682726376"><span class="hs-identifier hs-var">vanilla</span></a></span></span><span> </span><span id="local-6989586621682726377"><span class="annot"><span class="annottext">Maybe DsCompleteMatches
</span><a href="#local-6989586621682726377"><span class="hs-identifier hs-var">pragmas</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DsCompleteMatch -&gt; DsCompleteMatches
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">Maybe DsCompleteMatch
</span><a href="#local-6989586621682726376"><span class="hs-identifier hs-var">vanilla</span></a></span><span> </span><span class="annot"><span class="annottext">DsCompleteMatches -&gt; DsCompleteMatches -&gt; DsCompleteMatches
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">DsCompleteMatches -&gt; Maybe DsCompleteMatches -&gt; DsCompleteMatches
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe DsCompleteMatches
</span><a href="#local-6989586621682726377"><span class="hs-identifier hs-var">pragmas</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#isRcmInitialised"><span class="hs-identifier hs-type">isRcmInitialised</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#ResidualCompleteMatches"><span class="hs-identifier hs-type">ResidualCompleteMatches</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-277"></span><span id="isRcmInitialised"><span class="annot"><span class="annottext">isRcmInitialised :: ResidualCompleteMatches -&gt; Bool
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#isRcmInitialised"><span class="hs-identifier hs-var hs-var">isRcmInitialised</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#RCM"><span class="hs-identifier hs-type">RCM</span></a></span><span> </span><span id="local-6989586621682726380"><span class="annot"><span class="annottext">Maybe DsCompleteMatch
</span><a href="#local-6989586621682726380"><span class="hs-identifier hs-var">vanilla</span></a></span></span><span> </span><span id="local-6989586621682726381"><span class="annot"><span class="annottext">Maybe DsCompleteMatches
</span><a href="#local-6989586621682726381"><span class="hs-identifier hs-var">pragmas</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DsCompleteMatch -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe DsCompleteMatch
</span><a href="#local-6989586621682726380"><span class="hs-identifier hs-var">vanilla</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Maybe DsCompleteMatches -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe DsCompleteMatches
</span><a href="#local-6989586621682726381"><span class="hs-identifier hs-var">pragmas</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#ResidualCompleteMatches"><span class="hs-identifier hs-type">ResidualCompleteMatches</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-comment">-- formats as &quot;[{Nothing,Just},{P,Q}]&quot;</span><span>
</span><span id="line-281"></span><span>  </span><span id="local-6989586621682726390"><span class="annot"><span class="annottext">ppr :: ResidualCompleteMatches -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span id="local-6989586621682726391"><span class="annot"><span class="annottext">ResidualCompleteMatches
</span><a href="#local-6989586621682726391"><span class="hs-identifier hs-var">rcm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DsCompleteMatches -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResidualCompleteMatches -&gt; DsCompleteMatches
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#getRcm"><span class="hs-identifier hs-var">getRcm</span></a></span><span> </span><span class="annot"><span class="annottext">ResidualCompleteMatches
</span><a href="#local-6989586621682726391"><span class="hs-identifier hs-var">rcm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-----------------------</span><span>
</span><span id="line-284"></span><span class="annot"><span class="hs-comment">-- * Looking up VarInfo</span></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#emptyRCM"><span class="hs-identifier hs-type">emptyRCM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#ResidualCompleteMatches"><span class="hs-identifier hs-type">ResidualCompleteMatches</span></a></span><span>
</span><span id="line-287"></span><span id="emptyRCM"><span class="annot"><span class="annottext">emptyRCM :: ResidualCompleteMatches
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#emptyRCM"><span class="hs-identifier hs-var hs-var">emptyRCM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DsCompleteMatch
-&gt; Maybe DsCompleteMatches -&gt; ResidualCompleteMatches
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#RCM"><span class="hs-identifier hs-var">RCM</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DsCompleteMatch
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe DsCompleteMatches
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#emptyVarInfo"><span class="hs-identifier hs-type">emptyVarInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#VarInfo"><span class="hs-identifier hs-type">VarInfo</span></a></span><span>
</span><span id="line-290"></span><span id="emptyVarInfo"><span class="annot"><span class="annottext">emptyVarInfo :: Id -&gt; VarInfo
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#emptyVarInfo"><span class="hs-identifier hs-var hs-var">emptyVarInfo</span></a></span></span><span> </span><span id="local-6989586621682726394"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726394"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#VI"><span class="hs-identifier hs-type">VI</span></a></span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">vi_id :: Id
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#vi_id"><span class="hs-identifier hs-var">vi_id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726394"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vi_pos :: [PmAltConApp]
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#vi_pos"><span class="hs-identifier hs-var">vi_pos</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vi_neg :: PmAltConSet
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#vi_neg"><span class="hs-identifier hs-var">vi_neg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmAltConSet
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#emptyPmAltConSet"><span class="hs-identifier hs-var">emptyPmAltConSet</span></a></span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-comment">-- Why not set IsNotBot for unlifted type here?</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-comment">-- Because we'd have to trigger an inhabitation test, which we can't.</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-comment">-- See case (4) in Note [Strict fields and variables of unlifted type]</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-comment">-- in GHC.HsToCore.Pmc.Solver</span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vi_bot :: BotInfo
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#vi_bot"><span class="hs-identifier hs-var">vi_bot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BotInfo
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#MaybeBot"><span class="hs-identifier hs-var">MaybeBot</span></a></span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vi_rcm :: ResidualCompleteMatches
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#vi_rcm"><span class="hs-identifier hs-var">vi_rcm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResidualCompleteMatches
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#emptyRCM"><span class="hs-identifier hs-var">emptyRCM</span></a></span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#lookupVarInfo"><span class="hs-identifier hs-type">lookupVarInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TmState"><span class="hs-identifier hs-type">TmState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#VarInfo"><span class="hs-identifier hs-type">VarInfo</span></a></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- (lookupVarInfo tms x) tells what we know about 'x'</span><span>
</span><span id="line-305"></span><span id="lookupVarInfo"><span class="annot"><span class="annottext">lookupVarInfo :: TmState -&gt; Id -&gt; VarInfo
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#lookupVarInfo"><span class="hs-identifier hs-var hs-var">lookupVarInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TmSt"><span class="hs-identifier hs-type">TmSt</span></a></span><span> </span><span id="local-6989586621682726395"><span class="annot"><span class="annottext">UniqSDFM Id VarInfo
</span><a href="#local-6989586621682726395"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="annot"><span class="annottext">CoreMap Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DIdSet
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682726396"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726396"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarInfo -&gt; Maybe VarInfo -&gt; VarInfo
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; VarInfo
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#emptyVarInfo"><span class="hs-identifier hs-var">emptyVarInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726396"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqSDFM Id VarInfo -&gt; Id -&gt; Maybe VarInfo
forall key ele.
Uniquable key =&gt;
UniqSDFM key ele -&gt; key -&gt; Maybe ele
</span><a href="GHC.Types.Unique.SDFM.html#lookupUSDFM"><span class="hs-identifier hs-var">lookupUSDFM</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSDFM Id VarInfo
</span><a href="#local-6989586621682726395"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726396"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-comment">-- | Like @lookupVarInfo ts x@, but @lookupVarInfo ts x = (y, vi)@ also looks</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- through newtype constructors. We have @x ~ N1 (... (Nk y))@ such that the</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- returned @y@ doesn't have a positive newtype constructor constraint</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- associated with it (yet). The 'VarInfo' returned is that of @y@'s</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- representative.</span><span>
</span><span id="line-312"></span><span class="hs-comment">--</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- Careful, this means that @idType x@ might be different to @idType y@, even</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- modulo type normalisation!</span><span>
</span><span id="line-315"></span><span class="hs-comment">--</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- See also Note [Coverage checking Newtype matches] in GHC.HsToCore.Pmc.Solver.</span><span>
</span><span id="line-317"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#lookupVarInfoNT"><span class="hs-identifier hs-type">lookupVarInfoNT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TmState"><span class="hs-identifier hs-type">TmState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#VarInfo"><span class="hs-identifier hs-type">VarInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span id="lookupVarInfoNT"><span class="annot"><span class="annottext">lookupVarInfoNT :: TmState -&gt; Id -&gt; (Id, VarInfo)
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#lookupVarInfoNT"><span class="hs-identifier hs-var hs-var">lookupVarInfoNT</span></a></span></span><span> </span><span id="local-6989586621682726398"><span class="annot"><span class="annottext">TmState
</span><a href="#local-6989586621682726398"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621682726399"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726399"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TmState -&gt; Id -&gt; VarInfo
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#lookupVarInfo"><span class="hs-identifier hs-var">lookupVarInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TmState
</span><a href="#local-6989586621682726398"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726399"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#VI"><span class="hs-identifier hs-type">VI</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">vi_pos :: VarInfo -&gt; [PmAltConApp]
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#vi_pos"><span class="hs-identifier hs-var">vi_pos</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PmAltConApp] -&gt; Maybe Id
</span><a href="#local-6989586621682726400"><span class="hs-identifier hs-var">as_newtype</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682726401"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726401"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TmState -&gt; Id -&gt; (Id, VarInfo)
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#lookupVarInfoNT"><span class="hs-identifier hs-var">lookupVarInfoNT</span></a></span><span> </span><span class="annot"><span class="annottext">TmState
</span><a href="#local-6989586621682726398"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726401"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-320"></span><span>  </span><span id="local-6989586621682726402"><span class="annot"><span class="annottext">VarInfo
</span><a href="#local-6989586621682726402"><span class="hs-identifier hs-var">res</span></a></span></span><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726399"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarInfo
</span><a href="#local-6989586621682726402"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621682726400"><span class="annot"><span class="annottext">as_newtype :: [PmAltConApp] -&gt; Maybe Id
</span><a href="#local-6989586621682726400"><span class="hs-identifier hs-var hs-var">as_newtype</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Maybe Id
forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="annot"><span class="annottext">([Id] -&gt; Maybe Id)
-&gt; ([PmAltConApp] -&gt; [Id]) -&gt; [PmAltConApp] -&gt; Maybe Id
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PmAltConApp -&gt; Maybe Id) -&gt; [PmAltConApp] -&gt; [Id]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">PmAltConApp -&gt; Maybe Id
</span><a href="#local-6989586621682726405"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span id="local-6989586621682726405"><span class="annot"><span class="annottext">go :: PmAltConApp -&gt; Maybe Id
</span><a href="#local-6989586621682726405"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PACA"><span class="hs-identifier hs-type">PACA</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">paca_con :: PmAltConApp -&gt; PmAltCon
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#paca_con"><span class="hs-identifier hs-var">paca_con</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConLike"><span class="hs-identifier hs-type">PmAltConLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.ConLike.html#RealDataCon"><span class="hs-identifier hs-type">RealDataCon</span></a></span><span> </span><span id="local-6989586621682726408"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726408"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">paca_ids :: PmAltConApp -&gt; [Id]
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#paca_ids"><span class="hs-identifier hs-var">paca_ids</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682726409"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726409"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><span id="line-324"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isNewDataCon"><span class="hs-identifier hs-var">isNewDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726408"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Maybe Id
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726409"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><a href="#local-6989586621682726405"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">PmAltConApp
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Id
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span id="local-6989586621682726012"><span id="local-6989586621682726013"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#trvVarInfo"><span class="hs-identifier hs-type">trvVarInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621682726012"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#VarInfo"><span class="hs-identifier hs-type">VarInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682726012"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682726013"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#VarInfo"><span class="hs-identifier hs-type">VarInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#Nabla"><span class="hs-identifier hs-type">Nabla</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682726012"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682726013"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#Nabla"><span class="hs-identifier hs-type">Nabla</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-328"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#trvVarInfo"><span class="hs-pragma hs-type">trvVarInfo</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- This function is called a lot and we want to specilise it, not only</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- for the type class, but also for its 'f' function argument.</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- Before the INLINE pragma it sometimes inlined and sometimes didn't,</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- depending delicately on GHC's optimisations.  Better to use a pragma.</span><span>
</span><span id="line-333"></span><span id="trvVarInfo"><span class="annot"><span class="annottext">trvVarInfo :: forall (f :: * -&gt; *) a.
Functor f =&gt;
(VarInfo -&gt; f (a, VarInfo)) -&gt; Nabla -&gt; Id -&gt; f (a, Nabla)
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#trvVarInfo"><span class="hs-identifier hs-var hs-var">trvVarInfo</span></a></span></span><span> </span><span id="local-6989586621682726414"><span class="annot"><span class="annottext">VarInfo -&gt; f (a, VarInfo)
</span><a href="#local-6989586621682726414"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682726415"><span class="annot"><span class="annottext">nabla :: Nabla
</span><a href="#local-6989586621682726415"><span class="hs-identifier hs-var">nabla</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#MkNabla"><span class="hs-identifier hs-type">MkNabla</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">nabla_tm_st :: Nabla -&gt; TmState
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#nabla_tm_st"><span class="hs-identifier hs-var">nabla_tm_st</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682726416"><span class="annot"><span class="annottext">ts :: TmState
</span><a href="#local-6989586621682726416"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#TmSt"><span class="hs-identifier hs-type">TmSt</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">ts_facts :: TmState -&gt; UniqSDFM Id VarInfo
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#ts_facts"><span class="hs-identifier hs-var">ts_facts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682726417"><span class="annot"><span class="annottext">UniqSDFM Id VarInfo
</span><a href="#local-6989586621682726417"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span id="local-6989586621682726418"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726418"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, VarInfo) -&gt; (a, Nabla)
</span><a href="#local-6989586621682726419"><span class="hs-identifier hs-var">set_vi</span></a></span><span> </span><span class="annot"><span class="annottext">((a, VarInfo) -&gt; (a, Nabla)) -&gt; f (a, VarInfo) -&gt; f (a, Nabla)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">VarInfo -&gt; f (a, VarInfo)
</span><a href="#local-6989586621682726414"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TmState -&gt; Id -&gt; VarInfo
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#lookupVarInfo"><span class="hs-identifier hs-var">lookupVarInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TmState
</span><a href="#local-6989586621682726416"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726418"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-336"></span><span>    </span><span id="local-6989586621682726419"><span class="annot"><span class="annottext">set_vi :: (a, VarInfo) -&gt; (a, Nabla)
</span><a href="#local-6989586621682726419"><span class="hs-identifier hs-var hs-var">set_vi</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682726421"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682726421"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682726422"><span class="annot"><span class="annottext">VarInfo
</span><a href="#local-6989586621682726422"><span class="hs-identifier hs-var">vi'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-337"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682726421"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nabla
</span><a href="#local-6989586621682726415"><span class="hs-identifier hs-var">nabla</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#nabla_tm_st"><span class="hs-identifier hs-var">nabla_tm_st</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682726416"><span class="hs-identifier hs-type">ts</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#ts_facts"><span class="hs-identifier hs-var">ts_facts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Unique.SDFM.html#addToUSDFM"><span class="hs-identifier hs-type">addToUSDFM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682726417"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#vi_id"><span class="hs-identifier hs-var">vi_id</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682726422"><span class="hs-identifier hs-type">vi'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682726422"><span class="hs-identifier hs-type">vi'</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="hs-comment">------------------------------------------------</span><span>
</span><span id="line-340"></span><span class="annot"><span class="hs-comment">-- * Exported utility functions querying 'Nabla'</span></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#lookupRefuts"><span class="hs-identifier hs-type">lookupRefuts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#Nabla"><span class="hs-identifier hs-type">Nabla</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltCon"><span class="hs-identifier hs-type">PmAltCon</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- Unfortunately we need the extra bit of polymorphism and the unfortunate</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- duplication of lookupVarInfo here.</span><span>
</span><span id="line-345"></span><span id="lookupRefuts"><span class="annot"><span class="annottext">lookupRefuts :: Nabla -&gt; Id -&gt; [PmAltCon]
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#lookupRefuts"><span class="hs-identifier hs-var hs-var">lookupRefuts</span></a></span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#MkNabla"><span class="hs-identifier hs-type">MkNabla</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">nabla_tm_st :: Nabla -&gt; TmState
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#nabla_tm_st"><span class="hs-identifier hs-var">nabla_tm_st</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682726424"><span class="annot"><span class="annottext">TmState
</span><a href="#local-6989586621682726424"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span id="local-6989586621682726425"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726425"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-346"></span><span>  </span><span class="annot"><span class="annottext">PmAltConSet -&gt; [PmAltCon]
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmAltConSetElems"><span class="hs-identifier hs-var">pmAltConSetElems</span></a></span><span> </span><span class="annot"><span class="annottext">(PmAltConSet -&gt; [PmAltCon]) -&gt; PmAltConSet -&gt; [PmAltCon]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VarInfo -&gt; PmAltConSet
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#vi_neg"><span class="hs-identifier hs-var">vi_neg</span></a></span><span> </span><span class="annot"><span class="annottext">(VarInfo -&gt; PmAltConSet) -&gt; VarInfo -&gt; PmAltConSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TmState -&gt; Id -&gt; VarInfo
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#lookupVarInfo"><span class="hs-identifier hs-var">lookupVarInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TmState
</span><a href="#local-6989586621682726424"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726425"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#isDataConSolution"><span class="hs-identifier hs-type">isDataConSolution</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConApp"><span class="hs-identifier hs-type">PmAltConApp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-349"></span><span id="isDataConSolution"><span class="annot"><span class="annottext">isDataConSolution :: PmAltConApp -&gt; Bool
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#isDataConSolution"><span class="hs-identifier hs-var hs-var">isDataConSolution</span></a></span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PACA"><span class="hs-identifier hs-type">PACA</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">paca_con :: PmAltConApp -&gt; PmAltCon
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#paca_con"><span class="hs-identifier hs-var">paca_con</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConLike"><span class="hs-identifier hs-type">PmAltConLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.ConLike.html#RealDataCon"><span class="hs-identifier hs-type">RealDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-350"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#isDataConSolution"><span class="hs-identifier hs-var">isDataConSolution</span></a></span><span> </span><span class="annot"><span class="annottext">PmAltConApp
</span><span class="hs-identifier">_</span></span><span>                                             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="hs-comment">-- @lookupSolution nabla x@ picks a single solution ('vi_pos') of @x@ from</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- possibly many, preferring 'RealDataCon' solutions whenever possible.</span><span>
</span><span id="line-354"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#lookupSolution"><span class="hs-identifier hs-type">lookupSolution</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#Nabla"><span class="hs-identifier hs-type">Nabla</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConApp"><span class="hs-identifier hs-type">PmAltConApp</span></a></span><span>
</span><span id="line-355"></span><span id="lookupSolution"><span class="annot"><span class="annottext">lookupSolution :: Nabla -&gt; Id -&gt; Maybe PmAltConApp
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#lookupSolution"><span class="hs-identifier hs-var hs-var">lookupSolution</span></a></span></span><span> </span><span id="local-6989586621682726427"><span class="annot"><span class="annottext">Nabla
</span><a href="#local-6989586621682726427"><span class="hs-identifier hs-var">nabla</span></a></span></span><span> </span><span id="local-6989586621682726428"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726428"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VarInfo -&gt; [PmAltConApp]
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#vi_pos"><span class="hs-identifier hs-var">vi_pos</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TmState -&gt; Id -&gt; VarInfo
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#lookupVarInfo"><span class="hs-identifier hs-var">lookupVarInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nabla -&gt; TmState
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#nabla_tm_st"><span class="hs-identifier hs-var">nabla_tm_st</span></a></span><span> </span><span class="annot"><span class="annottext">Nabla
</span><a href="#local-6989586621682726427"><span class="hs-identifier hs-var">nabla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726428"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PmAltConApp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-357"></span><span>  </span><span id="local-6989586621682726429"><span class="annot"><span class="annottext">pos :: [PmAltConApp]
</span><a href="#local-6989586621682726429"><span class="hs-identifier hs-var">pos</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621682726430"><span class="annot"><span class="annottext">PmAltConApp
</span><a href="#local-6989586621682726430"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[PmAltConApp]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682726431"><span class="annot"><span class="annottext">PmAltConApp
</span><a href="#local-6989586621682726431"><span class="hs-identifier hs-var">sol</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(PmAltConApp -&gt; Bool) -&gt; [PmAltConApp] -&gt; Maybe PmAltConApp
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="annot"><span class="annottext">PmAltConApp -&gt; Bool
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#isDataConSolution"><span class="hs-identifier hs-var">isDataConSolution</span></a></span><span> </span><span class="annot"><span class="annottext">[PmAltConApp]
</span><a href="#local-6989586621682726429"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PmAltConApp -&gt; Maybe PmAltConApp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PmAltConApp
</span><a href="#local-6989586621682726431"><span class="hs-identifier hs-var">sol</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PmAltConApp -&gt; Maybe PmAltConApp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PmAltConApp
</span><a href="#local-6989586621682726430"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- The rest is just providing an IR for (overloaded!) literals and AltCons that</span><span>
</span><span id="line-363"></span><span class="hs-comment">-- sits between Hs and Core. We need a reliable way to detect and determine</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- equality between them, which is impossible with Hs (too expressive) and with</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- Core (no notion of overloaded literals, and even plain 'Int' literals are</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- actually constructor apps). Also String literals are troublesome.</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-comment">-- | Literals (simple and overloaded ones) for pattern match checking.</span><span>
</span><span id="line-369"></span><span class="hs-comment">--</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- See Note [Undecidable Equality for PmAltCons]</span><span>
</span><span id="line-371"></span><span class="hs-keyword">data</span><span> </span><span id="PmLit"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PmLit"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a></span></span><span>
</span><span id="line-372"></span><span>           </span><span class="hs-special">{</span><span> </span><span id="pm_lit_ty"><span class="annot"><span class="annottext">PmLit -&gt; Kind
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#pm_lit_ty"><span class="hs-identifier hs-var hs-var">pm_lit_ty</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-373"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="pm_lit_val"><span class="annot"><span class="annottext">PmLit -&gt; PmLitValue
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#pm_lit_val"><span class="hs-identifier hs-var hs-var">pm_lit_val</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitValue"><span class="hs-identifier hs-type">PmLitValue</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="hs-keyword">data</span><span> </span><span id="PmLitValue"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitValue"><span class="hs-identifier hs-var">PmLitValue</span></a></span></span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PmLitInt"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitInt"><span class="hs-identifier hs-var">PmLitInt</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PmLitRat"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitRat"><span class="hs-identifier hs-var">PmLitRat</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PmLitChar"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitChar"><span class="hs-identifier hs-var">PmLitChar</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-comment">-- We won't actually see PmLitString in the oracle since we desugar strings to</span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-comment">-- lists</span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PmLitString"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitString"><span class="hs-identifier hs-var">PmLitString</span></a></span></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PmLitOverInt"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverInt"><span class="hs-identifier hs-var">PmLitOverInt</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">{- How often Negated? -}</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-383"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PmLitOverRat"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverRat"><span class="hs-identifier hs-var">PmLitOverRat</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">{- How often Negated? -}</span><span> </span><span class="annot"><a href="GHC.Types.SourceText.html#FractionalLit"><span class="hs-identifier hs-type">FractionalLit</span></a></span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PmLitOverString"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverString"><span class="hs-identifier hs-var">PmLitOverString</span></a></span></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">-- | Undecidable semantic equality result.</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- See Note [Undecidable Equality for PmAltCons]</span><span>
</span><span id="line-388"></span><span class="hs-keyword">data</span><span> </span><span id="PmEquality"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmEquality"><span class="hs-identifier hs-var">PmEquality</span></a></span></span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Equal"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#Equal"><span class="hs-identifier hs-var">Equal</span></a></span></span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Disjoint"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#Disjoint"><span class="hs-identifier hs-var">Disjoint</span></a></span></span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PossiblyOverlap"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PossiblyOverlap"><span class="hs-identifier hs-var">PossiblyOverlap</span></a></span></span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682726446"><span id="local-6989586621682726450"><span class="annot"><span class="annottext">PmEquality -&gt; PmEquality -&gt; Bool
(PmEquality -&gt; PmEquality -&gt; Bool)
-&gt; (PmEquality -&gt; PmEquality -&gt; Bool) -&gt; Eq PmEquality
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: PmEquality -&gt; PmEquality -&gt; Bool
== :: PmEquality -&gt; PmEquality -&gt; Bool
$c/= :: PmEquality -&gt; PmEquality -&gt; Bool
/= :: PmEquality -&gt; PmEquality -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682726454"><span id="local-6989586621682726456"><span id="local-6989586621682726460"><span class="annot"><span class="annottext">Int -&gt; PmEquality -&gt; ShowS
[PmEquality] -&gt; ShowS
PmEquality -&gt; String
(Int -&gt; PmEquality -&gt; ShowS)
-&gt; (PmEquality -&gt; String)
-&gt; ([PmEquality] -&gt; ShowS)
-&gt; Show PmEquality
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; PmEquality -&gt; ShowS
showsPrec :: Int -&gt; PmEquality -&gt; ShowS
$cshow :: PmEquality -&gt; String
show :: PmEquality -&gt; String
$cshowList :: [PmEquality] -&gt; ShowS
showList :: [PmEquality] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span class="annot"><span class="hs-comment">-- | When 'PmEquality' can be decided. @True &lt;=&gt; Equal@, @False &lt;=&gt; Disjoint@.</span></span><span>
</span><span id="line-395"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#decEquality"><span class="hs-identifier hs-type">decEquality</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmEquality"><span class="hs-identifier hs-type">PmEquality</span></a></span><span>
</span><span id="line-396"></span><span id="decEquality"><span class="annot"><span class="annottext">decEquality :: Bool -&gt; PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#decEquality"><span class="hs-identifier hs-var hs-var">decEquality</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#Equal"><span class="hs-identifier hs-var">Equal</span></a></span><span>
</span><span id="line-397"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#decEquality"><span class="hs-identifier hs-var">decEquality</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#Disjoint"><span class="hs-identifier hs-var">Disjoint</span></a></span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-comment">-- | Undecidable equality for values represented by 'PmLit's.</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- See Note [Undecidable Equality for PmAltCons]</span><span>
</span><span id="line-401"></span><span class="hs-comment">--</span><span>
</span><span id="line-402"></span><span class="hs-comment">-- * @Just True@ ==&gt; Surely equal</span><span>
</span><span id="line-403"></span><span class="hs-comment">-- * @Just False@ ==&gt; Surely different (non-overlapping, even!)</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- * @Nothing@ ==&gt; Equality relation undecidable</span><span>
</span><span id="line-405"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#eqPmLit"><span class="hs-identifier hs-type">eqPmLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmEquality"><span class="hs-identifier hs-type">PmEquality</span></a></span><span>
</span><span id="line-406"></span><span id="eqPmLit"><span class="annot"><span class="annottext">eqPmLit :: PmLit -&gt; PmLit -&gt; PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#eqPmLit"><span class="hs-identifier hs-var hs-var">eqPmLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span id="local-6989586621682726466"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726466"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682726467"><span class="annot"><span class="annottext">PmLitValue
</span><a href="#local-6989586621682726467"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span id="local-6989586621682726468"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726468"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span id="local-6989586621682726469"><span class="annot"><span class="annottext">PmLitValue
</span><a href="#local-6989586621682726469"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-comment">-- no haddock | pprTrace &quot;eqPmLit&quot; (ppr t1 &lt;+&gt; ppr v1 $$ ppr t2 &lt;+&gt; ppr v2) False = undefined</span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726466"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Kind -&gt; Kind -&gt; Bool
Kind -&gt; Kind -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726468"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#Disjoint"><span class="hs-identifier hs-var">Disjoint</span></a></span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; PmLitValue -&gt; PmEquality
</span><a href="#local-6989586621682726471"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">PmLitValue
</span><a href="#local-6989586621682726467"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">PmLitValue
</span><a href="#local-6989586621682726469"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-411"></span><span>    </span><span id="local-6989586621682726471"><span class="annot"><span class="annottext">go :: PmLitValue -&gt; PmLitValue -&gt; PmEquality
</span><a href="#local-6989586621682726471"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitInt"><span class="hs-identifier hs-type">PmLitInt</span></a></span><span> </span><span id="local-6989586621682726486"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726486"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitInt"><span class="hs-identifier hs-type">PmLitInt</span></a></span><span> </span><span id="local-6989586621682726487"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726487"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#decEquality"><span class="hs-identifier hs-var">decEquality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726486"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726487"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>    </span><span class="annot"><a href="#local-6989586621682726471"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitRat"><span class="hs-identifier hs-type">PmLitRat</span></a></span><span> </span><span id="local-6989586621682726488"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682726488"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitRat"><span class="hs-identifier hs-type">PmLitRat</span></a></span><span> </span><span id="local-6989586621682726489"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682726489"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#decEquality"><span class="hs-identifier hs-var">decEquality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682726488"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682726489"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>    </span><span class="annot"><a href="#local-6989586621682726471"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitChar"><span class="hs-identifier hs-type">PmLitChar</span></a></span><span> </span><span id="local-6989586621682726490"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682726490"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitChar"><span class="hs-identifier hs-type">PmLitChar</span></a></span><span> </span><span id="local-6989586621682726491"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682726491"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#decEquality"><span class="hs-identifier hs-var">decEquality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682726490"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682726491"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>    </span><span class="annot"><a href="#local-6989586621682726471"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitString"><span class="hs-identifier hs-type">PmLitString</span></a></span><span> </span><span id="local-6989586621682726492"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682726492"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitString"><span class="hs-identifier hs-type">PmLitString</span></a></span><span> </span><span id="local-6989586621682726493"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682726493"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#decEquality"><span class="hs-identifier hs-var">decEquality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682726492"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">FastString -&gt; FastString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682726493"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>    </span><span class="annot"><a href="#local-6989586621682726471"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverInt"><span class="hs-identifier hs-type">PmLitOverInt</span></a></span><span> </span><span id="local-6989586621682726494"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726494"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span id="local-6989586621682726495"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726495"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverInt"><span class="hs-identifier hs-type">PmLitOverInt</span></a></span><span> </span><span id="local-6989586621682726496"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726496"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span id="local-6989586621682726497"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726497"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726494"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726496"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726495"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726497"><span class="hs-identifier hs-var">i2</span></a></span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#Equal"><span class="hs-identifier hs-var">Equal</span></a></span><span>
</span><span id="line-417"></span><span>    </span><span class="annot"><a href="#local-6989586621682726471"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverRat"><span class="hs-identifier hs-type">PmLitOverRat</span></a></span><span> </span><span id="local-6989586621682726498"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726498"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span id="local-6989586621682726499"><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621682726499"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverRat"><span class="hs-identifier hs-type">PmLitOverRat</span></a></span><span> </span><span id="local-6989586621682726500"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726500"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span id="local-6989586621682726501"><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621682726501"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726498"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726500"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621682726499"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">FractionalLit -&gt; FractionalLit -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621682726501"><span class="hs-identifier hs-var">r2</span></a></span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#Equal"><span class="hs-identifier hs-var">Equal</span></a></span><span>
</span><span id="line-419"></span><span>    </span><span class="annot"><a href="#local-6989586621682726471"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverString"><span class="hs-identifier hs-type">PmLitOverString</span></a></span><span> </span><span id="local-6989586621682726502"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682726502"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverString"><span class="hs-identifier hs-type">PmLitOverString</span></a></span><span> </span><span id="local-6989586621682726503"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682726503"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682726502"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">FastString -&gt; FastString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682726503"><span class="hs-identifier hs-var">s2</span></a></span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#Equal"><span class="hs-identifier hs-var">Equal</span></a></span><span>
</span><span id="line-421"></span><span>    </span><span class="annot"><a href="#local-6989586621682726471"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">PmLitValue
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="annot"><span class="annottext">PmLitValue
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PossiblyOverlap"><span class="hs-identifier hs-var">PossiblyOverlap</span></a></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="annot"><span class="hs-comment">-- | Syntactic equality.</span></span><span>
</span><span id="line-424"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682726506"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-425"></span><span>  </span><span id="local-6989586621682726509"><span class="annot"><span class="annottext">PmLit
</span><a href="#local-6989586621682726509"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682726510"><span class="annot"><span class="annottext">== :: PmLit -&gt; PmLit -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621682726511"><span class="annot"><span class="annottext">PmLit
</span><a href="#local-6989586621682726511"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLit -&gt; PmLit -&gt; PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#eqPmLit"><span class="hs-identifier hs-var">eqPmLit</span></a></span><span> </span><span class="annot"><span class="annottext">PmLit
</span><a href="#local-6989586621682726509"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PmLit
</span><a href="#local-6989586621682726511"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">PmEquality -&gt; PmEquality -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#Equal"><span class="hs-identifier hs-var">Equal</span></a></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="annot"><span class="hs-comment">-- | Type of a 'PmLit'</span></span><span>
</span><span id="line-428"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmLitType"><span class="hs-identifier hs-type">pmLitType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-429"></span><span id="pmLitType"><span class="annot"><span class="annottext">pmLitType :: PmLit -&gt; Kind
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmLitType"><span class="hs-identifier hs-var hs-var">pmLitType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span id="local-6989586621682726512"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726512"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">PmLitValue
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726512"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="hs-comment">-- | Undecidable equality for values represented by 'ConLike's.</span><span>
</span><span id="line-432"></span><span class="hs-comment">-- See Note [Undecidable Equality for PmAltCons].</span><span>
</span><span id="line-433"></span><span class="hs-comment">-- 'PatSynCon's aren't enforced to be generative, so two syntactically different</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- 'PatSynCon's might match the exact same values. Without looking into and</span><span>
</span><span id="line-435"></span><span class="hs-comment">-- reasoning about the pattern synonym's definition, we can't decide if their</span><span>
</span><span id="line-436"></span><span class="hs-comment">-- sets of matched values is different.</span><span>
</span><span id="line-437"></span><span class="hs-comment">--</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- * @Just True@ ==&gt; Surely equal</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- * @Just False@ ==&gt; Surely different (non-overlapping, even!)</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- * @Nothing@ ==&gt; Equality relation undecidable</span><span>
</span><span id="line-441"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#eqConLike"><span class="hs-identifier hs-type">eqConLike</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmEquality"><span class="hs-identifier hs-type">PmEquality</span></a></span><span>
</span><span id="line-442"></span><span id="eqConLike"><span class="annot"><span class="annottext">eqConLike :: ConLike -&gt; ConLike -&gt; PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#eqConLike"><span class="hs-identifier hs-var hs-var">eqConLike</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.ConLike.html#RealDataCon"><span class="hs-identifier hs-type">RealDataCon</span></a></span><span> </span><span id="local-6989586621682726515"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726515"><span class="hs-identifier hs-var">dc1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.ConLike.html#RealDataCon"><span class="hs-identifier hs-type">RealDataCon</span></a></span><span> </span><span id="local-6989586621682726516"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726516"><span class="hs-identifier hs-var">dc2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#decEquality"><span class="hs-identifier hs-var">decEquality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726515"><span class="hs-identifier hs-var">dc1</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; DataCon -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726516"><span class="hs-identifier hs-var">dc2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#eqConLike"><span class="hs-identifier hs-var">eqConLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.ConLike.html#PatSynCon"><span class="hs-identifier hs-type">PatSynCon</span></a></span><span> </span><span id="local-6989586621682726517"><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621682726517"><span class="hs-identifier hs-var">psc1</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.ConLike.html#PatSynCon"><span class="hs-identifier hs-type">PatSynCon</span></a></span><span> </span><span id="local-6989586621682726518"><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621682726518"><span class="hs-identifier hs-var">psc2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621682726517"><span class="hs-identifier hs-var">psc1</span></a></span><span> </span><span class="annot"><span class="annottext">PatSyn -&gt; PatSyn -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621682726518"><span class="hs-identifier hs-var">psc2</span></a></span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#Equal"><span class="hs-identifier hs-var">Equal</span></a></span><span>
</span><span id="line-446"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#eqConLike"><span class="hs-identifier hs-var">eqConLike</span></a></span><span> </span><span class="annot"><span class="annottext">ConLike
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="annot"><span class="annottext">ConLike
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PossiblyOverlap"><span class="hs-identifier hs-var">PossiblyOverlap</span></a></span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span class="hs-comment">-- | Represents the head of a match against a 'ConLike' or literal.</span><span>
</span><span id="line-449"></span><span class="hs-comment">-- Really similar to 'GHC.Core.AltCon'.</span><span>
</span><span id="line-450"></span><span class="hs-keyword">data</span><span> </span><span id="PmAltCon"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltCon"><span class="hs-identifier hs-var">PmAltCon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PmAltConLike"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConLike"><span class="hs-identifier hs-var">PmAltConLike</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a></span><span>
</span><span id="line-451"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="PmAltLit"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltLit"><span class="hs-identifier hs-var">PmAltLit</span></a></span></span><span>     </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-keyword">data</span><span> </span><span id="PmAltConSet"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConSet"><span class="hs-identifier hs-var">PmAltConSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PACS"><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PACS"><span class="hs-identifier hs-var">PACS</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.DSet.html#UniqDSet"><span class="hs-identifier hs-type">UniqDSet</span></a></span><span> </span><span class="annot"><a href="GHC.Core.ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#emptyPmAltConSet"><span class="hs-identifier hs-type">emptyPmAltConSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConSet"><span class="hs-identifier hs-type">PmAltConSet</span></a></span><span>
</span><span id="line-456"></span><span id="emptyPmAltConSet"><span class="annot"><span class="annottext">emptyPmAltConSet :: PmAltConSet
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#emptyPmAltConSet"><span class="hs-identifier hs-var hs-var">emptyPmAltConSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqDSet ConLike -&gt; [PmLit] -&gt; PmAltConSet
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PACS"><span class="hs-identifier hs-var">PACS</span></a></span><span> </span><span class="annot"><span class="annottext">UniqDSet ConLike
forall a. UniqDSet a
</span><a href="GHC.Types.Unique.DSet.html#emptyUniqDSet"><span class="hs-identifier hs-var">emptyUniqDSet</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#isEmptyPmAltConSet"><span class="hs-identifier hs-type">isEmptyPmAltConSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConSet"><span class="hs-identifier hs-type">PmAltConSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-459"></span><span id="isEmptyPmAltConSet"><span class="annot"><span class="annottext">isEmptyPmAltConSet :: PmAltConSet -&gt; Bool
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#isEmptyPmAltConSet"><span class="hs-identifier hs-var hs-var">isEmptyPmAltConSet</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PACS"><span class="hs-identifier hs-type">PACS</span></a></span><span> </span><span id="local-6989586621682726523"><span class="annot"><span class="annottext">UniqDSet ConLike
</span><a href="#local-6989586621682726523"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span id="local-6989586621682726524"><span class="annot"><span class="annottext">[PmLit]
</span><a href="#local-6989586621682726524"><span class="hs-identifier hs-var">lits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqDSet ConLike -&gt; Bool
forall a. UniqDSet a -&gt; Bool
</span><a href="GHC.Types.Unique.DSet.html#isEmptyUniqDSet"><span class="hs-identifier hs-var">isEmptyUniqDSet</span></a></span><span> </span><span class="annot"><span class="annottext">UniqDSet ConLike
</span><a href="#local-6989586621682726523"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[PmLit] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[PmLit]
</span><a href="#local-6989586621682726524"><span class="hs-identifier hs-var">lits</span></a></span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span class="hs-comment">-- | Whether there is a 'PmAltCon' in the 'PmAltConSet' that compares 'Equal' to</span><span>
</span><span id="line-462"></span><span class="hs-comment">-- the given 'PmAltCon' according to 'eqPmAltCon'.</span><span>
</span><span id="line-463"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#elemPmAltConSet"><span class="hs-identifier hs-type">elemPmAltConSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltCon"><span class="hs-identifier hs-type">PmAltCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConSet"><span class="hs-identifier hs-type">PmAltConSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-464"></span><span id="elemPmAltConSet"><span class="annot"><span class="annottext">elemPmAltConSet :: PmAltCon -&gt; PmAltConSet -&gt; Bool
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#elemPmAltConSet"><span class="hs-identifier hs-var hs-var">elemPmAltConSet</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConLike"><span class="hs-identifier hs-type">PmAltConLike</span></a></span><span> </span><span id="local-6989586621682726527"><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621682726527"><span class="hs-identifier hs-var">cl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PACS"><span class="hs-identifier hs-type">PACS</span></a></span><span> </span><span id="local-6989586621682726528"><span class="annot"><span class="annottext">UniqDSet ConLike
</span><a href="#local-6989586621682726528"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span class="annot"><span class="annottext">[PmLit]
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConLike -&gt; UniqDSet ConLike -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; UniqDSet a -&gt; Bool
</span><a href="GHC.Types.Unique.DSet.html#elementOfUniqDSet"><span class="hs-identifier hs-var">elementOfUniqDSet</span></a></span><span> </span><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621682726527"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="annot"><span class="annottext">UniqDSet ConLike
</span><a href="#local-6989586621682726528"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-465"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#elemPmAltConSet"><span class="hs-identifier hs-var">elemPmAltConSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltLit"><span class="hs-identifier hs-type">PmAltLit</span></a></span><span> </span><span id="local-6989586621682726530"><span class="annot"><span class="annottext">PmLit
</span><a href="#local-6989586621682726530"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PACS"><span class="hs-identifier hs-type">PACS</span></a></span><span> </span><span class="annot"><span class="annottext">UniqDSet ConLike
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621682726531"><span class="annot"><span class="annottext">[PmLit]
</span><a href="#local-6989586621682726531"><span class="hs-identifier hs-var">lits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLit -&gt; [PmLit] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">elem</span></span><span> </span><span class="annot"><span class="annottext">PmLit
</span><a href="#local-6989586621682726530"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="annot"><span class="annottext">[PmLit]
</span><a href="#local-6989586621682726531"><span class="hs-identifier hs-var">lits</span></a></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#extendPmAltConSet"><span class="hs-identifier hs-type">extendPmAltConSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConSet"><span class="hs-identifier hs-type">PmAltConSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltCon"><span class="hs-identifier hs-type">PmAltCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConSet"><span class="hs-identifier hs-type">PmAltConSet</span></a></span><span>
</span><span id="line-468"></span><span id="extendPmAltConSet"><span class="annot"><span class="annottext">extendPmAltConSet :: PmAltConSet -&gt; PmAltCon -&gt; PmAltConSet
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#extendPmAltConSet"><span class="hs-identifier hs-var hs-var">extendPmAltConSet</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PACS"><span class="hs-identifier hs-type">PACS</span></a></span><span> </span><span id="local-6989586621682726533"><span class="annot"><span class="annottext">UniqDSet ConLike
</span><a href="#local-6989586621682726533"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span id="local-6989586621682726534"><span class="annot"><span class="annottext">[PmLit]
</span><a href="#local-6989586621682726534"><span class="hs-identifier hs-var">lits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConLike"><span class="hs-identifier hs-type">PmAltConLike</span></a></span><span> </span><span id="local-6989586621682726535"><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621682726535"><span class="hs-identifier hs-var">cl</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqDSet ConLike -&gt; [PmLit] -&gt; PmAltConSet
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PACS"><span class="hs-identifier hs-var">PACS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqDSet ConLike -&gt; ConLike -&gt; UniqDSet ConLike
forall a. Uniquable a =&gt; UniqDSet a -&gt; a -&gt; UniqDSet a
</span><a href="GHC.Types.Unique.DSet.html#addOneToUniqDSet"><span class="hs-identifier hs-var">addOneToUniqDSet</span></a></span><span> </span><span class="annot"><span class="annottext">UniqDSet ConLike
</span><a href="#local-6989586621682726533"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621682726535"><span class="hs-identifier hs-var">cl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PmLit]
</span><a href="#local-6989586621682726534"><span class="hs-identifier hs-var">lits</span></a></span><span>
</span><span id="line-470"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#extendPmAltConSet"><span class="hs-identifier hs-var">extendPmAltConSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PACS"><span class="hs-identifier hs-type">PACS</span></a></span><span> </span><span id="local-6989586621682726537"><span class="annot"><span class="annottext">UniqDSet ConLike
</span><a href="#local-6989586621682726537"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span id="local-6989586621682726538"><span class="annot"><span class="annottext">[PmLit]
</span><a href="#local-6989586621682726538"><span class="hs-identifier hs-var">lits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltLit"><span class="hs-identifier hs-type">PmAltLit</span></a></span><span> </span><span id="local-6989586621682726539"><span class="annot"><span class="annottext">PmLit
</span><a href="#local-6989586621682726539"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqDSet ConLike -&gt; [PmLit] -&gt; PmAltConSet
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PACS"><span class="hs-identifier hs-var">PACS</span></a></span><span> </span><span class="annot"><span class="annottext">UniqDSet ConLike
</span><a href="#local-6989586621682726537"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PmLit] -&gt; [PmLit] -&gt; [PmLit]
forall a.
(HasDebugCallStack, Outputable a, Eq a) =&gt;
[a] -&gt; [a] -&gt; [a]
</span><a href="GHC.Data.List.SetOps.html#unionLists"><span class="hs-identifier hs-var">unionLists</span></a></span><span> </span><span class="annot"><span class="annottext">[PmLit]
</span><a href="#local-6989586621682726538"><span class="hs-identifier hs-var">lits</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PmLit
</span><a href="#local-6989586621682726539"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmAltConSetElems"><span class="hs-identifier hs-type">pmAltConSetElems</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConSet"><span class="hs-identifier hs-type">PmAltConSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltCon"><span class="hs-identifier hs-type">PmAltCon</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-474"></span><span id="pmAltConSetElems"><span class="annot"><span class="annottext">pmAltConSetElems :: PmAltConSet -&gt; [PmAltCon]
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmAltConSetElems"><span class="hs-identifier hs-var hs-var">pmAltConSetElems</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PACS"><span class="hs-identifier hs-type">PACS</span></a></span><span> </span><span id="local-6989586621682726540"><span class="annot"><span class="annottext">UniqDSet ConLike
</span><a href="#local-6989586621682726540"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span id="local-6989586621682726541"><span class="annot"><span class="annottext">[PmLit]
</span><a href="#local-6989586621682726541"><span class="hs-identifier hs-var">lits</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConLike -&gt; PmAltCon) -&gt; [ConLike] -&gt; [PmAltCon]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ConLike -&gt; PmAltCon
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConLike"><span class="hs-identifier hs-var">PmAltConLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqDSet ConLike -&gt; [ConLike]
forall a. UniqDSet a -&gt; [a]
</span><a href="GHC.Types.Unique.DSet.html#uniqDSetToList"><span class="hs-identifier hs-var">uniqDSetToList</span></a></span><span> </span><span class="annot"><span class="annottext">UniqDSet ConLike
</span><a href="#local-6989586621682726540"><span class="hs-identifier hs-var">cls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PmAltCon] -&gt; [PmAltCon] -&gt; [PmAltCon]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(PmLit -&gt; PmAltCon) -&gt; [PmLit] -&gt; [PmAltCon]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PmLit -&gt; PmAltCon
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltLit"><span class="hs-identifier hs-var">PmAltLit</span></a></span><span> </span><span class="annot"><span class="annottext">[PmLit]
</span><a href="#local-6989586621682726541"><span class="hs-identifier hs-var">lits</span></a></span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConSet"><span class="hs-identifier hs-type">PmAltConSet</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-478"></span><span>  </span><span id="local-6989586621682726546"><span class="annot"><span class="annottext">ppr :: PmAltConSet -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PmAltCon] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">([PmAltCon] -&gt; SDoc)
-&gt; (PmAltConSet -&gt; [PmAltCon]) -&gt; PmAltConSet -&gt; SDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PmAltConSet -&gt; [PmAltCon]
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmAltConSetElems"><span class="hs-identifier hs-var">pmAltConSetElems</span></a></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span class="hs-comment">-- | We can't in general decide whether two 'PmAltCon's match the same set of</span><span>
</span><span id="line-481"></span><span class="hs-comment">-- values. In addition to the reasons in 'eqPmLit' and 'eqConLike', a</span><span>
</span><span id="line-482"></span><span class="hs-comment">-- 'PmAltConLike' might or might not represent the same value as a 'PmAltLit'.</span><span>
</span><span id="line-483"></span><span class="hs-comment">-- See Note [Undecidable Equality for PmAltCons].</span><span>
</span><span id="line-484"></span><span class="hs-comment">--</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- * @Just True@ ==&gt; Surely equal</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- * @Just False@ ==&gt; Surely different (non-overlapping, even!)</span><span>
</span><span id="line-487"></span><span class="hs-comment">-- * @Nothing@ ==&gt; Equality relation undecidable</span><span>
</span><span id="line-488"></span><span class="hs-comment">--</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- Examples (omitting some constructor wrapping):</span><span>
</span><span id="line-490"></span><span class="hs-comment">--</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- * @eqPmAltCon (LitInt 42) (LitInt 1) == Just False@: Lit equality is</span><span>
</span><span id="line-492"></span><span class="hs-comment">--   decidable</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- * @eqPmAltCon (DataCon A) (DataCon B) == Just False@: DataCon equality is</span><span>
</span><span id="line-494"></span><span class="hs-comment">--   decidable</span><span>
</span><span id="line-495"></span><span class="hs-comment">-- * @eqPmAltCon (LitOverInt 42) (LitOverInt 1) == Nothing@: OverLit equality</span><span>
</span><span id="line-496"></span><span class="hs-comment">--   is undecidable</span><span>
</span><span id="line-497"></span><span class="hs-comment">-- * @eqPmAltCon (PatSyn PA) (PatSyn PB) == Nothing@: PatSyn equality is</span><span>
</span><span id="line-498"></span><span class="hs-comment">--   undecidable</span><span>
</span><span id="line-499"></span><span class="hs-comment">-- * @eqPmAltCon (DataCon I#) (LitInt 1) == Nothing@: DataCon to Lit</span><span>
</span><span id="line-500"></span><span class="hs-comment">--   comparisons are undecidable without reasoning about the wrapped @Int#@</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- * @eqPmAltCon (LitOverInt 1) (LitOverInt 1) == Just True@: We assume</span><span>
</span><span id="line-502"></span><span class="hs-comment">--   reflexivity for overloaded literals</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- * @eqPmAltCon (PatSyn PA) (PatSyn PA) == Just True@: We assume reflexivity</span><span>
</span><span id="line-504"></span><span class="hs-comment">--   for Pattern Synonyms</span><span>
</span><span id="line-505"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#eqPmAltCon"><span class="hs-identifier hs-type">eqPmAltCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltCon"><span class="hs-identifier hs-type">PmAltCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltCon"><span class="hs-identifier hs-type">PmAltCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmEquality"><span class="hs-identifier hs-type">PmEquality</span></a></span><span>
</span><span id="line-506"></span><span id="eqPmAltCon"><span class="annot"><span class="annottext">eqPmAltCon :: PmAltCon -&gt; PmAltCon -&gt; PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#eqPmAltCon"><span class="hs-identifier hs-var hs-var">eqPmAltCon</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConLike"><span class="hs-identifier hs-type">PmAltConLike</span></a></span><span> </span><span id="local-6989586621682726547"><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621682726547"><span class="hs-identifier hs-var">cl1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConLike"><span class="hs-identifier hs-type">PmAltConLike</span></a></span><span> </span><span id="local-6989586621682726548"><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621682726548"><span class="hs-identifier hs-var">cl2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConLike -&gt; ConLike -&gt; PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#eqConLike"><span class="hs-identifier hs-var">eqConLike</span></a></span><span> </span><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621682726547"><span class="hs-identifier hs-var">cl1</span></a></span><span> </span><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621682726548"><span class="hs-identifier hs-var">cl2</span></a></span><span>
</span><span id="line-507"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#eqPmAltCon"><span class="hs-identifier hs-var">eqPmAltCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltLit"><span class="hs-identifier hs-type">PmAltLit</span></a></span><span>     </span><span id="local-6989586621682726549"><span class="annot"><span class="annottext">PmLit
</span><a href="#local-6989586621682726549"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltLit"><span class="hs-identifier hs-type">PmAltLit</span></a></span><span>     </span><span id="local-6989586621682726550"><span class="annot"><span class="annottext">PmLit
</span><a href="#local-6989586621682726550"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLit -&gt; PmLit -&gt; PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#eqPmLit"><span class="hs-identifier hs-var">eqPmLit</span></a></span><span> </span><span class="annot"><span class="annottext">PmLit
</span><a href="#local-6989586621682726549"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">PmLit
</span><a href="#local-6989586621682726550"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-508"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#eqPmAltCon"><span class="hs-identifier hs-var">eqPmAltCon</span></a></span><span> </span><span class="annot"><span class="annottext">PmAltCon
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="annot"><span class="annottext">PmAltCon
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PossiblyOverlap"><span class="hs-identifier hs-var">PossiblyOverlap</span></a></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="annot"><span class="hs-comment">-- | Syntactic equality.</span></span><span>
</span><span id="line-511"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682726553"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltCon"><span class="hs-identifier hs-type">PmAltCon</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-512"></span><span>  </span><span id="local-6989586621682726557"><span class="annot"><span class="annottext">PmAltCon
</span><a href="#local-6989586621682726557"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682726558"><span class="annot"><span class="annottext">== :: PmAltCon -&gt; PmAltCon -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621682726559"><span class="annot"><span class="annottext">PmAltCon
</span><a href="#local-6989586621682726559"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmAltCon -&gt; PmAltCon -&gt; PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#eqPmAltCon"><span class="hs-identifier hs-var">eqPmAltCon</span></a></span><span> </span><span class="annot"><span class="annottext">PmAltCon
</span><a href="#local-6989586621682726557"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PmAltCon
</span><a href="#local-6989586621682726559"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">PmEquality -&gt; PmEquality -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PmEquality
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#Equal"><span class="hs-identifier hs-var">Equal</span></a></span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span class="annot"><span class="hs-comment">-- | Type of a 'PmAltCon'</span></span><span>
</span><span id="line-515"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmAltConType"><span class="hs-identifier hs-type">pmAltConType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltCon"><span class="hs-identifier hs-type">PmAltCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-516"></span><span id="pmAltConType"><span class="annot"><span class="annottext">pmAltConType :: PmAltCon -&gt; [Kind] -&gt; Kind
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmAltConType"><span class="hs-identifier hs-var hs-var">pmAltConType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltLit"><span class="hs-identifier hs-type">PmAltLit</span></a></span><span> </span><span id="local-6989586621682726560"><span class="annot"><span class="annottext">PmLit
</span><a href="#local-6989586621682726560"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>     </span><span id="local-6989586621682726561"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621682726561"><span class="hs-identifier hs-var">_arg_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Kind -&gt; Kind
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Kind] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621682726561"><span class="hs-identifier hs-var">_arg_tys</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; Kind) -&gt; Kind -&gt; Kind
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PmLit -&gt; Kind
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmLitType"><span class="hs-identifier hs-var">pmLitType</span></a></span><span> </span><span class="annot"><span class="annottext">PmLit
</span><a href="#local-6989586621682726560"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-517"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmAltConType"><span class="hs-identifier hs-var">pmAltConType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConLike"><span class="hs-identifier hs-type">PmAltConLike</span></a></span><span> </span><span id="local-6989586621682726563"><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621682726563"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682726564"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621682726564"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConLike -&gt; [Kind] -&gt; Kind
</span><a href="GHC.Core.ConLike.html#conLikeResTy"><span class="hs-identifier hs-var">conLikeResTy</span></a></span><span> </span><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621682726563"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621682726564"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span class="hs-comment">-- | Is a match on this constructor forcing the match variable?</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- True of data constructors, literals and pattern synonyms (#17357), but not of</span><span>
</span><span id="line-521"></span><span class="hs-comment">-- newtypes.</span><span>
</span><span id="line-522"></span><span class="hs-comment">-- See Note [Coverage checking Newtype matches] in GHC.HsToCore.Pmc.Solver.</span><span>
</span><span id="line-523"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#isPmAltConMatchStrict"><span class="hs-identifier hs-type">isPmAltConMatchStrict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltCon"><span class="hs-identifier hs-type">PmAltCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-524"></span><span id="isPmAltConMatchStrict"><span class="annot"><span class="annottext">isPmAltConMatchStrict :: PmAltCon -&gt; Bool
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#isPmAltConMatchStrict"><span class="hs-identifier hs-var hs-var">isPmAltConMatchStrict</span></a></span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltLit"><span class="hs-identifier hs-type">PmAltLit</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-525"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#isPmAltConMatchStrict"><span class="hs-identifier hs-var">isPmAltConMatchStrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConLike"><span class="hs-identifier hs-type">PmAltConLike</span></a></span><span> </span><span class="annot"><a href="GHC.Core.ConLike.html#PatSynCon"><span class="hs-identifier hs-type">PatSynCon</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-comment">-- #17357</span><span>
</span><span id="line-526"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#isPmAltConMatchStrict"><span class="hs-identifier hs-var">isPmAltConMatchStrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConLike"><span class="hs-identifier hs-type">PmAltConLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.ConLike.html#RealDataCon"><span class="hs-identifier hs-type">RealDataCon</span></a></span><span> </span><span id="local-6989586621682726566"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726566"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isNewDataCon"><span class="hs-identifier hs-var">isNewDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726566"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmAltConImplBangs"><span class="hs-identifier hs-type">pmAltConImplBangs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltCon"><span class="hs-identifier hs-type">PmAltCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.DataCon.html#HsImplBang"><span class="hs-identifier hs-type">HsImplBang</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-529"></span><span id="pmAltConImplBangs"><span class="annot"><span class="annottext">pmAltConImplBangs :: PmAltCon -&gt; [HsImplBang]
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmAltConImplBangs"><span class="hs-identifier hs-var hs-var">pmAltConImplBangs</span></a></span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltLit"><span class="hs-identifier hs-type">PmAltLit</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-530"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmAltConImplBangs"><span class="hs-identifier hs-var">pmAltConImplBangs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConLike"><span class="hs-identifier hs-type">PmAltConLike</span></a></span><span> </span><span id="local-6989586621682726567"><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621682726567"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConLike -&gt; [HsImplBang]
</span><a href="GHC.Core.ConLike.html#conLikeImplBangs"><span class="hs-identifier hs-var">conLikeImplBangs</span></a></span><span> </span><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621682726567"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="hs-comment">{- Note [Undecidable Equality for PmAltCons]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Equality on overloaded literals is undecidable in the general case. Consider
the following example:

  instance Num Bool where
    ...
    fromInteger 0 = False -- C-like representation of booleans
    fromInteger _ = True

    f :: Bool -&gt; ()
    f 1 = ()        -- Clause A
    f 2 = ()        -- Clause B

Clause B is redundant but to detect this, we must decide the constraint:
@fromInteger 2 ~ fromInteger 1@ which means that we
have to look through function @fromInteger@, whose implementation could
be anything. This poses difficulties for:

1. The expressive power of the check.
   We cannot expect a reasonable implementation of pattern matching to detect
   that @fromInteger 2 ~ fromInteger 1@ is True, unless we unfold function
   fromInteger. This puts termination at risk and is undecidable in the
   general case.

2. Error messages/Warnings.
   What should our message for @f@ above be? A reasonable approach would be
   to issue:

     Pattern matches are (potentially) redundant:
       f 2 = ...    under the assumption that 1 == 2

   but seems to complex and confusing for the user.

We choose to equate only obviously equal overloaded literals, in all other cases
we signal undecidability by returning Nothing from 'eqPmAltCons'. We do
better for non-overloaded literals, because we know their fromInteger/fromString
implementation is actually injective, allowing us to simplify the constraint
@fromInteger 1 ~ fromInteger 2@ to @1 ~ 2@, which is trivially unsatisfiable.

The impact of this treatment of overloaded literals is the following:

  * Redundancy checking is rather conservative, since it cannot see that clause
    B above is redundant.

  * We have instant equality check for overloaded literals (we do not rely on
    the term oracle which is rather expensive, both in terms of performance and
    memory). This significantly improves the performance of functions `covered`
    `uncovered` and `divergent` in &quot;GHC.HsToCore.Pmc&quot; and effectively addresses
    #11161.

  * The warnings issued are simpler.

Similar reasoning applies to pattern synonyms: In contrast to data constructors,
which are generative, constraints like F a ~ G b for two different pattern
synonyms F and G aren't immediately unsatisfiable. We assume F a ~ F a, though.
-}</span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#literalToPmLit"><span class="hs-identifier hs-type">literalToPmLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span>
</span><span id="line-591"></span><span id="literalToPmLit"><span class="annot"><span class="annottext">literalToPmLit :: Kind -&gt; Literal -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#literalToPmLit"><span class="hs-identifier hs-var hs-var">literalToPmLit</span></a></span></span><span> </span><span id="local-6989586621682726569"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726569"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682726570"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682726570"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; PmLitValue -&gt; PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726569"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">(PmLitValue -&gt; PmLit) -&gt; Maybe PmLitValue -&gt; Maybe PmLit
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Maybe PmLitValue
</span><a href="#local-6989586621682726571"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682726570"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-593"></span><span>    </span><span id="local-6989586621682726571"><span class="annot"><span class="annottext">go :: Literal -&gt; Maybe PmLitValue
</span><a href="#local-6989586621682726571"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitChar"><span class="hs-identifier hs-type">LitChar</span></a></span><span> </span><span id="local-6989586621682726573"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682726573"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; Maybe PmLitValue
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; PmLitValue
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitChar"><span class="hs-identifier hs-var">PmLitChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682726573"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span>    </span><span class="annot"><a href="#local-6989586621682726571"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span id="local-6989586621682726575"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682726575"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; Maybe PmLitValue
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; PmLitValue
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitRat"><span class="hs-identifier hs-var">PmLitRat</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682726575"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>    </span><span class="annot"><a href="#local-6989586621682726571"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span id="local-6989586621682726577"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682726577"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; Maybe PmLitValue
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; PmLitValue
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitRat"><span class="hs-identifier hs-var">PmLitRat</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682726577"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span>    </span><span class="annot"><a href="#local-6989586621682726571"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621682726579"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682726579"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; Maybe PmLitValue
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; PmLitValue
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitString"><span class="hs-identifier hs-var">PmLitString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; FastString
</span><a href="GHC.Data.FastString.html#mkFastStringByteString"><span class="hs-identifier hs-var">mkFastStringByteString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682726579"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-597"></span><span>    </span><span class="annot"><a href="#local-6989586621682726571"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682726582"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726582"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; Maybe PmLitValue
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; PmLitValue
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitInt"><span class="hs-identifier hs-var">PmLitInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726582"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>    </span><span class="annot"><a href="#local-6989586621682726571"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PmLitValue
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#negatePmLit"><span class="hs-identifier hs-type">negatePmLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span>
</span><span id="line-601"></span><span id="negatePmLit"><span class="annot"><span class="annottext">negatePmLit :: PmLit -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#negatePmLit"><span class="hs-identifier hs-var hs-var">negatePmLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span id="local-6989586621682726583"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726583"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682726584"><span class="annot"><span class="annottext">PmLitValue
</span><a href="#local-6989586621682726584"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; PmLitValue -&gt; PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726583"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">(PmLitValue -&gt; PmLit) -&gt; Maybe PmLitValue -&gt; Maybe PmLit
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; Maybe PmLitValue
</span><a href="#local-6989586621682726585"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">PmLitValue
</span><a href="#local-6989586621682726584"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-602"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-603"></span><span>    </span><span id="local-6989586621682726585"><span class="annot"><span class="annottext">go :: PmLitValue -&gt; Maybe PmLitValue
</span><a href="#local-6989586621682726585"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitInt"><span class="hs-identifier hs-type">PmLitInt</span></a></span><span> </span><span id="local-6989586621682726594"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726594"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; Maybe PmLitValue
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; PmLitValue
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitInt"><span class="hs-identifier hs-var">PmLitInt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726594"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-604"></span><span>    </span><span class="annot"><a href="#local-6989586621682726585"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitRat"><span class="hs-identifier hs-type">PmLitRat</span></a></span><span> </span><span id="local-6989586621682726595"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682726595"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; Maybe PmLitValue
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; PmLitValue
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitRat"><span class="hs-identifier hs-var">PmLitRat</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682726595"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>    </span><span class="annot"><a href="#local-6989586621682726585"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverInt"><span class="hs-identifier hs-type">PmLitOverInt</span></a></span><span> </span><span id="local-6989586621682726596"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726596"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682726597"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726597"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; Maybe PmLitValue
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; PmLitValue
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverInt"><span class="hs-identifier hs-var">PmLitOverInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726596"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726597"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span>    </span><span class="annot"><a href="#local-6989586621682726585"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverRat"><span class="hs-identifier hs-type">PmLitOverRat</span></a></span><span> </span><span id="local-6989586621682726599"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726599"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682726600"><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621682726600"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; Maybe PmLitValue
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FractionalLit -&gt; PmLitValue
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverRat"><span class="hs-identifier hs-var">PmLitOverRat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726599"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621682726600"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-607"></span><span>    </span><span class="annot"><a href="#local-6989586621682726585"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">PmLitValue
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PmLitValue
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#overloadPmLit"><span class="hs-identifier hs-type">overloadPmLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span>
</span><span id="line-610"></span><span id="overloadPmLit"><span class="annot"><span class="annottext">overloadPmLit :: Kind -&gt; PmLit -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#overloadPmLit"><span class="hs-identifier hs-var hs-var">overloadPmLit</span></a></span></span><span> </span><span id="local-6989586621682726601"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726601"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682726602"><span class="annot"><span class="annottext">PmLitValue
</span><a href="#local-6989586621682726602"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; PmLitValue -&gt; PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726601"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">(PmLitValue -&gt; PmLit) -&gt; Maybe PmLitValue -&gt; Maybe PmLit
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; Maybe PmLitValue
</span><a href="#local-6989586621682726603"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">PmLitValue
</span><a href="#local-6989586621682726602"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-611"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-612"></span><span>    </span><span id="local-6989586621682726603"><span class="annot"><span class="annottext">go :: PmLitValue -&gt; Maybe PmLitValue
</span><a href="#local-6989586621682726603"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitInt"><span class="hs-identifier hs-type">PmLitInt</span></a></span><span> </span><span id="local-6989586621682726604"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726604"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; Maybe PmLitValue
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; PmLitValue
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverInt"><span class="hs-identifier hs-var">PmLitOverInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726604"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>    </span><span class="annot"><a href="#local-6989586621682726603"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitRat"><span class="hs-identifier hs-type">PmLitRat</span></a></span><span> </span><span id="local-6989586621682726605"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682726605"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; Maybe PmLitValue
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(PmLitValue -&gt; Maybe PmLitValue) -&gt; PmLitValue -&gt; Maybe PmLitValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; FractionalLit -&gt; PmLitValue
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverRat"><span class="hs-identifier hs-var">PmLitOverRat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(FractionalLit -&gt; PmLitValue) -&gt; FractionalLit -&gt; PmLitValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; FractionalLit
</span><a href="GHC.Types.SourceText.html#fractionalLitFromRational"><span class="hs-identifier hs-var">fractionalLitFromRational</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682726605"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-614"></span><span>    </span><span class="annot"><a href="#local-6989586621682726603"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitString"><span class="hs-identifier hs-type">PmLitString</span></a></span><span> </span><span id="local-6989586621682726607"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682726607"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-615"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726601"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Kind -&gt; Kind -&gt; Bool
Kind -&gt; Kind -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.html#stringTy"><span class="hs-identifier hs-var">stringTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; Maybe PmLitValue
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PmLitValue
</span><a href="#local-6989586621682726602"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-616"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; Maybe PmLitValue
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; PmLitValue
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverString"><span class="hs-identifier hs-var">PmLitOverString</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682726607"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-617"></span><span>    </span><span class="annot"><a href="#local-6989586621682726603"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682726609"><span class="annot"><span class="annottext">ovRat :: PmLitValue
</span><a href="#local-6989586621682726609"><span class="hs-identifier hs-var">ovRat</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverRat"><span class="hs-identifier hs-type">PmLitOverRat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; Maybe PmLitValue
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PmLitValue
</span><a href="#local-6989586621682726609"><span class="hs-identifier hs-var">ovRat</span></a></span><span>
</span><span id="line-618"></span><span>    </span><span class="annot"><a href="#local-6989586621682726603"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">PmLitValue
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PmLitValue
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmLitAsStringLit"><span class="hs-identifier hs-type">pmLitAsStringLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>
</span><span id="line-621"></span><span id="pmLitAsStringLit"><span class="annot"><span class="annottext">pmLitAsStringLit :: PmLit -&gt; Maybe FastString
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmLitAsStringLit"><span class="hs-identifier hs-var hs-var">pmLitAsStringLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitString"><span class="hs-identifier hs-type">PmLitString</span></a></span><span> </span><span id="local-6989586621682726610"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682726610"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Maybe FastString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682726610"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-622"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#pmLitAsStringLit"><span class="hs-identifier hs-var">pmLitAsStringLit</span></a></span><span> </span><span class="annot"><span class="annottext">PmLit
</span><span class="hs-identifier">_</span></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FastString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-623"></span><span>
</span><span id="line-624"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#coreExprAsPmLit"><span class="hs-identifier hs-type">coreExprAsPmLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span>
</span><span id="line-625"></span><span class="hs-comment">-- coreExprAsPmLit e | pprTrace &quot;coreExprAsPmLit&quot; (ppr e) False = undefined</span><span>
</span><span id="line-626"></span><span id="coreExprAsPmLit"><span class="annot"><span class="annottext">coreExprAsPmLit :: CoreExpr -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#coreExprAsPmLit"><span class="hs-identifier hs-var hs-var">coreExprAsPmLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Tick"><span class="hs-identifier hs-type">Tick</span></a></span><span> </span><span id="local-6989586621682726612"><span class="annot"><span class="annottext">CoreTickish
</span><a href="#local-6989586621682726612"><span class="hs-identifier hs-var">_t</span></a></span></span><span> </span><span id="local-6989586621682726613"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726613"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#coreExprAsPmLit"><span class="hs-identifier hs-var">coreExprAsPmLit</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726613"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-627"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#coreExprAsPmLit"><span class="hs-identifier hs-var">coreExprAsPmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682726615"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682726615"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Literal -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#literalToPmLit"><span class="hs-identifier hs-var">literalToPmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; Kind
</span><a href="GHC.Types.Literal.html#literalType"><span class="hs-identifier hs-var">literalType</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682726615"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682726615"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-628"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#coreExprAsPmLit"><span class="hs-identifier hs-var">coreExprAsPmLit</span></a></span><span> </span><span id="local-6989586621682726617"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726617"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; (CoreExpr, [CoreExpr])
forall b. Expr b -&gt; (Expr b, [Expr b])
</span><a href="GHC.Core.html#collectArgs"><span class="hs-identifier hs-var">collectArgs</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726617"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-629"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682726620"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726620"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682726621"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682726621"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682726622"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726622"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Maybe DataCon
</span><a href="GHC.Types.Id.html#isDataConWorkId_maybe"><span class="hs-identifier hs-var">isDataConWorkId_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726620"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-631"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726622"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [DataCon] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#intDataCon"><span class="hs-identifier hs-var">intDataCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#wordDataCon"><span class="hs-identifier hs-var">wordDataCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#charDataCon"><span class="hs-identifier hs-var">charDataCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#floatDataCon"><span class="hs-identifier hs-var">floatDataCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#doubleDataCon"><span class="hs-identifier hs-var">doubleDataCon</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-632"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Literal -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#literalToPmLit"><span class="hs-identifier hs-var">literalToPmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726617"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682726621"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-633"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682726629"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726629"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682726630"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726630"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682726631"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726631"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682726632"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726632"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Integer -&gt; Maybe (Kind, Integer)
forall {b}. Num b =&gt; Id -&gt; b -&gt; Maybe (Kind, b)
</span><a href="#local-6989586621682726633"><span class="hs-identifier hs-var">bignum_lit_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726629"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726630"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-635"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PmLit -&gt; Maybe PmLit
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; PmLitValue -&gt; PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726631"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; PmLitValue
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitInt"><span class="hs-identifier hs-var">PmLitInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726632"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682726634"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726634"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682726635"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726635"><span class="hs-identifier hs-var">_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682726636"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726636"><span class="hs-identifier hs-var">n_arg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682726637"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726637"><span class="hs-identifier hs-var">d_arg</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682726638"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726638"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Maybe DataCon
</span><a href="GHC.Types.Id.html#isDataConWorkId_maybe"><span class="hs-identifier hs-var">isDataConWorkId_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726634"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-638"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Name
</span><a href="GHC.Core.DataCon.html#dataConName"><span class="hs-identifier hs-var">dataConName</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726638"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#ratioDataConName"><span class="hs-identifier hs-var">ratioDataConName</span></a></span><span>
</span><span id="line-639"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitInt"><span class="hs-identifier hs-type">PmLitInt</span></a></span><span> </span><span id="local-6989586621682726641"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726641"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#coreExprAsPmLit"><span class="hs-identifier hs-var">coreExprAsPmLit</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726636"><span class="hs-identifier hs-var">n_arg</span></a></span><span>
</span><span id="line-640"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitInt"><span class="hs-identifier hs-type">PmLitInt</span></a></span><span> </span><span id="local-6989586621682726642"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726642"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#coreExprAsPmLit"><span class="hs-identifier hs-var">coreExprAsPmLit</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726637"><span class="hs-identifier hs-var">d_arg</span></a></span><span>
</span><span id="line-641"></span><span>    </span><span class="hs-comment">-- HACK: just assume we have a literal double. This case only occurs for</span><span>
</span><span id="line-642"></span><span>    </span><span class="hs-comment">--       overloaded lits anyway, so we immediately override type information</span><span>
</span><span id="line-643"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Literal -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#literalToPmLit"><span class="hs-identifier hs-var">literalToPmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726617"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitDouble"><span class="hs-identifier hs-var">mkLitDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726641"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726642"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682726645"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726645"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682726646"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682726646"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>    </span><span class="hs-comment">-- See Note [Detecting overloaded literals with -XRebindableSyntax]</span><span>
</span><span id="line-647"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Name -&gt; Bool
</span><a href="#local-6989586621682726647"><span class="hs-identifier hs-var">is_rebound_name</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726645"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#fromIntegerName"><span class="hs-identifier hs-var">fromIntegerName</span></a></span><span>
</span><span id="line-648"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682726649"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726649"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; Maybe CoreExpr
forall a. [a] -&gt; Maybe a
</span><a href="GHC.Utils.Misc.html#lastMaybe"><span class="hs-identifier hs-var">lastMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682726646"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-649"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682726650"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726650"><span class="hs-identifier hs-var">_ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682726651"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726651"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe (Kind, Integer)
forall {b}. Expr b -&gt; Maybe (Kind, Integer)
</span><a href="#local-6989586621682726652"><span class="hs-identifier hs-var">bignum_conapp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726649"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-650"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PmLit -&gt; Maybe PmLit
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; PmLitValue -&gt; PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.html#integerTy"><span class="hs-identifier hs-var">integerTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; PmLitValue
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitInt"><span class="hs-identifier hs-var">PmLitInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726651"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe PmLit -&gt; (PmLit -&gt; Maybe PmLit) -&gt; Maybe PmLit
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; PmLit -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#overloadPmLit"><span class="hs-identifier hs-var">overloadPmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726617"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682726654"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726654"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682726655"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682726655"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span>    </span><span class="hs-comment">-- See Note [Detecting overloaded literals with -XRebindableSyntax]</span><span>
</span><span id="line-653"></span><span>    </span><span class="hs-comment">-- fromRational &lt;expr&gt;</span><span>
</span><span id="line-654"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Name -&gt; Bool
</span><a href="#local-6989586621682726647"><span class="hs-identifier hs-var">is_rebound_name</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726654"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#fromRationalName"><span class="hs-identifier hs-var">fromRationalName</span></a></span><span>
</span><span id="line-655"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682726657"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726657"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Bool) -&gt; [CoreExpr] -&gt; [CoreExpr]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (CoreExpr -&gt; Bool) -&gt; CoreExpr -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Bool
</span><a href="#local-6989586621682726659"><span class="hs-identifier hs-var">is_ratio</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682726655"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-656"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#coreExprAsPmLit"><span class="hs-identifier hs-var">coreExprAsPmLit</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726657"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PmLit -&gt; (PmLit -&gt; Maybe PmLit) -&gt; Maybe PmLit
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; PmLit -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#overloadPmLit"><span class="hs-identifier hs-var">overloadPmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726617"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span>  </span><span class="hs-comment">--Rationals with large exponents</span><span>
</span><span id="line-659"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682726660"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726660"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682726661"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682726661"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-660"></span><span>    </span><span class="hs-comment">-- See Note [Detecting overloaded literals with -XRebindableSyntax]</span><span>
</span><span id="line-661"></span><span>    </span><span class="hs-comment">-- See Note [Dealing with rationals with large exponents]</span><span>
</span><span id="line-662"></span><span>    </span><span class="hs-comment">-- mkRationalBase* &lt;rational&gt; &lt;exponent&gt;</span><span>
</span><span id="line-663"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682726662"><span class="annot"><span class="annottext">FractionalExponentBase
</span><a href="#local-6989586621682726662"><span class="hs-identifier hs-var">exp_base</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Maybe FractionalExponentBase
</span><a href="#local-6989586621682726663"><span class="hs-identifier hs-var">is_larg_exp_ratio</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726660"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-664"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682726664"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726664"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682726665"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726665"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Bool) -&gt; [CoreExpr] -&gt; [CoreExpr]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (CoreExpr -&gt; Bool) -&gt; CoreExpr -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Bool
</span><a href="#local-6989586621682726659"><span class="hs-identifier hs-var">is_ratio</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682726661"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-665"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682726666"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726666"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682726667"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726667"><span class="hs-identifier hs-var">_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682726668"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726668"><span class="hs-identifier hs-var">n_arg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682726669"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726669"><span class="hs-identifier hs-var">d_arg</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; (CoreExpr, [CoreExpr])
forall b. Expr b -&gt; (Expr b, [Expr b])
</span><a href="GHC.Core.html#collectArgs"><span class="hs-identifier hs-var">collectArgs</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726664"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-666"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682726670"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726670"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Maybe DataCon
</span><a href="GHC.Types.Id.html#isDataConWorkId_maybe"><span class="hs-identifier hs-var">isDataConWorkId_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726666"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-667"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Name
</span><a href="GHC.Core.DataCon.html#dataConName"><span class="hs-identifier hs-var">dataConName</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726670"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#ratioDataConName"><span class="hs-identifier hs-var">ratioDataConName</span></a></span><span>
</span><span id="line-668"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitInt"><span class="hs-identifier hs-type">PmLitInt</span></a></span><span> </span><span id="local-6989586621682726671"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726671"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#coreExprAsPmLit"><span class="hs-identifier hs-var">coreExprAsPmLit</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726668"><span class="hs-identifier hs-var">n_arg</span></a></span><span>
</span><span id="line-669"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitInt"><span class="hs-identifier hs-type">PmLitInt</span></a></span><span> </span><span id="local-6989586621682726672"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726672"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#coreExprAsPmLit"><span class="hs-identifier hs-var">coreExprAsPmLit</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726669"><span class="hs-identifier hs-var">d_arg</span></a></span><span>
</span><span id="line-670"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682726673"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726673"><span class="hs-identifier hs-var">_exp_ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682726674"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726674"><span class="hs-identifier hs-var">exp'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe (Kind, Integer)
forall {b}. Expr b -&gt; Maybe (Kind, Integer)
</span><a href="#local-6989586621682726652"><span class="hs-identifier hs-var">bignum_conapp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726665"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-671"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-672"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682726675"><span class="annot"><span class="annottext">rational :: Rational
</span><a href="#local-6989586621682726675"><span class="hs-identifier hs-var hs-var">rational</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726671"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">:%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726672"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-673"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682726677"><span class="annot"><span class="annottext">neg :: Int
</span><a href="#local-6989586621682726677"><span class="hs-identifier hs-var hs-var">neg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726671"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-674"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682726679"><span class="annot"><span class="annottext">frac :: FractionalLit
</span><a href="#local-6989586621682726679"><span class="hs-identifier hs-var hs-var">frac</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceText
-&gt; Bool
-&gt; Rational
-&gt; Integer
-&gt; FractionalExponentBase
-&gt; FractionalLit
</span><a href="GHC.Types.SourceText.html#mkFractionalLit"><span class="hs-identifier hs-var">mkFractionalLit</span></a></span><span> </span><span class="annot"><span class="annottext">SourceText
</span><a href="GHC.Types.SourceText.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682726675"><span class="hs-identifier hs-var">rational</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726674"><span class="hs-identifier hs-var">exp'</span></a></span><span> </span><span class="annot"><span class="annottext">FractionalExponentBase
</span><a href="#local-6989586621682726662"><span class="hs-identifier hs-var">exp_base</span></a></span><span>
</span><span id="line-675"></span><span>      </span><span class="annot"><span class="annottext">PmLit -&gt; Maybe PmLit
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(PmLit -&gt; Maybe PmLit) -&gt; PmLit -&gt; Maybe PmLit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; PmLitValue -&gt; PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726617"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FractionalLit -&gt; PmLitValue
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverRat"><span class="hs-identifier hs-var">PmLitOverRat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726677"><span class="hs-identifier hs-var">neg</span></a></span><span> </span><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621682726679"><span class="hs-identifier hs-var">frac</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-676"></span><span>
</span><span id="line-677"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682726681"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726681"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682726682"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682726682"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-678"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Name -&gt; Bool
</span><a href="#local-6989586621682726647"><span class="hs-identifier hs-var">is_rebound_name</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726681"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#fromStringName"><span class="hs-identifier hs-var">fromStringName</span></a></span><span>
</span><span id="line-679"></span><span>    </span><span class="hs-comment">-- See Note [Detecting overloaded literals with -XRebindableSyntax]</span><span>
</span><span id="line-680"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682726684"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726684"><span class="hs-identifier hs-var">s</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[CoreExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Bool) -&gt; [CoreExpr] -&gt; [CoreExpr]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isStringTy"><span class="hs-identifier hs-var">isStringTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; Bool) -&gt; (CoreExpr -&gt; Kind) -&gt; CoreExpr -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([CoreExpr] -&gt; [CoreExpr]) -&gt; [CoreExpr] -&gt; [CoreExpr]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Bool) -&gt; [CoreExpr] -&gt; [CoreExpr]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Bool
forall b. Expr b -&gt; Bool
</span><a href="GHC.Core.html#isValArg"><span class="hs-identifier hs-var">isValArg</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682726682"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-681"></span><span>    </span><span class="hs-comment">-- NB: Calls coreExprAsPmLit and then overloadPmLit, so that we return PmLitOverStrings</span><span>
</span><span id="line-682"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#coreExprAsPmLit"><span class="hs-identifier hs-var">coreExprAsPmLit</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726684"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PmLit -&gt; (PmLit -&gt; Maybe PmLit) -&gt; Maybe PmLit
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; PmLit -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#overloadPmLit"><span class="hs-identifier hs-var">overloadPmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726617"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-683"></span><span>  </span><span class="hs-comment">-- These last two cases handle proper String literals</span><span>
</span><span id="line-684"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682726686"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726686"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682726688"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726688"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-685"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682726689"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726689"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Maybe DataCon
</span><a href="GHC.Types.Id.html#isDataConWorkId_maybe"><span class="hs-identifier hs-var">isDataConWorkId_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726686"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-686"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726689"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; DataCon -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#nilDataCon"><span class="hs-identifier hs-var">nilDataCon</span></a></span><span>
</span><span id="line-687"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726688"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Kind -&gt; Kind -&gt; Bool
Kind -&gt; Kind -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.html#charTy"><span class="hs-identifier hs-var">charTy</span></a></span><span>
</span><span id="line-688"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Literal -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#literalToPmLit"><span class="hs-identifier hs-var">literalToPmLit</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.html#stringTy"><span class="hs-identifier hs-var">stringTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitString"><span class="hs-identifier hs-var">mkLitString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682726693"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726693"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682726694"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682726694"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-690"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726693"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#unpackCStringName"><span class="hs-identifier hs-var">unpackCStringName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#unpackCStringUtf8Name"><span class="hs-identifier hs-var">unpackCStringUtf8Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-691"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Literal -&gt; Maybe PmLit
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#literalToPmLit"><span class="hs-identifier hs-var">literalToPmLit</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.html#stringTy"><span class="hs-identifier hs-var">stringTy</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682726694"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span>  </span><span class="annot"><span class="annottext">(CoreExpr, [CoreExpr])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PmLit
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-694"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-695"></span><span>    </span><span id="local-6989586621682726652"><span class="annot"><span class="annottext">bignum_conapp_maybe :: Expr b -&gt; Maybe (Kind, Integer)
</span><a href="#local-6989586621682726652"><span class="hs-identifier hs-var hs-var">bignum_conapp_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682726700"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726700"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682726701"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726701"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-696"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Integer -&gt; Maybe (Kind, Integer)
forall {b}. Num b =&gt; Id -&gt; b -&gt; Maybe (Kind, b)
</span><a href="#local-6989586621682726633"><span class="hs-identifier hs-var">bignum_lit_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726700"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726701"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-697"></span><span>    </span><span class="annot"><a href="#local-6989586621682726652"><span class="hs-identifier hs-var">bignum_conapp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Expr b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Kind, Integer)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span>    </span><span id="local-6989586621682726633"><span class="annot"><span class="annottext">bignum_lit_maybe :: Id -&gt; b -&gt; Maybe (Kind, b)
</span><a href="#local-6989586621682726633"><span class="hs-identifier hs-var hs-var">bignum_lit_maybe</span></a></span></span><span> </span><span id="local-6989586621682726709"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726709"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682726710"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682726710"><span class="hs-identifier hs-var">l</span></a></span></span><span>
</span><span id="line-700"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682726711"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726711"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Maybe DataCon
</span><a href="GHC.Types.Id.html#isDataConWorkId_maybe"><span class="hs-identifier hs-var">isDataConWorkId_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726709"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-701"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726711"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; DataCon -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#integerISDataCon"><span class="hs-identifier hs-var">integerISDataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Kind, b) -&gt; Maybe (Kind, b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.html#integerTy"><span class="hs-identifier hs-var">integerTy</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682726710"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-702"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726711"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; DataCon -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#integerIPDataCon"><span class="hs-identifier hs-var">integerIPDataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Kind, b) -&gt; Maybe (Kind, b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.html#integerTy"><span class="hs-identifier hs-var">integerTy</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682726710"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-703"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726711"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; DataCon -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#integerINDataCon"><span class="hs-identifier hs-var">integerINDataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Kind, b) -&gt; Maybe (Kind, b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.html#integerTy"><span class="hs-identifier hs-var">integerTy</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b -&gt; b
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682726710"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-704"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726711"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; DataCon -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#naturalNSDataCon"><span class="hs-identifier hs-var">naturalNSDataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Kind, b) -&gt; Maybe (Kind, b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.html#naturalTy"><span class="hs-identifier hs-var">naturalTy</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682726710"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682726711"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; DataCon -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#naturalNBDataCon"><span class="hs-identifier hs-var">naturalNBDataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Kind, b) -&gt; Maybe (Kind, b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.html#naturalTy"><span class="hs-identifier hs-var">naturalTy</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682726710"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-706"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Kind, b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-707"></span><span>    </span><span class="annot"><a href="#local-6989586621682726633"><span class="hs-identifier hs-var">bignum_lit_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Kind, b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-708"></span><span>
</span><span id="line-709"></span><span>    </span><span id="local-6989586621682726659"><span class="annot"><span class="annottext">is_ratio :: CoreExpr -&gt; Bool
</span><a href="#local-6989586621682726659"><span class="hs-identifier hs-var hs-var">is_ratio</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-710"></span><span>    </span><span class="annot"><a href="#local-6989586621682726659"><span class="hs-identifier hs-var">is_ratio</span></a></span><span> </span><span id="local-6989586621682726721"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726721"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-711"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682726722"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682726722"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Kind -&gt; Maybe (TyCon, [Kind])
Kind -&gt; Maybe (TyCon, [Kind])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682726721"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682726722"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#ratioTyConName"><span class="hs-identifier hs-var">ratioTyConName</span></a></span><span>
</span><span id="line-713"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-714"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-715"></span><span>    </span><span id="local-6989586621682726663"><span class="annot"><span class="annottext">is_larg_exp_ratio :: Id -&gt; Maybe FractionalExponentBase
</span><a href="#local-6989586621682726663"><span class="hs-identifier hs-var hs-var">is_larg_exp_ratio</span></a></span></span><span> </span><span id="local-6989586621682726726"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726726"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-716"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Name -&gt; Bool
</span><a href="#local-6989586621682726647"><span class="hs-identifier hs-var">is_rebound_name</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726726"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#mkRationalBase10Name"><span class="hs-identifier hs-var">mkRationalBase10Name</span></a></span><span>
</span><span id="line-717"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FractionalExponentBase -&gt; Maybe FractionalExponentBase
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FractionalExponentBase
</span><a href="GHC.Types.SourceText.html#Base10"><span class="hs-identifier hs-var">Base10</span></a></span><span>
</span><span id="line-718"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Name -&gt; Bool
</span><a href="#local-6989586621682726647"><span class="hs-identifier hs-var">is_rebound_name</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726726"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#mkRationalBase2Name"><span class="hs-identifier hs-var">mkRationalBase2Name</span></a></span><span>
</span><span id="line-719"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FractionalExponentBase -&gt; Maybe FractionalExponentBase
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FractionalExponentBase
</span><a href="GHC.Types.SourceText.html#Base2"><span class="hs-identifier hs-var">Base2</span></a></span><span>
</span><span id="line-720"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-721"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FractionalExponentBase
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-722"></span><span>
</span><span id="line-723"></span><span>
</span><span id="line-724"></span><span>    </span><span class="hs-comment">-- See Note [Detecting overloaded literals with -XRebindableSyntax]</span><span>
</span><span id="line-725"></span><span>    </span><span class="annot"><a href="#local-6989586621682726647"><span class="hs-identifier hs-type">is_rebound_name</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-726"></span><span>    </span><span id="local-6989586621682726647"><span class="annot"><span class="annottext">is_rebound_name :: Id -&gt; Name -&gt; Bool
</span><a href="#local-6989586621682726647"><span class="hs-identifier hs-var hs-var">is_rebound_name</span></a></span></span><span> </span><span id="local-6989586621682726731"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726731"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682726732"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682726732"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; FastString
forall a. NamedThing a =&gt; a -&gt; FastString
</span><a href="GHC.Types.Name.html#getOccFS"><span class="hs-identifier hs-var">getOccFS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682726731"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; FastString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; FastString
forall a. NamedThing a =&gt; a -&gt; FastString
</span><a href="GHC.Types.Name.html#getOccFS"><span class="hs-identifier hs-var">getOccFS</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682726732"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span class="hs-comment">{- Note [Detecting overloaded literals with -XRebindableSyntax]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Normally, we'd find e.g. overloaded string literals by comparing the
application head of an expression to `fromStringName`. But that doesn't work
with -XRebindableSyntax: The `Name` of a user-provided `fromString` function is
different to `fromStringName`, which lives in a certain module, etc.

There really is no other way than to compare `OccName`s and guess which
argument is the actual literal string (we assume it's the first argument of
type `String`).

The same applies to other overloaded literals, such as overloaded rationals
(`fromRational`)and overloaded integer literals (`fromInteger`).

Note [Dealing with rationals with large exponents]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Rationals with large exponents are *not* desugared to
a simple rational. As that would require us to compute
their value which can be expensive. Rather they desugar
to an expression. For example 1e1000 will desugar to an
expression of the form: `mkRationalWithExponentBase10 (1 :% 1) 1000`

Only overloaded literals desugar to this form however, so we
we can just return a overloaded rational literal.

The most complex case is if we have RebindableSyntax enabled.
By example if we have a pattern like this: `f 3.3 = True`

It will desugar to:
  fromRational
    [TYPE: Rational, mkRationalBase10 (:% @Integer 10 1) (-1)]

The fromRational is properly detected as an overloaded Rational by
coreExprAsPmLit and it's general code for detecting overloaded rationals.
See Note [Detecting overloaded literals with -XRebindableSyntax].

This case then recurses into coreExprAsPmLit passing only the expression
`mkRationalBase10 (:% @Integer 10 1) (-1)`. Which is caught by rationals
with large exponents case. This will return a `PmLitOverRat` literal.

Which is then passed to overloadPmLit which simply returns it as-is since
it's already overloaded.

-}</span><span>
</span><span id="line-772"></span><span>
</span><span id="line-773"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitValue"><span class="hs-identifier hs-type">PmLitValue</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-774"></span><span>  </span><span id="local-6989586621682726744"><span class="annot"><span class="annottext">ppr :: PmLitValue -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitInt"><span class="hs-identifier hs-type">PmLitInt</span></a></span><span> </span><span id="local-6989586621682726745"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726745"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726745"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-775"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitRat"><span class="hs-identifier hs-type">PmLitRat</span></a></span><span> </span><span id="local-6989586621682726746"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682726746"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; SDoc
forall doc. IsLine doc =&gt; Double -&gt; doc
</span><a href="GHC.Utils.Outputable.html#double"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. RealFloat a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRat</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682726746"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- good enough</span><span>
</span><span id="line-776"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitChar"><span class="hs-identifier hs-type">PmLitChar</span></a></span><span> </span><span id="local-6989586621682726748"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682726748"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pprHsChar"><span class="hs-identifier hs-var">pprHsChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682726748"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-777"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitString"><span class="hs-identifier hs-type">PmLitString</span></a></span><span> </span><span id="local-6989586621682726750"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682726750"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pprHsString"><span class="hs-identifier hs-var">pprHsString</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682726750"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-778"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverInt"><span class="hs-identifier hs-type">PmLitOverInt</span></a></span><span> </span><span id="local-6989586621682726752"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726752"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682726753"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726753"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#minuses"><span class="hs-identifier hs-var">minuses</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726752"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682726753"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-779"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverRat"><span class="hs-identifier hs-type">PmLitOverRat</span></a></span><span> </span><span id="local-6989586621682726755"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726755"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682726756"><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621682726756"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#minuses"><span class="hs-identifier hs-var">minuses</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726755"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FractionalLit -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621682726756"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-780"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLitOverString"><span class="hs-identifier hs-type">PmLitOverString</span></a></span><span> </span><span id="local-6989586621682726757"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682726757"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pprHsString"><span class="hs-identifier hs-var">pprHsString</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682726757"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-781"></span><span>
</span><span id="line-782"></span><span class="hs-comment">-- Take care of negated literals</span><span>
</span><span id="line-783"></span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#minuses"><span class="hs-identifier hs-type">minuses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-784"></span><span id="minuses"><span class="annot"><span class="annottext">minuses :: Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.HsToCore.Pmc.Solver.Types.html#minuses"><span class="hs-identifier hs-var hs-var">minuses</span></a></span></span><span> </span><span id="local-6989586621682726758"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726758"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682726759"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682726759"><span class="hs-identifier hs-var">sdoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; [SDoc]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682726761"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682726761"><span class="hs-identifier hs-var">sdoc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682726761"><span class="hs-identifier hs-var">sdoc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682726759"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; Int -&gt; SDoc
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682726758"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-787"></span><span>  </span><span id="local-6989586621682726773"><span class="annot"><span class="annottext">ppr :: PmLit -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a></span><span> </span><span id="local-6989586621682726774"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726774"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682726775"><span class="annot"><span class="annottext">PmLitValue
</span><a href="#local-6989586621682726775"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLitValue -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">PmLitValue
</span><a href="#local-6989586621682726775"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682726776"><span class="hs-identifier hs-var">suffix</span></a></span><span>
</span><span id="line-788"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-789"></span><span>      </span><span class="hs-comment">-- Some ad-hoc hackery for displaying proper lit suffixes based on type</span><span>
</span><span id="line-790"></span><span>      </span><span id="local-6989586621682726777"><span class="annot"><span class="annottext">tbl :: [(Kind, SDoc)]
</span><a href="#local-6989586621682726777"><span class="hs-identifier hs-var hs-var">tbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.Prim.html#intPrimTy"><span class="hs-identifier hs-var">intPrimTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#primIntSuffix"><span class="hs-identifier hs-var">primIntSuffix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-791"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.Prim.html#int64PrimTy"><span class="hs-identifier hs-var">int64PrimTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#primInt64Suffix"><span class="hs-identifier hs-var">primInt64Suffix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-792"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.Prim.html#wordPrimTy"><span class="hs-identifier hs-var">wordPrimTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#primWordSuffix"><span class="hs-identifier hs-var">primWordSuffix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-793"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.Prim.html#word64PrimTy"><span class="hs-identifier hs-var">word64PrimTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#primWord64Suffix"><span class="hs-identifier hs-var">primWord64Suffix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-794"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.Prim.html#charPrimTy"><span class="hs-identifier hs-var">charPrimTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#primCharSuffix"><span class="hs-identifier hs-var">primCharSuffix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-795"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.Prim.html#floatPrimTy"><span class="hs-identifier hs-var">floatPrimTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#primFloatSuffix"><span class="hs-identifier hs-var">primFloatSuffix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-796"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.Prim.html#doublePrimTy"><span class="hs-identifier hs-var">doublePrimTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#primDoubleSuffix"><span class="hs-identifier hs-var">primDoubleSuffix</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-797"></span><span>      </span><span id="local-6989586621682726776"><span class="annot"><span class="annottext">suffix :: SDoc
</span><a href="#local-6989586621682726776"><span class="hs-identifier hs-var hs-var">suffix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Maybe SDoc -&gt; SDoc
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Kind, SDoc) -&gt; SDoc
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Kind, SDoc) -&gt; SDoc) -&gt; Maybe (Kind, SDoc) -&gt; Maybe SDoc
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">((Kind, SDoc) -&gt; Bool) -&gt; [(Kind, SDoc)] -&gt; Maybe (Kind, SDoc)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; Kind -&gt; Kind -&gt; Bool
Kind -&gt; Kind -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-identifier hs-var">eqType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621682726774"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; Bool) -&gt; ((Kind, SDoc) -&gt; Kind) -&gt; (Kind, SDoc) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Kind, SDoc) -&gt; Kind
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Kind, SDoc)]
</span><a href="#local-6989586621682726777"><span class="hs-identifier hs-var">tbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-798"></span><span>
</span><span id="line-799"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltCon"><span class="hs-identifier hs-type">PmAltCon</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-800"></span><span>  </span><span id="local-6989586621682726798"><span class="annot"><span class="annottext">ppr :: PmAltCon -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltConLike"><span class="hs-identifier hs-type">PmAltConLike</span></a></span><span> </span><span id="local-6989586621682726799"><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621682726799"><span class="hs-identifier hs-var">cl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConLike -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621682726799"><span class="hs-identifier hs-var">cl</span></a></span><span>
</span><span id="line-801"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmAltLit"><span class="hs-identifier hs-type">PmAltLit</span></a></span><span> </span><span id="local-6989586621682726800"><span class="annot"><span class="annottext">PmLit
</span><a href="#local-6989586621682726800"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PmLit -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">PmLit
</span><a href="#local-6989586621682726800"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-802"></span><span>
</span><span id="line-803"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.Solver.Types.html#PmEquality"><span class="hs-identifier hs-type">PmEquality</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-804"></span><span>  </span><span id="local-6989586621682726805"><span class="annot"><span class="annottext">ppr :: PmEquality -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; SDoc) -&gt; (PmEquality -&gt; String) -&gt; PmEquality -&gt; SDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PmEquality -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-805"></span></pre></body></html>