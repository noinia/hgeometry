<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html"><span class="hs-identifier">GHC.StgToCmm.InfoTableProv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#emitIpeBufferListNode"><span class="hs-identifier">emitIpeBufferListNode</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.html"><span class="hs-identifier">Foreign</span></a></span><span class="hs-cpp">

#if defined(HAVE_LIBZSTD)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign.C.Types</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString.Internal</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BSI</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unsafePerformIO</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.html"><span class="hs-identifier">GHC.Platform</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#pprUserRealSpan"><span class="hs-identifier">pprUserRealSpan</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#srcSpanFile"><span class="hs-identifier">srcSpanFile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSM.html"><span class="hs-identifier">GHC.Types.Unique.DSM</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html"><span class="hs-identifier">GHC.Unit.Module</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.FastString.html#fastStringToShortText"><span class="hs-identifier">fastStringToShortText</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#unpackFS"><span class="hs-identifier">unpackFS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#LexicalFastString"><span class="hs-identifier">LexicalFastString</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.html"><span class="hs-identifier">GHC.Cmm</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html"><span class="hs-identifier">GHC.Cmm.CLabel</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Utils.html"><span class="hs-identifier">GHC.Cmm.Utils</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Config.html"><span class="hs-identifier">GHC.StgToCmm.Config</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Monad.html"><span class="hs-identifier">GHC.StgToCmm.Monad</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.ShortText.html"><span class="hs-identifier">GHC.Data.ShortText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.ShortText.html#ShortText"><span class="hs-identifier">ShortText</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.ShortText.html"><span class="hs-identifier">GHC.Data.ShortText</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ST</span></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Builder.html"><span class="hs-identifier">Data.ByteString.Builder</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BSB</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.html"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BSL</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">{-
Note [Compression and Decompression of IPE data]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Compiling with `-finfo-table-map` causes build results to include a map from
info tables to source positions called the info table provenance entry (IPE)
map. See Note [Mapping Info Tables to Source Positions]. The IPE information
can grow the size of build results significantly. At the time of writing, a
default build of GHC results in a total of 109M of libHSghc-*.so build results.
A default+ipe build of GHC (see ./hadrian/doc/flavours.md) results in 262M of
libHSghc-*.so build results without compression.

We reduce the impact of IPE data on the size of build results by compressing
the data before it is emitted using the zstd compression library. See
Note [The Info Table Provenance Entry (IPE) Map] for information on the layout
of IPE data on disk and in the RTS. We cannot simply compress all data held in
the IPE entry buffer, as the pointers to info tables must be converted to
memory addresses during linking. Therefore, we can only compress the strings
table and the IPE entries themselves (which essentially only consist of indices
into the strings table).

With compression, a default+ipe build of GHC results in a total of 205M of
libHSghc-*.so build results. This is over a 20% reduction from the uncompressed
case.

Decompression happens lazily, as it only occurs when the IPE map is
constructed (which is also done lazily on first lookup or traversal). During
construction, the 'compressed' field of each IPE buffer list node is examined.
If the field indicates that the data has been compressed, the entry data and
strings table are decompressed before continuing with the normal IPE map
construction.
-}</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#emitIpeBufferListNode"><span class="hs-identifier hs-type">emitIpeBufferListNode</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-72"></span><span>     </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.CLabel.html#InfoProvEnt"><span class="hs-identifier hs-type">InfoProvEnt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSM.html#DUniqSupply"><span class="hs-identifier hs-type">DUniqSupply</span></a></span><span> </span><span class="hs-comment">-- ^ Symbols created source uniques deterministically</span><span>
</span><span id="line-75"></span><span>                 </span><span class="hs-comment">-- All uniques must be created from this supply.</span><span>
</span><span id="line-76"></span><span>                 </span><span class="hs-comment">-- NB: If you are creating a new symbol within this function,</span><span>
</span><span id="line-77"></span><span>                 </span><span class="hs-comment">-- make sure it is local only (as in not `externallyVisibleCLabel`).</span><span>
</span><span id="line-78"></span><span>                 </span><span class="hs-comment">-- If you need it to be global, reconsider the comment on the</span><span>
</span><span id="line-79"></span><span>                 </span><span class="hs-comment">-- call of emitIpeBufferListNode in Cmm.Parser.</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Monad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSM.html#DUniqSupply"><span class="hs-identifier hs-type">DUniqSupply</span></a></span><span>
</span><span id="line-81"></span><span id="emitIpeBufferListNode"><span class="annot"><span class="annottext">emitIpeBufferListNode :: Module -&gt; [InfoProvEnt] -&gt; DUniqSupply -&gt; FCode DUniqSupply
</span><a href="GHC.StgToCmm.InfoTableProv.html#emitIpeBufferListNode"><span class="hs-identifier hs-var hs-var">emitIpeBufferListNode</span></a></span></span><span> </span><span class="annot"><span class="annottext">Module
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621682886148"><span class="annot"><span class="annottext">DUniqSupply
</span><a href="#local-6989586621682886148"><span class="hs-identifier hs-var">dus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DUniqSupply -&gt; FCode DUniqSupply
forall a. a -&gt; FCode a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DUniqSupply
</span><a href="#local-6989586621682886148"><span class="hs-identifier hs-var">dus</span></a></span><span>
</span><span id="line-82"></span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#emitIpeBufferListNode"><span class="hs-identifier hs-var">emitIpeBufferListNode</span></a></span><span> </span><span id="local-6989586621682886149"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621682886149"><span class="hs-identifier hs-var">this_mod</span></a></span></span><span> </span><span id="local-6989586621682886150"><span class="annot"><span class="annottext">[InfoProvEnt]
</span><a href="#local-6989586621682886150"><span class="hs-identifier hs-var">ents</span></a></span></span><span> </span><span id="local-6989586621682886151"><span class="annot"><span class="annottext">DUniqSupply
</span><a href="#local-6989586621682886151"><span class="hs-identifier hs-var">dus0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-83"></span><span>    </span><span id="local-6989586621682886152"><span class="annot"><a href="#local-6989586621682886152"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FCode StgToCmmConfig
</span><a href="GHC.StgToCmm.Monad.html#getStgToCmmConfig"><span class="hs-identifier hs-var">getStgToCmmConfig</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682886154"><span class="annot"><a href="#local-6989586621682886154"><span class="hs-identifier hs-var">u1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682886155"><span class="annot"><a href="#local-6989586621682886155"><span class="hs-identifier hs-var">dus1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSM.html#takeUniqueFromDSupply"><span class="hs-identifier hs-type">takeUniqueFromDSupply</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886151"><span class="hs-identifier hs-type">dus0</span></a></span><span>
</span><span id="line-86"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682886157"><span class="annot"><a href="#local-6989586621682886157"><span class="hs-identifier hs-var">u2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682886158"><span class="annot"><a href="#local-6989586621682886158"><span class="hs-identifier hs-var">dus2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSM.html#takeUniqueFromDSupply"><span class="hs-identifier hs-type">takeUniqueFromDSupply</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886155"><span class="hs-identifier hs-type">dus1</span></a></span><span>
</span><span id="line-87"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682886159"><span class="annot"><a href="#local-6989586621682886159"><span class="hs-identifier hs-var">u3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682886160"><span class="annot"><a href="#local-6989586621682886160"><span class="hs-identifier hs-var">dus3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSM.html#takeUniqueFromDSupply"><span class="hs-identifier hs-type">takeUniqueFromDSupply</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886158"><span class="hs-identifier hs-type">dus2</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span>        </span><span id="local-6989586621682886161"><span class="annot"><a href="#local-6989586621682886161"><span class="hs-identifier hs-var hs-var">tables_lbl</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; CLabel
</span><a href="GHC.Cmm.CLabel.html#mkStringLitLabel"><span class="hs-identifier hs-var">mkStringLitLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682886154"><span class="hs-identifier hs-var">u1</span></a></span><span>
</span><span id="line-90"></span><span>        </span><span id="local-6989586621682886163"><span class="annot"><a href="#local-6989586621682886163"><span class="hs-identifier hs-var hs-var">strings_lbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; CLabel
</span><a href="GHC.Cmm.CLabel.html#mkStringLitLabel"><span class="hs-identifier hs-var">mkStringLitLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682886157"><span class="hs-identifier hs-var">u2</span></a></span><span>
</span><span id="line-91"></span><span>        </span><span id="local-6989586621682886164"><span class="annot"><a href="#local-6989586621682886164"><span class="hs-identifier hs-var hs-var">entries_lbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; CLabel
</span><a href="GHC.Cmm.CLabel.html#mkStringLitLabel"><span class="hs-identifier hs-var">mkStringLitLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682886159"><span class="hs-identifier hs-var">u3</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>        </span><span id="local-6989586621682886165"><span class="annot"><a href="#local-6989586621682886165"><span class="hs-identifier hs-var hs-var">ctx</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StgToCmmConfig -&gt; SDocContext
</span><a href="GHC.StgToCmm.Config.html#stgToCmmContext"><span class="hs-identifier hs-var">stgToCmmContext</span></a></span><span> </span><span class="annot"><span class="annottext">StgToCmmConfig
</span><a href="#local-6989586621682886152"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-94"></span><span>        </span><span id="local-6989586621682886167"><span class="annot"><a href="#local-6989586621682886167"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StgToCmmConfig -&gt; Platform
</span><a href="GHC.StgToCmm.Config.html#stgToCmmPlatform"><span class="hs-identifier hs-var">stgToCmmPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">StgToCmmConfig
</span><a href="#local-6989586621682886152"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-95"></span><span>        </span><span id="local-6989586621682886169"><span class="annot"><a href="#local-6989586621682886169"><span class="hs-identifier hs-var hs-var">int</span></a></span></span><span> </span><span id="local-6989586621682886170"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682886170"><span class="hs-identifier hs-var">n</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Int -&gt; CmmLit
</span><a href="GHC.Cmm.Utils.html#mkIntCLit"><span class="hs-identifier hs-var">mkIntCLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682886167"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682886170"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>        </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682886172"><span class="annot"><a href="#local-6989586621682886172"><span class="hs-identifier hs-var">cg_ipes</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682886173"><span class="annot"><a href="#local-6989586621682886173"><span class="hs-identifier hs-var">unit_id</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682886174"><span class="annot"><a href="#local-6989586621682886174"><span class="hs-identifier hs-var">module_name</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621682886175"><span class="annot"><a href="#local-6989586621682886175"><span class="hs-identifier hs-var">strtab</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">flip</span></span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#runState"><span class="hs-identifier hs-type">runState</span></a></span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#emptyStringTable"><span class="hs-identifier hs-type">emptyStringTable</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>          </span><span id="local-6989586621682886179"><span class="annot"><a href="#local-6989586621682886179"><span class="hs-identifier hs-var">unit_id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#lookupStringTable"><span class="hs-identifier hs-type">lookupStringTable</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.ShortText.html#pack"><span class="hs-identifier hs-type">ST.pack</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#renderWithContext"><span class="hs-identifier hs-type">renderWithContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886165"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#moduleName"><span class="hs-identifier hs-var">moduleName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886149"><span class="hs-identifier hs-type">this_mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>          </span><span id="local-6989586621682886185"><span class="annot"><a href="#local-6989586621682886185"><span class="hs-identifier hs-var">module_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#lookupStringTable"><span class="hs-identifier hs-type">lookupStringTable</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.ShortText.html#pack"><span class="hs-identifier hs-type">ST.pack</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#renderWithContext"><span class="hs-identifier hs-type">renderWithContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886165"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#moduleUnit"><span class="hs-identifier hs-var">moduleUnit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886149"><span class="hs-identifier hs-type">this_mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>          </span><span id="local-6989586621682886187"><span class="annot"><a href="#local-6989586621682886187"><span class="hs-identifier hs-var">cg_ipes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#toCgIPE"><span class="hs-identifier hs-type">toCgIPE</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886167"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886165"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682886150"><span class="hs-identifier hs-type">ents</span></a></span><span>
</span><span id="line-101"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682886187"><span class="hs-identifier hs-type">cg_ipes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682886179"><span class="hs-identifier hs-type">unit_id</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682886185"><span class="hs-identifier hs-type">module_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><a href="#local-6989586621682886190"><span class="hs-identifier hs-type">tables</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.html#CmmStatic"><span class="hs-identifier hs-type">CmmStatic</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-104"></span><span>        </span><span id="local-6989586621682886190"><span class="annot"><a href="#local-6989586621682886190"><span class="hs-identifier hs-var hs-var">tables</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CgInfoProvEnt -&gt; CmmStatic) -&gt; [CgInfoProvEnt] -&gt; [CmmStatic]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; CmmStatic
</span><a href="GHC.Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmLit -&gt; CmmStatic)
-&gt; (CgInfoProvEnt -&gt; CmmLit) -&gt; CgInfoProvEnt -&gt; CmmStatic
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CLabel -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a></span><span> </span><span class="annot"><span class="annottext">(CLabel -&gt; CmmLit)
-&gt; (CgInfoProvEnt -&gt; CLabel) -&gt; CgInfoProvEnt -&gt; CmmLit
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CgInfoProvEnt -&gt; CLabel
</span><a href="GHC.StgToCmm.InfoTableProv.html#ipeInfoTablePtr"><span class="hs-identifier hs-var">ipeInfoTablePtr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CgInfoProvEnt]
</span><a href="#local-6989586621682886172"><span class="hs-identifier hs-var">cg_ipes</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span>        </span><span class="annot"><a href="#local-6989586621682886195"><span class="hs-identifier hs-type">uncompressed_strings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-107"></span><span>        </span><span id="local-6989586621682886195"><span class="annot"><a href="#local-6989586621682886195"><span class="hs-identifier hs-var hs-var">uncompressed_strings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StringTable -&gt; ByteString
</span><a href="GHC.StgToCmm.InfoTableProv.html#getStringTableStrings"><span class="hs-identifier hs-var">getStringTableStrings</span></a></span><span> </span><span class="annot"><span class="annottext">StringTable
</span><a href="#local-6989586621682886175"><span class="hs-identifier hs-var">strtab</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>        </span><span class="annot"><a href="#local-6989586621682886197"><span class="hs-identifier hs-type">strings_bytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-110"></span><span>        </span><span id="local-6989586621682886197"><span class="annot"><a href="#local-6989586621682886197"><span class="hs-identifier hs-var hs-var">strings_bytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="GHC.StgToCmm.InfoTableProv.html#compress"><span class="hs-identifier hs-var">compress</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GHC.StgToCmm.InfoTableProv.html#defaultCompressionLevel"><span class="hs-identifier hs-var">defaultCompressionLevel</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682886195"><span class="hs-identifier hs-var">uncompressed_strings</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span>        </span><span class="annot"><a href="#local-6989586621682886200"><span class="hs-identifier hs-type">strings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.html#CmmStatic"><span class="hs-identifier hs-type">CmmStatic</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span>        </span><span id="local-6989586621682886200"><span class="annot"><a href="#local-6989586621682886200"><span class="hs-identifier hs-var hs-var">strings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString -&gt; CmmStatic
</span><a href="GHC.Cmm.html#CmmString"><span class="hs-identifier hs-var">CmmString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682886197"><span class="hs-identifier hs-var">strings_bytes</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>        </span><span class="annot"><a href="#local-6989586621682886202"><span class="hs-identifier hs-type">uncompressed_entries</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-116"></span><span>        </span><span id="local-6989586621682886202"><span class="annot"><a href="#local-6989586621682886202"><span class="hs-identifier hs-var hs-var">uncompressed_entries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteOrder -&gt; [CgInfoProvEnt] -&gt; ByteString
</span><a href="GHC.StgToCmm.InfoTableProv.html#toIpeBufferEntries"><span class="hs-identifier hs-var">toIpeBufferEntries</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; ByteOrder
</span><a href="GHC.Platform.html#platformByteOrder"><span class="hs-identifier hs-var">platformByteOrder</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682886167"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CgInfoProvEnt]
</span><a href="#local-6989586621682886172"><span class="hs-identifier hs-var">cg_ipes</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span>        </span><span class="annot"><a href="#local-6989586621682886205"><span class="hs-identifier hs-type">entries_bytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-119"></span><span>        </span><span id="local-6989586621682886205"><span class="annot"><a href="#local-6989586621682886205"><span class="hs-identifier hs-var hs-var">entries_bytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="GHC.StgToCmm.InfoTableProv.html#compress"><span class="hs-identifier hs-var">compress</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GHC.StgToCmm.InfoTableProv.html#defaultCompressionLevel"><span class="hs-identifier hs-var">defaultCompressionLevel</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682886202"><span class="hs-identifier hs-var">uncompressed_entries</span></a></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><a href="#local-6989586621682886206"><span class="hs-identifier hs-type">entries</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.html#CmmStatic"><span class="hs-identifier hs-type">CmmStatic</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-122"></span><span>        </span><span id="local-6989586621682886206"><span class="annot"><a href="#local-6989586621682886206"><span class="hs-identifier hs-var hs-var">entries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString -&gt; CmmStatic
</span><a href="GHC.Cmm.html#CmmString"><span class="hs-identifier hs-var">CmmString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682886205"><span class="hs-identifier hs-var">entries_bytes</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><a href="#local-6989586621682886207"><span class="hs-identifier hs-type">ipe_buffer_lbl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a></span><span>
</span><span id="line-125"></span><span>        </span><span id="local-6989586621682886207"><span class="annot"><a href="#local-6989586621682886207"><span class="hs-identifier hs-var hs-var">ipe_buffer_lbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; CLabel
</span><a href="GHC.Cmm.CLabel.html#mkIPELabel"><span class="hs-identifier hs-var">mkIPELabel</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621682886149"><span class="hs-identifier hs-var">this_mod</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><a href="#local-6989586621682886209"><span class="hs-identifier hs-type">ipe_buffer_node</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.html#CmmStatic"><span class="hs-identifier hs-type">CmmStatic</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span>        </span><span id="local-6989586621682886209"><span class="annot"><a href="#local-6989586621682886209"><span class="hs-identifier hs-var hs-var">ipe_buffer_node</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CmmLit -&gt; CmmStatic) -&gt; [CmmLit] -&gt; [CmmStatic]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmStatic
</span><a href="GHC.Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a></span><span>
</span><span id="line-129"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="hs-comment">-- 'next' field</span><span>
</span><span id="line-130"></span><span>            </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit
</span><a href="GHC.Cmm.Utils.html#zeroCLit"><span class="hs-identifier hs-var">zeroCLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682886167"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span>            </span><span class="hs-comment">-- 'compressed' field</span><span>
</span><span id="line-133"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; CmmLit
</span><a href="#local-6989586621682886169"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GHC.StgToCmm.InfoTableProv.html#do_compress"><span class="hs-identifier hs-var">do_compress</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>            </span><span class="hs-comment">-- 'count' field</span><span>
</span><span id="line-136"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; CmmLit
</span><a href="#local-6989586621682886169"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; CmmLit) -&gt; Int -&gt; CmmLit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[CgInfoProvEnt] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[CgInfoProvEnt]
</span><a href="#local-6989586621682886172"><span class="hs-identifier hs-var">cg_ipes</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span>            </span><span class="hs-comment">-- 'tables' field</span><span>
</span><span id="line-139"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CLabel -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682886161"><span class="hs-identifier hs-var">tables_lbl</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>            </span><span class="hs-comment">-- 'entries' field</span><span>
</span><span id="line-142"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CLabel -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682886164"><span class="hs-identifier hs-var">entries_lbl</span></a></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>            </span><span class="hs-comment">-- 'entries_size' field (decompressed size)</span><span>
</span><span id="line-145"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; CmmLit
</span><a href="#local-6989586621682886169"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; CmmLit) -&gt; Int -&gt; CmmLit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html#length"><span class="hs-identifier hs-var">BS.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682886202"><span class="hs-identifier hs-var">uncompressed_entries</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>            </span><span class="hs-comment">-- 'string_table' field</span><span>
</span><span id="line-148"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CLabel -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682886163"><span class="hs-identifier hs-var">strings_lbl</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>            </span><span class="hs-comment">-- 'string_table_size' field (decompressed size)</span><span>
</span><span id="line-151"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; CmmLit
</span><a href="#local-6989586621682886169"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; CmmLit) -&gt; Int -&gt; CmmLit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html#length"><span class="hs-identifier hs-var">BS.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682886195"><span class="hs-identifier hs-var">uncompressed_strings</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span>            </span><span class="hs-comment">-- 'module_name' field</span><span>
</span><span id="line-154"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrTabOffset -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">StrTabOffset
</span><a href="#local-6989586621682886174"><span class="hs-identifier hs-var">module_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>            </span><span class="hs-comment">-- 'unit_id' field</span><span>
</span><span id="line-157"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrTabOffset -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">StrTabOffset
</span><a href="#local-6989586621682886173"><span class="hs-identifier hs-var">unit_id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>
</span><span id="line-158"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-comment">-- Emit the list of info table pointers</span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><a href="GHC.StgToCmm.Monad.html#emitDecl"><span class="hs-identifier hs-type">emitDecl</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.html#CmmData"><span class="hs-identifier hs-type">CmmData</span></a></span><span>
</span><span id="line-162"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#Section"><span class="hs-identifier hs-type">Section</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886161"><span class="hs-identifier hs-type">tables_lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#CmmStaticsRaw"><span class="hs-identifier hs-type">CmmStaticsRaw</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886161"><span class="hs-identifier hs-type">tables_lbl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886190"><span class="hs-identifier hs-type">tables</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-comment">-- Emit the strings table</span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><a href="GHC.StgToCmm.Monad.html#emitDecl"><span class="hs-identifier hs-type">emitDecl</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.html#CmmData"><span class="hs-identifier hs-type">CmmData</span></a></span><span>
</span><span id="line-167"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#Section"><span class="hs-identifier hs-type">Section</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886163"><span class="hs-identifier hs-type">strings_lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#CmmStaticsRaw"><span class="hs-identifier hs-type">CmmStaticsRaw</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886163"><span class="hs-identifier hs-type">strings_lbl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886200"><span class="hs-identifier hs-type">strings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-comment">-- Emit the list of IPE buffer entries</span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><a href="GHC.StgToCmm.Monad.html#emitDecl"><span class="hs-identifier hs-type">emitDecl</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.html#CmmData"><span class="hs-identifier hs-type">CmmData</span></a></span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#Section"><span class="hs-identifier hs-type">Section</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886164"><span class="hs-identifier hs-type">entries_lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#CmmStaticsRaw"><span class="hs-identifier hs-type">CmmStaticsRaw</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886164"><span class="hs-identifier hs-type">entries_lbl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886206"><span class="hs-identifier hs-type">entries</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-comment">-- Emit the IPE buffer list node</span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><a href="GHC.StgToCmm.Monad.html#emitDecl"><span class="hs-identifier hs-type">emitDecl</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.html#CmmData"><span class="hs-identifier hs-type">CmmData</span></a></span><span>
</span><span id="line-177"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#Section"><span class="hs-identifier hs-type">Section</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886207"><span class="hs-identifier hs-type">ipe_buffer_lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#CmmStaticsRaw"><span class="hs-identifier hs-type">CmmStaticsRaw</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886207"><span class="hs-identifier hs-type">ipe_buffer_lbl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886209"><span class="hs-identifier hs-type">ipe_buffer_node</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682886160"><span class="hs-identifier hs-type">dus3</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><span class="hs-comment">-- | Emit the fields of an IpeBufferEntry struct for each entry in a given list.</span></span><span>
</span><span id="line-183"></span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#toIpeBufferEntries"><span class="hs-identifier hs-type">toIpeBufferEntries</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-184"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">ByteOrder</span></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Byte order to write the data in</span></span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#CgInfoProvEnt"><span class="hs-identifier hs-type">CgInfoProvEnt</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ List of IPE buffer entries</span></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-187"></span><span id="toIpeBufferEntries"><span class="annot"><span class="annottext">toIpeBufferEntries :: ByteOrder -&gt; [CgInfoProvEnt] -&gt; ByteString
</span><a href="GHC.StgToCmm.InfoTableProv.html#toIpeBufferEntries"><span class="hs-identifier hs-var hs-var">toIpeBufferEntries</span></a></span></span><span> </span><span id="local-6989586621682886221"><span class="annot"><span class="annottext">ByteOrder
</span><a href="#local-6989586621682886221"><span class="hs-identifier hs-var">byte_order</span></a></span></span><span> </span><span id="local-6989586621682886222"><span class="annot"><span class="annottext">[CgInfoProvEnt]
</span><a href="#local-6989586621682886222"><span class="hs-identifier hs-var">cg_ipes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-188"></span><span>      </span><span class="annot"><span class="annottext">LazyByteString -&gt; ByteString
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.Internal.html#toStrict"><span class="hs-identifier hs-var">BSL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(LazyByteString -&gt; ByteString)
-&gt; ([Builder] -&gt; LazyByteString) -&gt; [Builder] -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; LazyByteString
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Builder.Internal.html#toLazyByteString"><span class="hs-identifier hs-var">BSB.toLazyByteString</span></a></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; LazyByteString)
-&gt; ([Builder] -&gt; Builder) -&gt; [Builder] -&gt; LazyByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="annottext">([Builder] -&gt; ByteString) -&gt; [Builder] -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(CgInfoProvEnt -&gt; Builder) -&gt; [CgInfoProvEnt] -&gt; [Builder]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([Builder] -&gt; Builder)
-&gt; (CgInfoProvEnt -&gt; [Builder]) -&gt; CgInfoProvEnt -&gt; Builder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(StrTabOffset -&gt; Builder) -&gt; [StrTabOffset] -&gt; [Builder]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">StrTabOffset -&gt; Builder
</span><a href="#local-6989586621682886225"><span class="hs-identifier hs-var">word32Builder</span></a></span><span> </span><span class="annot"><span class="annottext">([StrTabOffset] -&gt; [Builder])
-&gt; (CgInfoProvEnt -&gt; [StrTabOffset]) -&gt; CgInfoProvEnt -&gt; [Builder]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CgInfoProvEnt -&gt; [StrTabOffset]
</span><a href="#local-6989586621682886226"><span class="hs-identifier hs-var">to_ipe_buf_ent</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CgInfoProvEnt]
</span><a href="#local-6989586621682886222"><span class="hs-identifier hs-var">cg_ipes</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><a href="#local-6989586621682886226"><span class="hs-identifier hs-type">to_ipe_buf_ent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#CgInfoProvEnt"><span class="hs-identifier hs-type">CgInfoProvEnt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">]</span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621682886226"><span class="annot"><span class="annottext">to_ipe_buf_ent :: CgInfoProvEnt -&gt; [StrTabOffset]
</span><a href="#local-6989586621682886226"><span class="hs-identifier hs-var hs-var">to_ipe_buf_ent</span></a></span></span><span> </span><span id="local-6989586621682886227"><span class="annot"><span class="annottext">CgInfoProvEnt
</span><a href="#local-6989586621682886227"><span class="hs-identifier hs-var">cg_ipe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">CgInfoProvEnt -&gt; StrTabOffset
</span><a href="GHC.StgToCmm.InfoTableProv.html#ipeTableName"><span class="hs-identifier hs-var">ipeTableName</span></a></span><span> </span><span class="annot"><span class="annottext">CgInfoProvEnt
</span><a href="#local-6989586621682886227"><span class="hs-identifier hs-var">cg_ipe</span></a></span><span>
</span><span id="line-194"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StrTabOffset -&gt; StrTabOffset
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(StrTabOffset -&gt; StrTabOffset) -&gt; StrTabOffset -&gt; StrTabOffset
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CgInfoProvEnt -&gt; StrTabOffset
</span><a href="GHC.StgToCmm.InfoTableProv.html#ipeClosureDesc"><span class="hs-identifier hs-var">ipeClosureDesc</span></a></span><span> </span><span class="annot"><span class="annottext">CgInfoProvEnt
</span><a href="#local-6989586621682886227"><span class="hs-identifier hs-var">cg_ipe</span></a></span><span>
</span><span id="line-195"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CgInfoProvEnt -&gt; StrTabOffset
</span><a href="GHC.StgToCmm.InfoTableProv.html#ipeTypeDesc"><span class="hs-identifier hs-var">ipeTypeDesc</span></a></span><span> </span><span class="annot"><span class="annottext">CgInfoProvEnt
</span><a href="#local-6989586621682886227"><span class="hs-identifier hs-var">cg_ipe</span></a></span><span>
</span><span id="line-196"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CgInfoProvEnt -&gt; StrTabOffset
</span><a href="GHC.StgToCmm.InfoTableProv.html#ipeLabel"><span class="hs-identifier hs-var">ipeLabel</span></a></span><span> </span><span class="annot"><span class="annottext">CgInfoProvEnt
</span><a href="#local-6989586621682886227"><span class="hs-identifier hs-var">cg_ipe</span></a></span><span>
</span><span id="line-197"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CgInfoProvEnt -&gt; StrTabOffset
</span><a href="GHC.StgToCmm.InfoTableProv.html#ipeSrcFile"><span class="hs-identifier hs-var">ipeSrcFile</span></a></span><span> </span><span class="annot"><span class="annottext">CgInfoProvEnt
</span><a href="#local-6989586621682886227"><span class="hs-identifier hs-var">cg_ipe</span></a></span><span>
</span><span id="line-198"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CgInfoProvEnt -&gt; StrTabOffset
</span><a href="GHC.StgToCmm.InfoTableProv.html#ipeSrcSpan"><span class="hs-identifier hs-var">ipeSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">CgInfoProvEnt
</span><a href="#local-6989586621682886227"><span class="hs-identifier hs-var">cg_ipe</span></a></span><span>
</span><span id="line-199"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><a href="#local-6989586621682886225"><span class="hs-identifier hs-type">word32Builder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier hs-type">BSB.Builder</span></a></span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621682886225"><span class="annot"><span class="annottext">word32Builder :: StrTabOffset -&gt; Builder
</span><a href="#local-6989586621682886225"><span class="hs-identifier hs-var hs-var">word32Builder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteOrder
</span><a href="#local-6989586621682886221"><span class="hs-identifier hs-var">byte_order</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-203"></span><span>      </span><span class="annot"><span class="annottext">ByteOrder
</span><span class="hs-identifier hs-var">BigEndian</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StrTabOffset -&gt; Builder
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Builder.html#word32BE"><span class="hs-identifier hs-var">BSB.word32BE</span></a></span><span>
</span><span id="line-204"></span><span>      </span><span class="annot"><span class="annottext">ByteOrder
</span><span class="hs-identifier hs-var">LittleEndian</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StrTabOffset -&gt; Builder
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Builder.html#word32LE"><span class="hs-identifier hs-var">BSB.word32LE</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#toCgIPE"><span class="hs-identifier hs-type">toCgIPE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDocContext"><span class="hs-identifier hs-type">SDocContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html#InfoProvEnt"><span class="hs-identifier hs-type">InfoProvEnt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#StringTable"><span class="hs-identifier hs-type">StringTable</span></a></span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#CgInfoProvEnt"><span class="hs-identifier hs-type">CgInfoProvEnt</span></a></span><span>
</span><span id="line-207"></span><span id="toCgIPE"><span class="annot"><span class="annottext">toCgIPE :: Platform
-&gt; SDocContext
-&gt; InfoProvEnt
-&gt; StateT StringTable Identity CgInfoProvEnt
</span><a href="GHC.StgToCmm.InfoTableProv.html#toCgIPE"><span class="hs-identifier hs-var hs-var">toCgIPE</span></a></span></span><span> </span><span id="local-6989586621682886238"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682886238"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682886239"><span class="annot"><span class="annottext">SDocContext
</span><a href="#local-6989586621682886239"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621682886240"><span class="annot"><span class="annottext">InfoProvEnt
</span><a href="#local-6989586621682886240"><span class="hs-identifier hs-var">ipe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-208"></span><span>    </span><span id="local-6989586621682886241"><span class="annot"><a href="#local-6989586621682886241"><span class="hs-identifier hs-var">table_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ShortText -&gt; State StringTable StrTabOffset
</span><a href="GHC.StgToCmm.InfoTableProv.html#lookupStringTable"><span class="hs-identifier hs-var">lookupStringTable</span></a></span><span> </span><span class="annot"><span class="annottext">(ShortText -&gt; State StringTable StrTabOffset)
-&gt; ShortText -&gt; State StringTable StrTabOffset
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShortText
</span><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.ShortText.html#pack"><span class="hs-identifier hs-var">ST.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ShortText) -&gt; String -&gt; ShortText
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDocContext -&gt; SDoc -&gt; String
</span><a href="GHC.Utils.Outputable.html#renderWithContext"><span class="hs-identifier hs-var">renderWithContext</span></a></span><span> </span><span class="annot"><span class="annottext">SDocContext
</span><a href="#local-6989586621682886239"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CLabel -&gt; SDoc
forall doc. IsLine doc =&gt; Platform -&gt; CLabel -&gt; doc
</span><a href="GHC.Cmm.CLabel.html#pprCLabel"><span class="hs-identifier hs-var">pprCLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682886238"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InfoProvEnt -&gt; CLabel
</span><a href="GHC.Cmm.CLabel.html#infoTablePtr"><span class="hs-identifier hs-var">infoTablePtr</span></a></span><span> </span><span class="annot"><span class="annottext">InfoProvEnt
</span><a href="#local-6989586621682886240"><span class="hs-identifier hs-var">ipe</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>    </span><span id="local-6989586621682886244"><span class="annot"><a href="#local-6989586621682886244"><span class="hs-identifier hs-var">type_desc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#lookupStringTable"><span class="hs-identifier hs-type">lookupStringTable</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.ShortText.html#pack"><span class="hs-identifier hs-type">ST.pack</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html#infoTableType"><span class="hs-identifier hs-var">infoTableType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886240"><span class="hs-identifier hs-type">ipe</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682886246"><span class="annot"><a href="#local-6989586621682886246"><span class="hs-identifier hs-var hs-var">label_str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ((RealSrcSpan, LexicalFastString) -&gt; String)
-&gt; Maybe (RealSrcSpan, LexicalFastString)
-&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.FastString.html#LexicalFastString"><span class="hs-identifier hs-type">LexicalFastString</span></a></span><span> </span><span id="local-6989586621682886249"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682886249"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; String
</span><a href="GHC.Data.FastString.html#unpackFS"><span class="hs-identifier hs-var">unpackFS</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682886249"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LexicalFastString -&gt; String)
-&gt; ((RealSrcSpan, LexicalFastString) -&gt; LexicalFastString)
-&gt; (RealSrcSpan, LexicalFastString)
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(RealSrcSpan, LexicalFastString) -&gt; LexicalFastString
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InfoProvEnt -&gt; Maybe (RealSrcSpan, LexicalFastString)
</span><a href="GHC.Cmm.CLabel.html#infoTableProv"><span class="hs-identifier hs-var">infoTableProv</span></a></span><span> </span><span class="annot"><span class="annottext">InfoProvEnt
</span><a href="#local-6989586621682886240"><span class="hs-identifier hs-var">ipe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682886252"><span class="annot"><a href="#local-6989586621682886252"><span class="hs-identifier hs-var">src_loc_file</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682886253"><span class="annot"><a href="#local-6989586621682886253"><span class="hs-identifier hs-var">src_loc_span</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html#infoTableProv"><span class="hs-identifier hs-var">infoTableProv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886240"><span class="hs-identifier hs-type">ipe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-213"></span><span>              </span><span class="annot"><span class="annottext">Maybe (RealSrcSpan, LexicalFastString)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShortText
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682886254"><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682886254"><span class="hs-identifier hs-var">span</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LexicalFastString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-215"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682886255"><span class="annot"><span class="annottext">file :: ShortText
</span><a href="#local-6989586621682886255"><span class="hs-identifier hs-var hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; ShortText
</span><a href="GHC.Data.FastString.html#fastStringToShortText"><span class="hs-identifier hs-var">fastStringToShortText</span></a></span><span> </span><span class="annot"><span class="annottext">(FastString -&gt; ShortText) -&gt; FastString -&gt; ShortText
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan -&gt; FastString
</span><a href="GHC.Types.SrcLoc.html#srcSpanFile"><span class="hs-identifier hs-var">srcSpanFile</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682886254"><span class="hs-identifier hs-var">span</span></a></span><span>
</span><span id="line-216"></span><span>                      </span><span id="local-6989586621682886256"><span class="annot"><span class="annottext">coords :: String
</span><a href="#local-6989586621682886256"><span class="hs-identifier hs-var hs-var">coords</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDocContext -&gt; SDoc -&gt; String
</span><a href="GHC.Utils.Outputable.html#renderWithContext"><span class="hs-identifier hs-var">renderWithContext</span></a></span><span> </span><span class="annot"><span class="annottext">SDocContext
</span><a href="#local-6989586621682886239"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; RealSrcSpan -&gt; SDoc
</span><a href="GHC.Types.SrcLoc.html#pprUserRealSpan"><span class="hs-identifier hs-var">pprUserRealSpan</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682886254"><span class="hs-identifier hs-var">span</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShortText
</span><a href="#local-6989586621682886255"><span class="hs-identifier hs-var">file</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682886256"><span class="hs-identifier hs-var">coords</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>    </span><span id="local-6989586621682886257"><span class="annot"><a href="#local-6989586621682886257"><span class="hs-keyword hs-var">label</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#lookupStringTable"><span class="hs-identifier hs-type">lookupStringTable</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.ShortText.html#pack"><span class="hs-identifier hs-type">ST.pack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886246"><span class="hs-identifier hs-type">label_str</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span id="local-6989586621682886258"><span class="annot"><a href="#local-6989586621682886258"><span class="hs-identifier hs-var">src_file</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#lookupStringTable"><span class="hs-identifier hs-type">lookupStringTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886252"><span class="hs-identifier hs-type">src_loc_file</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621682886259"><span class="annot"><a href="#local-6989586621682886259"><span class="hs-identifier hs-var">src_span</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#lookupStringTable"><span class="hs-identifier hs-type">lookupStringTable</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.ShortText.html#pack"><span class="hs-identifier hs-type">ST.pack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886253"><span class="hs-identifier hs-type">src_loc_span</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#CgInfoProvEnt"><span class="hs-identifier hs-type">CgInfoProvEnt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#ipeInfoTablePtr"><span class="hs-identifier hs-var">ipeInfoTablePtr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html#infoTablePtr"><span class="hs-identifier hs-var">infoTablePtr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886240"><span class="hs-identifier hs-type">ipe</span></a></span><span>
</span><span id="line-222"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#ipeTableName"><span class="hs-identifier hs-var">ipeTableName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682886241"><span class="hs-identifier hs-type">table_name</span></a></span><span>
</span><span id="line-223"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#ipeClosureDesc"><span class="hs-identifier hs-var">ipeClosureDesc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.CLabel.html#infoProvEntClosureType"><span class="hs-identifier hs-var">infoProvEntClosureType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886240"><span class="hs-identifier hs-type">ipe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#ipeTypeDesc"><span class="hs-identifier hs-var">ipeTypeDesc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682886244"><span class="hs-identifier hs-type">type_desc</span></a></span><span>
</span><span id="line-225"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#ipeLabel"><span class="hs-identifier hs-var">ipeLabel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682886257"><span class="hs-keyword hs-type">label</span></a></span><span>
</span><span id="line-226"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#ipeSrcFile"><span class="hs-identifier hs-var">ipeSrcFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682886258"><span class="hs-identifier hs-type">src_file</span></a></span><span>
</span><span id="line-227"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#ipeSrcSpan"><span class="hs-identifier hs-var">ipeSrcSpan</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682886259"><span class="hs-identifier hs-type">src_span</span></a></span><span>
</span><span id="line-228"></span><span>                           </span><span class="hs-special">}</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-keyword">data</span><span> </span><span id="CgInfoProvEnt"><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#CgInfoProvEnt"><span class="hs-identifier hs-var">CgInfoProvEnt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CgInfoProvEnt"><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#CgInfoProvEnt"><span class="hs-identifier hs-var">CgInfoProvEnt</span></a></span></span><span>
</span><span id="line-231"></span><span>                               </span><span class="hs-special">{</span><span> </span><span id="ipeInfoTablePtr"><span class="annot"><span class="annottext">CgInfoProvEnt -&gt; CLabel
</span><a href="GHC.StgToCmm.InfoTableProv.html#ipeInfoTablePtr"><span class="hs-identifier hs-var hs-var">ipeInfoTablePtr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Cmm.CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a></span><span>
</span><span id="line-232"></span><span>                               </span><span class="hs-special">,</span><span> </span><span id="ipeTableName"><span class="annot"><span class="annottext">CgInfoProvEnt -&gt; StrTabOffset
</span><a href="GHC.StgToCmm.InfoTableProv.html#ipeTableName"><span class="hs-identifier hs-var hs-var">ipeTableName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#StrTabOffset"><span class="hs-identifier hs-type">StrTabOffset</span></a></span><span>
</span><span id="line-233"></span><span>                               </span><span class="hs-special">,</span><span> </span><span id="ipeClosureDesc"><span class="annot"><span class="annottext">CgInfoProvEnt -&gt; StrTabOffset
</span><a href="GHC.StgToCmm.InfoTableProv.html#ipeClosureDesc"><span class="hs-identifier hs-var hs-var">ipeClosureDesc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-234"></span><span>                               </span><span class="hs-special">,</span><span> </span><span id="ipeTypeDesc"><span class="annot"><span class="annottext">CgInfoProvEnt -&gt; StrTabOffset
</span><a href="GHC.StgToCmm.InfoTableProv.html#ipeTypeDesc"><span class="hs-identifier hs-var hs-var">ipeTypeDesc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#StrTabOffset"><span class="hs-identifier hs-type">StrTabOffset</span></a></span><span>
</span><span id="line-235"></span><span>                               </span><span class="hs-special">,</span><span> </span><span id="ipeLabel"><span class="annot"><span class="annottext">CgInfoProvEnt -&gt; StrTabOffset
</span><a href="GHC.StgToCmm.InfoTableProv.html#ipeLabel"><span class="hs-identifier hs-var hs-var">ipeLabel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#StrTabOffset"><span class="hs-identifier hs-type">StrTabOffset</span></a></span><span>
</span><span id="line-236"></span><span>                               </span><span class="hs-special">,</span><span> </span><span id="ipeSrcFile"><span class="annot"><span class="annottext">CgInfoProvEnt -&gt; StrTabOffset
</span><a href="GHC.StgToCmm.InfoTableProv.html#ipeSrcFile"><span class="hs-identifier hs-var hs-var">ipeSrcFile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#StrTabOffset"><span class="hs-identifier hs-type">StrTabOffset</span></a></span><span>
</span><span id="line-237"></span><span>                               </span><span class="hs-special">,</span><span> </span><span id="ipeSrcSpan"><span class="annot"><span class="annottext">CgInfoProvEnt -&gt; StrTabOffset
</span><a href="GHC.StgToCmm.InfoTableProv.html#ipeSrcSpan"><span class="hs-identifier hs-var hs-var">ipeSrcSpan</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#StrTabOffset"><span class="hs-identifier hs-type">StrTabOffset</span></a></span><span>
</span><span id="line-238"></span><span>                               </span><span class="hs-special">}</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-keyword">data</span><span> </span><span id="StringTable"><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#StringTable"><span class="hs-identifier hs-var">StringTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="StringTable"><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#StringTable"><span class="hs-identifier hs-var">StringTable</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="stStrings"><span class="annot"><span class="annottext">StringTable -&gt; DList ShortText
</span><a href="GHC.StgToCmm.InfoTableProv.html#stStrings"><span class="hs-identifier hs-var hs-var">stStrings</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#DList"><span class="hs-identifier hs-type">DList</span></a></span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.ShortText.html#ShortText"><span class="hs-identifier hs-type">ShortText</span></a></span><span>
</span><span id="line-241"></span><span>                               </span><span class="hs-special">,</span><span> </span><span id="stLength"><span class="annot"><span class="annottext">StringTable -&gt; Int
</span><a href="GHC.StgToCmm.InfoTableProv.html#stLength"><span class="hs-identifier hs-var hs-var">stLength</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-242"></span><span>                               </span><span class="hs-special">,</span><span> </span><span id="stLookup"><span class="annot"><span class="annottext">StringTable -&gt; Map ShortText StrTabOffset
</span><a href="GHC.StgToCmm.InfoTableProv.html#stLookup"><span class="hs-identifier hs-var hs-var">stLookup</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.ShortText.html#ShortText"><span class="hs-identifier hs-type">ShortText</span></a></span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#StrTabOffset"><span class="hs-identifier hs-type">StrTabOffset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>                               </span><span class="hs-special">}</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-keyword">type</span><span> </span><span id="StrTabOffset"><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#StrTabOffset"><span class="hs-identifier hs-var">StrTabOffset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#emptyStringTable"><span class="hs-identifier hs-type">emptyStringTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#StringTable"><span class="hs-identifier hs-type">StringTable</span></a></span><span>
</span><span id="line-248"></span><span id="emptyStringTable"><span class="annot"><span class="annottext">emptyStringTable :: StringTable
</span><a href="GHC.StgToCmm.InfoTableProv.html#emptyStringTable"><span class="hs-identifier hs-var hs-var">emptyStringTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#StringTable"><span class="hs-identifier hs-type">StringTable</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">stStrings :: DList ShortText
</span><a href="GHC.StgToCmm.InfoTableProv.html#stStrings"><span class="hs-identifier hs-var">stStrings</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DList ShortText
forall a. DList a
</span><a href="GHC.StgToCmm.InfoTableProv.html#emptyDList"><span class="hs-identifier hs-var">emptyDList</span></a></span><span>
</span><span id="line-250"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stLength :: Int
</span><a href="GHC.StgToCmm.InfoTableProv.html#stLength"><span class="hs-identifier hs-var">stLength</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-251"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stLookup :: Map ShortText StrTabOffset
</span><a href="GHC.StgToCmm.InfoTableProv.html#stLookup"><span class="hs-identifier hs-var">stLookup</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map ShortText StrTabOffset
forall k a. Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span>
</span><span id="line-252"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#getStringTableStrings"><span class="hs-identifier hs-type">getStringTableStrings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#StringTable"><span class="hs-identifier hs-type">StringTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-255"></span><span id="getStringTableStrings"><span class="annot"><span class="annottext">getStringTableStrings :: StringTable -&gt; ByteString
</span><a href="GHC.StgToCmm.InfoTableProv.html#getStringTableStrings"><span class="hs-identifier hs-var hs-var">getStringTableStrings</span></a></span></span><span> </span><span id="local-6989586621682886268"><span class="annot"><span class="annottext">StringTable
</span><a href="#local-6989586621682886268"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><span class="annottext">LazyByteString -&gt; ByteString
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.Internal.html#toStrict"><span class="hs-identifier hs-var">BSL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(LazyByteString -&gt; ByteString) -&gt; LazyByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; LazyByteString
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Builder.Internal.html#toLazyByteString"><span class="hs-identifier hs-var">BSB.toLazyByteString</span></a></span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><span class="annottext">(Builder -&gt; LazyByteString) -&gt; Builder -&gt; LazyByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ShortText -&gt; Builder) -&gt; [ShortText] -&gt; Builder
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">ShortText -&gt; Builder
</span><a href="#local-6989586621682886270"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">([ShortText] -&gt; Builder) -&gt; [ShortText] -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DList ShortText -&gt; [ShortText]
forall a. DList a -&gt; [a]
</span><a href="GHC.StgToCmm.InfoTableProv.html#dlistToList"><span class="hs-identifier hs-var">dlistToList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StringTable -&gt; DList ShortText
</span><a href="GHC.StgToCmm.InfoTableProv.html#stStrings"><span class="hs-identifier hs-var">stStrings</span></a></span><span> </span><span class="annot"><span class="annottext">StringTable
</span><a href="#local-6989586621682886268"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-259"></span><span>    </span><span id="local-6989586621682886270"><span class="annot"><span class="annottext">f :: ShortText -&gt; Builder
</span><a href="#local-6989586621682886270"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682886275"><span class="annot"><span class="annottext">ShortText
</span><a href="#local-6989586621682886275"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; Builder
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Builder.Internal.html#shortByteString"><span class="hs-identifier hs-var">BSB.shortByteString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShortText -&gt; ShortByteString
</span><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.ShortText.html#contents"><span class="hs-identifier hs-var">ST.contents</span></a></span><span> </span><span class="annot"><span class="annottext">ShortText
</span><a href="#local-6989586621682886275"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Builder
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Builder.html#word8"><span class="hs-identifier hs-var">BSB.word8</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#lookupStringTable"><span class="hs-identifier hs-type">lookupStringTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.ShortText.html#ShortText"><span class="hs-identifier hs-type">ShortText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#StringTable"><span class="hs-identifier hs-type">StringTable</span></a></span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#StrTabOffset"><span class="hs-identifier hs-type">StrTabOffset</span></a></span><span>
</span><span id="line-262"></span><span id="lookupStringTable"><span class="annot"><span class="annottext">lookupStringTable :: ShortText -&gt; State StringTable StrTabOffset
</span><a href="GHC.StgToCmm.InfoTableProv.html#lookupStringTable"><span class="hs-identifier hs-var hs-var">lookupStringTable</span></a></span></span><span> </span><span id="local-6989586621682886279"><span class="annot"><span class="annottext">ShortText
</span><a href="#local-6989586621682886279"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StringTable -&gt; (StrTabOffset, StringTable))
-&gt; State StringTable StrTabOffset
forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; (a, s)) -&gt; StateT s m a
</span><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#state"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">((StringTable -&gt; (StrTabOffset, StringTable))
 -&gt; State StringTable StrTabOffset)
-&gt; (StringTable -&gt; (StrTabOffset, StringTable))
-&gt; State StringTable StrTabOffset
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682886281"><span class="annot"><span class="annottext">StringTable
</span><a href="#local-6989586621682886281"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ShortText -&gt; Map ShortText StrTabOffset -&gt; Maybe StrTabOffset
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">ShortText
</span><a href="#local-6989586621682886279"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StringTable -&gt; Map ShortText StrTabOffset
</span><a href="GHC.StgToCmm.InfoTableProv.html#stLookup"><span class="hs-identifier hs-var">stLookup</span></a></span><span> </span><span class="annot"><span class="annottext">StringTable
</span><a href="#local-6989586621682886281"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-264"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682886283"><span class="annot"><span class="annottext">StrTabOffset
</span><a href="#local-6989586621682886283"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrTabOffset
</span><a href="#local-6989586621682886283"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StringTable
</span><a href="#local-6989586621682886281"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>      </span><span class="annot"><span class="annottext">Maybe StrTabOffset
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-266"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682886284"><span class="annot"><span class="annottext">st' :: StringTable
</span><a href="#local-6989586621682886284"><span class="hs-identifier hs-var hs-var">st'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StringTable
</span><a href="#local-6989586621682886281"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#stStrings"><span class="hs-identifier hs-var">stStrings</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#stStrings"><span class="hs-identifier hs-var">stStrings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886281"><span class="hs-identifier hs-type">st</span></a></span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#snoc"><span class="hs-operator hs-type">`snoc`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886279"><span class="hs-identifier hs-type">str</span></a></span><span>
</span><span id="line-267"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#stLength"><span class="hs-identifier hs-var">stLength</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#stLength"><span class="hs-identifier hs-var">stLength</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886281"><span class="hs-identifier hs-type">st</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.ShortText.html#byteLength"><span class="hs-identifier hs-type">ST.byteLength</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886279"><span class="hs-identifier hs-type">str</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-268"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#stLookup"><span class="hs-identifier hs-var">stLookup</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Strict.Internal.html#insert"><span class="hs-identifier hs-type">M.insert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886279"><span class="hs-identifier hs-type">str</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886289"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#stLookup"><span class="hs-identifier hs-var">stLookup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886281"><span class="hs-identifier hs-type">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>                        </span><span class="hs-special">}</span><span>
</span><span id="line-270"></span><span>              </span><span id="local-6989586621682886289"><span class="annot"><span class="annottext">res :: StrTabOffset
</span><a href="#local-6989586621682886289"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; StrTabOffset
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StringTable -&gt; Int
</span><a href="GHC.StgToCmm.InfoTableProv.html#stLength"><span class="hs-identifier hs-var">stLength</span></a></span><span> </span><span class="annot"><span class="annottext">StringTable
</span><a href="#local-6989586621682886281"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrTabOffset
</span><a href="#local-6989586621682886289"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StringTable
</span><a href="#local-6989586621682886284"><span class="hs-identifier hs-var">st'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#do_compress"><span class="hs-identifier hs-type">do_compress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-274"></span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#compress"><span class="hs-identifier hs-type">compress</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span class="hs-cpp">
#if !defined(HAVE_LIBZSTD)
</span><span id="do_compress"><span class="annot"><span class="annottext">do_compress :: Int
</span><a href="GHC.StgToCmm.InfoTableProv.html#do_compress"><span class="hs-identifier hs-var hs-var">do_compress</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-277"></span><span id="compress"><span class="annot"><span class="annottext">compress :: Int -&gt; ByteString -&gt; ByteString
</span><a href="GHC.StgToCmm.InfoTableProv.html#compress"><span class="hs-identifier hs-var hs-var">compress</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682886290"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682886290"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682886290"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">do_compress</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-identifier">compress</span><span> </span><span class="hs-identifier">clvl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">BSI.PS</span><span> </span><span class="hs-identifier">srcForeignPtr</span><span> </span><span class="hs-identifier">off</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unsafePerformIO</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-identifier">withForeignPtr</span><span> </span><span class="hs-identifier">srcForeignPtr</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">srcPtr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-283"></span><span>      </span><span class="hs-identifier">maxCompressedSize</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">zstd_compress_bound</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">len</span><span>
</span><span id="line-284"></span><span>      </span><span class="hs-identifier">dstForeignPtr</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">BSI.mallocByteString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">maxCompressedSize</span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>      </span><span class="hs-identifier">withForeignPtr</span><span> </span><span class="hs-identifier">dstForeignPtr</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">dstPtr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-286"></span><span>        </span><span class="hs-identifier">compressedSize</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span>
</span><span id="line-287"></span><span>          </span><span class="hs-identifier">zstd_compress</span><span>
</span><span id="line-288"></span><span>            </span><span class="hs-identifier">dstPtr</span><span>
</span><span id="line-289"></span><span>            </span><span class="hs-identifier">maxCompressedSize</span><span>
</span><span id="line-290"></span><span>            </span><span class="hs-special">(</span><span class="hs-identifier">srcPtr</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">plusPtr</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">off</span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>            </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>            </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">clvl</span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>        </span><span class="hs-identifier">BSI.create</span><span> </span><span class="hs-identifier">compressedSize</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">copyBytes</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">dstPtr</span><span> </span><span class="hs-identifier">compressedSize</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;ZSTD_compress&quot;</span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-identifier">zstd_compress</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-297"></span><span>         </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">dst</span><span> </span><span class="hs-comment">-- ^ Destination buffer</span><span>
</span><span id="line-298"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CSize</span><span>   </span><span class="hs-comment">-- ^ Capacity of destination buffer</span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">src</span><span> </span><span class="hs-comment">-- ^ Source buffer</span><span>
</span><span id="line-300"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CSize</span><span>   </span><span class="hs-comment">-- ^ Size of source buffer</span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CInt</span><span>    </span><span class="hs-comment">-- ^ Compression level</span><span>
</span><span id="line-302"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">CSize</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- | Compute the maximum compressed size for a given source buffer size</span><span>
</span><span id="line-305"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;ZSTD_compressBound&quot;</span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-identifier">zstd_compress_bound</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-307"></span><span>         </span><span class="hs-identifier">CSize</span><span> </span><span class="hs-comment">-- ^ Size of source buffer</span><span>
</span><span id="line-308"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">CSize</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-311"></span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#defaultCompressionLevel"><span class="hs-identifier hs-type">defaultCompressionLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-312"></span><span id="defaultCompressionLevel"><span class="annot"><span class="annottext">defaultCompressionLevel :: Int
</span><a href="GHC.StgToCmm.InfoTableProv.html#defaultCompressionLevel"><span class="hs-identifier hs-var hs-var">defaultCompressionLevel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="hs-keyword">newtype</span><span> </span><span id="DList"><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#DList"><span class="hs-identifier hs-var">DList</span></a></span></span><span> </span><span id="local-6989586621682886077"><span class="annot"><a href="#local-6989586621682886077"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DList"><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#DList"><span class="hs-identifier hs-var">DList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682886077"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682886077"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span id="local-6989586621682886060"><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#emptyDList"><span class="hs-identifier hs-type">emptyDList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#DList"><span class="hs-identifier hs-type">DList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886060"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-317"></span><span id="emptyDList"><span class="annot"><span class="annottext">emptyDList :: forall a. DList a
</span><a href="GHC.StgToCmm.InfoTableProv.html#emptyDList"><span class="hs-identifier hs-var hs-var">emptyDList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; DList a
forall a. ([a] -&gt; [a]) -&gt; DList a
</span><a href="GHC.StgToCmm.InfoTableProv.html#DList"><span class="hs-identifier hs-var">DList</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span id="local-6989586621682886073"><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#snoc"><span class="hs-identifier hs-type">snoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#DList"><span class="hs-identifier hs-type">DList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886073"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682886073"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#DList"><span class="hs-identifier hs-type">DList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886073"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-320"></span><span id="snoc"><span class="annot"><span class="annottext">snoc :: forall a. DList a -&gt; a -&gt; DList a
</span><a href="GHC.StgToCmm.InfoTableProv.html#snoc"><span class="hs-identifier hs-var hs-var">snoc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#DList"><span class="hs-identifier hs-type">DList</span></a></span><span> </span><span id="local-6989586621682886293"><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621682886293"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682886294"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682886294"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; DList a
forall a. ([a] -&gt; [a]) -&gt; DList a
</span><a href="GHC.StgToCmm.InfoTableProv.html#DList"><span class="hs-identifier hs-var">DList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621682886293"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682886294"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span id="local-6989586621682886065"><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#dlistToList"><span class="hs-identifier hs-type">dlistToList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#DList"><span class="hs-identifier hs-type">DList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682886065"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682886065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-323"></span><span id="dlistToList"><span class="annot"><span class="annottext">dlistToList :: forall a. DList a -&gt; [a]
</span><a href="GHC.StgToCmm.InfoTableProv.html#dlistToList"><span class="hs-identifier hs-var hs-var">dlistToList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.StgToCmm.InfoTableProv.html#DList"><span class="hs-identifier hs-type">DList</span></a></span><span> </span><span id="local-6989586621682886295"><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621682886295"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621682886295"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-324"></span></pre></body></html>