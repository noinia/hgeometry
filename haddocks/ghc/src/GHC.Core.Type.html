<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- (c) The University of Glasgow 2006</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- (c) The GRASP/AQUA Project, Glasgow University, 1998</span><span>
</span><span id="line-3"></span><span class="hs-comment">--</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Type - public interface</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts, PatternSynonyms, ViewPatterns, MultiWayIf, RankNTypes #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="annot"><span class="hs-comment">-- | Main functions for manipulating types and type-related things</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-11"></span><span>        </span><span class="hs-comment">-- Note some of this is just re-exports from TyCon..</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Main data types representing Types</span></span><span>
</span><span id="line-14"></span><span>        </span><span class="annot"><span class="hs-comment">-- $type_classification</span></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span>        </span><span class="annot"><span class="hs-comment">-- $representation_types</span></span><span>
</span><span id="line-17"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Specificity.html#ForAllTyFlag"><span class="hs-identifier">ForAllTyFlag</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#FunTyFlag"><span class="hs-identifier">FunTyFlag</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>        </span><span class="annot"><a href="Language.Haskell.Syntax.Specificity.html#Specificity"><span class="hs-identifier">Specificity</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindOrType"><span class="hs-identifier">KindOrType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier">PredType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ThetaType"><span class="hs-identifier">ThetaType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FRRType"><span class="hs-identifier">FRRType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>        </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier">TyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier">isTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier">TyCoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#PiTyBinder"><span class="hs-identifier">PiTyBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#ForAllTyBinder"><span class="hs-identifier">ForAllTyBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVarBinder"><span class="hs-identifier">TyVarBinder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier">Mult</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier">Scaled</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KnotTied"><span class="hs-identifier">KnotTied</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#RuntimeRepType"><span class="hs-identifier">RuntimeRepType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Constructing and deconstructing types</span></span><span>
</span><span id="line-25"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier">mkTyVarTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkTyVarTys"><span class="hs-identifier">mkTyVarTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#getTyVar"><span class="hs-identifier">getTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#getTyVar_maybe"><span class="hs-identifier">getTyVar_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#repGetTyVar_maybe"><span class="hs-identifier">repGetTyVar_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#getCastedTyVar_maybe"><span class="hs-identifier">getCastedTyVar_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier">tyVarKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#varType"><span class="hs-identifier">varType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier">mkAppTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier">mkAppTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitAppTy"><span class="hs-identifier">splitAppTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitAppTys"><span class="hs-identifier">splitAppTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitAppTysNoView"><span class="hs-identifier">splitAppTysNoView</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitAppTy_maybe"><span class="hs-identifier">splitAppTy_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitAppTyNoView_maybe"><span class="hs-identifier">splitAppTyNoView_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tcSplitAppTyNoView_maybe"><span class="hs-identifier">tcSplitAppTyNoView_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkFunTy"><span class="hs-identifier">mkFunTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkVisFunTy"><span class="hs-identifier">mkVisFunTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkVisFunTyMany"><span class="hs-identifier">mkVisFunTyMany</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkVisFunTysMany"><span class="hs-identifier">mkVisFunTysMany</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkScaledFunTys"><span class="hs-identifier">mkScaledFunTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkInvisFunTy"><span class="hs-identifier">mkInvisFunTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkInvisFunTys"><span class="hs-identifier">mkInvisFunTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#tcMkVisFunTy"><span class="hs-identifier">tcMkVisFunTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#tcMkScaledFunTys"><span class="hs-identifier">tcMkScaledFunTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#tcMkInvisFunTy"><span class="hs-identifier">tcMkInvisFunTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitFunTy"><span class="hs-identifier">splitFunTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitFunTy_maybe"><span class="hs-identifier">splitFunTy_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitFunTys"><span class="hs-identifier">splitFunTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#funResultTy"><span class="hs-identifier">funResultTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#funArgTy"><span class="hs-identifier">funArgTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#funTyConAppTy_maybe"><span class="hs-identifier">funTyConAppTy_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.Prim.html#funTyFlagTyCon"><span class="hs-identifier">funTyFlagTyCon</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppFunTy_maybe"><span class="hs-identifier">tyConAppFunTy_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppFunCo_maybe"><span class="hs-identifier">tyConAppFunCo_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkFunctionType"><span class="hs-identifier">mkFunctionType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkScaledFunctionTys"><span class="hs-identifier">mkScaledFunctionTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#chooseFunTyFlag"><span class="hs-identifier">chooseFunTyFlag</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier">mkTyConApp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#mkTyConTy"><span class="hs-identifier">mkTyConTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier">tyConAppTyCon_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyConPicky_maybe"><span class="hs-identifier">tyConAppTyConPicky_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppArgs_maybe"><span class="hs-identifier">tyConAppArgs_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyCon"><span class="hs-identifier">tyConAppTyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppArgs"><span class="hs-identifier">tyConAppArgs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier">splitTyConApp_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitTyConAppNoView_maybe"><span class="hs-identifier">splitTyConAppNoView_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitTyConApp"><span class="hs-identifier">splitTyConApp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tcSplitTyConApp"><span class="hs-identifier">tcSplitTyConApp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier">tcSplitTyConApp_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkForAllTy"><span class="hs-identifier">mkForAllTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkForAllTys"><span class="hs-identifier">mkForAllTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkInvisForAllTys"><span class="hs-identifier">mkInvisForAllTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkTyCoInvForAllTys"><span class="hs-identifier">mkTyCoInvForAllTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkSpecForAllTy"><span class="hs-identifier">mkSpecForAllTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier">mkSpecForAllTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkVisForAllTys"><span class="hs-identifier">mkVisForAllTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkTyCoForAllTy"><span class="hs-identifier">mkTyCoForAllTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkTyCoForAllTys"><span class="hs-identifier">mkTyCoForAllTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkTyCoInvForAllTy"><span class="hs-identifier">mkTyCoInvForAllTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkInfForAllTy"><span class="hs-identifier">mkInfForAllTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkInfForAllTys"><span class="hs-identifier">mkInfForAllTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTyCoVars"><span class="hs-identifier">splitForAllTyCoVars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTyVars"><span class="hs-identifier">splitForAllTyVars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllReqTyBinders"><span class="hs-identifier">splitForAllReqTyBinders</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllInvisTyBinders"><span class="hs-identifier">splitForAllInvisTyBinders</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllForAllTyBinders"><span class="hs-identifier">splitForAllForAllTyBinders</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllForAllTyBinder_maybe"><span class="hs-identifier">splitForAllForAllTyBinder_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTyCoVar_maybe"><span class="hs-identifier">splitForAllTyCoVar_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTyCoVar"><span class="hs-identifier">splitForAllTyCoVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTyVar_maybe"><span class="hs-identifier">splitForAllTyVar_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllCoVar_maybe"><span class="hs-identifier">splitForAllCoVar_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitPiTy_maybe"><span class="hs-identifier">splitPiTy_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitPiTy"><span class="hs-identifier">splitPiTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitPiTys"><span class="hs-identifier">splitPiTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#getRuntimeArgTys"><span class="hs-identifier">getRuntimeArgTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkTyConBindersPreferAnon"><span class="hs-identifier">mkTyConBindersPreferAnon</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkPiTy"><span class="hs-identifier">mkPiTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkPiTys"><span class="hs-identifier">mkPiTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#piResultTy"><span class="hs-identifier">piResultTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier">piResultTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#applyTysX"><span class="hs-identifier">applyTysX</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#dropForAlls"><span class="hs-identifier">dropForAlls</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkFamilyTyConApp"><span class="hs-identifier">mkFamilyTyConApp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#buildSynTyCon"><span class="hs-identifier">buildSynTyCon</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkNumLitTy"><span class="hs-identifier">mkNumLitTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isNumLitTy"><span class="hs-identifier">isNumLitTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkStrLitTy"><span class="hs-identifier">mkStrLitTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isStrLitTy"><span class="hs-identifier">isStrLitTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkCharLitTy"><span class="hs-identifier">mkCharLitTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isCharLitTy"><span class="hs-identifier">isCharLitTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isLitTy"><span class="hs-identifier">isLitTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isPredTy"><span class="hs-identifier">isPredTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier">getRuntimeRep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitRuntimeRep_maybe"><span class="hs-identifier">splitRuntimeRep_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#kindRep_maybe"><span class="hs-identifier">kindRep_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#kindRep"><span class="hs-identifier">kindRep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#getLevity"><span class="hs-identifier">getLevity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#levityType_maybe"><span class="hs-identifier">levityType_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier">mkCastTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkCoercionTy"><span class="hs-identifier">mkCoercionTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitCastTy_maybe"><span class="hs-identifier">splitCastTy_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#ErrorMsgType"><span class="hs-identifier">ErrorMsgType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#userTypeError_maybe"><span class="hs-identifier">userTypeError_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#deepUserTypeError_maybe"><span class="hs-identifier">deepUserTypeError_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#pprUserTypeErrorTy"><span class="hs-identifier">pprUserTypeErrorTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#coAxNthLHS"><span class="hs-identifier">coAxNthLHS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#stripCoercionTy"><span class="hs-identifier">stripCoercionTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#splitInvisPiTys"><span class="hs-identifier">splitInvisPiTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitInvisPiTysN"><span class="hs-identifier">splitInvisPiTysN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#invisibleTyBndrCount"><span class="hs-identifier">invisibleTyBndrCount</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#filterOutInvisibleTypes"><span class="hs-identifier">filterOutInvisibleTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#filterOutInferredTypes"><span class="hs-identifier">filterOutInferredTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#partitionInvisibleTypes"><span class="hs-identifier">partitionInvisibleTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#partitionInvisibles"><span class="hs-identifier">partitionInvisibles</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-89"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tyConForAllTyFlags"><span class="hs-identifier">tyConForAllTyFlags</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#appTyForAllTyFlags"><span class="hs-identifier">appTyForAllTyFlags</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Analyzing types</span></span><span>
</span><span id="line-92"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#TyCoMapper"><span class="hs-identifier">TyCoMapper</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mapTyCo"><span class="hs-identifier">mapTyCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mapTyCoX"><span class="hs-identifier">mapTyCoX</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoFolder"><span class="hs-identifier">TyCoFolder</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#foldTyCo"><span class="hs-identifier">foldTyCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#noView"><span class="hs-identifier">noView</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>        </span><span class="hs-comment">-- (Newtypes)</span><span>
</span><span id="line-96"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#newTyConInstRhs"><span class="hs-identifier">newTyConInstRhs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Binders</span></span><span>
</span><span id="line-99"></span><span>        </span><span class="annot"><a href="GHC.Types.Var.html#mkForAllTyBinder"><span class="hs-identifier">mkForAllTyBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#mkForAllTyBinders"><span class="hs-identifier">mkForAllTyBinders</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>        </span><span class="annot"><a href="GHC.Types.Var.html#mkTyVarBinder"><span class="hs-identifier">mkTyVarBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#mkTyVarBinders"><span class="hs-identifier">mkTyVarBinders</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>        </span><span class="annot"><a href="GHC.Types.Var.html#tyVarSpecToBinders"><span class="hs-identifier">tyVarSpecToBinders</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>        </span><span class="annot"><a href="GHC.Types.Var.html#isAnonPiTyBinder"><span class="hs-identifier">isAnonPiTyBinder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><a href="GHC.Types.Var.html#binderVar"><span class="hs-identifier">binderVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#binderVars"><span class="hs-identifier">binderVars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#binderType"><span class="hs-identifier">binderType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#binderFlag"><span class="hs-identifier">binderFlag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#binderFlags"><span class="hs-identifier">binderFlags</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>        </span><span class="annot"><a href="GHC.Types.Var.html#piTyBinderType"><span class="hs-identifier">piTyBinderType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#namedPiTyBinder_maybe"><span class="hs-identifier">namedPiTyBinder_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>        </span><span class="annot"><a href="GHC.Types.Var.html#anonPiTyBinderType_maybe"><span class="hs-identifier">anonPiTyBinderType_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>        </span><span class="annot"><a href="Language.Haskell.Syntax.Specificity.html#isVisibleForAllTyFlag"><span class="hs-identifier">isVisibleForAllTyFlag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Specificity.html#isInvisibleForAllTyFlag"><span class="hs-identifier">isInvisibleForAllTyFlag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#isVisiblePiTyBinder"><span class="hs-identifier">isVisiblePiTyBinder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>        </span><span class="annot"><a href="GHC.Types.Var.html#isInvisiblePiTyBinder"><span class="hs-identifier">isInvisiblePiTyBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#isNamedPiTyBinder"><span class="hs-identifier">isNamedPiTyBinder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tyConBindersPiTyBinders"><span class="hs-identifier">tyConBindersPiTyBinders</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Predicates on types</span></span><span>
</span><span id="line-111"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isTyVarTy"><span class="hs-identifier">isTyVarTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isFunTy"><span class="hs-identifier">isFunTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isCoercionTy"><span class="hs-identifier">isCoercionTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isCoercionTy_maybe"><span class="hs-identifier">isCoercionTy_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy"><span class="hs-identifier">isForAllTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy_ty"><span class="hs-identifier">isForAllTy_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy_co"><span class="hs-identifier">isForAllTy_co</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy_invis_ty"><span class="hs-identifier">isForAllTy_invis_ty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isPiTy"><span class="hs-identifier">isPiTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier">isTauTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier">isFamFreeTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-116"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isAtomicTy"><span class="hs-identifier">isAtomicTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isValidJoinPointType"><span class="hs-identifier">isValidJoinPointType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-119"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppNeedsKindSig"><span class="hs-identifier">tyConAppNeedsKindSig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Space-saving construction</span></span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkTYPEapp"><span class="hs-identifier">mkTYPEapp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkTYPEapp_maybe"><span class="hs-identifier">mkTYPEapp_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkCONSTRAINTapp"><span class="hs-identifier">mkCONSTRAINTapp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkCONSTRAINTapp_maybe"><span class="hs-identifier">mkCONSTRAINTapp_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkBoxedRepApp_maybe"><span class="hs-identifier">mkBoxedRepApp_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkTupleRepApp_maybe"><span class="hs-identifier">mkTupleRepApp_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#typeOrConstraintKind"><span class="hs-identifier">typeOrConstraintKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><span class="hs-comment">-- *** Levity and boxity</span></span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#sORTKind_maybe"><span class="hs-identifier">sORTKind_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#typeTypeOrConstraint"><span class="hs-identifier">typeTypeOrConstraint</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-129"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#typeLevity"><span class="hs-identifier">typeLevity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#typeLevity_maybe"><span class="hs-identifier">typeLevity_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tyConIsTYPEorCONSTRAINT"><span class="hs-identifier">tyConIsTYPEorCONSTRAINT</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-130"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isLiftedTypeKind"><span class="hs-identifier">isLiftedTypeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isUnliftedTypeKind"><span class="hs-identifier">isUnliftedTypeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#pickyIsLiftedTypeKind"><span class="hs-identifier">pickyIsLiftedTypeKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-131"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isLiftedRuntimeRep"><span class="hs-identifier">isLiftedRuntimeRep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isUnliftedRuntimeRep"><span class="hs-identifier">isUnliftedRuntimeRep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#runtimeRepLevity_maybe"><span class="hs-identifier">runtimeRepLevity_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isBoxedRuntimeRep"><span class="hs-identifier">isBoxedRuntimeRep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isLiftedLevity"><span class="hs-identifier">isLiftedLevity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isUnliftedLevity"><span class="hs-identifier">isUnliftedLevity</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isUnliftedType"><span class="hs-identifier">isUnliftedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isBoxedType"><span class="hs-identifier">isBoxedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isUnboxedTupleType"><span class="hs-identifier">isUnboxedTupleType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isUnboxedSumType"><span class="hs-identifier">isUnboxedSumType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-135"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#kindBoxedRepLevity_maybe"><span class="hs-identifier">kindBoxedRepLevity_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mightBeLiftedType"><span class="hs-identifier">mightBeLiftedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mightBeUnliftedType"><span class="hs-identifier">mightBeUnliftedType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-137"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#definitelyLiftedType"><span class="hs-identifier">definitelyLiftedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#definitelyUnliftedType"><span class="hs-identifier">definitelyUnliftedType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isAlgType"><span class="hs-identifier">isAlgType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isDataFamilyAppType"><span class="hs-identifier">isDataFamilyAppType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isPrimitiveType"><span class="hs-identifier">isPrimitiveType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isStrictType"><span class="hs-identifier">isStrictType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isTerminatingType"><span class="hs-identifier">isTerminatingType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isLevityTy"><span class="hs-identifier">isLevityTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isLevityVar"><span class="hs-identifier">isLevityVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isRuntimeRepTy"><span class="hs-identifier">isRuntimeRepTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isRuntimeRepVar"><span class="hs-identifier">isRuntimeRepVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isRuntimeRepKindedTy"><span class="hs-identifier">isRuntimeRepKindedTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#dropRuntimeRepArgs"><span class="hs-identifier">dropRuntimeRepArgs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Multiplicity</span></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isMultiplicityTy"><span class="hs-identifier">isMultiplicityTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isMultiplicityVar"><span class="hs-identifier">isMultiplicityVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#unrestricted"><span class="hs-identifier">unrestricted</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#linear"><span class="hs-identifier">linear</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tymult"><span class="hs-identifier">tymult</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-148"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#mkScaled"><span class="hs-identifier">mkScaled</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#irrelevantMult"><span class="hs-identifier">irrelevantMult</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#scaledSet"><span class="hs-identifier">scaledSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#OneTy"><span class="hs-identifier">OneTy</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier">ManyTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isOneTy"><span class="hs-identifier">isOneTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isManyTy"><span class="hs-identifier">isManyTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-151"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isLinearType"><span class="hs-identifier">isLinearType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Main data types representing Kinds</span></span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier">Kind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Finding the kind of a type</span></span><span>
</span><span id="line-157"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier">typeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#typeHasFixedRuntimeRep"><span class="hs-identifier">typeHasFixedRuntimeRep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tcIsLiftedTypeKind"><span class="hs-identifier">tcIsLiftedTypeKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isConstraintKind"><span class="hs-identifier">isConstraintKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isConstraintLikeKind"><span class="hs-identifier">isConstraintLikeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#returnsConstraintKind"><span class="hs-identifier">returnsConstraintKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-160"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#tcIsBoxedTypeKind"><span class="hs-identifier">tcIsBoxedTypeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isTypeLikeKind"><span class="hs-identifier">isTypeLikeKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Common Kind</span></span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier">liftedTypeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#unliftedTypeKind"><span class="hs-identifier">unliftedTypeKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Type free variables</span></span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier">tyCoFVsOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsBndr"><span class="hs-identifier">tyCoFVsBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsVarBndr"><span class="hs-identifier">tyCoFVsVarBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsVarBndrs"><span class="hs-identifier">tyCoFVsVarBndrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-167"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier">tyCoVarsOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier">tyCoVarsOfTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-168"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeDSet"><span class="hs-identifier">tyCoVarsOfTypeDSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-169"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#coVarsOfType"><span class="hs-identifier">coVarsOfType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#coVarsOfTypes"><span class="hs-identifier">coVarsOfTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#anyFreeVarsOfType"><span class="hs-identifier">anyFreeVarsOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#anyFreeVarsOfTypes"><span class="hs-identifier">anyFreeVarsOfTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfType"><span class="hs-identifier">noFreeVarsOfType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-174"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#expandTypeSynonyms"><span class="hs-identifier">expandTypeSynonyms</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#expandSynTyConApp_maybe"><span class="hs-identifier">expandSynTyConApp_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#typeSize"><span class="hs-identifier">typeSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#occCheckExpand"><span class="hs-identifier">occCheckExpand</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Closing over kinds</span></span><span>
</span><span id="line-178"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#closeOverKindsDSet"><span class="hs-identifier">closeOverKindsDSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#closeOverKindsList"><span class="hs-identifier">closeOverKindsList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-179"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#closeOverKinds"><span class="hs-identifier">closeOverKinds</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Well-scoped lists of variables</span></span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#scopedSort"><span class="hs-identifier">scopedSort</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeWellScoped"><span class="hs-identifier">tyCoVarsOfTypeWellScoped</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypesWellScoped"><span class="hs-identifier">tyCoVarsOfTypesWellScoped</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Forcing evaluation of types</span></span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier">seqType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#seqTypes"><span class="hs-identifier">seqTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Other views onto Types</span></span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier">coreView</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier">coreFullView</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#rewriterView"><span class="hs-identifier">rewriterView</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyConsOfType"><span class="hs-identifier">tyConsOfType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Main type substitution data types</span></span><span>
</span><span id="line-194"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TvSubstEnv"><span class="hs-identifier">TvSubstEnv</span></a></span><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- Representation widely visible</span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#IdSubstEnv"><span class="hs-identifier">IdSubstEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#Subst"><span class="hs-identifier">Subst</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- Representation visible to a few friends</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Manipulating type substitutions</span></span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#emptyTvSubstEnv"><span class="hs-identifier">emptyTvSubstEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#emptySubst"><span class="hs-identifier">emptySubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkEmptySubst"><span class="hs-identifier">mkEmptySubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkTCvSubst"><span class="hs-identifier">mkTCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipTvSubst"><span class="hs-identifier">zipTvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkTvSubstPrs"><span class="hs-identifier">mkTvSubstPrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-202"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipTCvSubst"><span class="hs-identifier">zipTCvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#notElemSubst"><span class="hs-identifier">notElemSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#getTvSubstEnv"><span class="hs-identifier">getTvSubstEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-205"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zapSubst"><span class="hs-identifier">zapSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#getSubstInScope"><span class="hs-identifier">getSubstInScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#setInScope"><span class="hs-identifier">setInScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#getSubstRangeTyCoFVs"><span class="hs-identifier">getSubstRangeTyCoFVs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendSubstInScope"><span class="hs-identifier">extendSubstInScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendSubstInScopeList"><span class="hs-identifier">extendSubstInScopeList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendSubstInScopeSet"><span class="hs-identifier">extendSubstInScopeSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvSubst"><span class="hs-identifier">extendTCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendCvSubst"><span class="hs-identifier">extendCvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubst"><span class="hs-identifier">extendTvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubstList"><span class="hs-identifier">extendTvSubstList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubstAndInScope"><span class="hs-identifier">extendTvSubstAndInScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-209"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvSubstList"><span class="hs-identifier">extendTCvSubstList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-210"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubstWithClone"><span class="hs-identifier">extendTvSubstWithClone</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-211"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvSubstWithClone"><span class="hs-identifier">extendTCvSubstWithClone</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-212"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#isInScope"><span class="hs-identifier">isInScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#composeTCvSubst"><span class="hs-identifier">composeTCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipTyEnv"><span class="hs-identifier">zipTyEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipCoEnv"><span class="hs-identifier">zipCoEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-213"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#isEmptySubst"><span class="hs-identifier">isEmptySubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#unionSubst"><span class="hs-identifier">unionSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#isEmptyTCvSubst"><span class="hs-identifier">isEmptyTCvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Performing substitution on types and kinds</span></span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier">substTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTys"><span class="hs-identifier">substTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTy"><span class="hs-identifier">substScaledTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTys"><span class="hs-identifier">substScaledTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyWith"><span class="hs-identifier">substTyWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTysWith"><span class="hs-identifier">substTysWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTheta"><span class="hs-identifier">substTheta</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyAddInScope"><span class="hs-identifier">substTyAddInScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-218"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyUnchecked"><span class="hs-identifier">substTyUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTysUnchecked"><span class="hs-identifier">substTysUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTyUnchecked"><span class="hs-identifier">substScaledTyUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTysUnchecked"><span class="hs-identifier">substScaledTysUnchecked</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substThetaUnchecked"><span class="hs-identifier">substThetaUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyWithUnchecked"><span class="hs-identifier">substTyWithUnchecked</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCo"><span class="hs-identifier">substCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoUnchecked"><span class="hs-identifier">substCoUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoWithUnchecked"><span class="hs-identifier">substCoWithUnchecked</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVarBndr"><span class="hs-identifier">substTyVarBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVarBndrs"><span class="hs-identifier">substTyVarBndrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVar"><span class="hs-identifier">substTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVars"><span class="hs-identifier">substTyVars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substVarBndr"><span class="hs-identifier">substVarBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substVarBndrs"><span class="hs-identifier">substVarBndrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyCoBndr"><span class="hs-identifier">substTyCoBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVarToTyVar"><span class="hs-identifier">substTyVarToTyVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-224"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#cloneTyVarBndr"><span class="hs-identifier">cloneTyVarBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#cloneTyVarBndrs"><span class="hs-identifier">cloneTyVarBndrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#lookupTyVar"><span class="hs-identifier">lookupTyVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Tidying type related things up for printing</span></span><span>
</span><span id="line-227"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier">tidyType</span></a></span><span class="hs-special">,</span><span>      </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyTypes"><span class="hs-identifier">tidyTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-228"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyOpenType"><span class="hs-identifier">tidyOpenType</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTypes"><span class="hs-identifier">tidyOpenTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-229"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTypeX"><span class="hs-identifier">tidyOpenTypeX</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTypesX"><span class="hs-identifier">tidyOpenTypesX</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-230"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyVarBndr"><span class="hs-identifier">tidyVarBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyVarBndrs"><span class="hs-identifier">tidyVarBndrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-231"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyFreeTyCoVars"><span class="hs-identifier">tidyFreeTyCoVars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-232"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyFreeTyCoVarX"><span class="hs-identifier">tidyFreeTyCoVarX</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyFreeTyCoVarsX"><span class="hs-identifier">tidyFreeTyCoVarsX</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-233"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyTyCoVarOcc"><span class="hs-identifier">tidyTyCoVarOcc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-234"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyTopType"><span class="hs-identifier">tidyTopType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-235"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyForAllTyBinder"><span class="hs-identifier">tidyForAllTyBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyForAllTyBinders"><span class="hs-identifier">tidyForAllTyBinders</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Kinds</span></span><span>
</span><span id="line-238"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isTYPEorCONSTRAINT"><span class="hs-identifier">isTYPEorCONSTRAINT</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-239"></span><span>        </span><span class="annot"><a href="GHC.Core.Type.html#isConcreteType"><span class="hs-identifier">isConcreteType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isFixedRuntimeRepKind"><span class="hs-identifier">isFixedRuntimeRepKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">-- We import the representation and primitive functions from GHC.Core.TyCo.Rep.</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- Many things are reexported, but not the representation!</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html"><span class="hs-identifier">GHC.Core.TyCo.Rep</span></a></span><span>
</span><span id="line-250"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html"><span class="hs-identifier">GHC.Core.TyCo.Subst</span></a></span><span>
</span><span id="line-251"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html"><span class="hs-identifier">GHC.Core.TyCo.Tidy</span></a></span><span>
</span><span id="line-252"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html"><span class="hs-identifier">GHC.Core.TyCo.FVs</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- friends:</span><span>
</span><span id="line-255"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.html"><span class="hs-identifier">GHC.Types.Var</span></a></span><span>
</span><span id="line-256"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html"><span class="hs-identifier">GHC.Types.Var.Env</span></a></span><span>
</span><span id="line-257"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html"><span class="hs-identifier">GHC.Types.Var.Set</span></a></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span>
</span><span id="line-260"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.Prim.html"><span class="hs-identifier">GHC.Builtin.Types.Prim</span></a></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html"><span class="hs-identifier">GHC.Builtin.Types</span></a></span><span>
</span><span id="line-263"></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#charTy"><span class="hs-identifier">charTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#naturalTy"><span class="hs-identifier">naturalTy</span></a></span><span>
</span><span id="line-264"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#typeSymbolKind"><span class="hs-identifier">typeSymbolKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier">liftedTypeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#unliftedTypeKind"><span class="hs-identifier">unliftedTypeKind</span></a></span><span>
</span><span id="line-265"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#constraintKind"><span class="hs-identifier">constraintKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#zeroBitTypeKind"><span class="hs-identifier">zeroBitTypeKind</span></a></span><span>
</span><span id="line-266"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#manyDataConTy"><span class="hs-identifier">manyDataConTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#oneDataConTy"><span class="hs-identifier">oneDataConTy</span></a></span><span>
</span><span id="line-267"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#liftedRepTy"><span class="hs-identifier">liftedRepTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#unliftedRepTy"><span class="hs-identifier">unliftedRepTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#zeroBitRepTy"><span class="hs-identifier">zeroBitRepTy</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span>
</span><span id="line-271"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html"><span class="hs-identifier">GHC.Core.Coercion.Axiom</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html"><span class="hs-identifier">GHC.Core.Coercion</span></a></span><span>
</span><span id="line-274"></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkNomReflCo"><span class="hs-identifier">mkNomReflCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkGReflCo"><span class="hs-identifier">mkGReflCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkReflCo"><span class="hs-identifier">mkReflCo</span></a></span><span>
</span><span id="line-275"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkTyConAppCo"><span class="hs-identifier">mkTyConAppCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkAppCo"><span class="hs-identifier">mkAppCo</span></a></span><span>
</span><span id="line-276"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkForAllCo"><span class="hs-identifier">mkForAllCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkFunCo2"><span class="hs-identifier">mkFunCo2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkAxiomCo"><span class="hs-identifier">mkAxiomCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkUnivCo"><span class="hs-identifier">mkUnivCo</span></a></span><span>
</span><span id="line-277"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkSymCo"><span class="hs-identifier">mkSymCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkTransCo"><span class="hs-identifier">mkTransCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkSelCo"><span class="hs-identifier">mkSelCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkLRCo"><span class="hs-identifier">mkLRCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkInstCo"><span class="hs-identifier">mkInstCo</span></a></span><span>
</span><span id="line-278"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkKindCo"><span class="hs-identifier">mkKindCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkSubCo"><span class="hs-identifier">mkSubCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkFunCo"><span class="hs-identifier">mkFunCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#funRole"><span class="hs-identifier">funRole</span></a></span><span>
</span><span id="line-279"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#decomposePiCos"><span class="hs-identifier">decomposePiCos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier">coercionKind</span></a></span><span>
</span><span id="line-280"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionRKind"><span class="hs-identifier">coercionRKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionType"><span class="hs-identifier">coercionType</span></a></span><span>
</span><span id="line-281"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#isReflexiveCo"><span class="hs-identifier">isReflexiveCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#seqCo"><span class="hs-identifier">seqCo</span></a></span><span>
</span><span id="line-282"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#topNormaliseNewType_maybe"><span class="hs-identifier">topNormaliseNewType_maybe</span></a></span><span>
</span><span id="line-283"></span><span>   </span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html"><span class="hs-identifier">GHC.Tc.Utils.TcType</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVar"><span class="hs-identifier">isConcreteTyVar</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">-- others</span><span>
</span><span id="line-287"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-288"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html"><span class="hs-identifier">GHC.Utils.FV</span></a></span><span>
</span><span id="line-289"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-290"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-291"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html"><span class="hs-identifier">GHC.Data.Maybe</span></a></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html#orElse"><span class="hs-identifier">orElse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html#firstJust"><span class="hs-identifier">firstJust</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">-- $type_classification</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- #type_classification#</span><span>
</span><span id="line-297"></span><span class="hs-comment">--</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- Types are any, but at least one, of:</span><span>
</span><span id="line-299"></span><span class="hs-comment">--</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- [Boxed]              Iff its representation is a pointer to an object on the</span><span>
</span><span id="line-301"></span><span class="hs-comment">--                      GC'd heap. Operationally, heap objects can be entered as</span><span>
</span><span id="line-302"></span><span class="hs-comment">--                      a means of evaluation.</span><span>
</span><span id="line-303"></span><span class="hs-comment">--</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- [Lifted]             Iff it has bottom as an element: An instance of a</span><span>
</span><span id="line-305"></span><span class="hs-comment">--                      lifted type might diverge when evaluated.</span><span>
</span><span id="line-306"></span><span class="hs-comment">--                      GHC Haskell's unboxed types are unlifted.</span><span>
</span><span id="line-307"></span><span class="hs-comment">--                      An unboxed, but lifted type is not very useful.</span><span>
</span><span id="line-308"></span><span class="hs-comment">--                      (Example: A byte-represented type, where evaluating 0xff</span><span>
</span><span id="line-309"></span><span class="hs-comment">--                      computes the 12345678th collatz number modulo 0xff.)</span><span>
</span><span id="line-310"></span><span class="hs-comment">--                      Only lifted types may be unified with a type variable.</span><span>
</span><span id="line-311"></span><span class="hs-comment">--</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- [Algebraic]          Iff it is a type with one or more constructors, whether</span><span>
</span><span id="line-313"></span><span class="hs-comment">--                      declared with @data@ or @newtype@.</span><span>
</span><span id="line-314"></span><span class="hs-comment">--                      An algebraic type is one that can be deconstructed</span><span>
</span><span id="line-315"></span><span class="hs-comment">--                      with a case expression. There are algebraic types that</span><span>
</span><span id="line-316"></span><span class="hs-comment">--                      are not lifted types, like unlifted data types or</span><span>
</span><span id="line-317"></span><span class="hs-comment">--                      unboxed tuples.</span><span>
</span><span id="line-318"></span><span class="hs-comment">--</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- [Data]               Iff it is a type declared with @data@, or a boxed tuple.</span><span>
</span><span id="line-320"></span><span class="hs-comment">--                      There are also /unlifted/ data types.</span><span>
</span><span id="line-321"></span><span class="hs-comment">--</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- [Primitive]          Iff it is a built-in type that can't be expressed in Haskell.</span><span>
</span><span id="line-323"></span><span class="hs-comment">--</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- [Unlifted]           Anything that isn't lifted is considered unlifted.</span><span>
</span><span id="line-325"></span><span class="hs-comment">--</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- Currently, all primitive types are unlifted, but that's not necessarily</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- the case: for example, @Int@ could be primitive.</span><span>
</span><span id="line-328"></span><span class="hs-comment">--</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- Some primitive types are unboxed, such as @Int#@, whereas some are boxed</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- but unlifted (such as @ByteArray#@).  The only primitive types that we</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- classify as algebraic are the unboxed tuples.</span><span>
</span><span id="line-332"></span><span class="hs-comment">--</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- Some examples of type classifications that may make this a bit clearer are:</span><span>
</span><span id="line-334"></span><span class="hs-comment">--</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- Type          primitive       boxed           lifted          algebraic</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-338"></span><span class="hs-comment">-- Int#          Yes             No              No              No</span><span>
</span><span id="line-339"></span><span class="hs-comment">-- ByteArray#    Yes             Yes             No              No</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- (\# a, b \#)  Yes             No              No              Yes</span><span>
</span><span id="line-341"></span><span class="hs-comment">-- (\# a | b \#) Yes             No              No              Yes</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- (  a, b  )    No              Yes             Yes             Yes</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- [a]           No              Yes             Yes             Yes</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-comment">-- $representation_types</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- A /source type/ is a type that is a separate type as far as the type checker is</span><span>
</span><span id="line-348"></span><span class="hs-comment">-- concerned, but which has a more low-level representation as far as Core-to-Core</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- passes and the rest of the back end is concerned.</span><span>
</span><span id="line-350"></span><span class="hs-comment">--</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- You don't normally have to worry about this, as the utility functions in</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- this module will automatically convert a source into a representation type</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- if they are spotted, to the best of its abilities. If you don't want this</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- to happen, use the equivalent functions from the &quot;TcType&quot; module.</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Type representation
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="annot"><a href="GHC.Core.Type.html#rewriterView"><span class="hs-identifier hs-type">rewriterView</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-365"></span><span class="hs-comment">-- Unwrap a type synonym only when either:</span><span>
</span><span id="line-366"></span><span class="hs-comment">--   The type synonym is forgetful, or</span><span>
</span><span id="line-367"></span><span class="hs-comment">--   the type synonym mentions a type family in its expansion</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- See Note [Rewriting synonyms]</span><span>
</span><span id="line-369"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#rewriterView"><span class="hs-pragma hs-type">rewriterView</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-370"></span><span id="rewriterView"><span class="annot"><span class="annottext">rewriterView :: Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#rewriterView"><span class="hs-identifier hs-var hs-var">rewriterView</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682563867"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682563867"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682563868"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563868"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTypeSynonymTyCon"><span class="hs-identifier hs-var">isTypeSynonymTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682563867"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isForgetfulSynTyCon"><span class="hs-identifier hs-var">isForgetfulSynTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682563867"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isFamFreeTyCon"><span class="hs-identifier hs-var">isFamFreeTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682563867"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#expandSynTyConApp_maybe"><span class="hs-identifier hs-var">expandSynTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682563867"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563868"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-374"></span><span class="annot"><a href="GHC.Core.Type.html#rewriterView"><span class="hs-identifier hs-var">rewriterView</span></a></span><span> </span><span id="local-6989586621682563874"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563874"><span class="hs-identifier hs-var">_other</span></a></span></span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="annot"><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-type">coreView</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-378"></span><span class="hs-comment">-- ^ This function strips off the /top layer only/ of a type synonym</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- application (if any) its underlying representation type.</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- Returns 'Nothing' if there is nothing to look through.</span><span>
</span><span id="line-381"></span><span class="hs-comment">--</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- This function does not look through type family applications.</span><span>
</span><span id="line-383"></span><span class="hs-comment">--</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- By being non-recursive and inlined, this case analysis gets efficiently</span><span>
</span><span id="line-385"></span><span class="hs-comment">-- joined onto the case analysis that the caller is already doing</span><span>
</span><span id="line-386"></span><span id="coreView"><span class="annot"><span class="annottext">coreView :: Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var hs-var">coreView</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682563875"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682563875"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682563876"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563876"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#expandSynTyConApp_maybe"><span class="hs-identifier hs-var">expandSynTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682563875"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563876"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-387"></span><span class="annot"><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-388"></span><span class="hs-comment">-- See Note [Inlining coreView].</span><span>
</span><span id="line-389"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#coreView"><span class="hs-pragma hs-type">coreView</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="annot"><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-type">coreFullView</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#core_full_view"><span class="hs-identifier hs-type">core_full_view</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-392"></span><span class="hs-comment">-- ^ Iterates 'coreView' until there is no more to synonym to expand.</span><span>
</span><span id="line-393"></span><span class="hs-comment">-- NB: coreFullView is non-recursive and can be inlined;</span><span>
</span><span id="line-394"></span><span class="hs-comment">--     core_full_view is the recursive one</span><span>
</span><span id="line-395"></span><span class="hs-comment">-- See Note [Inlining coreView].</span><span>
</span><span id="line-396"></span><span id="coreFullView"><span class="annot"><span class="annottext">coreFullView :: Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var hs-var">coreFullView</span></a></span></span><span> </span><span id="local-6989586621682563878"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682563878"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682563879"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682563879"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTypeSynonymTyCon"><span class="hs-identifier hs-var">isTypeSynonymTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682563879"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#core_full_view"><span class="hs-identifier hs-var">core_full_view</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563878"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-398"></span><span class="annot"><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span id="local-6989586621682563880"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563880"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563880"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-399"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#coreFullView"><span class="hs-pragma hs-type">coreFullView</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span id="core_full_view"><span class="annot"><span class="annottext">core_full_view :: Type -&gt; Type
</span><a href="GHC.Core.Type.html#core_full_view"><span class="hs-identifier hs-var hs-var">core_full_view</span></a></span></span><span> </span><span id="local-6989586621682563881"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563881"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682563882"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563882"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563881"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#core_full_view"><span class="hs-identifier hs-var">core_full_view</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563882"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563881"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="hs-comment">-----------------------------------------------</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- | @expandSynTyConApp_maybe tc tys@ expands the RHS of type synonym @tc@</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- instantiated at arguments @tys@, or returns 'Nothing' if @tc@ is not a</span><span>
</span><span id="line-408"></span><span class="hs-comment">-- synonym.</span><span>
</span><span id="line-409"></span><span class="annot"><a href="GHC.Core.Type.html#expandSynTyConApp_maybe"><span class="hs-identifier hs-type">expandSynTyConApp_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-410"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#expandSynTyConApp_maybe"><span class="hs-pragma hs-type">expandSynTyConApp_maybe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- This INLINE will inline the call to expandSynTyConApp_maybe in coreView,</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- which will eliminate the allocation Just/Nothing in the result</span><span>
</span><span id="line-413"></span><span class="hs-comment">-- Don't be tempted to make `expand_syn` (which is NOINLINE) return the</span><span>
</span><span id="line-414"></span><span class="hs-comment">-- Just/Nothing, else you'll increase allocation</span><span>
</span><span id="line-415"></span><span id="expandSynTyConApp_maybe"><span class="annot"><span class="annottext">expandSynTyConApp_maybe :: TyCon -&gt; [Type] -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#expandSynTyConApp_maybe"><span class="hs-identifier hs-var hs-var">expandSynTyConApp_maybe</span></a></span></span><span> </span><span id="local-6989586621682563883"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682563883"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682563884"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563884"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span>
</span><span id="line-416"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682563885"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682563885"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682563886"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563886"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe ([TyVar], Type)
</span><a href="GHC.Core.TyCon.html#synTyConDefn_maybe"><span class="hs-identifier hs-var">synTyConDefn_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682563883"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-417"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563884"><span class="hs-identifier hs-var">arg_tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Arity -&gt; Bool
</span><a href="GHC.Core.Type.html#saturates"><span class="hs-operator hs-var">`saturates`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Arity
</span><a href="GHC.Core.TyCon.html#tyConArity"><span class="hs-identifier hs-var">tyConArity</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682563883"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-418"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe Type) -&gt; Type -&gt; Maybe Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#expand_syn"><span class="hs-identifier hs-var">expand_syn</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682563885"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563886"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563884"><span class="hs-identifier hs-var">arg_tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>    </span><span class="hs-comment">-- Why strict application? Because every client of this function will evaluat</span><span>
</span><span id="line-420"></span><span>    </span><span class="hs-comment">-- that (expand_syn ...) thunk, so it's more efficient not to build a thunk.</span><span>
</span><span id="line-421"></span><span>    </span><span class="hs-comment">-- Mind you, this function is always INLINEd, so the client context is probably</span><span>
</span><span id="line-422"></span><span>    </span><span class="hs-comment">-- enough to avoid thunk construction and so the $! is just belt-and-braces.</span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span class="annot"><a href="GHC.Core.Type.html#saturates"><span class="hs-identifier hs-type">saturates</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-427"></span><span id="saturates"><span class="annot"><span class="annottext">saturates :: [Type] -&gt; Arity -&gt; Bool
</span><a href="GHC.Core.Type.html#saturates"><span class="hs-identifier hs-var hs-var">saturates</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span>       </span><span class="annot"><span class="annottext">Arity
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-428"></span><span class="annot"><a href="GHC.Core.Type.html#saturates"><span class="hs-identifier hs-var">saturates</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="annot"><span class="annottext">Arity
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-429"></span><span class="annot"><a href="GHC.Core.Type.html#saturates"><span class="hs-identifier hs-var">saturates</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682563892"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563892"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682563893"><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621682563893"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621682563893"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Arity -&gt; Arity -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Arity
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Arity -&gt; Bool
</span><a href="GHC.Core.Type.html#saturates"><span class="hs-identifier hs-var">saturates</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563892"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621682563893"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Arity -&gt; Arity -&gt; Arity
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Arity
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>                       </span><span class="hs-comment">-- Arities are always positive; the assertion just checks</span><span>
</span><span id="line-431"></span><span>                       </span><span class="hs-comment">-- that, to avoid an infinite loop in the bad case</span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span class="hs-comment">-- | A helper for 'expandSynTyConApp_maybe' to avoid inlining this cold path</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- into call-sites.</span><span>
</span><span id="line-435"></span><span class="hs-comment">--</span><span>
</span><span id="line-436"></span><span class="hs-comment">-- Precondition: the call is saturated or over-saturated;</span><span>
</span><span id="line-437"></span><span class="hs-comment">--               i.e. length tvs &lt;= length arg_tys</span><span>
</span><span id="line-438"></span><span class="annot"><a href="GHC.Core.Type.html#expand_syn"><span class="hs-identifier hs-type">expand_syn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the variables bound by the synonym</span></span><span>
</span><span id="line-439"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ the RHS of the synonym</span></span><span>
</span><span id="line-440"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ the type arguments the synonym is instantiated at.</span></span><span>
</span><span id="line-441"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-442"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#expand_syn"><span class="hs-pragma hs-type">expand_syn</span></a></span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-comment">-- We never want to inline this cold-path.</span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span id="expand_syn"><span class="annot"><span class="annottext">expand_syn :: [TyVar] -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#expand_syn"><span class="hs-identifier hs-var hs-var">expand_syn</span></a></span></span><span> </span><span id="local-6989586621682563895"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682563895"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621682563896"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563896"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621682563897"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563897"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-comment">-- No substitution necessary if either tvs or tys is empty</span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-comment">-- This is both more efficient, and steers clear of an infinite</span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-comment">-- loop; see Note [Care using synonyms to compress types]</span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563897"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; Type
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682563895"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563896"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682563895"><span class="hs-identifier hs-var">tvs</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563896"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563897"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; [TyVar] -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621682563899"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563900"><span class="hs-identifier hs-var">empty_subst</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682563895"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563897"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-452"></span><span>    </span><span id="local-6989586621682563900"><span class="annot"><span class="annottext">empty_subst :: Subst
</span><a href="#local-6989586621682563900"><span class="hs-identifier hs-var hs-var">empty_subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#mkEmptySubst"><span class="hs-identifier hs-var">mkEmptySubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621682563901"><span class="hs-identifier hs-var">in_scope</span></a></span><span>
</span><span id="line-453"></span><span>    </span><span id="local-6989586621682563901"><span class="annot"><span class="annottext">in_scope :: InScopeSet
</span><a href="#local-6989586621682563901"><span class="hs-identifier hs-var hs-var">in_scope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; InScopeSet) -&gt; VarSet -&gt; InScopeSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfTypes"><span class="hs-identifier hs-var">shallowTyCoVarsOfTypes</span></a></span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; VarSet) -&gt; [Type] -&gt; VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563897"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-454"></span><span>      </span><span class="hs-comment">-- The free vars of 'rhs' should all be bound by 'tenv',</span><span>
</span><span id="line-455"></span><span>      </span><span class="hs-comment">-- so we only need the free vars of tys</span><span>
</span><span id="line-456"></span><span>      </span><span class="hs-comment">-- See also Note [The substitution invariant] in GHC.Core.TyCo.Subst.</span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span>    </span><span id="local-6989586621682563899"><span class="annot"><span class="annottext">go :: Subst -&gt; [TyVar] -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621682563899"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682563904"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563904"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621682563905"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563905"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-459"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563905"><span class="hs-identifier hs-var">tys</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563906"><span class="hs-identifier hs-var">rhs'</span></a></span><span>  </span><span class="hs-comment">-- Exactly Saturated</span><span>
</span><span id="line-460"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563906"><span class="hs-identifier hs-var">rhs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563905"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-461"></span><span>          </span><span class="hs-comment">-- Its important to use mkAppTys, rather than (foldl AppTy),</span><span>
</span><span id="line-462"></span><span>          </span><span class="hs-comment">-- because the function part might well return a</span><span>
</span><span id="line-463"></span><span>          </span><span class="hs-comment">-- partially-applied type constructor; indeed, usually will!</span><span>
</span><span id="line-464"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-465"></span><span>        </span><span id="local-6989586621682563906"><span class="annot"><span class="annottext">rhs' :: Type
</span><a href="#local-6989586621682563906"><span class="hs-identifier hs-var hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Subst -&gt; Type -&gt; Type
Subst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563904"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563896"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span>    </span><span class="annot"><a href="#local-6989586621682563899"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682563907"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563907"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682563908"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682563908"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682563909"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682563909"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682563910"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563910"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682563911"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563911"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; [TyVar] -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621682563899"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; TyVar -&gt; Type -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#extendTvSubst"><span class="hs-identifier hs-var">extendTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563907"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682563908"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563910"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682563909"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563911"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span>    </span><span class="annot"><a href="#local-6989586621682563899"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[TyVar]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expand_syn&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682563895"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563896"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563897"><span class="hs-identifier hs-var">arg_tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>                   </span><span class="hs-comment">-- Under-saturated, precondition failed</span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span class="hs-comment">{- Note [Inlining coreView]
~~~~~~~~~~~~~~~~~~~~~~~~~~~
It is very common to have a function

  f :: Type -&gt; ...
  f ty | Just ty' &lt;- coreView ty = f ty'
  f (TyVarTy ...) = ...
  f ...           = ...

If f is not otherwise recursive, the initial call to coreView
causes f to become recursive, which kills the possibility of
inlining. Instead, for non-recursive functions, we prefer to
use coreFullView, which guarantees to unwrap top-level type
synonyms. It can be inlined and is efficient and non-allocating
in its fast path. For this to really be fast, all calls made
on its fast path must also be inlined, linked back to this Note.
-}</span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                expandTypeSynonyms
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span class="annot"><a href="GHC.Core.Type.html#expandTypeSynonyms"><span class="hs-identifier hs-type">expandTypeSynonyms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-498"></span><span class="hs-comment">-- ^ Expand out all type synonyms.  Actually, it'd suffice to expand out</span><span>
</span><span id="line-499"></span><span class="hs-comment">-- just the ones that discard type variables (e.g.  type Funny a = Int)</span><span>
</span><span id="line-500"></span><span class="hs-comment">-- But we don't know which those are currently, so we just expand all.</span><span>
</span><span id="line-501"></span><span class="hs-comment">--</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- 'expandTypeSynonyms' only expands out type synonyms mentioned in the type,</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- not in the kinds of any TyCon or TyVar mentioned in the type.</span><span>
</span><span id="line-504"></span><span class="hs-comment">--</span><span>
</span><span id="line-505"></span><span class="hs-comment">-- Keep this synchronized with 'synonymTyConsOfType'</span><span>
</span><span id="line-506"></span><span id="expandTypeSynonyms"><span class="annot"><span class="annottext">expandTypeSynonyms :: Type -&gt; Type
</span><a href="GHC.Core.Type.html#expandTypeSynonyms"><span class="hs-identifier hs-var hs-var">expandTypeSynonyms</span></a></span></span><span> </span><span id="local-6989586621682563915"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563915"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-507"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; Type
</span><a href="#local-6989586621682563916"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#mkEmptySubst"><span class="hs-identifier hs-var">mkEmptySubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621682563917"><span class="hs-identifier hs-var">in_scope</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563915"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-509"></span><span>    </span><span id="local-6989586621682563917"><span class="annot"><span class="annottext">in_scope :: InScopeSet
</span><a href="#local-6989586621682563917"><span class="hs-identifier hs-var hs-var">in_scope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563915"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span>    </span><span id="local-6989586621682563916"><span class="annot"><span class="annottext">go :: Subst -&gt; Type -&gt; Type
</span><a href="#local-6989586621682563916"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682563918"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563918"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682563919"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682563919"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682563920"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563920"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#ExpandsSyn"><span class="hs-identifier hs-type">ExpandsSyn</span></a></span><span> </span><span id="local-6989586621682563922"><span class="annot"><span class="annottext">[(TyVar, Type)]
</span><a href="#local-6989586621682563922"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621682563923"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563923"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621682563924"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563924"><span class="hs-identifier hs-var">tys'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; ExpandSynResult Type
forall tyco. TyCon -&gt; [tyco] -&gt; ExpandSynResult tyco
</span><a href="GHC.Core.TyCon.html#expandSynTyCon_maybe"><span class="hs-identifier hs-var">expandSynTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682563919"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563926"><span class="hs-identifier hs-var">expanded_tys</span></a></span><span>
</span><span id="line-513"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682563927"><span class="annot"><span class="annottext">subst' :: Subst
</span><a href="#local-6989586621682563927"><span class="hs-identifier hs-var hs-var">subst'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#mkTvSubst"><span class="hs-identifier hs-var">mkTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621682563917"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(TyVar, Type)] -&gt; TvSubstEnv
forall a. [(TyVar, a)] -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#mkVarEnv"><span class="hs-identifier hs-var">mkVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">[(TyVar, Type)]
</span><a href="#local-6989586621682563922"><span class="hs-identifier hs-var">tenv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>            </span><span class="hs-comment">-- Make a fresh substitution; rhs has nothing to</span><span>
</span><span id="line-515"></span><span>            </span><span class="hs-comment">-- do with anything that has happened so far</span><span>
</span><span id="line-516"></span><span>            </span><span class="hs-comment">-- NB: if you make changes here, be sure to build an</span><span>
</span><span id="line-517"></span><span>            </span><span class="hs-comment">--     /idempotent/ substitution, even in the nested case</span><span>
</span><span id="line-518"></span><span>            </span><span class="hs-comment">--        type T a b = a -&gt; b</span><span>
</span><span id="line-519"></span><span>            </span><span class="hs-comment">--        type S x y = T y x</span><span>
</span><span id="line-520"></span><span>            </span><span class="hs-comment">-- (#11665)</span><span>
</span><span id="line-521"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; Type
</span><a href="#local-6989586621682563916"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563927"><span class="hs-identifier hs-var">subst'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563923"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563924"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-522"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-523"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682563919"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563926"><span class="hs-identifier hs-var">expanded_tys</span></a></span><span>
</span><span id="line-524"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-525"></span><span>        </span><span id="local-6989586621682563926"><span class="annot"><span class="annottext">expanded_tys :: [Type]
</span><a href="#local-6989586621682563926"><span class="hs-identifier hs-var hs-var">expanded_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; [Type] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; Type
</span><a href="#local-6989586621682563916"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563918"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682563920"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span>    </span><span class="annot"><a href="#local-6989586621682563916"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621682563931"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682563931"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682563931"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-528"></span><span>    </span><span class="annot"><a href="#local-6989586621682563916"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682563932"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563932"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682563934"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682563934"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; TyVar -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyVar"><span class="hs-identifier hs-var">substTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563932"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682563934"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-529"></span><span>    </span><span class="annot"><a href="#local-6989586621682563916"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682563935"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563935"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682563937"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563937"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682563938"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563938"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; Type
</span><a href="#local-6989586621682563916"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563935"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563937"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; Type
</span><a href="#local-6989586621682563916"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563935"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563938"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>    </span><span class="annot"><a href="#local-6989586621682563916"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682563939"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563939"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621682563940"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682563940"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682563942"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563942"><span class="hs-identifier hs-var">mult</span></a></span></span><span> </span><span id="local-6989586621682563943"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563943"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682563944"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563944"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563940"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682563916"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682563939"><span class="hs-identifier hs-type">subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682563942"><span class="hs-identifier hs-type">mult</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682563916"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682563939"><span class="hs-identifier hs-type">subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682563943"><span class="hs-identifier hs-type">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682563916"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682563939"><span class="hs-identifier hs-type">subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682563944"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-532"></span><span>    </span><span class="annot"><a href="#local-6989586621682563916"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682563948"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563948"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682563951"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682563951"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621682563952"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682563952"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682563953"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563953"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682563954"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563954"><span class="hs-identifier hs-var">subst'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682563955"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682563955"><span class="hs-identifier hs-var">tv'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Subst -&gt; Type -&gt; Type) -&gt; Subst -&gt; TyVar -&gt; (Subst, TyVar)
</span><a href="GHC.Core.TyCo.Subst.html#substVarBndrUsing"><span class="hs-identifier hs-var">substVarBndrUsing</span></a></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; Type
</span><a href="#local-6989586621682563916"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563948"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682563951"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-534"></span><span>        </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; ForAllTyFlag -&gt; VarBndr TyVar ForAllTyFlag
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682563955"><span class="hs-identifier hs-var">tv'</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682563952"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; Type
</span><a href="#local-6989586621682563916"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563954"><span class="hs-identifier hs-var">subst'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563953"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span>    </span><span class="annot"><a href="#local-6989586621682563916"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682563957"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563957"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682563959"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563959"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682563960"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682563960"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; Type
</span><a href="#local-6989586621682563916"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563957"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563959"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563957"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682563960"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>    </span><span class="annot"><a href="#local-6989586621682563916"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682563962"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563962"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621682563964"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682563964"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCoercionTy"><span class="hs-identifier hs-var">mkCoercionTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563962"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682563964"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span>    </span><span id="local-6989586621682563965"><span class="annot"><span class="annottext">go_mco :: Subst -&gt; MCoercionN -&gt; MCoercionN
</span><a href="#local-6989586621682563965"><span class="hs-identifier hs-var hs-var">go_mco</span></a></span></span><span> </span><span class="annot"><span class="annottext">Subst
</span><span class="hs-identifier">_</span></span><span>     </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>
</span><span id="line-539"></span><span>    </span><span class="annot"><a href="#local-6989586621682563965"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span id="local-6989586621682563967"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563967"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-type">MCo</span></a></span><span> </span><span id="local-6989586621682563969"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682563969"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; MCoercionN
</span><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-var">MCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563967"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682563969"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span>    </span><span id="local-6989586621682563961"><span class="annot"><span class="annottext">go_co :: Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var hs-var">go_co</span></a></span></span><span> </span><span id="local-6989586621682563970"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563970"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-type">Refl</span></a></span><span> </span><span id="local-6989586621682563972"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563972"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkNomReflCo"><span class="hs-identifier hs-var">mkNomReflCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; Type
</span><a href="#local-6989586621682563916"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563970"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563972"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>    </span><span class="annot"><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682563973"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563973"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-type">GRefl</span></a></span><span> </span><span id="local-6989586621682563975"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682563975"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682563976"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563976"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682563977"><span class="annot"><span class="annottext">MCoercionN
</span><a href="#local-6989586621682563977"><span class="hs-identifier hs-var">mco</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Role -&gt; Type -&gt; MCoercionN -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkGReflCo"><span class="hs-identifier hs-var">mkGReflCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682563975"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; Type
</span><a href="#local-6989586621682563916"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563973"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682563976"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; MCoercionN -&gt; MCoercionN
</span><a href="#local-6989586621682563965"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563973"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="#local-6989586621682563977"><span class="hs-identifier hs-var">mco</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>       </span><span class="hs-comment">-- NB: coercions are always expanded upon creation</span><span>
</span><span id="line-546"></span><span>    </span><span class="annot"><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682563978"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563978"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConAppCo"><span class="hs-identifier hs-type">TyConAppCo</span></a></span><span> </span><span id="local-6989586621682563980"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682563980"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682563981"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682563981"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682563982"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682563982"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt;
Role -&gt; TyCon -&gt; [KindCoercion] -&gt; KindCoercion
Role -&gt; TyCon -&gt; [KindCoercion] -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkTyConAppCo"><span class="hs-identifier hs-var">mkTyConAppCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682563980"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682563981"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; [KindCoercion] -&gt; [KindCoercion]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563978"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682563982"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>    </span><span class="annot"><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682563983"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563983"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppCo"><span class="hs-identifier hs-type">AppCo</span></a></span><span> </span><span id="local-6989586621682563985"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682563985"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621682563986"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682563986"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkAppCo"><span class="hs-identifier hs-var">mkAppCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563983"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682563985"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563983"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682563986"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>    </span><span class="annot"><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682563987"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563987"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllCo"><span class="hs-identifier hs-type">ForAllCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fco_tcv :: KindCoercion -&gt; TyVar
</span><a href="GHC.Core.TyCo.Rep.html#fco_tcv"><span class="hs-identifier hs-var">fco_tcv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682563990"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682563990"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_visL :: KindCoercion -&gt; ForAllTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#fco_visL"><span class="hs-identifier hs-var">fco_visL</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682563992"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682563992"><span class="hs-identifier hs-var">visL</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_visR :: KindCoercion -&gt; ForAllTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#fco_visR"><span class="hs-identifier hs-var">fco_visR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682563994"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682563994"><span class="hs-identifier hs-var">visR</span></a></span></span><span>
</span><span id="line-551"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_kind :: KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_kind"><span class="hs-identifier hs-var">fco_kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682563996"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682563996"><span class="hs-identifier hs-var">kind_co</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_body :: KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_body"><span class="hs-identifier hs-var">fco_body</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682563998"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682563998"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682563999"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563999"><span class="hs-identifier hs-var">subst'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564000"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564000"><span class="hs-identifier hs-var">tv'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564001"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564001"><span class="hs-identifier hs-var">kind_co'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; TyVar -&gt; KindCoercion -&gt; (Subst, TyVar, KindCoercion)
</span><a href="#local-6989586621682564002"><span class="hs-identifier hs-var">go_cobndr</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563987"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682563990"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682563996"><span class="hs-identifier hs-var">kind_co</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-553"></span><span>        </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt;
TyVar
-&gt; ForAllTyFlag
-&gt; ForAllTyFlag
-&gt; KindCoercion
-&gt; KindCoercion
-&gt; KindCoercion
TyVar
-&gt; ForAllTyFlag
-&gt; ForAllTyFlag
-&gt; KindCoercion
-&gt; KindCoercion
-&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkForAllCo"><span class="hs-identifier hs-var">mkForAllCo</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564000"><span class="hs-identifier hs-var">tv'</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682563992"><span class="hs-identifier hs-var">visL</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682563994"><span class="hs-identifier hs-var">visR</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564001"><span class="hs-identifier hs-var">kind_co'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682563999"><span class="hs-identifier hs-var">subst'</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682563998"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>    </span><span class="annot"><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682564003"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564003"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunCo"><span class="hs-identifier hs-type">FunCo</span></a></span><span> </span><span id="local-6989586621682564005"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682564005"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682564006"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564006"><span class="hs-identifier hs-var">afl</span></a></span></span><span> </span><span id="local-6989586621682564007"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564007"><span class="hs-identifier hs-var">afr</span></a></span></span><span> </span><span id="local-6989586621682564008"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564008"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682564009"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564009"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621682564010"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564010"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Role
-&gt; FunTyFlag
-&gt; FunTyFlag
-&gt; KindCoercion
-&gt; KindCoercion
-&gt; KindCoercion
-&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkFunCo2"><span class="hs-identifier hs-var">mkFunCo2</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682564005"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564006"><span class="hs-identifier hs-var">afl</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564007"><span class="hs-identifier hs-var">afr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564003"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564008"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564003"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564009"><span class="hs-identifier hs-var">co1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564003"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564010"><span class="hs-identifier hs-var">co2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>    </span><span class="annot"><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682564011"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564011"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-type">CoVarCo</span></a></span><span> </span><span id="local-6989586621682564013"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564013"><span class="hs-identifier hs-var">cv</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; TyVar -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Subst.html#substCoVar"><span class="hs-identifier hs-var">substCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564011"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564013"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-558"></span><span>    </span><span class="annot"><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682564015"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564015"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomCo"><span class="hs-identifier hs-type">AxiomCo</span></a></span><span> </span><span id="local-6989586621682564017"><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621682564017"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span id="local-6989586621682564018"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682564018"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoAxiomRule -&gt; [KindCoercion] -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkAxiomCo"><span class="hs-identifier hs-var">mkAxiomCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621682564017"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; [KindCoercion] -&gt; [KindCoercion]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564015"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682564018"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>    </span><span class="annot"><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682564019"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564019"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621682564020"><span class="annot"><span class="annottext">co :: KindCoercion
</span><a href="#local-6989586621682564020"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#UnivCo"><span class="hs-identifier hs-type">UnivCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">uco_lty :: KindCoercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#uco_lty"><span class="hs-identifier hs-var">uco_lty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564023"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564023"><span class="hs-identifier hs-var">lty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uco_rty :: KindCoercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#uco_rty"><span class="hs-identifier hs-var">uco_rty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564025"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564025"><span class="hs-identifier hs-var">rty</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564020"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#uco_lty"><span class="hs-identifier hs-var">uco_lty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682563916"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564019"><span class="hs-identifier hs-type">subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564023"><span class="hs-identifier hs-type">lty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#uco_rty"><span class="hs-identifier hs-var">uco_rty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682563916"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564019"><span class="hs-identifier hs-type">subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564025"><span class="hs-identifier hs-type">rty</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-562"></span><span>    </span><span class="annot"><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682564026"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564026"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SymCo"><span class="hs-identifier hs-type">SymCo</span></a></span><span> </span><span id="local-6989586621682564028"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564028"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkSymCo"><span class="hs-identifier hs-var">mkSymCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564026"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564028"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span>    </span><span class="annot"><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682564029"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564029"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TransCo"><span class="hs-identifier hs-type">TransCo</span></a></span><span> </span><span id="local-6989586621682564031"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564031"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621682564032"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564032"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-565"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion
KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkTransCo"><span class="hs-identifier hs-var">mkTransCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564029"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564031"><span class="hs-identifier hs-var">co1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564029"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564032"><span class="hs-identifier hs-var">co2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>    </span><span class="annot"><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682564033"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564033"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SelCo"><span class="hs-identifier hs-type">SelCo</span></a></span><span> </span><span id="local-6989586621682564035"><span class="annot"><span class="annottext">CoSel
</span><a href="#local-6989586621682564035"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682564036"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564036"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CoSel -&gt; KindCoercion -&gt; KindCoercion
CoSel -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkSelCo"><span class="hs-identifier hs-var">mkSelCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoSel
</span><a href="#local-6989586621682564035"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564033"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564036"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span>    </span><span class="annot"><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682564037"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564037"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LRCo"><span class="hs-identifier hs-type">LRCo</span></a></span><span> </span><span id="local-6989586621682564039"><span class="annot"><span class="annottext">LeftOrRight
</span><a href="#local-6989586621682564039"><span class="hs-identifier hs-var">lr</span></a></span></span><span> </span><span id="local-6989586621682564040"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564040"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LeftOrRight -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkLRCo"><span class="hs-identifier hs-var">mkLRCo</span></a></span><span> </span><span class="annot"><span class="annottext">LeftOrRight
</span><a href="#local-6989586621682564039"><span class="hs-identifier hs-var">lr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564037"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564040"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>    </span><span class="annot"><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682564041"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564041"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#InstCo"><span class="hs-identifier hs-type">InstCo</span></a></span><span> </span><span id="local-6989586621682564043"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564043"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621682564044"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564044"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-571"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkInstCo"><span class="hs-identifier hs-var">mkInstCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564041"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564043"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564041"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564044"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>    </span><span class="annot"><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682564045"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564045"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCo"><span class="hs-identifier hs-type">KindCo</span></a></span><span> </span><span id="local-6989586621682564047"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564047"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkKindCo"><span class="hs-identifier hs-var">mkKindCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564045"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564047"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>    </span><span class="annot"><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682564048"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564048"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SubCo"><span class="hs-identifier hs-type">SubCo</span></a></span><span> </span><span id="local-6989586621682564050"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564050"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; KindCoercion -&gt; KindCoercion
KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkSubCo"><span class="hs-identifier hs-var">mkSubCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564048"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564050"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>    </span><span class="annot"><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#HoleCo"><span class="hs-identifier hs-type">HoleCo</span></a></span><span> </span><span id="local-6989586621682564052"><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621682564052"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; KindCoercion
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expandTypeSynonyms hit a hole&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoercionHole -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621682564052"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span>      </span><span class="hs-comment">-- the &quot;False&quot; and &quot;const&quot; are to accommodate the type of</span><span>
</span><span id="line-580"></span><span>      </span><span class="hs-comment">-- substForAllCoBndrUsing, which is general enough to</span><span>
</span><span id="line-581"></span><span>      </span><span class="hs-comment">-- handle coercion optimization (which sometimes swaps the</span><span>
</span><span id="line-582"></span><span>      </span><span class="hs-comment">-- order of a coercion)</span><span>
</span><span id="line-583"></span><span>    </span><span id="local-6989586621682564002"><span class="annot"><span class="annottext">go_cobndr :: Subst -&gt; TyVar -&gt; KindCoercion -&gt; (Subst, TyVar, KindCoercion)
</span><a href="#local-6989586621682564002"><span class="hs-identifier hs-var hs-var">go_cobndr</span></a></span></span><span> </span><span id="local-6989586621682564053"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564053"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SwapFlag
-&gt; (KindCoercion -&gt; KindCoercion)
-&gt; Subst
-&gt; TyVar
-&gt; KindCoercion
-&gt; (Subst, TyVar, KindCoercion)
</span><a href="GHC.Core.TyCo.Subst.html#substForAllCoBndrUsing"><span class="hs-identifier hs-var">substForAllCoBndrUsing</span></a></span><span> </span><span class="annot"><span class="annottext">SwapFlag
</span><a href="GHC.Types.Basic.html#NotSwapped"><span class="hs-identifier hs-var">NotSwapped</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621682563961"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564053"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564053"><span class="hs-identifier hs-var">subst</span></a></span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span class="hs-comment">{- Notes on type synonyms
~~~~~~~~~~~~~~~~~~~~~~~~~
The various &quot;split&quot; functions (splitFunTy, splitRhoTy, splitForAllTy) try
to return type synonyms wherever possible. Thus

        type Foo a = a -&gt; a

we want
        splitFunTys (a -&gt; Foo a) = ([a], Foo a)
not                                ([a], a -&gt; a)

The reason is that we then get better (shorter) type signatures in
interfaces.  Notably this plays a role in tcTySigs in GHC.Tc.Gen.Bind.
-}</span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                Random functions (todo: organise)
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span class="hs-comment">-- | An INLINE helper for function such as 'kindRep_maybe' below.</span><span>
</span><span id="line-607"></span><span class="hs-comment">--</span><span>
</span><span id="line-608"></span><span class="hs-comment">-- @isTyConKeyApp_maybe key ty@ returns @Just tys@ iff</span><span>
</span><span id="line-609"></span><span class="hs-comment">-- the type @ty = T tys@, where T's unique = key</span><span>
</span><span id="line-610"></span><span class="hs-comment">-- key must not be `fUNTyConKey`; to test for functions, use `splitFunTy_maybe`.</span><span>
</span><span id="line-611"></span><span class="hs-comment">-- Thanks to this fact, we don't have to pattern match on `FunTy` here.</span><span>
</span><span id="line-612"></span><span class="annot"><a href="GHC.Core.Type.html#isTyConKeyApp_maybe"><span class="hs-identifier hs-type">isTyConKeyApp_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-613"></span><span id="isTyConKeyApp_maybe"><span class="annot"><span class="annottext">isTyConKeyApp_maybe :: Unique -&gt; Type -&gt; Maybe [Type]
</span><a href="GHC.Core.Type.html#isTyConKeyApp_maybe"><span class="hs-identifier hs-var hs-var">isTyConKeyApp_maybe</span></a></span></span><span> </span><span id="local-6989586621682564058"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682564058"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621682564059"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564059"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-614"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564060"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564060"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682564061"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564061"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564059"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-615"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564060"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682564058"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-616"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Maybe [Type]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564061"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-617"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-618"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [Type]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-619"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isTyConKeyApp_maybe"><span class="hs-pragma hs-type">isTyConKeyApp_maybe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span class="hs-comment">-- | Extract the RuntimeRep classifier of a type from its kind. For example,</span><span>
</span><span id="line-622"></span><span class="hs-comment">-- @kindRep * = LiftedRep@; Panics if this is not possible.</span><span>
</span><span id="line-623"></span><span class="hs-comment">-- Treats * and Constraint as the same</span><span>
</span><span id="line-624"></span><span class="annot"><a href="GHC.Core.Type.html#kindRep"><span class="hs-identifier hs-type">kindRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#RuntimeRepType"><span class="hs-identifier hs-type">RuntimeRepType</span></a></span><span>
</span><span id="line-625"></span><span id="kindRep"><span class="annot"><span class="annottext">kindRep :: HasDebugCallStack =&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#kindRep"><span class="hs-identifier hs-var hs-var">kindRep</span></a></span></span><span> </span><span id="local-6989586621682564068"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564068"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#kindRep_maybe"><span class="hs-identifier hs-var">kindRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564068"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-626"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564069"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564069"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564069"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-627"></span><span>              </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;kindRep&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564068"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>
</span><span id="line-629"></span><span class="hs-comment">-- | Given a kind (TYPE rr) or (CONSTRAINT rr), extract its RuntimeRep classifier rr.</span><span>
</span><span id="line-630"></span><span class="hs-comment">-- For example, @kindRep_maybe * = Just LiftedRep@</span><span>
</span><span id="line-631"></span><span class="hs-comment">-- Returns 'Nothing' if the kind is not of form (TYPE rr)</span><span>
</span><span id="line-632"></span><span class="annot"><a href="GHC.Core.Type.html#kindRep_maybe"><span class="hs-identifier hs-type">kindRep_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#RuntimeRepType"><span class="hs-identifier hs-type">RuntimeRepType</span></a></span><span>
</span><span id="line-633"></span><span id="kindRep_maybe"><span class="annot"><span class="annottext">kindRep_maybe :: HasDebugCallStack =&gt; Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#kindRep_maybe"><span class="hs-identifier hs-var hs-var">kindRep_maybe</span></a></span></span><span> </span><span id="local-6989586621682564071"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564071"><span class="hs-identifier hs-var">kind</span></a></span></span><span>
</span><span id="line-634"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeOrConstraint
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564072"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564072"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TypeOrConstraint, Type)
</span><a href="GHC.Core.Type.html#sORTKind_maybe"><span class="hs-identifier hs-var">sORTKind_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564071"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564072"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-635"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-636"></span><span>
</span><span id="line-637"></span><span class="hs-comment">-- | Returns True if the argument is (lifted) Type or Constraint</span><span>
</span><span id="line-638"></span><span class="hs-comment">-- See Note [TYPE and CONSTRAINT] in GHC.Builtin.Types.Prim</span><span>
</span><span id="line-639"></span><span class="annot"><a href="GHC.Core.Type.html#isLiftedTypeKind"><span class="hs-identifier hs-type">isLiftedTypeKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-640"></span><span id="isLiftedTypeKind"><span class="annot"><span class="annottext">isLiftedTypeKind :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLiftedTypeKind"><span class="hs-identifier hs-var hs-var">isLiftedTypeKind</span></a></span></span><span> </span><span id="local-6989586621682564073"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564073"><span class="hs-identifier hs-var">kind</span></a></span></span><span>
</span><span id="line-641"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#kindRep_maybe"><span class="hs-identifier hs-var">kindRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564073"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-642"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564074"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564074"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLiftedRuntimeRep"><span class="hs-identifier hs-var">isLiftedRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564074"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-643"></span><span>      </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span class="hs-comment">-- | Returns True if the kind classifies unlifted types (like 'Int#') and False</span><span>
</span><span id="line-646"></span><span class="hs-comment">-- otherwise. Note that this returns False for representation-polymorphic</span><span>
</span><span id="line-647"></span><span class="hs-comment">-- kinds, which may be specialized to a kind that classifies unlifted types.</span><span>
</span><span id="line-648"></span><span class="annot"><a href="GHC.Core.Type.html#isUnliftedTypeKind"><span class="hs-identifier hs-type">isUnliftedTypeKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-649"></span><span id="isUnliftedTypeKind"><span class="annot"><span class="annottext">isUnliftedTypeKind :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnliftedTypeKind"><span class="hs-identifier hs-var hs-var">isUnliftedTypeKind</span></a></span></span><span> </span><span id="local-6989586621682564075"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564075"><span class="hs-identifier hs-var">kind</span></a></span></span><span>
</span><span id="line-650"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#kindRep_maybe"><span class="hs-identifier hs-var">kindRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564075"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-651"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564076"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564076"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnliftedRuntimeRep"><span class="hs-identifier hs-var">isUnliftedRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564076"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-652"></span><span>      </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-653"></span><span>
</span><span id="line-654"></span><span class="annot"><a href="GHC.Core.Type.html#pickyIsLiftedTypeKind"><span class="hs-identifier hs-type">pickyIsLiftedTypeKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-655"></span><span class="hs-comment">-- Checks whether the kind is literally</span><span>
</span><span id="line-656"></span><span class="hs-comment">--      TYPE LiftedRep</span><span>
</span><span id="line-657"></span><span class="hs-comment">-- or   TYPE ('BoxedRep 'Lifted)</span><span>
</span><span id="line-658"></span><span class="hs-comment">-- or   Type</span><span>
</span><span id="line-659"></span><span class="hs-comment">-- without expanding type synonyms or anything</span><span>
</span><span id="line-660"></span><span class="hs-comment">-- Used only when deciding whether to suppress the &quot;:: *&quot; in</span><span>
</span><span id="line-661"></span><span class="hs-comment">-- (a :: *) when printing kinded type variables</span><span>
</span><span id="line-662"></span><span class="hs-comment">-- See Note [Suppressing * kinds] in GHC.Core.TyCo.Ppr</span><span>
</span><span id="line-663"></span><span id="pickyIsLiftedTypeKind"><span class="annot"><span class="annottext">pickyIsLiftedTypeKind :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#pickyIsLiftedTypeKind"><span class="hs-identifier hs-var hs-var">pickyIsLiftedTypeKind</span></a></span></span><span> </span><span id="local-6989586621682564077"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564077"><span class="hs-identifier hs-var">kind</span></a></span></span><span>
</span><span id="line-664"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564078"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564078"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682564079"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564079"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564077"><span class="hs-identifier hs-var">kind</span></a></span><span>
</span><span id="line-665"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564078"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#tYPETyConKey"><span class="hs-identifier hs-var">tYPETyConKey</span></a></span><span>
</span><span id="line-666"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564081"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564081"><span class="hs-identifier hs-var">rr_tc</span></a></span></span><span> </span><span id="local-6989586621682564082"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564082"><span class="hs-identifier hs-var">rr_args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564079"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564082"><span class="hs-identifier hs-var">rr_args</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-667"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564081"><span class="hs-identifier hs-var">rr_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#liftedRepTyConKey"><span class="hs-identifier hs-var">liftedRepTyConKey</span></a></span><span>
</span><span id="line-668"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682564084"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564084"><span class="hs-identifier hs-var">rr_arg</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-669"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564081"><span class="hs-identifier hs-var">rr_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#boxedRepDataConKey"><span class="hs-identifier hs-var">boxedRepDataConKey</span></a></span><span>
</span><span id="line-670"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564086"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564086"><span class="hs-identifier hs-var">lev</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564084"><span class="hs-identifier hs-var">rr_arg</span></a></span><span>
</span><span id="line-671"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564086"><span class="hs-identifier hs-var">lev</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#liftedDataConKey"><span class="hs-identifier hs-var">liftedDataConKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-672"></span><span>      </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-673"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564088"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564088"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564077"><span class="hs-identifier hs-var">kind</span></a></span><span>
</span><span id="line-674"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564088"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#liftedTypeKindTyConKey"><span class="hs-identifier hs-var">liftedTypeKindTyConKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-675"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-676"></span><span>
</span><span id="line-677"></span><span class="hs-comment">-- | Check whether a kind is of the form `TYPE (BoxedRep Lifted)`</span><span>
</span><span id="line-678"></span><span class="hs-comment">-- or `TYPE (BoxedRep Unlifted)`.</span><span>
</span><span id="line-679"></span><span class="hs-comment">--</span><span>
</span><span id="line-680"></span><span class="hs-comment">-- Returns:</span><span>
</span><span id="line-681"></span><span class="hs-comment">--</span><span>
</span><span id="line-682"></span><span class="hs-comment">--  - `Just Lifted` for `TYPE (BoxedRep Lifted)` and `Type`,</span><span>
</span><span id="line-683"></span><span class="hs-comment">--  - `Just Unlifted` for `TYPE (BoxedRep Unlifted)` and `UnliftedType`,</span><span>
</span><span id="line-684"></span><span class="hs-comment">--  - `Nothing` for anything else, e.g. `TYPE IntRep`, `TYPE (BoxedRep l)`, etc.</span><span>
</span><span id="line-685"></span><span class="annot"><a href="GHC.Core.Type.html#kindBoxedRepLevity_maybe"><span class="hs-identifier hs-type">kindBoxedRepLevity_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Levity"><span class="hs-identifier hs-type">Levity</span></a></span><span>
</span><span id="line-686"></span><span id="kindBoxedRepLevity_maybe"><span class="annot"><span class="annottext">kindBoxedRepLevity_maybe :: Type -&gt; Maybe Levity
</span><a href="GHC.Core.Type.html#kindBoxedRepLevity_maybe"><span class="hs-identifier hs-var hs-var">kindBoxedRepLevity_maybe</span></a></span></span><span> </span><span id="local-6989586621682564090"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564090"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-687"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564091"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564091"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#kindRep_maybe"><span class="hs-identifier hs-var">kindRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564090"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-688"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isBoxedRuntimeRep"><span class="hs-identifier hs-var">isBoxedRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564091"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-689"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Levity
</span><a href="GHC.Core.Type.html#runtimeRepLevity_maybe"><span class="hs-identifier hs-var">runtimeRepLevity_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564091"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-690"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-691"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Levity
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span class="hs-comment">-- | Check whether a type of kind 'RuntimeRep' is lifted.</span><span>
</span><span id="line-694"></span><span class="hs-comment">--</span><span>
</span><span id="line-695"></span><span class="hs-comment">-- 'isLiftedRuntimeRep' is:</span><span>
</span><span id="line-696"></span><span class="hs-comment">--</span><span>
</span><span id="line-697"></span><span class="hs-comment">--  * True of @LiftedRep :: RuntimeRep@</span><span>
</span><span id="line-698"></span><span class="hs-comment">--  * False of type variables, type family applications,</span><span>
</span><span id="line-699"></span><span class="hs-comment">--    and of other reps such as @IntRep :: RuntimeRep@.</span><span>
</span><span id="line-700"></span><span class="annot"><a href="GHC.Core.Type.html#isLiftedRuntimeRep"><span class="hs-identifier hs-type">isLiftedRuntimeRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#RuntimeRepType"><span class="hs-identifier hs-type">RuntimeRepType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-701"></span><span id="isLiftedRuntimeRep"><span class="annot"><span class="annottext">isLiftedRuntimeRep :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLiftedRuntimeRep"><span class="hs-identifier hs-var hs-var">isLiftedRuntimeRep</span></a></span></span><span> </span><span id="local-6989586621682564093"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564093"><span class="hs-identifier hs-var">rep</span></a></span></span><span>
</span><span id="line-702"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Levity
</span><a href="GHC.Core.Type.html#runtimeRepLevity_maybe"><span class="hs-identifier hs-var">runtimeRepLevity_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564093"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Levity -&gt; Maybe Levity -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Levity -&gt; Maybe Levity
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Levity
</span><a href="GHC.Types.Basic.html#Lifted"><span class="hs-identifier hs-var">Lifted</span></a></span><span>
</span><span id="line-703"></span><span>
</span><span id="line-704"></span><span class="hs-comment">-- | Check whether a type of kind 'RuntimeRep' is unlifted.</span><span>
</span><span id="line-705"></span><span class="hs-comment">--</span><span>
</span><span id="line-706"></span><span class="hs-comment">--  * True of definitely unlifted 'RuntimeRep's such as</span><span>
</span><span id="line-707"></span><span class="hs-comment">--    'UnliftedRep', 'IntRep', 'FloatRep', ...</span><span>
</span><span id="line-708"></span><span class="hs-comment">--  * False of 'LiftedRep',</span><span>
</span><span id="line-709"></span><span class="hs-comment">--  * False for type variables and type family applications.</span><span>
</span><span id="line-710"></span><span class="annot"><a href="GHC.Core.Type.html#isUnliftedRuntimeRep"><span class="hs-identifier hs-type">isUnliftedRuntimeRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#RuntimeRepType"><span class="hs-identifier hs-type">RuntimeRepType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-711"></span><span id="isUnliftedRuntimeRep"><span class="annot"><span class="annottext">isUnliftedRuntimeRep :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnliftedRuntimeRep"><span class="hs-identifier hs-var hs-var">isUnliftedRuntimeRep</span></a></span></span><span> </span><span id="local-6989586621682564097"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564097"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-712"></span><span>  </span><span class="annot"><span class="annottext">Type -&gt; Maybe Levity
</span><a href="GHC.Core.Type.html#runtimeRepLevity_maybe"><span class="hs-identifier hs-var">runtimeRepLevity_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564097"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Levity -&gt; Maybe Levity -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Levity -&gt; Maybe Levity
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Levity
</span><a href="GHC.Types.Basic.html#Unlifted"><span class="hs-identifier hs-var">Unlifted</span></a></span><span>
</span><span id="line-713"></span><span>
</span><span id="line-714"></span><span class="hs-comment">-- | An INLINE helper for functions such as 'isLiftedLevity' and 'isUnliftedLevity'.</span><span>
</span><span id="line-715"></span><span class="hs-comment">--</span><span>
</span><span id="line-716"></span><span class="hs-comment">-- Checks whether the type is a nullary 'TyCon' application,</span><span>
</span><span id="line-717"></span><span class="hs-comment">-- for a 'TyCon' with the given 'Unique'.</span><span>
</span><span id="line-718"></span><span class="annot"><a href="GHC.Core.Type.html#isNullaryTyConKeyApp"><span class="hs-identifier hs-type">isNullaryTyConKeyApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-719"></span><span id="isNullaryTyConKeyApp"><span class="annot"><span class="annottext">isNullaryTyConKeyApp :: Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isNullaryTyConKeyApp"><span class="hs-identifier hs-var hs-var">isNullaryTyConKeyApp</span></a></span></span><span> </span><span id="local-6989586621682564100"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682564100"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621682564101"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564101"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-720"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564102"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564102"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Maybe [Type]
</span><a href="GHC.Core.Type.html#isTyConKeyApp_maybe"><span class="hs-identifier hs-var">isTyConKeyApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682564100"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564101"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-721"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564102"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-722"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-723"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-724"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isNullaryTyConKeyApp"><span class="hs-pragma hs-type">isNullaryTyConKeyApp</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-725"></span><span>
</span><span id="line-726"></span><span class="annot"><a href="GHC.Core.Type.html#isLiftedLevity"><span class="hs-identifier hs-type">isLiftedLevity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-727"></span><span id="isLiftedLevity"><span class="annot"><span class="annottext">isLiftedLevity :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLiftedLevity"><span class="hs-identifier hs-var hs-var">isLiftedLevity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isNullaryTyConKeyApp"><span class="hs-identifier hs-var">isNullaryTyConKeyApp</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#liftedDataConKey"><span class="hs-identifier hs-var">liftedDataConKey</span></a></span><span>
</span><span id="line-728"></span><span>
</span><span id="line-729"></span><span class="annot"><a href="GHC.Core.Type.html#isUnliftedLevity"><span class="hs-identifier hs-type">isUnliftedLevity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-730"></span><span id="isUnliftedLevity"><span class="annot"><span class="annottext">isUnliftedLevity :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnliftedLevity"><span class="hs-identifier hs-var hs-var">isUnliftedLevity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isNullaryTyConKeyApp"><span class="hs-identifier hs-var">isNullaryTyConKeyApp</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#unliftedDataConKey"><span class="hs-identifier hs-var">unliftedDataConKey</span></a></span><span>
</span><span id="line-731"></span><span>
</span><span id="line-732"></span><span class="annot"><span class="hs-comment">-- | Is this the type 'Levity'?</span></span><span>
</span><span id="line-733"></span><span class="annot"><a href="GHC.Core.Type.html#isLevityTy"><span class="hs-identifier hs-type">isLevityTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-734"></span><span id="isLevityTy"><span class="annot"><span class="annottext">isLevityTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLevityTy"><span class="hs-identifier hs-var hs-var">isLevityTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isNullaryTyConKeyApp"><span class="hs-identifier hs-var">isNullaryTyConKeyApp</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#levityTyConKey"><span class="hs-identifier hs-var">levityTyConKey</span></a></span><span>
</span><span id="line-735"></span><span>
</span><span id="line-736"></span><span class="annot"><span class="hs-comment">-- | Is this the type 'RuntimeRep'?</span></span><span>
</span><span id="line-737"></span><span class="annot"><a href="GHC.Core.Type.html#isRuntimeRepTy"><span class="hs-identifier hs-type">isRuntimeRepTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-738"></span><span id="isRuntimeRepTy"><span class="annot"><span class="annottext">isRuntimeRepTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isRuntimeRepTy"><span class="hs-identifier hs-var hs-var">isRuntimeRepTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isNullaryTyConKeyApp"><span class="hs-identifier hs-var">isNullaryTyConKeyApp</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#runtimeRepTyConKey"><span class="hs-identifier hs-var">runtimeRepTyConKey</span></a></span><span>
</span><span id="line-739"></span><span>
</span><span id="line-740"></span><span class="annot"><span class="hs-comment">-- | Is a tyvar of type 'RuntimeRep'?</span></span><span>
</span><span id="line-741"></span><span class="annot"><a href="GHC.Core.Type.html#isRuntimeRepVar"><span class="hs-identifier hs-type">isRuntimeRepVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-742"></span><span id="isRuntimeRepVar"><span class="annot"><span class="annottext">isRuntimeRepVar :: TyVar -&gt; Bool
</span><a href="GHC.Core.Type.html#isRuntimeRepVar"><span class="hs-identifier hs-var hs-var">isRuntimeRepVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isRuntimeRepTy"><span class="hs-identifier hs-var">isRuntimeRepTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; (TyVar -&gt; Type) -&gt; TyVar -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span>
</span><span id="line-743"></span><span>
</span><span id="line-744"></span><span class="annot"><span class="hs-comment">-- | Is a tyvar of type 'Levity'?</span></span><span>
</span><span id="line-745"></span><span class="annot"><a href="GHC.Core.Type.html#isLevityVar"><span class="hs-identifier hs-type">isLevityVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-746"></span><span id="isLevityVar"><span class="annot"><span class="annottext">isLevityVar :: TyVar -&gt; Bool
</span><a href="GHC.Core.Type.html#isLevityVar"><span class="hs-identifier hs-var hs-var">isLevityVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLevityTy"><span class="hs-identifier hs-var">isLevityTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; (TyVar -&gt; Type) -&gt; TyVar -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span>
</span><span id="line-747"></span><span>
</span><span id="line-748"></span><span class="annot"><span class="hs-comment">-- | Is this the type 'Multiplicity'?</span></span><span>
</span><span id="line-749"></span><span class="annot"><a href="GHC.Core.Type.html#isMultiplicityTy"><span class="hs-identifier hs-type">isMultiplicityTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-750"></span><span id="isMultiplicityTy"><span class="annot"><span class="annottext">isMultiplicityTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isMultiplicityTy"><span class="hs-identifier hs-var hs-var">isMultiplicityTy</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isNullaryTyConKeyApp"><span class="hs-identifier hs-var">isNullaryTyConKeyApp</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#multiplicityTyConKey"><span class="hs-identifier hs-var">multiplicityTyConKey</span></a></span><span>
</span><span id="line-751"></span><span>
</span><span id="line-752"></span><span class="annot"><span class="hs-comment">-- | Is a tyvar of type 'Multiplicity'?</span></span><span>
</span><span id="line-753"></span><span class="annot"><a href="GHC.Core.Type.html#isMultiplicityVar"><span class="hs-identifier hs-type">isMultiplicityVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-754"></span><span id="isMultiplicityVar"><span class="annot"><span class="annottext">isMultiplicityVar :: TyVar -&gt; Bool
</span><a href="GHC.Core.Type.html#isMultiplicityVar"><span class="hs-identifier hs-var hs-var">isMultiplicityVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isMultiplicityTy"><span class="hs-identifier hs-var">isMultiplicityTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; (TyVar -&gt; Type) -&gt; TyVar -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span>
</span><span id="line-755"></span><span>
</span><span id="line-756"></span><span class="hs-comment">--------------------------------------------</span><span>
</span><span id="line-757"></span><span class="hs-comment">--  Splitting RuntimeRep</span><span>
</span><span id="line-758"></span><span class="hs-comment">--------------------------------------------</span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span class="hs-comment">-- | (splitRuntimeRep_maybe rr) takes a Type rr :: RuntimeRep, and</span><span>
</span><span id="line-761"></span><span class="hs-comment">--   returns the (TyCon,[Type]) for the RuntimeRep, if possible, where</span><span>
</span><span id="line-762"></span><span class="hs-comment">--   the TyCon is one of the promoted DataCons of RuntimeRep.</span><span>
</span><span id="line-763"></span><span class="hs-comment">-- Remember: the unique on TyCon that is a a promoted DataCon is the</span><span>
</span><span id="line-764"></span><span class="hs-comment">--           same as the unique on the DataCon</span><span>
</span><span id="line-765"></span><span class="hs-comment">--           See Note [Promoted data constructors] in GHC.Core.TyCon</span><span>
</span><span id="line-766"></span><span class="hs-comment">-- May not be possible if `rr` is a type variable or type</span><span>
</span><span id="line-767"></span><span class="hs-comment">--   family application</span><span>
</span><span id="line-768"></span><span class="annot"><a href="GHC.Core.Type.html#splitRuntimeRep_maybe"><span class="hs-identifier hs-type">splitRuntimeRep_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#RuntimeRepType"><span class="hs-identifier hs-type">RuntimeRepType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-769"></span><span id="splitRuntimeRep_maybe"><span class="annot"><span class="annottext">splitRuntimeRep_maybe :: Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitRuntimeRep_maybe"><span class="hs-identifier hs-var hs-var">splitRuntimeRep_maybe</span></a></span></span><span> </span><span id="local-6989586621682564109"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564109"><span class="hs-identifier hs-var">rep</span></a></span></span><span>
</span><span id="line-770"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564110"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564110"><span class="hs-identifier hs-var">rr_tc</span></a></span></span><span> </span><span id="local-6989586621682564111"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564111"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564109"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-771"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isPromotedDataCon"><span class="hs-identifier hs-var">isPromotedDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564110"><span class="hs-identifier hs-var">rr_tc</span></a></span><span>
</span><span id="line-772"></span><span>    </span><span class="hs-comment">-- isPromotedDataCon: be careful of type families (F tys) :: RuntimeRep,</span><span>
</span><span id="line-773"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyCon, [Type]) -&gt; Maybe (TyCon, [Type])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564110"><span class="hs-identifier hs-var">rr_tc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564111"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-774"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-775"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-776"></span><span>
</span><span id="line-777"></span><span class="annot"><span class="hs-comment">-- | See 'isBoxedRuntimeRep_maybe'.</span></span><span>
</span><span id="line-778"></span><span class="annot"><a href="GHC.Core.Type.html#isBoxedRuntimeRep"><span class="hs-identifier hs-type">isBoxedRuntimeRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#RuntimeRepType"><span class="hs-identifier hs-type">RuntimeRepType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-779"></span><span id="isBoxedRuntimeRep"><span class="annot"><span class="annottext">isBoxedRuntimeRep :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isBoxedRuntimeRep"><span class="hs-identifier hs-var hs-var">isBoxedRuntimeRep</span></a></span></span><span> </span><span id="local-6989586621682564114"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564114"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#isBoxedRuntimeRep_maybe"><span class="hs-identifier hs-var">isBoxedRuntimeRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564114"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-780"></span><span>
</span><span id="line-781"></span><span class="hs-comment">-- | `isBoxedRuntimeRep_maybe (rep :: RuntimeRep)` returns `Just lev` if `rep`</span><span>
</span><span id="line-782"></span><span class="hs-comment">-- expands to `Boxed lev` and returns `Nothing` otherwise.</span><span>
</span><span id="line-783"></span><span class="hs-comment">--</span><span>
</span><span id="line-784"></span><span class="hs-comment">-- Types with this runtime rep are represented by pointers on the GC'd heap.</span><span>
</span><span id="line-785"></span><span class="annot"><a href="GHC.Core.Type.html#isBoxedRuntimeRep_maybe"><span class="hs-identifier hs-type">isBoxedRuntimeRep_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#RuntimeRepType"><span class="hs-identifier hs-type">RuntimeRepType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LevityType"><span class="hs-identifier hs-type">LevityType</span></a></span><span>
</span><span id="line-786"></span><span id="isBoxedRuntimeRep_maybe"><span class="annot"><span class="annottext">isBoxedRuntimeRep_maybe :: Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#isBoxedRuntimeRep_maybe"><span class="hs-identifier hs-var hs-var">isBoxedRuntimeRep_maybe</span></a></span></span><span> </span><span id="local-6989586621682564116"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564116"><span class="hs-identifier hs-var">rep</span></a></span></span><span>
</span><span id="line-787"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564117"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564117"><span class="hs-identifier hs-var">rr_tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564118"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564118"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitRuntimeRep_maybe"><span class="hs-identifier hs-var">splitRuntimeRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564116"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-788"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564117"><span class="hs-identifier hs-var">rr_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#boxedRepDataConKey"><span class="hs-identifier hs-var">boxedRepDataConKey</span></a></span><span>
</span><span id="line-789"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682564119"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564119"><span class="hs-identifier hs-var">lev</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564118"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-790"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564119"><span class="hs-identifier hs-var">lev</span></a></span><span>
</span><span id="line-791"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-792"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-793"></span><span>
</span><span id="line-794"></span><span class="hs-comment">-- | Check whether a type (usually of kind 'RuntimeRep') is lifted, unlifted,</span><span>
</span><span id="line-795"></span><span class="hs-comment">--   or unknown.  Returns Nothing if the type isn't of kind 'RuntimeRep'.</span><span>
</span><span id="line-796"></span><span class="hs-comment">--</span><span>
</span><span id="line-797"></span><span class="hs-comment">-- `runtimeRepLevity_maybe rr` returns:</span><span>
</span><span id="line-798"></span><span class="hs-comment">--</span><span>
</span><span id="line-799"></span><span class="hs-comment">--   * `Just Lifted` if `rr` is `LiftedRep :: RuntimeRep`</span><span>
</span><span id="line-800"></span><span class="hs-comment">--   * `Just Unlifted` if `rr` is definitely unlifted, e.g. `IntRep`</span><span>
</span><span id="line-801"></span><span class="hs-comment">--   * `Nothing` if not known (e.g. it's a type variable or a type family application).</span><span>
</span><span id="line-802"></span><span class="annot"><a href="GHC.Core.Type.html#runtimeRepLevity_maybe"><span class="hs-identifier hs-type">runtimeRepLevity_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#RuntimeRepType"><span class="hs-identifier hs-type">RuntimeRepType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Levity"><span class="hs-identifier hs-type">Levity</span></a></span><span>
</span><span id="line-803"></span><span id="runtimeRepLevity_maybe"><span class="annot"><span class="annottext">runtimeRepLevity_maybe :: Type -&gt; Maybe Levity
</span><a href="GHC.Core.Type.html#runtimeRepLevity_maybe"><span class="hs-identifier hs-var hs-var">runtimeRepLevity_maybe</span></a></span></span><span> </span><span id="local-6989586621682564120"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564120"><span class="hs-identifier hs-var">rep</span></a></span></span><span>
</span><span id="line-804"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564121"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564121"><span class="hs-identifier hs-var">rr_tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564122"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564122"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitRuntimeRep_maybe"><span class="hs-identifier hs-var">splitRuntimeRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564120"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-805"></span><span>  </span><span class="hs-glyph">=</span><span>       </span><span class="hs-comment">-- NB: args might be non-empty e.g. TupleRep [r1, .., rn]</span><span>
</span><span id="line-806"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564121"><span class="hs-identifier hs-var">rr_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#boxedRepDataConKey"><span class="hs-identifier hs-var">boxedRepDataConKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-807"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564122"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-808"></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621682564123"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564123"><span class="hs-identifier hs-var">lev</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Levity
</span><a href="GHC.Core.Type.html#levityType_maybe"><span class="hs-identifier hs-var">levityType_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564123"><span class="hs-identifier hs-var">lev</span></a></span><span>
</span><span id="line-809"></span><span>            </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Levity
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-comment">-- Type isn't of kind RuntimeRep</span><span>
</span><span id="line-810"></span><span>                     </span><span class="hs-comment">-- The latter case happens via the call to isLiftedRuntimeRep</span><span>
</span><span id="line-811"></span><span>                     </span><span class="hs-comment">-- in GHC.Tc.Errors.Ppr.pprMismatchMsg (#22742)</span><span>
</span><span id="line-812"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Levity -&gt; Maybe Levity
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Levity
</span><a href="GHC.Types.Basic.html#Unlifted"><span class="hs-identifier hs-var">Unlifted</span></a></span><span>
</span><span id="line-813"></span><span>        </span><span class="hs-comment">-- Avoid searching all the unlifted RuntimeRep type cons</span><span>
</span><span id="line-814"></span><span>        </span><span class="hs-comment">-- In the RuntimeRep data type, only LiftedRep is lifted</span><span>
</span><span id="line-815"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-816"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Levity
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-817"></span><span>
</span><span id="line-818"></span><span class="hs-comment">--------------------------------------------</span><span>
</span><span id="line-819"></span><span class="hs-comment">--  Splitting Levity</span><span>
</span><span id="line-820"></span><span class="hs-comment">--------------------------------------------</span><span>
</span><span id="line-821"></span><span>
</span><span id="line-822"></span><span class="hs-comment">-- | `levityType_maybe` takes a Type of kind Levity, and returns its levity</span><span>
</span><span id="line-823"></span><span class="hs-comment">-- May not be possible for a type variable or type family application</span><span>
</span><span id="line-824"></span><span class="annot"><a href="GHC.Core.Type.html#levityType_maybe"><span class="hs-identifier hs-type">levityType_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LevityType"><span class="hs-identifier hs-type">LevityType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Levity"><span class="hs-identifier hs-type">Levity</span></a></span><span>
</span><span id="line-825"></span><span id="levityType_maybe"><span class="annot"><span class="annottext">levityType_maybe :: Type -&gt; Maybe Levity
</span><a href="GHC.Core.Type.html#levityType_maybe"><span class="hs-identifier hs-var hs-var">levityType_maybe</span></a></span></span><span> </span><span id="local-6989586621682564124"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564124"><span class="hs-identifier hs-var">lev</span></a></span></span><span>
</span><span id="line-826"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564125"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564125"><span class="hs-identifier hs-var">lev_tc</span></a></span></span><span> </span><span id="local-6989586621682564126"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564126"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564124"><span class="hs-identifier hs-var">lev</span></a></span><span>
</span><span id="line-827"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564125"><span class="hs-identifier hs-var">lev_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#liftedDataConKey"><span class="hs-identifier hs-var">liftedDataConKey</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Levity -&gt; Maybe Levity
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564126"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Levity -&gt; Maybe Levity) -&gt; Maybe Levity -&gt; Maybe Levity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Levity -&gt; Maybe Levity
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Levity
</span><a href="GHC.Types.Basic.html#Lifted"><span class="hs-identifier hs-var">Lifted</span></a></span><span>
</span><span id="line-828"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564125"><span class="hs-identifier hs-var">lev_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#unliftedDataConKey"><span class="hs-identifier hs-var">unliftedDataConKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Levity -&gt; Maybe Levity
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564126"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Levity -&gt; Maybe Levity) -&gt; Maybe Levity -&gt; Maybe Levity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Levity -&gt; Maybe Levity
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Levity
</span><a href="GHC.Types.Basic.html#Unlifted"><span class="hs-identifier hs-var">Unlifted</span></a></span><span>
</span><span id="line-829"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Levity
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-830"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-831"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Levity
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-832"></span><span>
</span><span id="line-833"></span><span>
</span><span id="line-834"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
               mapType
*                                                                      *
************************************************************************

These functions do a map-like operation over types, performing some operation
on all variables and binding sites. Primarily used for zonking.

Note [Efficiency for ForAllCo case of mapTyCoX]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
As noted in Note [ForAllCo] in GHC.Core.TyCo.Rep, a ForAllCo is a bit redundant.
It stores a TyCoVar and a Coercion, where the kind of the TyCoVar always matches
the left-hand kind of the coercion. This is convenient lots of the time, but
not when mapping a function over a coercion.

The problem is that tcm_tybinder will affect the TyCoVar's kind and
mapCoercion will affect the Coercion, and we hope that the results will be
the same. Even if they are the same (which should generally happen with
correct algorithms), then there is an efficiency issue. In particular,
this problem seems to make what should be a linear algorithm into a potentially
exponential one. But it's only going to be bad in the case where there's
lots of foralls in the kinds of other foralls. Like this:

  forall a : (forall b : (forall c : ...). ...). ...

This construction seems unlikely. So we'll do the inefficient, easy way
for now.

Note [Specialising mappers]
~~~~~~~~~~~~~~~~~~~~~~~~~~~
These INLINE pragmas are indispensable. mapTyCo and mapTyCoX are used
to implement zonking, and it's vital that they get specialised to the TcM
monad and the particular mapper in use.

Even specialising to the monad alone made a 20% allocation difference
in perf/compiler/T5030.

See Note [Specialising foldType] in &quot;GHC.Core.TyCo.Rep&quot; for more details of this
idiom.
-}</span></span><span>
</span><span id="line-875"></span><span>
</span><span id="line-876"></span><span class="annot"><span class="hs-comment">-- | This describes how a &quot;map&quot; operation over a type/coercion should behave</span></span><span>
</span><span id="line-877"></span><span class="hs-keyword">data</span><span> </span><span id="TyCoMapper"><span class="annot"><a href="GHC.Core.Type.html#TyCoMapper"><span class="hs-identifier hs-var">TyCoMapper</span></a></span></span><span> </span><span id="local-6989586621682563125"><span class="annot"><a href="#local-6989586621682563125"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621682563126"><span class="annot"><a href="#local-6989586621682563126"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-878"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TyCoMapper"><span class="annot"><a href="GHC.Core.Type.html#TyCoMapper"><span class="hs-identifier hs-var">TyCoMapper</span></a></span></span><span>
</span><span id="line-879"></span><span>      </span><span class="hs-special">{</span><span> </span><span id="tcm_tyvar"><span class="annot"><span class="annottext">forall env (m :: * -&gt; *).
TyCoMapper env m -&gt; env -&gt; TyVar -&gt; m Type
</span><a href="GHC.Core.Type.html#tcm_tyvar"><span class="hs-identifier hs-var hs-var">tcm_tyvar</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682563125"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-880"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="tcm_covar"><span class="annot"><span class="annottext">forall env (m :: * -&gt; *).
TyCoMapper env m -&gt; env -&gt; TyVar -&gt; m KindCoercion
</span><a href="GHC.Core.Type.html#tcm_covar"><span class="hs-identifier hs-var hs-var">tcm_covar</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682563125"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-881"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="tcm_hole"><span class="annot"><span class="annottext">forall env (m :: * -&gt; *).
TyCoMapper env m -&gt; env -&gt; CoercionHole -&gt; m KindCoercion
</span><a href="GHC.Core.Type.html#tcm_hole"><span class="hs-identifier hs-var hs-var">tcm_hole</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682563125"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionHole"><span class="hs-identifier hs-type">CoercionHole</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-882"></span><span>          </span><span class="hs-comment">-- ^ What to do with coercion holes.</span><span>
</span><span id="line-883"></span><span>          </span><span class="hs-comment">-- See Note [Coercion holes] in &quot;GHC.Core.TyCo.Rep&quot;.</span><span>
</span><span id="line-884"></span><span>
</span><span id="line-885"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="tcm_tycobinder"><span class="annot"><span class="annottext">forall env (m :: * -&gt; *).
TyCoMapper env m
-&gt; forall r.
   env -&gt; TyVar -&gt; ForAllTyFlag -&gt; (env -&gt; TyVar -&gt; m r) -&gt; m r
</span><a href="GHC.Core.Type.html#tcm_tycobinder"><span class="hs-identifier hs-var hs-var">tcm_tycobinder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682563134"><span class="annot"><a href="#local-6989586621682563134"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621682563125"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Specificity.html#ForAllTyFlag"><span class="hs-identifier hs-type">ForAllTyFlag</span></a></span><span>
</span><span id="line-886"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682563125"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682563134"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682563134"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-887"></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ The returned env is used in the extended scope</span></span><span>
</span><span id="line-888"></span><span>
</span><span id="line-889"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="tcm_tycon"><span class="annot"><span class="annottext">forall env (m :: * -&gt; *). TyCoMapper env m -&gt; TyCon -&gt; m TyCon
</span><a href="GHC.Core.Type.html#tcm_tycon"><span class="hs-identifier hs-var hs-var">tcm_tycon</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-890"></span><span>          </span><span class="hs-comment">-- ^ This is used only for TcTyCons</span><span>
</span><span id="line-891"></span><span>          </span><span class="hs-comment">-- a) To zonk TcTyCons</span><span>
</span><span id="line-892"></span><span>          </span><span class="hs-comment">-- b) To turn TcTyCons into TyCons.</span><span>
</span><span id="line-893"></span><span>          </span><span class="hs-comment">--    See Note [Type checking recursive type and class declarations]</span><span>
</span><span id="line-894"></span><span>          </span><span class="hs-comment">--    in &quot;GHC.Tc.TyCl&quot;</span><span>
</span><span id="line-895"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-896"></span><span>
</span><span id="line-897"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mapTyCo"><span class="hs-pragma hs-type">mapTyCo</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>  </span><span class="hs-comment">-- See Note [Specialising mappers]</span><span>
</span><span id="line-898"></span><span id="local-6989586621682563140"><span class="annot"><a href="GHC.Core.Type.html#mapTyCo"><span class="hs-identifier hs-type">mapTyCo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682563140"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#TyCoMapper"><span class="hs-identifier hs-type">TyCoMapper</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682563140"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-899"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563140"><span class="hs-identifier hs-type">m</span></a></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-900"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563140"><span class="hs-identifier hs-type">m</span></a></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-901"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563140"><span class="hs-identifier hs-type">m</span></a></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-902"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563140"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span></span><span>
</span><span id="line-903"></span><span id="mapTyCo"><span class="annot"><span class="annottext">mapTyCo :: forall (m :: * -&gt; *).
Monad m =&gt;
TyCoMapper () m
-&gt; (Type -&gt; m Type, [Type] -&gt; m [Type],
    KindCoercion -&gt; m KindCoercion, [KindCoercion] -&gt; m [KindCoercion])
</span><a href="GHC.Core.Type.html#mapTyCo"><span class="hs-identifier hs-var hs-var">mapTyCo</span></a></span></span><span> </span><span id="local-6989586621682564137"><span class="annot"><span class="annottext">TyCoMapper () m
</span><a href="#local-6989586621682564137"><span class="hs-identifier hs-var">mapper</span></a></span></span><span>
</span><span id="line-904"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyCoMapper () m
-&gt; (() -&gt; Type -&gt; m Type, () -&gt; [Type] -&gt; m [Type],
    () -&gt; KindCoercion -&gt; m KindCoercion,
    () -&gt; [KindCoercion] -&gt; m [KindCoercion])
forall (m :: * -&gt; *) env.
Monad m =&gt;
TyCoMapper env m
-&gt; (env -&gt; Type -&gt; m Type, env -&gt; [Type] -&gt; m [Type],
    env -&gt; KindCoercion -&gt; m KindCoercion,
    env -&gt; [KindCoercion] -&gt; m [KindCoercion])
</span><a href="GHC.Core.Type.html#mapTyCoX"><span class="hs-identifier hs-var">mapTyCoX</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoMapper () m
</span><a href="#local-6989586621682564137"><span class="hs-identifier hs-var">mapper</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-905"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621682564138"><span class="annot"><span class="annottext">() -&gt; Type -&gt; m Type
</span><a href="#local-6989586621682564138"><span class="hs-identifier hs-var">go_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564139"><span class="annot"><span class="annottext">() -&gt; [Type] -&gt; m [Type]
</span><a href="#local-6989586621682564139"><span class="hs-identifier hs-var">go_tys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564140"><span class="annot"><span class="annottext">() -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564140"><span class="hs-identifier hs-var">go_co</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564141"><span class="annot"><span class="annottext">() -&gt; [KindCoercion] -&gt; m [KindCoercion]
</span><a href="#local-6989586621682564141"><span class="hs-identifier hs-var">go_cos</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-906"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Type -&gt; m Type
</span><a href="#local-6989586621682564138"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">() -&gt; [Type] -&gt; m [Type]
</span><a href="#local-6989586621682564139"><span class="hs-identifier hs-var">go_tys</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">() -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564140"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">() -&gt; [KindCoercion] -&gt; m [KindCoercion]
</span><a href="#local-6989586621682564141"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-907"></span><span>
</span><span id="line-908"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mapTyCoX"><span class="hs-pragma hs-type">mapTyCoX</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>  </span><span class="hs-comment">-- See Note [Specialising mappers]</span><span>
</span><span id="line-909"></span><span class="annot"><a href="GHC.Core.Type.html#mapTyCoX"><span class="hs-identifier hs-type">mapTyCoX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682563142"><span class="annot"><a href="#local-6989586621682563142"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621682563143"><span class="annot"><a href="#local-6989586621682563143"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682563142"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-910"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#TyCoMapper"><span class="hs-identifier hs-type">TyCoMapper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682563143"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682563142"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-911"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621682563143"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563142"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-912"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682563143"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563142"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-913"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682563143"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563142"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-914"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682563143"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563142"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-915"></span><span id="mapTyCoX"><span class="annot"><span class="annottext">mapTyCoX :: forall (m :: * -&gt; *) env.
Monad m =&gt;
TyCoMapper env m
-&gt; (env -&gt; Type -&gt; m Type, env -&gt; [Type] -&gt; m [Type],
    env -&gt; KindCoercion -&gt; m KindCoercion,
    env -&gt; [KindCoercion] -&gt; m [KindCoercion])
</span><a href="GHC.Core.Type.html#mapTyCoX"><span class="hs-identifier hs-var hs-var">mapTyCoX</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#TyCoMapper"><span class="hs-identifier hs-type">TyCoMapper</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tcm_tyvar :: forall env (m :: * -&gt; *).
TyCoMapper env m -&gt; env -&gt; TyVar -&gt; m Type
</span><a href="GHC.Core.Type.html#tcm_tyvar"><span class="hs-identifier hs-var">tcm_tyvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564211"><span class="annot"><span class="annottext">env -&gt; TyVar -&gt; m Type
</span><a href="#local-6989586621682564211"><span class="hs-identifier hs-var">tyvar</span></a></span></span><span>
</span><span id="line-916"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcm_tycobinder :: forall env (m :: * -&gt; *).
TyCoMapper env m
-&gt; forall r.
   env -&gt; TyVar -&gt; ForAllTyFlag -&gt; (env -&gt; TyVar -&gt; m r) -&gt; m r
</span><a href="GHC.Core.Type.html#tcm_tycobinder"><span class="hs-identifier hs-var">tcm_tycobinder</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564212"><span class="annot"><span class="annottext">forall r.
env -&gt; TyVar -&gt; ForAllTyFlag -&gt; (env -&gt; TyVar -&gt; m r) -&gt; m r
</span><a href="#local-6989586621682564212"><span class="hs-identifier hs-var">tycobinder</span></a></span></span><span>
</span><span id="line-917"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcm_tycon :: forall env (m :: * -&gt; *). TyCoMapper env m -&gt; TyCon -&gt; m TyCon
</span><a href="GHC.Core.Type.html#tcm_tycon"><span class="hs-identifier hs-var">tcm_tycon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564213"><span class="annot"><span class="annottext">TyCon -&gt; m TyCon
</span><a href="#local-6989586621682564213"><span class="hs-identifier hs-var">tycon</span></a></span></span><span>
</span><span id="line-918"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcm_covar :: forall env (m :: * -&gt; *).
TyCoMapper env m -&gt; env -&gt; TyVar -&gt; m KindCoercion
</span><a href="GHC.Core.Type.html#tcm_covar"><span class="hs-identifier hs-var">tcm_covar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564214"><span class="annot"><span class="annottext">env -&gt; TyVar -&gt; m KindCoercion
</span><a href="#local-6989586621682564214"><span class="hs-identifier hs-var">covar</span></a></span></span><span>
</span><span id="line-919"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcm_hole :: forall env (m :: * -&gt; *).
TyCoMapper env m -&gt; env -&gt; CoercionHole -&gt; m KindCoercion
</span><a href="GHC.Core.Type.html#tcm_hole"><span class="hs-identifier hs-var">tcm_hole</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564215"><span class="annot"><span class="annottext">env -&gt; CoercionHole -&gt; m KindCoercion
</span><a href="#local-6989586621682564215"><span class="hs-identifier hs-var">cohole</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-920"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">env -&gt; [Type] -&gt; m [Type]
</span><a href="#local-6989586621682564217"><span class="hs-identifier hs-var">go_tys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">env -&gt; [KindCoercion] -&gt; m [KindCoercion]
</span><a href="#local-6989586621682564219"><span class="hs-identifier hs-var">go_cos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-921"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-922"></span><span>    </span><span class="hs-comment">-- See Note [Use explicit recursion in mapTyCo]</span><span>
</span><span id="line-923"></span><span>    </span><span id="local-6989586621682564217"><span class="annot"><span class="annottext">go_tys :: env -&gt; [Type] -&gt; m [Type]
</span><a href="#local-6989586621682564217"><span class="hs-identifier hs-var hs-var">go_tys</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="annottext">env
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; m [Type]
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-924"></span><span>    </span><span class="annot"><a href="#local-6989586621682564217"><span class="hs-identifier hs-var">go_tys</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564220"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564220"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564221"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564221"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682564222"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564222"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; [Type] -&gt; [Type]) -&gt; m Type -&gt; m ([Type] -&gt; [Type])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564220"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564221"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">m ([Type] -&gt; [Type]) -&gt; m [Type] -&gt; m [Type]
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; [Type] -&gt; m [Type]
</span><a href="#local-6989586621682564217"><span class="hs-identifier hs-var">go_tys</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564220"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564222"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-925"></span><span>
</span><span id="line-926"></span><span>    </span><span id="local-6989586621682564216"><span class="annot"><span class="annottext">go_ty :: env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621682564216"><span class="hs-identifier hs-var hs-var">go_ty</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564224"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564224"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682564225"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564225"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">env -&gt; TyVar -&gt; m Type
</span><a href="#local-6989586621682564211"><span class="hs-identifier hs-var">tyvar</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564224"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564225"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-927"></span><span>    </span><span class="annot"><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564226"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564226"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682564227"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564227"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682564228"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564228"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; m Type -&gt; m (Type -&gt; Type)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564226"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564227"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">m (Type -&gt; Type) -&gt; m Type -&gt; m Type
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564226"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564228"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-928"></span><span>    </span><span class="annot"><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="annottext">env
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621682564229"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682564229"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Type
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564229"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-929"></span><span>    </span><span class="annot"><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564230"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564230"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682564231"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564231"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564232"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564232"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; KindCoercion -&gt; Type)
-&gt; m Type -&gt; m (KindCoercion -&gt; Type)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564230"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564231"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">m (KindCoercion -&gt; Type) -&gt; m KindCoercion -&gt; m Type
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564230"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564232"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-930"></span><span>    </span><span class="annot"><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564233"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564233"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621682564234"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564234"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; Type) -&gt; m KindCoercion -&gt; m Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564233"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564234"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-931"></span><span>
</span><span id="line-932"></span><span>    </span><span class="annot"><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564235"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564235"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682564236"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682564236"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682564237"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564237"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682564238"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564238"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682564239"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564239"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-933"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682564240"><span class="annot"><a href="#local-6989586621682564240"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564235"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564237"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621682564241"><span class="annot"><a href="#local-6989586621682564241"><span class="hs-identifier hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682564216"><span class="hs-identifier hs-type">go_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564235"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564238"><span class="hs-identifier hs-type">arg</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621682564242"><span class="annot"><a href="#local-6989586621682564242"><span class="hs-identifier hs-var">res'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682564216"><span class="hs-identifier hs-type">go_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564235"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564239"><span class="hs-identifier hs-type">res</span></a></span><span>
</span><span id="line-934"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682564236"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682564240"><span class="hs-identifier hs-type">w'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682564241"><span class="hs-identifier hs-type">arg'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682564242"><span class="hs-identifier hs-type">res'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-935"></span><span>
</span><span id="line-936"></span><span>    </span><span class="annot"><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564243"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564243"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682564244"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682564244"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564245"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564245"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682564246"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564246"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-937"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTcTyCon"><span class="hs-identifier hs-var">isTcTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564245"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-938"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682564248"><span class="annot"><a href="#local-6989586621682564248"><span class="hs-identifier hs-var">tc'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; m TyCon
</span><a href="#local-6989586621682564213"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564245"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-939"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-type">mkTyConApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564248"><span class="hs-identifier hs-type">tc'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682564217"><span class="hs-identifier hs-type">go_tys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564243"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564246"><span class="hs-identifier hs-type">tys</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-940"></span><span>
</span><span id="line-941"></span><span>      </span><span class="hs-comment">-- Not a TcTyCon</span><span>
</span><span id="line-942"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564246"><span class="hs-identifier hs-var">tys</span></a></span><span>    </span><span class="hs-comment">-- Avoid allocation in this very</span><span>
</span><span id="line-943"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Type
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564244"><span class="hs-identifier hs-var">ty</span></a></span><span>   </span><span class="hs-comment">-- common case (E.g. Int, LiftedRep etc)</span><span>
</span><span id="line-944"></span><span>
</span><span id="line-945"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-946"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564245"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; Type) -&gt; m [Type] -&gt; m Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; [Type] -&gt; m [Type]
</span><a href="#local-6989586621682564217"><span class="hs-identifier hs-var">go_tys</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564243"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564246"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-947"></span><span>
</span><span id="line-948"></span><span>    </span><span class="annot"><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564249"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564249"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564250"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564250"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621682564251"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682564251"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564252"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564252"><span class="hs-identifier hs-var">inner</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-949"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">env -&gt; TyVar -&gt; ForAllTyFlag -&gt; (env -&gt; TyVar -&gt; m Type) -&gt; m Type
forall r.
env -&gt; TyVar -&gt; ForAllTyFlag -&gt; (env -&gt; TyVar -&gt; m r) -&gt; m r
</span><a href="#local-6989586621682564212"><span class="hs-identifier hs-var">tycobinder</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564249"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564250"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682564251"><span class="hs-identifier hs-var">vis</span></a></span><span> </span><span class="annot"><span class="annottext">((env -&gt; TyVar -&gt; m Type) -&gt; m Type)
-&gt; (env -&gt; TyVar -&gt; m Type) -&gt; m Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682564253"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564253"><span class="hs-identifier hs-var">env'</span></a></span></span><span> </span><span id="local-6989586621682564254"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564254"><span class="hs-identifier hs-var">tv'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-950"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682564255"><span class="annot"><a href="#local-6989586621682564255"><span class="hs-identifier hs-var">inner'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564253"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564252"><span class="hs-identifier hs-var">inner</span></a></span><span>
</span><span id="line-951"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564254"><span class="hs-identifier hs-type">tv'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564251"><span class="hs-identifier hs-type">vis</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682564255"><span class="hs-identifier hs-type">inner'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-952"></span><span>
</span><span id="line-953"></span><span>    </span><span class="hs-comment">-- See Note [Use explicit recursion in mapTyCo]</span><span>
</span><span id="line-954"></span><span>    </span><span id="local-6989586621682564219"><span class="annot"><span class="annottext">go_cos :: env -&gt; [KindCoercion] -&gt; m [KindCoercion]
</span><a href="#local-6989586621682564219"><span class="hs-identifier hs-var hs-var">go_cos</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="annottext">env
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[KindCoercion] -&gt; m [KindCoercion]
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-955"></span><span>    </span><span class="annot"><a href="#local-6989586621682564219"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564256"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564256"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564257"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564257"><span class="hs-identifier hs-var">co</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682564258"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682564258"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; [KindCoercion] -&gt; [KindCoercion])
-&gt; m KindCoercion -&gt; m ([KindCoercion] -&gt; [KindCoercion])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564256"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564257"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">m ([KindCoercion] -&gt; [KindCoercion])
-&gt; m [KindCoercion] -&gt; m [KindCoercion]
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; [KindCoercion] -&gt; m [KindCoercion]
</span><a href="#local-6989586621682564219"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564256"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682564258"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-956"></span><span>
</span><span id="line-957"></span><span>    </span><span id="local-6989586621682564259"><span class="annot"><span class="annottext">go_mco :: env -&gt; MCoercionN -&gt; m MCoercionN
</span><a href="#local-6989586621682564259"><span class="hs-identifier hs-var hs-var">go_mco</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="annottext">env
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MCoercionN -&gt; m MCoercionN
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>
</span><span id="line-958"></span><span>    </span><span class="annot"><a href="#local-6989586621682564259"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564260"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564260"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-type">MCo</span></a></span><span> </span><span id="local-6989586621682564261"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564261"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; MCoercionN
</span><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-var">MCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; MCoercionN) -&gt; m KindCoercion -&gt; m MCoercionN
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564260"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564261"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-959"></span><span>
</span><span id="line-960"></span><span>    </span><span class="annot"><a href="#local-6989586621682564218"><span class="hs-identifier hs-type">go_co</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682563143"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563142"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-961"></span><span>    </span><span id="local-6989586621682564218"><span class="annot"><span class="annottext">go_co :: env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var hs-var">go_co</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564262"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564262"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-type">Refl</span></a></span><span> </span><span id="local-6989586621682564263"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564263"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; KindCoercion) -&gt; m Type -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564262"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564263"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-962"></span><span>    </span><span class="annot"><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564264"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564264"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-type">GRefl</span></a></span><span> </span><span id="local-6989586621682564265"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682564265"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682564266"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564266"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564267"><span class="annot"><span class="annottext">MCoercionN
</span><a href="#local-6989586621682564267"><span class="hs-identifier hs-var">mco</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Role -&gt; Type -&gt; MCoercionN -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkGReflCo"><span class="hs-identifier hs-var">mkGReflCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682564265"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; MCoercionN -&gt; KindCoercion)
-&gt; m Type -&gt; m (MCoercionN -&gt; KindCoercion)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564264"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564266"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">m (MCoercionN -&gt; KindCoercion) -&gt; m MCoercionN -&gt; m KindCoercion
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; MCoercionN -&gt; m MCoercionN
</span><a href="#local-6989586621682564259"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564264"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercionN
</span><a href="#local-6989586621682564267"><span class="hs-identifier hs-var">mco</span></a></span><span>
</span><span id="line-963"></span><span>    </span><span class="annot"><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564268"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564268"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppCo"><span class="hs-identifier hs-type">AppCo</span></a></span><span> </span><span id="local-6989586621682564269"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564269"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621682564270"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564270"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkAppCo"><span class="hs-identifier hs-var">mkAppCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion -&gt; m (KindCoercion -&gt; KindCoercion)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564268"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564269"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">m (KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion -&gt; m KindCoercion
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564268"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564270"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-964"></span><span>    </span><span class="annot"><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564271"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564271"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunCo"><span class="hs-identifier hs-type">FunCo</span></a></span><span> </span><span id="local-6989586621682564272"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682564272"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682564273"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564273"><span class="hs-identifier hs-var">afl</span></a></span></span><span> </span><span id="local-6989586621682564274"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564274"><span class="hs-identifier hs-var">afr</span></a></span></span><span> </span><span id="local-6989586621682564275"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564275"><span class="hs-identifier hs-var">cw</span></a></span></span><span> </span><span id="local-6989586621682564276"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564276"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621682564277"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564277"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Role
-&gt; FunTyFlag
-&gt; FunTyFlag
-&gt; KindCoercion
-&gt; KindCoercion
-&gt; KindCoercion
-&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkFunCo2"><span class="hs-identifier hs-var">mkFunCo2</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682564272"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564273"><span class="hs-identifier hs-var">afl</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564274"><span class="hs-identifier hs-var">afr</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion
-&gt; m (KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564271"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564275"><span class="hs-identifier hs-var">cw</span></a></span><span>
</span><span id="line-965"></span><span>                                           </span><span class="annot"><span class="annottext">m (KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion -&gt; m (KindCoercion -&gt; KindCoercion)
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564271"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564276"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">m (KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion -&gt; m KindCoercion
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564271"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564277"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-966"></span><span>    </span><span class="annot"><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564278"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564278"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-type">CoVarCo</span></a></span><span> </span><span id="local-6989586621682564279"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564279"><span class="hs-identifier hs-var">cv</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">env -&gt; TyVar -&gt; m KindCoercion
</span><a href="#local-6989586621682564214"><span class="hs-identifier hs-var">covar</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564278"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564279"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-967"></span><span>    </span><span class="annot"><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564280"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564280"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#HoleCo"><span class="hs-identifier hs-type">HoleCo</span></a></span><span> </span><span id="local-6989586621682564281"><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621682564281"><span class="hs-identifier hs-var">hole</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">env -&gt; CoercionHole -&gt; m KindCoercion
</span><a href="#local-6989586621682564215"><span class="hs-identifier hs-var">cohole</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564280"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621682564281"><span class="hs-identifier hs-var">hole</span></a></span><span>
</span><span id="line-968"></span><span>    </span><span class="annot"><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564282"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564282"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#UnivCo"><span class="hs-identifier hs-type">UnivCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">uco_prov :: KindCoercion -&gt; UnivCoProvenance
</span><a href="GHC.Core.TyCo.Rep.html#uco_prov"><span class="hs-identifier hs-var">uco_prov</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564284"><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621682564284"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uco_role :: KindCoercion -&gt; Role
</span><a href="GHC.Core.TyCo.Rep.html#uco_role"><span class="hs-identifier hs-var">uco_role</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564286"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682564286"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-969"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uco_lty :: KindCoercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#uco_lty"><span class="hs-identifier hs-var">uco_lty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564287"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564287"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uco_rty :: KindCoercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#uco_rty"><span class="hs-identifier hs-var">uco_rty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564288"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564288"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uco_deps :: KindCoercion -&gt; [KindCoercion]
</span><a href="GHC.Core.TyCo.Rep.html#uco_deps"><span class="hs-identifier hs-var">uco_deps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564290"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682564290"><span class="hs-identifier hs-var">deps</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-970"></span><span>                                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
-&gt; [KindCoercion] -&gt; Role -&gt; Type -&gt; Type -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkUnivCo"><span class="hs-identifier hs-var">mkUnivCo</span></a></span><span> </span><span class="annot"><span class="annottext">(UnivCoProvenance
 -&gt; [KindCoercion] -&gt; Role -&gt; Type -&gt; Type -&gt; KindCoercion)
-&gt; m UnivCoProvenance
-&gt; m ([KindCoercion] -&gt; Role -&gt; Type -&gt; Type -&gt; KindCoercion)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance -&gt; m UnivCoProvenance
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621682564284"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-971"></span><span>                                                     </span><span class="annot"><span class="annottext">m ([KindCoercion] -&gt; Role -&gt; Type -&gt; Type -&gt; KindCoercion)
-&gt; m [KindCoercion] -&gt; m (Role -&gt; Type -&gt; Type -&gt; KindCoercion)
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; [KindCoercion] -&gt; m [KindCoercion]
</span><a href="#local-6989586621682564219"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564282"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682564290"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-972"></span><span>                                                     </span><span class="annot"><span class="annottext">m (Role -&gt; Type -&gt; Type -&gt; KindCoercion)
-&gt; m Role -&gt; m (Type -&gt; Type -&gt; KindCoercion)
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Role -&gt; m Role
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682564286"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-973"></span><span>                                                     </span><span class="annot"><span class="annottext">m (Type -&gt; Type -&gt; KindCoercion)
-&gt; m Type -&gt; m (Type -&gt; KindCoercion)
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564282"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564287"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">m (Type -&gt; KindCoercion) -&gt; m Type -&gt; m KindCoercion
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; Type -&gt; m Type
</span><a href="#local-6989586621682564216"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564282"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564288"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-974"></span><span>    </span><span class="annot"><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564291"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564291"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SymCo"><span class="hs-identifier hs-type">SymCo</span></a></span><span> </span><span id="local-6989586621682564292"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564292"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkSymCo"><span class="hs-identifier hs-var">mkSymCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; m KindCoercion -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564291"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564292"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-975"></span><span>    </span><span class="annot"><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564293"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564293"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TransCo"><span class="hs-identifier hs-type">TransCo</span></a></span><span> </span><span id="local-6989586621682564294"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564294"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621682564295"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564295"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion
KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkTransCo"><span class="hs-identifier hs-var">mkTransCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion -&gt; m (KindCoercion -&gt; KindCoercion)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564293"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564294"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">m (KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion -&gt; m KindCoercion
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564293"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564295"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-976"></span><span>    </span><span class="annot"><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564296"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564296"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomCo"><span class="hs-identifier hs-type">AxiomCo</span></a></span><span> </span><span id="local-6989586621682564297"><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621682564297"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682564298"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682564298"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoAxiomRule -&gt; [KindCoercion] -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkAxiomCo"><span class="hs-identifier hs-var">mkAxiomCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621682564297"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">([KindCoercion] -&gt; KindCoercion)
-&gt; m [KindCoercion] -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; [KindCoercion] -&gt; m [KindCoercion]
</span><a href="#local-6989586621682564219"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564296"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682564298"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-977"></span><span>    </span><span class="annot"><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564299"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564299"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SelCo"><span class="hs-identifier hs-type">SelCo</span></a></span><span> </span><span id="local-6989586621682564300"><span class="annot"><span class="annottext">CoSel
</span><a href="#local-6989586621682564300"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682564301"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564301"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CoSel -&gt; KindCoercion -&gt; KindCoercion
CoSel -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkSelCo"><span class="hs-identifier hs-var">mkSelCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoSel
</span><a href="#local-6989586621682564300"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; m KindCoercion -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564299"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564301"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-978"></span><span>    </span><span class="annot"><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564302"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564302"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LRCo"><span class="hs-identifier hs-type">LRCo</span></a></span><span> </span><span id="local-6989586621682564303"><span class="annot"><span class="annottext">LeftOrRight
</span><a href="#local-6989586621682564303"><span class="hs-identifier hs-var">lr</span></a></span></span><span> </span><span id="local-6989586621682564304"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564304"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LeftOrRight -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkLRCo"><span class="hs-identifier hs-var">mkLRCo</span></a></span><span> </span><span class="annot"><span class="annottext">LeftOrRight
</span><a href="#local-6989586621682564303"><span class="hs-identifier hs-var">lr</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; m KindCoercion -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564302"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564304"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-979"></span><span>    </span><span class="annot"><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564305"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564305"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#InstCo"><span class="hs-identifier hs-type">InstCo</span></a></span><span> </span><span id="local-6989586621682564306"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564306"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621682564307"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564307"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkInstCo"><span class="hs-identifier hs-var">mkInstCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion -&gt; m (KindCoercion -&gt; KindCoercion)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564305"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564306"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">m (KindCoercion -&gt; KindCoercion)
-&gt; m KindCoercion -&gt; m KindCoercion
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564305"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564307"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-980"></span><span>    </span><span class="annot"><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564308"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564308"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCo"><span class="hs-identifier hs-type">KindCo</span></a></span><span> </span><span id="local-6989586621682564309"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564309"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkKindCo"><span class="hs-identifier hs-var">mkKindCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; m KindCoercion -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564308"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564309"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-981"></span><span>    </span><span class="annot"><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564310"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564310"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SubCo"><span class="hs-identifier hs-type">SubCo</span></a></span><span> </span><span id="local-6989586621682564311"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564311"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; KindCoercion -&gt; KindCoercion
KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkSubCo"><span class="hs-identifier hs-var">mkSubCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; m KindCoercion -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564310"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564311"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-982"></span><span>    </span><span class="annot"><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564312"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564312"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682564313"><span class="annot"><span class="annottext">co :: KindCoercion
</span><a href="#local-6989586621682564313"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConAppCo"><span class="hs-identifier hs-type">TyConAppCo</span></a></span><span> </span><span id="local-6989586621682564314"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682564314"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682564315"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564315"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682564316"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682564316"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-983"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTcTyCon"><span class="hs-identifier hs-var">isTcTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564315"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-984"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682564317"><span class="annot"><a href="#local-6989586621682564317"><span class="hs-identifier hs-var">tc'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; m TyCon
</span><a href="#local-6989586621682564213"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564315"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-985"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkTyConAppCo"><span class="hs-identifier hs-type">mkTyConAppCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564314"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564317"><span class="hs-identifier hs-type">tc'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682564219"><span class="hs-identifier hs-type">go_cos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564312"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564316"><span class="hs-identifier hs-type">cos</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-986"></span><span>
</span><span id="line-987"></span><span>      </span><span class="hs-comment">-- Not a TcTyCon</span><span>
</span><span id="line-988"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[KindCoercion] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682564316"><span class="hs-identifier hs-var">cos</span></a></span><span>    </span><span class="hs-comment">-- Avoid allocation in this very</span><span>
</span><span id="line-989"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; m KindCoercion
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564313"><span class="hs-identifier hs-var">co</span></a></span><span>   </span><span class="hs-comment">-- common case (E.g. Int, LiftedRep etc)</span><span>
</span><span id="line-990"></span><span>
</span><span id="line-991"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-992"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt;
Role -&gt; TyCon -&gt; [KindCoercion] -&gt; KindCoercion
Role -&gt; TyCon -&gt; [KindCoercion] -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkTyConAppCo"><span class="hs-identifier hs-var">mkTyConAppCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682564314"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564315"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">([KindCoercion] -&gt; KindCoercion)
-&gt; m [KindCoercion] -&gt; m KindCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">env -&gt; [KindCoercion] -&gt; m [KindCoercion]
</span><a href="#local-6989586621682564219"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564312"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682564316"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-993"></span><span>    </span><span class="annot"><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682564318"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564318"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllCo"><span class="hs-identifier hs-type">ForAllCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fco_tcv :: KindCoercion -&gt; TyVar
</span><a href="GHC.Core.TyCo.Rep.html#fco_tcv"><span class="hs-identifier hs-var">fco_tcv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564319"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564319"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_visL :: KindCoercion -&gt; ForAllTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#fco_visL"><span class="hs-identifier hs-var">fco_visL</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564320"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682564320"><span class="hs-identifier hs-var">visL</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_visR :: KindCoercion -&gt; ForAllTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#fco_visR"><span class="hs-identifier hs-var">fco_visR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564321"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682564321"><span class="hs-identifier hs-var">visR</span></a></span></span><span>
</span><span id="line-994"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_kind :: KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_kind"><span class="hs-identifier hs-var">fco_kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564322"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564322"><span class="hs-identifier hs-var">kind_co</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_body :: KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_body"><span class="hs-identifier hs-var">fco_body</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564323"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564323"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-995"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682564324"><span class="annot"><a href="#local-6989586621682564324"><span class="hs-identifier hs-var">kind_co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564318"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564322"><span class="hs-identifier hs-var">kind_co</span></a></span><span>
</span><span id="line-996"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="#local-6989586621682564212"><span class="hs-identifier hs-type">tycobinder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564318"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564319"><span class="hs-identifier hs-type">tv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564320"><span class="hs-identifier hs-type">visL</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682564325"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564325"><span class="hs-identifier hs-var">env'</span></a></span></span><span> </span><span id="local-6989586621682564326"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564326"><span class="hs-identifier hs-var">tv'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-997"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682564327"><span class="annot"><a href="#local-6989586621682564327"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">env -&gt; KindCoercion -&gt; m KindCoercion
</span><a href="#local-6989586621682564218"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621682564325"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564323"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-998"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkForAllCo"><span class="hs-identifier hs-type">mkForAllCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564326"><span class="hs-identifier hs-type">tv'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564320"><span class="hs-identifier hs-type">visL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564321"><span class="hs-identifier hs-type">visR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564324"><span class="hs-identifier hs-type">kind_co'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682564327"><span class="hs-identifier hs-type">co'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-999"></span><span>        </span><span class="hs-comment">-- See Note [Efficiency for ForAllCo case of mapTyCoX]</span><span>
</span><span id="line-1000"></span><span>
</span><span id="line-1001"></span><span>
</span><span id="line-1002"></span><span class="hs-comment">{- Note [Use explicit recursion in mapTyCo]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We use explicit recursion in `mapTyCo`, rather than calling, say, `strictFoldDVarSet`,
for exactly the same reason as in Note [Use explicit recursion in foldTyCo] in
GHC.Core.TyCo.Rep. We are in a monadic context, and using too-clever higher order
functions makes the strictness analyser produce worse results.

We could probably use `foldr`, since it is inlined bodily, fairly early; but
I'm doing the simple thing and inlining it by hand.

See !12037 for performance glitches caused by using `strictFoldDVarSet` (which is
definitely not inlined bodily).
-}</span><span>
</span><span id="line-1015"></span><span>
</span><span id="line-1016"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                      TyVarTy
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-1021"></span><span>
</span><span id="line-1022"></span><span class="hs-comment">-- | Attempts to obtain the type variable underlying a 'Type', and panics with the</span><span>
</span><span id="line-1023"></span><span class="hs-comment">-- given message if this is not a type variable type. See also 'getTyVar_maybe'</span><span>
</span><span id="line-1024"></span><span class="annot"><a href="GHC.Core.Type.html#getTyVar"><span class="hs-identifier hs-type">getTyVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span>
</span><span id="line-1025"></span><span id="getTyVar"><span class="annot"><span class="annottext">getTyVar :: HasDebugCallStack =&gt; Type -&gt; TyVar
</span><a href="GHC.Core.Type.html#getTyVar"><span class="hs-identifier hs-var hs-var">getTyVar</span></a></span></span><span> </span><span id="local-6989586621682564332"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564332"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyVar
</span><a href="GHC.Core.Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564332"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1026"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564333"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564333"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564333"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1027"></span><span>                    </span><span class="annot"><span class="annottext">Maybe TyVar
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TyVar
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getTyVar&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564332"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1028"></span><span>
</span><span id="line-1029"></span><span class="annot"><span class="hs-comment">-- | Attempts to obtain the type variable underlying a 'Type'</span></span><span>
</span><span id="line-1030"></span><span class="annot"><a href="GHC.Core.Type.html#getTyVar_maybe"><span class="hs-identifier hs-type">getTyVar_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span>
</span><span id="line-1031"></span><span id="getTyVar_maybe"><span class="annot"><span class="annottext">getTyVar_maybe :: Type -&gt; Maybe TyVar
</span><a href="GHC.Core.Type.html#getTyVar_maybe"><span class="hs-identifier hs-var hs-var">getTyVar_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyVar
</span><a href="GHC.Core.Type.html#repGetTyVar_maybe"><span class="hs-identifier hs-var">repGetTyVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe TyVar) -&gt; (Type -&gt; Type) -&gt; Type -&gt; Maybe TyVar
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span>
</span><span id="line-1032"></span><span>
</span><span id="line-1033"></span><span class="hs-comment">-- | Attempts to obtain the type variable underlying a 'Type', without</span><span>
</span><span id="line-1034"></span><span class="hs-comment">-- any expansion</span><span>
</span><span id="line-1035"></span><span class="annot"><a href="GHC.Core.Type.html#repGetTyVar_maybe"><span class="hs-identifier hs-type">repGetTyVar_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span>
</span><span id="line-1036"></span><span id="repGetTyVar_maybe"><span class="annot"><span class="annottext">repGetTyVar_maybe :: Type -&gt; Maybe TyVar
</span><a href="GHC.Core.Type.html#repGetTyVar_maybe"><span class="hs-identifier hs-var hs-var">repGetTyVar_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682564334"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564334"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Maybe TyVar
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564334"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1037"></span><span class="annot"><a href="GHC.Core.Type.html#repGetTyVar_maybe"><span class="hs-identifier hs-var">repGetTyVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TyVar
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1038"></span><span>
</span><span id="line-1039"></span><span class="annot"><a href="GHC.Core.Type.html#isTyVarTy"><span class="hs-identifier hs-type">isTyVarTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1040"></span><span id="isTyVarTy"><span class="annot"><span class="annottext">isTyVarTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTyVarTy"><span class="hs-identifier hs-var hs-var">isTyVarTy</span></a></span></span><span> </span><span id="local-6989586621682564335"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564335"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TyVar -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Maybe TyVar
</span><a href="GHC.Core.Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564335"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1041"></span><span>
</span><span id="line-1042"></span><span class="hs-comment">-- | If the type is a tyvar, possibly under a cast, returns it, along</span><span>
</span><span id="line-1043"></span><span class="hs-comment">-- with the coercion. Thus, the co is :: kind tv ~N kind ty</span><span>
</span><span id="line-1044"></span><span class="annot"><a href="GHC.Core.Type.html#getCastedTyVar_maybe"><span class="hs-identifier hs-type">getCastedTyVar_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionN"><span class="hs-identifier hs-type">CoercionN</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1045"></span><span id="getCastedTyVar_maybe"><span class="annot"><span class="annottext">getCastedTyVar_maybe :: Type -&gt; Maybe (TyVar, KindCoercion)
</span><a href="GHC.Core.Type.html#getCastedTyVar_maybe"><span class="hs-identifier hs-var hs-var">getCastedTyVar_maybe</span></a></span></span><span> </span><span id="local-6989586621682564337"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564337"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564337"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1046"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682564338"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564338"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564339"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564339"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TyVar, KindCoercion) -&gt; Maybe (TyVar, KindCoercion)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564338"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564339"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1047"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682564340"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564340"><span class="hs-identifier hs-var">tv</span></a></span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TyVar, KindCoercion) -&gt; Maybe (TyVar, KindCoercion)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564340"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Role -&gt; Type -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkReflCo"><span class="hs-identifier hs-var">mkReflCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564340"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1048"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (TyVar, KindCoercion)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1049"></span><span>
</span><span id="line-1050"></span><span>
</span><span id="line-1051"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                      AppTy
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-1056"></span><span>
</span><span id="line-1057"></span><span class="hs-comment">{- We need to be pretty careful with AppTy to make sure we obey the
invariant that a TyConApp is always visibly so.  mkAppTy maintains the
invariant: use it.

Note [Decomposing fat arrow c=&gt;t]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Can we unify (a b) with (Eq a =&gt; ty)?   If we do so, we end up with
a partial application like ((=&gt;) (Eq a)) which doesn't make sense in
source Haskell.  In contrast, we *can* unify (a b) with (t1 -&gt; t2).
Here's an example (#9858) of how you might do it:
   i :: (Typeable a, Typeable b) =&gt; Proxy (a b) -&gt; TypeRep
   i p = typeRep p

   j = i (Proxy :: Proxy (Eq Int =&gt; Int))
The type (Proxy (Eq Int =&gt; Int)) is only accepted with -XImpredicativeTypes,
but suppose we want that.  But then in the call to 'i', we end
up decomposing (Eq Int =&gt; Int), and we definitely don't want that.

We are willing to split (t1 -=&gt; t2) because the argument is still of
kind Type, not Constraint.  So the criterion is isVisibleFunArg.

In Core there is no real reason to avoid such decomposition.  But for now I've
put the test in splitAppTyNoView_maybe, which applies throughout, because the
other calls to splitAppTy are in GHC.Core.Unify, which is also used by the
type checker (e.g. when matching type-function equations).
-}</span><span>
</span><span id="line-1083"></span><span>
</span><span id="line-1084"></span><span class="annot"><span class="hs-comment">-- | Applies a type to another, as in e.g. @k a@</span></span><span>
</span><span id="line-1085"></span><span class="annot"><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier hs-type">mkAppTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1086"></span><span>  </span><span class="hs-comment">-- See Note [Respecting definitional equality], invariant (EQ1).</span><span>
</span><span id="line-1087"></span><span id="mkAppTy"><span class="annot"><span class="annottext">mkAppTy :: Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier hs-var hs-var">mkAppTy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682564342"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564342"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span> </span><span id="local-6989586621682564343"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564343"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564344"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564344"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span>
</span><span id="line-1088"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span id="local-6989586621682564345"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564345"><span class="hs-identifier hs-var">arg_co</span></a></span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564346"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564346"><span class="hs-identifier hs-var">res_co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt;
KindCoercion
-&gt; Pair Type -&gt; [Type] -&gt; ([KindCoercion], KindCoercion)
KindCoercion
-&gt; Pair Type -&gt; [Type] -&gt; ([KindCoercion], KindCoercion)
</span><a href="GHC.Core.Coercion.html#decomposePiCos"><span class="hs-identifier hs-var">decomposePiCos</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564343"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; KindCoercion -&gt; Pair Type
KindCoercion -&gt; Pair Type
</span><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier hs-var">coercionKind</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564343"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564344"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1089"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564342"><span class="hs-identifier hs-var">fun_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-operator hs-var">`mkAppTy`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564344"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-operator hs-var">`mkCastTy`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564345"><span class="hs-identifier hs-var">arg_co</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-operator hs-var">`mkCastTy`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564346"><span class="hs-identifier hs-var">res_co</span></a></span><span>
</span><span id="line-1090"></span><span>
</span><span id="line-1091"></span><span class="annot"><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564347"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564347"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682564348"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564348"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564349"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564349"><span class="hs-identifier hs-var">ty2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564347"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564348"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564349"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1092"></span><span class="annot"><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a></span><span> </span><span id="local-6989586621682564350"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564350"><span class="hs-identifier hs-var">ty1</span></a></span></span><span>               </span><span id="local-6989586621682564351"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564351"><span class="hs-identifier hs-var">ty2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564350"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564351"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1093"></span><span>        </span><span class="hs-comment">-- Note that the TyConApp could be an</span><span>
</span><span id="line-1094"></span><span>        </span><span class="hs-comment">-- under-saturated type synonym.  GHC allows that; e.g.</span><span>
</span><span id="line-1095"></span><span>        </span><span class="hs-comment">--      type Foo k = k a -&gt; k a</span><span>
</span><span id="line-1096"></span><span>        </span><span class="hs-comment">--      type Id x = x</span><span>
</span><span id="line-1097"></span><span>        </span><span class="hs-comment">--      foo :: Foo Id -&gt; Foo Id</span><span>
</span><span id="line-1098"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-1099"></span><span>        </span><span class="hs-comment">-- Here Id is partially applied in the type sig for Foo,</span><span>
</span><span id="line-1100"></span><span>        </span><span class="hs-comment">-- but once the type synonyms are expanded all is well</span><span>
</span><span id="line-1101"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-1102"></span><span>        </span><span class="hs-comment">-- Moreover in GHC.Tc.Types.tcInferTyApps we build up a type</span><span>
</span><span id="line-1103"></span><span>        </span><span class="hs-comment">--   (T t1 t2 t3) one argument at a type, thus forming</span><span>
</span><span id="line-1104"></span><span>        </span><span class="hs-comment">--   (T t1), (T t1 t2), etc</span><span>
</span><span id="line-1105"></span><span>
</span><span id="line-1106"></span><span class="annot"><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-type">mkAppTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1107"></span><span id="mkAppTys"><span class="annot"><span class="annottext">mkAppTys :: Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var hs-var">mkAppTys</span></a></span></span><span> </span><span id="local-6989586621682564352"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564352"><span class="hs-identifier hs-var">ty1</span></a></span></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564352"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-1108"></span><span class="annot"><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682564353"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564353"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span> </span><span id="local-6989586621682564354"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564354"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564355"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564355"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span>  </span><span class="hs-comment">-- much more efficient then nested mkAppTy</span><span>
</span><span id="line-1109"></span><span>                                     </span><span class="hs-comment">-- Why do this? See (EQ1) of</span><span>
</span><span id="line-1110"></span><span>                                     </span><span class="hs-comment">-- Note [Respecting definitional equality]</span><span>
</span><span id="line-1111"></span><span>                                     </span><span class="hs-comment">-- in GHC.Core.TyCo.Rep</span><span>
</span><span id="line-1112"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564353"><span class="hs-identifier hs-var">fun_ty</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564357"><span class="hs-identifier hs-var">casted_arg_tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-operator hs-var">`mkCastTy`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564358"><span class="hs-identifier hs-var">res_co</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564359"><span class="hs-identifier hs-var">leftovers</span></a></span><span>
</span><span id="line-1113"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1114"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682564360"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682564360"><span class="hs-identifier hs-var">arg_cos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564358"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564358"><span class="hs-identifier hs-var">res_co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt;
KindCoercion
-&gt; Pair Type -&gt; [Type] -&gt; ([KindCoercion], KindCoercion)
KindCoercion
-&gt; Pair Type -&gt; [Type] -&gt; ([KindCoercion], KindCoercion)
</span><a href="GHC.Core.Coercion.html#decomposePiCos"><span class="hs-identifier hs-var">decomposePiCos</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564354"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; KindCoercion -&gt; Pair Type
KindCoercion -&gt; Pair Type
</span><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier hs-var">coercionKind</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564354"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564355"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-1115"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682564361"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564361"><span class="hs-identifier hs-var">args_to_cast</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564359"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564359"><span class="hs-identifier hs-var">leftovers</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[KindCoercion] -&gt; [Type] -&gt; ([Type], [Type])
forall b a. [b] -&gt; [a] -&gt; ([a], [a])
</span><a href="GHC.Utils.Misc.html#splitAtList"><span class="hs-identifier hs-var">splitAtList</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682564360"><span class="hs-identifier hs-var">arg_cos</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564355"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-1116"></span><span>    </span><span id="local-6989586621682564357"><span class="annot"><span class="annottext">casted_arg_tys :: [Type]
</span><a href="#local-6989586621682564357"><span class="hs-identifier hs-var hs-var">casted_arg_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; KindCoercion -&gt; Type)
-&gt; [Type] -&gt; [KindCoercion] -&gt; [Type]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564361"><span class="hs-identifier hs-var">args_to_cast</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682564360"><span class="hs-identifier hs-var">arg_cos</span></a></span><span>
</span><span id="line-1117"></span><span class="annot"><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564364"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564364"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682564365"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564365"><span class="hs-identifier hs-var">tys1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564366"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564366"><span class="hs-identifier hs-var">tys2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564364"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564365"><span class="hs-identifier hs-var">tys1</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564366"><span class="hs-identifier hs-var">tys2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1118"></span><span class="annot"><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a></span><span> </span><span id="local-6989586621682564367"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564367"><span class="hs-identifier hs-var">ty1</span></a></span></span><span>                </span><span id="local-6989586621682564368"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564368"><span class="hs-identifier hs-var">tys2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564367"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564368"><span class="hs-identifier hs-var">tys2</span></a></span><span>
</span><span id="line-1119"></span><span>
</span><span id="line-1120"></span><span class="hs-comment">-------------</span><span>
</span><span id="line-1121"></span><span class="annot"><a href="GHC.Core.Type.html#splitAppTy_maybe"><span class="hs-identifier hs-type">splitAppTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1122"></span><span class="hs-comment">-- ^ Attempt to take a type application apart, whether it is a</span><span>
</span><span id="line-1123"></span><span class="hs-comment">-- function, type constructor, or plain type application. Note</span><span>
</span><span id="line-1124"></span><span class="hs-comment">-- that type family applications are NEVER unsaturated by this!</span><span>
</span><span id="line-1125"></span><span id="splitAppTy_maybe"><span class="annot"><span class="annottext">splitAppTy_maybe :: Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Core.Type.html#splitAppTy_maybe"><span class="hs-identifier hs-var hs-var">splitAppTy_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (Type, Type)
Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Core.Type.html#splitAppTyNoView_maybe"><span class="hs-identifier hs-var">splitAppTyNoView_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe (Type, Type))
-&gt; (Type -&gt; Type) -&gt; Type -&gt; Maybe (Type, Type)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span>
</span><span id="line-1126"></span><span>
</span><span id="line-1127"></span><span class="annot"><a href="GHC.Core.Type.html#splitAppTy"><span class="hs-identifier hs-type">splitAppTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1128"></span><span class="hs-comment">-- ^ Attempts to take a type application apart, as in 'splitAppTy_maybe',</span><span>
</span><span id="line-1129"></span><span class="hs-comment">-- and panics if this is not possible</span><span>
</span><span id="line-1130"></span><span id="splitAppTy"><span class="annot"><span class="annottext">splitAppTy :: Type -&gt; (Type, Type)
</span><a href="GHC.Core.Type.html#splitAppTy"><span class="hs-identifier hs-var hs-var">splitAppTy</span></a></span></span><span> </span><span id="local-6989586621682564369"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564369"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Core.Type.html#splitAppTy_maybe"><span class="hs-identifier hs-var">splitAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564369"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Type, Type) -&gt; (Type, Type) -&gt; (Type, Type)
forall a. Maybe a -&gt; a -&gt; a
</span><a href="GHC.Data.Maybe.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; (Type, Type)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitAppTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564369"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1131"></span><span>
</span><span id="line-1132"></span><span class="hs-comment">-------------</span><span>
</span><span id="line-1133"></span><span class="annot"><a href="GHC.Core.Type.html#splitAppTyNoView_maybe"><span class="hs-identifier hs-type">splitAppTyNoView_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1134"></span><span class="hs-comment">-- ^ Does the AppTy split as in 'splitAppTy_maybe', but assumes that</span><span>
</span><span id="line-1135"></span><span class="hs-comment">-- any coreView stuff is already done</span><span>
</span><span id="line-1136"></span><span id="splitAppTyNoView_maybe"><span class="annot"><span class="annottext">splitAppTyNoView_maybe :: HasDebugCallStack =&gt; Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Core.Type.html#splitAppTyNoView_maybe"><span class="hs-identifier hs-var hs-var">splitAppTyNoView_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682564371"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564371"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621682564372"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564372"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1137"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type, Type) -&gt; Maybe (Type, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564371"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564372"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1138"></span><span>
</span><span id="line-1139"></span><span class="annot"><a href="GHC.Core.Type.html#splitAppTyNoView_maybe"><span class="hs-identifier hs-var">splitAppTyNoView_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span id="local-6989586621682564373"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564373"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span id="local-6989586621682564374"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564374"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682564375"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564375"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621682564376"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564376"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1140"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564377"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564377"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564378"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564378"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Type -&gt; Type -&gt; Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#funTyConAppTy_maybe"><span class="hs-identifier hs-var">funTyConAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564373"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564374"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564375"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564376"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1141"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564379"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564379"><span class="hs-identifier hs-var">tys'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564380"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564380"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Maybe ([Type], Type)
forall a. [a] -&gt; Maybe ([a], a)
</span><a href="GHC.Utils.Misc.html#snocView"><span class="hs-identifier hs-var">snocView</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564378"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1142"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type, Type) -&gt; Maybe (Type, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564377"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564379"><span class="hs-identifier hs-var">tys'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564380"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1143"></span><span>
</span><span id="line-1144"></span><span class="annot"><a href="GHC.Core.Type.html#splitAppTyNoView_maybe"><span class="hs-identifier hs-var">splitAppTyNoView_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564382"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564382"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682564383"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564383"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1145"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#tyConMustBeSaturated"><span class="hs-identifier hs-var">tyConMustBeSaturated</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564382"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564383"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Arity -&gt; Bool
forall a. [a] -&gt; Arity -&gt; Bool
</span><a href="GHC.Utils.Misc.html#lengthExceeds"><span class="hs-operator hs-var">`lengthExceeds`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Arity
</span><a href="GHC.Core.TyCon.html#tyConArity"><span class="hs-identifier hs-var">tyConArity</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564382"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1146"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564386"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564386"><span class="hs-identifier hs-var">tys'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564387"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564387"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Maybe ([Type], Type)
forall a. [a] -&gt; Maybe ([a], a)
</span><a href="GHC.Utils.Misc.html#snocView"><span class="hs-identifier hs-var">snocView</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564383"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1147"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type, Type) -&gt; Maybe (Type, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564382"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564386"><span class="hs-identifier hs-var">tys'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564387"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Never create unsaturated type family apps!</span><span>
</span><span id="line-1148"></span><span>
</span><span id="line-1149"></span><span class="annot"><a href="GHC.Core.Type.html#splitAppTyNoView_maybe"><span class="hs-identifier hs-var">splitAppTyNoView_maybe</span></a></span><span> </span><span id="local-6989586621682564388"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564388"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Type, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1150"></span><span>
</span><span id="line-1151"></span><span class="annot"><a href="GHC.Core.Type.html#tcSplitAppTyNoView_maybe"><span class="hs-identifier hs-type">tcSplitAppTyNoView_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1152"></span><span class="hs-comment">-- ^ Just like splitAppTyNoView_maybe, but does not split (c =&gt; t)</span><span>
</span><span id="line-1153"></span><span class="hs-comment">-- See Note [Decomposing fat arrow c=&gt;t]</span><span>
</span><span id="line-1154"></span><span id="tcSplitAppTyNoView_maybe"><span class="annot"><span class="annottext">tcSplitAppTyNoView_maybe :: Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Core.Type.html#tcSplitAppTyNoView_maybe"><span class="hs-identifier hs-var hs-var">tcSplitAppTyNoView_maybe</span></a></span></span><span> </span><span id="local-6989586621682564389"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564389"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1155"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564391"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564391"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564389"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1156"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunTyFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isVisibleFunArg"><span class="hs-identifier hs-var">isVisibleFunArg</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564391"><span class="hs-identifier hs-var">af</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- See Note [Decomposing fat arrow c=&gt;t]</span><span>
</span><span id="line-1157"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Type, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1158"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1159"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (Type, Type)
Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Core.Type.html#splitAppTyNoView_maybe"><span class="hs-identifier hs-var">splitAppTyNoView_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564389"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1160"></span><span>
</span><span id="line-1161"></span><span class="hs-comment">-------------</span><span>
</span><span id="line-1162"></span><span class="annot"><a href="GHC.Core.Type.html#splitAppTys"><span class="hs-identifier hs-type">splitAppTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1163"></span><span class="hs-comment">-- ^ Recursively splits a type as far as is possible, leaving a residual</span><span>
</span><span id="line-1164"></span><span class="hs-comment">-- type being applied to and the type arguments applied to it. Never fails,</span><span>
</span><span id="line-1165"></span><span class="hs-comment">-- even if that means returning an empty list of type applications.</span><span>
</span><span id="line-1166"></span><span id="splitAppTys"><span class="annot"><span class="annottext">splitAppTys :: HasDebugCallStack =&gt; Type -&gt; (Type, [Type])
</span><a href="GHC.Core.Type.html#splitAppTys"><span class="hs-identifier hs-var hs-var">splitAppTys</span></a></span></span><span> </span><span id="local-6989586621682564394"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564394"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621682564395"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564394"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564394"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1167"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1168"></span><span>    </span><span id="local-6989586621682564395"><span class="annot"><span class="annottext">split :: Type -&gt; Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621682564395"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621682564400"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564400"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621682564401"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564401"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564402"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564402"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564403"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564403"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564401"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621682564395"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564400"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564403"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564402"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1169"></span><span>    </span><span class="annot"><a href="#local-6989586621682564395"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682564404"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564404"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564405"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564405"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>        </span><span id="local-6989586621682564406"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564406"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621682564395"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564404"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564404"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564405"><span class="hs-identifier hs-var">arg</span></a></span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564406"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1170"></span><span>    </span><span class="annot"><a href="#local-6989586621682564395"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564407"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564407"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682564408"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564408"><span class="hs-identifier hs-var">tc_args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564409"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564409"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-1171"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- keep type families saturated</span><span>
</span><span id="line-1172"></span><span>            </span><span id="local-6989586621682564410"><span class="annot"><span class="annottext">n :: Arity
</span><a href="#local-6989586621682564410"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#tyConMustBeSaturated"><span class="hs-identifier hs-var">tyConMustBeSaturated</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564407"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Arity
</span><a href="GHC.Core.TyCon.html#tyConArity"><span class="hs-identifier hs-var">tyConArity</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564407"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1173"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arity
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1174"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682564411"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564411"><span class="hs-identifier hs-var">tc_args1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564412"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564412"><span class="hs-identifier hs-var">tc_args2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arity -&gt; [Type] -&gt; ([Type], [Type])
forall a. Arity -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621682564410"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564408"><span class="hs-identifier hs-var">tc_args</span></a></span><span>
</span><span id="line-1175"></span><span>        </span><span class="hs-keyword">in</span><span>
</span><span id="line-1176"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564407"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564411"><span class="hs-identifier hs-var">tc_args1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564412"><span class="hs-identifier hs-var">tc_args2</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564409"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1177"></span><span>    </span><span class="annot"><a href="#local-6989586621682564395"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span id="local-6989586621682564414"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564414"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span id="local-6989586621682564415"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564415"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682564416"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564416"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621682564417"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564417"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564418"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564418"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-1178"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564419"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564419"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682564420"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564420"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Type -&gt; Type -&gt; Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#funTyConAppTy_maybe"><span class="hs-identifier hs-var">funTyConAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564414"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564415"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564416"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564417"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1179"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Type, [Type]) -&gt; (Type, [Type])
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564418"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1180"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564419"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564420"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1181"></span><span>
</span><span id="line-1182"></span><span>    </span><span class="annot"><a href="#local-6989586621682564395"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564421"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564421"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682564422"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564422"><span class="hs-identifier hs-var">args</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564421"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564422"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1183"></span><span>
</span><span id="line-1184"></span><span class="annot"><span class="hs-comment">-- | Like 'splitAppTys', but doesn't look through type synonyms</span></span><span>
</span><span id="line-1185"></span><span class="annot"><a href="GHC.Core.Type.html#splitAppTysNoView"><span class="hs-identifier hs-type">splitAppTysNoView</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1186"></span><span id="splitAppTysNoView"><span class="annot"><span class="annottext">splitAppTysNoView :: HasDebugCallStack =&gt; Type -&gt; (Type, [Type])
</span><a href="GHC.Core.Type.html#splitAppTysNoView"><span class="hs-identifier hs-var hs-var">splitAppTysNoView</span></a></span></span><span> </span><span id="local-6989586621682564424"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564424"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621682564425"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564424"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1187"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1188"></span><span>    </span><span id="local-6989586621682564425"><span class="annot"><span class="annottext">split :: Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621682564425"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682564430"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564430"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564431"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564431"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564432"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564432"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621682564425"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564430"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564431"><span class="hs-identifier hs-var">arg</span></a></span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564432"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1189"></span><span>    </span><span class="annot"><a href="#local-6989586621682564425"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564433"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564433"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682564434"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564434"><span class="hs-identifier hs-var">tc_args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564435"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564435"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-1190"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682564436"><span class="annot"><span class="annottext">n :: Arity
</span><a href="#local-6989586621682564436"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#tyConMustBeSaturated"><span class="hs-identifier hs-var">tyConMustBeSaturated</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564433"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Arity
</span><a href="GHC.Core.TyCon.html#tyConArity"><span class="hs-identifier hs-var">tyConArity</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564433"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1191"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arity
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1192"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682564437"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564437"><span class="hs-identifier hs-var">tc_args1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564438"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564438"><span class="hs-identifier hs-var">tc_args2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arity -&gt; [Type] -&gt; ([Type], [Type])
forall a. Arity -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621682564436"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564434"><span class="hs-identifier hs-var">tc_args</span></a></span><span>
</span><span id="line-1193"></span><span>        </span><span class="hs-keyword">in</span><span>
</span><span id="line-1194"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564433"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564437"><span class="hs-identifier hs-var">tc_args1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564438"><span class="hs-identifier hs-var">tc_args2</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564435"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1195"></span><span>    </span><span class="annot"><a href="#local-6989586621682564425"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span id="local-6989586621682564439"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564439"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span id="local-6989586621682564440"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564440"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682564441"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564441"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621682564442"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564442"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564443"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564443"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-1196"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564444"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564444"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564445"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564445"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Type -&gt; Type -&gt; Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#funTyConAppTy_maybe"><span class="hs-identifier hs-var">funTyConAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564439"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564440"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564441"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564442"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1197"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Type, [Type]) -&gt; (Type, [Type])
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564443"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1198"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564444"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564445"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1199"></span><span>
</span><span id="line-1200"></span><span>    </span><span class="annot"><a href="#local-6989586621682564425"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564446"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564446"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564447"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564447"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564446"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564447"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1201"></span><span>
</span><span id="line-1202"></span><span>
</span><span id="line-1203"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                      LitTy
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-1208"></span><span>
</span><span id="line-1209"></span><span class="annot"><a href="GHC.Core.Type.html#mkNumLitTy"><span class="hs-identifier hs-type">mkNumLitTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1210"></span><span id="mkNumLitTy"><span class="annot"><span class="annottext">mkNumLitTy :: Integer -&gt; Type
</span><a href="GHC.Core.Type.html#mkNumLitTy"><span class="hs-identifier hs-var hs-var">mkNumLitTy</span></a></span></span><span> </span><span id="local-6989586621682564448"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682564448"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; TyLit
</span><a href="GHC.Core.TyCo.Rep.html#NumTyLit"><span class="hs-identifier hs-var">NumTyLit</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682564448"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1211"></span><span>
</span><span id="line-1212"></span><span class="annot"><span class="hs-comment">-- | Is this a numeric literal. We also look through type synonyms.</span></span><span>
</span><span id="line-1213"></span><span class="annot"><a href="GHC.Core.Type.html#isNumLitTy"><span class="hs-identifier hs-type">isNumLitTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-1214"></span><span id="isNumLitTy"><span class="annot"><span class="annottext">isNumLitTy :: Type -&gt; Maybe Integer
</span><a href="GHC.Core.Type.html#isNumLitTy"><span class="hs-identifier hs-var hs-var">isNumLitTy</span></a></span></span><span> </span><span id="local-6989586621682564450"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564450"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1215"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#NumTyLit"><span class="hs-identifier hs-type">NumTyLit</span></a></span><span> </span><span id="local-6989586621682564451"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682564451"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564450"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682564451"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1216"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Integer
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1217"></span><span>
</span><span id="line-1218"></span><span class="annot"><a href="GHC.Core.Type.html#mkStrLitTy"><span class="hs-identifier hs-type">mkStrLitTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1219"></span><span id="mkStrLitTy"><span class="annot"><span class="annottext">mkStrLitTy :: FastString -&gt; Type
</span><a href="GHC.Core.Type.html#mkStrLitTy"><span class="hs-identifier hs-var hs-var">mkStrLitTy</span></a></span></span><span> </span><span id="local-6989586621682564452"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682564452"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; TyLit
</span><a href="GHC.Core.TyCo.Rep.html#StrTyLit"><span class="hs-identifier hs-var">StrTyLit</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682564452"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1220"></span><span>
</span><span id="line-1221"></span><span class="annot"><span class="hs-comment">-- | Is this a symbol literal. We also look through type synonyms.</span></span><span>
</span><span id="line-1222"></span><span class="annot"><a href="GHC.Core.Type.html#isStrLitTy"><span class="hs-identifier hs-type">isStrLitTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>
</span><span id="line-1223"></span><span id="isStrLitTy"><span class="annot"><span class="annottext">isStrLitTy :: Type -&gt; Maybe FastString
</span><a href="GHC.Core.Type.html#isStrLitTy"><span class="hs-identifier hs-var hs-var">isStrLitTy</span></a></span></span><span> </span><span id="local-6989586621682564454"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564454"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1224"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#StrTyLit"><span class="hs-identifier hs-type">StrTyLit</span></a></span><span> </span><span id="local-6989586621682564455"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682564455"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564454"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Maybe FastString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682564455"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1225"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FastString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1226"></span><span>
</span><span id="line-1227"></span><span class="annot"><a href="GHC.Core.Type.html#mkCharLitTy"><span class="hs-identifier hs-type">mkCharLitTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1228"></span><span id="mkCharLitTy"><span class="annot"><span class="annottext">mkCharLitTy :: Char -&gt; Type
</span><a href="GHC.Core.Type.html#mkCharLitTy"><span class="hs-identifier hs-var hs-var">mkCharLitTy</span></a></span></span><span> </span><span id="local-6989586621682564456"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682564456"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; TyLit
</span><a href="GHC.Core.TyCo.Rep.html#CharTyLit"><span class="hs-identifier hs-var">CharTyLit</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682564456"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1229"></span><span>
</span><span id="line-1230"></span><span class="annot"><span class="hs-comment">-- | Is this a char literal? We also look through type synonyms.</span></span><span>
</span><span id="line-1231"></span><span class="annot"><a href="GHC.Core.Type.html#isCharLitTy"><span class="hs-identifier hs-type">isCharLitTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-1232"></span><span id="isCharLitTy"><span class="annot"><span class="annottext">isCharLitTy :: Type -&gt; Maybe Char
</span><a href="GHC.Core.Type.html#isCharLitTy"><span class="hs-identifier hs-var hs-var">isCharLitTy</span></a></span></span><span> </span><span id="local-6989586621682564458"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564458"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1233"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CharTyLit"><span class="hs-identifier hs-type">CharTyLit</span></a></span><span> </span><span id="local-6989586621682564459"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682564459"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564458"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Maybe Char
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682564459"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1234"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Char
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1235"></span><span>
</span><span id="line-1236"></span><span>
</span><span id="line-1237"></span><span class="annot"><span class="hs-comment">-- | Is this a type literal (symbol, numeric, or char)?</span></span><span>
</span><span id="line-1238"></span><span class="annot"><a href="GHC.Core.Type.html#isLitTy"><span class="hs-identifier hs-type">isLitTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyLit"><span class="hs-identifier hs-type">TyLit</span></a></span><span>
</span><span id="line-1239"></span><span id="isLitTy"><span class="annot"><span class="annottext">isLitTy :: Type -&gt; Maybe TyLit
</span><a href="GHC.Core.Type.html#isLitTy"><span class="hs-identifier hs-var hs-var">isLitTy</span></a></span></span><span> </span><span id="local-6989586621682564460"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564460"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1240"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621682564461"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682564461"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564460"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Maybe TyLit
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682564461"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1241"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TyLit
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1242"></span><span>
</span><span id="line-1243"></span><span class="annot"><span class="hs-comment">-- | A type of kind 'ErrorMessage' (from the 'GHC.TypeError' module).</span></span><span>
</span><span id="line-1244"></span><span class="hs-keyword">type</span><span> </span><span id="ErrorMsgType"><span class="annot"><a href="GHC.Core.Type.html#ErrorMsgType"><span class="hs-identifier hs-var">ErrorMsgType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1245"></span><span>
</span><span id="line-1246"></span><span class="hs-comment">-- | Is this type a custom user error?</span><span>
</span><span id="line-1247"></span><span class="hs-comment">-- If so, give us the error message.</span><span>
</span><span id="line-1248"></span><span class="annot"><a href="GHC.Core.Type.html#userTypeError_maybe"><span class="hs-identifier hs-type">userTypeError_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.Type.html#ErrorMsgType"><span class="hs-identifier hs-type">ErrorMsgType</span></a></span><span>
</span><span id="line-1249"></span><span id="userTypeError_maybe"><span class="annot"><span class="annottext">userTypeError_maybe :: Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#userTypeError_maybe"><span class="hs-identifier hs-var hs-var">userTypeError_maybe</span></a></span></span><span> </span><span id="local-6989586621682564462"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564462"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1250"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564463"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564463"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564462"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#userTypeError_maybe"><span class="hs-identifier hs-var">userTypeError_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564463"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1251"></span><span class="annot"><a href="GHC.Core.Type.html#userTypeError_maybe"><span class="hs-identifier hs-var">userTypeError_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564464"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564464"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564465"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564465"><span class="hs-identifier hs-var">_kind</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682564466"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564466"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1252"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564464"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#errorMessageTypeErrorFamName"><span class="hs-identifier hs-var">errorMessageTypeErrorFamName</span></a></span><span>
</span><span id="line-1253"></span><span>          </span><span class="hs-comment">-- There may be more than 2 arguments, if the type error is</span><span>
</span><span id="line-1254"></span><span>          </span><span class="hs-comment">-- used as a type constructor (e.g. at kind `Type -&gt; Type`).</span><span>
</span><span id="line-1255"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564466"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-1256"></span><span class="annot"><a href="GHC.Core.Type.html#userTypeError_maybe"><span class="hs-identifier hs-var">userTypeError_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-1257"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1258"></span><span>
</span><span id="line-1259"></span><span class="annot"><a href="GHC.Core.Type.html#deepUserTypeError_maybe"><span class="hs-identifier hs-type">deepUserTypeError_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.Type.html#ErrorMsgType"><span class="hs-identifier hs-type">ErrorMsgType</span></a></span><span>
</span><span id="line-1260"></span><span class="hs-comment">-- Look for custom user error, deeply inside the type</span><span>
</span><span id="line-1261"></span><span id="deepUserTypeError_maybe"><span class="annot"><span class="annottext">deepUserTypeError_maybe :: Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#deepUserTypeError_maybe"><span class="hs-identifier hs-var hs-var">deepUserTypeError_maybe</span></a></span></span><span> </span><span id="local-6989586621682564469"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564469"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1262"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564470"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564470"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564469"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#userTypeError_maybe"><span class="hs-identifier hs-var">userTypeError_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564470"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1263"></span><span class="annot"><a href="GHC.Core.Type.html#deepUserTypeError_maybe"><span class="hs-identifier hs-var">deepUserTypeError_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564471"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564471"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682564472"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564472"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1264"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564471"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#errorMessageTypeErrorFamName"><span class="hs-identifier hs-var">errorMessageTypeErrorFamName</span></a></span><span>
</span><span id="line-1265"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564473"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564473"><span class="hs-identifier hs-var">_kind</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682564474"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564474"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564472"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1266"></span><span>          </span><span class="hs-comment">-- There may be more than 2 arguments, if the type error is</span><span>
</span><span id="line-1267"></span><span>          </span><span class="hs-comment">-- used as a type constructor (e.g. at kind `Type -&gt; Type`).</span><span>
</span><span id="line-1268"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564474"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-1269"></span><span>
</span><span id="line-1270"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#tyConMustBeSaturated"><span class="hs-identifier hs-var">tyConMustBeSaturated</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564471"><span class="hs-identifier hs-var">tc</span></a></span><span>  </span><span class="hs-comment">-- Don't go looking for user type errors</span><span>
</span><span id="line-1271"></span><span>                             </span><span class="hs-comment">-- inside type family arguments (see #20241).</span><span>
</span><span id="line-1272"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe Type -&gt; Maybe Type)
-&gt; Maybe Type -&gt; [Type] -&gt; Maybe Type
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Type -&gt; Maybe Type -&gt; Maybe Type
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="GHC.Data.Maybe.html#firstJust"><span class="hs-identifier hs-var">firstJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Type -&gt; Maybe Type -&gt; Maybe Type)
-&gt; (Type -&gt; Maybe Type) -&gt; Type -&gt; Maybe Type -&gt; Maybe Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#deepUserTypeError_maybe"><span class="hs-identifier hs-var">deepUserTypeError_maybe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arity -&gt; [Type] -&gt; [Type]
forall a. Arity -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Arity
</span><a href="GHC.Core.TyCon.html#tyConArity"><span class="hs-identifier hs-var">tyConArity</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564471"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564472"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1273"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1274"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe Type -&gt; Maybe Type)
-&gt; Maybe Type -&gt; [Type] -&gt; Maybe Type
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Type -&gt; Maybe Type -&gt; Maybe Type
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="GHC.Data.Maybe.html#firstJust"><span class="hs-identifier hs-var">firstJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Type -&gt; Maybe Type -&gt; Maybe Type)
-&gt; (Type -&gt; Maybe Type) -&gt; Type -&gt; Maybe Type -&gt; Maybe Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#deepUserTypeError_maybe"><span class="hs-identifier hs-var">deepUserTypeError_maybe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564472"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1275"></span><span class="annot"><a href="GHC.Core.Type.html#deepUserTypeError_maybe"><span class="hs-identifier hs-var">deepUserTypeError_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682564477"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564477"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#deepUserTypeError_maybe"><span class="hs-identifier hs-var">deepUserTypeError_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564477"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1276"></span><span class="annot"><a href="GHC.Core.Type.html#deepUserTypeError_maybe"><span class="hs-identifier hs-var">deepUserTypeError_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564478"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564478"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564479"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564479"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1277"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#deepUserTypeError_maybe"><span class="hs-identifier hs-var">deepUserTypeError_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564478"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type -&gt; Maybe Type -&gt; Maybe Type
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="GHC.Data.Maybe.html#firstJust"><span class="hs-operator hs-var">`firstJust`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#deepUserTypeError_maybe"><span class="hs-identifier hs-var">deepUserTypeError_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564479"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1278"></span><span class="annot"><a href="GHC.Core.Type.html#deepUserTypeError_maybe"><span class="hs-identifier hs-var">deepUserTypeError_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682564480"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564480"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682564481"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564481"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1279"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#deepUserTypeError_maybe"><span class="hs-identifier hs-var">deepUserTypeError_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564480"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type -&gt; Maybe Type -&gt; Maybe Type
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="GHC.Data.Maybe.html#firstJust"><span class="hs-operator hs-var">`firstJust`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#deepUserTypeError_maybe"><span class="hs-identifier hs-var">deepUserTypeError_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564481"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1280"></span><span class="annot"><a href="GHC.Core.Type.html#deepUserTypeError_maybe"><span class="hs-identifier hs-var">deepUserTypeError_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682564482"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564482"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1281"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#deepUserTypeError_maybe"><span class="hs-identifier hs-var">deepUserTypeError_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564482"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1282"></span><span class="annot"><a href="GHC.Core.Type.html#deepUserTypeError_maybe"><span class="hs-identifier hs-var">deepUserTypeError_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-comment">-- TyVarTy, CoercionTy, LitTy</span><span>
</span><span id="line-1283"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1284"></span><span>
</span><span id="line-1285"></span><span class="annot"><span class="hs-comment">-- | Render a type corresponding to a user type error into a SDoc.</span></span><span>
</span><span id="line-1286"></span><span class="annot"><a href="GHC.Core.Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-type">pprUserTypeErrorTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#ErrorMsgType"><span class="hs-identifier hs-type">ErrorMsgType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1287"></span><span id="pprUserTypeErrorTy"><span class="annot"><span class="annottext">pprUserTypeErrorTy :: Type -&gt; SDoc
</span><a href="GHC.Core.Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var hs-var">pprUserTypeErrorTy</span></a></span></span><span> </span><span id="local-6989586621682564483"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564483"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1288"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564483"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1289"></span><span>
</span><span id="line-1290"></span><span>    </span><span class="hs-comment">-- Text &quot;Something&quot;</span><span>
</span><span id="line-1291"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564484"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564484"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span id="local-6989586621682564485"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564485"><span class="hs-identifier hs-var">txt</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1292"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564484"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#typeErrorTextDataConName"><span class="hs-identifier hs-var">typeErrorTextDataConName</span></a></span><span>
</span><span id="line-1293"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564487"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682564487"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe FastString
</span><a href="GHC.Core.Type.html#isStrLitTy"><span class="hs-identifier hs-var">isStrLitTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564485"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; SDoc
forall doc. IsLine doc =&gt; FastString -&gt; doc
</span><a href="GHC.Utils.Outputable.html#ftext"><span class="hs-identifier hs-var">ftext</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682564487"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-1294"></span><span>
</span><span id="line-1295"></span><span>    </span><span class="hs-comment">-- ShowType t</span><span>
</span><span id="line-1296"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564489"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564489"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span id="local-6989586621682564490"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564490"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682564491"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564491"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1297"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564489"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#typeErrorShowTypeDataConName"><span class="hs-identifier hs-var">typeErrorShowTypeDataConName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564491"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1298"></span><span>
</span><span id="line-1299"></span><span>    </span><span class="hs-comment">-- t1 :&lt;&gt;: t2</span><span>
</span><span id="line-1300"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564493"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564493"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span id="local-6989586621682564494"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564494"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682564495"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564495"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1301"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564493"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#typeErrorAppendDataConName"><span class="hs-identifier hs-var">typeErrorAppendDataConName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1302"></span><span>        </span><span class="annot"><span class="annottext">Type -&gt; SDoc
</span><a href="GHC.Core.Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564494"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
</span><a href="GHC.Core.Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564495"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1303"></span><span>
</span><span id="line-1304"></span><span>    </span><span class="hs-comment">-- t1 :$$: t2</span><span>
</span><span id="line-1305"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564498"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564498"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span id="local-6989586621682564499"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564499"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682564500"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564500"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1306"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564498"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#typeErrorVAppendDataConName"><span class="hs-identifier hs-var">typeErrorVAppendDataConName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1307"></span><span>        </span><span class="annot"><span class="annottext">Type -&gt; SDoc
</span><a href="GHC.Core.Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564499"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
</span><a href="GHC.Core.Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564500"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1308"></span><span>
</span><span id="line-1309"></span><span>    </span><span class="hs-comment">-- An unevaluated type function</span><span>
</span><span id="line-1310"></span><span>    </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564483"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1311"></span><span>
</span><span id="line-1312"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                      FunTy
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-1317"></span><span>
</span><span id="line-1318"></span><span class="hs-comment">{- Note [Representation of function types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Functions (e.g. Int -&gt; Char) can be thought of as being applications
of funTyCon (known in Haskell surface syntax as (-&gt;)), (note that
`RuntimeRep' quantifiers are left inferred)

    (-&gt;) :: forall {r1 :: RuntimeRep} {r2 :: RuntimeRep}
                   (a :: TYPE r1) (b :: TYPE r2).
            a -&gt; b -&gt; Type

However, for efficiency's sake we represent saturated applications of (-&gt;)
with FunTy. For instance, the type,

    (-&gt;) r1 r2 a b

is equivalent to,

    FunTy (Anon a) b

Note how the RuntimeReps are implied in the FunTy representation. For this
reason we must be careful when reconstructing the TyConApp representation (see,
for instance, splitTyConApp_maybe).

In the compiler we maintain the invariant that all saturated applications of
(-&gt;) are represented with FunTy.

See #11714.
-}</span><span>
</span><span id="line-1346"></span><span>
</span><span id="line-1347"></span><span class="hs-comment">-----------------------------------------------</span><span>
</span><span id="line-1348"></span><span class="annot"><a href="GHC.Core.Type.html#funTyConAppTy_maybe"><span class="hs-identifier hs-type">funTyConAppTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#FunTyFlag"><span class="hs-identifier hs-type">FunTyFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1349"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1350"></span><span class="hs-comment">-- ^ Given the components of a FunTy</span><span>
</span><span id="line-1351"></span><span class="hs-comment">-- figure out the corresponding TyConApp.</span><span>
</span><span id="line-1352"></span><span id="funTyConAppTy_maybe"><span class="annot"><span class="annottext">funTyConAppTy_maybe :: FunTyFlag -&gt; Type -&gt; Type -&gt; Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#funTyConAppTy_maybe"><span class="hs-identifier hs-var hs-var">funTyConAppTy_maybe</span></a></span></span><span> </span><span id="local-6989586621682564502"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564502"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span id="local-6989586621682564503"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564503"><span class="hs-identifier hs-var">mult</span></a></span></span><span> </span><span id="local-6989586621682564504"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564504"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682564505"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564505"><span class="hs-identifier hs-var">res</span></a></span></span><span>
</span><span id="line-1353"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564506"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564506"><span class="hs-identifier hs-var">arg_rep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-var">getRuntimeRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564504"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1354"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564508"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564508"><span class="hs-identifier hs-var">res_rep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-var">getRuntimeRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564505"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1355"></span><span>  </span><span class="hs-comment">-- If you're changing the lines below, you'll probably want to adapt the</span><span>
</span><span id="line-1356"></span><span>  </span><span class="hs-comment">-- `fUNTyCon` case of GHC.Core.Unify.unify_ty correspondingly.</span><span>
</span><span id="line-1357"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682564509"><span class="annot"><span class="annottext">args :: [Type]
</span><a href="#local-6989586621682564509"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isFUNArg"><span class="hs-identifier hs-var">isFUNArg</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564502"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564503"><span class="hs-identifier hs-var">mult</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564506"><span class="hs-identifier hs-var">arg_rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564508"><span class="hs-identifier hs-var">res_rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564504"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564505"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1358"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span>      </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564506"><span class="hs-identifier hs-var">arg_rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564508"><span class="hs-identifier hs-var">res_rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564504"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564505"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1359"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyCon, [Type]) -&gt; Maybe (TyCon, [Type])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((TyCon, [Type]) -&gt; Maybe (TyCon, [Type]))
-&gt; (TyCon, [Type]) -&gt; Maybe (TyCon, [Type])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunTyFlag -&gt; TyCon
</span><a href="GHC.Builtin.Types.Prim.html#funTyFlagTyCon"><span class="hs-identifier hs-var">funTyFlagTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564502"><span class="hs-identifier hs-var">af</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564509"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1360"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1361"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1362"></span><span>
</span><span id="line-1363"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppFunTy_maybe"><span class="hs-identifier hs-type">tyConAppFunTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1364"></span><span class="annot"><span class="hs-comment">-- ^ Return Just if this TyConApp should be represented as a FunTy</span></span><span>
</span><span id="line-1365"></span><span id="tyConAppFunTy_maybe"><span class="annot"><span class="annottext">tyConAppFunTy_maybe :: HasDebugCallStack =&gt; TyCon -&gt; [Type] -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#tyConAppFunTy_maybe"><span class="hs-identifier hs-var hs-var">tyConAppFunTy_maybe</span></a></span></span><span> </span><span id="local-6989586621682564514"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564514"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682564515"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564515"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-1366"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564516"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564516"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564517"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564517"><span class="hs-identifier hs-var">mult</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564518"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564518"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564519"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564519"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TyCon -&gt; [Type] -&gt; Maybe (FunTyFlag, Type, Type, Type)
forall a.
(HasDebugCallStack, Outputable a) =&gt;
a -&gt; TyCon -&gt; [a] -&gt; Maybe (FunTyFlag, a, a, a)
</span><a href="GHC.Core.Type.html#ty_con_app_fun_maybe"><span class="hs-identifier hs-var">ty_con_app_fun_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#manyDataConTy"><span class="hs-identifier hs-var">manyDataConTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564514"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564515"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1367"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564516"><span class="hs-identifier hs-var">af</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564517"><span class="hs-identifier hs-var">mult</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564518"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564519"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1368"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1369"></span><span>
</span><span id="line-1370"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppFunCo_maybe"><span class="hs-identifier hs-type">tyConAppFunCo_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Role"><span class="hs-identifier hs-type">Role</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1371"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-1372"></span><span class="annot"><span class="hs-comment">-- ^ Return Just if this TyConAppCo should be represented as a FunCo</span></span><span>
</span><span id="line-1373"></span><span id="tyConAppFunCo_maybe"><span class="annot"><span class="annottext">tyConAppFunCo_maybe :: HasDebugCallStack =&gt;
Role -&gt; TyCon -&gt; [KindCoercion] -&gt; Maybe KindCoercion
</span><a href="GHC.Core.Type.html#tyConAppFunCo_maybe"><span class="hs-identifier hs-var hs-var">tyConAppFunCo_maybe</span></a></span></span><span> </span><span id="local-6989586621682564525"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682564525"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682564526"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564526"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682564527"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682564527"><span class="hs-identifier hs-var">cos</span></a></span></span><span>
</span><span id="line-1374"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564528"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564528"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564529"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564529"><span class="hs-identifier hs-var">mult</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564530"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564530"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564531"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564531"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">KindCoercion
-&gt; TyCon
-&gt; [KindCoercion]
-&gt; Maybe (FunTyFlag, KindCoercion, KindCoercion, KindCoercion)
forall a.
(HasDebugCallStack, Outputable a) =&gt;
a -&gt; TyCon -&gt; [a] -&gt; Maybe (FunTyFlag, a, a, a)
</span><a href="GHC.Core.Type.html#ty_con_app_fun_maybe"><span class="hs-identifier hs-var">ty_con_app_fun_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564532"><span class="hs-identifier hs-var">mult_refl</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564526"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621682564527"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-1375"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role
-&gt; FunTyFlag
-&gt; KindCoercion
-&gt; KindCoercion
-&gt; KindCoercion
-&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkFunCo"><span class="hs-identifier hs-var">mkFunCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682564525"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564528"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564529"><span class="hs-identifier hs-var">mult</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564530"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564531"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1376"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1377"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe KindCoercion
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1378"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1379"></span><span>    </span><span id="local-6989586621682564532"><span class="annot"><span class="annottext">mult_refl :: KindCoercion
</span><a href="#local-6989586621682564532"><span class="hs-identifier hs-var hs-var">mult_refl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Role -&gt; Type -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkReflCo"><span class="hs-identifier hs-var">mkReflCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role -&gt; FunSel -&gt; Role
</span><a href="GHC.Core.Coercion.html#funRole"><span class="hs-identifier hs-var">funRole</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682564525"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">FunSel
</span><a href="GHC.Core.TyCo.Rep.html#SelMult"><span class="hs-identifier hs-var">SelMult</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#manyDataConTy"><span class="hs-identifier hs-var">manyDataConTy</span></a></span><span>
</span><span id="line-1380"></span><span>
</span><span id="line-1381"></span><span id="local-6989586621682563175"><span class="annot"><a href="GHC.Core.Type.html#ty_con_app_fun_maybe"><span class="hs-identifier hs-type">ty_con_app_fun_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682563175"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563175"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682563175"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1382"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#FunTyFlag"><span class="hs-identifier hs-type">FunTyFlag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682563175"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682563175"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682563175"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1383"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#ty_con_app_fun_maybe"><span class="hs-pragma hs-type">ty_con_app_fun_maybe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1384"></span><span class="hs-comment">-- Specialise this function for its two call sites</span><span>
</span><span id="line-1385"></span><span id="ty_con_app_fun_maybe"><span class="annot"><span class="annottext">ty_con_app_fun_maybe :: forall a.
(HasDebugCallStack, Outputable a) =&gt;
a -&gt; TyCon -&gt; [a] -&gt; Maybe (FunTyFlag, a, a, a)
</span><a href="GHC.Core.Type.html#ty_con_app_fun_maybe"><span class="hs-identifier hs-var hs-var">ty_con_app_fun_maybe</span></a></span></span><span> </span><span id="local-6989586621682564552"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682564552"><span class="hs-identifier hs-var">many_ty_co</span></a></span></span><span> </span><span id="local-6989586621682564553"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564553"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682564554"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682564554"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-1386"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682564555"><span class="hs-identifier hs-var">tc_uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#fUNTyConKey"><span class="hs-identifier hs-var">fUNTyConKey</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (FunTyFlag, a, a, a)
</span><a href="#local-6989586621682564556"><span class="hs-identifier hs-var">fUN_case</span></a></span><span>
</span><span id="line-1387"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682564555"><span class="hs-identifier hs-var">tc_uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#tcArrowTyConKey"><span class="hs-identifier hs-var">tcArrowTyConKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Maybe (FunTyFlag, a, a, a)
</span><a href="#local-6989586621682564558"><span class="hs-identifier hs-var">non_FUN_case</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="GHC.Types.Var.html#FTF_T_C"><span class="hs-identifier hs-var">FTF_T_C</span></a></span><span>
</span><span id="line-1388"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682564555"><span class="hs-identifier hs-var">tc_uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#ctArrowTyConKey"><span class="hs-identifier hs-var">ctArrowTyConKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Maybe (FunTyFlag, a, a, a)
</span><a href="#local-6989586621682564558"><span class="hs-identifier hs-var">non_FUN_case</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="GHC.Types.Var.html#FTF_C_T"><span class="hs-identifier hs-var">FTF_C_T</span></a></span><span>
</span><span id="line-1389"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682564555"><span class="hs-identifier hs-var">tc_uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#ccArrowTyConKey"><span class="hs-identifier hs-var">ccArrowTyConKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Maybe (FunTyFlag, a, a, a)
</span><a href="#local-6989586621682564558"><span class="hs-identifier hs-var">non_FUN_case</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="GHC.Types.Var.html#FTF_C_C"><span class="hs-identifier hs-var">FTF_C_C</span></a></span><span>
</span><span id="line-1390"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (FunTyFlag, a, a, a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1391"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1392"></span><span>    </span><span id="local-6989586621682564555"><span class="annot"><span class="annottext">tc_uniq :: Unique
</span><a href="#local-6989586621682564555"><span class="hs-identifier hs-var hs-var">tc_uniq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique
</span><a href="GHC.Core.TyCon.html#tyConUnique"><span class="hs-identifier hs-var">tyConUnique</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564553"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1393"></span><span>
</span><span id="line-1394"></span><span>    </span><span id="local-6989586621682564556"><span class="annot"><span class="annottext">fUN_case :: Maybe (FunTyFlag, a, a, a)
</span><a href="#local-6989586621682564556"><span class="hs-identifier hs-var hs-var">fUN_case</span></a></span></span><span>
</span><span id="line-1395"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564565"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682564565"><span class="hs-identifier hs-var">w</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682564566"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682564566"><span class="hs-identifier hs-var">_r1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682564567"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682564567"><span class="hs-identifier hs-var">_r2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682564568"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682564568"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682564569"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682564569"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682564570"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682564570"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682564554"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1396"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; SDoc -&gt; Maybe (FunTyFlag, a, a, a) -&gt; Maybe (FunTyFlag, a, a, a)
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682564570"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564553"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682564554"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (FunTyFlag, a, a, a) -&gt; Maybe (FunTyFlag, a, a, a))
-&gt; Maybe (FunTyFlag, a, a, a) -&gt; Maybe (FunTyFlag, a, a, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1397"></span><span>        </span><span class="annot"><span class="annottext">(FunTyFlag, a, a, a) -&gt; Maybe (FunTyFlag, a, a, a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="GHC.Types.Var.html#FTF_T_T"><span class="hs-identifier hs-var">FTF_T_T</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682564565"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682564568"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682564569"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1398"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (FunTyFlag, a, a, a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1399"></span><span>
</span><span id="line-1400"></span><span>    </span><span id="local-6989586621682564558"><span class="annot"><span class="annottext">non_FUN_case :: FunTyFlag -&gt; Maybe (FunTyFlag, a, a, a)
</span><a href="#local-6989586621682564558"><span class="hs-identifier hs-var hs-var">non_FUN_case</span></a></span></span><span> </span><span id="local-6989586621682564574"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564574"><span class="hs-identifier hs-var">ftf</span></a></span></span><span>
</span><span id="line-1401"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564575"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682564575"><span class="hs-identifier hs-var">_r1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682564576"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682564576"><span class="hs-identifier hs-var">_r2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682564577"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682564577"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682564578"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682564578"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682564579"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682564579"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682564554"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1402"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; SDoc -&gt; Maybe (FunTyFlag, a, a, a) -&gt; Maybe (FunTyFlag, a, a, a)
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682564579"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564553"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682564554"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (FunTyFlag, a, a, a) -&gt; Maybe (FunTyFlag, a, a, a))
-&gt; Maybe (FunTyFlag, a, a, a) -&gt; Maybe (FunTyFlag, a, a, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1403"></span><span>        </span><span class="annot"><span class="annottext">(FunTyFlag, a, a, a) -&gt; Maybe (FunTyFlag, a, a, a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564574"><span class="hs-identifier hs-var">ftf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682564552"><span class="hs-identifier hs-var">many_ty_co</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682564577"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682564578"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1404"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1405"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (FunTyFlag, a, a, a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1406"></span><span>
</span><span id="line-1407"></span><span class="annot"><a href="GHC.Core.Type.html#mkFunctionType"><span class="hs-identifier hs-type">mkFunctionType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1408"></span><span class="hs-comment">-- ^ This one works out the FunTyFlag from the argument type</span><span>
</span><span id="line-1409"></span><span class="hs-comment">-- See GHC.Types.Var Note [FunTyFlag]</span><span>
</span><span id="line-1410"></span><span id="mkFunctionType"><span class="annot"><span class="annottext">mkFunctionType :: HasDebugCallStack =&gt; Type -&gt; Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkFunctionType"><span class="hs-identifier hs-var hs-var">mkFunctionType</span></a></span></span><span> </span><span id="local-6989586621682564585"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564585"><span class="hs-identifier hs-var">mult</span></a></span></span><span> </span><span id="local-6989586621682564586"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564586"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span> </span><span id="local-6989586621682564587"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564587"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span>
</span><span id="line-1411"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564588"><span class="hs-identifier hs-var">af</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564586"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564587"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-1412"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; Type -&gt; Type
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682564589"><span class="hs-identifier hs-var">mult_ok</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564585"><span class="hs-identifier hs-var">mult</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564586"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564587"><span class="hs-identifier hs-var">res_ty</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1413"></span><span>                     </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564585"><span class="hs-identifier hs-var">mult</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1414"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1415"></span><span>    </span><span id="local-6989586621682564588"><span class="annot"><span class="annottext">af :: FunTyFlag
</span><a href="#local-6989586621682564588"><span class="hs-identifier hs-var hs-var">af</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type -&gt; FunTyFlag
Type -&gt; Type -&gt; FunTyFlag
</span><a href="GHC.Core.Type.html#chooseFunTyFlag"><span class="hs-identifier hs-var">chooseFunTyFlag</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564586"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564587"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-1416"></span><span>    </span><span id="local-6989586621682564589"><span class="annot"><span class="annottext">mult_ok :: Bool
</span><a href="#local-6989586621682564589"><span class="hs-identifier hs-var hs-var">mult_ok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isVisibleFunArg"><span class="hs-identifier hs-var">isVisibleFunArg</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564588"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isManyTy"><span class="hs-identifier hs-var">isManyTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564585"><span class="hs-identifier hs-var">mult</span></a></span><span>
</span><span id="line-1417"></span><span>
</span><span id="line-1418"></span><span class="annot"><a href="GHC.Core.Type.html#mkScaledFunctionTys"><span class="hs-identifier hs-type">mkScaledFunctionTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1419"></span><span class="annot"><span class="hs-comment">-- ^ Like mkFunctionType, compute the FunTyFlag from the arguments</span></span><span>
</span><span id="line-1420"></span><span id="mkScaledFunctionTys"><span class="annot"><span class="annottext">mkScaledFunctionTys :: [Scaled Type] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkScaledFunctionTys"><span class="hs-identifier hs-var hs-var">mkScaledFunctionTys</span></a></span></span><span> </span><span id="local-6989586621682564590"><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682564590"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span> </span><span id="local-6989586621682564591"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564591"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span>
</span><span id="line-1421"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Scaled Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Scaled Type] -&gt; Type
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Scaled Type -&gt; Type -&gt; Type
</span><a href="#local-6989586621682564592"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564591"><span class="hs-identifier hs-var">res_ty</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682564590"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-1422"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1423"></span><span>    </span><span id="local-6989586621682564592"><span class="annot"><span class="annottext">mk :: Scaled Type -&gt; Type -&gt; Type
</span><a href="#local-6989586621682564592"><span class="hs-identifier hs-var hs-var">mk</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span id="local-6989586621682564596"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564596"><span class="hs-identifier hs-var">mult</span></a></span></span><span> </span><span id="local-6989586621682564597"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564597"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564598"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564598"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span>
</span><span id="line-1424"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; FunTyFlag -&gt; Type -&gt; Type -&gt; Type -&gt; Type
FunTyFlag -&gt; Type -&gt; Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type -&gt; FunTyFlag
Type -&gt; Type -&gt; FunTyFlag
</span><a href="GHC.Core.Type.html#chooseFunTyFlag"><span class="hs-identifier hs-var">chooseFunTyFlag</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564597"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564598"><span class="hs-identifier hs-var">res_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1425"></span><span>                </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564596"><span class="hs-identifier hs-var">mult</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564597"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564598"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-1426"></span><span>
</span><span id="line-1427"></span><span class="annot"><a href="GHC.Core.Type.html#chooseFunTyFlag"><span class="hs-identifier hs-type">chooseFunTyFlag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#FunTyFlag"><span class="hs-identifier hs-type">FunTyFlag</span></a></span><span>
</span><span id="line-1428"></span><span class="annot"><span class="hs-comment">-- ^ See GHC.Types.Var Note [FunTyFlag]</span></span><span>
</span><span id="line-1429"></span><span id="chooseFunTyFlag"><span class="annot"><span class="annottext">chooseFunTyFlag :: HasDebugCallStack =&gt; Type -&gt; Type -&gt; FunTyFlag
</span><a href="GHC.Core.Type.html#chooseFunTyFlag"><span class="hs-identifier hs-var hs-var">chooseFunTyFlag</span></a></span></span><span> </span><span id="local-6989586621682564602"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564602"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span> </span><span id="local-6989586621682564603"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564603"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span>
</span><span id="line-1430"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint -&gt; TypeOrConstraint -&gt; FunTyFlag
</span><a href="GHC.Types.Var.html#mkFunTyFlag"><span class="hs-identifier hs-var">mkFunTyFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; TypeOrConstraint
Type -&gt; TypeOrConstraint
</span><a href="GHC.Core.Type.html#typeTypeOrConstraint"><span class="hs-identifier hs-var">typeTypeOrConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564602"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; TypeOrConstraint
Type -&gt; TypeOrConstraint
</span><a href="GHC.Core.Type.html#typeTypeOrConstraint"><span class="hs-identifier hs-var">typeTypeOrConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564603"><span class="hs-identifier hs-var">res_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1431"></span><span>
</span><span id="line-1432"></span><span class="annot"><a href="GHC.Core.Type.html#splitFunTy"><span class="hs-identifier hs-type">splitFunTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1433"></span><span class="hs-comment">-- ^ Attempts to extract the multiplicity, argument and result types from a type,</span><span>
</span><span id="line-1434"></span><span class="hs-comment">-- and panics if that is not possible. See also 'splitFunTy_maybe'</span><span>
</span><span id="line-1435"></span><span id="splitFunTy"><span class="annot"><span class="annottext">splitFunTy :: Type -&gt; (Type, Type, Type)
</span><a href="GHC.Core.Type.html#splitFunTy"><span class="hs-identifier hs-var hs-var">splitFunTy</span></a></span></span><span> </span><span id="local-6989586621682564605"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564605"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (FunTyFlag, Type, Type, Type)
</span><a href="GHC.Core.Type.html#splitFunTy_maybe"><span class="hs-identifier hs-var">splitFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564605"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1436"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564606"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564606"><span class="hs-identifier hs-var">_af</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564607"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564607"><span class="hs-identifier hs-var">mult</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564608"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564608"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564609"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564609"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564607"><span class="hs-identifier hs-var">mult</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564608"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564609"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1437"></span><span>                   </span><span class="annot"><span class="annottext">Maybe (FunTyFlag, Type, Type, Type)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; (Type, Type, Type)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitFunTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564605"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1438"></span><span>
</span><span id="line-1439"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitFunTy_maybe"><span class="hs-pragma hs-type">splitFunTy_maybe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1440"></span><span class="annot"><a href="GHC.Core.Type.html#splitFunTy_maybe"><span class="hs-identifier hs-type">splitFunTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#FunTyFlag"><span class="hs-identifier hs-type">FunTyFlag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1441"></span><span class="annot"><span class="hs-comment">-- ^ Attempts to extract the multiplicity, argument and result types from a type</span></span><span>
</span><span id="line-1442"></span><span id="splitFunTy_maybe"><span class="annot"><span class="annottext">splitFunTy_maybe :: Type -&gt; Maybe (FunTyFlag, Type, Type, Type)
</span><a href="GHC.Core.Type.html#splitFunTy_maybe"><span class="hs-identifier hs-var hs-var">splitFunTy_maybe</span></a></span></span><span> </span><span id="local-6989586621682564610"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564610"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1443"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span id="local-6989586621682564611"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564611"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span id="local-6989586621682564612"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564612"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682564613"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564613"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682564614"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564614"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564610"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FunTyFlag, Type, Type, Type)
-&gt; Maybe (FunTyFlag, Type, Type, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564611"><span class="hs-identifier hs-var">af</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564612"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564613"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564614"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1444"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (FunTyFlag, Type, Type, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1445"></span><span>
</span><span id="line-1446"></span><span class="annot"><a href="GHC.Core.Type.html#splitFunTys"><span class="hs-identifier hs-type">splitFunTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1447"></span><span id="splitFunTys"><span class="annot"><span class="annottext">splitFunTys :: Type -&gt; ([Scaled Type], Type)
</span><a href="GHC.Core.Type.html#splitFunTys"><span class="hs-identifier hs-var hs-var">splitFunTys</span></a></span></span><span> </span><span id="local-6989586621682564615"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564615"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Scaled Type] -&gt; Type -&gt; Type -&gt; ([Scaled Type], Type)
</span><a href="#local-6989586621682564616"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564615"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564615"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1448"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1449"></span><span>      </span><span class="hs-comment">-- common case first</span><span>
</span><span id="line-1450"></span><span>    </span><span id="local-6989586621682564616"><span class="annot"><span class="annottext">split :: [Scaled Type] -&gt; Type -&gt; Type -&gt; ([Scaled Type], Type)
</span><a href="#local-6989586621682564616"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621682564617"><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682564617"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682564618"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564618"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682564619"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564619"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682564620"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564620"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Scaled Type] -&gt; Type -&gt; Type -&gt; ([Scaled Type], Type)
</span><a href="#local-6989586621682564616"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564618"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564619"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled Type -&gt; [Scaled Type] -&gt; [Scaled Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682564617"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564620"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564620"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1451"></span><span>    </span><span class="annot"><a href="#local-6989586621682564616"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564621"><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682564621"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682564622"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564622"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621682564623"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564623"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564624"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564624"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564623"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Scaled Type] -&gt; Type -&gt; Type -&gt; ([Scaled Type], Type)
</span><a href="#local-6989586621682564616"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682564621"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564622"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564624"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1452"></span><span>    </span><span class="annot"><a href="#local-6989586621682564616"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564625"><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682564625"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682564626"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564626"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Scaled Type] -&gt; [Scaled Type]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682564625"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564626"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1453"></span><span>
</span><span id="line-1454"></span><span class="annot"><a href="GHC.Core.Type.html#funResultTy"><span class="hs-identifier hs-type">funResultTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1455"></span><span class="annot"><span class="hs-comment">-- ^ Extract the function result type and panic if that is not possible</span></span><span>
</span><span id="line-1456"></span><span id="funResultTy"><span class="annot"><span class="annottext">funResultTy :: HasDebugCallStack =&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#funResultTy"><span class="hs-identifier hs-var hs-var">funResultTy</span></a></span></span><span> </span><span id="local-6989586621682564632"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564632"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1457"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564633"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564633"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564632"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564633"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1458"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;funResultTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564632"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1459"></span><span>
</span><span id="line-1460"></span><span class="annot"><a href="GHC.Core.Type.html#funArgTy"><span class="hs-identifier hs-type">funArgTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1461"></span><span class="annot"><span class="hs-comment">-- ^ Extract the function argument type and panic if that is not possible</span></span><span>
</span><span id="line-1462"></span><span id="funArgTy"><span class="annot"><span class="annottext">funArgTy :: HasDebugCallStack =&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#funArgTy"><span class="hs-identifier hs-var hs-var">funArgTy</span></a></span></span><span> </span><span id="local-6989586621682564638"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564638"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1463"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564639"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564639"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564638"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564639"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1464"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;funArgTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564638"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1465"></span><span>
</span><span id="line-1466"></span><span class="hs-comment">-- ^ Just like 'piResultTys' but for a single argument</span><span>
</span><span id="line-1467"></span><span class="hs-comment">-- Try not to iterate 'piResultTy', because it's inefficient to substitute</span><span>
</span><span id="line-1468"></span><span class="hs-comment">-- one variable at a time; instead use 'piResultTys&quot;</span><span>
</span><span id="line-1469"></span><span class="annot"><a href="GHC.Core.Type.html#piResultTy"><span class="hs-identifier hs-type">piResultTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1470"></span><span id="piResultTy"><span class="annot"><span class="annottext">piResultTy :: HasDebugCallStack =&gt; Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#piResultTy"><span class="hs-identifier hs-var hs-var">piResultTy</span></a></span></span><span> </span><span id="local-6989586621682564646"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564646"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564647"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564647"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#piResultTy_maybe"><span class="hs-identifier hs-var">piResultTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564646"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564647"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1471"></span><span>                      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564649"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564649"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564649"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1472"></span><span>                      </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;piResultTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564646"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564647"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1473"></span><span>
</span><span id="line-1474"></span><span class="annot"><a href="GHC.Core.Type.html#piResultTy_maybe"><span class="hs-identifier hs-type">piResultTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1475"></span><span class="hs-comment">-- We don't need a 'tc' version, because</span><span>
</span><span id="line-1476"></span><span class="hs-comment">-- this function behaves the same for Type and Constraint</span><span>
</span><span id="line-1477"></span><span id="piResultTy_maybe"><span class="annot"><span class="annottext">piResultTy_maybe :: Type -&gt; Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#piResultTy_maybe"><span class="hs-identifier hs-var hs-var">piResultTy_maybe</span></a></span></span><span> </span><span id="local-6989586621682564650"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564650"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564651"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564651"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564650"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1478"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564652"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564652"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564652"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1479"></span><span>
</span><span id="line-1480"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564653"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564653"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564654"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564654"><span class="hs-identifier hs-var">res</span></a></span></span><span>
</span><span id="line-1481"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682564655"><span class="annot"><span class="annottext">empty_subst :: Subst
</span><a href="#local-6989586621682564655"><span class="hs-identifier hs-var hs-var">empty_subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#mkEmptySubst"><span class="hs-identifier hs-var">mkEmptySubst</span></a></span><span> </span><span class="annot"><span class="annottext">(InScopeSet -&gt; Subst) -&gt; InScopeSet -&gt; Subst
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; InScopeSet) -&gt; VarSet -&gt; InScopeSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1482"></span><span>                         </span><span class="annot"><span class="annottext">[Type] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564651"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564654"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1483"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Subst -&gt; Type -&gt; Type
Subst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; TyVar -&gt; Type -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvSubst"><span class="hs-identifier hs-var">extendTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564655"><span class="hs-identifier hs-var">empty_subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564653"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564651"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564654"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1484"></span><span>
</span><span id="line-1485"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1486"></span><span>
</span><span id="line-1487"></span><span class="hs-comment">-- | (piResultTys f_ty [ty1, .., tyn]) gives the type of (f ty1 .. tyn)</span><span>
</span><span id="line-1488"></span><span class="hs-comment">--   where f :: f_ty</span><span>
</span><span id="line-1489"></span><span class="hs-comment">-- 'piResultTys' is interesting because:</span><span>
</span><span id="line-1490"></span><span class="hs-comment">--      1. 'f_ty' may have more for-alls than there are args</span><span>
</span><span id="line-1491"></span><span class="hs-comment">--      2. Less obviously, it may have fewer for-alls</span><span>
</span><span id="line-1492"></span><span class="hs-comment">-- For case 2. think of:</span><span>
</span><span id="line-1493"></span><span class="hs-comment">--   piResultTys (forall a.a) [forall b.b, Int]</span><span>
</span><span id="line-1494"></span><span class="hs-comment">-- This really can happen, but only (I think) in situations involving</span><span>
</span><span id="line-1495"></span><span class="hs-comment">-- undefined.  For example:</span><span>
</span><span id="line-1496"></span><span class="hs-comment">--       undefined :: forall a. a</span><span>
</span><span id="line-1497"></span><span class="hs-comment">-- Term: undefined @(forall b. b-&gt;b) @Int</span><span>
</span><span id="line-1498"></span><span class="hs-comment">-- This term should have type (Int -&gt; Int), but notice that</span><span>
</span><span id="line-1499"></span><span class="hs-comment">-- there are more type args than foralls in 'undefined's type.</span><span>
</span><span id="line-1500"></span><span>
</span><span id="line-1501"></span><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><span id="line-1502"></span><span class="hs-comment">-- See Note [GHC Formalism] in GHC.Core.Lint</span><span>
</span><span id="line-1503"></span><span>
</span><span id="line-1504"></span><span class="hs-comment">-- This is a heavily used function (e.g. from typeKind),</span><span>
</span><span id="line-1505"></span><span class="hs-comment">-- so we pay attention to efficiency, especially in the special case</span><span>
</span><span id="line-1506"></span><span class="hs-comment">-- where there are no for-alls so we are just dropping arrows from</span><span>
</span><span id="line-1507"></span><span class="hs-comment">-- a function type/kind.</span><span>
</span><span id="line-1508"></span><span class="annot"><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-type">piResultTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1509"></span><span id="piResultTys"><span class="annot"><span class="annottext">piResultTys :: HasDebugCallStack =&gt; Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-var hs-var">piResultTys</span></a></span></span><span> </span><span id="local-6989586621682564673"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564673"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564673"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1510"></span><span class="annot"><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a></span><span> </span><span id="local-6989586621682564674"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564674"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564675"><span class="annot"><span class="annottext">orig_args :: [Type]
</span><a href="#local-6989586621682564675"><span class="hs-identifier hs-var">orig_args</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621682564676"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564676"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682564677"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564677"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1511"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564678"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564678"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564674"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1512"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; [Type] -&gt; Type
Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564678"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564677"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1513"></span><span>
</span><span id="line-1514"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564679"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564679"><span class="hs-identifier hs-var">tcv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564680"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564680"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564674"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1515"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- Both type and coercion variables</span><span>
</span><span id="line-1516"></span><span>    </span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621682564681"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; TyVar -&gt; Type -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvSubst"><span class="hs-identifier hs-var">extendTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564682"><span class="hs-identifier hs-var">init_subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564679"><span class="hs-identifier hs-var">tcv</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564676"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564680"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564677"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1517"></span><span>
</span><span id="line-1518"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564683"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564683"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564674"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1519"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; [Type] -&gt; Type
Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564683"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564675"><span class="hs-identifier hs-var">orig_args</span></a></span><span>
</span><span id="line-1520"></span><span>
</span><span id="line-1521"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1522"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;piResultTys1&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564674"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564675"><span class="hs-identifier hs-var">orig_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1523"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1524"></span><span>    </span><span id="local-6989586621682564682"><span class="annot"><span class="annottext">init_subst :: Subst
</span><a href="#local-6989586621682564682"><span class="hs-identifier hs-var hs-var">init_subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#mkEmptySubst"><span class="hs-identifier hs-var">mkEmptySubst</span></a></span><span> </span><span class="annot"><span class="annottext">(InScopeSet -&gt; Subst) -&gt; InScopeSet -&gt; Subst
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564674"><span class="hs-identifier hs-var">ty</span></a></span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564675"><span class="hs-identifier hs-var">orig_args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1525"></span><span>
</span><span id="line-1526"></span><span>    </span><span class="annot"><a href="#local-6989586621682564681"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1527"></span><span>    </span><span id="local-6989586621682564681"><span class="annot"><span class="annottext">go :: Subst -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621682564681"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682564684"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564684"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621682564685"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564685"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyUnchecked"><span class="hs-identifier hs-var">substTyUnchecked</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564684"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564685"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1528"></span><span>
</span><span id="line-1529"></span><span>    </span><span class="annot"><a href="#local-6989586621682564681"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682564686"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564686"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621682564687"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564687"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564688"><span class="annot"><span class="annottext">all_args :: [Type]
</span><a href="#local-6989586621682564688"><span class="hs-identifier hs-var">all_args</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621682564689"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564689"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682564690"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564690"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1530"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564691"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564691"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564687"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1531"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621682564681"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564686"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564691"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564690"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1532"></span><span>
</span><span id="line-1533"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564692"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564692"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564693"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564693"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564687"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1534"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621682564681"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; TyVar -&gt; Type -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvSubst"><span class="hs-identifier hs-var">extendTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564686"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564692"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564689"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564693"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564690"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1535"></span><span>
</span><span id="line-1536"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564694"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564694"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564687"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1537"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621682564681"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564686"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564694"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564688"><span class="hs-identifier hs-var">all_args</span></a></span><span>
</span><span id="line-1538"></span><span>
</span><span id="line-1539"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#isEmptyTCvSubst"><span class="hs-identifier hs-var">isEmptyTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564686"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- See Note [Care with kind instantiation]</span><span>
</span><span id="line-1540"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621682564681"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564682"><span class="hs-identifier hs-var">init_subst</span></a></span><span>
</span><span id="line-1541"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Subst -&gt; Type -&gt; Type
Subst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564686"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564687"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1542"></span><span>          </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564688"><span class="hs-identifier hs-var">all_args</span></a></span><span>
</span><span id="line-1543"></span><span>
</span><span id="line-1544"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1545"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- We have not run out of arguments, but the function doesn't</span><span>
</span><span id="line-1546"></span><span>        </span><span class="hs-comment">-- have the right kind to apply to them; so panic.</span><span>
</span><span id="line-1547"></span><span>        </span><span class="hs-comment">-- Without the explicit isEmptyVarEnv test, an ill-kinded type</span><span>
</span><span id="line-1548"></span><span>        </span><span class="hs-comment">-- would give an infinite loop, which is very unhelpful</span><span>
</span><span id="line-1549"></span><span>        </span><span class="hs-comment">-- c.f. #15473</span><span>
</span><span id="line-1550"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;piResultTys2&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564687"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564675"><span class="hs-identifier hs-var">orig_args</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564688"><span class="hs-identifier hs-var">all_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1551"></span><span>
</span><span id="line-1552"></span><span class="annot"><a href="GHC.Core.Type.html#applyTysX"><span class="hs-identifier hs-type">applyTysX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1553"></span><span class="hs-comment">-- applyTysX beta-reduces (/\tvs. body_ty) arg_tys</span><span>
</span><span id="line-1554"></span><span class="hs-comment">-- Assumes that (/\tvs. body_ty) is closed</span><span>
</span><span id="line-1555"></span><span id="applyTysX"><span class="annot"><span class="annottext">applyTysX :: HasDebugCallStack =&gt; [TyVar] -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#applyTysX"><span class="hs-identifier hs-var hs-var">applyTysX</span></a></span></span><span> </span><span id="local-6989586621682564705"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564705"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621682564706"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564706"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span> </span><span id="local-6989586621682564707"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564707"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span>
</span><span id="line-1556"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; Type -&gt; Type
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564705"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; [Type] -&gt; Bool
forall a b. [a] -&gt; [b] -&gt; Bool
</span><a href="GHC.Utils.Misc.html#leLength"><span class="hs-operator hs-var">`leLength`</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564707"><span class="hs-identifier hs-var">arg_tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682564709"><span class="hs-identifier hs-var">pp_stuff</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1557"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; Type -&gt; Type
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564706"><span class="hs-identifier hs-var">body_ty</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#subVarSet"><span class="hs-operator hs-var">`subVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#mkVarSet"><span class="hs-identifier hs-var">mkVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564705"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682564709"><span class="hs-identifier hs-var">pp_stuff</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1558"></span><span>    </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; [Type] -&gt; Type -&gt; Type
HasDebugCallStack =&gt; [TyVar] -&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyWith"><span class="hs-identifier hs-var">substTyWith</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564705"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564712"><span class="hs-identifier hs-var">arg_tys_prefix</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564706"><span class="hs-identifier hs-var">body_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1559"></span><span>             </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564713"><span class="hs-identifier hs-var">arg_tys_rest</span></a></span><span>
</span><span id="line-1560"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1561"></span><span>    </span><span id="local-6989586621682564709"><span class="annot"><span class="annottext">pp_stuff :: SDoc
</span><a href="#local-6989586621682564709"><span class="hs-identifier hs-var hs-var">pp_stuff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[TyVar] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564705"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564706"><span class="hs-identifier hs-var">body_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564707"><span class="hs-identifier hs-var">arg_tys</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1562"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682564712"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564712"><span class="hs-identifier hs-var">arg_tys_prefix</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564713"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564713"><span class="hs-identifier hs-var">arg_tys_rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; [Type] -&gt; ([Type], [Type])
forall b a. [b] -&gt; [a] -&gt; ([a], [a])
</span><a href="GHC.Utils.Misc.html#splitAtList"><span class="hs-identifier hs-var">splitAtList</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564705"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564707"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-1563"></span><span>
</span><span id="line-1564"></span><span>
</span><span id="line-1565"></span><span class="hs-comment">{- Note [Care with kind instantiation]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Suppose we have
  T :: forall k. k
and we are finding the kind of
  T (forall b. b -&gt; b) * Int
Then
  T (forall b. b-&gt;b) :: k[ k :-&gt; forall b. b-&gt;b]
                     :: forall b. b -&gt; b
So
  T (forall b. b-&gt;b) * :: (b -&gt; b)[ b :-&gt; *]
                       :: * -&gt; *

In other words we must instantiate the forall!

Similarly (#15428)
   S :: forall k f. k -&gt; f k
and we are finding the kind of
   S * (* -&gt;) Int Bool
We have
   S * (* -&gt;) :: (k -&gt; f k)[ k :-&gt; *, f :-&gt; (* -&gt;)]
              :: * -&gt; * -&gt; *
So again we must instantiate.

The same thing happens in GHC.CoreToIface.toIfaceAppArgsX.
-}</span><span>
</span><span id="line-1591"></span><span>
</span><span id="line-1592"></span><span>
</span><span id="line-1593"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                      TyConApp
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-1598"></span><span>
</span><span id="line-1599"></span><span class="hs-comment">-- splitTyConApp &quot;looks through&quot; synonyms, because they don't</span><span>
</span><span id="line-1600"></span><span class="hs-comment">-- mean a distinct type, but all other type-constructor applications</span><span>
</span><span id="line-1601"></span><span class="hs-comment">-- including functions are returned as Just ..</span><span>
</span><span id="line-1602"></span><span>
</span><span id="line-1603"></span><span class="hs-comment">-- | Retrieve the tycon heading this type, if there is one. Does /not/</span><span>
</span><span id="line-1604"></span><span class="hs-comment">-- look through synonyms.</span><span>
</span><span id="line-1605"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyConPicky_maybe"><span class="hs-identifier hs-type">tyConAppTyConPicky_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-1606"></span><span id="tyConAppTyConPicky_maybe"><span class="annot"><span class="annottext">tyConAppTyConPicky_maybe :: Type -&gt; Maybe TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyConPicky_maybe"><span class="hs-identifier hs-var hs-var">tyConAppTyConPicky_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564715"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564715"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe TyCon
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564715"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1607"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyConPicky_maybe"><span class="hs-identifier hs-var">tyConAppTyConPicky_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564716"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564716"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe TyCon
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunTyFlag -&gt; TyCon
</span><a href="GHC.Builtin.Types.Prim.html#funTyFlagTyCon"><span class="hs-identifier hs-var">funTyFlagTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564716"><span class="hs-identifier hs-var">af</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1608"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyConPicky_maybe"><span class="hs-identifier hs-var">tyConAppTyConPicky_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1609"></span><span>
</span><span id="line-1610"></span><span>
</span><span id="line-1611"></span><span class="hs-comment">-- | The same as @fst . splitTyConApp@</span><span>
</span><span id="line-1612"></span><span class="hs-comment">-- We can short-cut the FunTy case</span><span>
</span><span id="line-1613"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-pragma hs-type">tyConAppTyCon_maybe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1614"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-type">tyConAppTyCon_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-1615"></span><span id="tyConAppTyCon_maybe"><span class="annot"><span class="annottext">tyConAppTyCon_maybe :: Type -&gt; Maybe TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var hs-var">tyConAppTyCon_maybe</span></a></span></span><span> </span><span id="local-6989586621682564717"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564717"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564717"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1616"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564718"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564718"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe TyCon
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564718"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1617"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564719"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564719"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe TyCon
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunTyFlag -&gt; TyCon
</span><a href="GHC.Builtin.Types.Prim.html#funTyFlagTyCon"><span class="hs-identifier hs-var">funTyFlagTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564719"><span class="hs-identifier hs-var">af</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1618"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1619"></span><span>
</span><span id="line-1620"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyCon"><span class="hs-identifier hs-type">tyConAppTyCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-1621"></span><span id="tyConAppTyCon"><span class="annot"><span class="annottext">tyConAppTyCon :: HasDebugCallStack =&gt; Type -&gt; TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon"><span class="hs-identifier hs-var hs-var">tyConAppTyCon</span></a></span></span><span> </span><span id="local-6989586621682564724"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564724"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564724"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TyCon -&gt; TyCon -&gt; TyCon
forall a. Maybe a -&gt; a -&gt; a
</span><a href="GHC.Data.Maybe.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TyCon
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tyConAppTyCon&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564724"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1622"></span><span>
</span><span id="line-1623"></span><span class="annot"><span class="hs-comment">-- | The same as @snd . splitTyConApp@</span></span><span>
</span><span id="line-1624"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppArgs_maybe"><span class="hs-identifier hs-type">tyConAppArgs_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1625"></span><span id="tyConAppArgs_maybe"><span class="annot"><span class="annottext">tyConAppArgs_maybe :: Type -&gt; Maybe [Type]
</span><a href="GHC.Core.Type.html#tyConAppArgs_maybe"><span class="hs-identifier hs-var hs-var">tyConAppArgs_maybe</span></a></span></span><span> </span><span id="local-6989586621682564725"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564725"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564725"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1626"></span><span>                          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564726"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564726"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Maybe [Type]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564726"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1627"></span><span>                          </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><span class="hs-identifier hs-var">Nothing</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe [Type]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1628"></span><span>
</span><span id="line-1629"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppArgs"><span class="hs-identifier hs-type">tyConAppArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1630"></span><span id="tyConAppArgs"><span class="annot"><span class="annottext">tyConAppArgs :: HasDebugCallStack =&gt; Type -&gt; [Type]
</span><a href="GHC.Core.Type.html#tyConAppArgs"><span class="hs-identifier hs-var hs-var">tyConAppArgs</span></a></span></span><span> </span><span id="local-6989586621682564731"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564731"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe [Type]
</span><a href="GHC.Core.Type.html#tyConAppArgs_maybe"><span class="hs-identifier hs-var">tyConAppArgs_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564731"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [Type] -&gt; [Type] -&gt; [Type]
forall a. Maybe a -&gt; a -&gt; a
</span><a href="GHC.Data.Maybe.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; [Type]
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tyConAppArgs&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564731"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1631"></span><span>
</span><span id="line-1632"></span><span class="hs-comment">-- | Attempts to tease a type apart into a type constructor and the application</span><span>
</span><span id="line-1633"></span><span class="hs-comment">-- of a number of arguments to that constructor. Panics if that is not possible.</span><span>
</span><span id="line-1634"></span><span class="hs-comment">-- See also 'splitTyConApp_maybe'</span><span>
</span><span id="line-1635"></span><span class="annot"><a href="GHC.Core.Type.html#splitTyConApp"><span class="hs-identifier hs-type">splitTyConApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1636"></span><span id="splitTyConApp"><span class="annot"><span class="annottext">splitTyConApp :: Type -&gt; (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp"><span class="hs-identifier hs-var hs-var">splitTyConApp</span></a></span></span><span> </span><span id="local-6989586621682564732"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564732"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564732"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type]) -&gt; (TyCon, [Type]) -&gt; (TyCon, [Type])
forall a. Maybe a -&gt; a -&gt; a
</span><a href="GHC.Data.Maybe.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; (TyCon, [Type])
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitTyConApp&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564732"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1637"></span><span>
</span><span id="line-1638"></span><span class="hs-comment">-- | Attempts to tease a type apart into a type constructor and the application</span><span>
</span><span id="line-1639"></span><span class="hs-comment">-- of a number of arguments to that constructor</span><span>
</span><span id="line-1640"></span><span class="annot"><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-type">splitTyConApp_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1641"></span><span id="splitTyConApp_maybe"><span class="annot"><span class="annottext">splitTyConApp_maybe :: HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var hs-var">splitTyConApp_maybe</span></a></span></span><span> </span><span id="local-6989586621682564735"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564735"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConAppNoView_maybe"><span class="hs-identifier hs-var">splitTyConAppNoView_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564735"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1642"></span><span>
</span><span id="line-1643"></span><span class="annot"><a href="GHC.Core.Type.html#splitTyConAppNoView_maybe"><span class="hs-identifier hs-type">splitTyConAppNoView_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1644"></span><span class="hs-comment">-- Same as splitTyConApp_maybe but without looking through synonyms</span><span>
</span><span id="line-1645"></span><span id="splitTyConAppNoView_maybe"><span class="annot"><span class="annottext">splitTyConAppNoView_maybe :: HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConAppNoView_maybe"><span class="hs-identifier hs-var hs-var">splitTyConAppNoView_maybe</span></a></span></span><span> </span><span id="local-6989586621682564737"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564737"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1646"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564737"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1647"></span><span>      </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564738"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564738"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564739"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564739"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564740"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564740"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564741"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564741"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">}</span><span>
</span><span id="line-1648"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Type -&gt; Type -&gt; Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#funTyConAppTy_maybe"><span class="hs-identifier hs-var">funTyConAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564738"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564739"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564740"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564741"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1649"></span><span>      </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564742"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564742"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682564743"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564743"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TyCon, [Type]) -&gt; Maybe (TyCon, [Type])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564742"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564743"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1650"></span><span>      </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1651"></span><span>
</span><span id="line-1652"></span><span class="hs-comment">-- | tcSplitTyConApp_maybe splits a type constructor application into</span><span>
</span><span id="line-1653"></span><span class="hs-comment">-- its type constructor and applied types.</span><span>
</span><span id="line-1654"></span><span class="hs-comment">--</span><span>
</span><span id="line-1655"></span><span class="hs-comment">-- Differs from splitTyConApp_maybe in that it does *not* split types</span><span>
</span><span id="line-1656"></span><span class="hs-comment">-- headed with (=&gt;), as that's not a TyCon in the type-checker.</span><span>
</span><span id="line-1657"></span><span class="hs-comment">--</span><span>
</span><span id="line-1658"></span><span class="hs-comment">-- Note that this may fail (in funTyConAppTy_maybe) in the case</span><span>
</span><span id="line-1659"></span><span class="hs-comment">-- of a 'FunTy' with an argument of unknown kind 'FunTy'</span><span>
</span><span id="line-1660"></span><span class="hs-comment">-- (e.g. `FunTy (a :: k) Int`, since the kind of @a@ isn't of</span><span>
</span><span id="line-1661"></span><span class="hs-comment">-- the form `TYPE rep`.  This isn't usually a problem but may</span><span>
</span><span id="line-1662"></span><span class="hs-comment">-- be temporarily the case during canonicalization:</span><span>
</span><span id="line-1663"></span><span class="hs-comment">--     see Note [Decomposing FunTy] in GHC.Tc.Solver.Equality</span><span>
</span><span id="line-1664"></span><span class="hs-comment">--     and Note [The Purely Kinded Type Invariant (PKTI)] in GHC.Tc.Gen.HsType,</span><span>
</span><span id="line-1665"></span><span class="hs-comment">--         Wrinkle around FunTy</span><span>
</span><span id="line-1666"></span><span class="hs-comment">--</span><span>
</span><span id="line-1667"></span><span class="hs-comment">-- Consequently, you may need to zonk your type before</span><span>
</span><span id="line-1668"></span><span class="hs-comment">-- using this function.</span><span>
</span><span id="line-1669"></span><span class="annot"><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-type">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1670"></span><span class="hs-comment">-- Defined here to avoid module loops between Unify and TcType.</span><span>
</span><span id="line-1671"></span><span id="tcSplitTyConApp_maybe"><span class="annot"><span class="annottext">tcSplitTyConApp_maybe :: HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var hs-var">tcSplitTyConApp_maybe</span></a></span></span><span> </span><span id="local-6989586621682564745"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564745"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1672"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564745"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1673"></span><span>      </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564746"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564746"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564747"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564747"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564748"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564748"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564749"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564749"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">}</span><span>
</span><span id="line-1674"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isVisibleFunArg"><span class="hs-identifier hs-var">isVisibleFunArg</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564746"><span class="hs-identifier hs-var">af</span></a></span><span>    </span><span class="hs-comment">-- Visible args only</span><span>
</span><span id="line-1675"></span><span>                        </span><span class="hs-comment">-- See Note [Decomposing fat arrow c=&gt;t]</span><span>
</span><span id="line-1676"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Type -&gt; Type -&gt; Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#funTyConAppTy_maybe"><span class="hs-identifier hs-var">funTyConAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564746"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564747"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564748"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564749"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1677"></span><span>      </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682564750"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564750"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682564751"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564751"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TyCon, [Type]) -&gt; Maybe (TyCon, [Type])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564750"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564751"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1678"></span><span>      </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1679"></span><span>
</span><span id="line-1680"></span><span class="annot"><a href="GHC.Core.Type.html#tcSplitTyConApp"><span class="hs-identifier hs-type">tcSplitTyConApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1681"></span><span id="tcSplitTyConApp"><span class="annot"><span class="annottext">tcSplitTyConApp :: Type -&gt; (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp"><span class="hs-identifier hs-var hs-var">tcSplitTyConApp</span></a></span></span><span> </span><span id="local-6989586621682564752"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564752"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1682"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564752"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type]) -&gt; (TyCon, [Type]) -&gt; (TyCon, [Type])
forall a. Maybe a -&gt; a -&gt; a
</span><a href="GHC.Data.Maybe.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; (TyCon, [Type])
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcSplitTyConApp&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564752"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1683"></span><span>
</span><span id="line-1684"></span><span class="hs-comment">---------------------------</span><span>
</span><span id="line-1685"></span><span class="annot"><a href="GHC.Core.Type.html#newTyConInstRhs"><span class="hs-identifier hs-type">newTyConInstRhs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1686"></span><span class="hs-comment">-- ^ Unwrap one 'layer' of newtype on a type constructor and its</span><span>
</span><span id="line-1687"></span><span class="hs-comment">-- arguments, using an eta-reduced version of the @newtype@ if possible.</span><span>
</span><span id="line-1688"></span><span class="hs-comment">-- This requires tys to have at least @newTyConInstArity tycon@ elements.</span><span>
</span><span id="line-1689"></span><span id="newTyConInstRhs"><span class="annot"><span class="annottext">newTyConInstRhs :: TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#newTyConInstRhs"><span class="hs-identifier hs-var hs-var">newTyConInstRhs</span></a></span></span><span> </span><span id="local-6989586621682564753"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564753"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span id="local-6989586621682564754"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564754"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-1690"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; Type -&gt; Type
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564755"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; [Type] -&gt; Bool
forall a b. [a] -&gt; [b] -&gt; Bool
</span><a href="GHC.Utils.Misc.html#leLength"><span class="hs-operator hs-var">`leLength`</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564754"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564753"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564754"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564755"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1691"></span><span>      </span><span class="annot"><span class="annottext">[TyVar] -&gt; Type -&gt; [Type] -&gt; Type
HasDebugCallStack =&gt; [TyVar] -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#applyTysX"><span class="hs-identifier hs-var">applyTysX</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564755"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564756"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564754"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1692"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1693"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682564755"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564755"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564756"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564756"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; ([TyVar], Type)
</span><a href="GHC.Core.TyCon.html#newTyConEtadRhs"><span class="hs-identifier hs-var">newTyConEtadRhs</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564753"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-1694"></span><span>
</span><span id="line-1695"></span><span>
</span><span id="line-1696"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                      CastTy
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-1701"></span><span>
</span><span id="line-1702"></span><span class="annot"><a href="GHC.Core.Type.html#splitCastTy_maybe"><span class="hs-identifier hs-type">splitCastTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1703"></span><span id="splitCastTy_maybe"><span class="annot"><span class="annottext">splitCastTy_maybe :: Type -&gt; Maybe (Type, KindCoercion)
</span><a href="GHC.Core.Type.html#splitCastTy_maybe"><span class="hs-identifier hs-var hs-var">splitCastTy_maybe</span></a></span></span><span> </span><span id="local-6989586621682564758"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564758"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1704"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682564759"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564759"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span id="local-6989586621682564760"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564760"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564758"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type, KindCoercion) -&gt; Maybe (Type, KindCoercion)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564759"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564760"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1705"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Type, KindCoercion)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1706"></span><span>
</span><span id="line-1707"></span><span class="hs-comment">-- | Make a 'CastTy'. The Coercion must be nominal. Checks the</span><span>
</span><span id="line-1708"></span><span class="hs-comment">-- Coercion for reflexivity, dropping it if it's reflexive.</span><span>
</span><span id="line-1709"></span><span class="hs-comment">-- See @Note [Respecting definitional equality]@ in &quot;GHC.Core.TyCo.Rep&quot;</span><span>
</span><span id="line-1710"></span><span class="annot"><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-type">mkCastTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1711"></span><span id="mkCastTy"><span class="annot"><span class="annottext">mkCastTy :: Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-var hs-var">mkCastTy</span></a></span></span><span> </span><span id="local-6989586621682564761"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564761"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621682564762"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564762"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Bool
</span><a href="GHC.Core.Coercion.html#isReflexiveCo"><span class="hs-identifier hs-var">isReflexiveCo</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564762"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564761"><span class="hs-identifier hs-var">orig_ty</span></a></span><span>  </span><span class="hs-comment">-- (EQ2) from the Note</span><span>
</span><span id="line-1712"></span><span class="hs-comment">-- NB: Do the slow check here. This is important to keep the splitXXX</span><span>
</span><span id="line-1713"></span><span class="hs-comment">-- functions working properly. Otherwise, we may end up with something</span><span>
</span><span id="line-1714"></span><span class="hs-comment">-- like (((-&gt;) |&gt; something_reflexive_but_not_obviously_so) biz baz)</span><span>
</span><span id="line-1715"></span><span class="hs-comment">-- fails under splitFunTy_maybe. This happened with the cheaper check</span><span>
</span><span id="line-1716"></span><span class="hs-comment">-- in test dependent/should_compile/dynamic-paper.</span><span>
</span><span id="line-1717"></span><span class="annot"><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a></span><span> </span><span id="local-6989586621682564763"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564763"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621682564764"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564764"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mk_cast_ty"><span class="hs-identifier hs-var">mk_cast_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564763"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564764"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1718"></span><span>
</span><span id="line-1719"></span><span class="hs-comment">-- | Like 'mkCastTy', but avoids checking the coercion for reflexivity,</span><span>
</span><span id="line-1720"></span><span class="hs-comment">-- as that can be expensive.</span><span>
</span><span id="line-1721"></span><span class="annot"><a href="GHC.Core.Type.html#mk_cast_ty"><span class="hs-identifier hs-type">mk_cast_ty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1722"></span><span id="mk_cast_ty"><span class="annot"><span class="annottext">mk_cast_ty :: Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mk_cast_ty"><span class="hs-identifier hs-var hs-var">mk_cast_ty</span></a></span></span><span> </span><span id="local-6989586621682564766"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564766"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621682564767"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564767"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621682564768"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564766"><span class="hs-identifier hs-var">orig_ty</span></a></span><span>
</span><span id="line-1723"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1724"></span><span>    </span><span class="annot"><a href="#local-6989586621682564768"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1725"></span><span>    </span><span class="hs-comment">-- See Note [Using coreView in mk_cast_ty]</span><span>
</span><span id="line-1726"></span><span>    </span><span id="local-6989586621682564768"><span class="annot"><span class="annottext">go :: Type -&gt; Type
</span><a href="#local-6989586621682564768"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682564769"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564769"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564770"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564770"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564769"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621682564768"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564770"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1727"></span><span>
</span><span id="line-1728"></span><span>    </span><span class="annot"><a href="#local-6989586621682564768"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682564771"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564771"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564772"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564772"><span class="hs-identifier hs-var">co1</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1729"></span><span>      </span><span class="hs-comment">-- (EQ3) from the Note</span><span>
</span><span id="line-1730"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564771"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564772"><span class="hs-identifier hs-var">co1</span></a></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion
KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.Coercion.html#mkTransCo"><span class="hs-operator hs-var">`mkTransCo`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564767"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1731"></span><span>          </span><span class="hs-comment">-- call mkCastTy again for the reflexivity check</span><span>
</span><span id="line-1732"></span><span>
</span><span id="line-1733"></span><span>    </span><span class="annot"><a href="#local-6989586621682564768"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564773"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564773"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621682564774"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682564774"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564775"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564775"><span class="hs-identifier hs-var">inner_ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1734"></span><span>      </span><span class="hs-comment">-- (EQ4) from the Note</span><span>
</span><span id="line-1735"></span><span>      </span><span class="hs-comment">-- See Note [Weird typing rule for ForAllTy] in GHC.Core.TyCo.Rep.</span><span>
</span><span id="line-1736"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564773"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1737"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682564776"><span class="annot"><span class="annottext">fvs :: VarSet
</span><a href="#local-6989586621682564776"><span class="hs-identifier hs-var hs-var">fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCo"><span class="hs-identifier hs-var">tyCoVarsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564767"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1738"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- have to make sure that pushing the co in doesn't capture the bound var!</span><span>
</span><span id="line-1739"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564773"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682564776"><span class="hs-identifier hs-var">fvs</span></a></span><span>
</span><span id="line-1740"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682564779"><span class="annot"><span class="annottext">empty_subst :: Subst
</span><a href="#local-6989586621682564779"><span class="hs-identifier hs-var hs-var">empty_subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#mkEmptySubst"><span class="hs-identifier hs-var">mkEmptySubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682564776"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1741"></span><span>                 </span><span class="hs-special">(</span><span id="local-6989586621682564780"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564780"><span class="hs-identifier hs-var">subst</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564781"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564781"><span class="hs-identifier hs-var">tv'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Subst -&gt; TyVar -&gt; (Subst, TyVar)
Subst -&gt; TyVar -&gt; (Subst, TyVar)
</span><a href="GHC.Core.TyCo.Subst.html#substVarBndr"><span class="hs-identifier hs-var">substVarBndr</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564779"><span class="hs-identifier hs-var">empty_subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564773"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1742"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; ForAllTyFlag -&gt; VarBndr TyVar ForAllTyFlag
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564781"><span class="hs-identifier hs-var">tv'</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682564774"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Subst -&gt; Type -&gt; Type
Subst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682564780"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564775"><span class="hs-identifier hs-var">inner_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mk_cast_ty"><span class="hs-operator hs-var">`mk_cast_ty`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564767"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1743"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; ForAllTyFlag -&gt; VarBndr TyVar ForAllTyFlag
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564773"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682564774"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564775"><span class="hs-identifier hs-var">inner_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mk_cast_ty"><span class="hs-operator hs-var">`mk_cast_ty`</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564767"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1744"></span><span>
</span><span id="line-1745"></span><span>    </span><span class="annot"><a href="#local-6989586621682564768"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564766"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564767"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="hs-comment">-- NB: orig_ty: preserve synonyms if possible</span><span>
</span><span id="line-1746"></span><span>
</span><span id="line-1747"></span><span class="hs-comment">{-
Note [Using coreView in mk_cast_ty]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Invariants (EQ3) and (EQ4) of Note [Respecting definitional equality] in
GHC.Core.TyCo.Rep must apply regardless of type synonyms. For instance,
consider this example (#19742):

   type EqSameNat = () |&gt; co
   useNatEq :: EqSameNat |&gt; sym co

(Those casts aren't visible in the user-source code, of course; see #19742 for
what the user might write.)

The type `EqSameNat |&gt; sym co` looks as if it satisfies (EQ3), as it has no
nested casts, but if we expand EqSameNat, we see that it doesn't.
And then Bad Things happen.

The solution is easy: just use `coreView` when establishing (EQ3) and (EQ4) in
`mk_cast_ty`.
-}</span><span>
</span><span id="line-1767"></span><span>
</span><span id="line-1768"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                     CoercionTy
  CoercionTy allows us to inject coercions into types. A CoercionTy
  should appear only in the right-hand side of an application.
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-1775"></span><span>
</span><span id="line-1776"></span><span class="annot"><a href="GHC.Core.Type.html#mkCoercionTy"><span class="hs-identifier hs-type">mkCoercionTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1777"></span><span id="mkCoercionTy"><span class="annot"><span class="annottext">mkCoercionTy :: KindCoercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCoercionTy"><span class="hs-identifier hs-var hs-var">mkCoercionTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a></span><span>
</span><span id="line-1778"></span><span>
</span><span id="line-1779"></span><span class="annot"><a href="GHC.Core.Type.html#isCoercionTy"><span class="hs-identifier hs-type">isCoercionTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1780"></span><span id="isCoercionTy"><span class="annot"><span class="annottext">isCoercionTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isCoercionTy"><span class="hs-identifier hs-var hs-var">isCoercionTy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1781"></span><span class="annot"><a href="GHC.Core.Type.html#isCoercionTy"><span class="hs-identifier hs-var">isCoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1782"></span><span>
</span><span id="line-1783"></span><span class="annot"><a href="GHC.Core.Type.html#isCoercionTy_maybe"><span class="hs-identifier hs-type">isCoercionTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-1784"></span><span id="isCoercionTy_maybe"><span class="annot"><span class="annottext">isCoercionTy_maybe :: Type -&gt; Maybe KindCoercion
</span><a href="GHC.Core.Type.html#isCoercionTy_maybe"><span class="hs-identifier hs-var hs-var">isCoercionTy_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621682564782"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564782"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Maybe KindCoercion
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564782"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1785"></span><span class="annot"><a href="GHC.Core.Type.html#isCoercionTy_maybe"><span class="hs-identifier hs-var">isCoercionTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe KindCoercion
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1786"></span><span>
</span><span id="line-1787"></span><span class="annot"><a href="GHC.Core.Type.html#stripCoercionTy"><span class="hs-identifier hs-type">stripCoercionTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-1788"></span><span id="stripCoercionTy"><span class="annot"><span class="annottext">stripCoercionTy :: Type -&gt; KindCoercion
</span><a href="GHC.Core.Type.html#stripCoercionTy"><span class="hs-identifier hs-var hs-var">stripCoercionTy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621682564783"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564783"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682564783"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1789"></span><span class="annot"><a href="GHC.Core.Type.html#stripCoercionTy"><span class="hs-identifier hs-var">stripCoercionTy</span></a></span><span> </span><span id="local-6989586621682564784"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564784"><span class="hs-identifier hs-var">ty</span></a></span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; KindCoercion
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;stripCoercionTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564784"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1790"></span><span>
</span><span id="line-1791"></span><span>
</span><span id="line-1792"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                      ForAllTy
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-1797"></span><span>
</span><span id="line-1798"></span><span class="annot"><a href="GHC.Core.Type.html#tyConBindersPiTyBinders"><span class="hs-identifier hs-type">tyConBindersPiTyBinders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#PiTyBinder"><span class="hs-identifier hs-type">PiTyBinder</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1799"></span><span class="hs-comment">-- Return the tyConBinders in PiTyBinder form</span><span>
</span><span id="line-1800"></span><span id="tyConBindersPiTyBinders"><span class="annot"><span class="annottext">tyConBindersPiTyBinders :: [TyConBinder] -&gt; [PiTyBinder]
</span><a href="GHC.Core.Type.html#tyConBindersPiTyBinders"><span class="hs-identifier hs-var hs-var">tyConBindersPiTyBinders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyConBinder -&gt; PiTyBinder) -&gt; [TyConBinder] -&gt; [PiTyBinder]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TyConBinder -&gt; PiTyBinder
</span><a href="#local-6989586621682564785"><span class="hs-identifier hs-var">to_tyb</span></a></span><span>
</span><span id="line-1801"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1802"></span><span>    </span><span id="local-6989586621682564785"><span class="annot"><span class="annottext">to_tyb :: TyConBinder -&gt; PiTyBinder
</span><a href="#local-6989586621682564785"><span class="hs-identifier hs-var hs-var">to_tyb</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564786"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564786"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#NamedTCB"><span class="hs-identifier hs-type">NamedTCB</span></a></span><span> </span><span id="local-6989586621682564788"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682564788"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag -&gt; PiTyBinder
</span><a href="GHC.Types.Var.html#Named"><span class="hs-identifier hs-var">Named</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; ForAllTyFlag -&gt; VarBndr TyVar ForAllTyFlag
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564786"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682564788"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1803"></span><span>    </span><span class="annot"><a href="#local-6989586621682564785"><span class="hs-identifier hs-var">to_tyb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564790"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564790"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">TyConBndrVis
</span><a href="GHC.Core.TyCon.html#AnonTCB"><span class="hs-identifier hs-var">AnonTCB</span></a></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scaled Type -&gt; FunTyFlag -&gt; PiTyBinder
</span><a href="GHC.Types.Var.html#Anon"><span class="hs-identifier hs-var">Anon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Scaled Type
forall a. a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#tymult"><span class="hs-identifier hs-var">tymult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564790"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="GHC.Types.Var.html#FTF_T_T"><span class="hs-identifier hs-var">FTF_T_T</span></a></span><span>
</span><span id="line-1804"></span><span>
</span><span id="line-1805"></span><span class="annot"><span class="hs-comment">-- | Make a dependent forall over a TyCoVar</span></span><span>
</span><span id="line-1806"></span><span class="annot"><a href="GHC.Core.Type.html#mkTyCoForAllTy"><span class="hs-identifier hs-type">mkTyCoForAllTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Specificity.html#ForAllTyFlag"><span class="hs-identifier hs-type">ForAllTyFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1807"></span><span id="mkTyCoForAllTy"><span class="annot"><span class="annottext">mkTyCoForAllTy :: TyVar -&gt; ForAllTyFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyCoForAllTy"><span class="hs-identifier hs-var hs-var">mkTyCoForAllTy</span></a></span></span><span> </span><span id="local-6989586621682564793"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564793"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621682564794"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682564794"><span class="hs-identifier hs-var">vis</span></a></span></span><span> </span><span id="local-6989586621682564795"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564795"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1808"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564793"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1809"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564793"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564795"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1810"></span><span>   </span><span class="hs-comment">-- Maintain ForAllTy's invariants</span><span>
</span><span id="line-1811"></span><span>    </span><span class="hs-comment">-- See Note [Unused coercion variable in ForAllTy] in GHC.Core.TyCo.Rep</span><span>
</span><span id="line-1812"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type -&gt; Type
Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkVisFunTyMany"><span class="hs-identifier hs-var">mkVisFunTyMany</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564793"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564795"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1813"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1814"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; TyVar -&gt; VarBndr TyVar ForAllTyFlag
forall vis. vis -&gt; TyVar -&gt; VarBndr TyVar vis
</span><a href="GHC.Types.Var.html#mkForAllTyBinder"><span class="hs-identifier hs-var">mkForAllTyBinder</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682564794"><span class="hs-identifier hs-var">vis</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564793"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564795"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1815"></span><span>
</span><span id="line-1816"></span><span class="annot"><span class="hs-comment">-- | Make a dependent forall over a TyCoVar</span></span><span>
</span><span id="line-1817"></span><span class="annot"><a href="GHC.Core.Type.html#mkTyCoForAllTys"><span class="hs-identifier hs-type">mkTyCoForAllTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#ForAllTyBinder"><span class="hs-identifier hs-type">ForAllTyBinder</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1818"></span><span id="mkTyCoForAllTys"><span class="annot"><span class="annottext">mkTyCoForAllTys :: [VarBndr TyVar ForAllTyFlag] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyCoForAllTys"><span class="hs-identifier hs-var hs-var">mkTyCoForAllTys</span></a></span></span><span> </span><span id="local-6989586621682564797"><span class="annot"><span class="annottext">[VarBndr TyVar ForAllTyFlag]
</span><a href="#local-6989586621682564797"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span id="local-6989586621682564798"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564798"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1819"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarBndr TyVar ForAllTyFlag -&gt; Type -&gt; Type)
-&gt; Type -&gt; [VarBndr TyVar ForAllTyFlag] -&gt; Type
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564799"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564799"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682564800"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682564800"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; ForAllTyFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyCoForAllTy"><span class="hs-identifier hs-var">mkTyCoForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564799"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682564800"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564798"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TyVar ForAllTyFlag]
</span><a href="#local-6989586621682564797"><span class="hs-identifier hs-var">bndrs</span></a></span><span>
</span><span id="line-1820"></span><span>
</span><span id="line-1821"></span><span class="annot"><span class="hs-comment">-- | Make a dependent forall over an 'Inferred' variable</span></span><span>
</span><span id="line-1822"></span><span class="annot"><a href="GHC.Core.Type.html#mkTyCoInvForAllTy"><span class="hs-identifier hs-type">mkTyCoInvForAllTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1823"></span><span id="mkTyCoInvForAllTy"><span class="annot"><span class="annottext">mkTyCoInvForAllTy :: TyVar -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyCoInvForAllTy"><span class="hs-identifier hs-var hs-var">mkTyCoInvForAllTy</span></a></span></span><span> </span><span id="local-6989586621682564802"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564802"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621682564803"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564803"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; ForAllTyFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyCoForAllTy"><span class="hs-identifier hs-var">mkTyCoForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564802"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="Language.Haskell.Syntax.Specificity.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564803"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1824"></span><span>
</span><span id="line-1825"></span><span class="annot"><span class="hs-comment">-- | Like 'mkTyCoInvForAllTy', but tv should be a tyvar</span></span><span>
</span><span id="line-1826"></span><span class="annot"><a href="GHC.Core.Type.html#mkInfForAllTy"><span class="hs-identifier hs-type">mkInfForAllTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1827"></span><span id="mkInfForAllTy"><span class="annot"><span class="annottext">mkInfForAllTy :: TyVar -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkInfForAllTy"><span class="hs-identifier hs-var hs-var">mkInfForAllTy</span></a></span></span><span> </span><span id="local-6989586621682564804"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564804"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621682564805"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564805"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (VarBndr TyVar ForAllTyFlag -&gt; Type -&gt; Type)
-&gt; VarBndr TyVar ForAllTyFlag
-&gt; Type
-&gt; Type
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564804"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1828"></span><span>                      </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; ForAllTyFlag -&gt; VarBndr TyVar ForAllTyFlag
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564804"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="Language.Haskell.Syntax.Specificity.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564805"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1829"></span><span>
</span><span id="line-1830"></span><span class="hs-comment">-- | Like 'mkForAllTys', but assumes all variables are dependent and</span><span>
</span><span id="line-1831"></span><span class="hs-comment">-- 'Inferred', a common case</span><span>
</span><span id="line-1832"></span><span class="annot"><a href="GHC.Core.Type.html#mkTyCoInvForAllTys"><span class="hs-identifier hs-type">mkTyCoInvForAllTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1833"></span><span id="mkTyCoInvForAllTys"><span class="annot"><span class="annottext">mkTyCoInvForAllTys :: [TyVar] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyCoInvForAllTys"><span class="hs-identifier hs-var hs-var">mkTyCoInvForAllTys</span></a></span></span><span> </span><span id="local-6989586621682564806"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564806"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621682564807"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564807"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVar -&gt; Type -&gt; Type) -&gt; Type -&gt; [TyVar] -&gt; Type
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyCoInvForAllTy"><span class="hs-identifier hs-var">mkTyCoInvForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564807"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564806"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1834"></span><span>
</span><span id="line-1835"></span><span class="annot"><span class="hs-comment">-- | Like 'mkTyCoInvForAllTys', but tvs should be a list of tyvar</span></span><span>
</span><span id="line-1836"></span><span class="annot"><a href="GHC.Core.Type.html#mkInfForAllTys"><span class="hs-identifier hs-type">mkInfForAllTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1837"></span><span id="mkInfForAllTys"><span class="annot"><span class="annottext">mkInfForAllTys :: [TyVar] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkInfForAllTys"><span class="hs-identifier hs-var hs-var">mkInfForAllTys</span></a></span></span><span> </span><span id="local-6989586621682564808"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564808"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621682564809"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564809"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVar -&gt; Type -&gt; Type) -&gt; Type -&gt; [TyVar] -&gt; Type
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkInfForAllTy"><span class="hs-identifier hs-var">mkInfForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564809"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564808"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1838"></span><span>
</span><span id="line-1839"></span><span class="hs-comment">-- | Like 'mkForAllTy', but assumes the variable is dependent and 'Specified',</span><span>
</span><span id="line-1840"></span><span class="hs-comment">-- a common case</span><span>
</span><span id="line-1841"></span><span class="annot"><a href="GHC.Core.Type.html#mkSpecForAllTy"><span class="hs-identifier hs-type">mkSpecForAllTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1842"></span><span id="mkSpecForAllTy"><span class="annot"><span class="annottext">mkSpecForAllTy :: TyVar -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkSpecForAllTy"><span class="hs-identifier hs-var hs-var">mkSpecForAllTy</span></a></span></span><span> </span><span id="local-6989586621682564811"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564811"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621682564812"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564812"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (VarBndr TyVar ForAllTyFlag -&gt; Type -&gt; Type)
-&gt; VarBndr TyVar ForAllTyFlag
-&gt; Type
-&gt; Type
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564811"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1843"></span><span>                       </span><span class="hs-comment">-- covar is always Inferred, so input should be tyvar</span><span>
</span><span id="line-1844"></span><span>                       </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; ForAllTyFlag -&gt; VarBndr TyVar ForAllTyFlag
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564811"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="Language.Haskell.Syntax.Specificity.html#Specified"><span class="hs-identifier hs-var">Specified</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564812"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1845"></span><span>
</span><span id="line-1846"></span><span class="hs-comment">-- | Like 'mkForAllTys', but assumes all variables are dependent and</span><span>
</span><span id="line-1847"></span><span class="hs-comment">-- 'Specified', a common case</span><span>
</span><span id="line-1848"></span><span class="annot"><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier hs-type">mkSpecForAllTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1849"></span><span id="mkSpecForAllTys"><span class="annot"><span class="annottext">mkSpecForAllTys :: [TyVar] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var hs-var">mkSpecForAllTys</span></a></span></span><span> </span><span id="local-6989586621682564813"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564813"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621682564814"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564814"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVar -&gt; Type -&gt; Type) -&gt; Type -&gt; [TyVar] -&gt; Type
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkSpecForAllTy"><span class="hs-identifier hs-var">mkSpecForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564814"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564813"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1850"></span><span>
</span><span id="line-1851"></span><span class="annot"><span class="hs-comment">-- | Like mkForAllTys, but assumes all variables are dependent and visible</span></span><span>
</span><span id="line-1852"></span><span class="annot"><a href="GHC.Core.Type.html#mkVisForAllTys"><span class="hs-identifier hs-type">mkVisForAllTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1853"></span><span id="mkVisForAllTys"><span class="annot"><span class="annottext">mkVisForAllTys :: [TyVar] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkVisForAllTys"><span class="hs-identifier hs-var hs-var">mkVisForAllTys</span></a></span></span><span> </span><span id="local-6989586621682564815"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564815"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; ([VarBndr TyVar ForAllTyFlag] -&gt; Type -&gt; Type)
-&gt; [VarBndr TyVar ForAllTyFlag]
-&gt; Type
-&gt; Type
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyVar -&gt; Bool) -&gt; [TyVar] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564815"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1854"></span><span>                     </span><span class="hs-comment">-- covar is always Inferred, so all inputs should be tyvar</span><span>
</span><span id="line-1855"></span><span>                     </span><span class="annot"><span class="annottext">[VarBndr TyVar ForAllTyFlag] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkForAllTys"><span class="hs-identifier hs-var">mkForAllTys</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; ForAllTyFlag -&gt; VarBndr TyVar ForAllTyFlag
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564817"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="Language.Haskell.Syntax.Specificity.html#Required"><span class="hs-identifier hs-var">Required</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682564817"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564817"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564815"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1856"></span><span>
</span><span id="line-1857"></span><span class="hs-comment">-- | Given a list of type-level vars and the free vars of a result kind,</span><span>
</span><span id="line-1858"></span><span class="hs-comment">-- makes PiTyBinders, preferring anonymous binders</span><span>
</span><span id="line-1859"></span><span class="hs-comment">-- if the variable is, in fact, not dependent.</span><span>
</span><span id="line-1860"></span><span class="hs-comment">-- e.g.    mkTyConBindersPreferAnon [(k:*),(b:k),(c:k)] (k-&gt;k)</span><span>
</span><span id="line-1861"></span><span class="hs-comment">-- We want (k:*) Named, (b:k) Anon, (c:k) Anon</span><span>
</span><span id="line-1862"></span><span class="hs-comment">--</span><span>
</span><span id="line-1863"></span><span class="hs-comment">-- All non-coercion binders are /visible/.</span><span>
</span><span id="line-1864"></span><span class="annot"><a href="GHC.Core.Type.html#mkTyConBindersPreferAnon"><span class="hs-identifier hs-type">mkTyConBindersPreferAnon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span>      </span><span class="annot"><span class="hs-comment">-- ^ binders</span></span><span>
</span><span id="line-1865"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ free variables of result</span></span><span>
</span><span id="line-1866"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1867"></span><span id="mkTyConBindersPreferAnon"><span class="annot"><span class="annottext">mkTyConBindersPreferAnon :: [TyVar] -&gt; VarSet -&gt; [TyConBinder]
</span><a href="GHC.Core.Type.html#mkTyConBindersPreferAnon"><span class="hs-identifier hs-var hs-var">mkTyConBindersPreferAnon</span></a></span></span><span> </span><span id="local-6989586621682564820"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564820"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621682564821"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682564821"><span class="hs-identifier hs-var">inner_tkvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (([TyConBinder], VarSet) -&gt; [TyConBinder])
-&gt; ([TyConBinder], VarSet)
-&gt; [TyConBinder]
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyVar -&gt; Bool) -&gt; [TyVar] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564820"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1868"></span><span>                                           </span><span class="annot"><span class="annottext">([TyConBinder], VarSet) -&gt; [TyConBinder]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; ([TyConBinder], VarSet)
</span><a href="#local-6989586621682564823"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564820"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1869"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1870"></span><span>    </span><span class="annot"><a href="#local-6989586621682564823"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- also returns the free vars</span><span>
</span><span id="line-1871"></span><span>    </span><span id="local-6989586621682564823"><span class="annot"><span class="annottext">go :: [TyVar] -&gt; ([TyConBinder], VarSet)
</span><a href="#local-6989586621682564823"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682564821"><span class="hs-identifier hs-var">inner_tkvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1872"></span><span>    </span><span class="annot"><a href="#local-6989586621682564823"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682564824"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564824"><span class="hs-identifier hs-var">v</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682564825"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564825"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564824"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682564826"><span class="hs-identifier hs-var">fvs</span></a></span><span>
</span><span id="line-1873"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TyConBndrVis -&gt; TyConBinder
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564824"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; TyConBndrVis
</span><a href="GHC.Core.TyCon.html#NamedTCB"><span class="hs-identifier hs-var">NamedTCB</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="Language.Haskell.Syntax.Specificity.html#Required"><span class="hs-identifier hs-var">Required</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyConBinder -&gt; [TyConBinder] -&gt; [TyConBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621682564827"><span class="hs-identifier hs-var">binders</span></a></span><span>
</span><span id="line-1874"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682564826"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; TyVar -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#delVarSet"><span class="hs-operator hs-var">`delVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564824"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#unionVarSet"><span class="hs-operator hs-var">`unionVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682564830"><span class="hs-identifier hs-var">kind_vars</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1875"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1876"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TyConBndrVis -&gt; TyConBinder
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564824"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">TyConBndrVis
</span><a href="GHC.Core.TyCon.html#AnonTCB"><span class="hs-identifier hs-var">AnonTCB</span></a></span><span> </span><span class="annot"><span class="annottext">TyConBinder -&gt; [TyConBinder] -&gt; [TyConBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621682564827"><span class="hs-identifier hs-var">binders</span></a></span><span>
</span><span id="line-1877"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682564826"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#unionVarSet"><span class="hs-operator hs-var">`unionVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682564830"><span class="hs-identifier hs-var">kind_vars</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1878"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1879"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682564827"><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621682564827"><span class="hs-identifier hs-var">binders</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682564826"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682564826"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; ([TyConBinder], VarSet)
</span><a href="#local-6989586621682564823"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564825"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-1880"></span><span>        </span><span id="local-6989586621682564830"><span class="annot"><span class="annottext">kind_vars :: VarSet
</span><a href="#local-6989586621682564830"><span class="hs-identifier hs-var hs-var">kind_vars</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; VarSet) -&gt; Type -&gt; VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564824"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1881"></span><span>
</span><span id="line-1882"></span><span class="annot"><span class="hs-comment">-- | Take a ForAllTy apart, returning the binders and result type</span></span><span>
</span><span id="line-1883"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllForAllTyBinders"><span class="hs-identifier hs-type">splitForAllForAllTyBinders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#ForAllTyBinder"><span class="hs-identifier hs-type">ForAllTyBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1884"></span><span id="splitForAllForAllTyBinders"><span class="annot"><span class="annottext">splitForAllForAllTyBinders :: Type -&gt; ([VarBndr TyVar ForAllTyFlag], Type)
</span><a href="GHC.Core.Type.html#splitForAllForAllTyBinders"><span class="hs-identifier hs-var hs-var">splitForAllForAllTyBinders</span></a></span></span><span> </span><span id="local-6989586621682564831"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564831"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
-&gt; Type
-&gt; [VarBndr TyVar ForAllTyFlag]
-&gt; ([VarBndr TyVar ForAllTyFlag], Type)
</span><a href="#local-6989586621682564832"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564831"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564831"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1885"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1886"></span><span>    </span><span id="local-6989586621682564832"><span class="annot"><span class="annottext">split :: Type
-&gt; Type
-&gt; [VarBndr TyVar ForAllTyFlag]
-&gt; ([VarBndr TyVar ForAllTyFlag], Type)
</span><a href="#local-6989586621682564832"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span id="local-6989586621682564833"><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><a href="#local-6989586621682564833"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621682564834"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564834"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564835"><span class="annot"><span class="annottext">[VarBndr TyVar ForAllTyFlag]
</span><a href="#local-6989586621682564835"><span class="hs-identifier hs-var">bs</span></a></span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
-&gt; Type
-&gt; [VarBndr TyVar ForAllTyFlag]
-&gt; ([VarBndr TyVar ForAllTyFlag], Type)
</span><a href="#local-6989586621682564832"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564834"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564834"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><a href="#local-6989586621682564833"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
-&gt; [VarBndr TyVar ForAllTyFlag] -&gt; [VarBndr TyVar ForAllTyFlag]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[VarBndr TyVar ForAllTyFlag]
</span><a href="#local-6989586621682564835"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1887"></span><span>    </span><span class="annot"><a href="#local-6989586621682564832"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564836"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564836"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621682564837"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564837"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564838"><span class="annot"><span class="annottext">[VarBndr TyVar ForAllTyFlag]
</span><a href="#local-6989586621682564838"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564839"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564839"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564837"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
-&gt; Type
-&gt; [VarBndr TyVar ForAllTyFlag]
-&gt; ([VarBndr TyVar ForAllTyFlag], Type)
</span><a href="#local-6989586621682564832"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564836"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564839"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TyVar ForAllTyFlag]
</span><a href="#local-6989586621682564838"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-1888"></span><span>    </span><span class="annot"><a href="#local-6989586621682564832"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564840"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564840"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                </span><span id="local-6989586621682564841"><span class="annot"><span class="annottext">[VarBndr TyVar ForAllTyFlag]
</span><a href="#local-6989586621682564841"><span class="hs-identifier hs-var">bs</span></a></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VarBndr TyVar ForAllTyFlag] -&gt; [VarBndr TyVar ForAllTyFlag]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[VarBndr TyVar ForAllTyFlag]
</span><a href="#local-6989586621682564841"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564840"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1889"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllForAllTyBinders"><span class="hs-pragma hs-type">splitForAllForAllTyBinders</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1890"></span><span>
</span><span id="line-1891"></span><span class="hs-comment">-- | Take a ForAllTy apart, returning the list of tycovars and the result type.</span><span>
</span><span id="line-1892"></span><span class="hs-comment">-- This always succeeds, even if it returns only an empty list. Note that the</span><span>
</span><span id="line-1893"></span><span class="hs-comment">-- result type returned may have free variables that were bound by a forall.</span><span>
</span><span id="line-1894"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTyCoVars"><span class="hs-identifier hs-type">splitForAllTyCoVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1895"></span><span id="splitForAllTyCoVars"><span class="annot"><span class="annottext">splitForAllTyCoVars :: Type -&gt; ([TyVar], Type)
</span><a href="GHC.Core.Type.html#splitForAllTyCoVars"><span class="hs-identifier hs-var hs-var">splitForAllTyCoVars</span></a></span></span><span> </span><span id="local-6989586621682564842"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564842"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621682564843"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564842"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564842"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1896"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1897"></span><span>    </span><span id="local-6989586621682564843"><span class="annot"><span class="annottext">split :: Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621682564843"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564844"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564844"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564845"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564845"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>    </span><span id="local-6989586621682564846"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564846"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621682564843"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564845"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564845"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564844"><span class="hs-identifier hs-var">tv</span></a></span><span class="annot"><span class="annottext">TyVar -&gt; [TyVar] -&gt; [TyVar]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564846"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1898"></span><span>    </span><span class="annot"><a href="#local-6989586621682564843"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564847"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564847"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621682564848"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564848"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564849"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564849"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564850"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564850"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564848"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621682564843"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564847"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564850"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564849"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1899"></span><span>    </span><span class="annot"><a href="#local-6989586621682564843"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564851"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564851"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                            </span><span id="local-6989586621682564852"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564852"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; [TyVar]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564852"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564851"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1900"></span><span>
</span><span id="line-1901"></span><span class="hs-comment">-- | Like 'splitForAllTyCoVars', but split only for tyvars.</span><span>
</span><span id="line-1902"></span><span class="hs-comment">-- This always succeeds, even if it returns only an empty list. Note that the</span><span>
</span><span id="line-1903"></span><span class="hs-comment">-- result type returned may have free variables that were bound by a forall.</span><span>
</span><span id="line-1904"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTyVars"><span class="hs-identifier hs-type">splitForAllTyVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1905"></span><span id="splitForAllTyVars"><span class="annot"><span class="annottext">splitForAllTyVars :: Type -&gt; ([TyVar], Type)
</span><a href="GHC.Core.Type.html#splitForAllTyVars"><span class="hs-identifier hs-var hs-var">splitForAllTyVars</span></a></span></span><span> </span><span id="local-6989586621682564853"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564853"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621682564854"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564853"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564853"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1906"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1907"></span><span>    </span><span id="local-6989586621682564854"><span class="annot"><span class="annottext">split :: Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621682564854"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564855"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564855"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564856"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564856"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564857"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564857"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564855"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621682564854"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564856"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564856"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564855"><span class="hs-identifier hs-var">tv</span></a></span><span class="annot"><span class="annottext">TyVar -&gt; [TyVar] -&gt; [TyVar]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564857"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1908"></span><span>    </span><span class="annot"><a href="#local-6989586621682564854"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564858"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564858"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621682564859"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564859"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564860"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564860"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564861"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564861"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564859"><span class="hs-identifier hs-var">ty</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621682564854"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564858"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564861"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564860"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1909"></span><span>    </span><span class="annot"><a href="#local-6989586621682564854"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564862"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564862"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                   </span><span id="local-6989586621682564863"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564863"><span class="hs-identifier hs-var">tvs</span></a></span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; [TyVar]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682564863"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564862"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1910"></span><span>
</span><span id="line-1911"></span><span class="hs-comment">-- | Like 'splitForAllTyCoVars', but only splits 'ForAllTy's with 'Required' type</span><span>
</span><span id="line-1912"></span><span class="hs-comment">-- variable binders. Furthermore, each returned tyvar is annotated with '()'.</span><span>
</span><span id="line-1913"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllReqTyBinders"><span class="hs-identifier hs-type">splitForAllReqTyBinders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#ReqTyBinder"><span class="hs-identifier hs-type">ReqTyBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1914"></span><span id="splitForAllReqTyBinders"><span class="annot"><span class="annottext">splitForAllReqTyBinders :: Type -&gt; ([ReqTyBinder], Type)
</span><a href="GHC.Core.Type.html#splitForAllReqTyBinders"><span class="hs-identifier hs-var hs-var">splitForAllReqTyBinders</span></a></span></span><span> </span><span id="local-6989586621682564864"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564864"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [ReqTyBinder] -&gt; ([ReqTyBinder], Type)
</span><a href="#local-6989586621682564865"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564864"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564864"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1915"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1916"></span><span>    </span><span id="local-6989586621682564865"><span class="annot"><span class="annottext">split :: Type -&gt; Type -&gt; [ReqTyBinder] -&gt; ([ReqTyBinder], Type)
</span><a href="#local-6989586621682564865"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564866"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564866"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="Language.Haskell.Syntax.Specificity.html#Required"><span class="hs-identifier hs-var">Required</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564867"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564867"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564868"><span class="annot"><span class="annottext">[ReqTyBinder]
</span><a href="#local-6989586621682564868"><span class="hs-identifier hs-var">tvs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [ReqTyBinder] -&gt; ([ReqTyBinder], Type)
</span><a href="#local-6989586621682564865"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564867"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564867"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; () -&gt; ReqTyBinder
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564866"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="annot"><span class="annottext">ReqTyBinder -&gt; [ReqTyBinder] -&gt; [ReqTyBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[ReqTyBinder]
</span><a href="#local-6989586621682564868"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1917"></span><span>    </span><span class="annot"><a href="#local-6989586621682564865"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564869"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564869"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621682564870"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564870"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564871"><span class="annot"><span class="annottext">[ReqTyBinder]
</span><a href="#local-6989586621682564871"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564872"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564872"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564870"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [ReqTyBinder] -&gt; ([ReqTyBinder], Type)
</span><a href="#local-6989586621682564865"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564869"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564872"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[ReqTyBinder]
</span><a href="#local-6989586621682564871"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1918"></span><span>    </span><span class="annot"><a href="#local-6989586621682564865"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564873"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564873"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                   </span><span id="local-6989586621682564874"><span class="annot"><span class="annottext">[ReqTyBinder]
</span><a href="#local-6989586621682564874"><span class="hs-identifier hs-var">tvs</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ReqTyBinder] -&gt; [ReqTyBinder]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[ReqTyBinder]
</span><a href="#local-6989586621682564874"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564873"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1919"></span><span>
</span><span id="line-1920"></span><span class="hs-comment">-- | Like 'splitForAllTyCoVars', but only splits 'ForAllTy's with 'Invisible' type</span><span>
</span><span id="line-1921"></span><span class="hs-comment">-- variable binders. Furthermore, each returned tyvar is annotated with its</span><span>
</span><span id="line-1922"></span><span class="hs-comment">-- 'Specificity'.</span><span>
</span><span id="line-1923"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllInvisTyBinders"><span class="hs-identifier hs-type">splitForAllInvisTyBinders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#InvisTyBinder"><span class="hs-identifier hs-type">InvisTyBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1924"></span><span id="splitForAllInvisTyBinders"><span class="annot"><span class="annottext">splitForAllInvisTyBinders :: Type -&gt; ([InvisTyBinder], Type)
</span><a href="GHC.Core.Type.html#splitForAllInvisTyBinders"><span class="hs-identifier hs-var hs-var">splitForAllInvisTyBinders</span></a></span></span><span> </span><span id="local-6989586621682564876"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564876"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [InvisTyBinder] -&gt; ([InvisTyBinder], Type)
</span><a href="#local-6989586621682564877"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564876"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564876"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1925"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1926"></span><span>    </span><span id="local-6989586621682564877"><span class="annot"><span class="annottext">split :: Type -&gt; Type -&gt; [InvisTyBinder] -&gt; ([InvisTyBinder], Type)
</span><a href="#local-6989586621682564877"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564878"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564878"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Specificity.html#Invisible"><span class="hs-identifier hs-type">Invisible</span></a></span><span> </span><span id="local-6989586621682564879"><span class="annot"><span class="annottext">Specificity
</span><a href="#local-6989586621682564879"><span class="hs-identifier hs-var">spec</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564880"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564880"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564881"><span class="annot"><span class="annottext">[InvisTyBinder]
</span><a href="#local-6989586621682564881"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [InvisTyBinder] -&gt; ([InvisTyBinder], Type)
</span><a href="#local-6989586621682564877"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564880"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564880"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Specificity -&gt; InvisTyBinder
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564878"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Specificity
</span><a href="#local-6989586621682564879"><span class="hs-identifier hs-var">spec</span></a></span><span class="annot"><span class="annottext">InvisTyBinder -&gt; [InvisTyBinder] -&gt; [InvisTyBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[InvisTyBinder]
</span><a href="#local-6989586621682564881"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1927"></span><span>    </span><span class="annot"><a href="#local-6989586621682564877"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564882"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564882"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621682564883"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564883"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564884"><span class="annot"><span class="annottext">[InvisTyBinder]
</span><a href="#local-6989586621682564884"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564885"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564885"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564883"><span class="hs-identifier hs-var">ty</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [InvisTyBinder] -&gt; ([InvisTyBinder], Type)
</span><a href="#local-6989586621682564877"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564882"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564885"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[InvisTyBinder]
</span><a href="#local-6989586621682564884"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1928"></span><span>    </span><span class="annot"><a href="#local-6989586621682564877"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564886"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564886"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                   </span><span id="local-6989586621682564887"><span class="annot"><span class="annottext">[InvisTyBinder]
</span><a href="#local-6989586621682564887"><span class="hs-identifier hs-var">tvs</span></a></span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[InvisTyBinder] -&gt; [InvisTyBinder]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[InvisTyBinder]
</span><a href="#local-6989586621682564887"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564886"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1929"></span><span>
</span><span id="line-1930"></span><span class="annot"><span class="hs-comment">-- | Checks whether this is a proper forall (with a named binder)</span></span><span>
</span><span id="line-1931"></span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy"><span class="hs-identifier hs-type">isForAllTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1932"></span><span id="isForAllTy"><span class="annot"><span class="annottext">isForAllTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isForAllTy"><span class="hs-identifier hs-var hs-var">isForAllTy</span></a></span></span><span> </span><span id="local-6989586621682564888"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564888"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1933"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564888"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1934"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1935"></span><span>
</span><span id="line-1936"></span><span class="annot"><span class="hs-comment">-- | Like `isForAllTy`, but returns True only if it is a tyvar binder</span></span><span>
</span><span id="line-1937"></span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy_ty"><span class="hs-identifier hs-type">isForAllTy_ty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1938"></span><span id="isForAllTy_ty"><span class="annot"><span class="annottext">isForAllTy_ty :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isForAllTy_ty"><span class="hs-identifier hs-var hs-var">isForAllTy_ty</span></a></span></span><span> </span><span id="local-6989586621682564889"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564889"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1939"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564890"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564890"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564889"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1940"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564890"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1941"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1942"></span><span>
</span><span id="line-1943"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1944"></span><span>
</span><span id="line-1945"></span><span class="annot"><span class="hs-comment">-- | Like `isForAllTy`, but returns True only if it is an inferred tyvar binder</span></span><span>
</span><span id="line-1946"></span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy_invis_ty"><span class="hs-identifier hs-type">isForAllTy_invis_ty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1947"></span><span id="isForAllTy_invis_ty"><span class="annot"><span class="annottext">isForAllTy_invis_ty :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isForAllTy_invis_ty"><span class="hs-identifier hs-var hs-var">isForAllTy_invis_ty</span></a></span></span><span>  </span><span id="local-6989586621682564891"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564891"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1948"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564892"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564892"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Specificity.html#Invisible"><span class="hs-identifier hs-type">Invisible</span></a></span><span> </span><span class="annot"><span class="annottext">Specificity
</span><a href="Language.Haskell.Syntax.Specificity.html#InferredSpec"><span class="hs-identifier hs-var">InferredSpec</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564891"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1949"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564892"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1950"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1951"></span><span>
</span><span id="line-1952"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1953"></span><span>
</span><span id="line-1954"></span><span class="annot"><span class="hs-comment">-- | Like `isForAllTy`, but returns True only if it is a covar binder</span></span><span>
</span><span id="line-1955"></span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy_co"><span class="hs-identifier hs-type">isForAllTy_co</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1956"></span><span id="isForAllTy_co"><span class="annot"><span class="annottext">isForAllTy_co :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isForAllTy_co"><span class="hs-identifier hs-var hs-var">isForAllTy_co</span></a></span></span><span> </span><span id="local-6989586621682564894"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564894"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1957"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564895"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564895"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564894"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1958"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564895"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1959"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1960"></span><span>
</span><span id="line-1961"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1962"></span><span>
</span><span id="line-1963"></span><span class="annot"><span class="hs-comment">-- | Is this a function or forall?</span></span><span>
</span><span id="line-1964"></span><span class="annot"><a href="GHC.Core.Type.html#isPiTy"><span class="hs-identifier hs-type">isPiTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1965"></span><span id="isPiTy"><span class="annot"><span class="annottext">isPiTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isPiTy"><span class="hs-identifier hs-var hs-var">isPiTy</span></a></span></span><span> </span><span id="local-6989586621682564896"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564896"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564896"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1966"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1967"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1968"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1969"></span><span>
</span><span id="line-1970"></span><span class="hs-comment">-- | Is this a function?</span><span>
</span><span id="line-1971"></span><span class="hs-comment">-- Note: `forall {b}. Show b =&gt; b -&gt; IO b` will not be considered a function by this function.</span><span>
</span><span id="line-1972"></span><span class="hs-comment">--       It would merely be a forall wrapping a function type.</span><span>
</span><span id="line-1973"></span><span class="annot"><a href="GHC.Core.Type.html#isFunTy"><span class="hs-identifier hs-type">isFunTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1974"></span><span id="isFunTy"><span class="annot"><span class="annottext">isFunTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFunTy"><span class="hs-identifier hs-var hs-var">isFunTy</span></a></span></span><span> </span><span id="local-6989586621682564897"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564897"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1975"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564897"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1976"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1977"></span><span>
</span><span id="line-1978"></span><span class="annot"><span class="hs-comment">-- | Take a forall type apart, or panics if that is not possible.</span></span><span>
</span><span id="line-1979"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTyCoVar"><span class="hs-identifier hs-type">splitForAllTyCoVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1980"></span><span id="splitForAllTyCoVar"><span class="annot"><span class="annottext">splitForAllTyCoVar :: Type -&gt; (TyVar, Type)
</span><a href="GHC.Core.Type.html#splitForAllTyCoVar"><span class="hs-identifier hs-var hs-var">splitForAllTyCoVar</span></a></span></span><span> </span><span id="local-6989586621682564898"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564898"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1981"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564899"><span class="annot"><span class="annottext">(TyVar, Type)
</span><a href="#local-6989586621682564899"><span class="hs-identifier hs-var">answer</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TyVar, Type)
</span><a href="GHC.Core.Type.html#splitForAllTyCoVar_maybe"><span class="hs-identifier hs-var">splitForAllTyCoVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564898"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVar, Type)
</span><a href="#local-6989586621682564899"><span class="hs-identifier hs-var">answer</span></a></span><span>
</span><span id="line-1982"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; (TyVar, Type)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitForAllTyCoVar&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564898"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1983"></span><span>
</span><span id="line-1984"></span><span class="annot"><span class="hs-comment">-- | Drops all ForAllTys</span></span><span>
</span><span id="line-1985"></span><span class="annot"><a href="GHC.Core.Type.html#dropForAlls"><span class="hs-identifier hs-type">dropForAlls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1986"></span><span id="dropForAlls"><span class="annot"><span class="annottext">dropForAlls :: Type -&gt; Type
</span><a href="GHC.Core.Type.html#dropForAlls"><span class="hs-identifier hs-var hs-var">dropForAlls</span></a></span></span><span> </span><span id="local-6989586621682564900"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564900"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621682564901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564900"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1987"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1988"></span><span>    </span><span id="local-6989586621682564901"><span class="annot"><span class="annottext">go :: Type -&gt; Type
</span><a href="#local-6989586621682564901"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682564902"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564902"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621682564901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564902"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1989"></span><span>    </span><span class="annot"><a href="#local-6989586621682564901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682564903"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564903"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564904"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564904"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564903"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621682564901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564904"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1990"></span><span>    </span><span class="annot"><a href="#local-6989586621682564901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682564905"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564905"><span class="hs-identifier hs-var">res</span></a></span></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564905"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1991"></span><span>
</span><span id="line-1992"></span><span class="annot"><span class="hs-comment">-- | Attempts to take a ForAllTy apart, returning the full ForAllTyBinder</span></span><span>
</span><span id="line-1993"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllForAllTyBinder_maybe"><span class="hs-identifier hs-type">splitForAllForAllTyBinder_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#ForAllTyBinder"><span class="hs-identifier hs-type">ForAllTyBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1994"></span><span id="splitForAllForAllTyBinder_maybe"><span class="annot"><span class="annottext">splitForAllForAllTyBinder_maybe :: Type -&gt; Maybe (VarBndr TyVar ForAllTyFlag, Type)
</span><a href="GHC.Core.Type.html#splitForAllForAllTyBinder_maybe"><span class="hs-identifier hs-var hs-var">splitForAllForAllTyBinder_maybe</span></a></span></span><span> </span><span id="local-6989586621682564906"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564906"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1995"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span id="local-6989586621682564907"><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><a href="#local-6989586621682564907"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621682564908"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564908"><span class="hs-identifier hs-var">inner_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564906"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarBndr TyVar ForAllTyFlag, Type)
-&gt; Maybe (VarBndr TyVar ForAllTyFlag, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><a href="#local-6989586621682564907"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564908"><span class="hs-identifier hs-var">inner_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1996"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (VarBndr TyVar ForAllTyFlag, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1997"></span><span>
</span><span id="line-1998"></span><span>
</span><span id="line-1999"></span><span class="annot"><span class="hs-comment">-- | Attempts to take a ForAllTy apart, returning the Var</span></span><span>
</span><span id="line-2000"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTyCoVar_maybe"><span class="hs-identifier hs-type">splitForAllTyCoVar_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2001"></span><span id="splitForAllTyCoVar_maybe"><span class="annot"><span class="annottext">splitForAllTyCoVar_maybe :: Type -&gt; Maybe (TyVar, Type)
</span><a href="GHC.Core.Type.html#splitForAllTyCoVar_maybe"><span class="hs-identifier hs-var hs-var">splitForAllTyCoVar_maybe</span></a></span></span><span> </span><span id="local-6989586621682564909"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564909"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2002"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564910"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564910"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564911"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564911"><span class="hs-identifier hs-var">inner_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564909"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVar, Type) -&gt; Maybe (TyVar, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564910"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564911"><span class="hs-identifier hs-var">inner_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2003"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TyVar, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2004"></span><span>
</span><span id="line-2005"></span><span class="annot"><span class="hs-comment">-- | Attempts to take a ForAllTy apart, but only if the binder is a TyVar</span></span><span>
</span><span id="line-2006"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTyVar_maybe"><span class="hs-identifier hs-type">splitForAllTyVar_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2007"></span><span id="splitForAllTyVar_maybe"><span class="annot"><span class="annottext">splitForAllTyVar_maybe :: Type -&gt; Maybe (TyVar, Type)
</span><a href="GHC.Core.Type.html#splitForAllTyVar_maybe"><span class="hs-identifier hs-var hs-var">splitForAllTyVar_maybe</span></a></span></span><span> </span><span id="local-6989586621682564912"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564912"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2008"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564913"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564913"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564914"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564914"><span class="hs-identifier hs-var">inner_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564912"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2009"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564913"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-2010"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVar, Type) -&gt; Maybe (TyVar, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564913"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564914"><span class="hs-identifier hs-var">inner_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2011"></span><span>
</span><span id="line-2012"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TyVar, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2013"></span><span>
</span><span id="line-2014"></span><span class="annot"><span class="hs-comment">-- | Like 'splitForAllTyCoVar_maybe', but only returns Just if it is a covar binder.</span></span><span>
</span><span id="line-2015"></span><span class="annot"><a href="GHC.Core.Type.html#splitForAllCoVar_maybe"><span class="hs-identifier hs-type">splitForAllCoVar_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2016"></span><span id="splitForAllCoVar_maybe"><span class="annot"><span class="annottext">splitForAllCoVar_maybe :: Type -&gt; Maybe (TyVar, Type)
</span><a href="GHC.Core.Type.html#splitForAllCoVar_maybe"><span class="hs-identifier hs-var hs-var">splitForAllCoVar_maybe</span></a></span></span><span> </span><span id="local-6989586621682564915"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564915"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2017"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682564916"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564916"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564917"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564917"><span class="hs-identifier hs-var">inner_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564915"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2018"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564916"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-2019"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVar, Type) -&gt; Maybe (TyVar, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682564916"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564917"><span class="hs-identifier hs-var">inner_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2020"></span><span>
</span><span id="line-2021"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TyVar, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2022"></span><span>
</span><span id="line-2023"></span><span class="hs-comment">-- | Attempts to take a forall type apart; works with proper foralls and</span><span>
</span><span id="line-2024"></span><span class="hs-comment">-- functions</span><span>
</span><span id="line-2025"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitPiTy_maybe"><span class="hs-pragma hs-type">splitPiTy_maybe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>  </span><span class="hs-comment">-- callers will immediately deconstruct</span><span>
</span><span id="line-2026"></span><span class="annot"><a href="GHC.Core.Type.html#splitPiTy_maybe"><span class="hs-identifier hs-type">splitPiTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#PiTyBinder"><span class="hs-identifier hs-type">PiTyBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2027"></span><span id="splitPiTy_maybe"><span class="annot"><span class="annottext">splitPiTy_maybe :: Type -&gt; Maybe (PiTyBinder, Type)
</span><a href="GHC.Core.Type.html#splitPiTy_maybe"><span class="hs-identifier hs-var hs-var">splitPiTy_maybe</span></a></span></span><span> </span><span id="local-6989586621682564918"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564918"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564918"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2028"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span id="local-6989586621682564919"><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><a href="#local-6989586621682564919"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621682564920"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564920"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PiTyBinder, Type) -&gt; Maybe (PiTyBinder, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag -&gt; PiTyBinder
</span><a href="GHC.Types.Var.html#Named"><span class="hs-identifier hs-var">Named</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><a href="#local-6989586621682564919"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564920"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2029"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564921"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564921"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564922"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564922"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564923"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564923"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564924"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564924"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">}</span><span>
</span><span id="line-2030"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PiTyBinder, Type) -&gt; Maybe (PiTyBinder, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scaled Type -&gt; FunTyFlag -&gt; PiTyBinder
</span><a href="GHC.Types.Var.html#Anon"><span class="hs-identifier hs-var">Anon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#mkScaled"><span class="hs-identifier hs-var">mkScaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564922"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564923"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564921"><span class="hs-identifier hs-var">af</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564924"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2031"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (PiTyBinder, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2032"></span><span>
</span><span id="line-2033"></span><span class="annot"><span class="hs-comment">-- | Takes a forall type apart, or panics</span></span><span>
</span><span id="line-2034"></span><span class="annot"><a href="GHC.Core.Type.html#splitPiTy"><span class="hs-identifier hs-type">splitPiTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#PiTyBinder"><span class="hs-identifier hs-type">PiTyBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2035"></span><span id="splitPiTy"><span class="annot"><span class="annottext">splitPiTy :: Type -&gt; (PiTyBinder, Type)
</span><a href="GHC.Core.Type.html#splitPiTy"><span class="hs-identifier hs-var hs-var">splitPiTy</span></a></span></span><span> </span><span id="local-6989586621682564925"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564925"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2036"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564926"><span class="annot"><span class="annottext">(PiTyBinder, Type)
</span><a href="#local-6989586621682564926"><span class="hs-identifier hs-var">answer</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (PiTyBinder, Type)
</span><a href="GHC.Core.Type.html#splitPiTy_maybe"><span class="hs-identifier hs-var">splitPiTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564925"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PiTyBinder, Type)
</span><a href="#local-6989586621682564926"><span class="hs-identifier hs-var">answer</span></a></span><span>
</span><span id="line-2037"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; (PiTyBinder, Type)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitPiTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564925"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2038"></span><span>
</span><span id="line-2039"></span><span class="hs-comment">-- | Split off all PiTyBinders to a type, splitting both proper foralls</span><span>
</span><span id="line-2040"></span><span class="hs-comment">-- and functions</span><span>
</span><span id="line-2041"></span><span class="annot"><a href="GHC.Core.Type.html#splitPiTys"><span class="hs-identifier hs-type">splitPiTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#PiTyBinder"><span class="hs-identifier hs-type">PiTyBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2042"></span><span id="splitPiTys"><span class="annot"><span class="annottext">splitPiTys :: Type -&gt; ([PiTyBinder], Type)
</span><a href="GHC.Core.Type.html#splitPiTys"><span class="hs-identifier hs-var hs-var">splitPiTys</span></a></span></span><span> </span><span id="local-6989586621682564927"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564927"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [PiTyBinder] -&gt; ([PiTyBinder], Type)
</span><a href="#local-6989586621682564928"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564927"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564927"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2043"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2044"></span><span>    </span><span id="local-6989586621682564928"><span class="annot"><span class="annottext">split :: Type -&gt; Type -&gt; [PiTyBinder] -&gt; ([PiTyBinder], Type)
</span><a href="#local-6989586621682564928"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span id="local-6989586621682564929"><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><a href="#local-6989586621682564929"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621682564930"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564930"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564931"><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564931"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [PiTyBinder] -&gt; ([PiTyBinder], Type)
</span><a href="#local-6989586621682564928"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564930"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564930"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag -&gt; PiTyBinder
</span><a href="GHC.Types.Var.html#Named"><span class="hs-identifier hs-var">Named</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><a href="#local-6989586621682564929"><span class="hs-identifier hs-var">b</span></a></span><span>  </span><span class="annot"><span class="annottext">PiTyBinder -&gt; [PiTyBinder] -&gt; [PiTyBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564931"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2045"></span><span>    </span><span class="annot"><a href="#local-6989586621682564928"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564932"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564932"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564933"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564933"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564934"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564934"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564935"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564935"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564936"><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564936"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-2046"></span><span>                                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [PiTyBinder] -&gt; ([PiTyBinder], Type)
</span><a href="#local-6989586621682564928"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564935"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564935"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scaled Type -&gt; FunTyFlag -&gt; PiTyBinder
</span><a href="GHC.Types.Var.html#Anon"><span class="hs-identifier hs-var">Anon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564933"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564934"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564932"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="annot"><span class="annottext">PiTyBinder -&gt; [PiTyBinder] -&gt; [PiTyBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564936"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2047"></span><span>    </span><span class="annot"><a href="#local-6989586621682564928"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564937"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564937"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621682564938"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564938"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564939"><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564939"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564940"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564940"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564938"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [PiTyBinder] -&gt; ([PiTyBinder], Type)
</span><a href="#local-6989586621682564928"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564937"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564940"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564939"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-2048"></span><span>    </span><span class="annot"><a href="#local-6989586621682564928"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564941"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564941"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                </span><span id="local-6989586621682564942"><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564942"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PiTyBinder] -&gt; [PiTyBinder]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564942"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564941"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2049"></span><span>
</span><span id="line-2050"></span><span class="hs-comment">-- | Extracts a list of run-time arguments from a function type,</span><span>
</span><span id="line-2051"></span><span class="hs-comment">-- looking through newtypes to the right of arrows.</span><span>
</span><span id="line-2052"></span><span class="hs-comment">--</span><span>
</span><span id="line-2053"></span><span class="hs-comment">-- Examples:</span><span>
</span><span id="line-2054"></span><span class="hs-comment">--</span><span>
</span><span id="line-2055"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2056"></span><span class="hs-comment">--    newtype Identity a = I a</span><span>
</span><span id="line-2057"></span><span class="hs-comment">--</span><span>
</span><span id="line-2058"></span><span class="hs-comment">--    getRuntimeArgTys (Int -&gt; Bool -&gt; Double) == [(Int, FTF_T_T), (Bool, FTF_T_T)]</span><span>
</span><span id="line-2059"></span><span class="hs-comment">--    getRuntimeArgTys (Identity Int -&gt; Bool -&gt; Double) == [(Identity Int, FTF_T_T), (Bool, FTF_T_T)]</span><span>
</span><span id="line-2060"></span><span class="hs-comment">--    getRuntimeArgTys (Int -&gt; Identity (Bool -&gt; Identity Double)) == [(Int, FTF_T_T), (Bool, FTF_T_T)]</span><span>
</span><span id="line-2061"></span><span class="hs-comment">--    getRuntimeArgTys (forall a. Show a =&gt; Identity a -&gt; a -&gt; Int -&gt; Bool)</span><span>
</span><span id="line-2062"></span><span class="hs-comment">--             == [(Show a, FTF_C_T), (Identity a, FTF_T_T),(a, FTF_T_T),(Int, FTF_T_T)]</span><span>
</span><span id="line-2063"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2064"></span><span class="hs-comment">--</span><span>
</span><span id="line-2065"></span><span class="hs-comment">-- Note that, in the last case, the returned types might mention an out-of-scope</span><span>
</span><span id="line-2066"></span><span class="hs-comment">-- type variable. This function is used only when we really care about the /kinds/</span><span>
</span><span id="line-2067"></span><span class="hs-comment">-- of the returned types, so this is OK.</span><span>
</span><span id="line-2068"></span><span class="hs-comment">--</span><span>
</span><span id="line-2069"></span><span class="hs-comment">-- **Warning**: this function can return an infinite list. For example:</span><span>
</span><span id="line-2070"></span><span class="hs-comment">--</span><span>
</span><span id="line-2071"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2072"></span><span class="hs-comment">--   newtype N a = MkN (a -&gt; N a)</span><span>
</span><span id="line-2073"></span><span class="hs-comment">--   getRuntimeArgTys (N a) == repeat (a, FTF_T_T)</span><span>
</span><span id="line-2074"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2075"></span><span class="annot"><a href="GHC.Core.Type.html#getRuntimeArgTys"><span class="hs-identifier hs-type">getRuntimeArgTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#FunTyFlag"><span class="hs-identifier hs-type">FunTyFlag</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2076"></span><span id="getRuntimeArgTys"><span class="annot"><span class="annottext">getRuntimeArgTys :: Type -&gt; [(Scaled Type, FunTyFlag)]
</span><a href="GHC.Core.Type.html#getRuntimeArgTys"><span class="hs-identifier hs-var hs-var">getRuntimeArgTys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [(Scaled Type, FunTyFlag)]
</span><a href="#local-6989586621682564943"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-2077"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2078"></span><span>    </span><span class="annot"><a href="#local-6989586621682564943"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#FunTyFlag"><span class="hs-identifier hs-type">FunTyFlag</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2079"></span><span>    </span><span id="local-6989586621682564943"><span class="annot"><span class="annottext">go :: Type -&gt; [(Scaled Type, FunTyFlag)]
</span><a href="#local-6989586621682564943"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682564944"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564944"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2080"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [(Scaled Type, FunTyFlag)]
</span><a href="#local-6989586621682564943"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564944"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-2081"></span><span>    </span><span class="annot"><a href="#local-6989586621682564943"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564945"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564945"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564946"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564946"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564947"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564947"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564948"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564948"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2082"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564945"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564946"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564948"><span class="hs-identifier hs-var">af</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Scaled Type, FunTyFlag)
-&gt; [(Scaled Type, FunTyFlag)] -&gt; [(Scaled Type, FunTyFlag)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [(Scaled Type, FunTyFlag)]
</span><a href="#local-6989586621682564943"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564947"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-2083"></span><span>    </span><span class="annot"><a href="#local-6989586621682564943"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682564949"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564949"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2084"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564950"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564950"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564949"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2085"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [(Scaled Type, FunTyFlag)]
</span><a href="#local-6989586621682564943"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564950"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-2086"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621682564951"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564951"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (KindCoercion, Type)
</span><a href="GHC.Core.Coercion.html#topNormaliseNewType_maybe"><span class="hs-identifier hs-var">topNormaliseNewType_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564949"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2087"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [(Scaled Type, FunTyFlag)]
</span><a href="#local-6989586621682564943"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564951"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-2088"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2089"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2090"></span><span>
</span><span id="line-2091"></span><span class="annot"><a href="GHC.Core.Type.html#invisibleTyBndrCount"><span class="hs-identifier hs-type">invisibleTyBndrCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-2092"></span><span class="hs-comment">-- Returns the number of leading invisible forall'd binders in the type</span><span>
</span><span id="line-2093"></span><span class="hs-comment">-- Includes invisible predicate arguments; e.g. for</span><span>
</span><span id="line-2094"></span><span class="hs-comment">--    e.g.  forall {k}. (k ~ *) =&gt; k -&gt; k</span><span>
</span><span id="line-2095"></span><span class="hs-comment">-- returns 2 not 1</span><span>
</span><span id="line-2096"></span><span id="invisibleTyBndrCount"><span class="annot"><span class="annottext">invisibleTyBndrCount :: Type -&gt; Arity
</span><a href="GHC.Core.Type.html#invisibleTyBndrCount"><span class="hs-identifier hs-var hs-var">invisibleTyBndrCount</span></a></span></span><span> </span><span id="local-6989586621682564952"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564952"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PiTyBinder] -&gt; Arity
forall a. [a] -&gt; Arity
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Arity
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([PiTyBinder], Type) -&gt; [PiTyBinder]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; ([PiTyBinder], Type)
</span><a href="GHC.Core.Type.html#splitInvisPiTys"><span class="hs-identifier hs-var">splitInvisPiTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564952"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2097"></span><span>
</span><span id="line-2098"></span><span class="hs-comment">-- | Like 'splitPiTys', but returns only *invisible* binders, including constraints.</span><span>
</span><span id="line-2099"></span><span class="hs-comment">-- Stops at the first visible binder.</span><span>
</span><span id="line-2100"></span><span class="annot"><a href="GHC.Core.Type.html#splitInvisPiTys"><span class="hs-identifier hs-type">splitInvisPiTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#PiTyBinder"><span class="hs-identifier hs-type">PiTyBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2101"></span><span id="splitInvisPiTys"><span class="annot"><span class="annottext">splitInvisPiTys :: Type -&gt; ([PiTyBinder], Type)
</span><a href="GHC.Core.Type.html#splitInvisPiTys"><span class="hs-identifier hs-var hs-var">splitInvisPiTys</span></a></span></span><span> </span><span id="local-6989586621682564954"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564954"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [PiTyBinder] -&gt; ([PiTyBinder], Type)
</span><a href="#local-6989586621682564955"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564954"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564954"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2102"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-2103"></span><span>    </span><span id="local-6989586621682564955"><span class="annot"><span class="annottext">split :: Type -&gt; Type -&gt; [PiTyBinder] -&gt; ([PiTyBinder], Type)
</span><a href="#local-6989586621682564955"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span id="local-6989586621682564956"><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><a href="#local-6989586621682564956"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621682564957"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564957"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682564958"><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564958"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-2104"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682564959"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682564959"><span class="hs-identifier hs-var">vis</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><a href="#local-6989586621682564956"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-2105"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; Bool
</span><a href="Language.Haskell.Syntax.Specificity.html#isInvisibleForAllTyFlag"><span class="hs-identifier hs-var">isInvisibleForAllTyFlag</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682564959"><span class="hs-identifier hs-var">vis</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [PiTyBinder] -&gt; ([PiTyBinder], Type)
</span><a href="#local-6989586621682564955"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564957"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564957"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag -&gt; PiTyBinder
</span><a href="GHC.Types.Var.html#Named"><span class="hs-identifier hs-var">Named</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><a href="#local-6989586621682564956"><span class="hs-identifier hs-var">b</span></a></span><span>  </span><span class="annot"><span class="annottext">PiTyBinder -&gt; [PiTyBinder] -&gt; [PiTyBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564958"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2106"></span><span>    </span><span class="annot"><a href="#local-6989586621682564955"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564960"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564960"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564961"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564961"><span class="hs-identifier hs-var">mult</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564962"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564962"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564963"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564963"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span id="local-6989586621682564964"><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564964"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-2107"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isInvisibleFunArg"><span class="hs-identifier hs-var">isInvisibleFunArg</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564960"><span class="hs-identifier hs-var">af</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [PiTyBinder] -&gt; ([PiTyBinder], Type)
</span><a href="#local-6989586621682564955"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564963"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564963"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scaled Type -&gt; FunTyFlag -&gt; PiTyBinder
</span><a href="GHC.Types.Var.html#Anon"><span class="hs-identifier hs-var">Anon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#mkScaled"><span class="hs-identifier hs-var">mkScaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564961"><span class="hs-identifier hs-var">mult</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564962"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564960"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="annot"><span class="annottext">PiTyBinder -&gt; [PiTyBinder] -&gt; [PiTyBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564964"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2108"></span><span>    </span><span class="annot"><a href="#local-6989586621682564955"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564966"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564966"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621682564967"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564967"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564968"><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564968"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-2109"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564969"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564969"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564967"><span class="hs-identifier hs-var">ty</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [PiTyBinder] -&gt; ([PiTyBinder], Type)
</span><a href="#local-6989586621682564955"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564966"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564969"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564968"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-2110"></span><span>    </span><span class="annot"><a href="#local-6989586621682564955"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621682564970"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564970"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>          </span><span id="local-6989586621682564971"><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564971"><span class="hs-identifier hs-var">bs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PiTyBinder] -&gt; [PiTyBinder]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564971"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564970"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2111"></span><span>
</span><span id="line-2112"></span><span class="annot"><a href="GHC.Core.Type.html#splitInvisPiTysN"><span class="hs-identifier hs-type">splitInvisPiTysN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#PiTyBinder"><span class="hs-identifier hs-type">PiTyBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2113"></span><span class="hs-comment">-- ^ Same as 'splitInvisPiTys', but stop when</span><span>
</span><span id="line-2114"></span><span class="hs-comment">--   - you have found @n@ 'PiTyBinder's,</span><span>
</span><span id="line-2115"></span><span class="hs-comment">--   - or you run out of invisible binders</span><span>
</span><span id="line-2116"></span><span id="splitInvisPiTysN"><span class="annot"><span class="annottext">splitInvisPiTysN :: Arity -&gt; Type -&gt; ([PiTyBinder], Type)
</span><a href="GHC.Core.Type.html#splitInvisPiTysN"><span class="hs-identifier hs-var hs-var">splitInvisPiTysN</span></a></span></span><span> </span><span id="local-6989586621682564972"><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621682564972"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682564973"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564973"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arity -&gt; Type -&gt; Type -&gt; [PiTyBinder] -&gt; ([PiTyBinder], Type)
forall {t}.
(Eq t, Num t) =&gt;
t -&gt; Type -&gt; Type -&gt; [PiTyBinder] -&gt; ([PiTyBinder], Type)
</span><a href="#local-6989586621682564974"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621682564972"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564973"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564973"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2117"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-2118"></span><span>    </span><span id="local-6989586621682564974"><span class="annot"><span class="annottext">split :: t -&gt; Type -&gt; Type -&gt; [PiTyBinder] -&gt; ([PiTyBinder], Type)
</span><a href="#local-6989586621682564974"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621682564983"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682564983"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682564984"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564984"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621682564985"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564985"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682564986"><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564986"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-2119"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682564983"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PiTyBinder] -&gt; [PiTyBinder]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564986"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564984"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2120"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682564987"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564987"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564985"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Type -&gt; Type -&gt; [PiTyBinder] -&gt; ([PiTyBinder], Type)
</span><a href="#local-6989586621682564974"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682564983"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564984"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564987"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564986"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-2121"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span id="local-6989586621682564988"><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><a href="#local-6989586621682564988"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621682564989"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564989"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564985"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2122"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682564990"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682564990"><span class="hs-identifier hs-var">vis</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><a href="#local-6989586621682564988"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-2123"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; Bool
</span><a href="Language.Haskell.Syntax.Specificity.html#isInvisibleForAllTyFlag"><span class="hs-identifier hs-var">isInvisibleForAllTyFlag</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682564990"><span class="hs-identifier hs-var">vis</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Type -&gt; Type -&gt; [PiTyBinder] -&gt; ([PiTyBinder], Type)
</span><a href="#local-6989586621682564974"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682564983"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564989"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564989"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag -&gt; PiTyBinder
</span><a href="GHC.Types.Var.html#Named"><span class="hs-identifier hs-var">Named</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><a href="#local-6989586621682564988"><span class="hs-identifier hs-var">b</span></a></span><span>  </span><span class="annot"><span class="annottext">PiTyBinder -&gt; [PiTyBinder] -&gt; [PiTyBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564986"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2124"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564991"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564991"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564992"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564992"><span class="hs-identifier hs-var">mult</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564993"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564993"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682564994"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564994"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564985"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2125"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isInvisibleFunArg"><span class="hs-identifier hs-var">isInvisibleFunArg</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564991"><span class="hs-identifier hs-var">af</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Type -&gt; Type -&gt; [PiTyBinder] -&gt; ([PiTyBinder], Type)
</span><a href="#local-6989586621682564974"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682564983"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564994"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564994"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scaled Type -&gt; FunTyFlag -&gt; PiTyBinder
</span><a href="GHC.Types.Var.html#Anon"><span class="hs-identifier hs-var">Anon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564992"><span class="hs-identifier hs-var">mult</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564993"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682564991"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="annot"><span class="annottext">PiTyBinder -&gt; [PiTyBinder] -&gt; [PiTyBinder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564986"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2126"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PiTyBinder] -&gt; [PiTyBinder]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682564986"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682564984"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2127"></span><span>
</span><span id="line-2128"></span><span class="hs-comment">-- | Given a 'TyCon' and a list of argument types, filter out any invisible</span><span>
</span><span id="line-2129"></span><span class="hs-comment">-- (i.e., 'Inferred' or 'Specified') arguments.</span><span>
</span><span id="line-2130"></span><span class="annot"><a href="GHC.Core.Type.html#filterOutInvisibleTypes"><span class="hs-identifier hs-type">filterOutInvisibleTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2131"></span><span id="filterOutInvisibleTypes"><span class="annot"><span class="annottext">filterOutInvisibleTypes :: TyCon -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.Type.html#filterOutInvisibleTypes"><span class="hs-identifier hs-var hs-var">filterOutInvisibleTypes</span></a></span></span><span> </span><span id="local-6989586621682564995"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564995"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682564996"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564996"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Type], [Type]) -&gt; [Type]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(([Type], [Type]) -&gt; [Type]) -&gt; ([Type], [Type]) -&gt; [Type]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; ([Type], [Type])
</span><a href="GHC.Core.Type.html#partitionInvisibleTypes"><span class="hs-identifier hs-var">partitionInvisibleTypes</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564995"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564996"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2132"></span><span>
</span><span id="line-2133"></span><span class="hs-comment">-- | Given a 'TyCon' and a list of argument types, filter out any 'Inferred'</span><span>
</span><span id="line-2134"></span><span class="hs-comment">-- arguments.</span><span>
</span><span id="line-2135"></span><span class="annot"><a href="GHC.Core.Type.html#filterOutInferredTypes"><span class="hs-identifier hs-type">filterOutInferredTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2136"></span><span id="filterOutInferredTypes"><span class="annot"><span class="annottext">filterOutInferredTypes :: TyCon -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.Type.html#filterOutInferredTypes"><span class="hs-identifier hs-var hs-var">filterOutInferredTypes</span></a></span></span><span> </span><span id="local-6989586621682564998"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564998"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682564999"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564999"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2137"></span><span>  </span><span class="annot"><span class="annottext">[Bool] -&gt; [Type] -&gt; [Type]
forall a. [Bool] -&gt; [a] -&gt; [a]
</span><a href="GHC.Utils.Misc.html#filterByList"><span class="hs-identifier hs-var">filterByList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ForAllTyFlag -&gt; Bool) -&gt; [ForAllTyFlag] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; ForAllTyFlag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="Language.Haskell.Syntax.Specificity.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ForAllTyFlag] -&gt; [Bool]) -&gt; [ForAllTyFlag] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; [ForAllTyFlag]
</span><a href="GHC.Core.Type.html#tyConForAllTyFlags"><span class="hs-identifier hs-var">tyConForAllTyFlags</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682564998"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564999"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682564999"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2138"></span><span>
</span><span id="line-2139"></span><span class="hs-comment">-- | Given a 'TyCon' and a list of argument types, partition the arguments</span><span>
</span><span id="line-2140"></span><span class="hs-comment">-- into:</span><span>
</span><span id="line-2141"></span><span class="hs-comment">--</span><span>
</span><span id="line-2142"></span><span class="hs-comment">-- 1. 'Inferred' or 'Specified' (i.e., invisible) arguments and</span><span>
</span><span id="line-2143"></span><span class="hs-comment">--</span><span>
</span><span id="line-2144"></span><span class="hs-comment">-- 2. 'Required' (i.e., visible) arguments</span><span>
</span><span id="line-2145"></span><span class="annot"><a href="GHC.Core.Type.html#partitionInvisibleTypes"><span class="hs-identifier hs-type">partitionInvisibleTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2146"></span><span id="partitionInvisibleTypes"><span class="annot"><span class="annottext">partitionInvisibleTypes :: TyCon -&gt; [Type] -&gt; ([Type], [Type])
</span><a href="GHC.Core.Type.html#partitionInvisibleTypes"><span class="hs-identifier hs-var hs-var">partitionInvisibleTypes</span></a></span></span><span> </span><span id="local-6989586621682565002"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565002"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682565003"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565003"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2147"></span><span>  </span><span class="annot"><span class="annottext">[Bool] -&gt; [Type] -&gt; ([Type], [Type])
forall a. [Bool] -&gt; [a] -&gt; ([a], [a])
</span><a href="GHC.Utils.Misc.html#partitionByList"><span class="hs-identifier hs-var">partitionByList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ForAllTyFlag -&gt; Bool) -&gt; [ForAllTyFlag] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; Bool
</span><a href="Language.Haskell.Syntax.Specificity.html#isInvisibleForAllTyFlag"><span class="hs-identifier hs-var">isInvisibleForAllTyFlag</span></a></span><span> </span><span class="annot"><span class="annottext">([ForAllTyFlag] -&gt; [Bool]) -&gt; [ForAllTyFlag] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; [ForAllTyFlag]
</span><a href="GHC.Core.Type.html#tyConForAllTyFlags"><span class="hs-identifier hs-var">tyConForAllTyFlags</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565002"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565003"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565003"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2148"></span><span>
</span><span id="line-2149"></span><span class="hs-comment">-- | Given a list of things paired with their visibilities, partition the</span><span>
</span><span id="line-2150"></span><span class="hs-comment">-- things into (invisible things, visible things).</span><span>
</span><span id="line-2151"></span><span id="local-6989586621682563202"><span class="annot"><a href="GHC.Core.Type.html#partitionInvisibles"><span class="hs-identifier hs-type">partitionInvisibles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682563202"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Specificity.html#ForAllTyFlag"><span class="hs-identifier hs-type">ForAllTyFlag</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682563202"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682563202"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-2152"></span><span id="partitionInvisibles"><span class="annot"><span class="annottext">partitionInvisibles :: forall a. [(a, ForAllTyFlag)] -&gt; ([a], [a])
</span><a href="GHC.Core.Type.html#partitionInvisibles"><span class="hs-identifier hs-var hs-var">partitionInvisibles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, ForAllTyFlag) -&gt; Either a a)
-&gt; [(a, ForAllTyFlag)] -&gt; ([a], [a])
forall a b c. (a -&gt; Either b c) -&gt; [a] -&gt; ([b], [c])
</span><a href="GHC.Utils.Misc.html#partitionWith"><span class="hs-identifier hs-var">partitionWith</span></a></span><span> </span><span class="annot"><span class="annottext">(a, ForAllTyFlag) -&gt; Either a a
forall a. (a, ForAllTyFlag) -&gt; Either a a
</span><a href="#local-6989586621682565006"><span class="hs-identifier hs-var">pick_invis</span></a></span><span>
</span><span id="line-2153"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2154"></span><span>    </span><span id="local-6989586621682563207"><span class="annot"><a href="#local-6989586621682565006"><span class="hs-identifier hs-type">pick_invis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682563207"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Specificity.html#ForAllTyFlag"><span class="hs-identifier hs-type">ForAllTyFlag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621682563207"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682563207"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-2155"></span><span>    </span><span id="local-6989586621682565006"><span class="annot"><span class="annottext">pick_invis :: forall a. (a, ForAllTyFlag) -&gt; Either a a
</span><a href="#local-6989586621682565006"><span class="hs-identifier hs-var hs-var">pick_invis</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682565007"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682565007"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682565008"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682565008"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; Bool
</span><a href="Language.Haskell.Syntax.Specificity.html#isInvisibleForAllTyFlag"><span class="hs-identifier hs-var">isInvisibleForAllTyFlag</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682565008"><span class="hs-identifier hs-var">vis</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682565007"><span class="hs-identifier hs-var">thing</span></a></span><span>
</span><span id="line-2156"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682565007"><span class="hs-identifier hs-var">thing</span></a></span><span>
</span><span id="line-2157"></span><span>
</span><span id="line-2158"></span><span class="hs-comment">-- | Given a 'TyCon' and a list of argument types to which the 'TyCon' is</span><span>
</span><span id="line-2159"></span><span class="hs-comment">-- applied, determine each argument's visibility</span><span>
</span><span id="line-2160"></span><span class="hs-comment">-- ('Inferred', 'Specified', or 'Required').</span><span>
</span><span id="line-2161"></span><span class="hs-comment">--</span><span>
</span><span id="line-2162"></span><span class="hs-comment">-- Wrinkle: consider the following scenario:</span><span>
</span><span id="line-2163"></span><span class="hs-comment">--</span><span>
</span><span id="line-2164"></span><span class="hs-comment">-- &gt; T :: forall k. k -&gt; k</span><span>
</span><span id="line-2165"></span><span class="hs-comment">-- &gt; tyConForAllTyFlags T [forall m. m -&gt; m -&gt; m, S, R, Q]</span><span>
</span><span id="line-2166"></span><span class="hs-comment">--</span><span>
</span><span id="line-2167"></span><span class="hs-comment">-- After substituting, we get</span><span>
</span><span id="line-2168"></span><span class="hs-comment">--</span><span>
</span><span id="line-2169"></span><span class="hs-comment">-- &gt; T (forall m. m -&gt; m -&gt; m) :: (forall m. m -&gt; m -&gt; m) -&gt; forall n. n -&gt; n -&gt; n</span><span>
</span><span id="line-2170"></span><span class="hs-comment">--</span><span>
</span><span id="line-2171"></span><span class="hs-comment">-- Thus, the first argument is invisible, @S@ is visible, @R@ is invisible again,</span><span>
</span><span id="line-2172"></span><span class="hs-comment">-- and @Q@ is visible.</span><span>
</span><span id="line-2173"></span><span class="annot"><a href="GHC.Core.Type.html#tyConForAllTyFlags"><span class="hs-identifier hs-type">tyConForAllTyFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Specificity.html#ForAllTyFlag"><span class="hs-identifier hs-type">ForAllTyFlag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2174"></span><span id="tyConForAllTyFlags"><span class="annot"><span class="annottext">tyConForAllTyFlags :: TyCon -&gt; [Type] -&gt; [ForAllTyFlag]
</span><a href="GHC.Core.Type.html#tyConForAllTyFlags"><span class="hs-identifier hs-var hs-var">tyConForAllTyFlags</span></a></span></span><span> </span><span id="local-6989586621682565009"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565009"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [ForAllTyFlag]
</span><a href="GHC.Core.Type.html#fun_kind_arg_flags"><span class="hs-identifier hs-var">fun_kind_arg_flags</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#tyConKind"><span class="hs-identifier hs-var">tyConKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565009"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2175"></span><span>
</span><span id="line-2176"></span><span class="hs-comment">-- | Given a 'Type' and a list of argument types to which the 'Type' is</span><span>
</span><span id="line-2177"></span><span class="hs-comment">-- applied, determine each argument's visibility</span><span>
</span><span id="line-2178"></span><span class="hs-comment">-- ('Inferred', 'Specified', or 'Required').</span><span>
</span><span id="line-2179"></span><span class="hs-comment">--</span><span>
</span><span id="line-2180"></span><span class="hs-comment">-- Most of the time, the arguments will be 'Required', but not always. Consider</span><span>
</span><span id="line-2181"></span><span class="hs-comment">-- @f :: forall a. a -&gt; Type@. In @f Type Bool@, the first argument (@Type@) is</span><span>
</span><span id="line-2182"></span><span class="hs-comment">-- 'Specified' and the second argument (@Bool@) is 'Required'. It is precisely</span><span>
</span><span id="line-2183"></span><span class="hs-comment">-- this sort of higher-rank situation in which 'appTyForAllTyFlags' comes in handy,</span><span>
</span><span id="line-2184"></span><span class="hs-comment">-- since @f Type Bool@ would be represented in Core using 'AppTy's.</span><span>
</span><span id="line-2185"></span><span class="hs-comment">-- (See also #15792).</span><span>
</span><span id="line-2186"></span><span class="annot"><a href="GHC.Core.Type.html#appTyForAllTyFlags"><span class="hs-identifier hs-type">appTyForAllTyFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Specificity.html#ForAllTyFlag"><span class="hs-identifier hs-type">ForAllTyFlag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2187"></span><span id="appTyForAllTyFlags"><span class="annot"><span class="annottext">appTyForAllTyFlags :: Type -&gt; [Type] -&gt; [ForAllTyFlag]
</span><a href="GHC.Core.Type.html#appTyForAllTyFlags"><span class="hs-identifier hs-var hs-var">appTyForAllTyFlags</span></a></span></span><span> </span><span id="local-6989586621682565012"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565012"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [ForAllTyFlag]
</span><a href="GHC.Core.Type.html#fun_kind_arg_flags"><span class="hs-identifier hs-var">fun_kind_arg_flags</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565012"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2188"></span><span>
</span><span id="line-2189"></span><span class="hs-comment">-- | Given a function kind and a list of argument types (where each argument's</span><span>
</span><span id="line-2190"></span><span class="hs-comment">-- kind aligns with the corresponding position in the argument kind), determine</span><span>
</span><span id="line-2191"></span><span class="hs-comment">-- each argument's visibility ('Inferred', 'Specified', or 'Required').</span><span>
</span><span id="line-2192"></span><span class="annot"><a href="GHC.Core.Type.html#fun_kind_arg_flags"><span class="hs-identifier hs-type">fun_kind_arg_flags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Specificity.html#ForAllTyFlag"><span class="hs-identifier hs-type">ForAllTyFlag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2193"></span><span id="fun_kind_arg_flags"><span class="annot"><span class="annottext">fun_kind_arg_flags :: Type -&gt; [Type] -&gt; [ForAllTyFlag]
</span><a href="GHC.Core.Type.html#fun_kind_arg_flags"><span class="hs-identifier hs-var hs-var">fun_kind_arg_flags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; [Type] -&gt; [ForAllTyFlag]
</span><a href="#local-6989586621682565013"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="GHC.Core.TyCo.Subst.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span>
</span><span id="line-2194"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2195"></span><span>    </span><span id="local-6989586621682565013"><span class="annot"><span class="annottext">go :: Subst -&gt; Type -&gt; [Type] -&gt; [ForAllTyFlag]
</span><a href="#local-6989586621682565013"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682565014"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682565014"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621682565015"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565015"><span class="hs-identifier hs-var">ki</span></a></span></span><span> </span><span id="local-6989586621682565016"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565016"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span>
</span><span id="line-2196"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565017"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565017"><span class="hs-identifier hs-var">ki'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565015"><span class="hs-identifier hs-var">ki</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; [Type] -&gt; [ForAllTyFlag]
</span><a href="#local-6989586621682565013"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682565014"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565017"><span class="hs-identifier hs-var">ki'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565016"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-2197"></span><span>    </span><span class="annot"><a href="#local-6989586621682565013"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2198"></span><span>    </span><span class="annot"><a href="#local-6989586621682565013"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682565018"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682565018"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682565019"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565019"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621682565020"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682565020"><span class="hs-identifier hs-var">argf</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682565021"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565021"><span class="hs-identifier hs-var">res_ki</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682565022"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565022"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682565023"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565023"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2199"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682565020"><span class="hs-identifier hs-var">argf</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; [ForAllTyFlag] -&gt; [ForAllTyFlag]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; [Type] -&gt; [ForAllTyFlag]
</span><a href="#local-6989586621682565013"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682565024"><span class="hs-identifier hs-var">subst'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565021"><span class="hs-identifier hs-var">res_ki</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565023"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-2200"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-2201"></span><span>        </span><span id="local-6989586621682565024"><span class="annot"><span class="annottext">subst' :: Subst
</span><a href="#local-6989586621682565024"><span class="hs-identifier hs-var hs-var">subst'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; TyVar -&gt; Type -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#extendTvSubst"><span class="hs-identifier hs-var">extendTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682565018"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565019"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565022"><span class="hs-identifier hs-var">arg_ty</span></a></span><span>
</span><span id="line-2202"></span><span>    </span><span class="annot"><a href="#local-6989586621682565013"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682565025"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682565025"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682565026"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565026"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682565027"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565027"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span>
</span><span id="line-2203"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565028"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565028"><span class="hs-identifier hs-var">ki</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; TyVar -&gt; Maybe Type
</span><a href="GHC.Core.TyCo.Subst.html#lookupTyVar"><span class="hs-identifier hs-var">lookupTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682565025"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565026"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; [Type] -&gt; [ForAllTyFlag]
</span><a href="#local-6989586621682565013"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682565025"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565028"><span class="hs-identifier hs-var">ki</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565027"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-2204"></span><span>    </span><span class="hs-comment">-- This FunTy case is important to handle kinds with nested foralls, such</span><span>
</span><span id="line-2205"></span><span>    </span><span class="hs-comment">-- as this kind (inspired by #16518):</span><span>
</span><span id="line-2206"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-2207"></span><span>    </span><span class="hs-comment">--   forall {k1} k2. k1 -&gt; k2 -&gt; forall k3. k3 -&gt; Type</span><span>
</span><span id="line-2208"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-2209"></span><span>    </span><span class="hs-comment">-- Here, we want to get the following ForAllTyFlags:</span><span>
</span><span id="line-2210"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-2211"></span><span>    </span><span class="hs-comment">-- [Inferred,   Specified, Required, Required, Specified, Required]</span><span>
</span><span id="line-2212"></span><span>    </span><span class="hs-comment">-- forall {k1}. forall k2. k1 -&gt;     k2 -&gt;     forall k3. k3 -&gt;     Type</span><span>
</span><span id="line-2213"></span><span>    </span><span class="annot"><a href="#local-6989586621682565013"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682565029"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682565029"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682565030"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682565030"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682565031"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565031"><span class="hs-identifier hs-var">res_ki</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682565032"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565032"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2214"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682565033"><span class="hs-identifier hs-var">argf</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; [ForAllTyFlag] -&gt; [ForAllTyFlag]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Type -&gt; [Type] -&gt; [ForAllTyFlag]
</span><a href="#local-6989586621682565013"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682565029"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565031"><span class="hs-identifier hs-var">res_ki</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565032"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-2215"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-2216"></span><span>        </span><span id="local-6989586621682565033"><span class="annot"><span class="annottext">argf :: ForAllTyFlag
</span><a href="#local-6989586621682565033"><span class="hs-identifier hs-var hs-var">argf</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isVisibleFunArg"><span class="hs-identifier hs-var">isVisibleFunArg</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682565030"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="Language.Haskell.Syntax.Specificity.html#Required"><span class="hs-identifier hs-var">Required</span></a></span><span>
</span><span id="line-2217"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="Language.Haskell.Syntax.Specificity.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a></span><span>
</span><span id="line-2218"></span><span>    </span><span class="annot"><a href="#local-6989586621682565013"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682565034"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565034"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; ForAllTyFlag) -&gt; [Type] -&gt; [ForAllTyFlag]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; Type -&gt; ForAllTyFlag
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="Language.Haskell.Syntax.Specificity.html#Required"><span class="hs-identifier hs-var">Required</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565034"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-2219"></span><span>                        </span><span class="hs-comment">-- something is ill-kinded. But this can happen</span><span>
</span><span id="line-2220"></span><span>                        </span><span class="hs-comment">-- when printing errors. Assume everything is Required.</span><span>
</span><span id="line-2221"></span><span>
</span><span id="line-2222"></span><span class="hs-comment">-- @isTauTy@ tests if a type has no foralls or (=&gt;)</span><span>
</span><span id="line-2223"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-type">isTauTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2224"></span><span id="isTauTy"><span class="annot"><span class="annottext">isTauTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var hs-var">isTauTy</span></a></span></span><span> </span><span id="local-6989586621682565036"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565036"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565037"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565037"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565036"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565037"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-2225"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2226"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2227"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682565038"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565038"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682565039"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565039"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565039"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTauTyCon"><span class="hs-identifier hs-var">isTauTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565038"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2228"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682565042"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565042"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682565043"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565043"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565042"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565043"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-2229"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682565044"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682565044"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682565045"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565045"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682565046"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565046"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682565047"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565047"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2230"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isInvisibleFunArg"><span class="hs-identifier hs-var">isInvisibleFunArg</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682565044"><span class="hs-identifier hs-var">af</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>                               </span><span class="hs-comment">-- e.g., Eq a =&gt; b</span><span>
</span><span id="line-2231"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565045"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565046"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565047"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-comment">-- e.g., a -&gt; b</span><span>
</span><span id="line-2232"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2233"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682565048"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565048"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565048"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2234"></span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>  </span><span class="hs-comment">-- Not sure about this</span><span>
</span><span id="line-2235"></span><span>
</span><span id="line-2236"></span><span class="annot"><a href="GHC.Core.Type.html#isAtomicTy"><span class="hs-identifier hs-type">isAtomicTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2237"></span><span class="hs-comment">-- True if the type is just a single token, and can be printed compactly</span><span>
</span><span id="line-2238"></span><span class="hs-comment">-- Used when deciding how to lay out type error messages; see the</span><span>
</span><span id="line-2239"></span><span class="hs-comment">-- call in GHC.Tc.Errors</span><span>
</span><span id="line-2240"></span><span id="isAtomicTy"><span class="annot"><span class="annottext">isAtomicTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isAtomicTy"><span class="hs-identifier hs-var hs-var">isAtomicTy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2241"></span><span class="annot"><a href="GHC.Core.Type.html#isAtomicTy"><span class="hs-identifier hs-var">isAtomicTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2242"></span><span class="annot"><a href="GHC.Core.Type.html#isAtomicTy"><span class="hs-identifier hs-var">isAtomicTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2243"></span><span>
</span><span id="line-2244"></span><span class="annot"><a href="GHC.Core.Type.html#isAtomicTy"><span class="hs-identifier hs-var">isAtomicTy</span></a></span><span> </span><span id="local-6989586621682565049"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565049"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLiftedTypeKind"><span class="hs-identifier hs-var">isLiftedTypeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565049"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2245"></span><span>   </span><span class="hs-comment">-- 'Type' prints compactly as *</span><span>
</span><span id="line-2246"></span><span>   </span><span class="hs-comment">-- See GHC.Iface.Type.ppr_kind_type</span><span>
</span><span id="line-2247"></span><span>
</span><span id="line-2248"></span><span class="annot"><a href="GHC.Core.Type.html#isAtomicTy"><span class="hs-identifier hs-var">isAtomicTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2249"></span><span>
</span><span id="line-2250"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Type families}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-2257"></span><span>
</span><span id="line-2258"></span><span class="annot"><a href="GHC.Core.Type.html#mkFamilyTyConApp"><span class="hs-identifier hs-type">mkFamilyTyConApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-2259"></span><span class="hs-comment">-- ^ Given a family instance TyCon and its arg types, return the</span><span>
</span><span id="line-2260"></span><span class="hs-comment">-- corresponding family type.  E.g:</span><span>
</span><span id="line-2261"></span><span class="hs-comment">--</span><span>
</span><span id="line-2262"></span><span class="hs-comment">-- &gt; data family T a</span><span>
</span><span id="line-2263"></span><span class="hs-comment">-- &gt; data instance T (Maybe b) = MkT b</span><span>
</span><span id="line-2264"></span><span class="hs-comment">--</span><span>
</span><span id="line-2265"></span><span class="hs-comment">-- Where the instance tycon is :RTL, so:</span><span>
</span><span id="line-2266"></span><span class="hs-comment">--</span><span>
</span><span id="line-2267"></span><span class="hs-comment">-- &gt; mkFamilyTyConApp :RTL Int  =  T (Maybe Int)</span><span>
</span><span id="line-2268"></span><span id="mkFamilyTyConApp"><span class="annot"><span class="annottext">mkFamilyTyConApp :: TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkFamilyTyConApp"><span class="hs-identifier hs-var hs-var">mkFamilyTyConApp</span></a></span></span><span> </span><span id="local-6989586621682565050"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565050"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682565051"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565051"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-2269"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682565052"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565052"><span class="hs-identifier hs-var">fam_tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682565053"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565053"><span class="hs-identifier hs-var">fam_tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.TyCon.html#tyConFamInst_maybe"><span class="hs-identifier hs-var">tyConFamInst_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565050"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2270"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682565055"><span class="annot"><span class="annottext">tvs :: [TyVar]
</span><a href="#local-6989586621682565055"><span class="hs-identifier hs-var hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [TyVar]
</span><a href="GHC.Core.TyCon.html#tyConTyVars"><span class="hs-identifier hs-var">tyConTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565050"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2271"></span><span>        </span><span id="local-6989586621682565057"><span class="annot"><span class="annottext">fam_subst :: Subst
</span><a href="#local-6989586621682565057"><span class="hs-identifier hs-var hs-var">fam_subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; Subst -&gt; Subst
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682565055"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; [Type] -&gt; Bool
forall a b. [a] -&gt; [b] -&gt; Bool
</span><a href="GHC.Utils.Misc.html#equalLength"><span class="hs-operator hs-var">`equalLength`</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565051"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565050"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565051"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Subst -&gt; Subst) -&gt; Subst -&gt; Subst
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2272"></span><span>                    </span><span class="annot"><span class="annottext">[TyVar] -&gt; [Type] -&gt; Subst
HasDebugCallStack =&gt; [TyVar] -&gt; [Type] -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#zipTvSubst"><span class="hs-identifier hs-var">zipTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682565055"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565051"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2273"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565052"><span class="hs-identifier hs-var">fam_tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Subst -&gt; [Type] -&gt; [Type]
Subst -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Subst.html#substTys"><span class="hs-identifier hs-var">substTys</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682565057"><span class="hs-identifier hs-var">fam_subst</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565053"><span class="hs-identifier hs-var">fam_tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2274"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2275"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565050"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565051"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2276"></span><span>
</span><span id="line-2277"></span><span class="hs-comment">-- | Get the type on the LHS of a coercion induced by a type/data</span><span>
</span><span id="line-2278"></span><span class="hs-comment">-- family instance.</span><span>
</span><span id="line-2279"></span><span id="local-6989586621682563214"><span class="annot"><a href="GHC.Core.Type.html#coAxNthLHS"><span class="hs-identifier hs-type">coAxNthLHS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682563214"><span class="hs-identifier hs-type">br</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span></span><span>
</span><span id="line-2280"></span><span id="coAxNthLHS"><span class="annot"><span class="annottext">coAxNthLHS :: forall (br :: BranchFlag). CoAxiom br -&gt; Arity -&gt; Type
</span><a href="GHC.Core.Type.html#coAxNthLHS"><span class="hs-identifier hs-var hs-var">coAxNthLHS</span></a></span></span><span> </span><span id="local-6989586621682565059"><span class="annot"><span class="annottext">CoAxiom br
</span><a href="#local-6989586621682565059"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span id="local-6989586621682565060"><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621682565060"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2281"></span><span>  </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxiom br -&gt; TyCon
forall (br :: BranchFlag). CoAxiom br -&gt; TyCon
</span><a href="GHC.Core.Coercion.Axiom.html#coAxiomTyCon"><span class="hs-identifier hs-var">coAxiomTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom br
</span><a href="#local-6989586621682565059"><span class="hs-identifier hs-var">ax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxBranch -&gt; [Type]
</span><a href="GHC.Core.Coercion.Axiom.html#coAxBranchLHS"><span class="hs-identifier hs-var">coAxBranchLHS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxiom br -&gt; Arity -&gt; CoAxBranch
forall (br :: BranchFlag). CoAxiom br -&gt; Arity -&gt; CoAxBranch
</span><a href="GHC.Core.Coercion.Axiom.html#coAxiomNthBranch"><span class="hs-identifier hs-var">coAxiomNthBranch</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom br
</span><a href="#local-6989586621682565059"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621682565060"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2282"></span><span>
</span><span id="line-2283"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-type">isFamFreeTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2284"></span><span id="isFamFreeTy"><span class="annot"><span class="annottext">isFamFreeTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var hs-var">isFamFreeTy</span></a></span></span><span> </span><span id="local-6989586621682565064"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565064"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565065"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565065"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565064"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565065"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-2285"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2286"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2287"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682565066"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565066"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682565067"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565067"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565067"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isFamFreeTyCon"><span class="hs-identifier hs-var">isFamFreeTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565066"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2288"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682565068"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565068"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682565069"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565069"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565068"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565069"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-2289"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682565070"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565070"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682565071"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565071"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682565072"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565072"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565070"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565071"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565072"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-2290"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682565073"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565073"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565073"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2291"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682565074"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565074"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565074"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2292"></span><span class="annot"><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>  </span><span class="hs-comment">-- Not sure about this</span><span>
</span><span id="line-2293"></span><span>
</span><span id="line-2294"></span><span class="annot"><a href="GHC.Core.Type.html#buildSynTyCon"><span class="hs-identifier hs-type">buildSynTyCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KnotTied"><span class="hs-identifier hs-type">KnotTied</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ /result/ kind</span></span><span>
</span><span id="line-2295"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Role"><span class="hs-identifier hs-type">Role</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KnotTied"><span class="hs-identifier hs-type">KnotTied</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-2296"></span><span class="hs-comment">-- This function is here because here is where we have</span><span>
</span><span id="line-2297"></span><span class="hs-comment">--   isFamFree and isTauTy</span><span>
</span><span id="line-2298"></span><span id="buildSynTyCon"><span class="annot"><span class="annottext">buildSynTyCon :: Name -&gt; [TyConBinder] -&gt; Type -&gt; [Role] -&gt; Type -&gt; TyCon
</span><a href="GHC.Core.Type.html#buildSynTyCon"><span class="hs-identifier hs-var hs-var">buildSynTyCon</span></a></span></span><span> </span><span id="local-6989586621682565075"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682565075"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682565076"><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621682565076"><span class="hs-identifier hs-var">binders</span></a></span></span><span> </span><span id="local-6989586621682565077"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565077"><span class="hs-identifier hs-var">res_kind</span></a></span></span><span> </span><span id="local-6989586621682565078"><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621682565078"><span class="hs-identifier hs-var">roles</span></a></span></span><span> </span><span id="local-6989586621682565079"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565079"><span class="hs-identifier hs-var">rhs</span></a></span></span><span>
</span><span id="line-2299"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; [TyConBinder]
-&gt; Type
-&gt; [Role]
-&gt; Type
-&gt; Bool
-&gt; Bool
-&gt; Bool
-&gt; Bool
-&gt; TyCon
</span><a href="GHC.Core.TyCon.html#mkSynonymTyCon"><span class="hs-identifier hs-var">mkSynonymTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682565075"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621682565076"><span class="hs-identifier hs-var">binders</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565077"><span class="hs-identifier hs-var">res_kind</span></a></span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621682565078"><span class="hs-identifier hs-var">roles</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565079"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-2300"></span><span>                   </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682565081"><span class="hs-identifier hs-var">is_tau</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682565082"><span class="hs-identifier hs-var">is_fam_free</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682565083"><span class="hs-identifier hs-var">is_forgetful</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682565084"><span class="hs-identifier hs-var">is_concrete</span></a></span><span>
</span><span id="line-2301"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2302"></span><span>    </span><span id="local-6989586621682565085"><span class="annot"><span class="annottext">qtvs :: VarSet
</span><a href="#local-6989586621682565085"><span class="hs-identifier hs-var hs-var">qtvs</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#mkVarSet"><span class="hs-identifier hs-var">mkVarSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyConBinder -&gt; TyVar) -&gt; [TyConBinder] -&gt; [TyVar]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TyConBinder -&gt; TyVar
forall tv argf. VarBndr tv argf -&gt; tv
</span><a href="GHC.Types.Var.html#binderVar"><span class="hs-identifier hs-var">binderVar</span></a></span><span> </span><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621682565076"><span class="hs-identifier hs-var">binders</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2303"></span><span>    </span><span id="local-6989586621682565081"><span class="annot"><span class="annottext">is_tau :: Bool
</span><a href="#local-6989586621682565081"><span class="hs-identifier hs-var hs-var">is_tau</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565079"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-2304"></span><span>    </span><span id="local-6989586621682565082"><span class="annot"><span class="annottext">is_fam_free :: Bool
</span><a href="#local-6989586621682565082"><span class="hs-identifier hs-var hs-var">is_fam_free</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565079"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-2305"></span><span>    </span><span id="local-6989586621682565084"><span class="annot"><span class="annottext">is_concrete :: Bool
</span><a href="#local-6989586621682565084"><span class="hs-identifier hs-var hs-var">is_concrete</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isConcreteTypeWith"><span class="hs-identifier hs-var">isConcreteTypeWith</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682565085"><span class="hs-identifier hs-var">qtvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565079"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-2306"></span><span>    </span><span id="local-6989586621682565083"><span class="annot"><span class="annottext">is_forgetful :: Bool
</span><a href="#local-6989586621682565083"><span class="hs-identifier hs-var hs-var">is_forgetful</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682565085"><span class="hs-identifier hs-var">qtvs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#subVarSet"><span class="hs-operator hs-var">`subVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682565087"><span class="hs-identifier hs-var">expanded_rhs_tyvars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2307"></span><span>
</span><span id="line-2308"></span><span>    </span><span id="local-6989586621682565087"><span class="annot"><span class="annottext">expanded_rhs_tyvars :: VarSet
</span><a href="#local-6989586621682565087"><span class="hs-identifier hs-var hs-var">expanded_rhs_tyvars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#expandTypeSynonyms"><span class="hs-identifier hs-var">expandTypeSynonyms</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565079"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2309"></span><span>       </span><span class="hs-comment">-- See Note [Forgetful type synonyms] in GHC.Core.TyCon</span><span>
</span><span id="line-2310"></span><span>       </span><span class="hs-comment">-- To find out if this TyCon is forgetful, expand the synonyms in its RHS</span><span>
</span><span id="line-2311"></span><span>       </span><span class="hs-comment">-- and check that all of the binders are free in the expanded type.</span><span>
</span><span id="line-2312"></span><span>       </span><span class="hs-comment">-- We really only need to expand the /forgetful/ synonyms on the RHS,</span><span>
</span><span id="line-2313"></span><span>       </span><span class="hs-comment">-- but we don't currently have a function to do that.</span><span>
</span><span id="line-2314"></span><span>       </span><span class="hs-comment">-- Failing to expand the RHS led to #25094, e.g.</span><span>
</span><span id="line-2315"></span><span>       </span><span class="hs-comment">--    type Bucket a b c = Key (a,b,c)</span><span>
</span><span id="line-2316"></span><span>       </span><span class="hs-comment">--    type Key x = Any</span><span>
</span><span id="line-2317"></span><span>       </span><span class="hs-comment">-- Here Bucket is definitely forgetful!</span><span>
</span><span id="line-2318"></span><span>
</span><span id="line-2319"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Liftedness}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-2326"></span><span>
</span><span id="line-2327"></span><span class="hs-comment">-- | Tries to compute the 'Levity' of the given type. Returns either</span><span>
</span><span id="line-2328"></span><span class="hs-comment">-- a definite 'Levity', or 'Nothing' if we aren't sure (e.g. the</span><span>
</span><span id="line-2329"></span><span class="hs-comment">-- type is representation-polymorphic).</span><span>
</span><span id="line-2330"></span><span class="hs-comment">--</span><span>
</span><span id="line-2331"></span><span class="hs-comment">-- Panics if the kind does not have the shape @TYPE r@.</span><span>
</span><span id="line-2332"></span><span class="annot"><a href="GHC.Core.Type.html#typeLevity_maybe"><span class="hs-identifier hs-type">typeLevity_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Levity"><span class="hs-identifier hs-type">Levity</span></a></span><span>
</span><span id="line-2333"></span><span id="typeLevity_maybe"><span class="annot"><span class="annottext">typeLevity_maybe :: HasDebugCallStack =&gt; Type -&gt; Maybe Levity
</span><a href="GHC.Core.Type.html#typeLevity_maybe"><span class="hs-identifier hs-var hs-var">typeLevity_maybe</span></a></span></span><span> </span><span id="local-6989586621682565090"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565090"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Levity
</span><a href="GHC.Core.Type.html#runtimeRepLevity_maybe"><span class="hs-identifier hs-var">runtimeRepLevity_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565090"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2334"></span><span>
</span><span id="line-2335"></span><span class="annot"><a href="GHC.Core.Type.html#typeLevity"><span class="hs-identifier hs-type">typeLevity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Levity"><span class="hs-identifier hs-type">Levity</span></a></span><span>
</span><span id="line-2336"></span><span id="typeLevity"><span class="annot"><span class="annottext">typeLevity :: HasDebugCallStack =&gt; Type -&gt; Levity
</span><a href="GHC.Core.Type.html#typeLevity"><span class="hs-identifier hs-var hs-var">typeLevity</span></a></span></span><span> </span><span id="local-6989586621682565096"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565096"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Levity
Type -&gt; Maybe Levity
</span><a href="GHC.Core.Type.html#typeLevity_maybe"><span class="hs-identifier hs-var">typeLevity_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565096"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2337"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565097"><span class="annot"><span class="annottext">Levity
</span><a href="#local-6989586621682565097"><span class="hs-identifier hs-var">lev</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Levity
</span><a href="#local-6989586621682565097"><span class="hs-identifier hs-var">lev</span></a></span><span>
</span><span id="line-2338"></span><span>                   </span><span class="annot"><span class="annottext">Maybe Levity
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Levity
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;typeLevity&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565096"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2339"></span><span>
</span><span id="line-2340"></span><span class="hs-comment">-- | Is the given type definitely unlifted?</span><span>
</span><span id="line-2341"></span><span class="hs-comment">-- See &quot;Type#type_classification&quot; for what an unlifted type is.</span><span>
</span><span id="line-2342"></span><span class="hs-comment">--</span><span>
</span><span id="line-2343"></span><span class="hs-comment">-- Panics on representation-polymorphic types; See 'mightBeUnliftedType' for</span><span>
</span><span id="line-2344"></span><span class="hs-comment">-- a more approximate predicate that behaves better in the presence of</span><span>
</span><span id="line-2345"></span><span class="hs-comment">-- representation polymorphism.</span><span>
</span><span id="line-2346"></span><span class="annot"><a href="GHC.Core.Type.html#isUnliftedType"><span class="hs-identifier hs-type">isUnliftedType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2347"></span><span>        </span><span class="hs-comment">-- isUnliftedType returns True for forall'd unlifted types:</span><span>
</span><span id="line-2348"></span><span>        </span><span class="hs-comment">--      x :: forall a. Int#</span><span>
</span><span id="line-2349"></span><span>        </span><span class="hs-comment">-- I found bindings like these were getting floated to the top level.</span><span>
</span><span id="line-2350"></span><span id="isUnliftedType"><span class="annot"><span class="annottext">isUnliftedType :: HasDebugCallStack =&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnliftedType"><span class="hs-identifier hs-var hs-var">isUnliftedType</span></a></span></span><span> </span><span id="local-6989586621682565107"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565107"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2351"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Levity
Type -&gt; Maybe Levity
</span><a href="GHC.Core.Type.html#typeLevity_maybe"><span class="hs-identifier hs-var">typeLevity_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565107"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2352"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Levity
</span><a href="GHC.Types.Basic.html#Lifted"><span class="hs-identifier hs-var">Lifted</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2353"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Levity
</span><a href="GHC.Types.Basic.html#Unlifted"><span class="hs-identifier hs-var">Unlifted</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2354"></span><span>    </span><span class="annot"><span class="annottext">Maybe Levity
</span><span class="hs-identifier hs-var">Nothing</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Bool
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;isUnliftedType&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565107"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565107"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2355"></span><span>
</span><span id="line-2356"></span><span class="hs-comment">-- | Returns:</span><span>
</span><span id="line-2357"></span><span class="hs-comment">--</span><span>
</span><span id="line-2358"></span><span class="hs-comment">-- * 'False' if the type is /guaranteed/ unlifted or</span><span>
</span><span id="line-2359"></span><span class="hs-comment">-- * 'True' if it lifted, OR we aren't sure</span><span>
</span><span id="line-2360"></span><span class="hs-comment">--    (e.g. in a representation-polymorphic case)</span><span>
</span><span id="line-2361"></span><span class="annot"><a href="GHC.Core.Type.html#mightBeLiftedType"><span class="hs-identifier hs-type">mightBeLiftedType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2362"></span><span id="mightBeLiftedType"><span class="annot"><span class="annottext">mightBeLiftedType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#mightBeLiftedType"><span class="hs-identifier hs-var hs-var">mightBeLiftedType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Levity -&gt; Bool
</span><a href="GHC.Types.Basic.html#mightBeLifted"><span class="hs-identifier hs-var">mightBeLifted</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Levity -&gt; Bool) -&gt; (Type -&gt; Maybe Levity) -&gt; Type -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Levity
Type -&gt; Maybe Levity
</span><a href="GHC.Core.Type.html#typeLevity_maybe"><span class="hs-identifier hs-var">typeLevity_maybe</span></a></span><span>
</span><span id="line-2363"></span><span>
</span><span id="line-2364"></span><span class="annot"><a href="GHC.Core.Type.html#definitelyLiftedType"><span class="hs-identifier hs-type">definitelyLiftedType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2365"></span><span id="definitelyLiftedType"><span class="annot"><span class="annottext">definitelyLiftedType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#definitelyLiftedType"><span class="hs-identifier hs-var hs-var">definitelyLiftedType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Type -&gt; Bool) -&gt; Type -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#mightBeUnliftedType"><span class="hs-identifier hs-var">mightBeUnliftedType</span></a></span><span>
</span><span id="line-2366"></span><span>
</span><span id="line-2367"></span><span class="hs-comment">-- | Returns:</span><span>
</span><span id="line-2368"></span><span class="hs-comment">--</span><span>
</span><span id="line-2369"></span><span class="hs-comment">-- * 'False' if the type is /guaranteed/ lifted or</span><span>
</span><span id="line-2370"></span><span class="hs-comment">-- * 'True' if it is unlifted, OR we aren't sure</span><span>
</span><span id="line-2371"></span><span class="hs-comment">--    (e.g. in a representation-polymorphic case)</span><span>
</span><span id="line-2372"></span><span class="annot"><a href="GHC.Core.Type.html#mightBeUnliftedType"><span class="hs-identifier hs-type">mightBeUnliftedType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2373"></span><span id="mightBeUnliftedType"><span class="annot"><span class="annottext">mightBeUnliftedType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#mightBeUnliftedType"><span class="hs-identifier hs-var hs-var">mightBeUnliftedType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Levity -&gt; Bool
</span><a href="GHC.Types.Basic.html#mightBeUnlifted"><span class="hs-identifier hs-var">mightBeUnlifted</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Levity -&gt; Bool) -&gt; (Type -&gt; Maybe Levity) -&gt; Type -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Levity
Type -&gt; Maybe Levity
</span><a href="GHC.Core.Type.html#typeLevity_maybe"><span class="hs-identifier hs-var">typeLevity_maybe</span></a></span><span>
</span><span id="line-2374"></span><span>
</span><span id="line-2375"></span><span class="annot"><a href="GHC.Core.Type.html#definitelyUnliftedType"><span class="hs-identifier hs-type">definitelyUnliftedType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2376"></span><span id="definitelyUnliftedType"><span class="annot"><span class="annottext">definitelyUnliftedType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#definitelyUnliftedType"><span class="hs-identifier hs-var hs-var">definitelyUnliftedType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Type -&gt; Bool) -&gt; Type -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#mightBeLiftedType"><span class="hs-identifier hs-var">mightBeLiftedType</span></a></span><span>
</span><span id="line-2377"></span><span>
</span><span id="line-2378"></span><span class="hs-comment">-- | See &quot;Type#type_classification&quot; for what a boxed type is.</span><span>
</span><span id="line-2379"></span><span class="hs-comment">-- Panics on representation-polymorphic types; See 'mightBeUnliftedType' for</span><span>
</span><span id="line-2380"></span><span class="hs-comment">-- a more approximate predicate that behaves better in the presence of</span><span>
</span><span id="line-2381"></span><span class="hs-comment">-- representation polymorphism.</span><span>
</span><span id="line-2382"></span><span class="annot"><a href="GHC.Core.Type.html#isBoxedType"><span class="hs-identifier hs-type">isBoxedType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2383"></span><span id="isBoxedType"><span class="annot"><span class="annottext">isBoxedType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isBoxedType"><span class="hs-identifier hs-var hs-var">isBoxedType</span></a></span></span><span> </span><span id="local-6989586621682565111"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565111"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isBoxedRuntimeRep"><span class="hs-identifier hs-var">isBoxedRuntimeRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565111"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2384"></span><span>
</span><span id="line-2385"></span><span class="annot"><span class="hs-comment">-- | Is this a type of kind RuntimeRep? (e.g. LiftedRep)</span></span><span>
</span><span id="line-2386"></span><span class="annot"><a href="GHC.Core.Type.html#isRuntimeRepKindedTy"><span class="hs-identifier hs-type">isRuntimeRepKindedTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2387"></span><span id="isRuntimeRepKindedTy"><span class="annot"><span class="annottext">isRuntimeRepKindedTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isRuntimeRepKindedTy"><span class="hs-identifier hs-var hs-var">isRuntimeRepKindedTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isRuntimeRepTy"><span class="hs-identifier hs-var">isRuntimeRepTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; (Type -&gt; Type) -&gt; Type -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span>
</span><span id="line-2388"></span><span>
</span><span id="line-2389"></span><span class="hs-comment">-- | Drops prefix of RuntimeRep constructors in 'TyConApp's. Useful for e.g.</span><span>
</span><span id="line-2390"></span><span class="hs-comment">-- dropping 'LiftedRep arguments of unboxed tuple TyCon applications:</span><span>
</span><span id="line-2391"></span><span class="hs-comment">--</span><span>
</span><span id="line-2392"></span><span class="hs-comment">--   dropRuntimeRepArgs [ 'LiftedRep, 'IntRep</span><span>
</span><span id="line-2393"></span><span class="hs-comment">--                      , String, Int# ] == [String, Int#]</span><span>
</span><span id="line-2394"></span><span class="hs-comment">--</span><span>
</span><span id="line-2395"></span><span class="annot"><a href="GHC.Core.Type.html#dropRuntimeRepArgs"><span class="hs-identifier hs-type">dropRuntimeRepArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2396"></span><span id="dropRuntimeRepArgs"><span class="annot"><span class="annottext">dropRuntimeRepArgs :: [Type] -&gt; [Type]
</span><a href="GHC.Core.Type.html#dropRuntimeRepArgs"><span class="hs-identifier hs-var hs-var">dropRuntimeRepArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; [Type]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isRuntimeRepKindedTy"><span class="hs-identifier hs-var">isRuntimeRepKindedTy</span></a></span><span>
</span><span id="line-2397"></span><span>
</span><span id="line-2398"></span><span class="hs-comment">-- | Extract the RuntimeRep classifier of a type. For instance,</span><span>
</span><span id="line-2399"></span><span class="hs-comment">-- @getRuntimeRep_maybe Int = Just LiftedRep@. Returns 'Nothing' if this is not</span><span>
</span><span id="line-2400"></span><span class="hs-comment">-- possible.</span><span>
</span><span id="line-2401"></span><span class="annot"><a href="GHC.Core.Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-type">getRuntimeRep_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span>
</span><span id="line-2402"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#RuntimeRepType"><span class="hs-identifier hs-type">RuntimeRepType</span></a></span><span>
</span><span id="line-2403"></span><span id="getRuntimeRep_maybe"><span class="annot"><span class="annottext">getRuntimeRep_maybe :: HasDebugCallStack =&gt; Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-var hs-var">getRuntimeRep_maybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#kindRep_maybe"><span class="hs-identifier hs-var">kindRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe Type) -&gt; (Type -&gt; Type) -&gt; Type -&gt; Maybe Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span>
</span><span id="line-2404"></span><span>
</span><span id="line-2405"></span><span class="hs-comment">-- | Extract the RuntimeRep classifier of a type. For instance,</span><span>
</span><span id="line-2406"></span><span class="hs-comment">-- @getRuntimeRep_maybe Int = LiftedRep@. Panics if this is not possible.</span><span>
</span><span id="line-2407"></span><span class="annot"><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-type">getRuntimeRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#RuntimeRepType"><span class="hs-identifier hs-type">RuntimeRepType</span></a></span><span>
</span><span id="line-2408"></span><span id="getRuntimeRep"><span class="annot"><span class="annottext">getRuntimeRep :: HasDebugCallStack =&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var hs-var">getRuntimeRep</span></a></span></span><span> </span><span id="local-6989586621682565125"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565125"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2409"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-var">getRuntimeRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565125"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2410"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565126"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565126"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565126"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2411"></span><span>      </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getRuntimeRep&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565125"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565125"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2412"></span><span>
</span><span id="line-2413"></span><span class="hs-comment">-- | Extract the 'Levity' of a type. For example, @getLevity_maybe Int = Just Lifted@,</span><span>
</span><span id="line-2414"></span><span class="hs-comment">-- @getLevity (Array# Int) = Just Unlifted@, @getLevity Float# = Nothing@.</span><span>
</span><span id="line-2415"></span><span class="hs-comment">--</span><span>
</span><span id="line-2416"></span><span class="hs-comment">-- Returns 'Nothing' if this is not possible. Does not look through type family applications.</span><span>
</span><span id="line-2417"></span><span class="annot"><a href="GHC.Core.Type.html#getLevity_maybe"><span class="hs-identifier hs-type">getLevity_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-2418"></span><span id="getLevity_maybe"><span class="annot"><span class="annottext">getLevity_maybe :: HasDebugCallStack =&gt; Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#getLevity_maybe"><span class="hs-identifier hs-var hs-var">getLevity_maybe</span></a></span></span><span> </span><span id="local-6989586621682565130"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565130"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2419"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565131"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565131"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-var">getRuntimeRep_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565130"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2420"></span><span>  </span><span class="hs-comment">-- Directly matching on TyConApp after expanding type synonyms</span><span>
</span><span id="line-2421"></span><span>  </span><span class="hs-comment">-- saves allocations compared to `splitTyConApp_maybe`. See #22254.</span><span>
</span><span id="line-2422"></span><span>  </span><span class="hs-comment">-- Given that this is a pretty hot function we make use of the fact</span><span>
</span><span id="line-2423"></span><span>  </span><span class="hs-comment">-- and use isTyConKeyApp_maybe instead.</span><span>
</span><span id="line-2424"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682565132"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565132"><span class="hs-identifier hs-var">lev</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Maybe [Type]
</span><a href="GHC.Core.Type.html#isTyConKeyApp_maybe"><span class="hs-identifier hs-var">isTyConKeyApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#boxedRepDataConKey"><span class="hs-identifier hs-var">boxedRepDataConKey</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565131"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-2425"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565132"><span class="hs-identifier hs-var">lev</span></a></span><span>
</span><span id="line-2426"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2427"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2428"></span><span>
</span><span id="line-2429"></span><span class="hs-comment">-- | Extract the 'Levity' of a type. For example, @getLevity Int = Lifted@,</span><span>
</span><span id="line-2430"></span><span class="hs-comment">-- or @getLevity (Array# Int) = Unlifted@.</span><span>
</span><span id="line-2431"></span><span class="hs-comment">--</span><span>
</span><span id="line-2432"></span><span class="hs-comment">-- Panics if this is not possible. Does not look through type family applications.</span><span>
</span><span id="line-2433"></span><span class="annot"><a href="GHC.Core.Type.html#getLevity"><span class="hs-identifier hs-type">getLevity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-2434"></span><span id="getLevity"><span class="annot"><span class="annottext">getLevity :: HasDebugCallStack =&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#getLevity"><span class="hs-identifier hs-var hs-var">getLevity</span></a></span></span><span> </span><span id="local-6989586621682565142"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565142"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2435"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565143"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565143"><span class="hs-identifier hs-var">lev</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe Type
Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#getLevity_maybe"><span class="hs-identifier hs-var">getLevity_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565142"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2436"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565143"><span class="hs-identifier hs-var">lev</span></a></span><span>
</span><span id="line-2437"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2438"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getLevity&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565142"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565142"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2439"></span><span>
</span><span id="line-2440"></span><span class="annot"><a href="GHC.Core.Type.html#isUnboxedTupleType"><span class="hs-identifier hs-type">isUnboxedTupleType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2441"></span><span id="isUnboxedTupleType"><span class="annot"><span class="annottext">isUnboxedTupleType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnboxedTupleType"><span class="hs-identifier hs-var hs-var">isUnboxedTupleType</span></a></span></span><span> </span><span id="local-6989586621682565144"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565144"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2442"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; TyCon
Type -&gt; TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon"><span class="hs-identifier hs-var">tyConAppTyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565144"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#tupleRepDataConKey"><span class="hs-identifier hs-var">tupleRepDataConKey</span></a></span><span>
</span><span id="line-2443"></span><span>  </span><span class="hs-comment">-- NB: Do not use typePrimRep, as that can't tell the difference between</span><span>
</span><span id="line-2444"></span><span>  </span><span class="hs-comment">-- unboxed tuples and unboxed sums</span><span>
</span><span id="line-2445"></span><span>
</span><span id="line-2446"></span><span>
</span><span id="line-2447"></span><span class="annot"><a href="GHC.Core.Type.html#isUnboxedSumType"><span class="hs-identifier hs-type">isUnboxedSumType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2448"></span><span id="isUnboxedSumType"><span class="annot"><span class="annottext">isUnboxedSumType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnboxedSumType"><span class="hs-identifier hs-var hs-var">isUnboxedSumType</span></a></span></span><span> </span><span id="local-6989586621682565146"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565146"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2449"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; TyCon
Type -&gt; TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon"><span class="hs-identifier hs-var">tyConAppTyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565146"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#sumRepDataConKey"><span class="hs-identifier hs-var">sumRepDataConKey</span></a></span><span>
</span><span id="line-2450"></span><span>
</span><span id="line-2451"></span><span class="hs-comment">-- | See &quot;Type#type_classification&quot; for what an algebraic type is.</span><span>
</span><span id="line-2452"></span><span class="hs-comment">-- Should only be applied to /types/, as opposed to e.g. partially</span><span>
</span><span id="line-2453"></span><span class="hs-comment">-- saturated type constructors</span><span>
</span><span id="line-2454"></span><span class="annot"><a href="GHC.Core.Type.html#isAlgType"><span class="hs-identifier hs-type">isAlgType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2455"></span><span id="isAlgType"><span class="annot"><span class="annottext">isAlgType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isAlgType"><span class="hs-identifier hs-var hs-var">isAlgType</span></a></span></span><span> </span><span id="local-6989586621682565148"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565148"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2456"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565148"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2457"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682565149"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565149"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682565150"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565150"><span class="hs-identifier hs-var">ty_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (TyCon -&gt; Bool) -&gt; TyCon -&gt; Bool
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565150"><span class="hs-identifier hs-var">ty_args</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Arity -&gt; Bool
forall a. [a] -&gt; Arity -&gt; Bool
</span><a href="GHC.Utils.Misc.html#lengthIs"><span class="hs-operator hs-var">`lengthIs`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Arity
</span><a href="GHC.Core.TyCon.html#tyConArity"><span class="hs-identifier hs-var">tyConArity</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565149"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-2458"></span><span>                            </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isAlgTyCon"><span class="hs-identifier hs-var">isAlgTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565149"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2459"></span><span>      </span><span id="local-6989586621682565153"><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><a href="#local-6989586621682565153"><span class="hs-identifier hs-var">_other</span></a></span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2460"></span><span>
</span><span id="line-2461"></span><span class="annot"><span class="hs-comment">-- | Check whether a type is a data family type</span></span><span>
</span><span id="line-2462"></span><span class="annot"><a href="GHC.Core.Type.html#isDataFamilyAppType"><span class="hs-identifier hs-type">isDataFamilyAppType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2463"></span><span id="isDataFamilyAppType"><span class="annot"><span class="annottext">isDataFamilyAppType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isDataFamilyAppType"><span class="hs-identifier hs-var hs-var">isDataFamilyAppType</span></a></span></span><span> </span><span id="local-6989586621682565154"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565154"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565154"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2464"></span><span>                           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565155"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565155"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isDataFamilyTyCon"><span class="hs-identifier hs-var">isDataFamilyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565155"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2465"></span><span>                           </span><span class="annot"><span class="annottext">Maybe TyCon
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2466"></span><span>
</span><span id="line-2467"></span><span class="hs-comment">-- | Computes whether an argument (or let right hand side) should</span><span>
</span><span id="line-2468"></span><span class="hs-comment">-- be computed strictly or lazily, based only on its type.</span><span>
</span><span id="line-2469"></span><span class="hs-comment">-- Currently, it's just 'isUnliftedType'.</span><span>
</span><span id="line-2470"></span><span class="hs-comment">-- Panics on representation-polymorphic types.</span><span>
</span><span id="line-2471"></span><span class="annot"><a href="GHC.Core.Type.html#isStrictType"><span class="hs-identifier hs-type">isStrictType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2472"></span><span id="isStrictType"><span class="annot"><span class="annottext">isStrictType :: HasDebugCallStack =&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isStrictType"><span class="hs-identifier hs-var hs-var">isStrictType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Bool
Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a></span><span>
</span><span id="line-2473"></span><span>
</span><span id="line-2474"></span><span class="annot"><a href="GHC.Core.Type.html#isTerminatingType"><span class="hs-identifier hs-type">isTerminatingType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2475"></span><span class="hs-comment">-- ^ True &lt;=&gt; a term of this type cannot be bottom</span><span>
</span><span id="line-2476"></span><span class="hs-comment">-- This identifies the types described by</span><span>
</span><span id="line-2477"></span><span class="hs-comment">--    Note [NON-BOTTOM-DICTS invariant] in GHC.Core</span><span>
</span><span id="line-2478"></span><span class="hs-comment">-- NB: unlifted types are not terminating types!</span><span>
</span><span id="line-2479"></span><span class="hs-comment">--     e.g. you can write a term (loop 1)::Int# that diverges.</span><span>
</span><span id="line-2480"></span><span id="isTerminatingType"><span class="annot"><span class="annottext">isTerminatingType :: HasDebugCallStack =&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTerminatingType"><span class="hs-identifier hs-var hs-var">isTerminatingType</span></a></span></span><span> </span><span id="local-6989586621682565160"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565160"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565160"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2481"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565161"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565161"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isClassTyCon"><span class="hs-identifier hs-var">isClassTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565161"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565161"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2482"></span><span>    </span><span class="annot"><span class="annottext">Maybe TyCon
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2483"></span><span>
</span><span id="line-2484"></span><span class="annot"><a href="GHC.Core.Type.html#isPrimitiveType"><span class="hs-identifier hs-type">isPrimitiveType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2485"></span><span class="annot"><span class="hs-comment">-- ^ Returns true of types that are opaque to Haskell.</span></span><span>
</span><span id="line-2486"></span><span id="isPrimitiveType"><span class="annot"><span class="annottext">isPrimitiveType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isPrimitiveType"><span class="hs-identifier hs-var hs-var">isPrimitiveType</span></a></span></span><span> </span><span id="local-6989586621682565164"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565164"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565164"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2487"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682565165"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565165"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682565166"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565166"><span class="hs-identifier hs-var">ty_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (TyCon -&gt; Bool) -&gt; TyCon -&gt; Bool
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565166"><span class="hs-identifier hs-var">ty_args</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Arity -&gt; Bool
forall a. [a] -&gt; Arity -&gt; Bool
</span><a href="GHC.Utils.Misc.html#lengthIs"><span class="hs-operator hs-var">`lengthIs`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Arity
</span><a href="GHC.Core.TyCon.html#tyConArity"><span class="hs-identifier hs-var">tyConArity</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565165"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-2488"></span><span>                                              </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isPrimTyCon"><span class="hs-identifier hs-var">isPrimTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565165"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2489"></span><span>                        </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2490"></span><span>
</span><span id="line-2491"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Join points}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-2498"></span><span>
</span><span id="line-2499"></span><span class="hs-comment">-- | Determine whether a type could be the type of a join point of given total</span><span>
</span><span id="line-2500"></span><span class="hs-comment">-- arity, according to the polymorphism rule. A join point cannot be polymorphic</span><span>
</span><span id="line-2501"></span><span class="hs-comment">-- in its return type, since given</span><span>
</span><span id="line-2502"></span><span class="hs-comment">--   join j @a @b x y z = e1 in e2,</span><span>
</span><span id="line-2503"></span><span class="hs-comment">-- the types of e1 and e2 must be the same, and a and b are not in scope for e2.</span><span>
</span><span id="line-2504"></span><span class="hs-comment">-- (See Note [The polymorphism rule of join points] in &quot;GHC.Core&quot;.) Returns False</span><span>
</span><span id="line-2505"></span><span class="hs-comment">-- also if the type simply doesn't have enough arguments.</span><span>
</span><span id="line-2506"></span><span class="hs-comment">--</span><span>
</span><span id="line-2507"></span><span class="hs-comment">-- Note that we need to know how many arguments (type *and* value) the putative</span><span>
</span><span id="line-2508"></span><span class="hs-comment">-- join point takes; for instance, if</span><span>
</span><span id="line-2509"></span><span class="hs-comment">--   j :: forall a. a -&gt; Int</span><span>
</span><span id="line-2510"></span><span class="hs-comment">-- then j could be a binary join point returning an Int, but it could *not* be a</span><span>
</span><span id="line-2511"></span><span class="hs-comment">-- unary join point returning a -&gt; Int.</span><span>
</span><span id="line-2512"></span><span class="hs-comment">--</span><span>
</span><span id="line-2513"></span><span class="hs-comment">-- TODO: See Note [Excess polymorphism and join points]</span><span>
</span><span id="line-2514"></span><span class="annot"><a href="GHC.Core.Type.html#isValidJoinPointType"><span class="hs-identifier hs-type">isValidJoinPointType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#JoinArity"><span class="hs-identifier hs-type">JoinArity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2515"></span><span id="isValidJoinPointType"><span class="annot"><span class="annottext">isValidJoinPointType :: Arity -&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isValidJoinPointType"><span class="hs-identifier hs-var hs-var">isValidJoinPointType</span></a></span></span><span> </span><span id="local-6989586621682565169"><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621682565169"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span id="local-6989586621682565170"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565170"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2516"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Arity -&gt; Type -&gt; Bool
forall {t}. (Eq t, Num t) =&gt; VarSet -&gt; t -&gt; Type -&gt; Bool
</span><a href="#local-6989586621682565171"><span class="hs-identifier hs-var">valid_under</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621682565169"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565170"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2517"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2518"></span><span>    </span><span id="local-6989586621682565171"><span class="annot"><span class="annottext">valid_under :: VarSet -&gt; t -&gt; Type -&gt; Bool
</span><a href="#local-6989586621682565171"><span class="hs-identifier hs-var hs-var">valid_under</span></a></span></span><span> </span><span id="local-6989586621682565181"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682565181"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621682565182"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682565182"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span id="local-6989586621682565183"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565183"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2519"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682565182"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2520"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682565181"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#disjointVarSet"><span class="hs-operator hs-var">`disjointVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565183"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2521"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682565185"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565185"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682565186"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565186"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TyVar, Type)
</span><a href="GHC.Core.Type.html#splitForAllTyCoVar_maybe"><span class="hs-identifier hs-var">splitForAllTyCoVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565183"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2522"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; t -&gt; Type -&gt; Bool
</span><a href="#local-6989586621682565171"><span class="hs-identifier hs-var">valid_under</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682565181"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; TyVar -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#extendVarSet"><span class="hs-operator hs-var">`extendVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565185"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682565182"><span class="hs-identifier hs-var">arity</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565186"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-2523"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682565188"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565188"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (FunTyFlag, Type, Type, Type)
</span><a href="GHC.Core.Type.html#splitFunTy_maybe"><span class="hs-identifier hs-var">splitFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565183"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2524"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; t -&gt; Type -&gt; Bool
</span><a href="#local-6989586621682565171"><span class="hs-identifier hs-var">valid_under</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682565181"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682565182"><span class="hs-identifier hs-var">arity</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565188"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-2525"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2526"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2527"></span><span>
</span><span id="line-2528"></span><span class="hs-comment">{- Note [Excess polymorphism and join points]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In principle, if a function would be a join point except that it fails
the polymorphism rule (see Note [The polymorphism rule of join points] in
GHC.Core), it can still be made a join point with some effort. This is because
all tail calls must return the same type (they return to the same context!), and
thus if the return type depends on an argument, that argument must always be the
same.

For instance, consider:

  let f :: forall a. a -&gt; Char -&gt; [a]
      f @a x c = ... f @a y 'a' ...
  in ... f @Int 1 'b' ... f @Int 2 'c' ...

(where the calls are tail calls). `f` fails the polymorphism rule because its
return type is [a], where [a] is bound. But since the type argument is always
'Int', we can rewrite it as:

  let f' :: Int -&gt; Char -&gt; [Int]
      f' x c = ... f' y 'a' ...
  in ... f' 1 'b' ... f 2 'c' ...

and now we can make f' a join point:

  join f' :: Int -&gt; Char -&gt; [Int]
       f' x c = ... jump f' y 'a' ...
  in ... jump f' 1 'b' ... jump f' 2 'c' ...

It's not clear that this comes up often, however. TODO: Measure how often and
add this analysis if necessary.  See #14620.


************************************************************************
*                                                                      *
\subsection{Sequencing on types}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-2567"></span><span>
</span><span id="line-2568"></span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-type">seqType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2569"></span><span id="seqType"><span class="annot"><span class="annottext">seqType :: Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var hs-var">seqType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621682565189"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682565189"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682565189"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2570"></span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682565190"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565190"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565190"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2571"></span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682565191"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565191"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682565192"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565192"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565191"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565192"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2572"></span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682565193"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565193"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682565194"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565194"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682565195"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565195"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565193"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565194"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565195"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2573"></span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682565196"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565196"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682565197"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565197"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565196"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ()
</span><a href="GHC.Core.Type.html#seqTypes"><span class="hs-identifier hs-var">seqTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565197"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2574"></span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682565198"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565198"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682565199"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565199"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565198"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565199"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2575"></span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682565200"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565200"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682565201"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682565201"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565200"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; ()
</span><a href="GHC.Core.Coercion.html#seqCo"><span class="hs-identifier hs-var">seqCo</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682565201"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2576"></span><span class="annot"><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621682565202"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682565202"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; ()
</span><a href="GHC.Core.Coercion.html#seqCo"><span class="hs-identifier hs-var">seqCo</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682565202"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2577"></span><span>
</span><span id="line-2578"></span><span class="annot"><a href="GHC.Core.Type.html#seqTypes"><span class="hs-identifier hs-type">seqTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2579"></span><span id="seqTypes"><span class="annot"><span class="annottext">seqTypes :: [Type] -&gt; ()
</span><a href="GHC.Core.Type.html#seqTypes"><span class="hs-identifier hs-var hs-var">seqTypes</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2580"></span><span class="annot"><a href="GHC.Core.Type.html#seqTypes"><span class="hs-identifier hs-var">seqTypes</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682565203"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565203"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682565204"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565204"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ()
</span><a href="GHC.Core.Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565203"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ()
</span><a href="GHC.Core.Type.html#seqTypes"><span class="hs-identifier hs-var">seqTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565204"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2581"></span><span>
</span><span id="line-2582"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
        The kind of a type
*                                                                      *
************************************************************************

Note [Kinding rules for types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Here are the key kinding rules for types

          torc1 is TYPE or CONSTRAINT
          torc2 is TYPE or CONSTRAINT
          t1 : torc1 rep1
          t2 : torc2 rep2
   (FUN)  ----------------
          t1 -&gt; t2 : torc2 LiftedRep
          -- In fact the arrow varies with torc1/torc2
          -- See Note [Function type constructors and FunTy]
          -- in GHC.Builtin.Types.Prim

          torc is TYPE or CONSTRAINT
          ty : body_torc rep
          ki : Type
          `a` is a type variable
          `a` is not free in rep
(FORALL1) -----------------------
          forall (a::ki). ty : body_torc rep

          torc is TYPE or CONSTRAINT
          ty : body_torc rep
          `c` is a coercion variable
          `c` is not free in rep
          `c` is free in ty       -- Surprise 1!
(FORALL2) -------------------------
          forall (cv::k1 ~#{N,R} k2). ty : body_torc LiftedRep
                                           -- Surprise 2!

Note that:
* (FORALL1) rejects (forall (a::Maybe). blah)

* (FORALL2) Surprise 1:
  See GHC.Core.TyCo.Rep Note [Unused coercion variable in ForAllTy]

* (FORALL2) Surprise 2: coercion abstractions are not erased, so
  this must be LiftedRep, just like (FUN).  (FORALL2) is just a
  dependent form of (FUN).


Note [Phantom type variables in kinds]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider

  type K (r :: RuntimeRep) = Type   -- Note 'r' is unused
  data T r :: K r                   -- T :: forall r -&gt; K r
  foo :: forall r. T r

The body of the forall in foo's type has kind (K r), and
normally it would make no sense to have
   forall r. (ty :: K r)
because the kind of the forall would escape the binding
of 'r'.  But in this case it's fine because (K r) expands
to Type, so we explicitly /permit/ the type
   forall r. T r

To accommodate such a type, in typeKind (forall a.ty) we use
occCheckExpand to expand any type synonyms in the kind of 'ty'
to eliminate 'a'.  See kinding rule (FORALL) in
Note [Kinding rules for types]


See also
 * GHC.Core.Type.occCheckExpand
 * GHC.Core.Utils.coreAltsType
 * GHC.Tc.Validity.checkEscapingKind
all of which grapple with the same problem.

See #14939.
-}</span><span>
</span><span id="line-2661"></span><span>
</span><span id="line-2662"></span><span class="hs-comment">-----------------------------</span><span>
</span><span id="line-2663"></span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-type">typeKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span>
</span><span id="line-2664"></span><span class="hs-comment">-- No need to expand synonyms</span><span>
</span><span id="line-2665"></span><span id="typeKind"><span class="annot"><span class="annottext">typeKind :: HasDebugCallStack =&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var hs-var">typeKind</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682565227"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565227"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682565228"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565228"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; [Type] -&gt; Type
Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#tyConKind"><span class="hs-identifier hs-var">tyConKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565227"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565228"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2666"></span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621682565229"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682565229"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><a href="GHC.Core.Type.html#typeLiteralKind"><span class="hs-identifier hs-var">typeLiteralKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682565229"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-2667"></span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682565231"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682565231"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; TypeOrConstraint
</span><a href="GHC.Types.Var.html#funTyFlagResultTypeOrConstraint"><span class="hs-identifier hs-var">funTyFlagResultTypeOrConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682565231"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2668"></span><span>                                     </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a></span><span>
</span><span id="line-2669"></span><span>                                     </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#ConstraintLike"><span class="hs-identifier hs-var">ConstraintLike</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#constraintKind"><span class="hs-identifier hs-var">constraintKind</span></a></span><span>
</span><span id="line-2670"></span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682565235"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565235"><span class="hs-identifier hs-var">tyvar</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565235"><span class="hs-identifier hs-var">tyvar</span></a></span><span>
</span><span id="line-2671"></span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682565236"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565236"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span id="local-6989586621682565237"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682565237"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; KindCoercion -&gt; Type
KindCoercion -&gt; Type
</span><a href="GHC.Core.Coercion.html#coercionRKind"><span class="hs-identifier hs-var">coercionRKind</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682565237"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2672"></span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621682565238"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682565238"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Type
</span><a href="GHC.Core.Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621682565238"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2673"></span><span>
</span><span id="line-2674"></span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682565239"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565239"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621682565240"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565240"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2675"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621682565241"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565239"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565240"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2676"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2677"></span><span>    </span><span class="hs-comment">-- Accumulate the type arguments, so we can call piResultTys,</span><span>
</span><span id="line-2678"></span><span>    </span><span class="hs-comment">-- rather than a succession of calls to piResultTy (which is</span><span>
</span><span id="line-2679"></span><span>    </span><span class="hs-comment">-- asymptotically costly as the number of arguments increases)</span><span>
</span><span id="line-2680"></span><span>    </span><span id="local-6989586621682565241"><span class="annot"><span class="annottext">go :: Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621682565241"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682565244"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565244"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621682565245"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565245"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682565246"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565246"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; Type
</span><a href="#local-6989586621682565241"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565244"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565245"><span class="hs-identifier hs-var">arg</span></a></span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565246"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2681"></span><span>    </span><span class="annot"><a href="#local-6989586621682565241"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682565247"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565247"><span class="hs-identifier hs-var">fun</span></a></span></span><span>             </span><span id="local-6989586621682565248"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565248"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; [Type] -&gt; Type
Type -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565247"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565248"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2682"></span><span>
</span><span id="line-2683"></span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span id="local-6989586621682565249"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682565249"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2684"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; Type -&gt; Type
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682565250"><span class="hs-identifier hs-var">tcvs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565249"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2685"></span><span>       </span><span class="hs-comment">-- If tcvs is empty somehow we'll get an infinite loop!</span><span>
</span><span id="line-2686"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; Type -&gt; Maybe Type
</span><a href="GHC.Core.TyCo.FVs.html#occCheckExpand"><span class="hs-identifier hs-var">occCheckExpand</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682565250"><span class="hs-identifier hs-var">tcvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565251"><span class="hs-identifier hs-var">body_kind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2687"></span><span>      </span><span class="hs-comment">-- We must make sure tvs do not occur in kind,</span><span>
</span><span id="line-2688"></span><span>      </span><span class="hs-comment">-- as they would be out of scope!</span><span>
</span><span id="line-2689"></span><span>      </span><span class="hs-comment">-- See Note [Phantom type variables in kinds]</span><span>
</span><span id="line-2690"></span><span>      </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;typeKind&quot;</span></span><span>
</span><span id="line-2691"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565249"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682565250"><span class="hs-identifier hs-var">tcvs</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565252"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565251"><span class="hs-identifier hs-var">body_kind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2692"></span><span>
</span><span id="line-2693"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565253"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565253"><span class="hs-identifier hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(TyVar -&gt; Bool) -&gt; [TyVar] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682565250"><span class="hs-identifier hs-var">tcvs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565253"><span class="hs-identifier hs-var">k'</span></a></span><span>                     </span><span class="hs-comment">-- Rule (FORALL1)</span><span>
</span><span id="line-2694"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565254"><span class="hs-identifier hs-var">lifted_kind_from_body</span></a></span><span>  </span><span class="hs-comment">-- Rule (FORALL2)</span><span>
</span><span id="line-2695"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2696"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682565250"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621682565250"><span class="hs-identifier hs-var">tcvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682565252"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565252"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([TyVar], Type)
</span><a href="GHC.Core.Type.html#splitForAllTyCoVars"><span class="hs-identifier hs-var">splitForAllTyCoVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565249"><span class="hs-identifier hs-var">ty</span></a></span><span>  </span><span class="hs-comment">-- Important: splits both TyVar and CoVar binders</span><span>
</span><span id="line-2697"></span><span>    </span><span id="local-6989586621682565251"><span class="annot"><span class="annottext">body_kind :: Type
</span><a href="#local-6989586621682565251"><span class="hs-identifier hs-var hs-var">body_kind</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565252"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-2698"></span><span>
</span><span id="line-2699"></span><span>    </span><span id="local-6989586621682565254"><span class="annot"><span class="annottext">lifted_kind_from_body :: Type
</span><a href="#local-6989586621682565254"><span class="hs-identifier hs-var hs-var">lifted_kind_from_body</span></a></span></span><span>  </span><span class="hs-comment">-- Implements (FORALL2)</span><span>
</span><span id="line-2700"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TypeOrConstraint, Type)
</span><a href="GHC.Core.Type.html#sORTKind_maybe"><span class="hs-identifier hs-var">sORTKind_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565251"><span class="hs-identifier hs-var">body_kind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2701"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#ConstraintLike"><span class="hs-identifier hs-var">ConstraintLike</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#constraintKind"><span class="hs-identifier hs-var">constraintKind</span></a></span><span>
</span><span id="line-2702"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a></span><span>
</span><span id="line-2703"></span><span>          </span><span class="annot"><span class="annottext">Maybe (TypeOrConstraint, Type)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;typeKind&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565251"><span class="hs-identifier hs-var">body_kind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2704"></span><span>
</span><span id="line-2705"></span><span class="hs-comment">---------------------------------------------</span><span>
</span><span id="line-2706"></span><span>
</span><span id="line-2707"></span><span class="annot"><a href="GHC.Core.Type.html#sORTKind_maybe"><span class="hs-identifier hs-type">sORTKind_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#TypeOrConstraint"><span class="hs-identifier hs-type">TypeOrConstraint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2708"></span><span class="hs-comment">-- Sees if the argument is of form (TYPE rep) or (CONSTRAINT rep)</span><span>
</span><span id="line-2709"></span><span class="hs-comment">-- and if so returns which, and the runtime rep</span><span>
</span><span id="line-2710"></span><span class="hs-comment">--</span><span>
</span><span id="line-2711"></span><span class="hs-comment">-- This is a &quot;hot&quot; function.  Do not call splitTyConApp_maybe here,</span><span>
</span><span id="line-2712"></span><span class="hs-comment">-- to avoid the faff with FunTy</span><span>
</span><span id="line-2713"></span><span id="sORTKind_maybe"><span class="annot"><span class="annottext">sORTKind_maybe :: Type -&gt; Maybe (TypeOrConstraint, Type)
</span><a href="GHC.Core.Type.html#sORTKind_maybe"><span class="hs-identifier hs-var hs-var">sORTKind_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682565255"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565255"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682565256"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565256"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2714"></span><span>  </span><span class="hs-comment">-- First, short-cuts for Type and Constraint that do no allocation</span><span>
</span><span id="line-2715"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682565257"><span class="hs-identifier hs-var">tc_uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#liftedTypeKindTyConKey"><span class="hs-identifier hs-var">liftedTypeKindTyConKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Maybe (TypeOrConstraint, Type) -&gt; Maybe (TypeOrConstraint, Type)
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565256"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (TypeOrConstraint, Type) -&gt; Maybe (TypeOrConstraint, Type))
-&gt; Maybe (TypeOrConstraint, Type) -&gt; Maybe (TypeOrConstraint, Type)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(TypeOrConstraint, Type) -&gt; Maybe (TypeOrConstraint, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#liftedRepTy"><span class="hs-identifier hs-var">liftedRepTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2716"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682565257"><span class="hs-identifier hs-var">tc_uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#constraintKindTyConKey"><span class="hs-identifier hs-var">constraintKindTyConKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Maybe (TypeOrConstraint, Type) -&gt; Maybe (TypeOrConstraint, Type)
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565256"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (TypeOrConstraint, Type) -&gt; Maybe (TypeOrConstraint, Type))
-&gt; Maybe (TypeOrConstraint, Type) -&gt; Maybe (TypeOrConstraint, Type)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(TypeOrConstraint, Type) -&gt; Maybe (TypeOrConstraint, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#ConstraintLike"><span class="hs-identifier hs-var">ConstraintLike</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#liftedRepTy"><span class="hs-identifier hs-var">liftedRepTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2717"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682565257"><span class="hs-identifier hs-var">tc_uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#tYPETyConKey"><span class="hs-identifier hs-var">tYPETyConKey</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint -&gt; Maybe (TypeOrConstraint, Type)
</span><a href="#local-6989586621682565259"><span class="hs-identifier hs-var">get_rep</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span>
</span><span id="line-2718"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682565257"><span class="hs-identifier hs-var">tc_uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#cONSTRAINTTyConKey"><span class="hs-identifier hs-var">cONSTRAINTTyConKey</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint -&gt; Maybe (TypeOrConstraint, Type)
</span><a href="#local-6989586621682565259"><span class="hs-identifier hs-var">get_rep</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#ConstraintLike"><span class="hs-identifier hs-var">ConstraintLike</span></a></span><span>
</span><span id="line-2719"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565261"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565261"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#expandSynTyConApp_maybe"><span class="hs-identifier hs-var">expandSynTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565255"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565256"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TypeOrConstraint, Type)
</span><a href="GHC.Core.Type.html#sORTKind_maybe"><span class="hs-identifier hs-var">sORTKind_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565261"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-2720"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2721"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621682565257"><span class="annot"><span class="annottext">tc_uniq :: Unique
</span><a href="#local-6989586621682565257"><span class="hs-identifier hs-var hs-var">tc_uniq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique
</span><a href="GHC.Core.TyCon.html#tyConUnique"><span class="hs-identifier hs-var">tyConUnique</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565255"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2722"></span><span>     </span><span class="hs-comment">-- This bang on tc_uniq is important.  It means that sORTKind_maybe starts</span><span>
</span><span id="line-2723"></span><span>     </span><span class="hs-comment">-- by evaluating tc_uniq, and then ends up with a single case with a 4-way branch</span><span>
</span><span id="line-2724"></span><span>
</span><span id="line-2725"></span><span>    </span><span id="local-6989586621682565259"><span class="annot"><span class="annottext">get_rep :: TypeOrConstraint -&gt; Maybe (TypeOrConstraint, Type)
</span><a href="#local-6989586621682565259"><span class="hs-identifier hs-var hs-var">get_rep</span></a></span></span><span> </span><span id="local-6989586621682565262"><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="#local-6989586621682565262"><span class="hs-identifier hs-var">torc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565256"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2726"></span><span>                     </span><span class="hs-special">(</span><span id="local-6989586621682565263"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565263"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682565264"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565264"><span class="hs-identifier hs-var">_reps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Maybe (TypeOrConstraint, Type) -&gt; Maybe (TypeOrConstraint, Type)
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565264"><span class="hs-identifier hs-var">_reps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (TypeOrConstraint, Type) -&gt; Maybe (TypeOrConstraint, Type))
-&gt; Maybe (TypeOrConstraint, Type) -&gt; Maybe (TypeOrConstraint, Type)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(TypeOrConstraint, Type) -&gt; Maybe (TypeOrConstraint, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="#local-6989586621682565262"><span class="hs-identifier hs-var">torc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565263"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2727"></span><span>                     </span><span class="hs-special">[</span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (TypeOrConstraint, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2728"></span><span>
</span><span id="line-2729"></span><span class="annot"><a href="GHC.Core.Type.html#sORTKind_maybe"><span class="hs-identifier hs-var">sORTKind_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TypeOrConstraint, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2730"></span><span>
</span><span id="line-2731"></span><span class="annot"><a href="GHC.Core.Type.html#typeTypeOrConstraint"><span class="hs-identifier hs-type">typeTypeOrConstraint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#TypeOrConstraint"><span class="hs-identifier hs-type">TypeOrConstraint</span></a></span><span>
</span><span id="line-2732"></span><span class="hs-comment">-- Precondition: expects a type that classifies values.</span><span>
</span><span id="line-2733"></span><span class="hs-comment">-- Returns whether it is TypeLike or ConstraintLike.</span><span>
</span><span id="line-2734"></span><span class="hs-comment">-- Equivalent to calling sORTKind_maybe, but faster in the FunTy case</span><span>
</span><span id="line-2735"></span><span id="typeTypeOrConstraint"><span class="annot"><span class="annottext">typeTypeOrConstraint :: HasDebugCallStack =&gt; Type -&gt; TypeOrConstraint
</span><a href="GHC.Core.Type.html#typeTypeOrConstraint"><span class="hs-identifier hs-var hs-var">typeTypeOrConstraint</span></a></span></span><span> </span><span id="local-6989586621682565274"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565274"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2736"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#coreFullView"><span class="hs-identifier hs-var">coreFullView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565274"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2737"></span><span>       </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682565275"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682565275"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; TypeOrConstraint
</span><a href="GHC.Types.Var.html#funTyFlagResultTypeOrConstraint"><span class="hs-identifier hs-var">funTyFlagResultTypeOrConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682565275"><span class="hs-identifier hs-var">af</span></a></span><span>
</span><span id="line-2738"></span><span>       </span><span id="local-6989586621682565276"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565276"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682565277"><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="#local-6989586621682565277"><span class="hs-identifier hs-var">torc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TypeOrConstraint, Type)
</span><a href="GHC.Core.Type.html#sORTKind_maybe"><span class="hs-identifier hs-var">sORTKind_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565276"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2739"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="#local-6989586621682565277"><span class="hs-identifier hs-var">torc</span></a></span><span>
</span><span id="line-2740"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2741"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TypeOrConstraint
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;typeOrConstraint&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565274"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565274"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2742"></span><span>
</span><span id="line-2743"></span><span class="annot"><a href="GHC.Core.Type.html#isPredTy"><span class="hs-identifier hs-type">isPredTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2744"></span><span class="hs-comment">-- Precondition: expects a type that classifies values</span><span>
</span><span id="line-2745"></span><span class="hs-comment">-- See Note [Types for coercions, predicates, and evidence] in GHC.Core.TyCo.Rep</span><span>
</span><span id="line-2746"></span><span class="hs-comment">-- Returns True for types of kind (CONSTRAINT _), False for ones of kind (TYPE _)</span><span>
</span><span id="line-2747"></span><span id="isPredTy"><span class="annot"><span class="annottext">isPredTy :: HasDebugCallStack =&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isPredTy"><span class="hs-identifier hs-var hs-var">isPredTy</span></a></span></span><span> </span><span id="local-6989586621682565280"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565280"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; TypeOrConstraint
Type -&gt; TypeOrConstraint
</span><a href="GHC.Core.Type.html#typeTypeOrConstraint"><span class="hs-identifier hs-var">typeTypeOrConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565280"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2748"></span><span>                  </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2749"></span><span>                  </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#ConstraintLike"><span class="hs-identifier hs-var">ConstraintLike</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2750"></span><span>
</span><span id="line-2751"></span><span class="hs-comment">-- | Does this classify a type allowed to have values? Responds True to things</span><span>
</span><span id="line-2752"></span><span class="hs-comment">-- like *, TYPE Lifted, TYPE IntRep, TYPE v, Constraint.</span><span>
</span><span id="line-2753"></span><span class="annot"><a href="GHC.Core.Type.html#isTYPEorCONSTRAINT"><span class="hs-identifier hs-type">isTYPEorCONSTRAINT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2754"></span><span class="annot"><span class="hs-comment">-- ^ True of a kind `TYPE _` or `CONSTRAINT _`</span></span><span>
</span><span id="line-2755"></span><span id="isTYPEorCONSTRAINT"><span class="annot"><span class="annottext">isTYPEorCONSTRAINT :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTYPEorCONSTRAINT"><span class="hs-identifier hs-var hs-var">isTYPEorCONSTRAINT</span></a></span></span><span> </span><span id="local-6989586621682565281"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565281"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TypeOrConstraint, Type) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Maybe (TypeOrConstraint, Type)
</span><a href="GHC.Core.Type.html#sORTKind_maybe"><span class="hs-identifier hs-var">sORTKind_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565281"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2756"></span><span>
</span><span id="line-2757"></span><span class="annot"><a href="GHC.Core.Type.html#tyConIsTYPEorCONSTRAINT"><span class="hs-identifier hs-type">tyConIsTYPEorCONSTRAINT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2758"></span><span id="tyConIsTYPEorCONSTRAINT"><span class="annot"><span class="annottext">tyConIsTYPEorCONSTRAINT :: TyCon -&gt; Bool
</span><a href="GHC.Core.Type.html#tyConIsTYPEorCONSTRAINT"><span class="hs-identifier hs-var hs-var">tyConIsTYPEorCONSTRAINT</span></a></span></span><span> </span><span id="local-6989586621682565282"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565282"><span class="hs-identifier hs-var">tc</span></a></span></span><span>
</span><span id="line-2759"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682565283"><span class="hs-identifier hs-var">tc_uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#tYPETyConKey"><span class="hs-identifier hs-var">tYPETyConKey</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682565283"><span class="hs-identifier hs-var">tc_uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#cONSTRAINTTyConKey"><span class="hs-identifier hs-var">cONSTRAINTTyConKey</span></a></span><span>
</span><span id="line-2760"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2761"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621682565283"><span class="annot"><span class="annottext">tc_uniq :: Unique
</span><a href="#local-6989586621682565283"><span class="hs-identifier hs-var hs-var">tc_uniq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique
</span><a href="GHC.Core.TyCon.html#tyConUnique"><span class="hs-identifier hs-var">tyConUnique</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565282"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2762"></span><span>
</span><span id="line-2763"></span><span class="annot"><a href="GHC.Core.Type.html#isConstraintLikeKind"><span class="hs-identifier hs-type">isConstraintLikeKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2764"></span><span class="hs-comment">-- True of (CONSTRAINT _)</span><span>
</span><span id="line-2765"></span><span id="isConstraintLikeKind"><span class="annot"><span class="annottext">isConstraintLikeKind :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isConstraintLikeKind"><span class="hs-identifier hs-var hs-var">isConstraintLikeKind</span></a></span></span><span> </span><span id="local-6989586621682565284"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565284"><span class="hs-identifier hs-var">kind</span></a></span></span><span>
</span><span id="line-2766"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TypeOrConstraint, Type)
</span><a href="GHC.Core.Type.html#sORTKind_maybe"><span class="hs-identifier hs-var">sORTKind_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565284"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2767"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#ConstraintLike"><span class="hs-identifier hs-var">ConstraintLike</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2768"></span><span>      </span><span class="annot"><span class="annottext">Maybe (TypeOrConstraint, Type)
</span><span class="hs-identifier">_</span></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2769"></span><span>
</span><span id="line-2770"></span><span class="annot"><a href="GHC.Core.Type.html#isConstraintKind"><span class="hs-identifier hs-type">isConstraintKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2771"></span><span class="hs-comment">-- True of (CONSTRAINT LiftedRep)</span><span>
</span><span id="line-2772"></span><span id="isConstraintKind"><span class="annot"><span class="annottext">isConstraintKind :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isConstraintKind"><span class="hs-identifier hs-var hs-var">isConstraintKind</span></a></span></span><span> </span><span id="local-6989586621682565285"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565285"><span class="hs-identifier hs-var">kind</span></a></span></span><span>
</span><span id="line-2773"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TypeOrConstraint, Type)
</span><a href="GHC.Core.Type.html#sORTKind_maybe"><span class="hs-identifier hs-var">sORTKind_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565285"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2774"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#ConstraintLike"><span class="hs-identifier hs-var">ConstraintLike</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682565286"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565286"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLiftedRuntimeRep"><span class="hs-identifier hs-var">isLiftedRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565286"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-2775"></span><span>      </span><span class="annot"><span class="annottext">Maybe (TypeOrConstraint, Type)
</span><span class="hs-identifier">_</span></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2776"></span><span>
</span><span id="line-2777"></span><span class="annot"><a href="GHC.Core.Type.html#tcIsLiftedTypeKind"><span class="hs-identifier hs-type">tcIsLiftedTypeKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2778"></span><span class="annot"><span class="hs-comment">-- ^ Is this kind equivalent to 'Type' i.e. TYPE LiftedRep?</span></span><span>
</span><span id="line-2779"></span><span id="tcIsLiftedTypeKind"><span class="annot"><span class="annottext">tcIsLiftedTypeKind :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#tcIsLiftedTypeKind"><span class="hs-identifier hs-var hs-var">tcIsLiftedTypeKind</span></a></span></span><span> </span><span id="local-6989586621682565287"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565287"><span class="hs-identifier hs-var">kind</span></a></span></span><span>
</span><span id="line-2780"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682565288"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565288"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TypeOrConstraint, Type)
</span><a href="GHC.Core.Type.html#sORTKind_maybe"><span class="hs-identifier hs-var">sORTKind_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565287"><span class="hs-identifier hs-var">kind</span></a></span><span>
</span><span id="line-2781"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLiftedRuntimeRep"><span class="hs-identifier hs-var">isLiftedRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565288"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-2782"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2783"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2784"></span><span>
</span><span id="line-2785"></span><span class="annot"><a href="GHC.Core.Type.html#tcIsBoxedTypeKind"><span class="hs-identifier hs-type">tcIsBoxedTypeKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2786"></span><span class="annot"><span class="hs-comment">-- ^ Is this kind equivalent to @TYPE (BoxedRep l)@ for some @l :: Levity@?</span></span><span>
</span><span id="line-2787"></span><span id="tcIsBoxedTypeKind"><span class="annot"><span class="annottext">tcIsBoxedTypeKind :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#tcIsBoxedTypeKind"><span class="hs-identifier hs-var hs-var">tcIsBoxedTypeKind</span></a></span></span><span> </span><span id="local-6989586621682565289"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565289"><span class="hs-identifier hs-var">kind</span></a></span></span><span>
</span><span id="line-2788"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682565290"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565290"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TypeOrConstraint, Type)
</span><a href="GHC.Core.Type.html#sORTKind_maybe"><span class="hs-identifier hs-var">sORTKind_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565289"><span class="hs-identifier hs-var">kind</span></a></span><span>
</span><span id="line-2789"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isBoxedRuntimeRep"><span class="hs-identifier hs-var">isBoxedRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565290"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-2790"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2791"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2792"></span><span>
</span><span id="line-2793"></span><span class="hs-comment">-- | Is this kind equivalent to @TYPE r@ (for some unknown r)?</span><span>
</span><span id="line-2794"></span><span class="hs-comment">--</span><span>
</span><span id="line-2795"></span><span class="hs-comment">-- This considers 'Constraint' to be distinct from @*@.</span><span>
</span><span id="line-2796"></span><span class="annot"><a href="GHC.Core.Type.html#isTypeLikeKind"><span class="hs-identifier hs-type">isTypeLikeKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2797"></span><span id="isTypeLikeKind"><span class="annot"><span class="annottext">isTypeLikeKind :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTypeLikeKind"><span class="hs-identifier hs-var hs-var">isTypeLikeKind</span></a></span></span><span> </span><span id="local-6989586621682565291"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565291"><span class="hs-identifier hs-var">kind</span></a></span></span><span>
</span><span id="line-2798"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TypeOrConstraint, Type)
</span><a href="GHC.Core.Type.html#sORTKind_maybe"><span class="hs-identifier hs-var">sORTKind_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565291"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2799"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2800"></span><span>      </span><span class="annot"><span class="annottext">Maybe (TypeOrConstraint, Type)
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2801"></span><span>
</span><span id="line-2802"></span><span class="annot"><a href="GHC.Core.Type.html#returnsConstraintKind"><span class="hs-identifier hs-type">returnsConstraintKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2803"></span><span class="hs-comment">-- True &lt;=&gt; the Kind ultimately returns a Constraint</span><span>
</span><span id="line-2804"></span><span class="hs-comment">--   E.g.  * -&gt; Constraint</span><span>
</span><span id="line-2805"></span><span class="hs-comment">--         forall k. k -&gt; Constraint</span><span>
</span><span id="line-2806"></span><span id="returnsConstraintKind"><span class="annot"><span class="annottext">returnsConstraintKind :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#returnsConstraintKind"><span class="hs-identifier hs-var hs-var">returnsConstraintKind</span></a></span></span><span> </span><span id="local-6989586621682565292"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565292"><span class="hs-identifier hs-var">kind</span></a></span></span><span>
</span><span id="line-2807"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565293"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565293"><span class="hs-identifier hs-var">kind'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565292"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#returnsConstraintKind"><span class="hs-identifier hs-var">returnsConstraintKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565293"><span class="hs-identifier hs-var">kind'</span></a></span><span>
</span><span id="line-2808"></span><span class="annot"><a href="GHC.Core.Type.html#returnsConstraintKind"><span class="hs-identifier hs-var">returnsConstraintKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682565294"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565294"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#returnsConstraintKind"><span class="hs-identifier hs-var">returnsConstraintKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565294"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2809"></span><span class="annot"><a href="GHC.Core.Type.html#returnsConstraintKind"><span class="hs-identifier hs-var">returnsConstraintKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682565295"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565295"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#returnsConstraintKind"><span class="hs-identifier hs-var">returnsConstraintKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565295"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2810"></span><span class="annot"><a href="GHC.Core.Type.html#returnsConstraintKind"><span class="hs-identifier hs-var">returnsConstraintKind</span></a></span><span> </span><span id="local-6989586621682565296"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565296"><span class="hs-identifier hs-var">kind</span></a></span></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isConstraintLikeKind"><span class="hs-identifier hs-var">isConstraintLikeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565296"><span class="hs-identifier hs-var">kind</span></a></span><span>
</span><span id="line-2811"></span><span>
</span><span id="line-2812"></span><span class="hs-comment">--------------------------</span><span>
</span><span id="line-2813"></span><span class="annot"><a href="GHC.Core.Type.html#typeLiteralKind"><span class="hs-identifier hs-type">typeLiteralKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyLit"><span class="hs-identifier hs-type">TyLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span>
</span><span id="line-2814"></span><span id="typeLiteralKind"><span class="annot"><span class="annottext">typeLiteralKind :: TyLit -&gt; Type
</span><a href="GHC.Core.Type.html#typeLiteralKind"><span class="hs-identifier hs-var hs-var">typeLiteralKind</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#NumTyLit"><span class="hs-identifier hs-type">NumTyLit</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#naturalTy"><span class="hs-identifier hs-var">naturalTy</span></a></span><span>
</span><span id="line-2815"></span><span class="annot"><a href="GHC.Core.Type.html#typeLiteralKind"><span class="hs-identifier hs-var">typeLiteralKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#StrTyLit"><span class="hs-identifier hs-type">StrTyLit</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#typeSymbolKind"><span class="hs-identifier hs-var">typeSymbolKind</span></a></span><span>
</span><span id="line-2816"></span><span class="annot"><a href="GHC.Core.Type.html#typeLiteralKind"><span class="hs-identifier hs-var">typeLiteralKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CharTyLit"><span class="hs-identifier hs-type">CharTyLit</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#charTy"><span class="hs-identifier hs-var">charTy</span></a></span><span>
</span><span id="line-2817"></span><span>
</span><span id="line-2818"></span><span class="hs-comment">-- | Returns True if a type has a syntactically fixed runtime rep,</span><span>
</span><span id="line-2819"></span><span class="hs-comment">-- as per Note [Fixed RuntimeRep] in GHC.Tc.Utils.Concrete.</span><span>
</span><span id="line-2820"></span><span class="hs-comment">--</span><span>
</span><span id="line-2821"></span><span class="hs-comment">-- This function is equivalent to `isFixedRuntimeRepKind . typeKind`</span><span>
</span><span id="line-2822"></span><span class="hs-comment">-- but much faster.</span><span>
</span><span id="line-2823"></span><span class="hs-comment">--</span><span>
</span><span id="line-2824"></span><span class="hs-comment">-- __Precondition:__ The type has kind @('TYPE' blah)@</span><span>
</span><span id="line-2825"></span><span class="annot"><a href="GHC.Core.Type.html#typeHasFixedRuntimeRep"><span class="hs-identifier hs-type">typeHasFixedRuntimeRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2826"></span><span id="typeHasFixedRuntimeRep"><span class="annot"><span class="annottext">typeHasFixedRuntimeRep :: HasDebugCallStack =&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#typeHasFixedRuntimeRep"><span class="hs-identifier hs-var hs-var">typeHasFixedRuntimeRep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682565298"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-2827"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2828"></span><span>    </span><span id="local-6989586621682565298"><span class="annot"><span class="annottext">go :: Type -&gt; Bool
</span><a href="#local-6989586621682565298"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682565301"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565301"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-2829"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#tcHasFixedRuntimeRep"><span class="hs-identifier hs-var">tcHasFixedRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565301"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2830"></span><span>    </span><span class="annot"><a href="#local-6989586621682565298"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2831"></span><span>    </span><span class="annot"><a href="#local-6989586621682565298"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2832"></span><span>    </span><span class="annot"><a href="#local-6989586621682565298"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682565303"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565303"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682565298"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565303"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2833"></span><span>    </span><span class="annot"><a href="#local-6989586621682565298"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682565304"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565304"><span class="hs-identifier hs-var">ty</span></a></span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Bool
Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFixedRuntimeRepKind"><span class="hs-identifier hs-var">isFixedRuntimeRepKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565304"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2834"></span><span>
</span><span id="line-2835"></span><span class="hs-comment">-- | Checks that a kind of the form 'Type', 'Constraint'</span><span>
</span><span id="line-2836"></span><span class="hs-comment">-- or @'TYPE r@ is concrete. See 'isConcreteType'.</span><span>
</span><span id="line-2837"></span><span class="hs-comment">--</span><span>
</span><span id="line-2838"></span><span class="hs-comment">-- __Precondition:__ The type has kind `TYPE blah` or `CONSTRAINT blah`</span><span>
</span><span id="line-2839"></span><span class="annot"><a href="GHC.Core.Type.html#isFixedRuntimeRepKind"><span class="hs-identifier hs-type">isFixedRuntimeRepKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2840"></span><span id="isFixedRuntimeRepKind"><span class="annot"><span class="annottext">isFixedRuntimeRepKind :: HasDebugCallStack =&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isFixedRuntimeRepKind"><span class="hs-identifier hs-var hs-var">isFixedRuntimeRepKind</span></a></span></span><span> </span><span id="local-6989586621682565309"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565309"><span class="hs-identifier hs-var">k</span></a></span></span><span>
</span><span id="line-2841"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; Bool -&gt; Bool
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTYPEorCONSTRAINT"><span class="hs-identifier hs-var">isTYPEorCONSTRAINT</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565309"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565309"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2842"></span><span>    </span><span class="hs-comment">-- the isLiftedTypeKind check is necessary b/c of Constraint</span><span>
</span><span id="line-2843"></span><span>    </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isConcreteType"><span class="hs-identifier hs-var">isConcreteType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565309"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-2844"></span><span>
</span><span id="line-2845"></span><span class="hs-comment">-- | Tests whether the given type is concrete, i.e. it</span><span>
</span><span id="line-2846"></span><span class="hs-comment">-- whether it consists only of concrete type constructors,</span><span>
</span><span id="line-2847"></span><span class="hs-comment">-- concrete type variables, and applications.</span><span>
</span><span id="line-2848"></span><span class="hs-comment">--</span><span>
</span><span id="line-2849"></span><span class="hs-comment">-- See Note [Concrete types] in GHC.Tc.Utils.Concrete.</span><span>
</span><span id="line-2850"></span><span class="annot"><a href="GHC.Core.Type.html#isConcreteType"><span class="hs-identifier hs-type">isConcreteType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2851"></span><span id="isConcreteType"><span class="annot"><span class="annottext">isConcreteType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isConcreteType"><span class="hs-identifier hs-var hs-var">isConcreteType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isConcreteTypeWith"><span class="hs-identifier hs-var">isConcreteTypeWith</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-2852"></span><span>
</span><span id="line-2853"></span><span class="annot"><a href="GHC.Core.Type.html#isConcreteTypeWith"><span class="hs-identifier hs-type">isConcreteTypeWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyVarSet"><span class="hs-identifier hs-type">TyVarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2854"></span><span class="hs-comment">-- See Note [Concrete types] in GHC.Tc.Utils.Concrete.</span><span>
</span><span id="line-2855"></span><span class="hs-comment">-- For this &quot;With&quot; version we pass in a set of TyVars to be considered</span><span>
</span><span id="line-2856"></span><span class="hs-comment">-- concrete.  This supports mkSynonymTyCon, which needs to test the RHS</span><span>
</span><span id="line-2857"></span><span class="hs-comment">-- for concreteness, under the assumption that the binders are instantiated</span><span>
</span><span id="line-2858"></span><span class="hs-comment">-- to concrete types</span><span>
</span><span id="line-2859"></span><span id="isConcreteTypeWith"><span class="annot"><span class="annottext">isConcreteTypeWith :: VarSet -&gt; Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isConcreteTypeWith"><span class="hs-identifier hs-var hs-var">isConcreteTypeWith</span></a></span></span><span> </span><span id="local-6989586621682565311"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682565311"><span class="hs-identifier hs-var">conc_tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682565312"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-2860"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2861"></span><span>    </span><span id="local-6989586621682565312"><span class="annot"><span class="annottext">go :: Type -&gt; Bool
</span><a href="#local-6989586621682565312"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682565313"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565313"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVar"><span class="hs-identifier hs-var">isConcreteTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565313"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565313"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682565311"><span class="hs-identifier hs-var">conc_tvs</span></a></span><span>
</span><span id="line-2862"></span><span>    </span><span class="annot"><a href="#local-6989586621682565312"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682565314"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565314"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621682565315"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565315"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682565312"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565314"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682565312"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565315"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-2863"></span><span>    </span><span class="annot"><a href="#local-6989586621682565312"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682565316"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565316"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682565317"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565317"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Bool
</span><a href="#local-6989586621682565318"><span class="hs-identifier hs-var">go_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565316"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565317"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2864"></span><span>    </span><span class="annot"><a href="#local-6989586621682565312"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2865"></span><span>    </span><span class="annot"><a href="#local-6989586621682565312"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682565319"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565319"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682565320"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565320"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682565321"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565321"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682565312"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565319"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-2866"></span><span>                           </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682565312"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565320"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682565312"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565320"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-2867"></span><span>                           </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682565312"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565321"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682565312"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565321"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2868"></span><span>    </span><span class="annot"><a href="#local-6989586621682565312"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2869"></span><span>    </span><span class="annot"><a href="#local-6989586621682565312"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2870"></span><span>    </span><span class="annot"><a href="#local-6989586621682565312"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2871"></span><span>
</span><span id="line-2872"></span><span>    </span><span id="local-6989586621682565318"><span class="annot"><span class="annottext">go_tc :: TyCon -&gt; [Type] -&gt; Bool
</span><a href="#local-6989586621682565318"><span class="hs-identifier hs-var hs-var">go_tc</span></a></span></span><span> </span><span id="local-6989586621682565322"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565322"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682565323"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565323"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-2873"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isForgetfulSynTyCon"><span class="hs-identifier hs-var">isForgetfulSynTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565322"><span class="hs-identifier hs-var">tc</span></a></span><span>  </span><span class="hs-comment">-- E.g. type S a = Int</span><span>
</span><span id="line-2874"></span><span>                                </span><span class="hs-comment">-- Then (S x) is concrete even if x isn't</span><span>
</span><span id="line-2875"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565324"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565324"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#expandSynTyConApp_maybe"><span class="hs-identifier hs-var">expandSynTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565322"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565323"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2876"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682565312"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565324"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-2877"></span><span>
</span><span id="line-2878"></span><span>      </span><span class="hs-comment">-- Apart from forgetful synonyms, isConcreteTyCon</span><span>
</span><span id="line-2879"></span><span>      </span><span class="hs-comment">-- is enough; no need to expand.  This is good for e.g</span><span>
</span><span id="line-2880"></span><span>      </span><span class="hs-comment">--      type LiftedRep = BoxedRep Lifted</span><span>
</span><span id="line-2881"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isConcreteTyCon"><span class="hs-identifier hs-var">isConcreteTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565322"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2882"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682565312"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565323"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2883"></span><span>
</span><span id="line-2884"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-comment">-- E.g. type families</span><span>
</span><span id="line-2885"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2886"></span><span>
</span><span id="line-2887"></span><span>
</span><span id="line-2888"></span><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
         Pretty-printing
%*                                                                      *
%************************************************************************

Most pretty-printing is either in GHC.Core.TyCo.Rep or GHC.Iface.Type.

-}</span><span>
</span><span id="line-2898"></span><span>
</span><span id="line-2899"></span><span class="hs-comment">-- | Does a 'TyCon' (that is applied to some number of arguments) need to be</span><span>
</span><span id="line-2900"></span><span class="hs-comment">-- ascribed with an explicit kind signature to resolve ambiguity if rendered as</span><span>
</span><span id="line-2901"></span><span class="hs-comment">-- a source-syntax type?</span><span>
</span><span id="line-2902"></span><span class="hs-comment">-- (See @Note [When does a tycon application need an explicit kind signature?]@</span><span>
</span><span id="line-2903"></span><span class="hs-comment">-- for a full explanation of what this function checks for.)</span><span>
</span><span id="line-2904"></span><span class="annot"><a href="GHC.Core.Type.html#tyConAppNeedsKindSig"><span class="hs-identifier hs-type">tyConAppNeedsKindSig</span></a></span><span>
</span><span id="line-2905"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>  </span><span class="hs-comment">-- ^ Should specified binders count towards injective positions in</span><span>
</span><span id="line-2906"></span><span>           </span><span class="hs-comment">--   the kind of the TyCon? (If you're using visible kind</span><span>
</span><span id="line-2907"></span><span>           </span><span class="hs-comment">--   applications, then you want True here.</span><span>
</span><span id="line-2908"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-2909"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ The number of args the 'TyCon' is applied to.</span></span><span>
</span><span id="line-2910"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>  </span><span class="hs-comment">-- ^ Does @T t_1 ... t_n@ need a kind signature? (Where @n@ is the</span><span>
</span><span id="line-2911"></span><span>           </span><span class="hs-comment">--   number of arguments)</span><span>
</span><span id="line-2912"></span><span id="tyConAppNeedsKindSig"><span class="annot"><span class="annottext">tyConAppNeedsKindSig :: Bool -&gt; TyCon -&gt; Arity -&gt; Bool
</span><a href="GHC.Core.Type.html#tyConAppNeedsKindSig"><span class="hs-identifier hs-var hs-var">tyConAppNeedsKindSig</span></a></span></span><span> </span><span id="local-6989586621682565326"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682565326"><span class="hs-identifier hs-var">spec_inj_pos</span></a></span></span><span> </span><span id="local-6989586621682565327"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565327"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682565328"><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621682565328"><span class="hs-identifier hs-var">n_args</span></a></span></span><span>
</span><span id="line-2913"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TyConBinder] -&gt; Arity -&gt; Ordering
forall a. [a] -&gt; Arity -&gt; Ordering
</span><a href="GHC.Utils.Misc.html#listLengthCmp"><span class="hs-identifier hs-var">listLengthCmp</span></a></span><span> </span><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621682565330"><span class="hs-identifier hs-var">tc_binders</span></a></span><span> </span><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621682565328"><span class="hs-identifier hs-var">n_args</span></a></span><span>
</span><span id="line-2914"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2915"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2916"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682565331"><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621682565331"><span class="hs-identifier hs-var">dropped_binders</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682565332"><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621682565332"><span class="hs-identifier hs-var">remaining_binders</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2917"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arity -&gt; [TyConBinder] -&gt; ([TyConBinder], [TyConBinder])
forall a. Arity -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621682565328"><span class="hs-identifier hs-var">n_args</span></a></span><span> </span><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621682565330"><span class="hs-identifier hs-var">tc_binders</span></a></span><span>
</span><span id="line-2918"></span><span>        </span><span id="local-6989586621682565333"><span class="annot"><span class="annottext">result_kind :: Type
</span><a href="#local-6989586621682565333"><span class="hs-identifier hs-var hs-var">result_kind</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyConBinder] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCon.html#mkTyConKind"><span class="hs-identifier hs-var">mkTyConKind</span></a></span><span> </span><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621682565332"><span class="hs-identifier hs-var">remaining_binders</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565335"><span class="hs-identifier hs-var">tc_res_kind</span></a></span><span>
</span><span id="line-2919"></span><span>        </span><span id="local-6989586621682565336"><span class="annot"><span class="annottext">result_vars :: VarSet
</span><a href="#local-6989586621682565336"><span class="hs-identifier hs-var hs-var">result_vars</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565333"><span class="hs-identifier hs-var">result_kind</span></a></span><span>
</span><span id="line-2920"></span><span>        </span><span id="local-6989586621682565337"><span class="annot"><span class="annottext">dropped_vars :: VarSet
</span><a href="#local-6989586621682565337"><span class="hs-identifier hs-var hs-var">dropped_vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV -&gt; VarSet
</span><a href="GHC.Utils.FV.html#fvVarSet"><span class="hs-identifier hs-var">fvVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">(FV -&gt; VarSet) -&gt; FV -&gt; VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2921"></span><span>                       </span><span class="annot"><span class="annottext">(TyConBinder -&gt; FV) -&gt; [TyConBinder] -&gt; FV
forall a. (a -&gt; FV) -&gt; [a] -&gt; FV
</span><a href="GHC.Utils.FV.html#mapUnionFV"><span class="hs-identifier hs-var">mapUnionFV</span></a></span><span> </span><span class="annot"><span class="annottext">TyConBinder -&gt; FV
</span><a href="#local-6989586621682565340"><span class="hs-identifier hs-var">injective_vars_of_binder</span></a></span><span> </span><span class="annot"><span class="annottext">[TyConBinder]
</span><a href="#local-6989586621682565331"><span class="hs-identifier hs-var">dropped_binders</span></a></span><span>
</span><span id="line-2922"></span><span>
</span><span id="line-2923"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#subVarSet"><span class="hs-identifier hs-var">subVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682565336"><span class="hs-identifier hs-var">result_vars</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682565337"><span class="hs-identifier hs-var">dropped_vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2924"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2925"></span><span>    </span><span id="local-6989586621682565330"><span class="annot"><span class="annottext">tc_binders :: [TyConBinder]
</span><a href="#local-6989586621682565330"><span class="hs-identifier hs-var hs-var">tc_binders</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [TyConBinder]
</span><a href="GHC.Core.TyCon.html#tyConBinders"><span class="hs-identifier hs-var">tyConBinders</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565327"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2926"></span><span>    </span><span id="local-6989586621682565335"><span class="annot"><span class="annottext">tc_res_kind :: Type
</span><a href="#local-6989586621682565335"><span class="hs-identifier hs-var hs-var">tc_res_kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#tyConResKind"><span class="hs-identifier hs-var">tyConResKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565327"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2927"></span><span>
</span><span id="line-2928"></span><span>    </span><span class="hs-comment">-- Returns the variables that would be fixed by knowing a TyConBinder. See</span><span>
</span><span id="line-2929"></span><span>    </span><span class="hs-comment">-- Note [When does a tycon application need an explicit kind signature?]</span><span>
</span><span id="line-2930"></span><span>    </span><span class="hs-comment">-- for a more detailed explanation of what this function does.</span><span>
</span><span id="line-2931"></span><span>    </span><span class="annot"><a href="#local-6989586621682565340"><span class="hs-identifier hs-type">injective_vars_of_binder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span>
</span><span id="line-2932"></span><span>    </span><span id="local-6989586621682565340"><span class="annot"><span class="annottext">injective_vars_of_binder :: TyConBinder -&gt; FV
</span><a href="#local-6989586621682565340"><span class="hs-identifier hs-var hs-var">injective_vars_of_binder</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682565343"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565343"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621682565344"><span class="annot"><span class="annottext">TyConBndrVis
</span><a href="#local-6989586621682565344"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2933"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyConBndrVis
</span><a href="#local-6989586621682565344"><span class="hs-identifier hs-var">vis</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2934"></span><span>        </span><span class="annot"><span class="annottext">TyConBndrVis
</span><a href="GHC.Core.TyCon.html#AnonTCB"><span class="hs-identifier hs-var">AnonTCB</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#injectiveVarsOfType"><span class="hs-identifier hs-var">injectiveVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-comment">-- conservative choice</span><span>
</span><span id="line-2935"></span><span>                                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565343"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2936"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCon.html#NamedTCB"><span class="hs-identifier hs-type">NamedTCB</span></a></span><span> </span><span id="local-6989586621682565346"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682565346"><span class="hs-identifier hs-var">argf</span></a></span></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; Bool
</span><a href="#local-6989586621682565347"><span class="hs-identifier hs-var">source_of_injectivity</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682565346"><span class="hs-identifier hs-var">argf</span></a></span><span>
</span><span id="line-2937"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; FV
</span><a href="GHC.Utils.FV.html#unitFV"><span class="hs-identifier hs-var">unitFV</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565343"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span>
</span><span id="line-2938"></span><span>                          </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#injectiveVarsOfType"><span class="hs-identifier hs-var">injectiveVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621682565343"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2939"></span><span>        </span><span class="annot"><span class="annottext">TyConBndrVis
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FV
</span><a href="GHC.Utils.FV.html#emptyFV"><span class="hs-identifier hs-var">emptyFV</span></a></span><span>
</span><span id="line-2940"></span><span>
</span><span id="line-2941"></span><span>    </span><span id="local-6989586621682565347"><span class="annot"><span class="annottext">source_of_injectivity :: ForAllTyFlag -&gt; Bool
</span><a href="#local-6989586621682565347"><span class="hs-identifier hs-var hs-var">source_of_injectivity</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="Language.Haskell.Syntax.Specificity.html#Required"><span class="hs-identifier hs-var">Required</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2942"></span><span>    </span><span class="annot"><a href="#local-6989586621682565347"><span class="hs-identifier hs-var">source_of_injectivity</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="Language.Haskell.Syntax.Specificity.html#Specified"><span class="hs-identifier hs-var">Specified</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682565326"><span class="hs-identifier hs-var">spec_inj_pos</span></a></span><span>
</span><span id="line-2943"></span><span>    </span><span class="annot"><a href="#local-6989586621682565347"><span class="hs-identifier hs-var">source_of_injectivity</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="Language.Haskell.Syntax.Specificity.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2944"></span><span>
</span><span id="line-2945"></span><span class="hs-comment">{-
Note [When does a tycon application need an explicit kind signature?]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
There are a couple of places in GHC where we convert Core Types into forms that
more closely resemble user-written syntax. These include:

1. Template Haskell Type reification (see, for instance, GHC.Tc.Gen.Splice.reify_tc_app)
2. Converting Types to LHsTypes (such as in Haddock.Convert in haddock)

This conversion presents a challenge: how do we ensure that the resulting type
has enough kind information so as not to be ambiguous? To better motivate this
question, consider the following Core type:

  -- Foo :: Type -&gt; Type
  type Foo = Proxy Type

There is nothing ambiguous about the RHS of Foo in Core. But if we were to,
say, reify it into a TH Type, then it's tempting to just drop the invisible
Type argument and simply return `Proxy`. But now we've lost crucial kind
information: we don't know if we're dealing with `Proxy Type` or `Proxy Bool`
or `Proxy Int` or something else! We've inadvertently introduced ambiguity.

Unlike in other situations in GHC, we can't just turn on
-fprint-explicit-kinds, as we need to produce something which has the same
structure as a source-syntax type. Moreover, we can't rely on visible kind
application, since the first kind argument to Proxy is inferred, not specified.
Our solution is to annotate certain tycons with their kinds whenever they
appear in applied form in order to resolve the ambiguity. For instance, we
would reify the RHS of Foo like so:

  type Foo = (Proxy :: Type -&gt; Type)

We need to devise an algorithm that determines precisely which tycons need
these explicit kind signatures. We certainly don't want to annotate _every_
tycon with a kind signature, or else we might end up with horribly bloated
types like the following:

  (Either :: Type -&gt; Type -&gt; Type) (Int :: Type) (Char :: Type)

We only want to annotate tycons that absolutely require kind signatures in
order to resolve some sort of ambiguity, and nothing more.

Suppose we have a tycon application (T ty_1 ... ty_n). Why might this type
require a kind signature? It might require it when we need to fill in any of
T's omitted arguments. By &quot;omitted argument&quot;, we mean one that is dropped when
reifying ty_1 ... ty_n. Sometimes, the omitted arguments are inferred and
specified arguments (e.g., TH reification in GHC.Tc.Gen.Splice), and sometimes the
omitted arguments are only the inferred ones (e.g., in situations where
specified arguments are reified through visible kind application).
Regardless, the key idea is that _some_ arguments are going to be omitted after
reification, and the only mechanism we have at our disposal for filling them in
is through explicit kind signatures.

What do we mean by &quot;fill in&quot;? Let's consider this small example:

  T :: forall {k}. Type -&gt; (k -&gt; Type) -&gt; k

Moreover, we have this application of T:

  T @{j} Int aty

When we reify this type, we omit the inferred argument @{j}. Is it fixed by the
other (non-inferred) arguments? Yes! If we know the kind of (aty :: blah), then
we'll generate an equality constraint (kappa -&gt; Type) and, assuming we can
solve it, that will fix `kappa`. (Here, `kappa` is the unification variable
that we instantiate `k` with.)

Therefore, for any application of a tycon T to some arguments, the Question We
Must Answer is:

* Given the first n arguments of T, do the kinds of the non-omitted arguments
  fill in the omitted arguments?

(This is still a bit hand-wavy, but we'll refine this question incrementally
as we explain more of the machinery underlying this process.)

Answering this question is precisely the role that the `injectiveVarsOfType`
and `injective_vars_of_binder` functions exist to serve. If an omitted argument
`a` appears in the set returned by `injectiveVarsOfType ty`, then knowing
`ty` determines (i.e., fills in) `a`. (More on `injective_vars_of_binder` in a
bit.)

More formally, if
`a` is in `injectiveVarsOfType ty`
and  S1(ty) ~ S2(ty),
then S1(a)  ~ S2(a),
where S1 and S2 are arbitrary substitutions.

For example, is `F` is a non-injective type family, then

  injectiveVarsOfType(Either c (Maybe (a, F b c))) = {a, c}

Now that we know what this function does, here is a second attempt at the
Question We Must Answer:

* Given the first n arguments of T (ty_1 ... ty_n), consider the binders
  of T that are instantiated by non-omitted arguments. Do the injective
  variables of these binders fill in the remainder of T's kind?

Alright, we're getting closer. Next, we need to clarify what the injective
variables of a tycon binder are. This the role that the
`injective_vars_of_binder` function serves. Here is what this function does for
each form of tycon binder:

* Anonymous binders are injective positions. For example, in the promoted data
  constructor '(:):

    '(:) :: forall a. a -&gt; [a] -&gt; [a]

  The second and third tyvar binders (of kinds `a` and `[a]`) are both
  anonymous, so if we had '(:) 'True '[], then the kinds of 'True and
  '[] would contribute to the kind of '(:) 'True '[]. Therefore,
  injective_vars_of_binder(_ :: a) = injectiveVarsOfType(a) = {a}.
  (Similarly, injective_vars_of_binder(_ :: [a]) = {a}.)
* Named binders:
  - Inferred binders are never injective positions. For example, in this data
    type:

      data Proxy a
      Proxy :: forall {k}. k -&gt; Type

    If we had Proxy 'True, then the kind of 'True would not contribute to the
    kind of Proxy 'True. Therefore,
    injective_vars_of_binder(forall {k}. ...) = {}.
  - Required binders are injective positions. For example, in this data type:

      data Wurble k (a :: k) :: k
      Wurble :: forall k -&gt; k -&gt; k

  The first tyvar binder (of kind `forall k`) has required visibility, so if
  we had Wurble (Maybe a) Nothing, then the kind of Maybe a would
  contribute to the kind of Wurble (Maybe a) Nothing. Hence,
  injective_vars_of_binder(forall a -&gt; ...) = {a}.
  - Specified binders /might/ be injective positions, depending on how you
    approach things. Continuing the '(:) example:

      '(:) :: forall a. a -&gt; [a] -&gt; [a]

    Normally, the (forall a. ...) tyvar binder wouldn't contribute to the kind
    of '(:) 'True '[], since it's not explicitly instantiated by the user. But
    if visible kind application is enabled, then this is possible, since the
    user can write '(:) @Bool 'True '[]. (In that case,
    injective_vars_of_binder(forall a. ...) = {a}.)

    There are some situations where using visible kind application is appropriate
    and others where it is not (e.g., TH
    reification), so the `injective_vars_of_binder` function is parameterized by
    a Bool which decides if specified binders should be counted towards
    injective positions or not.

Now that we've defined injective_vars_of_binder, we can refine the Question We
Must Answer once more:

* Given the first n arguments of T (ty_1 ... ty_n), consider the binders
  of T that are instantiated by non-omitted arguments. For each such binder
  b_i, take the union of all injective_vars_of_binder(b_i). Is this set a
  superset of the free variables of the remainder of T's kind?

If the answer to this question is &quot;no&quot;, then (T ty_1 ... ty_n) needs an
explicit kind signature, since T's kind has kind variables leftover that
aren't fixed by the non-omitted arguments.

One last sticking point: what does &quot;the remainder of T's kind&quot; mean? You might
be tempted to think that it corresponds to all of the arguments in the kind of
T that would normally be instantiated by omitted arguments. But this isn't
quite right, strictly speaking. Consider the following (silly) example:

  S :: forall {k}. Type -&gt; Type

And suppose we have this application of S:

  S Int Bool

The Int argument would be omitted, and
injective_vars_of_binder(_ :: Type) = {}. This is not a superset of {k}, which
might suggest that (S Bool) needs an explicit kind signature. But
(S Bool :: Type) doesn't actually fix `k`! This is because the kind signature
only affects the /result/ of the application, not all of the individual
arguments. So adding a kind signature here won't make a difference. Therefore,
the fourth (and final) iteration of the Question We Must Answer is:

* Given the first n arguments of T (ty_1 ... ty_n), consider the binders
  of T that are instantiated by non-omitted arguments. For each such binder
  b_i, take the union of all injective_vars_of_binder(b_i). Is this set a
  superset of the free variables of the kind of (T ty_1 ... ty_n)?

Phew, that was a lot of work!

How can be sure that this is correct? That is, how can we be sure that in the
event that we leave off a kind annotation, that one could infer the kind of the
tycon application from its arguments? It's essentially a proof by induction: if
we can infer the kinds of every subtree of a type, then the whole tycon
application will have an inferrable kind--unless, of course, the remainder of
the tycon application's kind has uninstantiated kind variables.

What happens if T is oversaturated? That is, if T's kind has fewer than n
arguments, in the case that the concrete application instantiates a result
kind variable with an arrow kind? If we run out of arguments, we do not attach
a kind annotation. This should be a rare case, indeed. Here is an example:

   data T1 :: k1 -&gt; k2 -&gt; *
   data T2 :: k1 -&gt; k2 -&gt; *

   type family G (a :: k) :: k
   type instance G T1 = T2

   type instance F Char = (G T1 Bool :: (* -&gt; *) -&gt; *)   -- F from above

Here G's kind is (forall k. k -&gt; k), and the desugared RHS of that last
instance of F is (G (* -&gt; (* -&gt; *) -&gt; *) (T1 * (* -&gt; *)) Bool). According to
the algorithm above, there are 3 arguments to G so we should peel off 3
arguments in G's kind. But G's kind has only two arguments. This is the
rare special case, and we choose not to annotate the application of G with
a kind signature. After all, we needn't do this, since that instance would
be reified as:

   type instance F Char = G (T1 :: * -&gt; (* -&gt; *) -&gt; *) Bool

So the kind of G isn't ambiguous anymore due to the explicit kind annotation
on its argument. See #8953 and test th/T8953.
-}</span><span>
</span><span id="line-3166"></span><span>
</span><span id="line-3167"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Multiplicities
*                                                                      *
************************************************************************

These functions would prefer to be in GHC.Core.Multiplicity, but
they some are used elsewhere in this module, and wanted to bring
their friends here with them.
-}</span><span>
</span><span id="line-3178"></span><span>
</span><span id="line-3179"></span><span id="local-6989586621682563187"><span class="annot"><a href="GHC.Core.Type.html#unrestricted"><span class="hs-identifier hs-type">unrestricted</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#linear"><span class="hs-identifier hs-type">linear</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tymult"><span class="hs-identifier hs-type">tymult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682563187"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682563187"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3180"></span><span>
</span><span id="line-3181"></span><span class="annot"><span class="hs-comment">-- | Scale a payload by Many</span></span><span>
</span><span id="line-3182"></span><span id="unrestricted"><span class="annot"><span class="annottext">unrestricted :: forall a. a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#unrestricted"><span class="hs-identifier hs-var hs-var">unrestricted</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; a -&gt; Scaled a
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span>
</span><span id="line-3183"></span><span>
</span><span id="line-3184"></span><span class="annot"><span class="hs-comment">-- | Scale a payload by One</span></span><span>
</span><span id="line-3185"></span><span id="linear"><span class="annot"><span class="annottext">linear :: forall a. a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#linear"><span class="hs-identifier hs-var hs-var">linear</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; a -&gt; Scaled a
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Core.Type.html#OneTy"><span class="hs-identifier hs-var">OneTy</span></a></span><span>
</span><span id="line-3186"></span><span>
</span><span id="line-3187"></span><span class="annot"><span class="hs-comment">-- | Scale a payload by Many; used for type arguments in core</span></span><span>
</span><span id="line-3188"></span><span id="tymult"><span class="annot"><span class="annottext">tymult :: forall a. a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#tymult"><span class="hs-identifier hs-var hs-var">tymult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; a -&gt; Scaled a
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span>
</span><span id="line-3189"></span><span>
</span><span id="line-3190"></span><span id="local-6989586621682563232"><span class="annot"><a href="GHC.Core.Type.html#irrelevantMult"><span class="hs-identifier hs-type">irrelevantMult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682563232"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563232"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3191"></span><span id="irrelevantMult"><span class="annot"><span class="annottext">irrelevantMult :: forall a. Scaled a -&gt; a
</span><a href="GHC.Core.Type.html#irrelevantMult"><span class="hs-identifier hs-var hs-var">irrelevantMult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scaled a -&gt; a
forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span>
</span><span id="line-3192"></span><span>
</span><span id="line-3193"></span><span id="local-6989586621682565352"><span class="annot"><a href="GHC.Core.Type.html#mkScaled"><span class="hs-identifier hs-type">mkScaled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682565352"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682565352"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3194"></span><span id="mkScaled"><span class="annot"><span class="annottext">mkScaled :: forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#mkScaled"><span class="hs-identifier hs-var hs-var">mkScaled</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; a -&gt; Scaled a
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span>
</span><span id="line-3195"></span><span>
</span><span id="line-3196"></span><span id="local-6989586621682563235"><span id="local-6989586621682563236"><span class="annot"><a href="GHC.Core.Type.html#scaledSet"><span class="hs-identifier hs-type">scaledSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682563235"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682563236"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682563236"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-3197"></span><span id="scaledSet"><span class="annot"><span class="annottext">scaledSet :: forall a b. Scaled a -&gt; b -&gt; Scaled b
</span><a href="GHC.Core.Type.html#scaledSet"><span class="hs-identifier hs-var hs-var">scaledSet</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span id="local-6989586621682565353"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565353"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682565354"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682565354"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; b -&gt; Scaled b
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565353"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682565354"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-3198"></span><span>
</span><span id="line-3199"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#OneTy"><span class="hs-identifier hs-type">OneTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span>
</span><span id="line-3200"></span><span class="hs-keyword">pattern</span><span> </span><span id="OneTy"><span id="%24mOneTy"><span id="%24bOneTy"><span class="annot"><span class="annottext">$mOneTy :: forall {r}. Type -&gt; ((# #) -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bOneTy :: Type
</span><a href="GHC.Core.Type.html#OneTy"><span class="hs-identifier hs-var hs-var hs-var">OneTy</span></a></span></span></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#isOneTy"><span class="hs-identifier hs-type">isOneTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-3201"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#OneTy"><span class="hs-identifier hs-var">OneTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#oneDataConTy"><span class="hs-identifier hs-var">oneDataConTy</span></a></span><span>
</span><span id="line-3202"></span><span>
</span><span id="line-3203"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-type">ManyTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span>
</span><span id="line-3204"></span><span class="hs-keyword">pattern</span><span> </span><span id="ManyTy"><span id="%24mManyTy"><span id="%24bManyTy"><span class="annot"><span class="annottext">$mManyTy :: forall {r}. Type -&gt; ((# #) -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bManyTy :: Type
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var hs-var hs-var">ManyTy</span></a></span></span></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#isManyTy"><span class="hs-identifier hs-type">isManyTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-3205"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#manyDataConTy"><span class="hs-identifier hs-var">manyDataConTy</span></a></span><span>
</span><span id="line-3206"></span><span>
</span><span id="line-3207"></span><span class="annot"><a href="GHC.Core.Type.html#isManyTy"><span class="hs-identifier hs-type">isManyTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-3208"></span><span id="isManyTy"><span class="annot"><span class="annottext">isManyTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isManyTy"><span class="hs-identifier hs-var hs-var">isManyTy</span></a></span></span><span> </span><span id="local-6989586621682565359"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565359"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-3209"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565360"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565360"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565359"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-3210"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565360"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#manyDataConKey"><span class="hs-identifier hs-var">manyDataConKey</span></a></span><span>
</span><span id="line-3211"></span><span class="annot"><a href="GHC.Core.Type.html#isManyTy"><span class="hs-identifier hs-var">isManyTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-3212"></span><span>
</span><span id="line-3213"></span><span class="annot"><a href="GHC.Core.Type.html#isOneTy"><span class="hs-identifier hs-type">isOneTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-3214"></span><span id="isOneTy"><span class="annot"><span class="annottext">isOneTy :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isOneTy"><span class="hs-identifier hs-var hs-var">isOneTy</span></a></span></span><span> </span><span id="local-6989586621682565362"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565362"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-3215"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565363"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565363"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565362"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-3216"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565363"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#oneDataConKey"><span class="hs-identifier hs-var">oneDataConKey</span></a></span><span>
</span><span id="line-3217"></span><span class="annot"><a href="GHC.Core.Type.html#isOneTy"><span class="hs-identifier hs-var">isOneTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-3218"></span><span>
</span><span id="line-3219"></span><span class="annot"><a href="GHC.Core.Type.html#isLinearType"><span class="hs-identifier hs-type">isLinearType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-3220"></span><span class="hs-comment">-- ^ @isLinear t@ returns @True@ of a if @t@ is a type of (curried) function</span><span>
</span><span id="line-3221"></span><span class="hs-comment">-- where at least one argument is linear (or otherwise non-unrestricted). We use</span><span>
</span><span id="line-3222"></span><span class="hs-comment">-- this function to check whether it is safe to eta reduce an Id in CorePrep. It</span><span>
</span><span id="line-3223"></span><span class="hs-comment">-- is always safe to return 'True', because 'True' deactivates the optimisation.</span><span>
</span><span id="line-3224"></span><span id="isLinearType"><span class="annot"><span class="annottext">isLinearType :: Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLinearType"><span class="hs-identifier hs-var hs-var">isLinearType</span></a></span></span><span> </span><span id="local-6989586621682565365"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565365"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565365"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3225"></span><span>                      </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682565366"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565366"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLinearType"><span class="hs-identifier hs-var">isLinearType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565366"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-3226"></span><span>                      </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3227"></span><span>                      </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682565367"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565367"><span class="hs-identifier hs-var">res</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLinearType"><span class="hs-identifier hs-var">isLinearType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565367"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-3228"></span><span>                      </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-3229"></span><span>
</span><span id="line-3230"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                    Space-saving construction
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-3235"></span><span>
</span><span id="line-3236"></span><span class="hs-comment">{- Note [Using synonyms to compress types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Was: [Prefer Type over TYPE (BoxedRep Lifted)]

The Core of nearly any program will have numerous occurrences of the Types

   TyConApp BoxedRep [TyConApp Lifted []]    -- Synonym LiftedRep
   TyConApp BoxedRep [TyConApp Unlifted []]  -- Synonym UnliftedREp
   TyConApp TYPE [TyConApp LiftedRep []]     -- Synonym Type
   TyConApp TYPE [TyConApp UnliftedRep []]   -- Synonym UnliftedType

While investigating #17292 we found that these constituted a majority
of all TyConApp constructors on the heap:

    (From a sample of 100000 TyConApp closures)
    0x45f3523    - 28732 - `Type`
    0x420b840702 - 9629  - generic type constructors
    0x42055b7e46 - 9596
    0x420559b582 - 9511
    0x420bb15a1e - 9509
    0x420b86c6ba - 9501
    0x42055bac1e - 9496
    0x45e68fd    - 538   - `TYPE ...`

Consequently, we try hard to ensure that operations on such types are
efficient. Specifically, we strive to

 a. Avoid heap allocation of such types; use a single static TyConApp
 b. Use a small (shallow in the tree-depth sense) representation
    for such types

Goal (b) is particularly useful as it makes traversals (e.g. free variable
traversal, substitution, and comparison) more efficient.
Comparison in particular takes special advantage of nullary type synonym
applications (e.g. things like @TyConApp typeTyCon []@). See
* Note [Comparing type synonyms] in &quot;GHC.Core.TyCo.Compare&quot;
* Note [Unifying type synonyms] in &quot;GHC.Core.Unify&quot;

To accomplish these we use a number of tricks, implemented by mkTyConApp.

 1. Instead of (TyConApp BoxedRep [TyConApp Lifted []]),
    we prefer a statically-allocated (TyConApp LiftedRep [])
    where `LiftedRep` is a type synonym:
       type LiftedRep = BoxedRep Lifted
    Similarly for UnliftedRep

 2. Instead of (TyConApp TYPE [TyConApp LiftedRep []])
    we prefer the statically-allocated (TyConApp Type [])
    where `Type` is a type synonym
       type Type = TYPE LiftedRep
    Similarly for UnliftedType

These serve goal (b) since there are no applied type arguments to traverse,
e.g., during comparison.

 3. We have a single, statically allocated top-level binding to
    represent `TyConApp GHC.Types.Type []` (namely
    'GHC.Builtin.Types.Prim.liftedTypeKind'), ensuring that we don't
    need to allocate such types (goal (a)).  See functions
    mkTYPEapp and mkBoxedRepApp

 4. We use the sharing mechanism described in Note [Sharing nullary TyConApps]
    in GHC.Core.TyCon to ensure that we never need to allocate such
    nullary applications (goal (a)).

See #17958, #20541
-}</span><span>
</span><span id="line-3303"></span><span>
</span><span id="line-3304"></span><span class="hs-comment">-- | A key function: builds a 'TyConApp' or 'FunTy' as appropriate to</span><span>
</span><span id="line-3305"></span><span class="hs-comment">-- its arguments.  Applies its arguments to the constructor from left to right.</span><span>
</span><span id="line-3306"></span><span class="annot"><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-type">mkTyConApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-3307"></span><span id="mkTyConApp"><span class="annot"><span class="annottext">mkTyConApp :: TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var hs-var">mkTyConApp</span></a></span></span><span> </span><span id="local-6989586621682565368"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565368"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-3308"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- See Note [Sharing nullary TyConApps] in GHC.Core.TyCon</span><span>
</span><span id="line-3309"></span><span>    </span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#mkTyConTy"><span class="hs-identifier hs-var">mkTyConTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565368"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-3310"></span><span>
</span><span id="line-3311"></span><span class="annot"><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span id="local-6989586621682565369"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565369"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span id="local-6989586621682565370"><span class="annot"><span class="annottext">tys :: [Type]
</span><a href="#local-6989586621682565370"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621682565371"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565371"><span class="hs-identifier hs-var">ty1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682565372"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565372"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3312"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565373"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565373"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; TyCon -&gt; [Type] -&gt; Maybe Type
TyCon -&gt; [Type] -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#tyConAppFunTy_maybe"><span class="hs-identifier hs-var">tyConAppFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565369"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565370"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-3313"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565373"><span class="hs-identifier hs-var">fun_ty</span></a></span><span>
</span><span id="line-3314"></span><span>
</span><span id="line-3315"></span><span>  </span><span class="hs-comment">-- See Note [Using synonyms to compress types]</span><span>
</span><span id="line-3316"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682565374"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#tYPETyConKey"><span class="hs-identifier hs-var">tYPETyConKey</span></a></span><span>
</span><span id="line-3317"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565375"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565375"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#mkTYPEapp_maybe"><span class="hs-identifier hs-var">mkTYPEapp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565371"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-3318"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; Type
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565372"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565375"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-3319"></span><span>
</span><span id="line-3320"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682565374"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#cONSTRAINTTyConKey"><span class="hs-identifier hs-var">cONSTRAINTTyConKey</span></a></span><span>
</span><span id="line-3321"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565376"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565376"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#mkCONSTRAINTapp_maybe"><span class="hs-identifier hs-var">mkCONSTRAINTapp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565371"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-3322"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; Type
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565372"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565376"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-3323"></span><span>
</span><span id="line-3324"></span><span>  </span><span class="hs-comment">-- See Note [Using synonyms to compress types]</span><span>
</span><span id="line-3325"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682565374"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#boxedRepDataConTyConKey"><span class="hs-identifier hs-var">boxedRepDataConTyConKey</span></a></span><span>
</span><span id="line-3326"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565378"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565378"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#mkBoxedRepApp_maybe"><span class="hs-identifier hs-var">mkBoxedRepApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565371"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-3327"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; Type
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565372"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565378"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-3328"></span><span>
</span><span id="line-3329"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682565374"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#tupleRepDataConTyConKey"><span class="hs-identifier hs-var">tupleRepDataConTyConKey</span></a></span><span>
</span><span id="line-3330"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565380"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565380"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#mkTupleRepApp_maybe"><span class="hs-identifier hs-var">mkTupleRepApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565371"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-3331"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; Type
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565372"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565380"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-3332"></span><span>
</span><span id="line-3333"></span><span>  </span><span class="hs-comment">-- The catch-all case</span><span>
</span><span id="line-3334"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-3335"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565369"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565370"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-3336"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3337"></span><span>    </span><span id="local-6989586621682565374"><span class="annot"><span class="annottext">key :: Unique
</span><a href="#local-6989586621682565374"><span class="hs-identifier hs-var hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique
</span><a href="GHC.Core.TyCon.html#tyConUnique"><span class="hs-identifier hs-var">tyConUnique</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565369"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-3338"></span><span>
</span><span id="line-3339"></span><span>
</span><span id="line-3340"></span><span class="hs-comment">{- Note [Care using synonyms to compress types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Using a synonym to compress a types has a tricky wrinkle. Consider
coreView applied to (TyConApp LiftedRep [])

* coreView expands the LiftedRep synonym:
     type LiftedRep = BoxedRep Lifted

* Danger: we might apply the empty substitution to the RHS of the
  synonym.  And substTy calls mkTyConApp BoxedRep [Lifted]. And
  mkTyConApp compresses that back to LiftedRep.  Loop!

* Solution: in expandSynTyConApp_maybe, don't call substTy for nullary
  type synonyms.  That's more efficient anyway.
-}</span><span>
</span><span id="line-3355"></span><span>
</span><span id="line-3356"></span><span>
</span><span id="line-3357"></span><span class="annot"><a href="GHC.Core.Type.html#mkTYPEapp"><span class="hs-identifier hs-type">mkTYPEapp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#RuntimeRepType"><span class="hs-identifier hs-type">RuntimeRepType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-3358"></span><span id="mkTYPEapp"><span class="annot"><span class="annottext">mkTYPEapp :: Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkTYPEapp"><span class="hs-identifier hs-var hs-var">mkTYPEapp</span></a></span></span><span> </span><span id="local-6989586621682565381"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565381"><span class="hs-identifier hs-var">rr</span></a></span></span><span>
</span><span id="line-3359"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#mkTYPEapp_maybe"><span class="hs-identifier hs-var">mkTYPEapp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565381"><span class="hs-identifier hs-var">rr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3360"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565382"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565382"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565382"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-3361"></span><span>       </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.Prim.html#tYPETyCon"><span class="hs-identifier hs-var">tYPETyCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565381"><span class="hs-identifier hs-var">rr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3362"></span><span>
</span><span id="line-3363"></span><span class="annot"><a href="GHC.Core.Type.html#mkTYPEapp_maybe"><span class="hs-identifier hs-type">mkTYPEapp_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#RuntimeRepType"><span class="hs-identifier hs-type">RuntimeRepType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-3364"></span><span class="hs-comment">-- ^ Given a @RuntimeRep@, applies @TYPE@ to it.</span><span>
</span><span id="line-3365"></span><span class="hs-comment">-- On the fly it rewrites</span><span>
</span><span id="line-3366"></span><span class="hs-comment">--      TYPE LiftedRep      --&gt;   liftedTypeKind    (a synonym)</span><span>
</span><span id="line-3367"></span><span class="hs-comment">--      TYPE UnliftedRep    --&gt;   unliftedTypeKind  (ditto)</span><span>
</span><span id="line-3368"></span><span class="hs-comment">--      TYPE ZeroBitRep     --&gt;   zeroBitTypeKind   (ditto)</span><span>
</span><span id="line-3369"></span><span class="hs-comment">-- NB: no need to check for TYPE (BoxedRep Lifted), TYPE (BoxedRep Unlifted)</span><span>
</span><span id="line-3370"></span><span class="hs-comment">--     because those inner types should already have been rewritten</span><span>
</span><span id="line-3371"></span><span class="hs-comment">--     to LiftedRep and UnliftedRep respectively, by mkTyConApp</span><span>
</span><span id="line-3372"></span><span class="hs-comment">--</span><span>
</span><span id="line-3373"></span><span class="hs-comment">-- see Note [TYPE and CONSTRAINT] in GHC.Builtin.Types.Prim.</span><span>
</span><span id="line-3374"></span><span class="hs-comment">-- See Note [Using synonyms to compress types] in GHC.Core.Type</span><span>
</span><span id="line-3375"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkTYPEapp_maybe"><span class="hs-pragma hs-type">mkTYPEapp_maybe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-3376"></span><span id="mkTYPEapp_maybe"><span class="annot"><span class="annottext">mkTYPEapp_maybe :: Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#mkTYPEapp_maybe"><span class="hs-identifier hs-var hs-var">mkTYPEapp_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682565384"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565384"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682565385"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565385"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3377"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682565386"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#liftedRepTyConKey"><span class="hs-identifier hs-var">liftedRepTyConKey</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Type -&gt; Maybe Type
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565385"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Type -&gt; Maybe Type) -&gt; Maybe Type -&gt; Maybe Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a></span><span>   </span><span class="hs-comment">-- TYPE LiftedRep</span><span>
</span><span id="line-3378"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682565386"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#unliftedRepTyConKey"><span class="hs-identifier hs-var">unliftedRepTyConKey</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Type -&gt; Maybe Type
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565385"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Type -&gt; Maybe Type) -&gt; Maybe Type -&gt; Maybe Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#unliftedTypeKind"><span class="hs-identifier hs-var">unliftedTypeKind</span></a></span><span> </span><span class="hs-comment">-- TYPE UnliftedRep</span><span>
</span><span id="line-3379"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682565386"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#zeroBitRepTyConKey"><span class="hs-identifier hs-var">zeroBitRepTyConKey</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Type -&gt; Maybe Type
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565385"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Type -&gt; Maybe Type) -&gt; Maybe Type -&gt; Maybe Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#zeroBitTypeKind"><span class="hs-identifier hs-var">zeroBitTypeKind</span></a></span><span>  </span><span class="hs-comment">-- TYPE ZeroBitRep</span><span>
</span><span id="line-3380"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3381"></span><span>    </span><span id="local-6989586621682565386"><span class="annot"><span class="annottext">key :: Unique
</span><a href="#local-6989586621682565386"><span class="hs-identifier hs-var hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique
</span><a href="GHC.Core.TyCon.html#tyConUnique"><span class="hs-identifier hs-var">tyConUnique</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565384"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-3382"></span><span class="annot"><a href="GHC.Core.Type.html#mkTYPEapp_maybe"><span class="hs-identifier hs-var">mkTYPEapp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3383"></span><span>
</span><span id="line-3384"></span><span class="hs-comment">------------------</span><span>
</span><span id="line-3385"></span><span class="annot"><a href="GHC.Core.Type.html#mkCONSTRAINTapp"><span class="hs-identifier hs-type">mkCONSTRAINTapp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#RuntimeRepType"><span class="hs-identifier hs-type">RuntimeRepType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-3386"></span><span class="annot"><span class="hs-comment">-- ^ Just like mkTYPEapp</span></span><span>
</span><span id="line-3387"></span><span id="mkCONSTRAINTapp"><span class="annot"><span class="annottext">mkCONSTRAINTapp :: Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkCONSTRAINTapp"><span class="hs-identifier hs-var hs-var">mkCONSTRAINTapp</span></a></span></span><span> </span><span id="local-6989586621682565389"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565389"><span class="hs-identifier hs-var">rr</span></a></span></span><span>
</span><span id="line-3388"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#mkCONSTRAINTapp_maybe"><span class="hs-identifier hs-var">mkCONSTRAINTapp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565389"><span class="hs-identifier hs-var">rr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3389"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682565390"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565390"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565390"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-3390"></span><span>       </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.Prim.html#cONSTRAINTTyCon"><span class="hs-identifier hs-var">cONSTRAINTTyCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565389"><span class="hs-identifier hs-var">rr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3391"></span><span>
</span><span id="line-3392"></span><span class="annot"><a href="GHC.Core.Type.html#mkCONSTRAINTapp_maybe"><span class="hs-identifier hs-type">mkCONSTRAINTapp_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#RuntimeRepType"><span class="hs-identifier hs-type">RuntimeRepType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-3393"></span><span class="annot"><span class="hs-comment">-- ^ Just like mkTYPEapp_maybe</span></span><span>
</span><span id="line-3394"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkCONSTRAINTapp_maybe"><span class="hs-pragma hs-type">mkCONSTRAINTapp_maybe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-3395"></span><span id="mkCONSTRAINTapp_maybe"><span class="annot"><span class="annottext">mkCONSTRAINTapp_maybe :: Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#mkCONSTRAINTapp_maybe"><span class="hs-identifier hs-var hs-var">mkCONSTRAINTapp_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682565392"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565392"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682565393"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565393"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3396"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565392"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#liftedRepTyConKey"><span class="hs-identifier hs-var">liftedRepTyConKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Type -&gt; Maybe Type
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565393"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Type -&gt; Maybe Type) -&gt; Maybe Type -&gt; Maybe Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-3397"></span><span>                                    </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#constraintKind"><span class="hs-identifier hs-var">constraintKind</span></a></span><span>   </span><span class="hs-comment">-- CONSTRAINT LiftedRep</span><span>
</span><span id="line-3398"></span><span class="annot"><a href="GHC.Core.Type.html#mkCONSTRAINTapp_maybe"><span class="hs-identifier hs-var">mkCONSTRAINTapp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3399"></span><span>
</span><span id="line-3400"></span><span class="hs-comment">------------------</span><span>
</span><span id="line-3401"></span><span class="annot"><a href="GHC.Core.Type.html#mkBoxedRepApp_maybe"><span class="hs-identifier hs-type">mkBoxedRepApp_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LevityType"><span class="hs-identifier hs-type">LevityType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-3402"></span><span class="hs-comment">-- ^ Given a `Levity`, apply `BoxedRep` to it</span><span>
</span><span id="line-3403"></span><span class="hs-comment">-- On the fly, rewrite</span><span>
</span><span id="line-3404"></span><span class="hs-comment">--      BoxedRep Lifted     --&gt;   liftedRepTy    (a synonym)</span><span>
</span><span id="line-3405"></span><span class="hs-comment">--      BoxedRep Unlifted   --&gt;   unliftedRepTy  (ditto)</span><span>
</span><span id="line-3406"></span><span class="hs-comment">-- See Note [TYPE and CONSTRAINT] in GHC.Builtin.Types.Prim.</span><span>
</span><span id="line-3407"></span><span class="hs-comment">-- See Note [Using synonyms to compress types] in GHC.Core.Type</span><span>
</span><span id="line-3408"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkBoxedRepApp_maybe"><span class="hs-pragma hs-type">mkBoxedRepApp_maybe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-3409"></span><span id="mkBoxedRepApp_maybe"><span class="annot"><span class="annottext">mkBoxedRepApp_maybe :: Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#mkBoxedRepApp_maybe"><span class="hs-identifier hs-var hs-var">mkBoxedRepApp_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682565395"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565395"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682565396"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565396"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3410"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682565397"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#liftedDataConKey"><span class="hs-identifier hs-var">liftedDataConKey</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Type -&gt; Maybe Type
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565396"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Type -&gt; Maybe Type) -&gt; Maybe Type -&gt; Maybe Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#liftedRepTy"><span class="hs-identifier hs-var">liftedRepTy</span></a></span><span>    </span><span class="hs-comment">-- BoxedRep Lifted</span><span>
</span><span id="line-3411"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682565397"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#unliftedDataConKey"><span class="hs-identifier hs-var">unliftedDataConKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Type -&gt; Maybe Type
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565396"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Type -&gt; Maybe Type) -&gt; Maybe Type -&gt; Maybe Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#unliftedRepTy"><span class="hs-identifier hs-var">unliftedRepTy</span></a></span><span>  </span><span class="hs-comment">-- BoxedRep Unlifted</span><span>
</span><span id="line-3412"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3413"></span><span>    </span><span id="local-6989586621682565397"><span class="annot"><span class="annottext">key :: Unique
</span><a href="#local-6989586621682565397"><span class="hs-identifier hs-var hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique
</span><a href="GHC.Core.TyCon.html#tyConUnique"><span class="hs-identifier hs-var">tyConUnique</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565395"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-3414"></span><span class="annot"><a href="GHC.Core.Type.html#mkBoxedRepApp_maybe"><span class="hs-identifier hs-var">mkBoxedRepApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3415"></span><span>
</span><span id="line-3416"></span><span class="annot"><a href="GHC.Core.Type.html#mkTupleRepApp_maybe"><span class="hs-identifier hs-type">mkTupleRepApp_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-3417"></span><span class="hs-comment">-- ^ Given a `[RuntimeRep]`, apply `TupleRep` to it</span><span>
</span><span id="line-3418"></span><span class="hs-comment">-- On the fly, rewrite</span><span>
</span><span id="line-3419"></span><span class="hs-comment">--      TupleRep [] -&gt; zeroBitRepTy   (a synonym)</span><span>
</span><span id="line-3420"></span><span class="hs-comment">-- See Note [TYPE and CONSTRAINT] in GHC.Builtin.Types.Prim.</span><span>
</span><span id="line-3421"></span><span class="hs-comment">-- See Note [Using synonyms to compress types] in GHC.Core.Type</span><span>
</span><span id="line-3422"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkTupleRepApp_maybe"><span class="hs-pragma hs-type">mkTupleRepApp_maybe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-3423"></span><span id="mkTupleRepApp_maybe"><span class="annot"><span class="annottext">mkTupleRepApp_maybe :: Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#mkTupleRepApp_maybe"><span class="hs-identifier hs-var hs-var">mkTupleRepApp_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682565398"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565398"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682565399"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565399"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3424"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682565400"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#nilDataConKey"><span class="hs-identifier hs-var">nilDataConKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Type -&gt; Maybe Type
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
</span><a href="GHC.Utils.Misc.html#isSingleton"><span class="hs-identifier hs-var">isSingleton</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682565399"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Type -&gt; Maybe Type) -&gt; Maybe Type -&gt; Maybe Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#zeroBitRepTy"><span class="hs-identifier hs-var">zeroBitRepTy</span></a></span><span>  </span><span class="hs-comment">-- ZeroBitRep</span><span>
</span><span id="line-3425"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3426"></span><span>    </span><span id="local-6989586621682565400"><span class="annot"><span class="annottext">key :: Unique
</span><a href="#local-6989586621682565400"><span class="hs-identifier hs-var hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique
</span><a href="GHC.Core.TyCon.html#tyConUnique"><span class="hs-identifier hs-var">tyConUnique</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682565398"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-3427"></span><span class="annot"><a href="GHC.Core.Type.html#mkTupleRepApp_maybe"><span class="hs-identifier hs-var">mkTupleRepApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3428"></span><span>
</span><span id="line-3429"></span><span class="annot"><a href="GHC.Core.Type.html#typeOrConstraintKind"><span class="hs-identifier hs-type">typeOrConstraintKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#TypeOrConstraint"><span class="hs-identifier hs-type">TypeOrConstraint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#RuntimeRepType"><span class="hs-identifier hs-type">RuntimeRepType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span>
</span><span id="line-3430"></span><span id="typeOrConstraintKind"><span class="annot"><span class="annottext">typeOrConstraintKind :: TypeOrConstraint -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeOrConstraintKind"><span class="hs-identifier hs-var hs-var">typeOrConstraintKind</span></a></span></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span>       </span><span id="local-6989586621682565403"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565403"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkTYPEapp"><span class="hs-identifier hs-var">mkTYPEapp</span></a></span><span>       </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565403"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-3431"></span><span class="annot"><a href="GHC.Core.Type.html#typeOrConstraintKind"><span class="hs-identifier hs-var">typeOrConstraintKind</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#ConstraintLike"><span class="hs-identifier hs-var">ConstraintLike</span></a></span><span> </span><span id="local-6989586621682565404"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565404"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkCONSTRAINTapp"><span class="hs-identifier hs-var">mkCONSTRAINTapp</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682565404"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-3432"></span></pre></body></html>