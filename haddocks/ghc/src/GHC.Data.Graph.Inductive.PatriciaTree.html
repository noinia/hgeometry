<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-comment">-- |An efficient implementation of 'Data.Graph.Inductive.Graph.Graph'</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- using big-endian patricia tree (i.e. &quot;Data.IntMap&quot;).</span><span>
</span><span id="line-4"></span><span class="hs-comment">--</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- This module provides the following specialised functions to gain</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- more performance, using GHC's RULES pragma:</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- * 'Data.Graph.Inductive.Graph.insNode'</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- * 'Data.Graph.Inductive.Graph.insEdge'</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- * 'Data.Graph.Inductive.Graph.gmap'</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- * 'Data.Graph.Inductive.Graph.nmap'</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- * 'Data.Graph.Inductive.Graph.emap'</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Code is from Hackage `fgl` package version 5.7.0.3</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html"><span class="hs-identifier">GHC.Data.Graph.Inductive.PatriciaTree</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier">Gr</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#UGr"><span class="hs-identifier">UGr</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.Graph.html"><span class="hs-identifier">GHC.Data.Graph.Inductive.Graph</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.html"><span class="hs-identifier">Data.IntMap</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier">IntMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.html"><span class="hs-identifier">Data.IntMap</span></a></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IM</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Tuple.html"><span class="hs-identifier">Data.Tuple</span></a></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">swap</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Strict.html"><span class="hs-identifier">Data.IntMap.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IMS</span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Generics.html"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Bifunctor.html"><span class="hs-identifier">Data.Bifunctor</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- GRAPH REPRESENTATION</span><span>
</span><span id="line-45"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">newtype</span><span> </span><span id="Gr"><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span></span><span> </span><span id="local-6989586621682468674"><span class="annot"><a href="#local-6989586621682468674"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621682468675"><span class="annot"><a href="#local-6989586621682468675"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Gr"><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468674"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468675"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682468847"><span id="local-6989586621682468849"><span class="annot"><span class="annottext">(forall x. Gr a b -&gt; Rep (Gr a b) x)
-&gt; (forall x. Rep (Gr a b) x -&gt; Gr a b) -&gt; Generic (Gr a b)
forall x. Rep (Gr a b) x -&gt; Gr a b
forall x. Gr a b -&gt; Rep (Gr a b) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a b x. Rep (Gr a b) x -&gt; Gr a b
forall a b x. Gr a b -&gt; Rep (Gr a b) x
$cfrom :: forall a b x. Gr a b -&gt; Rep (Gr a b) x
from :: forall x. Gr a b -&gt; Rep (Gr a b) x
$cto :: forall a b x. Rep (Gr a b) x -&gt; Gr a b
to :: forall x. Rep (Gr a b) x -&gt; Gr a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">type</span><span> </span><span id="GraphRep"><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-var">GraphRep</span></a></span></span><span> </span><span id="local-6989586621682468854"><span class="annot"><a href="#local-6989586621682468854"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621682468855"><span class="annot"><a href="#local-6989586621682468855"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468854"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468855"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">type</span><span> </span><span id="Context%27"><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-var">Context'</span></a></span></span><span> </span><span id="local-6989586621682468856"><span class="annot"><a href="#local-6989586621682468856"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621682468857"><span class="annot"><a href="#local-6989586621682468857"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682468857"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682468856"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682468857"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">type</span><span> </span><span id="UGr"><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#UGr"><span class="hs-identifier hs-var">UGr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- CLASS INSTANCES</span><span>
</span><span id="line-57"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682468592"><span id="local-6989586621682468593"><span id="local-6989586621682468862"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621682468592"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621682468593"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468592"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468593"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621682468887"><span class="annot"><span class="annottext">IntMap (IntMap [b], a, IntMap [b])
</span><a href="#local-6989586621682468887"><span class="hs-identifier hs-var">g1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682468888"><span class="annot"><span class="annottext">== :: Gr a b -&gt; Gr a b -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621682468889"><span class="annot"><span class="annottext">IntMap (IntMap [b], a, IntMap [b])
</span><a href="#local-6989586621682468889"><span class="hs-identifier hs-var">g2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b]))
-&gt; IntMap (IntMap [b], a, IntMap [b])
-&gt; IntMap (IntMap [b], a, IntMap [b])
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b])
forall {f :: * -&gt; *} {f :: * -&gt; *} {a} {a} {b}.
(Functor f, Functor f, Ord a, Ord a) =&gt;
(f [a], b, f [a]) -&gt; (f [a], b, f [a])
</span><a href="#local-6989586621682468890"><span class="hs-identifier hs-var">sortAdj</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (IntMap [b], a, IntMap [b])
</span><a href="#local-6989586621682468887"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (IntMap [b], a, IntMap [b])
-&gt; IntMap (IntMap [b], a, IntMap [b]) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">((IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b]))
-&gt; IntMap (IntMap [b], a, IntMap [b])
-&gt; IntMap (IntMap [b], a, IntMap [b])
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b])
forall {f :: * -&gt; *} {f :: * -&gt; *} {a} {a} {b}.
(Functor f, Functor f, Ord a, Ord a) =&gt;
(f [a], b, f [a]) -&gt; (f [a], b, f [a])
</span><a href="#local-6989586621682468890"><span class="hs-identifier hs-var">sortAdj</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (IntMap [b], a, IntMap [b])
</span><a href="#local-6989586621682468889"><span class="hs-identifier hs-var">g2</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span>      </span><span id="local-6989586621682468890"><span class="annot"><span class="annottext">sortAdj :: (f [a], b, f [a]) -&gt; (f [a], b, f [a])
</span><a href="#local-6989586621682468890"><span class="hs-identifier hs-var hs-var">sortAdj</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682468903"><span class="annot"><span class="annottext">f [a]
</span><a href="#local-6989586621682468903"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682468904"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682468904"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682468905"><span class="annot"><span class="annottext">f [a]
</span><a href="#local-6989586621682468905"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; f [a] -&gt; f [a]
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="annot"><span class="annottext">f [a]
</span><a href="#local-6989586621682468903"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682468904"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; f [a] -&gt; f [a]
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="annot"><span class="annottext">f [a]
</span><a href="#local-6989586621682468905"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682468613"><span id="local-6989586621682468614"><span id="local-6989586621682468910"><span id="local-6989586621682468914"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621682468613"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621682468614"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468613"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468614"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-65"></span><span>  </span><span id="local-6989586621682468933"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; Gr a b -&gt; ShowS
</span><a href="#local-6989586621682468933"><span class="hs-identifier hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621682468935"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682468935"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682468936"><span class="annot"><span class="annottext">Gr a b
</span><a href="#local-6989586621682468936"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ShowS -&gt; ShowS
</span><span class="hs-identifier hs-var">showParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682468935"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; ShowS) -&gt; ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-66"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkGraph &quot;</span></span><span>
</span><span id="line-67"></span><span>                    </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[LNode a] -&gt; ShowS
forall a. Show a =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">shows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gr a b -&gt; [LNode a]
forall a b. Gr a b -&gt; [LNode a]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LNode a]
</span><a href="GHC.Data.Graph.Inductive.Graph.html#labNodes"><span class="hs-identifier hs-var">labNodes</span></a></span><span> </span><span class="annot"><span class="annottext">Gr a b
</span><a href="#local-6989586621682468936"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>                    </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-69"></span><span>                    </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[LEdge b] -&gt; ShowS
forall a. Show a =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">shows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gr a b -&gt; [LEdge b]
forall a b. Gr a b -&gt; [LEdge b]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LEdge b]
</span><a href="GHC.Data.Graph.Inductive.Graph.html#labEdges"><span class="hs-identifier hs-var">labEdges</span></a></span><span> </span><span class="annot"><span class="annottext">Gr a b
</span><a href="#local-6989586621682468936"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682468643"><span id="local-6989586621682468644"><span id="local-6989586621682468948"><span id="local-6989586621682468952"><span id="local-6989586621682468955"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621682468643"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621682468644"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468643"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468644"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>  </span><span id="local-6989586621682468977"><span class="annot"><span class="annottext">readsPrec :: Int -&gt; ReadS (Gr a b)
</span><a href="#local-6989586621682468977"><span class="hs-identifier hs-var hs-var hs-var">readsPrec</span></a></span></span><span> </span><span id="local-6989586621682468979"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682468979"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ReadS (Gr a b) -&gt; ReadS (Gr a b)
forall a. Bool -&gt; ReadS a -&gt; ReadS a
</span><span class="hs-identifier hs-var">readParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682468979"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ReadS (Gr a b) -&gt; ReadS (Gr a b))
-&gt; ReadS (Gr a b) -&gt; ReadS (Gr a b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682468981"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682468981"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;mkGraph&quot;</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682468982"><span class="annot"><a href="#local-6989586621682468982"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadS String
</span><span class="hs-identifier hs-var">lex</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682468981"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682468984"><span class="annot"><a href="#local-6989586621682468984"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682468985"><span class="annot"><a href="#local-6989586621682468985"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">reads</span></span><span> </span><span class="annot"><a href="#local-6989586621682468982"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682468987"><span class="annot"><a href="#local-6989586621682468987"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682468988"><span class="annot"><a href="#local-6989586621682468988"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">reads</span></span><span> </span><span class="annot"><a href="#local-6989586621682468985"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.Graph.html#mkGraph"><span class="hs-identifier hs-type">mkGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468984"><span class="hs-identifier hs-type">ns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468987"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682468988"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682468996"><span class="annot"><a href="GHC.Data.Graph.Inductive.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621682469002"><span class="annot"><span class="annottext">empty :: forall a b. Gr a b
</span><a href="#local-6989586621682469002"><span class="hs-identifier hs-var hs-var hs-var">empty</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
forall a. IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#empty"><span class="hs-identifier hs-var">IM.empty</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621682469005"><span class="annot"><span class="annottext">isEmpty :: forall a b. Gr a b -&gt; Bool
</span><a href="#local-6989586621682469005"><span class="hs-identifier hs-var hs-var hs-var">isEmpty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621682469007"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469007"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Bool
forall a. IntMap a -&gt; Bool
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#null"><span class="hs-identifier hs-var">IM.null</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469007"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span>    </span><span id="local-6989586621682469009"><span class="annot"><span class="annottext">match :: forall a b. Int -&gt; Gr a b -&gt; Decomp Gr a b
</span><a href="#local-6989586621682469009"><span class="hs-identifier hs-var hs-var hs-var">match</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Gr a b -&gt; Decomp Gr a b
forall a b. Int -&gt; Gr a b -&gt; Decomp Gr a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#matchGr"><span class="hs-identifier hs-var">matchGr</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span>    </span><span id="local-6989586621682469016"><span class="annot"><span class="annottext">mkGraph :: forall a b. [LNode a] -&gt; [LEdge b] -&gt; Gr a b
</span><a href="GHC.Data.Graph.Inductive.Graph.html#mkGraph"><span class="hs-identifier hs-var hs-var hs-var">mkGraph</span></a></span></span><span> </span><span id="local-6989586621682469017"><span class="annot"><span class="annottext">[LNode a]
</span><a href="#local-6989586621682469017"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621682469018"><span class="annot"><span class="annottext">[LEdge b]
</span><a href="#local-6989586621682469018"><span class="hs-identifier hs-var">es</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LEdge b] -&gt; Gr a b -&gt; Gr a b
forall (gr :: * -&gt; * -&gt; *) b a.
DynGraph gr =&gt;
[LEdge b] -&gt; gr a b -&gt; gr a b
</span><a href="GHC.Data.Graph.Inductive.Graph.html#insEdges"><span class="hs-identifier hs-var">insEdges</span></a></span><span> </span><span class="annot"><span class="annottext">[LEdge b]
</span><a href="#local-6989586621682469018"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-86"></span><span>                      </span><span class="annot"><span class="annottext">(Gr a b -&gt; Gr a b) -&gt; ([LNode a] -&gt; Gr a b) -&gt; [LNode a] -&gt; Gr a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span>
</span><span id="line-87"></span><span>                      </span><span class="annot"><span class="annottext">(GraphRep a b -&gt; Gr a b)
-&gt; ([LNode a] -&gt; GraphRep a b) -&gt; [LNode a] -&gt; Gr a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Int, Context' a b)] -&gt; GraphRep a b
forall a. [(Int, a)] -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#fromList"><span class="hs-identifier hs-var">IM.fromList</span></a></span><span>
</span><span id="line-88"></span><span>                      </span><span class="annot"><span class="annottext">([(Int, Context' a b)] -&gt; GraphRep a b)
-&gt; ([LNode a] -&gt; [(Int, Context' a b)])
-&gt; [LNode a]
-&gt; GraphRep a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LNode a -&gt; (Int, Context' a b))
-&gt; [LNode a] -&gt; [(Int, Context' a b)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Context' a b) -&gt; LNode a -&gt; (Int, Context' a b)
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><a href="../../base-4.21.0.0-ae91/src/Data.Bifunctor.html#second"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682469022"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469022"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
forall a. IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#empty"><span class="hs-identifier hs-var">IM.empty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469022"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IntMap [b]
forall a. IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#empty"><span class="hs-identifier hs-var">IM.empty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>                      </span><span class="annot"><span class="annottext">([LNode a] -&gt; Gr a b) -&gt; [LNode a] -&gt; Gr a b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[LNode a]
</span><a href="#local-6989586621682469017"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>    </span><span id="local-6989586621682469023"><span class="annot"><span class="annottext">labNodes :: forall a b. Gr a b -&gt; [LNode a]
</span><a href="GHC.Data.Graph.Inductive.Graph.html#labNodes"><span class="hs-identifier hs-var hs-var hs-var">labNodes</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621682469024"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469024"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469025"><span class="hs-identifier hs-var">node</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469026"><span class="hs-keyword hs-var">label</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469025"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469025"><span class="hs-identifier hs-var">node</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469026"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469026"><span class="hs-keyword hs-var">label</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; [(Int, Context' a b)]
forall a. IntMap a -&gt; [(Int, a)]
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#toList"><span class="hs-identifier hs-var">IM.toList</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469024"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621682469028"><span class="annot"><span class="annottext">noNodes :: forall a b. Gr a b -&gt; Int
</span><a href="#local-6989586621682469028"><span class="hs-identifier hs-var hs-var hs-var">noNodes</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621682469030"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469030"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Int
forall a. IntMap a -&gt; Int
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#size"><span class="hs-identifier hs-var">IM.size</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469030"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>    </span><span id="local-6989586621682469036"><span class="annot"><span class="annottext">nodeRange :: forall a b. Gr a b -&gt; (Int, Int)
</span><a href="#local-6989586621682469036"><span class="hs-identifier hs-var hs-var hs-var">nodeRange</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621682469038"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469038"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Maybe (Int, Int) -&gt; (Int, Int)
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; (Int, Int)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nodeRange of empty graph&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>                       </span><span class="annot"><span class="annottext">(Maybe (Int, Int) -&gt; (Int, Int)) -&gt; Maybe (Int, Int) -&gt; (Int, Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; (Int, Int))
-&gt; Maybe Int -&gt; Maybe Int -&gt; Maybe (Int, Int)
forall a b c. (a -&gt; b -&gt; c) -&gt; Maybe a -&gt; Maybe b -&gt; Maybe c
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ((Int, Context' a b), GraphRep a b) -&gt; Maybe Int
forall {b} {b} {b}. Maybe ((b, b), b) -&gt; Maybe b
</span><a href="#local-6989586621682469041"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphRep a b -&gt; Maybe ((Int, Context' a b), GraphRep a b)
forall a. IntMap a -&gt; Maybe ((Int, a), IntMap a)
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#minViewWithKey"><span class="hs-identifier hs-var">IM.minViewWithKey</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469038"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ((Int, Context' a b), GraphRep a b) -&gt; Maybe Int
forall {b} {b} {b}. Maybe ((b, b), b) -&gt; Maybe b
</span><a href="#local-6989586621682469041"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphRep a b -&gt; Maybe ((Int, Context' a b), GraphRep a b)
forall a. IntMap a -&gt; Maybe ((Int, a), IntMap a)
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#maxViewWithKey"><span class="hs-identifier hs-var">IM.maxViewWithKey</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469038"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>        </span><span id="local-6989586621682469041"><span class="annot"><span class="annottext">ix :: Maybe ((b, b), b) -&gt; Maybe b
</span><a href="#local-6989586621682469041"><span class="hs-identifier hs-var hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((b, b), b) -&gt; b) -&gt; Maybe ((b, b), b) -&gt; Maybe b
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b, b) -&gt; b
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((b, b) -&gt; b) -&gt; (((b, b), b) -&gt; (b, b)) -&gt; ((b, b), b) -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((b, b), b) -&gt; (b, b)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621682469051"><span class="annot"><span class="annottext">labEdges :: forall a b. Gr a b -&gt; [LEdge b]
</span><a href="GHC.Data.Graph.Inductive.Graph.html#labEdges"><span class="hs-identifier hs-var hs-var hs-var">labEdges</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621682469052"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469052"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469053"><span class="annot"><a href="#local-6989586621682469053"><span class="hs-identifier hs-var">node</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469054"><span class="annot"><a href="#local-6989586621682469054"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; [(Int, Context' a b)]
forall a. IntMap a -&gt; [(Int, a)]
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#toList"><span class="hs-identifier hs-var">IM.toList</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469052"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-103"></span><span>                         </span><span class="hs-special">(</span><span id="local-6989586621682469055"><span class="annot"><a href="#local-6989586621682469055"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469056"><span class="annot"><a href="#local-6989586621682469056"><span class="hs-identifier hs-var">labels</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#toList"><span class="hs-identifier hs-type">IM.toList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469054"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-104"></span><span>                         </span><span id="local-6989586621682469057"><span class="annot"><a href="#local-6989586621682469057"><span class="hs-keyword hs-var">label</span></a></span></span><span>             </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682469056"><span class="hs-identifier hs-type">labels</span></a></span><span>
</span><span id="line-105"></span><span>                         </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682469053"><span class="hs-identifier hs-type">node</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682469055"><span class="hs-identifier hs-type">next</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682469057"><span class="hs-keyword hs-type">label</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.Graph.html#DynGraph"><span class="hs-identifier hs-type">DynGraph</span></a></span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682469062"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621682469062"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469063"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469063"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469064"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469064"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469065"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621682469065"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682469066"><span class="annot"><span class="annottext">&amp; :: forall a b. Context a b -&gt; Gr a b -&gt; Gr a b
</span><a href="#local-6989586621682469066"><span class="hs-operator hs-var hs-var hs-var">&amp;</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621682469068"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469068"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682469069"><span class="annot"><span class="annottext">g1 :: GraphRep a b
</span><a href="#local-6989586621682469069"><span class="hs-identifier hs-var hs-var">g1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (IntMap [b], a, IntMap [b]) -&gt; GraphRep a b -&gt; GraphRep a b
forall a. Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#insert"><span class="hs-identifier hs-var">IM.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469063"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469071"><span class="hs-identifier hs-var">preds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469064"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469072"><span class="hs-identifier hs-var">succs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469068"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-110"></span><span>              </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621682469073"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469073"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469071"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469071"><span class="hs-identifier hs-var">preds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Adj b -&gt; (Int, IntMap [b])
forall b. Adj b -&gt; (Int, IntMap [b])
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fromAdjCounting"><span class="hs-identifier hs-var">fromAdjCounting</span></a></span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621682469062"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-111"></span><span>              </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621682469075"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469075"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469072"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469072"><span class="hs-identifier hs-var">succs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Adj b -&gt; (Int, IntMap [b])
forall b. Adj b -&gt; (Int, IntMap [b])
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fromAdjCounting"><span class="hs-identifier hs-var">fromAdjCounting</span></a></span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621682469065"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-112"></span><span>              </span><span class="hs-glyph">!</span><span id="local-6989586621682469076"><span class="annot"><span class="annottext">g2 :: GraphRep a b
</span><a href="#local-6989586621682469076"><span class="hs-identifier hs-var hs-var">g2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Int -&gt; Int -&gt; IntMap [b] -&gt; GraphRep a b
forall a b.
GraphRep a b -&gt; Int -&gt; Int -&gt; IntMap [b] -&gt; GraphRep a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addSucc"><span class="hs-identifier hs-var">addSucc</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469069"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469063"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469073"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469071"><span class="hs-identifier hs-var">preds</span></a></span><span>
</span><span id="line-113"></span><span>              </span><span class="hs-glyph">!</span><span id="local-6989586621682469078"><span class="annot"><span class="annottext">g3 :: GraphRep a b
</span><a href="#local-6989586621682469078"><span class="hs-identifier hs-var hs-var">g3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Int -&gt; Int -&gt; IntMap [b] -&gt; GraphRep a b
forall a b.
GraphRep a b -&gt; Int -&gt; Int -&gt; IntMap [b] -&gt; GraphRep a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addPred"><span class="hs-identifier hs-var">addPred</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469076"><span class="hs-identifier hs-var">g2</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469063"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469075"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469072"><span class="hs-identifier hs-var">succs</span></a></span><span>
</span><span id="line-114"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469078"><span class="hs-identifier hs-var">g3</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682468737"><span id="local-6989586621682469082"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468737"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621682469086"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; Gr a a -&gt; Gr a b
</span><span class="hs-identifier hs-var hs-var hs-var">fmap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Gr a a -&gt; Gr a b
forall a a b. (a -&gt; b) -&gt; Gr a a -&gt; Gr a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fastEMap"><span class="hs-identifier hs-var">fastEMap</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Bifunctor.html#Bifunctor"><span class="hs-identifier hs-type">Bifunctor</span></a></span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621682469095"><span class="annot"><span class="annottext">bimap :: forall a b c d. (a -&gt; b) -&gt; (c -&gt; d) -&gt; Gr a c -&gt; Gr b d
</span><a href="#local-6989586621682469095"><span class="hs-identifier hs-var hs-var hs-var">bimap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (c -&gt; d) -&gt; Gr a c -&gt; Gr b d
forall a b c d. (a -&gt; c) -&gt; (b -&gt; d) -&gt; Gr a b -&gt; Gr c d
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fastNEMap"><span class="hs-identifier hs-var">fastNEMap</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621682469098"><span class="annot"><span class="annottext">first :: forall a b c. (a -&gt; b) -&gt; Gr a c -&gt; Gr b c
</span><a href="#local-6989586621682469098"><span class="hs-identifier hs-var hs-var hs-var">first</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Gr a c -&gt; Gr b c
forall a b c. (a -&gt; c) -&gt; Gr a b -&gt; Gr c b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fastNMap"><span class="hs-identifier hs-var">fastNMap</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621682469101"><span class="annot"><span class="annottext">second :: forall b c a. (b -&gt; c) -&gt; Gr a b -&gt; Gr a c
</span><a href="../../base-4.21.0.0-ae91/src/Data.Bifunctor.html#second"><span class="hs-identifier hs-var hs-var hs-var">second</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b -&gt; c) -&gt; Gr a b -&gt; Gr a c
forall a a b. (a -&gt; b) -&gt; Gr a a -&gt; Gr a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fastEMap"><span class="hs-identifier hs-var">fastEMap</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span id="local-6989586621682469102"><span id="local-6989586621682469103"><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#matchGr"><span class="hs-identifier hs-type">matchGr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469102"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469103"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.Graph.html#Decomp"><span class="hs-identifier hs-type">Decomp</span></a></span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469102"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469103"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-129"></span><span id="matchGr"><span class="annot"><span class="annottext">matchGr :: forall a b. Int -&gt; Gr a b -&gt; Decomp Gr a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#matchGr"><span class="hs-identifier hs-var hs-var">matchGr</span></a></span></span><span> </span><span id="local-6989586621682469105"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469105"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621682469106"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469106"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int -&gt; GraphRep a b -&gt; Maybe (Context' a b)
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#lookup"><span class="hs-identifier hs-var">IM.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469105"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469106"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-131"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Context' a b)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-132"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Context a b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469106"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469108"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469108"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469109"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469109"><span class="hs-keyword hs-var">label</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469110"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469110"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682469111"><span class="annot"><span class="annottext">g1 :: GraphRep a b
</span><a href="#local-6989586621682469111"><span class="hs-identifier hs-var hs-var">g1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; GraphRep a b -&gt; GraphRep a b
forall a. Int -&gt; IntMap a -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#delete"><span class="hs-identifier hs-var">IM.delete</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469105"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469106"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-136"></span><span>                   </span><span class="hs-glyph">!</span><span id="local-6989586621682469113"><span class="annot"><span class="annottext">p' :: IntMap [b]
</span><a href="#local-6989586621682469113"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap [b] -&gt; IntMap [b]
forall a. Int -&gt; IntMap a -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#delete"><span class="hs-identifier hs-var">IM.delete</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469105"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469108"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-137"></span><span>                   </span><span class="hs-glyph">!</span><span id="local-6989586621682469114"><span class="annot"><span class="annottext">s' :: IntMap [b]
</span><a href="#local-6989586621682469114"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap [b] -&gt; IntMap [b]
forall a. Int -&gt; IntMap a -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#delete"><span class="hs-identifier hs-var">IM.delete</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469105"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469110"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-138"></span><span>                   </span><span class="hs-glyph">!</span><span id="local-6989586621682469115"><span class="annot"><span class="annottext">g2 :: GraphRep a b
</span><a href="#local-6989586621682469115"><span class="hs-identifier hs-var hs-var">g2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Int -&gt; IntMap [b] -&gt; GraphRep a b
forall a b x. GraphRep a b -&gt; Int -&gt; IntMap x -&gt; GraphRep a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#clearPred"><span class="hs-identifier hs-var">clearPred</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469111"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469105"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469114"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-139"></span><span>                   </span><span class="hs-glyph">!</span><span id="local-6989586621682469117"><span class="annot"><span class="annottext">g3 :: GraphRep a b
</span><a href="#local-6989586621682469117"><span class="hs-identifier hs-var hs-var">g3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Int -&gt; IntMap [b] -&gt; GraphRep a b
forall a b x. GraphRep a b -&gt; Int -&gt; IntMap x -&gt; GraphRep a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#clearSucc"><span class="hs-identifier hs-var">clearSucc</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469115"><span class="hs-identifier hs-var">g2</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469105"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469113"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-140"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context a b -&gt; Maybe (Context a b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b] -&gt; Adj b
forall b. IntMap [b] -&gt; Adj b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#toAdj"><span class="hs-identifier hs-var">toAdj</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469113"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469105"><span class="hs-identifier hs-var">node</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469109"><span class="hs-keyword hs-var">label</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b] -&gt; Adj b
forall b. IntMap [b] -&gt; Adj b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#toAdj"><span class="hs-identifier hs-var">toAdj</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469110"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469117"><span class="hs-identifier hs-var">g3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- OVERRIDING FUNCTIONS</span><span>
</span><span id="line-144"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">{-

{- RULES
      &quot;insNode/Data.Graph.Inductive.PatriciaTree&quot;  insNode = fastInsNode
  -}
fastInsNode :: LNode a -&gt; Gr a b -&gt; Gr a b
fastInsNode (v, l) (Gr g) = g' `seq` Gr g'
  where
    g' = IM.insert v (IM.empty, l, IM.empty) g

-}</span><span>
</span><span id="line-157"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-158"></span><span>      </span><span class="annot"><span class="hs-pragma">&quot;insEdge/GHC.Data.Graph.Inductive.PatriciaTree&quot;</span></span><span>  </span><span class="annot"><a href="GHC.Data.Graph.Inductive.Graph.html#insEdge"><span class="hs-pragma hs-type">insEdge</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fastInsEdge"><span class="hs-pragma hs-type">fastInsEdge</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-160"></span><span id="local-6989586621682468773"><span id="local-6989586621682468774"><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fastInsEdge"><span class="hs-identifier hs-type">fastInsEdge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.Graph.html#LEdge"><span class="hs-identifier hs-type">LEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468773"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468774"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468773"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468774"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468773"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-161"></span><span id="fastInsEdge"><span class="annot"><span class="annottext">fastInsEdge :: forall b a. LEdge b -&gt; Gr a b -&gt; Gr a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fastInsEdge"><span class="hs-identifier hs-var hs-var">fastInsEdge</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469122"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469122"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469123"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469123"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469124"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682469124"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621682469125"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469125"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469126"><span class="hs-identifier hs-var">g2</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b -&gt; Gr a b
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469126"><span class="hs-identifier hs-var">g2</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>    </span><span id="local-6989586621682469127"><span class="annot"><span class="annottext">g1 :: GraphRep a b
</span><a href="#local-6989586621682469127"><span class="hs-identifier hs-var hs-var">g1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b]))
-&gt; Int -&gt; GraphRep a b -&gt; GraphRep a b
forall a. (a -&gt; a) -&gt; Int -&gt; IntMap a -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#adjust"><span class="hs-identifier hs-var">IM.adjust</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b])
</span><a href="#local-6989586621682469129"><span class="hs-identifier hs-var">addS'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469122"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469125"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621682469126"><span class="annot"><span class="annottext">g2 :: GraphRep a b
</span><a href="#local-6989586621682469126"><span class="hs-identifier hs-var hs-var">g2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b]))
-&gt; Int -&gt; GraphRep a b -&gt; GraphRep a b
forall a. (a -&gt; a) -&gt; Int -&gt; IntMap a -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#adjust"><span class="hs-identifier hs-var">IM.adjust</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b])
</span><a href="#local-6989586621682469130"><span class="hs-identifier hs-var">addP'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469123"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469127"><span class="hs-identifier hs-var">g1</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621682469129"><span class="annot"><span class="annottext">addS' :: (IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b])
</span><a href="#local-6989586621682469129"><span class="hs-identifier hs-var hs-var">addS'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469131"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469131"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469132"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469132"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469133"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469133"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469131"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469132"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [b] -&gt; [b]) -&gt; Int -&gt; [b] -&gt; IntMap [b] -&gt; IntMap [b]
forall a. (a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#insertWith"><span class="hs-identifier hs-var">IM.insertWith</span></a></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b] -&gt; [b]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469123"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682469124"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469133"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621682469130"><span class="annot"><span class="annottext">addP' :: (IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b])
</span><a href="#local-6989586621682469130"><span class="hs-identifier hs-var hs-var">addP'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469136"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469136"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469137"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469137"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469138"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469138"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([b] -&gt; [b] -&gt; [b]) -&gt; Int -&gt; [b] -&gt; IntMap [b] -&gt; IntMap [b]
forall a. (a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#insertWith"><span class="hs-identifier hs-var">IM.insertWith</span></a></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b] -&gt; [b]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469122"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682469124"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469136"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469137"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469138"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">{-

{- RULES
      &quot;gmap/Data.Graph.Inductive.PatriciaTree&quot;  gmap = fastGMap
  -}
fastGMap :: forall a b c d. (Context a b -&gt; Context c d) -&gt; Gr a b -&gt; Gr c d
fastGMap f (Gr g) = Gr (IM.mapWithKey f' g)
  where
    f' :: Node -&gt; Context' a b -&gt; Context' c d
    f' = ((fromContext . f) .) . toContext

{- RULES
      &quot;nmap/Data.Graph.Inductive.PatriciaTree&quot;  nmap = fastNMap
  -}
-}</span><span>
</span><span id="line-184"></span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fastNMap"><span class="hs-identifier hs-type">fastNMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682468759"><span class="annot"><a href="#local-6989586621682468759"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621682468761"><span class="annot"><a href="#local-6989586621682468761"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621682468760"><span class="annot"><a href="#local-6989586621682468760"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682468759"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682468760"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468759"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468761"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468760"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468761"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-185"></span><span id="fastNMap"><span class="annot"><span class="annottext">fastNMap :: forall a b c. (a -&gt; c) -&gt; Gr a b -&gt; Gr c b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fastNMap"><span class="hs-identifier hs-var hs-var">fastNMap</span></a></span></span><span> </span><span id="local-6989586621682469139"><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621682469139"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621682469140"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469140"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep c b -&gt; Gr c b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Context' a b -&gt; Context' c b) -&gt; GraphRep a b -&gt; GraphRep c b
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#map"><span class="hs-identifier hs-var">IM.map</span></a></span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; Context' c b
</span><a href="#local-6989586621682469142"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469140"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><a href="#local-6989586621682469142"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468759"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468761"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468760"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468761"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621682469142"><span class="annot"><span class="annottext">f' :: Context' a b -&gt; Context' c b
</span><a href="#local-6989586621682469142"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469143"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469143"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469144"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469144"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469145"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469145"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469143"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621682469139"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469144"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469145"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span class="hs-comment">{-

{- RULES
      &quot;emap/GHC.Data.Graph.Inductive.PatriciaTree&quot;  emap = fastEMap
   -}
-}</span><span>
</span><span id="line-195"></span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fastEMap"><span class="hs-identifier hs-type">fastEMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682469146"><span class="annot"><a href="#local-6989586621682469146"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621682469147"><span class="annot"><a href="#local-6989586621682469147"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621682469148"><span class="annot"><a href="#local-6989586621682469148"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682469147"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682469148"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469146"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469147"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469146"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469148"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-196"></span><span id="fastEMap"><span class="annot"><span class="annottext">fastEMap :: forall a a b. (a -&gt; b) -&gt; Gr a a -&gt; Gr a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fastEMap"><span class="hs-identifier hs-var hs-var">fastEMap</span></a></span></span><span> </span><span id="local-6989586621682469149"><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621682469149"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621682469150"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469150"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a c -&gt; Gr a c
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Context' a b -&gt; Context' a c) -&gt; GraphRep a b -&gt; GraphRep a c
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#map"><span class="hs-identifier hs-var">IM.map</span></a></span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; Context' a c
</span><a href="#local-6989586621682469151"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469150"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><a href="#local-6989586621682469151"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469146"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469147"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469146"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469148"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span id="local-6989586621682469151"><span class="annot"><span class="annottext">f' :: Context' a b -&gt; Context' a c
</span><a href="#local-6989586621682469151"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469152"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469152"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469153"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469153"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469154"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469154"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([b] -&gt; [c]) -&gt; IntMap [b] -&gt; IntMap [c]
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#map"><span class="hs-identifier hs-var">IM.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; c) -&gt; [b] -&gt; [c]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621682469149"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469152"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469153"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [c]) -&gt; IntMap [b] -&gt; IntMap [c]
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#map"><span class="hs-identifier hs-var">IM.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; c) -&gt; [b] -&gt; [c]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621682469149"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469154"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">{-  RULES
      &quot;nemap/GHC.Data.Graph.Inductive.PatriciaTree&quot;  nemap = fastNEMap
   -}</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fastNEMap"><span class="hs-identifier hs-type">fastNEMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682468752"><span class="annot"><a href="#local-6989586621682468752"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621682468754"><span class="annot"><a href="#local-6989586621682468754"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621682468753"><span class="annot"><a href="#local-6989586621682468753"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621682468755"><span class="annot"><a href="#local-6989586621682468755"><span class="hs-identifier hs-type">d</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682468752"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682468753"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682468754"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682468755"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468752"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468754"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468753"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468755"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-206"></span><span id="fastNEMap"><span class="annot"><span class="annottext">fastNEMap :: forall a b c d. (a -&gt; c) -&gt; (b -&gt; d) -&gt; Gr a b -&gt; Gr c d
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fastNEMap"><span class="hs-identifier hs-var hs-var">fastNEMap</span></a></span></span><span> </span><span id="local-6989586621682469155"><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621682469155"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621682469156"><span class="annot"><span class="annottext">b -&gt; d
</span><a href="#local-6989586621682469156"><span class="hs-identifier hs-var">fe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621682469157"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469157"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep c d -&gt; Gr c d
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Context' a b -&gt; Context' c d) -&gt; GraphRep a b -&gt; GraphRep c d
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#map"><span class="hs-identifier hs-var">IM.map</span></a></span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; Context' c d
</span><a href="#local-6989586621682469158"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469157"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><a href="#local-6989586621682469158"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468752"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468754"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468753"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468755"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span id="local-6989586621682469158"><span class="annot"><span class="annottext">f :: Context' a b -&gt; Context' c d
</span><a href="#local-6989586621682469158"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469159"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469159"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469160"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469160"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469161"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469161"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([b] -&gt; [d]) -&gt; IntMap [b] -&gt; IntMap [d]
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#map"><span class="hs-identifier hs-var">IM.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; d) -&gt; [b] -&gt; [d]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; d
</span><a href="#local-6989586621682469156"><span class="hs-identifier hs-var">fe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469159"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621682469155"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469160"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [d]) -&gt; IntMap [b] -&gt; IntMap [d]
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#map"><span class="hs-identifier hs-var">IM.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; d) -&gt; [b] -&gt; [d]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; d
</span><a href="#local-6989586621682469156"><span class="hs-identifier hs-var">fe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469161"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- UTILITIES</span><span>
</span><span id="line-215"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span id="local-6989586621682468772"><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#toAdj"><span class="hs-identifier hs-type">toAdj</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682468772"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.Graph.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468772"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-218"></span><span id="toAdj"><span class="annot"><span class="annottext">toAdj :: forall b. IntMap [b] -&gt; Adj b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#toAdj"><span class="hs-identifier hs-var hs-var">toAdj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, [b]) -&gt; [(b, Int)]) -&gt; [(Int, [b])] -&gt; [(b, Int)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">(Int, [b]) -&gt; [(b, Int)]
forall {b} {a}. (b, [a]) -&gt; [(a, b)]
</span><a href="#local-6989586621682469165"><span class="hs-identifier hs-var">expand</span></a></span><span> </span><span class="annot"><span class="annottext">([(Int, [b])] -&gt; [(b, Int)])
-&gt; (IntMap [b] -&gt; [(Int, [b])]) -&gt; IntMap [b] -&gt; [(b, Int)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IntMap [b] -&gt; [(Int, [b])]
forall a. IntMap a -&gt; [(Int, a)]
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#toList"><span class="hs-identifier hs-var">IM.toList</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621682469165"><span class="annot"><span class="annottext">expand :: (b, [a]) -&gt; [(a, b)]
</span><a href="#local-6989586621682469165"><span class="hs-identifier hs-var hs-var">expand</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469166"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682469166"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682469167"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682469167"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, b)) -&gt; [a] -&gt; [(a, b)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b -&gt; (a, b)) -&gt; b -&gt; a -&gt; (a, b)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682469166"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682469167"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-comment">--fromAdj :: Adj b -&gt; IntMap [b]</span><span>
</span><span id="line-223"></span><span class="hs-comment">--fromAdj = IM.fromListWith addLists . map (second (:[]) . swap)</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-keyword">data</span><span> </span><span id="FromListCounting"><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#FromListCounting"><span class="hs-identifier hs-var">FromListCounting</span></a></span></span><span> </span><span id="local-6989586621682468817"><span class="annot"><a href="#local-6989586621682468817"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FromListCounting"><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#FromListCounting"><span class="hs-identifier hs-var">FromListCounting</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468817"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469172"><span id="local-6989586621682469177"><span class="annot"><span class="annottext">FromListCounting a -&gt; FromListCounting a -&gt; Bool
(FromListCounting a -&gt; FromListCounting a -&gt; Bool)
-&gt; (FromListCounting a -&gt; FromListCounting a -&gt; Bool)
-&gt; Eq (FromListCounting a)
forall a. Eq a =&gt; FromListCounting a -&gt; FromListCounting a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a. Eq a =&gt; FromListCounting a -&gt; FromListCounting a -&gt; Bool
== :: FromListCounting a -&gt; FromListCounting a -&gt; Bool
$c/= :: forall a. Eq a =&gt; FromListCounting a -&gt; FromListCounting a -&gt; Bool
/= :: FromListCounting a -&gt; FromListCounting a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469182"><span id="local-6989586621682469188"><span id="local-6989586621682469192"><span class="annot"><span class="annottext">Int -&gt; FromListCounting a -&gt; ShowS
[FromListCounting a] -&gt; ShowS
FromListCounting a -&gt; String
(Int -&gt; FromListCounting a -&gt; ShowS)
-&gt; (FromListCounting a -&gt; String)
-&gt; ([FromListCounting a] -&gt; ShowS)
-&gt; Show (FromListCounting a)
forall a. Show a =&gt; Int -&gt; FromListCounting a -&gt; ShowS
forall a. Show a =&gt; [FromListCounting a] -&gt; ShowS
forall a. Show a =&gt; FromListCounting a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; FromListCounting a -&gt; ShowS
showsPrec :: Int -&gt; FromListCounting a -&gt; ShowS
$cshow :: forall a. Show a =&gt; FromListCounting a -&gt; String
show :: FromListCounting a -&gt; String
$cshowList :: forall a. Show a =&gt; [FromListCounting a] -&gt; ShowS
showList :: [FromListCounting a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469196"><span id="local-6989586621682469200"><span id="local-6989586621682469203"><span id="local-6989586621682469213"><span class="annot"><span class="annottext">ReadPrec [FromListCounting a]
ReadPrec (FromListCounting a)
Int -&gt; ReadS (FromListCounting a)
ReadS [FromListCounting a]
(Int -&gt; ReadS (FromListCounting a))
-&gt; ReadS [FromListCounting a]
-&gt; ReadPrec (FromListCounting a)
-&gt; ReadPrec [FromListCounting a]
-&gt; Read (FromListCounting a)
forall a. Read a =&gt; ReadPrec [FromListCounting a]
forall a. Read a =&gt; ReadPrec (FromListCounting a)
forall a. Read a =&gt; Int -&gt; ReadS (FromListCounting a)
forall a. Read a =&gt; ReadS [FromListCounting a]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: forall a. Read a =&gt; Int -&gt; ReadS (FromListCounting a)
readsPrec :: Int -&gt; ReadS (FromListCounting a)
$creadList :: forall a. Read a =&gt; ReadS [FromListCounting a]
readList :: ReadS [FromListCounting a]
$creadPrec :: forall a. Read a =&gt; ReadPrec (FromListCounting a)
readPrec :: ReadPrec (FromListCounting a)
$creadListPrec :: forall a. Read a =&gt; ReadPrec [FromListCounting a]
readListPrec :: ReadPrec [FromListCounting a]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span id="local-6989586621682468810"><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#getFromListCounting"><span class="hs-identifier hs-type">getFromListCounting</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#FromListCounting"><span class="hs-identifier hs-type">FromListCounting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468810"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468810"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-229"></span><span id="getFromListCounting"><span class="annot"><span class="annottext">getFromListCounting :: forall a. FromListCounting a -&gt; (Int, IntMap a)
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#getFromListCounting"><span class="hs-identifier hs-var hs-var">getFromListCounting</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#FromListCounting"><span class="hs-identifier hs-type">FromListCounting</span></a></span><span> </span><span id="local-6989586621682469219"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469219"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682469220"><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621682469220"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469219"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621682469220"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#getFromListCounting"><span class="hs-pragma hs-type">getFromListCounting</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span id="local-6989586621682468812"><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fromListWithKeyCounting"><span class="hs-identifier hs-type">fromListWithKeyCounting</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682468812"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682468812"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682468812"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682468812"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468812"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-233"></span><span id="fromListWithKeyCounting"><span class="annot"><span class="annottext">fromListWithKeyCounting :: forall a. (Int -&gt; a -&gt; a -&gt; a) -&gt; [(Int, a)] -&gt; (Int, IntMap a)
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fromListWithKeyCounting"><span class="hs-identifier hs-var hs-var">fromListWithKeyCounting</span></a></span></span><span> </span><span id="local-6989586621682469225"><span class="annot"><span class="annottext">Int -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621682469225"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FromListCounting a -&gt; (Int, IntMap a)
forall a. FromListCounting a -&gt; (Int, IntMap a)
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#getFromListCounting"><span class="hs-identifier hs-var">getFromListCounting</span></a></span><span> </span><span class="annot"><span class="annottext">(FromListCounting a -&gt; (Int, IntMap a))
-&gt; ([(Int, a)] -&gt; FromListCounting a)
-&gt; [(Int, a)]
-&gt; (Int, IntMap a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FromListCounting a -&gt; (Int, a) -&gt; FromListCounting a)
-&gt; FromListCounting a -&gt; [(Int, a)] -&gt; FromListCounting a
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">FromListCounting a -&gt; (Int, a) -&gt; FromListCounting a
</span><a href="#local-6989586621682469227"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IntMap a -&gt; FromListCounting a
forall a. Int -&gt; IntMap a -&gt; FromListCounting a
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#FromListCounting"><span class="hs-identifier hs-var">FromListCounting</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">IntMap a
forall a. IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#empty"><span class="hs-identifier hs-var">IM.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-235"></span><span>    </span><span id="local-6989586621682469227"><span class="annot"><span class="annottext">ins :: FromListCounting a -&gt; (Int, a) -&gt; FromListCounting a
</span><a href="#local-6989586621682469227"><span class="hs-identifier hs-var hs-var">ins</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#FromListCounting"><span class="hs-identifier hs-type">FromListCounting</span></a></span><span> </span><span id="local-6989586621682469228"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469228"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682469229"><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621682469229"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469230"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469230"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682469231"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469231"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap a -&gt; FromListCounting a
forall a. Int -&gt; IntMap a -&gt; FromListCounting a
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#FromListCounting"><span class="hs-identifier hs-var">FromListCounting</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469228"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
forall a. (Int -&gt; a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#insertWithKey"><span class="hs-identifier hs-var">IM.insertWithKey</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621682469225"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469230"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469231"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621682469229"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fromListWithKeyCounting"><span class="hs-pragma hs-type">fromListWithKeyCounting</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span id="local-6989586621682468819"><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fromListWithCounting"><span class="hs-identifier hs-type">fromListWithCounting</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682468819"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682468819"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682468819"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682468819"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468819"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-239"></span><span id="fromListWithCounting"><span class="annot"><span class="annottext">fromListWithCounting :: forall a. (a -&gt; a -&gt; a) -&gt; [(Int, a)] -&gt; (Int, IntMap a)
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fromListWithCounting"><span class="hs-identifier hs-var hs-var">fromListWithCounting</span></a></span></span><span> </span><span id="local-6989586621682469235"><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621682469235"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; a -&gt; a) -&gt; [(Int, a)] -&gt; (Int, IntMap a)
forall a. (Int -&gt; a -&gt; a -&gt; a) -&gt; [(Int, a)] -&gt; (Int, IntMap a)
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fromListWithKeyCounting"><span class="hs-identifier hs-var">fromListWithKeyCounting</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682469236"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469236"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682469237"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469237"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621682469235"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469236"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469237"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fromListWithCounting"><span class="hs-pragma hs-type">fromListWithCounting</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span id="local-6989586621682468731"><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fromAdjCounting"><span class="hs-identifier hs-type">fromAdjCounting</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.Graph.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468731"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682468731"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-243"></span><span id="fromAdjCounting"><span class="annot"><span class="annottext">fromAdjCounting :: forall b. Adj b -&gt; (Int, IntMap [b])
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fromAdjCounting"><span class="hs-identifier hs-var hs-var">fromAdjCounting</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [b] -&gt; [b]) -&gt; [(Int, [b])] -&gt; (Int, IntMap [b])
forall a. (a -&gt; a -&gt; a) -&gt; [(Int, a)] -&gt; (Int, IntMap a)
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#fromListWithCounting"><span class="hs-identifier hs-var">fromListWithCounting</span></a></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b] -&gt; [b]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span class="annot"><span class="annottext">([(Int, [b])] -&gt; (Int, IntMap [b]))
-&gt; (Adj b -&gt; [(Int, [b])]) -&gt; Adj b -&gt; (Int, IntMap [b])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((b, Int) -&gt; (Int, [b])) -&gt; Adj b -&gt; [(Int, [b])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; [b]) -&gt; (Int, b) -&gt; (Int, [b])
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><a href="../../base-4.21.0.0-ae91/src/Data.Bifunctor.html#second"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int, b) -&gt; (Int, [b]))
-&gt; ((b, Int) -&gt; (Int, b)) -&gt; (b, Int) -&gt; (Int, [b])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(b, Int) -&gt; (Int, b)
forall a b. (a, b) -&gt; (b, a)
</span><span class="hs-identifier hs-var">swap</span></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">-- We use differenceWith to modify a graph more than bulkThreshold times,</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- and repeated insertWith otherwise.</span><span>
</span><span id="line-247"></span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#bulkThreshold"><span class="hs-identifier hs-type">bulkThreshold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-248"></span><span id="bulkThreshold"><span class="annot"><span class="annottext">bulkThreshold :: Int
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#bulkThreshold"><span class="hs-identifier hs-var hs-var">bulkThreshold</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">--toContext :: Node -&gt; Context' a b -&gt; Context a b</span><span>
</span><span id="line-251"></span><span class="hs-comment">--toContext v (ps, a, ss) = (toAdj ps, v, a, toAdj ss)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">--fromContext :: Context a b -&gt; Context' a b</span><span>
</span><span id="line-254"></span><span class="hs-comment">--fromContext (ps, _, a, ss) = (fromAdj ps, a, fromAdj ss)</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">-- A version of @++@ where order isn't important, so @xs ++ [x]@</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- becomes @x:xs@.  Used when we have to have a function of type @[a]</span><span>
</span><span id="line-258"></span><span class="hs-comment">-- -&gt; [a] -&gt; [a]@ but one of the lists is just going to be a single</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- element (and it isn't possible to tell which).</span><span>
</span><span id="line-260"></span><span id="local-6989586621682468780"><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-type">addLists</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682468780"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682468780"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682468780"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-261"></span><span id="addLists"><span class="annot"><span class="annottext">addLists :: forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var hs-var">addLists</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682469240"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469240"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621682469241"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682469241"><span class="hs-keyword hs-var">as</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469240"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682469241"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-262"></span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span id="local-6989586621682469242"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682469242"><span class="hs-keyword hs-var">as</span></a></span></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621682469243"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469243"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469243"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682469242"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-263"></span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span id="local-6989586621682469244"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682469244"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span id="local-6989586621682469245"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682469245"><span class="hs-identifier hs-var">ys</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682469244"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682469245"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addSucc"><span class="hs-identifier hs-type">addSucc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682468732"><span class="annot"><a href="#local-6989586621682468732"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621682468733"><span class="annot"><a href="#local-6989586621682468733"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468732"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468733"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IM.IntMap</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682468733"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468732"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468733"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-266"></span><span id="addSucc"><span class="annot"><span class="annottext">addSucc :: forall a b.
GraphRep a b -&gt; Int -&gt; Int -&gt; IntMap [b] -&gt; GraphRep a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addSucc"><span class="hs-identifier hs-var hs-var">addSucc</span></a></span></span><span> </span><span id="local-6989586621682469247"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469247"><span class="hs-identifier hs-var">g0</span></a></span></span><span> </span><span id="local-6989586621682469248"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469248"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621682469249"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469249"><span class="hs-identifier hs-var">numAdd</span></a></span></span><span> </span><span id="local-6989586621682469250"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469250"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469249"><span class="hs-identifier hs-var">numAdd</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#bulkThreshold"><span class="hs-identifier hs-var">bulkThreshold</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GraphRep a b -&gt; Int -&gt; [b] -&gt; GraphRep a b)
-&gt; GraphRep a b -&gt; IntMap [b] -&gt; GraphRep a b
forall a b. (a -&gt; Int -&gt; b -&gt; a) -&gt; a -&gt; IntMap b -&gt; a
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#foldlWithKey%27"><span class="hs-identifier hs-var">foldlWithKey'</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Int -&gt; [b] -&gt; GraphRep a b
</span><a href="#local-6989586621682469253"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469247"><span class="hs-identifier hs-var">g0</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469250"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>    </span><span class="annot"><a href="#local-6989586621682469253"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468732"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468733"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682468733"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468732"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468733"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-270"></span><span>    </span><span id="local-6989586621682469253"><span class="annot"><span class="annottext">go :: GraphRep a b -&gt; Int -&gt; [b] -&gt; GraphRep a b
</span><a href="#local-6989586621682469253"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682469254"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469254"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621682469255"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469255"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621682469256"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621682469256"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Context' a b -&gt; Context' a b)
-&gt; Int -&gt; GraphRep a b -&gt; GraphRep a b
forall a. (a -&gt; a) -&gt; Int -&gt; IntMap a -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Strict.Internal.html#adjust"><span class="hs-identifier hs-var">IMS.adjust</span></a></span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; Context' a b
</span><a href="#local-6989586621682469258"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469255"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469254"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-271"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682469258"><span class="annot"><span class="annottext">f :: Context' a b -&gt; Context' a b
</span><a href="#local-6989586621682469258"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469259"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469259"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469260"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469260"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469261"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469261"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682469262"><span class="annot"><span class="annottext">ss' :: IntMap [b]
</span><a href="#local-6989586621682469262"><span class="hs-identifier hs-var hs-var">ss'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [b] -&gt; [b]) -&gt; Int -&gt; [b] -&gt; IntMap [b] -&gt; IntMap [b]
forall a. (a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#insertWith"><span class="hs-identifier hs-var">IM.insertWith</span></a></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b] -&gt; [b]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469248"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621682469256"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469261"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-272"></span><span>                             </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469259"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469260"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469262"><span class="hs-identifier hs-var">ss'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addSucc"><span class="hs-identifier hs-var">addSucc</span></a></span><span> </span><span id="local-6989586621682469263"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469263"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621682469264"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469264"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682469265"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469265"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Context' a b -&gt; [b] -&gt; Maybe (Context' a b))
-&gt; GraphRep a b -&gt; IntMap [b] -&gt; GraphRep a b
forall a b. (a -&gt; b -&gt; Maybe a) -&gt; IntMap a -&gt; IntMap b -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Strict.Internal.html#differenceWith"><span class="hs-identifier hs-var">IMS.differenceWith</span></a></span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; [b] -&gt; Maybe (Context' a b)
</span><a href="#local-6989586621682469267"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469263"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469265"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><a href="#local-6989586621682469267"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468732"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468733"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682468733"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468732"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468733"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621682469267"><span class="annot"><span class="annottext">go :: Context' a b -&gt; [b] -&gt; Maybe (Context' a b)
</span><a href="#local-6989586621682469267"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469268"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469268"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469269"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469269"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469270"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469270"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682469271"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621682469271"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682469272"><span class="annot"><span class="annottext">ss' :: IntMap [b]
</span><a href="#local-6989586621682469272"><span class="hs-identifier hs-var hs-var">ss'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [b] -&gt; [b]) -&gt; Int -&gt; [b] -&gt; IntMap [b] -&gt; IntMap [b]
forall a. (a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#insertWith"><span class="hs-identifier hs-var">IM.insertWith</span></a></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b] -&gt; [b]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469264"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621682469271"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469270"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-277"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; Maybe (Context' a b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469268"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469269"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469272"><span class="hs-identifier hs-var">ss'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span id="local-6989586621682468827"><span id="local-6989586621682468828"><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#foldlWithKey%27"><span class="hs-identifier hs-type">foldlWithKey'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682468827"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">IM.Key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682468828"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682468827"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682468827"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468828"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682468827"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-280"></span><span id="foldlWithKey%27"><span class="annot"><span class="annottext">foldlWithKey' :: forall a b. (a -&gt; Int -&gt; b -&gt; a) -&gt; a -&gt; IntMap b -&gt; a
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#foldlWithKey%27"><span class="hs-identifier hs-var hs-var">foldlWithKey'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-281"></span><span>  </span><span class="annot"><span class="annottext">(a -&gt; Int -&gt; b -&gt; a) -&gt; a -&gt; IntMap b -&gt; a
forall a b. (a -&gt; Int -&gt; b -&gt; a) -&gt; a -&gt; IntMap b -&gt; a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#foldlWithKey%27"><span class="hs-identifier hs-var">IM.foldlWithKey'</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addPred"><span class="hs-identifier hs-type">addPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682469275"><span class="annot"><a href="#local-6989586621682469275"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621682469276"><span class="annot"><a href="#local-6989586621682469276"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469275"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469276"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IM.IntMap</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682469276"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469275"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469276"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-284"></span><span id="addPred"><span class="annot"><span class="annottext">addPred :: forall a b.
GraphRep a b -&gt; Int -&gt; Int -&gt; IntMap [b] -&gt; GraphRep a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addPred"><span class="hs-identifier hs-var hs-var">addPred</span></a></span></span><span> </span><span id="local-6989586621682469278"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469278"><span class="hs-identifier hs-var">g0</span></a></span></span><span> </span><span id="local-6989586621682469279"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469279"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621682469280"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469280"><span class="hs-identifier hs-var">numAdd</span></a></span></span><span> </span><span id="local-6989586621682469281"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469281"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469280"><span class="hs-identifier hs-var">numAdd</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#bulkThreshold"><span class="hs-identifier hs-var">bulkThreshold</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GraphRep a b -&gt; Int -&gt; [b] -&gt; GraphRep a b)
-&gt; GraphRep a b -&gt; IntMap [b] -&gt; GraphRep a b
forall a b. (a -&gt; Int -&gt; b -&gt; a) -&gt; a -&gt; IntMap b -&gt; a
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#foldlWithKey%27"><span class="hs-identifier hs-var">foldlWithKey'</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Int -&gt; [b] -&gt; GraphRep a b
</span><a href="#local-6989586621682469282"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469278"><span class="hs-identifier hs-var">g0</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469281"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><a href="#local-6989586621682469282"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469275"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469276"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682469276"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469275"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469276"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-288"></span><span>    </span><span id="local-6989586621682469282"><span class="annot"><span class="annottext">go :: GraphRep a b -&gt; Int -&gt; [b] -&gt; GraphRep a b
</span><a href="#local-6989586621682469282"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682469283"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469283"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621682469284"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469284"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621682469285"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621682469285"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Context' a b -&gt; Context' a b)
-&gt; Int -&gt; GraphRep a b -&gt; GraphRep a b
forall a. (a -&gt; a) -&gt; Int -&gt; IntMap a -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Strict.Internal.html#adjust"><span class="hs-identifier hs-var">IMS.adjust</span></a></span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; Context' a b
</span><a href="#local-6989586621682469286"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469284"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469283"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-289"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682469286"><span class="annot"><span class="annottext">f :: Context' a b -&gt; Context' a b
</span><a href="#local-6989586621682469286"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469287"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469287"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469288"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469288"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469289"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469289"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682469290"><span class="annot"><span class="annottext">ps' :: IntMap [b]
</span><a href="#local-6989586621682469290"><span class="hs-identifier hs-var hs-var">ps'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [b] -&gt; [b]) -&gt; Int -&gt; [b] -&gt; IntMap [b] -&gt; IntMap [b]
forall a. (a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#insertWith"><span class="hs-identifier hs-var">IM.insertWith</span></a></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b] -&gt; [b]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469279"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621682469285"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469287"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-290"></span><span>                             </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469290"><span class="hs-identifier hs-var">ps'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469288"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469289"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addPred"><span class="hs-identifier hs-var">addPred</span></a></span><span> </span><span id="local-6989586621682469291"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469291"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621682469292"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469292"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682469293"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469293"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Context' a b -&gt; [b] -&gt; Maybe (Context' a b))
-&gt; GraphRep a b -&gt; IntMap [b] -&gt; GraphRep a b
forall a b. (a -&gt; b -&gt; Maybe a) -&gt; IntMap a -&gt; IntMap b -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Strict.Internal.html#differenceWith"><span class="hs-identifier hs-var">IMS.differenceWith</span></a></span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; [b] -&gt; Maybe (Context' a b)
</span><a href="#local-6989586621682469294"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469291"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469293"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><a href="#local-6989586621682469294"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469275"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469276"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682469276"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469275"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469276"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>    </span><span id="local-6989586621682469294"><span class="annot"><span class="annottext">go :: Context' a b -&gt; [b] -&gt; Maybe (Context' a b)
</span><a href="#local-6989586621682469294"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469295"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469295"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469296"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469296"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469297"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469297"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682469298"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621682469298"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682469299"><span class="annot"><span class="annottext">ps' :: IntMap [b]
</span><a href="#local-6989586621682469299"><span class="hs-identifier hs-var hs-var">ps'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [b] -&gt; [b]) -&gt; Int -&gt; [b] -&gt; IntMap [b] -&gt; IntMap [b]
forall a. (a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#insertWith"><span class="hs-identifier hs-var">IM.insertWith</span></a></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b] -&gt; [b]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469292"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621682469298"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469295"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-295"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; Maybe (Context' a b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469299"><span class="hs-identifier hs-var">ps'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469296"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469297"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#clearSucc"><span class="hs-identifier hs-type">clearSucc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682469300"><span class="annot"><a href="#local-6989586621682469300"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621682469301"><span class="annot"><a href="#local-6989586621682469301"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621682469302"><span class="annot"><a href="#local-6989586621682469302"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469300"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469301"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IM.IntMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469302"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469300"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469301"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-298"></span><span id="clearSucc"><span class="annot"><span class="annottext">clearSucc :: forall a b x. GraphRep a b -&gt; Int -&gt; IntMap x -&gt; GraphRep a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#clearSucc"><span class="hs-identifier hs-var hs-var">clearSucc</span></a></span></span><span> </span><span id="local-6989586621682469303"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469303"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621682469304"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469304"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Context' a b -&gt; x -&gt; Maybe (Context' a b))
-&gt; GraphRep a b -&gt; IntMap x -&gt; GraphRep a b
forall a b. (a -&gt; b -&gt; Maybe a) -&gt; IntMap a -&gt; IntMap b -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Strict.Internal.html#differenceWith"><span class="hs-identifier hs-var">IMS.differenceWith</span></a></span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; x -&gt; Maybe (Context' a b)
</span><a href="#local-6989586621682469305"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469303"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><a href="#local-6989586621682469305"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469300"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469301"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682469302"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469300"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682469301"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>    </span><span id="local-6989586621682469305"><span class="annot"><span class="annottext">go :: Context' a b -&gt; x -&gt; Maybe (Context' a b)
</span><a href="#local-6989586621682469305"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469306"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469306"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469307"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469307"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469308"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469308"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682469309"><span class="annot"><span class="annottext">ss' :: IntMap [b]
</span><a href="#local-6989586621682469309"><span class="hs-identifier hs-var hs-var">ss'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap [b] -&gt; IntMap [b]
forall a. Int -&gt; IntMap a -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#delete"><span class="hs-identifier hs-var">IM.delete</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469304"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469308"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-302"></span><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; Maybe (Context' a b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469306"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469307"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469309"><span class="hs-identifier hs-var">ss'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#clearPred"><span class="hs-identifier hs-type">clearPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682468769"><span class="annot"><a href="#local-6989586621682468769"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621682468770"><span class="annot"><a href="#local-6989586621682468770"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621682468771"><span class="annot"><a href="#local-6989586621682468771"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468769"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468770"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IM.IntMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468771"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468769"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468770"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-305"></span><span id="clearPred"><span class="annot"><span class="annottext">clearPred :: forall a b x. GraphRep a b -&gt; Int -&gt; IntMap x -&gt; GraphRep a b
</span><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#clearPred"><span class="hs-identifier hs-var hs-var">clearPred</span></a></span></span><span> </span><span id="local-6989586621682469310"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469310"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621682469311"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469311"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Context' a b -&gt; x -&gt; Maybe (Context' a b))
-&gt; GraphRep a b -&gt; IntMap x -&gt; GraphRep a b
forall a b. (a -&gt; b -&gt; Maybe a) -&gt; IntMap a -&gt; IntMap b -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Strict.Internal.html#differenceWith"><span class="hs-identifier hs-var">IMS.differenceWith</span></a></span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; x -&gt; Maybe (Context' a b)
</span><a href="#local-6989586621682469312"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621682469310"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><a href="#local-6989586621682469312"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468769"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468770"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682468771"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468769"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682468770"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>    </span><span id="local-6989586621682469312"><span class="annot"><span class="annottext">go :: Context' a b -&gt; x -&gt; Maybe (Context' a b)
</span><a href="#local-6989586621682469312"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682469313"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469313"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469314"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469314"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682469315"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469315"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682469316"><span class="annot"><span class="annottext">ps' :: IntMap [b]
</span><a href="#local-6989586621682469316"><span class="hs-identifier hs-var hs-var">ps'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap [b] -&gt; IntMap [b]
forall a. Int -&gt; IntMap a -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#delete"><span class="hs-identifier hs-var">IM.delete</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682469311"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469313"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-309"></span><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; Maybe (Context' a b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469316"><span class="hs-identifier hs-var">ps'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682469314"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621682469315"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">{-----------------------------------------------------------------

Copyright (c) 1999-2008, Martin Erwig
              2010, Ivan Lazar Miljenovic
              2022, Norman Ramsey
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice,
   this list of conditions and the following disclaimer.

2. Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in the
   documentation and/or other materials provided with the distribution.

3. Neither the name of the author nor the names of its contributors may be
   used to endorse or promote products derived from this software without
   specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.

----------------------------------------------------------------}</span><span>
</span><span id="line-345"></span></pre></body></html>