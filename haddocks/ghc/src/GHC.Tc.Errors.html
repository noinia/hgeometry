<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase          #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf          #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns      #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ParallelListComp    #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-uni-patterns   #-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html"><span class="hs-identifier">GHC.Tc.Errors</span></a></span><span class="hs-special">(</span><span>
</span><span id="line-12"></span><span>       </span><span class="annot"><a href="GHC.Tc.Errors.html#reportUnsolved"><span class="hs-identifier">reportUnsolved</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#reportAllUnsolved"><span class="hs-identifier">reportAllUnsolved</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#warnAllUnsolved"><span class="hs-identifier">warnAllUnsolved</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>       </span><span class="annot"><a href="GHC.Tc.Errors.html#warnDefaulting"><span class="hs-identifier">warnDefaulting</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span>       </span><span class="annot"><span class="hs-comment">-- * GHC API helper functions</span></span><span>
</span><span id="line-16"></span><span>       </span><span class="annot"><a href="GHC.Tc.Errors.html#solverReportMsg_ExpectedActuals"><span class="hs-identifier">solverReportMsg_ExpectedActuals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Ppr.html#mismatchMsg_ExpectedActuals"><span class="hs-identifier">mismatchMsg_ExpectedActuals</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Env.html"><span class="hs-identifier">GHC.Driver.Env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.Env.html#hsc_units"><span class="hs-identifier">hsc_units</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html"><span class="hs-identifier">GHC.Driver.DynFlags</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Ppr.html"><span class="hs-identifier">GHC.Driver.Ppr</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Config.Diagnostic.html"><span class="hs-identifier">GHC.Driver.Config.Diagnostic</span></a></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Unbound.html"><span class="hs-identifier">GHC.Rename.Unbound</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html"><span class="hs-identifier">GHC.Tc.Types</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html"><span class="hs-identifier">GHC.Tc.Utils.Monad</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html"><span class="hs-identifier">GHC.Tc.Errors.Types</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Ppr.html"><span class="hs-identifier">GHC.Tc.Errors.Ppr</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html"><span class="hs-identifier">GHC.Tc.Types.Constraint</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.CtLoc.html"><span class="hs-identifier">GHC.Tc.Types.CtLoc</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcMType.html"><span class="hs-identifier">GHC.Tc.Utils.TcMType</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Zonk.Type.html"><span class="hs-identifier">GHC.Tc.Zonk.Type</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html"><span class="hs-identifier">GHC.Tc.Utils.TcType</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Zonk.TcType.html"><span class="hs-identifier">GHC.Tc.Zonk.TcType</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html"><span class="hs-identifier">GHC.Tc.Types.Origin</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html"><span class="hs-identifier">GHC.Tc.Types.Evidence</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.EvTerm.html"><span class="hs-identifier">GHC.Tc.Types.EvTerm</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Instance.Family.html"><span class="hs-identifier">GHC.Tc.Instance.Family</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Instantiate.html"><span class="hs-identifier">GHC.Tc.Utils.Instantiate</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Hole.html"><span class="hs-identifier">GHC.Tc.Errors.Hole</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Hole.html#findValidHoleFits"><span class="hs-identifier">findValidHoleFits</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Hole.html#getHoleFitDispConfig"><span class="hs-identifier">getHoleFitDispConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Hole.html#pprHoleFit"><span class="hs-identifier">pprHoleFit</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html"><span class="hs-identifier">GHC.Types.Name.Reader</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.html"><span class="hs-identifier">GHC.Types.Id</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.html"><span class="hs-identifier">GHC.Types.Var</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html"><span class="hs-identifier">GHC.Types.Var.Set</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html"><span class="hs-identifier">GHC.Types.Var.Env</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html"><span class="hs-identifier">GHC.Types.Name.Env</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Error.html"><span class="hs-identifier">GHC.Types.Error</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Map.html"><span class="hs-identifier">GHC.Types.Unique.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UM</span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html"><span class="hs-identifier">GHC.Unit.Module</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.LanguageExtensions.html"><span class="hs-identifier">GHC.LanguageExtensions</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LangExt</span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html"><span class="hs-identifier">GHC.Core.Predicate</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html"><span class="hs-identifier">GHC.Core.Coercion</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html"><span class="hs-identifier">GHC.Core.TyCo.Ppr</span></a></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html#pprTyVars"><span class="hs-identifier">pprTyVars</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html"><span class="hs-identifier">GHC.Core.TyCo.Tidy</span></a></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyAvoiding"><span class="hs-identifier">tidyAvoiding</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.InstEnv.html"><span class="hs-identifier">GHC.Core.InstEnv</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html"><span class="hs-identifier">GHC.Core.DataCon</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html"><span class="hs-identifier">GHC.Utils.Error</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Error.html#diagReasonSeverity"><span class="hs-identifier">diagReasonSeverity</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><a href="GHC.Utils.Error.html#pprLocMsgEnvelope"><span class="hs-identifier">pprLocMsgEnvelope</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">O</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html"><span class="hs-identifier">GHC.Utils.FV</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#fvVarList"><span class="hs-identifier">fvVarList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#unionFV"><span class="hs-identifier">unionFV</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Bag.html"><span class="hs-identifier">GHC.Data.Bag</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.List.SetOps.html"><span class="hs-identifier">GHC.Data.List.SetOps</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Data.List.SetOps.html#equivClasses"><span class="hs-identifier">equivClasses</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.List.SetOps.html#nubOrdBy"><span class="hs-identifier">nubOrdBy</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html"><span class="hs-identifier">GHC.Data.Maybe</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="GHC.Data.Strict.html"><span class="hs-identifier">GHC.Data.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">forM_</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Foldable.html"><span class="hs-identifier">Data.Foldable</span></a></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">toList</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Function.html"><span class="hs-identifier">Data.Function</span></a></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">on</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">partition</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">union</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sortBy</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#nonEmpty"><span class="hs-identifier">nonEmpty</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Ord.html"><span class="hs-identifier">Data.Ord</span></a></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">comparing</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\section{Errors and contexts}
*                                                                      *
************************************************************************

ToDo: for these error messages, should we note the location as coming
from the insts, or just whatever seems to be around in the monad just
now?

Note [Deferring coercion errors to runtime]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
While developing, sometimes it is desirable to allow compilation to succeed even
if there are type errors in the code. Consider the following case:

  module Main where

  a :: Int
  a = 'a'

  main = print &quot;b&quot;

Even though `a` is ill-typed, it is not used in the end, so if all that we're
interested in is `main` it is handy to be able to ignore the problems in `a`.

Since we treat type equalities as evidence, this is relatively simple. Whenever
we run into a type mismatch in GHC.Tc.Utils.Unify, we normally just emit an error. But it
is always safe to defer the mismatch to the main constraint solver. If we do
that, `a` will get transformed into

  co :: Int ~ Char
  co = ...

  a :: Int
  a = 'a' `cast` co

The constraint solver would realize that `co` is an insoluble constraint, and
emit an error with `reportUnsolved`. But we can also replace the right-hand side
of `co` with `error &quot;Deferred type error: Int ~ Char&quot;`. This allows the program
to compile, and it will run fine unless we evaluate `a`. This is what
`deferErrorsToRuntime` does.

It does this by keeping track of which errors correspond to which coercion
in GHC.Tc.Errors. GHC.Tc.Errors.reportTidyWanteds does not print the errors
and does not fail if -fdefer-type-errors is on, so that we can continue
compilation. The errors are turned into warnings in `reportUnsolved`.
-}</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- | Report unsolved goals as errors or warnings. We may also turn some into</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- deferred run-time errors if `-fdefer-type-errors` is on.</span><span>
</span><span id="line-139"></span><span class="annot"><a href="GHC.Tc.Errors.html#reportUnsolved"><span class="hs-identifier hs-type">reportUnsolved</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span id="reportUnsolved"><span class="annot"><span class="annottext">reportUnsolved :: WantedConstraints -&gt; TcM (Bag EvBind)
</span><a href="GHC.Tc.Errors.html#reportUnsolved"><span class="hs-identifier hs-var hs-var">reportUnsolved</span></a></span></span><span> </span><span id="local-6989586621683031481"><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621683031481"><span class="hs-identifier hs-var">wanted</span></a></span></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683031482"><span class="annot"><a href="#local-6989586621683031482"><span class="hs-identifier hs-var">binds_var</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcM EvBindsVar
</span><a href="GHC.Tc.Utils.Monad.html#newTcEvBinds"><span class="hs-identifier hs-var">newTcEvBinds</span></a></span><span>
</span><span id="line-142"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683031484"><span class="annot"><a href="#local-6989586621683031484"><span class="hs-identifier hs-var">defer_errors</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#goptM"><span class="hs-identifier hs-type">goptM</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#Opt_DeferTypeErrors"><span class="hs-identifier hs-type">Opt_DeferTypeErrors</span></a></span><span>
</span><span id="line-143"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683031487"><span class="annot"><a href="#local-6989586621683031487"><span class="hs-identifier hs-var hs-var">type_errors</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683031484"><span class="hs-identifier hs-var">defer_errors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-var">ErrorWithoutFlag</span></a></span><span>
</span><span id="line-144"></span><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; DiagnosticReason
</span><a href="GHC.Types.Error.html#WarningWithFlag"><span class="hs-identifier hs-var">WarningWithFlag</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnDeferredTypeErrors"><span class="hs-identifier hs-var">Opt_WarnDeferredTypeErrors</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683031492"><span class="annot"><a href="#local-6989586621683031492"><span class="hs-identifier hs-var">defer_holes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#goptM"><span class="hs-identifier hs-type">goptM</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#Opt_DeferTypedHoles"><span class="hs-identifier hs-type">Opt_DeferTypedHoles</span></a></span><span>
</span><span id="line-147"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683031494"><span class="annot"><a href="#local-6989586621683031494"><span class="hs-identifier hs-var hs-var">expr_holes</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683031492"><span class="hs-identifier hs-var">defer_holes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-var">ErrorWithoutFlag</span></a></span><span>
</span><span id="line-148"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; DiagnosticReason
</span><a href="GHC.Types.Error.html#WarningWithFlag"><span class="hs-identifier hs-var">WarningWithFlag</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnTypedHoles"><span class="hs-identifier hs-var">Opt_WarnTypedHoles</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683031496"><span class="annot"><a href="#local-6989586621683031496"><span class="hs-identifier hs-var">partial_sigs</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-type">xoptM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LangExt.PartialTypeSignatures</span></span><span>
</span><span id="line-151"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683031499"><span class="annot"><a href="#local-6989586621683031499"><span class="hs-identifier hs-var hs-var">type_holes</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683031496"><span class="hs-identifier hs-var">partial_sigs</span></a></span><span>
</span><span id="line-152"></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-var">ErrorWithoutFlag</span></a></span><span>
</span><span id="line-153"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-154"></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; DiagnosticReason
</span><a href="GHC.Types.Error.html#WarningWithFlag"><span class="hs-identifier hs-var">WarningWithFlag</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnPartialTypeSignatures"><span class="hs-identifier hs-var">Opt_WarnPartialTypeSignatures</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683031501"><span class="annot"><a href="#local-6989586621683031501"><span class="hs-identifier hs-var">defer_out_of_scope</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#goptM"><span class="hs-identifier hs-type">goptM</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#Opt_DeferOutOfScopeVariables"><span class="hs-identifier hs-type">Opt_DeferOutOfScopeVariables</span></a></span><span>
</span><span id="line-157"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683031503"><span class="annot"><a href="#local-6989586621683031503"><span class="hs-identifier hs-var hs-var">out_of_scope_holes</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683031501"><span class="hs-identifier hs-var">defer_out_of_scope</span></a></span><span>
</span><span id="line-158"></span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-var">ErrorWithoutFlag</span></a></span><span>
</span><span id="line-159"></span><span>                                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-160"></span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; DiagnosticReason
</span><a href="GHC.Types.Error.html#WarningWithFlag"><span class="hs-identifier hs-var">WarningWithFlag</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnDeferredOutOfScopeVariables"><span class="hs-identifier hs-var">Opt_WarnDeferredOutOfScopeVariables</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#report_unsolved"><span class="hs-identifier hs-type">report_unsolved</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031487"><span class="hs-identifier hs-type">type_errors</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031494"><span class="hs-identifier hs-type">expr_holes</span></a></span><span>
</span><span id="line-163"></span><span>                         </span><span class="annot"><a href="#local-6989586621683031499"><span class="hs-identifier hs-type">type_holes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031503"><span class="hs-identifier hs-type">out_of_scope_holes</span></a></span><span>
</span><span id="line-164"></span><span>                         </span><span class="annot"><a href="#local-6989586621683031482"><span class="hs-identifier hs-type">binds_var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031481"><span class="hs-identifier hs-type">wanted</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683031506"><span class="annot"><a href="#local-6989586621683031506"><span class="hs-identifier hs-var">ev_binds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#getTcEvBindsMap"><span class="hs-identifier hs-type">getTcEvBindsMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031482"><span class="hs-identifier hs-type">binds_var</span></a></span><span>
</span><span id="line-167"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#evBindMapBinds"><span class="hs-identifier hs-type">evBindMapBinds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031506"><span class="hs-identifier hs-type">ev_binds</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">-- | Report *all* unsolved goals as errors, even if -fdefer-type-errors is on</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- However, do not make any evidence bindings, because we don't</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- have any convenient place to put them.</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- NB: Type-level holes are OK, because there are no bindings.</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- See Note [Deferring coercion errors to runtime]</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- Used by solveEqualities for kind equalities</span><span>
</span><span id="line-175"></span><span class="hs-comment">--      (see Note [Failure in local type signatures] in GHC.Tc.Solver)</span><span>
</span><span id="line-176"></span><span class="annot"><a href="GHC.Tc.Errors.html#reportAllUnsolved"><span class="hs-identifier hs-type">reportAllUnsolved</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span id="reportAllUnsolved"><span class="annot"><span class="annottext">reportAllUnsolved :: WantedConstraints -&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#reportAllUnsolved"><span class="hs-identifier hs-var hs-var">reportAllUnsolved</span></a></span></span><span> </span><span id="local-6989586621683031509"><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621683031509"><span class="hs-identifier hs-var">wanted</span></a></span></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683031510"><span class="annot"><a href="#local-6989586621683031510"><span class="hs-identifier hs-var">ev_binds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcM EvBindsVar
</span><a href="GHC.Tc.Utils.Monad.html#newNoTcEvBinds"><span class="hs-identifier hs-var">newNoTcEvBinds</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683031512"><span class="annot"><a href="#local-6989586621683031512"><span class="hs-identifier hs-var">partial_sigs</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-type">xoptM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LangExt.PartialTypeSignatures</span></span><span>
</span><span id="line-181"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683031513"><span class="annot"><a href="#local-6989586621683031513"><span class="hs-identifier hs-var hs-var">type_holes</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683031512"><span class="hs-identifier hs-var">partial_sigs</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-var">ErrorWithoutFlag</span></a></span><span>
</span><span id="line-182"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; DiagnosticReason
</span><a href="GHC.Types.Error.html#WarningWithFlag"><span class="hs-identifier hs-var">WarningWithFlag</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnPartialTypeSignatures"><span class="hs-identifier hs-var">Opt_WarnPartialTypeSignatures</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#report_unsolved"><span class="hs-identifier hs-type">report_unsolved</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-type">ErrorWithoutFlag</span></a></span><span>
</span><span id="line-185"></span><span>                         </span><span class="annot"><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-type">ErrorWithoutFlag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031513"><span class="hs-identifier hs-type">type_holes</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-type">ErrorWithoutFlag</span></a></span><span>
</span><span id="line-186"></span><span>                         </span><span class="annot"><a href="#local-6989586621683031510"><span class="hs-identifier hs-type">ev_binds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031509"><span class="hs-identifier hs-type">wanted</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-comment">-- | Report all unsolved goals as warnings (but without deferring any errors to</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- run-time). See Note [Safe Haskell Overlapping Instances Implementation] in</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- &quot;GHC.Tc.Solver&quot;</span><span>
</span><span id="line-191"></span><span class="annot"><a href="GHC.Tc.Errors.html#warnAllUnsolved"><span class="hs-identifier hs-type">warnAllUnsolved</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span id="warnAllUnsolved"><span class="annot"><span class="annottext">warnAllUnsolved :: WantedConstraints -&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#warnAllUnsolved"><span class="hs-identifier hs-var hs-var">warnAllUnsolved</span></a></span></span><span> </span><span id="local-6989586621683031514"><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621683031514"><span class="hs-identifier hs-var">wanted</span></a></span></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683031515"><span class="annot"><a href="#local-6989586621683031515"><span class="hs-identifier hs-var">ev_binds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcM EvBindsVar
</span><a href="GHC.Tc.Utils.Monad.html#newTcEvBinds"><span class="hs-identifier hs-var">newTcEvBinds</span></a></span><span>
</span><span id="line-194"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#report_unsolved"><span class="hs-identifier hs-type">report_unsolved</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Error.html#WarningWithoutFlag"><span class="hs-identifier hs-type">WarningWithoutFlag</span></a></span><span>
</span><span id="line-195"></span><span>                         </span><span class="annot"><a href="GHC.Types.Error.html#WarningWithoutFlag"><span class="hs-identifier hs-type">WarningWithoutFlag</span></a></span><span>
</span><span id="line-196"></span><span>                         </span><span class="annot"><a href="GHC.Types.Error.html#WarningWithoutFlag"><span class="hs-identifier hs-type">WarningWithoutFlag</span></a></span><span>
</span><span id="line-197"></span><span>                         </span><span class="annot"><a href="GHC.Types.Error.html#WarningWithoutFlag"><span class="hs-identifier hs-type">WarningWithoutFlag</span></a></span><span>
</span><span id="line-198"></span><span>                         </span><span class="annot"><a href="#local-6989586621683031515"><span class="hs-identifier hs-type">ev_binds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031514"><span class="hs-identifier hs-type">wanted</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="annot"><span class="hs-comment">-- | Report unsolved goals as errors or warnings.</span></span><span>
</span><span id="line-201"></span><span class="annot"><a href="GHC.Tc.Errors.html#report_unsolved"><span class="hs-identifier hs-type">report_unsolved</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#DiagnosticReason"><span class="hs-identifier hs-type">DiagnosticReason</span></a></span><span> </span><span class="hs-comment">-- Deferred type errors</span><span>
</span><span id="line-202"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#DiagnosticReason"><span class="hs-identifier hs-type">DiagnosticReason</span></a></span><span> </span><span class="hs-comment">-- Expression holes</span><span>
</span><span id="line-203"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#DiagnosticReason"><span class="hs-identifier hs-type">DiagnosticReason</span></a></span><span> </span><span class="hs-comment">-- Type holes</span><span>
</span><span id="line-204"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#DiagnosticReason"><span class="hs-identifier hs-type">DiagnosticReason</span></a></span><span> </span><span class="hs-comment">-- Out of scope holes</span><span>
</span><span id="line-205"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#EvBindsVar"><span class="hs-identifier hs-type">EvBindsVar</span></a></span><span>        </span><span class="hs-comment">-- cec_binds</span><span>
</span><span id="line-206"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span id="report_unsolved"><span class="annot"><span class="annottext">report_unsolved :: DiagnosticReason
-&gt; DiagnosticReason
-&gt; DiagnosticReason
-&gt; DiagnosticReason
-&gt; EvBindsVar
-&gt; WantedConstraints
-&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#report_unsolved"><span class="hs-identifier hs-var hs-var">report_unsolved</span></a></span></span><span> </span><span id="local-6989586621683031517"><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="#local-6989586621683031517"><span class="hs-identifier hs-var">type_errors</span></a></span></span><span> </span><span id="local-6989586621683031518"><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="#local-6989586621683031518"><span class="hs-identifier hs-var">expr_holes</span></a></span></span><span>
</span><span id="line-208"></span><span>    </span><span id="local-6989586621683031519"><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="#local-6989586621683031519"><span class="hs-identifier hs-var">type_holes</span></a></span></span><span> </span><span id="local-6989586621683031520"><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="#local-6989586621683031520"><span class="hs-identifier hs-var">out_of_scope_holes</span></a></span></span><span> </span><span id="local-6989586621683031521"><span class="annot"><span class="annottext">EvBindsVar
</span><a href="#local-6989586621683031521"><span class="hs-identifier hs-var">binds_var</span></a></span></span><span> </span><span id="local-6989586621683031522"><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621683031522"><span class="hs-identifier hs-var">wanted</span></a></span></span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">WantedConstraints -&gt; Bool
</span><a href="GHC.Tc.Types.Constraint.html#isEmptyWC"><span class="hs-identifier hs-var">isEmptyWC</span></a></span><span> </span><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621683031522"><span class="hs-identifier hs-var">wanted</span></a></span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcM ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;reportUnsolved {&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; TcM ()) -&gt; SDoc -&gt; TcM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-213"></span><span>         </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;type errors:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">DiagnosticReason -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="#local-6989586621683031517"><span class="hs-identifier hs-var">type_errors</span></a></span><span>
</span><span id="line-214"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expr holes:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">DiagnosticReason -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="#local-6989586621683031518"><span class="hs-identifier hs-var">expr_holes</span></a></span><span>
</span><span id="line-215"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;type holes:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">DiagnosticReason -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="#local-6989586621683031519"><span class="hs-identifier hs-var">type_holes</span></a></span><span>
</span><span id="line-216"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;scope holes:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">DiagnosticReason -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="#local-6989586621683031520"><span class="hs-identifier hs-var">out_of_scope_holes</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-217"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;reportUnsolved (before zonking and tidying)&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WantedConstraints -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621683031522"><span class="hs-identifier hs-var">wanted</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683031529"><span class="annot"><a href="#local-6989586621683031529"><span class="hs-identifier hs-var">wanted</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ZonkM WantedConstraints -&gt; TcM WantedConstraints
forall a. ZonkM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#liftZonkM"><span class="hs-identifier hs-var">liftZonkM</span></a></span><span> </span><span class="annot"><span class="annottext">(ZonkM WantedConstraints -&gt; TcM WantedConstraints)
-&gt; ZonkM WantedConstraints -&gt; TcM WantedConstraints
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WantedConstraints -&gt; ZonkM WantedConstraints
</span><a href="GHC.Tc.Zonk.TcType.html#zonkWC"><span class="hs-identifier hs-var">zonkWC</span></a></span><span> </span><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621683031522"><span class="hs-identifier hs-var">wanted</span></a></span><span>   </span><span class="hs-comment">-- Zonk to reveal all information</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683031532"><span class="annot"><a href="#local-6989586621683031532"><span class="hs-identifier hs-var hs-var">tidy_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OccName] -&gt; (TidyEnv -&gt; [TcId] -&gt; TidyEnv) -&gt; [TcId] -&gt; TidyEnv
forall a. [OccName] -&gt; (TidyEnv -&gt; a -&gt; TidyEnv) -&gt; a -&gt; TidyEnv
</span><a href="GHC.Core.TyCo.Tidy.html#tidyAvoiding"><span class="hs-identifier hs-var">tidyAvoiding</span></a></span><span> </span><span class="annot"><span class="annottext">[OccName]
</span><a href="#local-6989586621683031533"><span class="hs-identifier hs-var">bound_occs</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; [TcId] -&gt; TidyEnv
</span><a href="GHC.Core.TyCo.Tidy.html#tidyFreeTyCoVars"><span class="hs-identifier hs-var">tidyFreeTyCoVars</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031535"><span class="hs-identifier hs-var">free_tvs</span></a></span><span>
</span><span id="line-222"></span><span>                        </span><span class="hs-comment">-- See Note [tidyAvoiding] in GHC.Core.TyCo.Tidy</span><span>
</span><span id="line-223"></span><span>             </span><span id="local-6989586621683031535"><span class="annot"><a href="#local-6989586621683031535"><span class="hs-identifier hs-var hs-var">free_tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TcId -&gt; Bool) -&gt; [TcId] -&gt; [TcId]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="GHC.Utils.Misc.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a></span><span> </span><span class="annot"><span class="annottext">TcId -&gt; Bool
</span><a href="GHC.Types.Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">([TcId] -&gt; [TcId]) -&gt; [TcId] -&gt; [TcId]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-224"></span><span>                        </span><span class="annot"><span class="annottext">WantedConstraints -&gt; [TcId]
</span><a href="GHC.Tc.Types.Constraint.html#tyCoVarsOfWCList"><span class="hs-identifier hs-var">tyCoVarsOfWCList</span></a></span><span> </span><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621683031529"><span class="hs-identifier hs-var">wanted</span></a></span><span>
</span><span id="line-225"></span><span>                        </span><span class="hs-comment">-- tyCoVarsOfWC returns free coercion *holes*, even though</span><span>
</span><span id="line-226"></span><span>                        </span><span class="hs-comment">-- they are &quot;bound&quot; by other wanted constraints. They in</span><span>
</span><span id="line-227"></span><span>                        </span><span class="hs-comment">-- turn may mention variables bound further in, which makes</span><span>
</span><span id="line-228"></span><span>                        </span><span class="hs-comment">-- no sense. Really we should not return those holes at all;</span><span>
</span><span id="line-229"></span><span>                        </span><span class="hs-comment">-- for now we just filter them out.</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span>             </span><span class="annot"><a href="#local-6989586621683031533"><span class="hs-identifier hs-type">bound_occs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-232"></span><span>             </span><span id="local-6989586621683031533"><span class="annot"><a href="#local-6989586621683031533"><span class="hs-identifier hs-var hs-var">bound_occs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WantedConstraints -&gt; [OccName]
</span><a href="GHC.Tc.Types.Constraint.html#boundOccNamesOfWC"><span class="hs-identifier hs-var">boundOccNamesOfWC</span></a></span><span> </span><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621683031529"><span class="hs-identifier hs-var">wanted</span></a></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-type">traceTc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;reportUnsolved (after zonking):&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-235"></span><span>         </span><span class="annot"><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Free tyvars:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html#pprTyVars"><span class="hs-identifier hs-type">pprTyVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031535"><span class="hs-identifier hs-type">free_tvs</span></a></span><span>
</span><span id="line-236"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Bound occs:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031533"><span class="hs-identifier hs-type">bound_occs</span></a></span><span>
</span><span id="line-237"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Tidy env:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031532"><span class="hs-identifier hs-type">tidy_env</span></a></span><span>
</span><span id="line-238"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Wanted:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031529"><span class="hs-identifier hs-type">wanted</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683031540"><span class="annot"><a href="#local-6989586621683031540"><span class="hs-identifier hs-var">warn_redundant</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#woptM"><span class="hs-identifier hs-type">woptM</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#Opt_WarnRedundantConstraints"><span class="hs-identifier hs-type">Opt_WarnRedundantConstraints</span></a></span><span>
</span><span id="line-241"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683031543"><span class="annot"><a href="#local-6989586621683031543"><span class="hs-identifier hs-var">exp_syns</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#goptM"><span class="hs-identifier hs-type">goptM</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#Opt_PrintExpandedSynonyms"><span class="hs-identifier hs-type">Opt_PrintExpandedSynonyms</span></a></span><span>
</span><span id="line-242"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683031545"><span class="annot"><a href="#local-6989586621683031545"><span class="hs-identifier hs-var hs-var">err_ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#CEC"><span class="hs-identifier hs-type">CEC</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cec_encl :: [Implication]
</span><a href="GHC.Tc.Errors.Types.html#cec_encl"><span class="hs-identifier hs-var">cec_encl</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-243"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cec_tidy :: TidyEnv
</span><a href="GHC.Tc.Errors.Types.html#cec_tidy"><span class="hs-identifier hs-var">cec_tidy</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621683031532"><span class="hs-identifier hs-var">tidy_env</span></a></span><span>
</span><span id="line-244"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cec_defer_type_errors :: DiagnosticReason
</span><a href="GHC.Tc.Errors.Types.html#cec_defer_type_errors"><span class="hs-identifier hs-var">cec_defer_type_errors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="#local-6989586621683031517"><span class="hs-identifier hs-var">type_errors</span></a></span><span>
</span><span id="line-245"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cec_expr_holes :: DiagnosticReason
</span><a href="GHC.Tc.Errors.Types.html#cec_expr_holes"><span class="hs-identifier hs-var">cec_expr_holes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="#local-6989586621683031518"><span class="hs-identifier hs-var">expr_holes</span></a></span><span>
</span><span id="line-246"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cec_type_holes :: DiagnosticReason
</span><a href="GHC.Tc.Errors.Types.html#cec_type_holes"><span class="hs-identifier hs-var">cec_type_holes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="#local-6989586621683031519"><span class="hs-identifier hs-var">type_holes</span></a></span><span>
</span><span id="line-247"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cec_out_of_scope_holes :: DiagnosticReason
</span><a href="GHC.Tc.Errors.Types.html#cec_out_of_scope_holes"><span class="hs-identifier hs-var">cec_out_of_scope_holes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="#local-6989586621683031520"><span class="hs-identifier hs-var">out_of_scope_holes</span></a></span><span>
</span><span id="line-248"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cec_suppress :: Bool
</span><a href="GHC.Tc.Errors.Types.html#cec_suppress"><span class="hs-identifier hs-var">cec_suppress</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WantedConstraints -&gt; Bool
</span><a href="GHC.Tc.Types.Constraint.html#insolubleWC"><span class="hs-identifier hs-var">insolubleWC</span></a></span><span> </span><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621683031529"><span class="hs-identifier hs-var">wanted</span></a></span><span>
</span><span id="line-249"></span><span>                                 </span><span class="hs-comment">-- See Note [Suppressing error messages]</span><span>
</span><span id="line-250"></span><span>                                 </span><span class="hs-comment">-- Suppress low-priority errors if there</span><span>
</span><span id="line-251"></span><span>                                 </span><span class="hs-comment">-- are insoluble errors anywhere;</span><span>
</span><span id="line-252"></span><span>                                 </span><span class="hs-comment">-- See #15539 and c.f. setting ic_status</span><span>
</span><span id="line-253"></span><span>                                 </span><span class="hs-comment">-- in GHC.Tc.Solver.setImplicationStatus</span><span>
</span><span id="line-254"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cec_warn_redundant :: Bool
</span><a href="GHC.Tc.Errors.Types.html#cec_warn_redundant"><span class="hs-identifier hs-var">cec_warn_redundant</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683031540"><span class="hs-identifier hs-var">warn_redundant</span></a></span><span>
</span><span id="line-255"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cec_expand_syns :: Bool
</span><a href="GHC.Tc.Errors.Types.html#cec_expand_syns"><span class="hs-identifier hs-var">cec_expand_syns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683031543"><span class="hs-identifier hs-var">exp_syns</span></a></span><span>
</span><span id="line-256"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cec_binds :: EvBindsVar
</span><a href="GHC.Tc.Errors.Types.html#cec_binds"><span class="hs-identifier hs-var">cec_binds</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EvBindsVar
</span><a href="#local-6989586621683031521"><span class="hs-identifier hs-var">binds_var</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683031558"><span class="annot"><a href="#local-6989586621683031558"><span class="hs-identifier hs-var">tc_lvl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#getTcLevel"><span class="hs-identifier hs-type">getTcLevel</span></a></span><span>
</span><span id="line-259"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#reportWanteds"><span class="hs-identifier hs-type">reportWanteds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031545"><span class="hs-identifier hs-type">err_ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031558"><span class="hs-identifier hs-type">tc_lvl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031529"><span class="hs-identifier hs-type">wanted</span></a></span><span>
</span><span id="line-260"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-type">traceTc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;reportUnsolved }&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">--------------------------------------------</span><span>
</span><span id="line-263"></span><span class="hs-comment">--      Internal functions</span><span>
</span><span id="line-264"></span><span class="hs-comment">--------------------------------------------</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="annot"><span class="hs-comment">-- | Make a report from a single 'TcSolverReportMsg'.</span></span><span>
</span><span id="line-267"></span><span class="annot"><a href="GHC.Tc.Errors.html#important"><span class="hs-identifier hs-type">important</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcSolverReportMsg"><span class="hs-identifier hs-type">TcSolverReportMsg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span>
</span><span id="line-268"></span><span id="important"><span class="annot"><span class="annottext">important :: SolverReportErrCtxt -&gt; TcSolverReportMsg -&gt; SolverReport
</span><a href="GHC.Tc.Errors.html#important"><span class="hs-identifier hs-var hs-var">important</span></a></span></span><span> </span><span id="local-6989586621683031563"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031563"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683031564"><span class="annot"><span class="annottext">TcSolverReportMsg
</span><a href="#local-6989586621683031564"><span class="hs-identifier hs-var">doc</span></a></span></span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sr_important_msg :: SolverReportWithCtxt
</span><a href="GHC.Tc.Errors.Types.html#sr_important_msg"><span class="hs-identifier hs-var">sr_important_msg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TcSolverReportMsg -&gt; SolverReportWithCtxt
</span><a href="GHC.Tc.Errors.Types.html#SolverReportWithCtxt"><span class="hs-identifier hs-var">SolverReportWithCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031563"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">TcSolverReportMsg
</span><a href="#local-6989586621683031564"><span class="hs-identifier hs-var">doc</span></a></span><span>
</span><span id="line-270"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sr_supplementary :: [SolverReportSupplementary]
</span><a href="GHC.Tc.Errors.Types.html#sr_supplementary"><span class="hs-identifier hs-var">sr_supplementary</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="annot"><a href="GHC.Tc.Errors.html#add_relevant_bindings"><span class="hs-identifier hs-type">add_relevant_bindings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#RelevantBindings"><span class="hs-identifier hs-type">RelevantBindings</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span>
</span><span id="line-273"></span><span id="add_relevant_bindings"><span class="annot"><span class="annottext">add_relevant_bindings :: RelevantBindings -&gt; SolverReport -&gt; SolverReport
</span><a href="GHC.Tc.Errors.html#add_relevant_bindings"><span class="hs-identifier hs-var hs-var">add_relevant_bindings</span></a></span></span><span> </span><span id="local-6989586621683031570"><span class="annot"><span class="annottext">RelevantBindings
</span><a href="#local-6989586621683031570"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span id="local-6989586621683031571"><span class="annot"><span class="annottext">report :: SolverReport
</span><a href="#local-6989586621683031571"><span class="hs-identifier hs-var">report</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sr_supplementary :: SolverReport -&gt; [SolverReportSupplementary]
</span><a href="GHC.Tc.Errors.Types.html#sr_supplementary"><span class="hs-identifier hs-var">sr_supplementary</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031572"><span class="annot"><span class="annottext">[SolverReportSupplementary]
</span><a href="#local-6989586621683031572"><span class="hs-identifier hs-var">supp</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReport
</span><a href="#local-6989586621683031571"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#sr_supplementary"><span class="hs-identifier hs-var">sr_supplementary</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SupplementaryBindings"><span class="hs-identifier hs-type">SupplementaryBindings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031570"><span class="hs-identifier hs-type">binds</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621683031572"><span class="hs-identifier hs-type">supp</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="annot"><span class="hs-comment">-- | Returns True &lt;=&gt; the SolverReportErrCtxt indicates that something is deferred</span></span><span>
</span><span id="line-277"></span><span class="annot"><a href="GHC.Tc.Errors.html#deferringAnyBindings"><span class="hs-identifier hs-type">deferringAnyBindings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-comment">-- Don't check cec_type_holes, as these don't cause bindings to be deferred</span><span>
</span><span id="line-279"></span><span id="deferringAnyBindings"><span class="annot"><span class="annottext">deferringAnyBindings :: SolverReportErrCtxt -&gt; Bool
</span><a href="GHC.Tc.Errors.html#deferringAnyBindings"><span class="hs-identifier hs-var hs-var">deferringAnyBindings</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#CEC"><span class="hs-identifier hs-type">CEC</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cec_defer_type_errors :: SolverReportErrCtxt -&gt; DiagnosticReason
</span><a href="GHC.Tc.Errors.Types.html#cec_defer_type_errors"><span class="hs-identifier hs-var">cec_defer_type_errors</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-var">ErrorWithoutFlag</span></a></span><span>
</span><span id="line-280"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cec_expr_holes :: SolverReportErrCtxt -&gt; DiagnosticReason
</span><a href="GHC.Tc.Errors.Types.html#cec_expr_holes"><span class="hs-identifier hs-var">cec_expr_holes</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-var">ErrorWithoutFlag</span></a></span><span>
</span><span id="line-281"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cec_out_of_scope_holes :: SolverReportErrCtxt -&gt; DiagnosticReason
</span><a href="GHC.Tc.Errors.Types.html#cec_out_of_scope_holes"><span class="hs-identifier hs-var">cec_out_of_scope_holes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-var">ErrorWithoutFlag</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-282"></span><span class="annot"><a href="GHC.Tc.Errors.html#deferringAnyBindings"><span class="hs-identifier hs-var">deferringAnyBindings</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><span class="hs-identifier">_</span></span><span>                                                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="annot"><a href="GHC.Tc.Errors.html#maybeSwitchOffDefer"><span class="hs-identifier hs-type">maybeSwitchOffDefer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#EvBindsVar"><span class="hs-identifier hs-type">EvBindsVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- Switch off defer-type-errors inside CoEvBindsVar</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- See Note [Failing equalities with no evidence bindings]</span><span>
</span><span id="line-287"></span><span id="maybeSwitchOffDefer"><span class="annot"><span class="annottext">maybeSwitchOffDefer :: EvBindsVar -&gt; SolverReportErrCtxt -&gt; SolverReportErrCtxt
</span><a href="GHC.Tc.Errors.html#maybeSwitchOffDefer"><span class="hs-identifier hs-var hs-var">maybeSwitchOffDefer</span></a></span></span><span> </span><span id="local-6989586621683031576"><span class="annot"><span class="annottext">EvBindsVar
</span><a href="#local-6989586621683031576"><span class="hs-identifier hs-var">evb</span></a></span></span><span> </span><span id="local-6989586621683031577"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031577"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>
</span><span id="line-288"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#CoEvBindsVar"><span class="hs-identifier hs-type">CoEvBindsVar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EvBindsVar
</span><a href="#local-6989586621683031576"><span class="hs-identifier hs-var">evb</span></a></span><span>
</span><span id="line-289"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031577"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_defer_type_errors"><span class="hs-identifier hs-var">cec_defer_type_errors</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-type">ErrorWithoutFlag</span></a></span><span>
</span><span id="line-290"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_expr_holes"><span class="hs-identifier hs-var">cec_expr_holes</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-type">ErrorWithoutFlag</span></a></span><span>
</span><span id="line-291"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_out_of_scope_holes"><span class="hs-identifier hs-var">cec_out_of_scope_holes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-type">ErrorWithoutFlag</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-292"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-293"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031577"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">{- Note [Failing equalities with no evidence bindings]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
If we go inside an implication that has no term evidence
(e.g. unifying under a forall), we can't defer type errors.  You could
imagine using the /enclosing/ bindings (in cec_binds), but that may
not have enough stuff in scope for the bindings to be well typed.  So
we just switch off deferred type errors altogether.  See #14605.

This is done by maybeSwitchOffDefer.  It's also useful in one other
place: see Note [Wrapping failing kind equalities] in GHC.Tc.Solver.

Note [Suppressing error messages]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The cec_suppress flag says &quot;don't report any errors&quot;.  Instead, just create
evidence bindings (as usual).  It's used when more important errors have occurred.

Specifically (see reportWanteds)
  * If there are insoluble Givens, then we are in unreachable code and all bets
    are off.  So don't report any further errors.
  * If there are any insolubles (eg Int~Bool), here or in a nested implication,
    then suppress errors from the simple constraints here.  Sometimes the
    simple-constraint errors are a knock-on effect of the insolubles.

This suppression behaviour is controlled by the Bool flag in
ReportErrorSpec, as used in reportWanteds.

But we need to take care: flags can turn errors into warnings, and we
don't want those warnings to suppress subsequent errors (including
suppressing the essential addTcEvBind for them: #15152). So in
tryReporter we use askNoErrs to see if any error messages were
/actually/ produced; if not, we don't switch on suppression.

A consequence is that warnings never suppress warnings, so turning an
error into a warning may allow subsequent warnings to appear that were
previously suppressed.   (e.g. partial-sigs/should_fail/T14584)
-}</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="annot"><a href="GHC.Tc.Errors.html#reportImplic"><span class="hs-identifier hs-type">reportImplic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Implication"><span class="hs-identifier hs-type">Implication</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span id="reportImplic"><span class="annot"><span class="annottext">reportImplic :: SolverReportErrCtxt -&gt; Implication -&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#reportImplic"><span class="hs-identifier hs-var hs-var">reportImplic</span></a></span></span><span> </span><span id="local-6989586621683031580"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031580"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683031581"><span class="annot"><span class="annottext">implic :: Implication
</span><a href="#local-6989586621683031581"><span class="hs-identifier hs-var">implic</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Implic"><span class="hs-identifier hs-type">Implic</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ic_skols :: Implication -&gt; [TcId]
</span><a href="GHC.Tc.Types.Constraint.html#ic_skols"><span class="hs-identifier hs-var">ic_skols</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031584"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031584"><span class="hs-identifier hs-var">tvs</span></a></span></span><span>
</span><span id="line-334"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ic_given :: Implication -&gt; [TcId]
</span><a href="GHC.Tc.Types.Constraint.html#ic_given"><span class="hs-identifier hs-var">ic_given</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031586"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031586"><span class="hs-identifier hs-var">given</span></a></span></span><span>
</span><span id="line-335"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ic_wanted :: Implication -&gt; WantedConstraints
</span><a href="GHC.Tc.Types.Constraint.html#ic_wanted"><span class="hs-identifier hs-var">ic_wanted</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031588"><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621683031588"><span class="hs-identifier hs-var">wanted</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ic_binds :: Implication -&gt; EvBindsVar
</span><a href="GHC.Tc.Types.Constraint.html#ic_binds"><span class="hs-identifier hs-var">ic_binds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031590"><span class="annot"><span class="annottext">EvBindsVar
</span><a href="#local-6989586621683031590"><span class="hs-identifier hs-var">evb</span></a></span></span><span>
</span><span id="line-336"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ic_status :: Implication -&gt; ImplicStatus
</span><a href="GHC.Tc.Types.Constraint.html#ic_status"><span class="hs-identifier hs-var">ic_status</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031592"><span class="annot"><span class="annottext">ImplicStatus
</span><a href="#local-6989586621683031592"><span class="hs-identifier hs-var">status</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ic_info :: Implication -&gt; SkolemInfoAnon
</span><a href="GHC.Tc.Types.Constraint.html#ic_info"><span class="hs-identifier hs-var">ic_info</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031594"><span class="annot"><span class="annottext">SkolemInfoAnon
</span><a href="#local-6989586621683031594"><span class="hs-identifier hs-var">info</span></a></span></span><span>
</span><span id="line-337"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ic_env :: Implication -&gt; CtLocEnv
</span><a href="GHC.Tc.Types.Constraint.html#ic_env"><span class="hs-identifier hs-var">ic_env</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031596"><span class="annot"><span class="annottext">CtLocEnv
</span><a href="#local-6989586621683031596"><span class="hs-identifier hs-var">ct_loc_env</span></a></span></span><span>
</span><span id="line-338"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ic_tclvl :: Implication -&gt; TcLevel
</span><a href="GHC.Tc.Types.Constraint.html#ic_tclvl"><span class="hs-identifier hs-var">ic_tclvl</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031598"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621683031598"><span class="hs-identifier hs-var">tc_lvl</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">SkolemInfoAnon
</span><a href="GHC.Tc.Types.Origin.html#BracketSkol"><span class="hs-identifier hs-var">BracketSkol</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SkolemInfoAnon
</span><a href="#local-6989586621683031594"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683031600"><span class="hs-identifier hs-var">insoluble</span></a></span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcM ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>        </span><span class="hs-comment">-- For Template Haskell brackets report only</span><span>
</span><span id="line-342"></span><span>                     </span><span class="hs-comment">-- definite errors. The whole thing will be re-checked</span><span>
</span><span id="line-343"></span><span>                     </span><span class="hs-comment">-- later when we plug it in, and meanwhile there may</span><span>
</span><span id="line-344"></span><span>                     </span><span class="hs-comment">-- certainly be un-satisfied constraints</span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;reportImplic&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; TcM ()) -&gt; SDoc -&gt; TcM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-348"></span><span>           </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tidy env:&quot;</span></span><span>   </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TidyEnv
</span><a href="GHC.Tc.Errors.Types.html#cec_tidy"><span class="hs-identifier hs-var">cec_tidy</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031580"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;skols:     &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId] -&gt; SDoc
</span><a href="GHC.Core.TyCo.Ppr.html#pprTyVars"><span class="hs-identifier hs-var">pprTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031584"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-350"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tidy skols:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId] -&gt; SDoc
</span><a href="GHC.Core.TyCo.Ppr.html#pprTyVars"><span class="hs-identifier hs-var">pprTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031601"><span class="hs-identifier hs-var">tvs'</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TcM () -&gt; TcM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683031602"><span class="hs-identifier hs-var">bad_telescope</span></a></span><span> </span><span class="annot"><span class="annottext">(TcM () -&gt; TcM ()) -&gt; TcM () -&gt; TcM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
-&gt; CtLocEnv -&gt; SkolemInfoAnon -&gt; [TcId] -&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#reportBadTelescope"><span class="hs-identifier hs-var">reportBadTelescope</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031580"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">CtLocEnv
</span><a href="#local-6989586621683031596"><span class="hs-identifier hs-var">ct_loc_env</span></a></span><span> </span><span class="annot"><span class="annottext">SkolemInfoAnon
</span><a href="#local-6989586621683031594"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031584"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-353"></span><span>               </span><span class="hs-comment">-- Do /not/ use the tidied tvs because then are in the</span><span>
</span><span id="line-354"></span><span>               </span><span class="hs-comment">-- wrong order, so tidying will rename things wrongly</span><span>
</span><span id="line-355"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TcLevel -&gt; WantedConstraints -&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#reportWanteds"><span class="hs-identifier hs-var">reportWanteds</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031604"><span class="hs-identifier hs-var">ctxt'</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621683031598"><span class="hs-identifier hs-var">tc_lvl</span></a></span><span> </span><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621683031588"><span class="hs-identifier hs-var">wanted</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span>       </span><span class="hs-comment">-- Report redundant (unused) constraints</span><span>
</span><span id="line-358"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
-&gt; CtLocEnv -&gt; SkolemInfoAnon -&gt; [TcId] -&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#warnRedundantConstraints"><span class="hs-identifier hs-var">warnRedundantConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031604"><span class="hs-identifier hs-var">ctxt'</span></a></span><span> </span><span class="annot"><span class="annottext">CtLocEnv
</span><a href="#local-6989586621683031596"><span class="hs-identifier hs-var">ct_loc_env</span></a></span><span> </span><span class="annot"><span class="annottext">SkolemInfoAnon
</span><a href="#local-6989586621683031606"><span class="hs-identifier hs-var">info'</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031607"><span class="hs-identifier hs-var">dead_givens</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-360"></span><span>    </span><span id="local-6989586621683031600"><span class="annot"><span class="annottext">insoluble :: Bool
</span><a href="#local-6989586621683031600"><span class="hs-identifier hs-var hs-var">insoluble</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImplicStatus -&gt; Bool
</span><a href="GHC.Tc.Types.Constraint.html#isInsolubleStatus"><span class="hs-identifier hs-var">isInsolubleStatus</span></a></span><span> </span><span class="annot"><span class="annottext">ImplicStatus
</span><a href="#local-6989586621683031592"><span class="hs-identifier hs-var">status</span></a></span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621683031609"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621683031609"><span class="hs-identifier hs-var">env1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031601"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031601"><span class="hs-identifier hs-var">tvs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; [TcId] -&gt; (TidyEnv, [TcId])
</span><a href="GHC.Core.TyCo.Tidy.html#tidyVarBndrs"><span class="hs-identifier hs-var">tidyVarBndrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TidyEnv
</span><a href="GHC.Tc.Errors.Types.html#cec_tidy"><span class="hs-identifier hs-var">cec_tidy</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031580"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([TcId] -&gt; (TidyEnv, [TcId])) -&gt; [TcId] -&gt; (TidyEnv, [TcId])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-362"></span><span>                   </span><span class="annot"><span class="annottext">[TcId] -&gt; [TcId]
</span><a href="GHC.Core.TyCo.FVs.html#scopedSort"><span class="hs-identifier hs-var">scopedSort</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031584"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-363"></span><span>        </span><span class="hs-comment">-- scopedSort: the ic_skols may not be in dependency order</span><span>
</span><span id="line-364"></span><span>        </span><span class="hs-comment">-- (see Note [Skolems in an implication] in GHC.Tc.Types.Constraint)</span><span>
</span><span id="line-365"></span><span>        </span><span class="hs-comment">-- but tidying goes wrong on out-of-order constraints;</span><span>
</span><span id="line-366"></span><span>        </span><span class="hs-comment">-- so we sort them here before tidying</span><span>
</span><span id="line-367"></span><span>    </span><span id="local-6989586621683031606"><span class="annot"><span class="annottext">info' :: SkolemInfoAnon
</span><a href="#local-6989586621683031606"><span class="hs-identifier hs-var hs-var">info'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; SkolemInfoAnon -&gt; SkolemInfoAnon
</span><a href="GHC.Tc.Errors.Ppr.html#tidySkolemInfoAnon"><span class="hs-identifier hs-var">tidySkolemInfoAnon</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621683031609"><span class="hs-identifier hs-var">env1</span></a></span><span> </span><span class="annot"><span class="annottext">SkolemInfoAnon
</span><a href="#local-6989586621683031594"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-368"></span><span>    </span><span id="local-6989586621683031613"><span class="annot"><span class="annottext">implic' :: Implication
</span><a href="#local-6989586621683031613"><span class="hs-identifier hs-var hs-var">implic'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683031581"><span class="hs-identifier hs-var">implic</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#ic_skols"><span class="hs-identifier hs-var">ic_skols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683031601"><span class="hs-identifier hs-type">tvs'</span></a></span><span>
</span><span id="line-369"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#ic_given"><span class="hs-identifier hs-var">ic_given</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Zonk.TcType.html#tidyEvVar"><span class="hs-identifier hs-type">tidyEvVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031609"><span class="hs-identifier hs-type">env1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683031586"><span class="hs-identifier hs-type">given</span></a></span><span>
</span><span id="line-370"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#ic_info"><span class="hs-identifier hs-var">ic_info</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683031606"><span class="hs-identifier hs-type">info'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span>    </span><span id="local-6989586621683031615"><span class="annot"><span class="annottext">ctxt1 :: SolverReportErrCtxt
</span><a href="#local-6989586621683031615"><span class="hs-identifier hs-var hs-var">ctxt1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EvBindsVar -&gt; SolverReportErrCtxt -&gt; SolverReportErrCtxt
</span><a href="GHC.Tc.Errors.html#maybeSwitchOffDefer"><span class="hs-identifier hs-var">maybeSwitchOffDefer</span></a></span><span> </span><span class="annot"><span class="annottext">EvBindsVar
</span><a href="#local-6989586621683031590"><span class="hs-identifier hs-var">evb</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031580"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span id="local-6989586621683031604"><span class="annot"><span class="annottext">ctxt' :: SolverReportErrCtxt
</span><a href="#local-6989586621683031604"><span class="hs-identifier hs-var hs-var">ctxt'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031615"><span class="hs-identifier hs-var">ctxt1</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_tidy"><span class="hs-identifier hs-var">cec_tidy</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683031609"><span class="hs-identifier hs-type">env1</span></a></span><span>
</span><span id="line-374"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_encl"><span class="hs-identifier hs-var">cec_encl</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683031613"><span class="hs-identifier hs-type">implic'</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_encl"><span class="hs-identifier hs-var">cec_encl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031580"><span class="hs-identifier hs-type">ctxt</span></a></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_suppress"><span class="hs-identifier hs-var">cec_suppress</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683031600"><span class="hs-identifier hs-type">insoluble</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_suppress"><span class="hs-identifier hs-var">cec_suppress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031580"><span class="hs-identifier hs-type">ctxt</span></a></span><span>
</span><span id="line-377"></span><span>                        </span><span class="hs-comment">-- Suppress inessential errors if there</span><span>
</span><span id="line-378"></span><span>                        </span><span class="hs-comment">-- are insolubles anywhere in the</span><span>
</span><span id="line-379"></span><span>                        </span><span class="hs-comment">-- tree rooted here, or we've come across</span><span>
</span><span id="line-380"></span><span>                        </span><span class="hs-comment">-- a suppress-worthy constraint higher up (#11541)</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_binds"><span class="hs-identifier hs-var">cec_binds</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683031590"><span class="hs-identifier hs-type">evb</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span>    </span><span id="local-6989586621683031607"><span class="annot"><span class="annottext">dead_givens :: [TcId]
</span><a href="#local-6989586621683031607"><span class="hs-identifier hs-var hs-var">dead_givens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ImplicStatus
</span><a href="#local-6989586621683031592"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-385"></span><span>                    </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#IC_Solved"><span class="hs-identifier hs-type">IC_Solved</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ics_dead :: ImplicStatus -&gt; [TcId]
</span><a href="GHC.Tc.Types.Constraint.html#ics_dead"><span class="hs-identifier hs-var">ics_dead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031619"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031619"><span class="hs-identifier hs-var">dead</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031619"><span class="hs-identifier hs-var">dead</span></a></span><span>
</span><span id="line-386"></span><span>                    </span><span class="annot"><span class="annottext">ImplicStatus
</span><span class="hs-identifier">_</span></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span>    </span><span id="local-6989586621683031602"><span class="annot"><span class="annottext">bad_telescope :: Bool
</span><a href="#local-6989586621683031602"><span class="hs-identifier hs-var hs-var">bad_telescope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ImplicStatus
</span><a href="#local-6989586621683031592"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-389"></span><span>              </span><span class="annot"><span class="annottext">ImplicStatus
</span><a href="GHC.Tc.Types.Constraint.html#IC_BadTelescope"><span class="hs-identifier hs-var">IC_BadTelescope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-390"></span><span>              </span><span class="annot"><span class="annottext">ImplicStatus
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="annot"><a href="GHC.Tc.Errors.html#warnRedundantConstraints"><span class="hs-identifier hs-type">warnRedundantConstraints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.CtLoc.html#CtLocEnv"><span class="hs-identifier hs-type">CtLocEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#SkolemInfoAnon"><span class="hs-identifier hs-type">SkolemInfoAnon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span class="hs-comment">-- See Note [Tracking redundant constraints] in GHC.Tc.Solver</span><span>
</span><span id="line-394"></span><span id="warnRedundantConstraints"><span class="annot"><span class="annottext">warnRedundantConstraints :: SolverReportErrCtxt
-&gt; CtLocEnv -&gt; SkolemInfoAnon -&gt; [TcId] -&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#warnRedundantConstraints"><span class="hs-identifier hs-var hs-var">warnRedundantConstraints</span></a></span></span><span> </span><span id="local-6989586621683031622"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031622"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683031623"><span class="annot"><span class="annottext">CtLocEnv
</span><a href="#local-6989586621683031623"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621683031624"><span class="annot"><span class="annottext">SkolemInfoAnon
</span><a href="#local-6989586621683031624"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621683031625"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031625"><span class="hs-identifier hs-var">redundant_evs</span></a></span></span><span>
</span><span id="line-395"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; Bool
</span><a href="GHC.Tc.Errors.Types.html#cec_warn_redundant"><span class="hs-identifier hs-var">cec_warn_redundant</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031622"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcM ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[TcId] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031625"><span class="hs-identifier hs-var">redundant_evs</span></a></span><span>
</span><span id="line-399"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcM ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span> </span><span class="hs-comment">-- Do not report redundant constraints for quantified constraints</span><span>
</span><span id="line-402"></span><span> </span><span class="hs-comment">-- See (RC4) in Note [Tracking redundant constraints]</span><span>
</span><span id="line-403"></span><span> </span><span class="hs-comment">-- Fortunately it is easy to spot implications constraints that arise</span><span>
</span><span id="line-404"></span><span> </span><span class="hs-comment">-- from quantified constraints, from their SkolInfo</span><span>
</span><span id="line-405"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#InstSkol"><span class="hs-identifier hs-type">InstSkol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Origin.html#IsQC"><span class="hs-identifier hs-type">IsQC</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PatersonSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SkolemInfoAnon
</span><a href="#local-6989586621683031624"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-406"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcM ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#SigSkol"><span class="hs-identifier hs-type">SigSkol</span></a></span><span> </span><span id="local-6989586621683031630"><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="#local-6989586621683031630"><span class="hs-identifier hs-var">user_ctxt</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(Name, TcId)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SkolemInfoAnon
</span><a href="#local-6989586621683031624"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-409"></span><span> </span><span class="hs-comment">-- When dealing with a user-written type signature,</span><span>
</span><span id="line-410"></span><span> </span><span class="hs-comment">-- we want to add &quot;In the type signature for f&quot;.</span><span>
</span><span id="line-411"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; CtLocEnv -&gt; TcM ()
</span><a href="#local-6989586621683031631"><span class="hs-identifier hs-var">report_redundant_msg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CtLocEnv -&gt; SrcSpan -&gt; CtLocEnv
</span><a href="GHC.Tc.Types.CtLoc.html#setCtLocEnvLoc"><span class="hs-identifier hs-var">setCtLocEnvLoc</span></a></span><span> </span><span class="annot"><span class="annottext">CtLocEnv
</span><a href="#local-6989586621683031623"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserTypeCtxt -&gt; SrcSpan
</span><a href="GHC.Tc.Types.Origin.html#redundantConstraintsSpan"><span class="hs-identifier hs-var">redundantConstraintsSpan</span></a></span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="#local-6989586621683031630"><span class="hs-identifier hs-var">user_ctxt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>                             </span><span class="hs-comment">--  ^^^^ add &quot;In the type signature...&quot;</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-415"></span><span> </span><span class="hs-comment">-- But for InstSkol there already *is* a surrounding</span><span>
</span><span id="line-416"></span><span> </span><span class="hs-comment">-- &quot;In the instance declaration for Eq [a]&quot; context</span><span>
</span><span id="line-417"></span><span> </span><span class="hs-comment">-- and we don't want to say it twice. Seems a bit ad-hoc</span><span>
</span><span id="line-418"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; CtLocEnv -&gt; TcM ()
</span><a href="#local-6989586621683031631"><span class="hs-identifier hs-var">report_redundant_msg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">CtLocEnv
</span><a href="#local-6989586621683031623"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-419"></span><span>                   </span><span class="hs-comment">--   ^^^^^ don't add &quot;In the type signature...&quot;</span><span>
</span><span id="line-420"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-421"></span><span>   </span><span class="annot"><a href="#local-6989586621683031631"><span class="hs-identifier hs-type">report_redundant_msg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- whether to add &quot;In the type signature...&quot; to the diagnostic</span><span>
</span><span id="line-422"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.CtLoc.html#CtLocEnv"><span class="hs-identifier hs-type">CtLocEnv</span></a></span><span>
</span><span id="line-423"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRn"><span class="hs-identifier hs-type">TcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>   </span><span id="local-6989586621683031631"><span class="annot"><span class="annottext">report_redundant_msg :: Bool -&gt; CtLocEnv -&gt; TcM ()
</span><a href="#local-6989586621683031631"><span class="hs-identifier hs-var hs-var">report_redundant_msg</span></a></span></span><span> </span><span id="local-6989586621683031634"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683031634"><span class="hs-identifier hs-var">show_info</span></a></span></span><span> </span><span id="local-6989586621683031635"><span class="annot"><span class="annottext">CtLocEnv
</span><a href="#local-6989586621683031635"><span class="hs-identifier hs-var">lcl_env</span></a></span></span><span>
</span><span id="line-425"></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683031636"><span class="annot"><a href="#local-6989586621683031636"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-426"></span><span>              </span><span class="annot"><span class="annottext">CtLocEnv
-&gt; TcRnMessage
-&gt; Maybe SolverReportErrCtxt
-&gt; [SolverReportSupplementary]
-&gt; TcM (MsgEnvelope TcRnMessage)
</span><a href="GHC.Tc.Errors.html#mkErrorReport"><span class="hs-identifier hs-var">mkErrorReport</span></a></span><span>
</span><span id="line-427"></span><span>                </span><span class="annot"><span class="annottext">CtLocEnv
</span><a href="#local-6989586621683031635"><span class="hs-identifier hs-var">lcl_env</span></a></span><span>
</span><span id="line-428"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TcId] -&gt; (SkolemInfoAnon, Bool) -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnRedundantConstraints"><span class="hs-identifier hs-var">TcRnRedundantConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031625"><span class="hs-identifier hs-var">redundant_evs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SkolemInfoAnon
</span><a href="#local-6989586621683031624"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683031634"><span class="hs-identifier hs-var">show_info</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; Maybe SolverReportErrCtxt
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031622"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-431"></span><span>          </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#reportDiagnostic"><span class="hs-identifier hs-type">reportDiagnostic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031636"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span class="annot"><a href="GHC.Tc.Errors.html#reportBadTelescope"><span class="hs-identifier hs-type">reportBadTelescope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.CtLoc.html#CtLocEnv"><span class="hs-identifier hs-type">CtLocEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#SkolemInfoAnon"><span class="hs-identifier hs-type">SkolemInfoAnon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span id="reportBadTelescope"><span class="annot"><span class="annottext">reportBadTelescope :: SolverReportErrCtxt
-&gt; CtLocEnv -&gt; SkolemInfoAnon -&gt; [TcId] -&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#reportBadTelescope"><span class="hs-identifier hs-var hs-var">reportBadTelescope</span></a></span></span><span> </span><span id="local-6989586621683031641"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031641"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683031642"><span class="annot"><span class="annottext">CtLocEnv
</span><a href="#local-6989586621683031642"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Origin.html#ForAllSkol"><span class="hs-identifier hs-type">ForAllSkol</span></a></span><span> </span><span id="local-6989586621683031644"><span class="annot"><span class="annottext">TyVarBndrs
</span><a href="#local-6989586621683031644"><span class="hs-identifier hs-var">telescope</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683031645"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031645"><span class="hs-identifier hs-var">skols</span></a></span></span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683031646"><span class="annot"><a href="#local-6989586621683031646"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CtLocEnv
-&gt; TcRnMessage
-&gt; Maybe SolverReportErrCtxt
-&gt; [SolverReportSupplementary]
-&gt; TcM (MsgEnvelope TcRnMessage)
</span><a href="GHC.Tc.Errors.html#mkErrorReport"><span class="hs-identifier hs-var">mkErrorReport</span></a></span><span>
</span><span id="line-436"></span><span>                  </span><span class="annot"><span class="annottext">CtLocEnv
</span><a href="#local-6989586621683031642"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-437"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportWithCtxt -&gt; DiagnosticReason -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnSolverReport"><span class="hs-identifier hs-var">TcRnSolverReport</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportWithCtxt
</span><a href="#local-6989586621683031648"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-var">ErrorWithoutFlag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; Maybe SolverReportErrCtxt
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031641"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>                  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-440"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#reportDiagnostic"><span class="hs-identifier hs-type">reportDiagnostic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031646"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-441"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-442"></span><span>    </span><span id="local-6989586621683031648"><span class="annot"><span class="annottext">report :: SolverReportWithCtxt
</span><a href="#local-6989586621683031648"><span class="hs-identifier hs-var hs-var">report</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TcSolverReportMsg -&gt; SolverReportWithCtxt
</span><a href="GHC.Tc.Errors.Types.html#SolverReportWithCtxt"><span class="hs-identifier hs-var">SolverReportWithCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031641"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(TcSolverReportMsg -&gt; SolverReportWithCtxt)
-&gt; TcSolverReportMsg -&gt; SolverReportWithCtxt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndrs -&gt; [TcId] -&gt; TcSolverReportMsg
</span><a href="GHC.Tc.Errors.Types.html#BadTelescope"><span class="hs-identifier hs-var">BadTelescope</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarBndrs
</span><a href="#local-6989586621683031644"><span class="hs-identifier hs-var">telescope</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031645"><span class="hs-identifier hs-var">skols</span></a></span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="annot"><a href="GHC.Tc.Errors.html#reportBadTelescope"><span class="hs-identifier hs-var">reportBadTelescope</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CtLocEnv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683031650"><span class="annot"><span class="annottext">SkolemInfoAnon
</span><a href="#local-6989586621683031650"><span class="hs-identifier hs-var">skol_info</span></a></span></span><span> </span><span id="local-6989586621683031651"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031651"><span class="hs-identifier hs-var">skols</span></a></span></span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;reportBadTelescope&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SkolemInfoAnon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">SkolemInfoAnon
</span><a href="#local-6989586621683031650"><span class="hs-identifier hs-var">skol_info</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683031651"><span class="hs-identifier hs-var">skols</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="hs-comment">-- | Should we completely ignore this constraint in error reporting?</span><span>
</span><span id="line-448"></span><span class="hs-comment">-- It *must* be the case that any constraint for which this returns True</span><span>
</span><span id="line-449"></span><span class="hs-comment">-- somehow causes an error to be reported elsewhere.</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- See Note [Constraints to ignore].</span><span>
</span><span id="line-451"></span><span class="annot"><a href="GHC.Tc.Errors.html#ignoreConstraint"><span class="hs-identifier hs-type">ignoreConstraint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Ct"><span class="hs-identifier hs-type">Ct</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-452"></span><span id="ignoreConstraint"><span class="annot"><span class="annottext">ignoreConstraint :: Ct -&gt; Bool
</span><a href="GHC.Tc.Errors.html#ignoreConstraint"><span class="hs-identifier hs-var hs-var">ignoreConstraint</span></a></span></span><span> </span><span id="local-6989586621683031655"><span class="annot"><span class="annottext">Ct
</span><a href="#local-6989586621683031655"><span class="hs-identifier hs-var">ct</span></a></span></span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CtOrigin
</span><a href="GHC.Tc.Types.Origin.html#AssocFamPatOrigin"><span class="hs-identifier hs-var">AssocFamPatOrigin</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ct -&gt; CtOrigin
</span><a href="GHC.Tc.Types.Constraint.html#ctOrigin"><span class="hs-identifier hs-var">ctOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">Ct
</span><a href="#local-6989586621683031655"><span class="hs-identifier hs-var">ct</span></a></span><span>
</span><span id="line-454"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-455"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-456"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="hs-comment">-- | Makes an error item from a constraint, calculating whether or not</span><span>
</span><span id="line-459"></span><span class="hs-comment">-- the item should be suppressed. See Note [Wanteds rewrite Wanteds]</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- in GHC.Tc.Types.Constraint. Returns Nothing if we should just ignore</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- a constraint. See Note [Constraints to ignore].</span><span>
</span><span id="line-462"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkErrorItem"><span class="hs-identifier hs-type">mkErrorItem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Ct"><span class="hs-identifier hs-type">Ct</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span id="mkErrorItem"><span class="annot"><span class="annottext">mkErrorItem :: Ct -&gt; TcM (Maybe ErrorItem)
</span><a href="GHC.Tc.Errors.html#mkErrorItem"><span class="hs-identifier hs-var hs-var">mkErrorItem</span></a></span></span><span> </span><span id="local-6989586621683031659"><span class="annot"><span class="annottext">Ct
</span><a href="#local-6989586621683031659"><span class="hs-identifier hs-var">ct</span></a></span></span><span>
</span><span id="line-464"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Ct -&gt; Bool
</span><a href="GHC.Tc.Errors.html#ignoreConstraint"><span class="hs-identifier hs-var">ignoreConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">Ct
</span><a href="#local-6989586621683031659"><span class="hs-identifier hs-var">ct</span></a></span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Ignoring constraint:&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ct -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Ct
</span><a href="#local-6989586621683031659"><span class="hs-identifier hs-var">ct</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Maybe ErrorItem -&gt; TcM (Maybe ErrorItem)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe ErrorItem
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">}</span><span>   </span><span class="hs-comment">-- See Note [Constraints to ignore]</span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683031660"><span class="annot"><span class="annottext">loc :: CtLoc
</span><a href="#local-6989586621683031660"><span class="hs-identifier hs-var hs-var hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ct -&gt; CtLoc
</span><a href="GHC.Tc.Types.Constraint.html#ctLoc"><span class="hs-identifier hs-var">ctLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ct
</span><a href="#local-6989586621683031659"><span class="hs-identifier hs-var">ct</span></a></span><span>
</span><span id="line-470"></span><span>             </span><span id="local-6989586621683031662"><span class="annot"><span class="annottext">flav :: CtFlavour
</span><a href="#local-6989586621683031662"><span class="hs-identifier hs-var hs-var hs-var">flav</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ct -&gt; CtFlavour
</span><a href="GHC.Tc.Types.Constraint.html#ctFlavour"><span class="hs-identifier hs-var">ctFlavour</span></a></span><span> </span><span class="annot"><span class="annottext">Ct
</span><a href="#local-6989586621683031659"><span class="hs-identifier hs-var">ct</span></a></span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683031664"><span class="annot"><a href="#local-6989586621683031664"><span class="hs-identifier hs-var">suppress</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031665"><span class="annot"><a href="#local-6989586621683031665"><span class="hs-identifier hs-var">m_evdest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ct -&gt; CtEvidence
</span><a href="GHC.Tc.Types.Constraint.html#ctEvidence"><span class="hs-identifier hs-var">ctEvidence</span></a></span><span> </span><span class="annot"><span class="annottext">Ct
</span><a href="#local-6989586621683031659"><span class="hs-identifier hs-var">ct</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-473"></span><span>         </span><span class="hs-comment">-- For this `suppress` stuff</span><span>
</span><span id="line-474"></span><span>         </span><span class="hs-comment">-- see Note [Wanteds rewrite Wanteds] in GHC.Tc.Types.Constraint</span><span>
</span><span id="line-475"></span><span>           </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#CtGiven"><span class="hs-identifier hs-type">CtGiven</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Bool, Maybe TcEvDest)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Bool, Maybe TcEvDest)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe TcEvDest
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>           </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#CtWanted"><span class="hs-identifier hs-type">CtWanted</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ctev_rewriters :: CtEvidence -&gt; RewriterSet
</span><a href="GHC.Tc.Types.Constraint.html#ctev_rewriters"><span class="hs-identifier hs-var">ctev_rewriters</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031670"><span class="annot"><span class="annottext">RewriterSet
</span><a href="#local-6989586621683031670"><span class="hs-identifier hs-var">rewriters</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ctev_dest :: CtEvidence -&gt; TcEvDest
</span><a href="GHC.Tc.Types.Constraint.html#ctev_dest"><span class="hs-identifier hs-var">ctev_dest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031672"><span class="annot"><span class="annottext">TcEvDest
</span><a href="#local-6989586621683031672"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-477"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683031673"><span class="annot"><a href="#local-6989586621683031673"><span class="hs-identifier hs-var">rewriters'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RewriterSet -&gt; TcM RewriterSet
</span><a href="GHC.Tc.Zonk.Type.html#zonkRewriterSet"><span class="hs-identifier hs-var">zonkRewriterSet</span></a></span><span> </span><span class="annot"><span class="annottext">RewriterSet
</span><a href="#local-6989586621683031670"><span class="hs-identifier hs-var">rewriters</span></a></span><span>
</span><span id="line-478"></span><span>                   </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#isEmptyRewriterSet"><span class="hs-identifier hs-type">isEmptyRewriterSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031673"><span class="hs-identifier hs-type">rewriters'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621683031672"><span class="hs-identifier hs-type">dest</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683031676"><span class="annot"><a href="#local-6989586621683031676"><span class="hs-identifier hs-var hs-var">m_reason</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ct
</span><a href="#local-6989586621683031659"><span class="hs-identifier hs-var">ct</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-481"></span><span>                </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#CIrredCan"><span class="hs-identifier hs-type">CIrredCan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#IrredCt"><span class="hs-identifier hs-type">IrredCt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ir_reason :: IrredCt -&gt; CtIrredReason
</span><a href="GHC.Tc.Types.Constraint.html#ir_reason"><span class="hs-identifier hs-var">ir_reason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031680"><span class="annot"><span class="annottext">CtIrredReason
</span><a href="#local-6989586621683031680"><span class="hs-identifier hs-var">reason</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CtIrredReason -&gt; Maybe CtIrredReason
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">CtIrredReason
</span><a href="#local-6989586621683031680"><span class="hs-identifier hs-var">reason</span></a></span><span>
</span><span id="line-482"></span><span>                </span><span class="annot"><span class="annottext">Ct
</span><span class="hs-identifier">_</span></span><span>                                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CtIrredReason
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-483"></span><span>
</span><span id="line-484"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#EI"><span class="hs-identifier hs-type">EI</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ei_pred"><span class="hs-identifier hs-var">ei_pred</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#ctPred"><span class="hs-identifier hs-type">ctPred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031659"><span class="hs-identifier hs-type">ct</span></a></span><span>
</span><span id="line-485"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ei_evdest"><span class="hs-identifier hs-var">ei_evdest</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683031665"><span class="hs-identifier hs-type">m_evdest</span></a></span><span>
</span><span id="line-486"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ei_flavour"><span class="hs-identifier hs-var">ei_flavour</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683031662"><span class="hs-identifier hs-type">flav</span></a></span><span>
</span><span id="line-487"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ei_loc"><span class="hs-identifier hs-var">ei_loc</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683031660"><span class="hs-identifier hs-type">loc</span></a></span><span>
</span><span id="line-488"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ei_m_reason"><span class="hs-identifier hs-var">ei_m_reason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683031676"><span class="hs-identifier hs-type">m_reason</span></a></span><span>
</span><span id="line-489"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ei_suppress"><span class="hs-identifier hs-var">ei_suppress</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683031664"><span class="hs-identifier hs-type">suppress</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="annot"><span class="hs-comment">-- | Actually report this 'ErrorItem'.</span></span><span>
</span><span id="line-492"></span><span class="annot"><a href="GHC.Tc.Errors.html#unsuppressErrorItem"><span class="hs-identifier hs-type">unsuppressErrorItem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span>
</span><span id="line-493"></span><span id="unsuppressErrorItem"><span class="annot"><span class="annottext">unsuppressErrorItem :: ErrorItem -&gt; ErrorItem
</span><a href="GHC.Tc.Errors.html#unsuppressErrorItem"><span class="hs-identifier hs-var hs-var">unsuppressErrorItem</span></a></span></span><span> </span><span id="local-6989586621683031690"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031690"><span class="hs-identifier hs-var">ei</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031690"><span class="hs-identifier hs-var">ei</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ei_suppress"><span class="hs-identifier hs-var">ei_suppress</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-496"></span><span class="annot"><a href="GHC.Tc.Errors.html#reportWanteds"><span class="hs-identifier hs-type">reportWanteds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span id="reportWanteds"><span class="annot"><span class="annottext">reportWanteds :: SolverReportErrCtxt -&gt; TcLevel -&gt; WantedConstraints -&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#reportWanteds"><span class="hs-identifier hs-var hs-var">reportWanteds</span></a></span></span><span> </span><span id="local-6989586621683031691"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031691"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683031692"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621683031692"><span class="hs-identifier hs-var">tc_lvl</span></a></span></span><span> </span><span id="local-6989586621683031693"><span class="annot"><span class="annottext">wc :: WantedConstraints
</span><a href="#local-6989586621683031693"><span class="hs-identifier hs-var">wc</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#WC"><span class="hs-identifier hs-type">WC</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">wc_simple :: WantedConstraints -&gt; Cts
</span><a href="GHC.Tc.Types.Constraint.html#wc_simple"><span class="hs-identifier hs-var">wc_simple</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031696"><span class="annot"><span class="annottext">Cts
</span><a href="#local-6989586621683031696"><span class="hs-identifier hs-var">simples</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">wc_impl :: WantedConstraints -&gt; Bag Implication
</span><a href="GHC.Tc.Types.Constraint.html#wc_impl"><span class="hs-identifier hs-var">wc_impl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031698"><span class="annot"><span class="annottext">Bag Implication
</span><a href="#local-6989586621683031698"><span class="hs-identifier hs-var">implics</span></a></span></span><span>
</span><span id="line-498"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">wc_errors :: WantedConstraints -&gt; Bag DelayedError
</span><a href="GHC.Tc.Types.Constraint.html#wc_errors"><span class="hs-identifier hs-var">wc_errors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031700"><span class="annot"><span class="annottext">Bag DelayedError
</span><a href="#local-6989586621683031700"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">WantedConstraints -&gt; Bool
</span><a href="GHC.Tc.Types.Constraint.html#isEmptyWC"><span class="hs-identifier hs-var">isEmptyWC</span></a></span><span> </span><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621683031693"><span class="hs-identifier hs-var">wc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;reportWanteds empty WC&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-501"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683031701"><span class="annot"><a href="#local-6989586621683031701"><span class="hs-identifier hs-var">tidy_items1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ct -&gt; TcM (Maybe ErrorItem))
-&gt; [Ct] -&gt; IOEnv (Env TcGblEnv TcLclEnv) [ErrorItem]
forall (m :: * -&gt; *) a b.
Applicative m =&gt;
(a -&gt; m (Maybe b)) -&gt; [a] -&gt; m [b]
</span><a href="GHC.Utils.Monad.html#mapMaybeM"><span class="hs-identifier hs-var">mapMaybeM</span></a></span><span> </span><span class="annot"><span class="annottext">Ct -&gt; TcM (Maybe ErrorItem)
</span><a href="GHC.Tc.Errors.html#mkErrorItem"><span class="hs-identifier hs-var">mkErrorItem</span></a></span><span> </span><span class="annot"><span class="annottext">[Ct]
</span><a href="#local-6989586621683031703"><span class="hs-identifier hs-var">tidy_cts</span></a></span><span>
</span><span id="line-502"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-type">traceTc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;reportWanteds 1&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Simples =&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031696"><span class="hs-identifier hs-type">simples</span></a></span><span>
</span><span id="line-503"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Suppress =&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_suppress"><span class="hs-identifier hs-var">cec_suppress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031691"><span class="hs-identifier hs-type">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tidy_cts   =&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031703"><span class="hs-identifier hs-type">tidy_cts</span></a></span><span>
</span><span id="line-505"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tidy_items1 =&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031701"><span class="hs-identifier hs-type">tidy_items1</span></a></span><span>
</span><span id="line-506"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tidy_errs =&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031704"><span class="hs-identifier hs-type">tidy_errs</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span>         </span><span class="hs-comment">-- Catch an awkward (and probably rare) case in which /all/ errors are</span><span>
</span><span id="line-509"></span><span>         </span><span class="hs-comment">-- suppressed: see Wrinkle (WRW2) in Note [Prioritise Wanteds with empty</span><span>
</span><span id="line-510"></span><span>         </span><span class="hs-comment">-- RewriterSet] in GHC.Tc.Types.Constraint.</span><span>
</span><span id="line-511"></span><span>         </span><span class="hs-comment">--</span><span>
</span><span id="line-512"></span><span>         </span><span class="hs-comment">-- Unless we are sure that an error will be reported some other way</span><span>
</span><span id="line-513"></span><span>         </span><span class="hs-comment">-- (details in the defn of tidy_items) un-suppress the lot. This makes</span><span>
</span><span id="line-514"></span><span>         </span><span class="hs-comment">-- sure we don't forget to report an error at all, which is</span><span>
</span><span id="line-515"></span><span>         </span><span class="hs-comment">-- catastrophic: GHC proceeds to desguar and optimise the program, even</span><span>
</span><span id="line-516"></span><span>         </span><span class="hs-comment">-- though it is full of type errors (#22702, #22793)</span><span>
</span><span id="line-517"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683031705"><span class="annot"><a href="#local-6989586621683031705"><span class="hs-identifier hs-var">errs_already</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#ifErrsM"><span class="hs-identifier hs-type">ifErrsM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683031707"><span class="annot"><a href="#local-6989586621683031707"><span class="hs-identifier hs-var hs-var">tidy_items</span></a></span></span><span>
</span><span id="line-519"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683031705"><span class="hs-identifier hs-var">errs_already</span></a></span><span>                     </span><span class="hs-comment">-- Have not already reported an error (perhaps</span><span>
</span><span id="line-520"></span><span>                                                      </span><span class="hs-comment">--   from an outer implication); see #21405</span><span>
</span><span id="line-521"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ct -&gt; Bool) -&gt; Cts -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Ct -&gt; Bool
</span><a href="GHC.Tc.Errors.html#ignoreConstraint"><span class="hs-identifier hs-var">ignoreConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">Cts
</span><a href="#local-6989586621683031696"><span class="hs-identifier hs-var">simples</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- No error is ignorable (is reported elsewhere)</span><span>
</span><span id="line-522"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(ErrorItem -&gt; Bool) -&gt; [ErrorItem] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Bool
</span><a href="GHC.Tc.Errors.Types.html#ei_suppress"><span class="hs-identifier hs-var">ei_suppress</span></a></span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683031701"><span class="hs-identifier hs-var">tidy_items1</span></a></span><span>          </span><span class="hs-comment">-- All errors are suppressed</span><span>
</span><span id="line-523"></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ErrorItem -&gt; ErrorItem) -&gt; [ErrorItem] -&gt; [ErrorItem]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; ErrorItem
</span><a href="GHC.Tc.Errors.html#unsuppressErrorItem"><span class="hs-identifier hs-var">unsuppressErrorItem</span></a></span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683031701"><span class="hs-identifier hs-var">tidy_items1</span></a></span><span>
</span><span id="line-524"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-525"></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683031701"><span class="hs-identifier hs-var">tidy_items1</span></a></span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span>         </span><span class="hs-comment">-- First, deal with any out-of-scope errors:</span><span>
</span><span id="line-528"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683031710"><span class="annot"><a href="#local-6989586621683031710"><span class="hs-identifier hs-var">out_of_scope</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031711"><span class="annot"><a href="#local-6989586621683031711"><span class="hs-identifier hs-var">other_holes</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031712"><span class="annot"><a href="#local-6989586621683031712"><span class="hs-identifier hs-var">not_conc_errs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683031713"><span class="hs-identifier hs-type">partition_errors</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031704"><span class="hs-identifier hs-type">tidy_errs</span></a></span><span>
</span><span id="line-529"></span><span>               </span><span class="hs-comment">-- don't suppress out-of-scope errors</span><span>
</span><span id="line-530"></span><span>             </span><span id="local-6989586621683031714"><span class="annot"><a href="#local-6989586621683031714"><span class="hs-identifier hs-var hs-var">ctxt_for_scope_errs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031691"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_suppress"><span class="hs-identifier hs-var">cec_suppress</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-531"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031715"><span class="annot"><a href="#local-6989586621683031715"><span class="hs-identifier hs-var">no_out_of_scope</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#askNoErrs"><span class="hs-identifier hs-type">askNoErrs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-532"></span><span>                                 </span><span class="annot"><a href="GHC.Tc.Errors.html#reportHoles"><span class="hs-identifier hs-type">reportHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031707"><span class="hs-identifier hs-type">tidy_items</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031714"><span class="hs-identifier hs-type">ctxt_for_scope_errs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031710"><span class="hs-identifier hs-type">out_of_scope</span></a></span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span>         </span><span class="hs-comment">-- Next, deal with things that are utterly wrong</span><span>
</span><span id="line-535"></span><span>         </span><span class="hs-comment">-- Like Int ~ Bool (incl nullary TyCons)</span><span>
</span><span id="line-536"></span><span>         </span><span class="hs-comment">-- or  Int ~ t a   (AppTy on one side)</span><span>
</span><span id="line-537"></span><span>         </span><span class="hs-comment">-- These /ones/ are not suppressed by the incoming context</span><span>
</span><span id="line-538"></span><span>         </span><span class="hs-comment">-- (but will be by out-of-scope errors)</span><span>
</span><span id="line-539"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683031718"><span class="annot"><a href="#local-6989586621683031718"><span class="hs-identifier hs-var hs-var">ctxt_for_insols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031691"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_suppress"><span class="hs-identifier hs-var">cec_suppress</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><a href="#local-6989586621683031715"><span class="hs-identifier hs-type">no_out_of_scope</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-540"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#reportHoles"><span class="hs-identifier hs-type">reportHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031707"><span class="hs-identifier hs-type">tidy_items</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031718"><span class="hs-identifier hs-type">ctxt_for_insols</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031711"><span class="hs-identifier hs-type">other_holes</span></a></span><span>
</span><span id="line-541"></span><span>          </span><span class="hs-comment">-- holes never suppress</span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#reportNotConcreteErrs"><span class="hs-identifier hs-type">reportNotConcreteErrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031718"><span class="hs-identifier hs-type">ctxt_for_insols</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031712"><span class="hs-identifier hs-type">not_conc_errs</span></a></span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span>          </span><span class="hs-comment">-- See Note [Suppressing confusing errors]</span><span>
</span><span id="line-546"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683031720"><span class="annot"><a href="#local-6989586621683031720"><span class="hs-identifier hs-var">suppressed_items</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031721"><span class="annot"><a href="#local-6989586621683031721"><span class="hs-identifier hs-var">items0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">partition</span></span><span> </span><span class="annot"><a href="#local-6989586621683031722"><span class="hs-identifier hs-type">suppress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031707"><span class="hs-identifier hs-type">tidy_items</span></a></span><span>
</span><span id="line-547"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-type">traceTc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;reportWanteds suppressed:&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031720"><span class="hs-identifier hs-type">suppressed_items</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683031723"><span class="annot"><a href="#local-6989586621683031723"><span class="hs-identifier hs-var">ctxt1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031724"><span class="annot"><a href="#local-6989586621683031724"><span class="hs-identifier hs-var">items1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#tryReporters"><span class="hs-identifier hs-type">tryReporters</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031718"><span class="hs-identifier hs-type">ctxt_for_insols</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031726"><span class="hs-identifier hs-type">report1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031721"><span class="hs-identifier hs-type">items0</span></a></span><span>
</span><span id="line-549"></span><span>
</span><span id="line-550"></span><span>         </span><span class="hs-comment">-- Now all the other constraints.  We suppress errors here if</span><span>
</span><span id="line-551"></span><span>         </span><span class="hs-comment">-- any of the first batch failed, or if the enclosing context</span><span>
</span><span id="line-552"></span><span>         </span><span class="hs-comment">-- says to suppress</span><span>
</span><span id="line-553"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683031727"><span class="annot"><a href="#local-6989586621683031727"><span class="hs-identifier hs-var hs-var">ctxt2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031723"><span class="hs-identifier hs-var">ctxt1</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_suppress"><span class="hs-identifier hs-var">cec_suppress</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_suppress"><span class="hs-identifier hs-var">cec_suppress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031691"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_suppress"><span class="hs-identifier hs-var">cec_suppress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031723"><span class="hs-identifier hs-type">ctxt1</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-554"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683031728"><span class="annot"><a href="#local-6989586621683031728"><span class="hs-identifier hs-var">ctxt3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031729"><span class="annot"><a href="#local-6989586621683031729"><span class="hs-identifier hs-var">leftovers</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#tryReporters"><span class="hs-identifier hs-type">tryReporters</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031727"><span class="hs-identifier hs-type">ctxt2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031730"><span class="hs-identifier hs-type">report2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031724"><span class="hs-identifier hs-type">items1</span></a></span><span>
</span><span id="line-555"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html#massertPpr"><span class="hs-identifier hs-type">massertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621683031729"><span class="hs-identifier hs-type">leftovers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>           </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;The following unsolved Wanted constraints \
                 \have not been reported to the user:&quot;</span></span><span>
</span><span id="line-558"></span><span>           </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031729"><span class="hs-identifier hs-type">leftovers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>
</span><span id="line-560"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Data.Bag.html#mapBagM_"><span class="hs-identifier hs-type">mapBagM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.html#reportImplic"><span class="hs-identifier hs-type">reportImplic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031727"><span class="hs-identifier hs-type">ctxt2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683031698"><span class="hs-identifier hs-type">implics</span></a></span><span>
</span><span id="line-561"></span><span>            </span><span class="hs-comment">-- NB ctxt2: don't suppress inner insolubles if there's only a</span><span>
</span><span id="line-562"></span><span>            </span><span class="hs-comment">-- wanted insoluble here; but do suppress inner insolubles</span><span>
</span><span id="line-563"></span><span>            </span><span class="hs-comment">-- if there's a *given* insoluble here (= inaccessible code)</span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span>            </span><span class="hs-comment">-- Only now, if there are no errors, do we report suppressed ones</span><span>
</span><span id="line-566"></span><span>            </span><span class="hs-comment">-- See Note [Suppressing confusing errors]</span><span>
</span><span id="line-567"></span><span>            </span><span class="hs-comment">-- We don't need to update the context further because of the</span><span>
</span><span id="line-568"></span><span>            </span><span class="hs-comment">-- whenNoErrs guard</span><span>
</span><span id="line-569"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#whenNoErrs"><span class="hs-identifier hs-type">whenNoErrs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-570"></span><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031734"><span class="annot"><a href="#local-6989586621683031734"><span class="hs-identifier hs-var">more_leftovers</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#tryReporters"><span class="hs-identifier hs-type">tryReporters</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031728"><span class="hs-identifier hs-type">ctxt3</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031735"><span class="hs-identifier hs-type">report3</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031720"><span class="hs-identifier hs-type">suppressed_items</span></a></span><span>
</span><span id="line-571"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html#massertPpr"><span class="hs-identifier hs-type">massertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621683031734"><span class="hs-identifier hs-type">more_leftovers</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031734"><span class="hs-identifier hs-type">more_leftovers</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-572"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-573"></span><span>    </span><span id="local-6989586621683031736"><span class="annot"><span class="annottext">env :: TidyEnv
</span><a href="#local-6989586621683031736"><span class="hs-identifier hs-var hs-var">env</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TidyEnv
</span><a href="GHC.Tc.Errors.Types.html#cec_tidy"><span class="hs-identifier hs-var">cec_tidy</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031691"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-574"></span><span>    </span><span id="local-6989586621683031703"><span class="annot"><span class="annottext">tidy_cts :: [Ct]
</span><a href="#local-6989586621683031703"><span class="hs-identifier hs-var hs-var">tidy_cts</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cts -&gt; [Ct]
forall a. Bag a -&gt; [a]
</span><a href="GHC.Data.Bag.html#bagToList"><span class="hs-identifier hs-var">bagToList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ct -&gt; Ct) -&gt; Cts -&gt; Cts
forall a b. (a -&gt; b) -&gt; Bag a -&gt; Bag b
</span><a href="GHC.Data.Bag.html#mapBag"><span class="hs-identifier hs-var">mapBag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv -&gt; Ct -&gt; Ct
</span><a href="GHC.Tc.Zonk.TcType.html#tidyCt"><span class="hs-identifier hs-var">tidyCt</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621683031736"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>   </span><span class="annot"><span class="annottext">Cts
</span><a href="#local-6989586621683031696"><span class="hs-identifier hs-var">simples</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>    </span><span id="local-6989586621683031704"><span class="annot"><span class="annottext">tidy_errs :: [DelayedError]
</span><a href="#local-6989586621683031704"><span class="hs-identifier hs-var hs-var">tidy_errs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bag DelayedError -&gt; [DelayedError]
forall a. Bag a -&gt; [a]
</span><a href="GHC.Data.Bag.html#bagToList"><span class="hs-identifier hs-var">bagToList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DelayedError -&gt; DelayedError)
-&gt; Bag DelayedError -&gt; Bag DelayedError
forall a b. (a -&gt; b) -&gt; Bag a -&gt; Bag b
</span><a href="GHC.Data.Bag.html#mapBag"><span class="hs-identifier hs-var">mapBag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv -&gt; DelayedError -&gt; DelayedError
</span><a href="GHC.Tc.Zonk.TcType.html#tidyDelayedError"><span class="hs-identifier hs-var">tidyDelayedError</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621683031736"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bag DelayedError
</span><a href="#local-6989586621683031700"><span class="hs-identifier hs-var">errs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>
</span><span id="line-577"></span><span>    </span><span class="annot"><a href="#local-6989586621683031713"><span class="hs-identifier hs-type">partition_errors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#DelayedError"><span class="hs-identifier hs-type">DelayedError</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Hole"><span class="hs-identifier hs-type">Hole</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Hole"><span class="hs-identifier hs-type">Hole</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#NotConcreteError"><span class="hs-identifier hs-type">NotConcreteError</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span>    </span><span id="local-6989586621683031713"><span class="annot"><span class="annottext">partition_errors :: [DelayedError] -&gt; ([Hole], [Hole], [NotConcreteError])
</span><a href="#local-6989586621683031713"><span class="hs-identifier hs-var hs-var">partition_errors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Hole]
-&gt; [Hole]
-&gt; [NotConcreteError]
-&gt; [DelayedError]
-&gt; ([Hole], [Hole], [NotConcreteError])
</span><a href="#local-6989586621683031741"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-579"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-580"></span><span>        </span><span id="local-6989586621683031741"><span class="annot"><span class="annottext">go :: [Hole]
-&gt; [Hole]
-&gt; [NotConcreteError]
-&gt; [DelayedError]
-&gt; ([Hole], [Hole], [NotConcreteError])
</span><a href="#local-6989586621683031741"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621683031742"><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031742"><span class="hs-identifier hs-var">out_of_scope</span></a></span></span><span> </span><span id="local-6989586621683031743"><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031743"><span class="hs-identifier hs-var">other_holes</span></a></span></span><span> </span><span id="local-6989586621683031744"><span class="annot"><span class="annottext">[NotConcreteError]
</span><a href="#local-6989586621683031744"><span class="hs-identifier hs-var">syn_eqs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-581"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031742"><span class="hs-identifier hs-var">out_of_scope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031743"><span class="hs-identifier hs-var">other_holes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NotConcreteError]
</span><a href="#local-6989586621683031744"><span class="hs-identifier hs-var">syn_eqs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>        </span><span class="annot"><a href="#local-6989586621683031741"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621683031745"><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031745"><span class="hs-identifier hs-var">es1</span></a></span></span><span> </span><span id="local-6989586621683031746"><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031746"><span class="hs-identifier hs-var">es2</span></a></span></span><span> </span><span id="local-6989586621683031747"><span class="annot"><span class="annottext">[NotConcreteError]
</span><a href="#local-6989586621683031747"><span class="hs-identifier hs-var">es3</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683031748"><span class="annot"><span class="annottext">DelayedError
</span><a href="#local-6989586621683031748"><span class="hs-identifier hs-var">err</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621683031749"><span class="annot"><span class="annottext">[DelayedError]
</span><a href="#local-6989586621683031749"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683031750"><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031750"><span class="hs-identifier hs-var">es1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031751"><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031751"><span class="hs-identifier hs-var">es2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031752"><span class="annot"><span class="annottext">[NotConcreteError]
</span><a href="#local-6989586621683031752"><span class="hs-identifier hs-var">es3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Hole]
-&gt; [Hole]
-&gt; [NotConcreteError]
-&gt; [DelayedError]
-&gt; ([Hole], [Hole], [NotConcreteError])
</span><a href="#local-6989586621683031741"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031745"><span class="hs-identifier hs-var">es1</span></a></span><span> </span><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031746"><span class="hs-identifier hs-var">es2</span></a></span><span> </span><span class="annot"><span class="annottext">[NotConcreteError]
</span><a href="#local-6989586621683031747"><span class="hs-identifier hs-var">es3</span></a></span><span> </span><span class="annot"><span class="annottext">[DelayedError]
</span><a href="#local-6989586621683031749"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-584"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DelayedError
</span><a href="#local-6989586621683031748"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-585"></span><span>              </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#DE_Hole"><span class="hs-identifier hs-type">DE_Hole</span></a></span><span> </span><span id="local-6989586621683031754"><span class="annot"><span class="annottext">Hole
</span><a href="#local-6989586621683031754"><span class="hs-identifier hs-var">hole</span></a></span></span><span>
</span><span id="line-586"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Hole -&gt; Bool
</span><a href="GHC.Tc.Types.Constraint.html#isOutOfScopeHole"><span class="hs-identifier hs-var">isOutOfScopeHole</span></a></span><span> </span><span class="annot"><span class="annottext">Hole
</span><a href="#local-6989586621683031754"><span class="hs-identifier hs-var">hole</span></a></span><span>
</span><span id="line-587"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hole
</span><a href="#local-6989586621683031754"><span class="hs-identifier hs-var">hole</span></a></span><span> </span><span class="annot"><span class="annottext">Hole -&gt; [Hole] -&gt; [Hole]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031750"><span class="hs-identifier hs-var">es1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031751"><span class="hs-identifier hs-var">es2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NotConcreteError]
</span><a href="#local-6989586621683031752"><span class="hs-identifier hs-var">es3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-589"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031750"><span class="hs-identifier hs-var">es1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Hole
</span><a href="#local-6989586621683031754"><span class="hs-identifier hs-var">hole</span></a></span><span> </span><span class="annot"><span class="annottext">Hole -&gt; [Hole] -&gt; [Hole]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031751"><span class="hs-identifier hs-var">es2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NotConcreteError]
</span><a href="#local-6989586621683031752"><span class="hs-identifier hs-var">es3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-590"></span><span>              </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#DE_NotConcrete"><span class="hs-identifier hs-type">DE_NotConcrete</span></a></span><span> </span><span id="local-6989586621683031757"><span class="annot"><span class="annottext">NotConcreteError
</span><a href="#local-6989586621683031757"><span class="hs-identifier hs-var">err</span></a></span></span><span>
</span><span id="line-591"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031750"><span class="hs-identifier hs-var">es1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031751"><span class="hs-identifier hs-var">es2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NotConcreteError
</span><a href="#local-6989586621683031757"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">NotConcreteError -&gt; [NotConcreteError] -&gt; [NotConcreteError]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[NotConcreteError]
</span><a href="#local-6989586621683031752"><span class="hs-identifier hs-var">es3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>
</span><span id="line-593"></span><span>      </span><span class="hs-comment">-- See Note [Suppressing confusing errors]</span><span>
</span><span id="line-594"></span><span>    </span><span class="annot"><a href="#local-6989586621683031722"><span class="hs-identifier hs-type">suppress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-595"></span><span>    </span><span id="local-6989586621683031722"><span class="annot"><span class="annottext">suppress :: ErrorItem -&gt; Bool
</span><a href="#local-6989586621683031722"><span class="hs-identifier hs-var hs-var">suppress</span></a></span></span><span> </span><span id="local-6989586621683031758"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031758"><span class="hs-identifier hs-var">item</span></a></span></span><span>
</span><span id="line-596"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CtFlavour
</span><a href="GHC.Tc.Types.Constraint.html#Wanted"><span class="hs-identifier hs-var">Wanted</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; CtFlavour
</span><a href="GHC.Tc.Errors.Types.html#ei_flavour"><span class="hs-identifier hs-var">ei_flavour</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031758"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-597"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Bool
</span><a href="#local-6989586621683031760"><span class="hs-identifier hs-var">is_ww_fundep_item</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031758"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-598"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-599"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-600"></span><span>
</span><span id="line-601"></span><span>    </span><span class="hs-comment">-- report1: ones that should *not* be suppressed by</span><span>
</span><span id="line-602"></span><span>    </span><span class="hs-comment">--          an insoluble somewhere else in the tree</span><span>
</span><span id="line-603"></span><span>    </span><span class="hs-comment">-- It's crucial that anything that is considered insoluble</span><span>
</span><span id="line-604"></span><span>    </span><span class="hs-comment">-- (see GHC.Tc.Utils.insolublWantedCt) is caught here, otherwise</span><span>
</span><span id="line-605"></span><span>    </span><span class="hs-comment">-- we might suppress its error message, and proceed on past</span><span>
</span><span id="line-606"></span><span>    </span><span class="hs-comment">-- type checking to get a Lint error later</span><span>
</span><span id="line-607"></span><span>    </span><span id="local-6989586621683031726"><span class="annot"><span class="annottext">report1 :: [ReporterSpec]
</span><a href="#local-6989586621683031726"><span class="hs-identifier hs-var hs-var">report1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;custom_error&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Pred -&gt; Bool
forall {p}. ErrorItem -&gt; p -&gt; Bool
</span><a href="#local-6989586621683031761"><span class="hs-identifier hs-var">is_user_type_error</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Reporter
</span><a href="GHC.Tc.Errors.html#mkUserTypeErrorReporter"><span class="hs-identifier hs-var">mkUserTypeErrorReporter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>                 </span><span class="hs-comment">-- (Handles TypeError and Unsatisfiable)</span><span>
</span><span id="line-609"></span><span>
</span><span id="line-610"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReporterSpec
</span><a href="#local-6989586621683031763"><span class="hs-identifier hs-var">given_eq_spec</span></a></span><span>
</span><span id="line-611"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;insoluble2&quot;</span></span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="annottext">ErrorItem -&gt; Pred -&gt; Bool
forall {p}. p -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031764"><span class="hs-identifier hs-var">utterly_wrong</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport)
-&gt; Reporter
</span><a href="GHC.Tc.Errors.html#mkGroupReporter"><span class="hs-identifier hs-var">mkGroupReporter</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="GHC.Tc.Errors.html#mkEqErr"><span class="hs-identifier hs-var">mkEqErr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;skolem eq1&quot;</span></span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="annottext">ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031767"><span class="hs-identifier hs-var">very_wrong</span></a></span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Reporter
</span><a href="GHC.Tc.Errors.html#mkSkolReporter"><span class="hs-identifier hs-var">mkSkolReporter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FixedRuntimeRep&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031769"><span class="hs-identifier hs-var">is_FRR</span></a></span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport)
-&gt; Reporter
</span><a href="GHC.Tc.Errors.html#mkGroupReporter"><span class="hs-identifier hs-var">mkGroupReporter</span></a></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt;
SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="GHC.Tc.Errors.html#mkFRRErr"><span class="hs-identifier hs-var">mkFRRErr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;skolem eq2&quot;</span></span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="annottext">ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031771"><span class="hs-identifier hs-var">skolem_eq</span></a></span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Reporter
</span><a href="GHC.Tc.Errors.html#mkSkolReporter"><span class="hs-identifier hs-var">mkSkolReporter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-615"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;non-tv eq&quot;</span></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">ErrorItem -&gt; Pred -&gt; Bool
forall {p}. p -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031772"><span class="hs-identifier hs-var">non_tv_eq</span></a></span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Reporter
</span><a href="GHC.Tc.Errors.html#mkSkolReporter"><span class="hs-identifier hs-var">mkSkolReporter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span>                  </span><span class="hs-comment">-- The only remaining equalities are alpha ~ ty,</span><span>
</span><span id="line-618"></span><span>                  </span><span class="hs-comment">-- where alpha is untouchable; and representational equalities</span><span>
</span><span id="line-619"></span><span>                  </span><span class="hs-comment">-- Prefer homogeneous equalities over hetero, because the</span><span>
</span><span id="line-620"></span><span>                  </span><span class="hs-comment">-- former might be holding up the latter.</span><span>
</span><span id="line-621"></span><span>                  </span><span class="hs-comment">-- See Note [Equalities with incompatible kinds] in GHC.Tc.Solver.Equality</span><span>
</span><span id="line-622"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Homo eqs&quot;</span></span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="annottext">ErrorItem -&gt; Pred -&gt; Bool
forall {p}. p -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031773"><span class="hs-identifier hs-var">is_homo_equality</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">(SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport)
-&gt; Reporter
</span><a href="GHC.Tc.Errors.html#mkGroupReporter"><span class="hs-identifier hs-var">mkGroupReporter</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="GHC.Tc.Errors.html#mkEqErr"><span class="hs-identifier hs-var">mkEqErr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-623"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Other eqs&quot;</span></span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031774"><span class="hs-identifier hs-var">is_equality</span></a></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">(SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport)
-&gt; Reporter
</span><a href="GHC.Tc.Errors.html#mkGroupReporter"><span class="hs-identifier hs-var">mkGroupReporter</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="GHC.Tc.Errors.html#mkEqErr"><span class="hs-identifier hs-var">mkEqErr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span>    </span><span class="hs-comment">-- report2: we suppress these if there are insolubles elsewhere in the tree</span><span>
</span><span id="line-627"></span><span>    </span><span id="local-6989586621683031730"><span class="annot"><span class="annottext">report2 :: [ReporterSpec]
</span><a href="#local-6989586621683031730"><span class="hs-identifier hs-var hs-var">report2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Implicit params&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031776"><span class="hs-identifier hs-var">is_ip</span></a></span><span class="hs-special">,</span><span>           </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport)
-&gt; Reporter
</span><a href="GHC.Tc.Errors.html#mkGroupReporter"><span class="hs-identifier hs-var">mkGroupReporter</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="GHC.Tc.Errors.html#mkIPErr"><span class="hs-identifier hs-var">mkIPErr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Irreds&quot;</span></span><span class="hs-special">,</span><span>          </span><span class="annot"><span class="annottext">ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031778"><span class="hs-identifier hs-var">is_irred</span></a></span><span class="hs-special">,</span><span>        </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport)
-&gt; Reporter
</span><a href="GHC.Tc.Errors.html#mkGroupReporter"><span class="hs-identifier hs-var">mkGroupReporter</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="GHC.Tc.Errors.html#mkIrredErr"><span class="hs-identifier hs-var">mkIrredErr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Dicts&quot;</span></span><span class="hs-special">,</span><span>           </span><span class="annot"><span class="annottext">ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031780"><span class="hs-identifier hs-var">is_dict</span></a></span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport)
-&gt; Reporter
</span><a href="GHC.Tc.Errors.html#mkGroupReporter"><span class="hs-identifier hs-var">mkGroupReporter</span></a></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt;
SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="GHC.Tc.Errors.html#mkDictErr"><span class="hs-identifier hs-var">mkDictErr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-630"></span><span>
</span><span id="line-631"></span><span>    </span><span class="hs-comment">-- report3: suppressed errors should be reported as categorized by either report1</span><span>
</span><span id="line-632"></span><span>    </span><span class="hs-comment">-- or report2. Keep this in sync with the suppress function above</span><span>
</span><span id="line-633"></span><span>    </span><span id="local-6989586621683031735"><span class="annot"><span class="annottext">report3 :: [(String, ErrorItem -&gt; p -&gt; Bool, Bool, Reporter)]
</span><a href="#local-6989586621683031735"><span class="hs-identifier hs-var hs-var">report3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wanted/wanted fundeps&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; p -&gt; Bool
forall {p}. ErrorItem -&gt; p -&gt; Bool
</span><a href="#local-6989586621683031782"><span class="hs-identifier hs-var">is_ww_fundep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport)
-&gt; Reporter
</span><a href="GHC.Tc.Errors.html#mkGroupReporter"><span class="hs-identifier hs-var">mkGroupReporter</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="GHC.Tc.Errors.html#mkEqErr"><span class="hs-identifier hs-var">mkEqErr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span>    </span><span class="hs-comment">-- rigid_nom_eq, rigid_nom_tv_eq,</span><span>
</span><span id="line-637"></span><span>    </span><span class="annot"><a href="#local-6989586621683031780"><span class="hs-identifier hs-type">is_dict</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683031774"><span class="hs-identifier hs-type">is_equality</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683031776"><span class="hs-identifier hs-type">is_ip</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683031769"><span class="hs-identifier hs-type">is_FRR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683031778"><span class="hs-identifier hs-type">is_irred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-638"></span><span>
</span><span id="line-639"></span><span>    </span><span id="local-6989586621683031783"><span class="annot"><span class="annottext">is_given_eq :: ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031783"><span class="hs-identifier hs-var hs-var">is_given_eq</span></a></span></span><span> </span><span id="local-6989586621683031784"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031784"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span id="local-6989586621683031785"><span class="annot"><span class="annottext">Pred
</span><a href="#local-6989586621683031785"><span class="hs-identifier hs-var">pred</span></a></span></span><span>
</span><span id="line-640"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CtFlavour
</span><a href="GHC.Tc.Types.Constraint.html#Given"><span class="hs-identifier hs-var">Given</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; CtFlavour
</span><a href="GHC.Tc.Errors.Types.html#ei_flavour"><span class="hs-identifier hs-var">ei_flavour</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031784"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-641"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html#EqPred"><span class="hs-identifier hs-type">EqPred</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pred
</span><a href="#local-6989586621683031785"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-642"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-643"></span><span>       </span><span class="hs-comment">-- I think all given residuals are equalities</span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span>    </span><span class="hs-comment">-- Things like (Int ~N Bool)</span><span>
</span><span id="line-646"></span><span>    </span><span id="local-6989586621683031764"><span class="annot"><span class="annottext">utterly_wrong :: p -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031764"><span class="hs-identifier hs-var hs-var">utterly_wrong</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Predicate.html#EqPred"><span class="hs-identifier hs-type">EqPred</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a></span><span> </span><span id="local-6989586621683031789"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031789"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621683031790"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031790"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isRigidTy"><span class="hs-identifier hs-var">isRigidTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031789"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isRigidTy"><span class="hs-identifier hs-var">isRigidTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031790"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-647"></span><span>    </span><span class="annot"><a href="#local-6989586621683031764"><span class="hs-identifier hs-var">utterly_wrong</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pred
</span><span class="hs-identifier">_</span></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-648"></span><span>
</span><span id="line-649"></span><span>    </span><span class="hs-comment">-- Things like (a ~N Int)</span><span>
</span><span id="line-650"></span><span>    </span><span id="local-6989586621683031767"><span class="annot"><span class="annottext">very_wrong :: ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031767"><span class="hs-identifier hs-var hs-var">very_wrong</span></a></span></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Predicate.html#EqPred"><span class="hs-identifier hs-type">EqPred</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a></span><span> </span><span id="local-6989586621683031793"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031793"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621683031794"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031794"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLevel -&gt; Type -&gt; Bool
</span><a href="GHC.Tc.Errors.html#isSkolemTy"><span class="hs-identifier hs-var">isSkolemTy</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621683031692"><span class="hs-identifier hs-var">tc_lvl</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031793"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isRigidTy"><span class="hs-identifier hs-var">isRigidTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031794"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-651"></span><span>    </span><span class="annot"><a href="#local-6989586621683031767"><span class="hs-identifier hs-var">very_wrong</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pred
</span><span class="hs-identifier">_</span></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-652"></span><span>
</span><span id="line-653"></span><span>    </span><span class="hs-comment">-- Representation-polymorphism errors, to be reported using mkFRRErr.</span><span>
</span><span id="line-654"></span><span>    </span><span id="local-6989586621683031769"><span class="annot"><span class="annottext">is_FRR :: ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031769"><span class="hs-identifier hs-var hs-var">is_FRR</span></a></span></span><span> </span><span id="local-6989586621683031796"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031796"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span class="annot"><span class="annottext">Pred
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FixedRuntimeRepErrorInfo -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe FixedRuntimeRepErrorInfo -&gt; Bool)
-&gt; Maybe FixedRuntimeRepErrorInfo -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; ErrorItem -&gt; Maybe FixedRuntimeRepErrorInfo
ErrorItem -&gt; Maybe FixedRuntimeRepErrorInfo
</span><a href="GHC.Tc.Errors.html#fixedRuntimeRepOrigin_maybe"><span class="hs-identifier hs-var">fixedRuntimeRepOrigin_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031796"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-655"></span><span>
</span><span id="line-656"></span><span>    </span><span class="hs-comment">-- Things like (a ~N b) or (a  ~N  F Bool)</span><span>
</span><span id="line-657"></span><span>    </span><span id="local-6989586621683031771"><span class="annot"><span class="annottext">skolem_eq :: ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031771"><span class="hs-identifier hs-var hs-var">skolem_eq</span></a></span></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Predicate.html#EqPred"><span class="hs-identifier hs-type">EqPred</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a></span><span> </span><span id="local-6989586621683031799"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031799"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLevel -&gt; Type -&gt; Bool
</span><a href="GHC.Tc.Errors.html#isSkolemTy"><span class="hs-identifier hs-var">isSkolemTy</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621683031692"><span class="hs-identifier hs-var">tc_lvl</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031799"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-658"></span><span>    </span><span class="annot"><a href="#local-6989586621683031771"><span class="hs-identifier hs-var">skolem_eq</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pred
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span>    </span><span class="hs-comment">-- Things like (F a  ~N  Int)</span><span>
</span><span id="line-661"></span><span>    </span><span id="local-6989586621683031772"><span class="annot"><span class="annottext">non_tv_eq :: p -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031772"><span class="hs-identifier hs-var hs-var">non_tv_eq</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Predicate.html#EqPred"><span class="hs-identifier hs-type">EqPred</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a></span><span> </span><span id="local-6989586621683031800"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031800"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTyVarTy"><span class="hs-identifier hs-var">isTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031800"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-662"></span><span>    </span><span class="annot"><a href="#local-6989586621683031772"><span class="hs-identifier hs-var">non_tv_eq</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pred
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-663"></span><span>
</span><span id="line-664"></span><span>    </span><span class="hs-comment">-- Catch TypeError and Unsatisfiable.</span><span>
</span><span id="line-665"></span><span>    </span><span class="hs-comment">-- Here, we want any nested TypeErrors to bubble up, so we use</span><span>
</span><span id="line-666"></span><span>    </span><span class="hs-comment">-- 'containsUserTypeError' and not 'isTopLevelUserTypeError'.</span><span>
</span><span id="line-667"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-668"></span><span>    </span><span class="hs-comment">-- See also Note [Implementation of Unsatisfiable constraints], point (F).</span><span>
</span><span id="line-669"></span><span>    </span><span id="local-6989586621683031761"><span class="annot"><span class="annottext">is_user_type_error :: ErrorItem -&gt; p -&gt; Bool
</span><a href="#local-6989586621683031761"><span class="hs-identifier hs-var hs-var">is_user_type_error</span></a></span></span><span> </span><span id="local-6989586621683031802"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031802"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Types.Constraint.html#containsUserTypeError"><span class="hs-identifier hs-var">containsUserTypeError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; Type
</span><a href="GHC.Tc.Errors.Types.html#errorItemPred"><span class="hs-identifier hs-var">errorItemPred</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031802"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>
</span><span id="line-671"></span><span>    </span><span id="local-6989586621683031773"><span class="annot"><span class="annottext">is_homo_equality :: p -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031773"><span class="hs-identifier hs-var hs-var">is_homo_equality</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Predicate.html#EqPred"><span class="hs-identifier hs-type">EqPred</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683031808"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031808"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621683031809"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031809"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-672"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031808"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#tcEqType"><span class="hs-operator hs-var">`tcEqType`</span></a></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031809"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-673"></span><span>    </span><span class="annot"><a href="#local-6989586621683031773"><span class="hs-identifier hs-var">is_homo_equality</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pred
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-674"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span>    </span><span id="local-6989586621683031774"><span class="annot"><span class="annottext">is_equality :: ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031774"><span class="hs-identifier hs-var hs-var">is_equality</span></a></span></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><span class="hs-identifier">_</span></span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Predicate.html#EqPred"><span class="hs-identifier hs-type">EqPred</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-677"></span><span>    </span><span class="annot"><a href="#local-6989586621683031774"><span class="hs-identifier hs-var">is_equality</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pred
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-678"></span><span>
</span><span id="line-679"></span><span>    </span><span id="local-6989586621683031780"><span class="annot"><span class="annottext">is_dict :: ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031780"><span class="hs-identifier hs-var hs-var">is_dict</span></a></span></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Predicate.html#ClassPred"><span class="hs-identifier hs-type">ClassPred</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-680"></span><span>    </span><span class="annot"><a href="#local-6989586621683031780"><span class="hs-identifier hs-var">is_dict</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pred
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-681"></span><span>
</span><span id="line-682"></span><span>    </span><span id="local-6989586621683031776"><span class="annot"><span class="annottext">is_ip :: ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031776"><span class="hs-identifier hs-var hs-var">is_ip</span></a></span></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Predicate.html#ClassPred"><span class="hs-identifier hs-type">ClassPred</span></a></span><span> </span><span id="local-6989586621683031813"><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621683031813"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Class -&gt; Bool
</span><a href="GHC.Core.Predicate.html#isIPClass"><span class="hs-identifier hs-var">isIPClass</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621683031813"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-683"></span><span>    </span><span class="annot"><a href="#local-6989586621683031776"><span class="hs-identifier hs-var">is_ip</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pred
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span>    </span><span id="local-6989586621683031778"><span class="annot"><span class="annottext">is_irred :: ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031778"><span class="hs-identifier hs-var hs-var">is_irred</span></a></span></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Predicate.html#IrredPred"><span class="hs-identifier hs-type">IrredPred</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-686"></span><span>    </span><span class="annot"><a href="#local-6989586621683031778"><span class="hs-identifier hs-var">is_irred</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pred
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-687"></span><span>
</span><span id="line-688"></span><span>     </span><span class="hs-comment">-- See situation (1) of Note [Suppressing confusing errors]</span><span>
</span><span id="line-689"></span><span>    </span><span id="local-6989586621683031782"><span class="annot"><span class="annottext">is_ww_fundep :: ErrorItem -&gt; p -&gt; Bool
</span><a href="#local-6989586621683031782"><span class="hs-identifier hs-var hs-var">is_ww_fundep</span></a></span></span><span> </span><span id="local-6989586621683031816"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031816"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Bool
</span><a href="#local-6989586621683031760"><span class="hs-identifier hs-var">is_ww_fundep_item</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031816"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-690"></span><span>    </span><span id="local-6989586621683031760"><span class="annot"><span class="annottext">is_ww_fundep_item :: ErrorItem -&gt; Bool
</span><a href="#local-6989586621683031760"><span class="hs-identifier hs-var hs-var">is_ww_fundep_item</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CtOrigin -&gt; Bool
</span><a href="GHC.Tc.Types.Origin.html#isWantedWantedFunDepOrigin"><span class="hs-identifier hs-var">isWantedWantedFunDepOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">(CtOrigin -&gt; Bool) -&gt; (ErrorItem -&gt; CtOrigin) -&gt; ErrorItem -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; CtOrigin
</span><a href="GHC.Tc.Errors.Types.html#errorItemOrigin"><span class="hs-identifier hs-var">errorItemOrigin</span></a></span><span>
</span><span id="line-691"></span><span>
</span><span id="line-692"></span><span>    </span><span id="local-6989586621683031763"><span class="annot"><span class="annottext">given_eq_spec :: ReporterSpec
</span><a href="#local-6989586621683031763"><span class="hs-identifier hs-var hs-var">given_eq_spec</span></a></span></span><span>  </span><span class="hs-comment">-- See Note [Given errors]</span><span>
</span><span id="line-693"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683031820"><span class="hs-identifier hs-var">has_gadt_match_here</span></a></span><span>
</span><span id="line-694"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;insoluble1a&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031783"><span class="hs-identifier hs-var">is_given_eq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Reporter
</span><a href="GHC.Tc.Errors.html#mkGivenErrorReporter"><span class="hs-identifier hs-var">mkGivenErrorReporter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-695"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-696"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;insoluble1b&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683031783"><span class="hs-identifier hs-var">is_given_eq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Reporter
</span><a href="GHC.Tc.Errors.html#ignoreErrorReporter"><span class="hs-identifier hs-var">ignoreErrorReporter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-697"></span><span>          </span><span class="hs-comment">-- False means don't suppress subsequent errors</span><span>
</span><span id="line-698"></span><span>          </span><span class="hs-comment">-- Reason: we don't report all given errors</span><span>
</span><span id="line-699"></span><span>          </span><span class="hs-comment">--         (see mkGivenErrorReporter), and we should only suppress</span><span>
</span><span id="line-700"></span><span>          </span><span class="hs-comment">--         subsequent errors if we actually report this one!</span><span>
</span><span id="line-701"></span><span>          </span><span class="hs-comment">--         #13446 is an example</span><span>
</span><span id="line-702"></span><span>
</span><span id="line-703"></span><span>    </span><span class="hs-comment">-- See Note [Given errors]</span><span>
</span><span id="line-704"></span><span>    </span><span id="local-6989586621683031820"><span class="annot"><span class="annottext">has_gadt_match_here :: Bool
</span><a href="#local-6989586621683031820"><span class="hs-identifier hs-var hs-var">has_gadt_match_here</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Implication] -&gt; Bool
</span><a href="#local-6989586621683031823"><span class="hs-identifier hs-var">has_gadt_match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; [Implication]
</span><a href="GHC.Tc.Errors.Types.html#cec_encl"><span class="hs-identifier hs-var">cec_encl</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031691"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>    </span><span id="local-6989586621683031823"><span class="annot"><span class="annottext">has_gadt_match :: [Implication] -&gt; Bool
</span><a href="#local-6989586621683031823"><span class="hs-identifier hs-var hs-var">has_gadt_match</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-706"></span><span>    </span><span class="annot"><a href="#local-6989586621683031823"><span class="hs-identifier hs-var">has_gadt_match</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683031825"><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683031825"><span class="hs-identifier hs-var">implic</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621683031826"><span class="annot"><span class="annottext">[Implication]
</span><a href="#local-6989586621683031826"><span class="hs-identifier hs-var">implics</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-707"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#PatSkol"><span class="hs-identifier hs-type">PatSkol</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Implication -&gt; SkolemInfoAnon
</span><a href="GHC.Tc.Types.Constraint.html#ic_info"><span class="hs-identifier hs-var">ic_info</span></a></span><span> </span><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683031825"><span class="hs-identifier hs-var">implic</span></a></span><span>
</span><span id="line-708"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Implication -&gt; HasGivenEqs
</span><a href="GHC.Tc.Types.Constraint.html#ic_given_eqs"><span class="hs-identifier hs-var">ic_given_eqs</span></a></span><span> </span><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683031825"><span class="hs-identifier hs-var">implic</span></a></span><span> </span><span class="annot"><span class="annottext">HasGivenEqs -&gt; HasGivenEqs -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">HasGivenEqs
</span><a href="GHC.Tc.Types.Constraint.html#NoGivenEqs"><span class="hs-identifier hs-var">NoGivenEqs</span></a></span><span>
</span><span id="line-709"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Implication -&gt; Bool
</span><a href="GHC.Tc.Types.Constraint.html#ic_warn_inaccessible"><span class="hs-identifier hs-var">ic_warn_inaccessible</span></a></span><span> </span><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683031825"><span class="hs-identifier hs-var">implic</span></a></span><span>
</span><span id="line-710"></span><span>          </span><span class="hs-comment">-- Don't bother doing this if -Winaccessible-code isn't enabled.</span><span>
</span><span id="line-711"></span><span>          </span><span class="hs-comment">-- See Note [Avoid -Winaccessible-code when deriving] in GHC.Tc.TyCl.Instance.</span><span>
</span><span id="line-712"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-713"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-714"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Implication] -&gt; Bool
</span><a href="#local-6989586621683031823"><span class="hs-identifier hs-var">has_gadt_match</span></a></span><span> </span><span class="annot"><span class="annottext">[Implication]
</span><a href="#local-6989586621683031826"><span class="hs-identifier hs-var">implics</span></a></span><span>
</span><span id="line-715"></span><span>
</span><span id="line-716"></span><span class="hs-comment">---------------</span><span>
</span><span id="line-717"></span><span class="annot"><a href="GHC.Tc.Errors.html#isSkolemTy"><span class="hs-identifier hs-type">isSkolemTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-718"></span><span class="hs-comment">-- The type is a skolem tyvar</span><span>
</span><span id="line-719"></span><span id="isSkolemTy"><span class="annot"><span class="annottext">isSkolemTy :: TcLevel -&gt; Type -&gt; Bool
</span><a href="GHC.Tc.Errors.html#isSkolemTy"><span class="hs-identifier hs-var hs-var">isSkolemTy</span></a></span></span><span> </span><span id="local-6989586621683031832"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621683031832"><span class="hs-identifier hs-var">tc_lvl</span></a></span></span><span> </span><span id="local-6989586621683031833"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031833"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-720"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683031834"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683031834"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TcId
</span><a href="GHC.Core.Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031833"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-721"></span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">TcId -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isSkolemTyVar"><span class="hs-identifier hs-var">isSkolemTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683031834"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-722"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isTyVarTyVar"><span class="hs-identifier hs-var">isTyVarTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683031834"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">TcLevel -&gt; TcId -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isTouchableMetaTyVar"><span class="hs-identifier hs-var">isTouchableMetaTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621683031832"><span class="hs-identifier hs-var">tc_lvl</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683031834"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-723"></span><span>     </span><span class="hs-comment">-- The last case is for touchable TyVarTvs</span><span>
</span><span id="line-724"></span><span>     </span><span class="hs-comment">-- we postpone untouchables to a latter test (too obscure)</span><span>
</span><span id="line-725"></span><span>
</span><span id="line-726"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-727"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-728"></span><span>
</span><span id="line-729"></span><span class="annot"><a href="GHC.Tc.Errors.html#isTyFun_maybe"><span class="hs-identifier hs-type">isTyFun_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-730"></span><span id="isTyFun_maybe"><span class="annot"><span class="annottext">isTyFun_maybe :: Type -&gt; Maybe TyCon
</span><a href="GHC.Tc.Errors.html#isTyFun_maybe"><span class="hs-identifier hs-var hs-var">isTyFun_maybe</span></a></span></span><span> </span><span id="local-6989586621683031840"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031840"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031840"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-731"></span><span>                      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683031842"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683031842"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTypeFamilyTyCon"><span class="hs-identifier hs-var">isTypeFamilyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683031842"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe TyCon
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683031842"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-732"></span><span>                      </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-733"></span><span>
</span><span id="line-734"></span><span class="hs-comment">{- Note [Suppressing confusing errors]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Certain errors we might encounter are potentially confusing to users.
If there are any other errors to report, at all, we want to suppress these.

Which errors (only 1 case right now):

1) Errors which arise from the interaction of two Wanted fun-dep constraints.
   Example:

     class C a b | a -&gt; b where
       op :: a -&gt; b -&gt; b

     foo _ = op True Nothing

     bar _ = op False []

   Here, we could infer
     foo :: C Bool (Maybe a) =&gt; p -&gt; Maybe a
     bar :: C Bool [a]       =&gt; p -&gt; [a]

   (The unused arguments suppress the monomorphism restriction.) The problem
   is that these types can't both be correct, as they violate the functional
   dependency. Yet reporting an error here is awkward: we must
   non-deterministically choose either foo or bar to reject. We thus want
   to report this problem only when there is nothing else to report.
   See typecheck/should_fail/T13506 for an example of when to suppress
   the error. The case above is actually accepted, because foo and bar
   are checked separately, and thus the two fundep constraints never
   encounter each other. It is test case typecheck/should_compile/FunDepOrigin1.

   This case applies only when both fundeps are *Wanted* fundeps; when
   both are givens, the error represents unreachable code. For
   a Given/Wanted case, see #9612.

Mechanism:

We use the `suppress` function within reportWanteds to filter out these two
cases, then report all other errors. Lastly, we return to these suppressed
ones and report them only if there have been no errors so far.

Note [Constraints to ignore]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Some constraints are meant only to aid the solver by unification; a failure
to solve them is not necessarily an error to report to the user. It is critical
that compilation is aborted elsewhere if there are any ignored constraints here;
they will remain unfilled, and might have been used to rewrite another constraint.

Currently, the constraints to ignore are:

1) Constraints generated in order to unify associated type instance parameters
   with class parameters. Here are two illustrative examples:

     class C (a :: k) where
       type F (b :: k)

     instance C True where
       type F a = Int

     instance C Left where
       type F (Left :: a -&gt; Either a b) = Bool

   In the first instance, we want to infer that `a` has type Bool. So we emit
   a constraint unifying kappa (the guessed type of `a`) with Bool. All is well.

   In the second instance, we process the associated type instance only
   after fixing the quantified type variables of the class instance. We thus
   have skolems a1 and b1 such that the class instance is for (Left :: a1 -&gt; Either a1 b1).
   Unifying a1 and b1 with a and b in the type instance will fail, but harmlessly so.
   checkConsistentFamInst checks for this, and will fail if anything has gone
   awry. Really the equality constraints emitted are just meant as an aid, not
   a requirement. This is test case T13972.

   We detect this case by looking for an origin of AssocFamPatOrigin; constraints
   with this origin are dropped entirely during error message reporting.

   If there is any trouble, checkValidFamInst bleats, aborting compilation.

Note [Implementation of Unsatisfiable constraints]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The Unsatisfiable constraint was introduced in GHC proposal #433 (https://github.com/ghc-proposals/ghc-proposals/blob/master/proposals/0433-unsatisfiable.rst).
See Note [The Unsatisfiable constraint] in GHC.TypeError.

Its implementation consists of the following:

  A. The definitions.

     The Unsatisfiable class is defined in GHC.TypeError, in base.
     It consists of the following definitions:

       type Unsatisfiable :: ErrorMessage -&gt; Constraint
       class Unsatisfiable msg where
         unsatisfiableLifted :: a

       unsatisfiable :: forall {rep} (msg :: ErrorMessage) (a :: TYPE rep). Unsatisfiable msg =&gt; a
       unsatisfiable = unsatisfiableLifted @msg @((##) -&gt; a) (##)

     The class TyCon as well as the unsatisfiable Id have known-key Names
     in GHC; they are not wired-in.

  B. Unsatisfiable instances.

     The Unsatisfiable typeclass has no instances (see GHC.Tc.Instance.Class.matchGlobalInst).

     Users are prevented from writing instances in GHC.Tc.Validity.check_special_inst_head.
     This is done using the same mechanism as for, say, Coercible or WithDict.

  C. Using [G] Unsatisfiable msg to solve any Wanted.

     In GHC.Tc.Solver.simplifyTopWanteds, after defaulting happens, when an
     implication contains Givens of the form [G] Unsatisfiable msg, and the
     implication supports term-level evidence (as per Note [Coercion evidence only]
     in GHC.Tc.Types.Evidence), we use any such Given to solve all the Wanteds
     in that implication. See GHC.Tc.Solver.useUnsatisfiableGivens.

     The way we construct the evidence terms is slightly complicated by
     Type vs Constraint considerations; see Note [Evidence terms from Unsatisfiable Givens]
     in GHC.Tc.Solver.

     The proposal explains why this happens after defaulting: if there are other
     ways to solve the Wanteds, we would prefer to use that, as that will make
     user programs &quot;as defined as possible&quot;.

     Wrinkle [Ambiguity]

       We also use an Unsatisfiable Given to solve Wanteds when performing an
       ambiguity check. See the call to &quot;useUnsatisfiableGivens&quot; in
       GHC.Tc.Solver.simplifyAmbiguityCheck.

       This is, for example, required to typecheck the definition
       of &quot;unsatisfiable&quot; itself:

         unsatisfiable :: forall {rep} (msg :: ErrorMessage) (a :: TYPE rep). Unsatisfiable msg =&gt; a

       The ambiguity check on this type signature will produce

         [G] Unsatisfiable msg1, [W] Unsatisfiable msg2

       and we want to ensure the Given solves the Wanted, to accept the definition.

       NB:

         An alternative would be to add a functional dependency on Unsatisfiable:

           class Unsatisfiable msg | -&gt; msg

         Then we would unify msg1 and msg2 in the above constraint solving problem,
         and would be able to solve the Wanted using the Given in the normal way.
         However, adding such a functional dependency solely for this purpose
         could have undesirable consequences. For example, one might have

           [W] Unsatisfiable (Text &quot;msg1&quot;), [W] Unsatisfiable (Text &quot;msg2&quot;)

         and W-W fundep interaction would produce the insoluble constraint

           [W] &quot;msg1&quot; ~ &quot;msg2&quot;

         which we definitely wouldn't want to report to the user.

  D. Adding &quot;meth = unsatisfiable @msg&quot; method bindings.

     When a class instance has an &quot;Unsatisfiable msg&quot; constraint in its context,
     and the user has omitted methods, we add method bindings of the form
     &quot;meth = unsatisfiable @msg&quot;.
     See GHC.Tc.TyCl.Instance.tcMethods, in particular &quot;tc_default&quot;.

     Example:

         class C a where { op :: a -&gt; a }
         instance Unsatisfiable Msg =&gt; C [a] where {}

       elaborates to

         instance Unsatisfiable Msg =&gt; C [a] where { op = unsatisfiable @Msg }

       due to the (Unsatisfiable Msg) constraint in the instance context.

     We also switch off the &quot;missing methods&quot; warning in this situation.
     See &quot;checkMinimalDefinition&quot; in GHC.Tc.TyCl.Instance.tcMethods.

     Note that we do this even when there is a default method available. This
     ensures we run into the unsatisfiable error message when deferring type
     errors; otherwise we could end up with a runtime loop as seen in #23816.

  E. Switching off functional dependency coverage checks when there is
     an &quot;Unsatisfiable msg&quot; context.

     This is because we want to allow users to rule out certain instances with
     an &quot;unsatisfiable&quot; error, even when that would violate a functional
     dependency. For example:

       class C a b | a -&gt; b
       instance Unsatisfiable (Text &quot;No&quot;) =&gt; C a b

     See GHC.Tc.Instance.FunDeps.checkInstCoverage.

  F. Error reporting of &quot;Unsatisfiable msg&quot; constraints.

     This is done in GHC.Tc.Errors.reportWanteds: we detect when a constraint
     is of the form &quot;Unsatisfiable msg&quot; and just emit the custom message
     as an error to the user.

     This is the only way that &quot;Unsatisfiable msg&quot; constraints are reported,
     which makes their behaviour much more predictable than TypeError.
-}</span><span>
</span><span id="line-939"></span><span>
</span><span id="line-940"></span><span>
</span><span id="line-941"></span><span class="hs-comment">--------------------------------------------</span><span>
</span><span id="line-942"></span><span class="hs-comment">--      Reporters</span><span>
</span><span id="line-943"></span><span class="hs-comment">--------------------------------------------</span><span>
</span><span id="line-944"></span><span>
</span><span id="line-945"></span><span class="hs-keyword">type</span><span> </span><span id="Reporter"><span class="annot"><a href="GHC.Tc.Errors.html#Reporter"><span class="hs-identifier hs-var">Reporter</span></a></span></span><span>
</span><span id="line-946"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-947"></span><span class="hs-keyword">type</span><span> </span><span id="ReporterSpec"><span class="annot"><a href="GHC.Tc.Errors.html#ReporterSpec"><span class="hs-identifier hs-var">ReporterSpec</span></a></span></span><span>
</span><span id="line-948"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                      </span><span class="hs-comment">-- Name</span><span>
</span><span id="line-949"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>  </span><span class="hs-comment">-- Pick these ones</span><span>
</span><span id="line-950"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>                        </span><span class="hs-comment">-- True &lt;=&gt; suppress subsequent reporters</span><span>
</span><span id="line-951"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#Reporter"><span class="hs-identifier hs-type">Reporter</span></a></span><span class="hs-special">)</span><span>                   </span><span class="hs-comment">-- The reporter itself</span><span>
</span><span id="line-952"></span><span>
</span><span id="line-953"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkSkolReporter"><span class="hs-identifier hs-type">mkSkolReporter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#Reporter"><span class="hs-identifier hs-type">Reporter</span></a></span><span>
</span><span id="line-954"></span><span class="hs-comment">-- Suppress duplicates with either the same LHS, or same location</span><span>
</span><span id="line-955"></span><span class="hs-comment">-- Pre-condition: all items are equalities</span><span>
</span><span id="line-956"></span><span id="mkSkolReporter"><span class="annot"><span class="annottext">mkSkolReporter :: Reporter
</span><a href="GHC.Tc.Errors.html#mkSkolReporter"><span class="hs-identifier hs-var hs-var">mkSkolReporter</span></a></span></span><span> </span><span id="local-6989586621683031844"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031844"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683031845"><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683031845"><span class="hs-identifier hs-var">items</span></a></span></span><span>
</span><span id="line-957"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NonEmpty ErrorItem -&gt; TcM ()) -&gt; [NonEmpty ErrorItem] -&gt; TcM ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport)
-&gt; Reporter
</span><a href="GHC.Tc.Errors.html#reportGroup"><span class="hs-identifier hs-var">reportGroup</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="GHC.Tc.Errors.html#mkEqErr"><span class="hs-identifier hs-var">mkEqErr</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031844"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ErrorItem] -&gt; [NonEmpty ErrorItem]
</span><a href="#local-6989586621683031848"><span class="hs-identifier hs-var">group</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty ErrorItem -&gt; [ErrorItem]
forall a. NonEmpty a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683031845"><span class="hs-identifier hs-var">items</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-958"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-959"></span><span>     </span><span id="local-6989586621683031848"><span class="annot"><span class="annottext">group :: [ErrorItem] -&gt; [NonEmpty ErrorItem]
</span><a href="#local-6989586621683031848"><span class="hs-identifier hs-var hs-var">group</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-960"></span><span>     </span><span class="annot"><a href="#local-6989586621683031848"><span class="hs-identifier hs-var">group</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683031849"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031849"><span class="hs-identifier hs-var">item</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621683031850"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683031850"><span class="hs-identifier hs-var">items</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031849"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; [ErrorItem] -&gt; NonEmpty ErrorItem
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683031852"><span class="hs-identifier hs-var">yeses</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem -&gt; [NonEmpty ErrorItem] -&gt; [NonEmpty ErrorItem]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[ErrorItem] -&gt; [NonEmpty ErrorItem]
</span><a href="#local-6989586621683031848"><span class="hs-identifier hs-var">group</span></a></span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683031853"><span class="hs-identifier hs-var">noes</span></a></span><span>
</span><span id="line-961"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-962"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621683031852"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683031852"><span class="hs-identifier hs-var">yeses</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031853"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683031853"><span class="hs-identifier hs-var">noes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ErrorItem -&gt; Bool) -&gt; [ErrorItem] -&gt; ([ErrorItem], [ErrorItem])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; ErrorItem -&gt; Bool
</span><a href="#local-6989586621683031854"><span class="hs-identifier hs-var">group_with</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031849"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683031850"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-963"></span><span>
</span><span id="line-964"></span><span>     </span><span id="local-6989586621683031854"><span class="annot"><span class="annottext">group_with :: ErrorItem -&gt; ErrorItem -&gt; Bool
</span><a href="#local-6989586621683031854"><span class="hs-identifier hs-var hs-var">group_with</span></a></span></span><span> </span><span id="local-6989586621683031855"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031855"><span class="hs-identifier hs-var">item1</span></a></span></span><span> </span><span id="local-6989586621683031856"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031856"><span class="hs-identifier hs-var">item2</span></a></span></span><span>
</span><span id="line-965"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; ErrorItem -&gt; Ordering
</span><a href="GHC.Tc.Errors.html#cmp_loc"><span class="hs-identifier hs-var">cmp_loc</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031855"><span class="hs-identifier hs-var">item1</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031856"><span class="hs-identifier hs-var">item2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-966"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; ErrorItem -&gt; Bool
</span><a href="GHC.Tc.Errors.html#eq_lhs_type"><span class="hs-identifier hs-var">eq_lhs_type</span></a></span><span>   </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031855"><span class="hs-identifier hs-var">item1</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031856"><span class="hs-identifier hs-var">item2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-967"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-968"></span><span>
</span><span id="line-969"></span><span class="annot"><a href="GHC.Tc.Errors.html#reportHoles"><span class="hs-identifier hs-type">reportHoles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- other (tidied) constraints</span><span>
</span><span id="line-970"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Hole"><span class="hs-identifier hs-type">Hole</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-971"></span><span id="reportHoles"><span class="annot"><span class="annottext">reportHoles :: [ErrorItem] -&gt; SolverReportErrCtxt -&gt; [Hole] -&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#reportHoles"><span class="hs-identifier hs-var hs-var">reportHoles</span></a></span></span><span> </span><span id="local-6989586621683031859"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683031859"><span class="hs-identifier hs-var">tidy_items</span></a></span></span><span> </span><span id="local-6989586621683031860"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031860"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683031861"><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031861"><span class="hs-identifier hs-var">holes</span></a></span></span><span>
</span><span id="line-972"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-973"></span><span>      </span><span id="local-6989586621683031862"><span class="annot"><a href="#local-6989586621683031862"><span class="hs-identifier hs-var">diag_opts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; DiagOpts
</span><a href="GHC.Driver.Config.Diagnostic.html#initDiagOpts"><span class="hs-identifier hs-var">initDiagOpts</span></a></span><span> </span><span class="annot"><span class="annottext">(DynFlags -&gt; DiagOpts)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) DynFlags
-&gt; IOEnv (Env TcGblEnv TcLclEnv) DiagOpts
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-974"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683031866"><span class="annot"><a href="#local-6989586621683031866"><span class="hs-identifier hs-var hs-var">severity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiagOpts -&gt; DiagnosticReason -&gt; Severity
</span><a href="GHC.Utils.Error.html#diagReasonSeverity"><span class="hs-identifier hs-var">diagReasonSeverity</span></a></span><span> </span><span class="annot"><span class="annottext">DiagOpts
</span><a href="#local-6989586621683031862"><span class="hs-identifier hs-var">diag_opts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; DiagnosticReason
</span><a href="GHC.Tc.Errors.Types.html#cec_type_holes"><span class="hs-identifier hs-var">cec_type_holes</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031860"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-975"></span><span>          </span><span id="local-6989586621683031867"><span class="annot"><a href="#local-6989586621683031867"><span class="hs-identifier hs-var hs-var">holes'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Hole -&gt; Bool) -&gt; [Hole] -&gt; [Hole]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Severity -&gt; Hole -&gt; Bool
</span><a href="GHC.Tc.Errors.html#keepThisHole"><span class="hs-identifier hs-var">keepThisHole</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="#local-6989586621683031866"><span class="hs-identifier hs-var">severity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Hole]
</span><a href="#local-6989586621683031861"><span class="hs-identifier hs-var">holes</span></a></span><span>
</span><span id="line-976"></span><span>      </span><span class="hs-comment">-- Zonk and tidy all the TcLclEnvs before calling `mkHoleError`</span><span>
</span><span id="line-977"></span><span>      </span><span class="hs-comment">-- because otherwise types will be zonked and tidied many times over.</span><span>
</span><span id="line-978"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621683031869"><span class="annot"><a href="#local-6989586621683031869"><span class="hs-identifier hs-var">tidy_env'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031870"><span class="annot"><a href="#local-6989586621683031870"><span class="hs-identifier hs-var">lcl_name_cache</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#liftZonkM"><span class="hs-identifier hs-type">liftZonkM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-979"></span><span>        </span><span class="annot"><a href="GHC.Tc.Errors.html#zonkTidyTcLclEnvs"><span class="hs-identifier hs-type">zonkTidyTcLclEnvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_tidy"><span class="hs-identifier hs-var">cec_tidy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031860"><span class="hs-identifier hs-type">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.CtLoc.html#ctl_env"><span class="hs-identifier hs-var">ctl_env</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#hole_loc"><span class="hs-identifier hs-var">hole_loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683031867"><span class="hs-identifier hs-type">holes'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-980"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683031874"><span class="annot"><a href="#local-6989586621683031874"><span class="hs-identifier hs-var hs-var">ctxt'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031860"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_tidy"><span class="hs-identifier hs-var">cec_tidy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683031869"><span class="hs-identifier hs-type">tidy_env'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-981"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">forM_</span></span><span> </span><span class="annot"><a href="#local-6989586621683031867"><span class="hs-identifier hs-type">holes'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621683031875"><span class="annot"><span class="annottext">Hole
</span><a href="#local-6989586621683031875"><span class="hs-identifier hs-var">hole</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683031876"><span class="annot"><a href="#local-6989586621683031876"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameEnv Type
-&gt; [ErrorItem]
-&gt; SolverReportErrCtxt
-&gt; Hole
-&gt; TcM (MsgEnvelope TcRnMessage)
</span><a href="GHC.Tc.Errors.html#mkHoleError"><span class="hs-identifier hs-var">mkHoleError</span></a></span><span> </span><span class="annot"><span class="annottext">NameEnv Type
</span><a href="#local-6989586621683031870"><span class="hs-identifier hs-var">lcl_name_cache</span></a></span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683031859"><span class="hs-identifier hs-var">tidy_items</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031874"><span class="hs-identifier hs-var">ctxt'</span></a></span><span> </span><span class="annot"><span class="annottext">Hole
</span><a href="#local-6989586621683031875"><span class="hs-identifier hs-var">hole</span></a></span><span>
</span><span id="line-982"></span><span>                                 </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#reportDiagnostic"><span class="hs-identifier hs-type">reportDiagnostic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031876"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-983"></span><span>
</span><span id="line-984"></span><span class="annot"><a href="GHC.Tc.Errors.html#keepThisHole"><span class="hs-identifier hs-type">keepThisHole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#Severity"><span class="hs-identifier hs-type">Severity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Hole"><span class="hs-identifier hs-type">Hole</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-985"></span><span class="hs-comment">-- See Note [Skip type holes rapidly]</span><span>
</span><span id="line-986"></span><span id="keepThisHole"><span class="annot"><span class="annottext">keepThisHole :: Severity -&gt; Hole -&gt; Bool
</span><a href="GHC.Tc.Errors.html#keepThisHole"><span class="hs-identifier hs-var hs-var">keepThisHole</span></a></span></span><span> </span><span id="local-6989586621683031878"><span class="annot"><span class="annottext">Severity
</span><a href="#local-6989586621683031878"><span class="hs-identifier hs-var">sev</span></a></span></span><span> </span><span id="local-6989586621683031879"><span class="annot"><span class="annottext">Hole
</span><a href="#local-6989586621683031879"><span class="hs-identifier hs-var">hole</span></a></span></span><span>
</span><span id="line-987"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Hole -&gt; HoleSort
</span><a href="GHC.Tc.Types.Constraint.html#hole_sort"><span class="hs-identifier hs-var">hole_sort</span></a></span><span> </span><span class="annot"><span class="annottext">Hole
</span><a href="#local-6989586621683031879"><span class="hs-identifier hs-var">hole</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-988"></span><span>       </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#ExprHole"><span class="hs-identifier hs-type">ExprHole</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-989"></span><span>       </span><span class="annot"><span class="annottext">HoleSort
</span><a href="GHC.Tc.Types.Constraint.html#TypeHole"><span class="hs-identifier hs-var">TypeHole</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683031883"><span class="hs-identifier hs-var">keep_type_hole</span></a></span><span>
</span><span id="line-990"></span><span>       </span><span class="annot"><span class="annottext">HoleSort
</span><a href="GHC.Tc.Types.Constraint.html#ConstraintHole"><span class="hs-identifier hs-var">ConstraintHole</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683031883"><span class="hs-identifier hs-var">keep_type_hole</span></a></span><span>
</span><span id="line-991"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-992"></span><span>    </span><span id="local-6989586621683031883"><span class="annot"><span class="annottext">keep_type_hole :: Bool
</span><a href="#local-6989586621683031883"><span class="hs-identifier hs-var hs-var">keep_type_hole</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="#local-6989586621683031878"><span class="hs-identifier hs-var">sev</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-993"></span><span>                         </span><span class="annot"><span class="annottext">Severity
</span><a href="GHC.Types.Error.html#SevIgnore"><span class="hs-identifier hs-var">SevIgnore</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-994"></span><span>                         </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-995"></span><span>
</span><span id="line-996"></span><span class="hs-comment">-- | zonkTidyTcLclEnvs takes a bunch of 'CtLocEnv's, each from a Hole.</span><span>
</span><span id="line-997"></span><span class="hs-comment">-- It returns a ('Name' :-&gt; 'Type') mapping which gives the zonked, tidied</span><span>
</span><span id="line-998"></span><span class="hs-comment">-- type for each Id in any of the binder stacks in the  'CtLocEnv's.</span><span>
</span><span id="line-999"></span><span class="hs-comment">-- Since there is a huge overlap between these stacks, is is much,</span><span>
</span><span id="line-1000"></span><span class="hs-comment">-- much faster to do them all at once, avoiding duplication.</span><span>
</span><span id="line-1001"></span><span class="annot"><a href="GHC.Tc.Errors.html#zonkTidyTcLclEnvs"><span class="hs-identifier hs-type">zonkTidyTcLclEnvs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Types.CtLoc.html#CtLocEnv"><span class="hs-identifier hs-type">CtLocEnv</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Zonk.Monad.html#ZonkM"><span class="hs-identifier hs-type">ZonkM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1002"></span><span id="zonkTidyTcLclEnvs"><span class="annot"><span class="annottext">zonkTidyTcLclEnvs :: TidyEnv -&gt; [CtLocEnv] -&gt; ZonkM (TidyEnv, NameEnv Type)
</span><a href="GHC.Tc.Errors.html#zonkTidyTcLclEnvs"><span class="hs-identifier hs-var hs-var">zonkTidyTcLclEnvs</span></a></span></span><span> </span><span id="local-6989586621683031887"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621683031887"><span class="hs-identifier hs-var">tidy_env</span></a></span></span><span> </span><span id="local-6989586621683031888"><span class="annot"><span class="annottext">[CtLocEnv]
</span><a href="#local-6989586621683031888"><span class="hs-identifier hs-var">lcls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TidyEnv, NameEnv Type)
 -&gt; TcBinder -&gt; ZonkM (TidyEnv, NameEnv Type))
-&gt; (TidyEnv, NameEnv Type)
-&gt; [TcBinder]
-&gt; ZonkM (TidyEnv, NameEnv Type)
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="annot"><span class="annottext">(TidyEnv, NameEnv Type)
-&gt; TcBinder -&gt; ZonkM (TidyEnv, NameEnv Type)
</span><a href="#local-6989586621683031889"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621683031887"><span class="hs-identifier hs-var">tidy_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NameEnv Type
forall a. NameEnv a
</span><a href="GHC.Types.Name.Env.html#emptyNameEnv"><span class="hs-identifier hs-var">emptyNameEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CtLocEnv -&gt; [TcBinder]) -&gt; [CtLocEnv] -&gt; [TcBinder]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">CtLocEnv -&gt; [TcBinder]
</span><a href="GHC.Tc.Types.CtLoc.html#ctl_bndrs"><span class="hs-identifier hs-var">ctl_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">[CtLocEnv]
</span><a href="#local-6989586621683031888"><span class="hs-identifier hs-var">lcls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1003"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1004"></span><span>    </span><span id="local-6989586621683031889"><span class="annot"><span class="annottext">go :: (TidyEnv, NameEnv Type)
-&gt; TcBinder -&gt; ZonkM (TidyEnv, NameEnv Type)
</span><a href="#local-6989586621683031889"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621683031899"><span class="annot"><span class="annottext">(TidyEnv, NameEnv Type)
</span><a href="#local-6989586621683031899"><span class="hs-identifier hs-var">envs</span></a></span></span><span> </span><span id="local-6989586621683031900"><span class="annot"><span class="annottext">TcBinder
</span><a href="#local-6989586621683031900"><span class="hs-identifier hs-var">tc_bndr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TcBinder
</span><a href="#local-6989586621683031900"><span class="hs-identifier hs-var">tc_bndr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1005"></span><span>          </span><span class="annot"><a href="GHC.Tc.Types.BasicTypes.html#TcTvBndr"><span class="hs-identifier hs-type">TcTvBndr</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TidyEnv, NameEnv Type) -&gt; ZonkM (TidyEnv, NameEnv Type)
forall a. a -&gt; ZonkM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TidyEnv, NameEnv Type)
</span><a href="#local-6989586621683031899"><span class="hs-identifier hs-var">envs</span></a></span><span>
</span><span id="line-1006"></span><span>          </span><span class="annot"><a href="GHC.Tc.Types.BasicTypes.html#TcIdBndr"><span class="hs-identifier hs-type">TcIdBndr</span></a></span><span> </span><span id="local-6989586621683031903"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683031903"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span id="local-6989586621683031904"><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621683031904"><span class="hs-identifier hs-var">_top_lvl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Type -&gt; (TidyEnv, NameEnv Type) -&gt; ZonkM (TidyEnv, NameEnv Type)
</span><a href="#local-6989586621683031905"><span class="hs-identifier hs-var">go_one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683031903"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; Type
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683031903"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TidyEnv, NameEnv Type)
</span><a href="#local-6989586621683031899"><span class="hs-identifier hs-var">envs</span></a></span><span>
</span><span id="line-1007"></span><span>          </span><span class="annot"><a href="GHC.Tc.Types.BasicTypes.html#TcIdBndr_ExpType"><span class="hs-identifier hs-type">TcIdBndr_ExpType</span></a></span><span> </span><span id="local-6989586621683031909"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683031909"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621683031910"><span class="annot"><span class="annottext">ExpType
</span><a href="#local-6989586621683031910"><span class="hs-identifier hs-var">et</span></a></span></span><span> </span><span id="local-6989586621683031911"><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621683031911"><span class="hs-identifier hs-var">_top_lvl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1008"></span><span>            </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683031912"><span class="annot"><a href="#local-6989586621683031912"><span class="hs-identifier hs-var">mb_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Type) -&gt; ZonkM (Maybe Type)
forall a. IO a -&gt; ZonkM a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Type) -&gt; ZonkM (Maybe Type))
-&gt; IO (Maybe Type) -&gt; ZonkM (Maybe Type)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExpType -&gt; IO (Maybe Type)
forall (m :: * -&gt; *). MonadIO m =&gt; ExpType -&gt; m (Maybe Type)
</span><a href="GHC.Tc.Utils.TcMType.html#readExpType_maybe"><span class="hs-identifier hs-var">readExpType_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">ExpType
</span><a href="#local-6989586621683031910"><span class="hs-identifier hs-var">et</span></a></span><span>
</span><span id="line-1009"></span><span>                   </span><span class="hs-comment">-- et really should be filled in by now. But there's a chance</span><span>
</span><span id="line-1010"></span><span>                   </span><span class="hs-comment">-- it hasn't, if, say, we're reporting a kind error en route to</span><span>
</span><span id="line-1011"></span><span>                   </span><span class="hs-comment">-- checking a term. See test indexed-types/should_fail/T8129</span><span>
</span><span id="line-1012"></span><span>                   </span><span class="hs-comment">-- Or we are reporting errors from the ambiguity check on</span><span>
</span><span id="line-1013"></span><span>                   </span><span class="hs-comment">-- a local type signature</span><span>
</span><span id="line-1014"></span><span>               </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621683031912"><span class="hs-identifier hs-type">mb_ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1015"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683031915"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031915"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Type -&gt; (TidyEnv, NameEnv Type) -&gt; ZonkM (TidyEnv, NameEnv Type)
</span><a href="#local-6989586621683031905"><span class="hs-identifier hs-var">go_one</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683031909"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031915"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">(TidyEnv, NameEnv Type)
</span><a href="#local-6989586621683031899"><span class="hs-identifier hs-var">envs</span></a></span><span>
</span><span id="line-1016"></span><span>                   </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TidyEnv, NameEnv Type) -&gt; ZonkM (TidyEnv, NameEnv Type)
forall a. a -&gt; ZonkM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TidyEnv, NameEnv Type)
</span><a href="#local-6989586621683031899"><span class="hs-identifier hs-var">envs</span></a></span><span>
</span><span id="line-1017"></span><span>               </span><span class="hs-special">}</span><span>
</span><span id="line-1018"></span><span>    </span><span id="local-6989586621683031905"><span class="annot"><span class="annottext">go_one :: Name
-&gt; Type -&gt; (TidyEnv, NameEnv Type) -&gt; ZonkM (TidyEnv, NameEnv Type)
</span><a href="#local-6989586621683031905"><span class="hs-identifier hs-var hs-var">go_one</span></a></span></span><span> </span><span id="local-6989586621683031919"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683031919"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621683031920"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031920"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683031921"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621683031921"><span class="hs-identifier hs-var">tidy_env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031922"><span class="annot"><span class="annottext">NameEnv Type
</span><a href="#local-6989586621683031922"><span class="hs-identifier hs-var">name_env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1019"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683031919"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; NameEnv Type -&gt; Bool
forall a. Name -&gt; NameEnv a -&gt; Bool
</span><a href="GHC.Types.Name.Env.html#elemNameEnv"><span class="hs-operator hs-var">`elemNameEnv`</span></a></span><span> </span><span class="annot"><span class="annottext">NameEnv Type
</span><a href="#local-6989586621683031922"><span class="hs-identifier hs-var">name_env</span></a></span><span>
</span><span id="line-1020"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(TidyEnv, NameEnv Type) -&gt; ZonkM (TidyEnv, NameEnv Type)
forall a. a -&gt; ZonkM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621683031921"><span class="hs-identifier hs-var">tidy_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NameEnv Type
</span><a href="#local-6989586621683031922"><span class="hs-identifier hs-var">name_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1021"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1022"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621683031924"><span class="annot"><a href="#local-6989586621683031924"><span class="hs-identifier hs-var">tidy_env'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031925"><span class="annot"><a href="#local-6989586621683031925"><span class="hs-identifier hs-var">tidy_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; Type -&gt; ZonkM (TidyEnv, Type)
</span><a href="GHC.Tc.Zonk.TcType.html#zonkTidyTcType"><span class="hs-identifier hs-var">zonkTidyTcType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621683031921"><span class="hs-identifier hs-var">tidy_env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031920"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1023"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683031924"><span class="hs-identifier hs-type">tidy_env'</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><a href="GHC.Types.Name.Env.html#extendNameEnv"><span class="hs-identifier hs-type">extendNameEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031922"><span class="hs-identifier hs-type">name_env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031919"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031925"><span class="hs-identifier hs-type">tidy_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1024"></span><span>
</span><span id="line-1025"></span><span class="annot"><a href="GHC.Tc.Errors.html#reportNotConcreteErrs"><span class="hs-identifier hs-type">reportNotConcreteErrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#NotConcreteError"><span class="hs-identifier hs-type">NotConcreteError</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1026"></span><span id="reportNotConcreteErrs"><span class="annot"><span class="annottext">reportNotConcreteErrs :: SolverReportErrCtxt -&gt; [NotConcreteError] -&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#reportNotConcreteErrs"><span class="hs-identifier hs-var hs-var">reportNotConcreteErrs</span></a></span></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcM ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1027"></span><span class="annot"><a href="GHC.Tc.Errors.html#reportNotConcreteErrs"><span class="hs-identifier hs-var">reportNotConcreteErrs</span></a></span><span> </span><span id="local-6989586621683031928"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031928"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683031929"><span class="annot"><span class="annottext">errs :: [NotConcreteError]
</span><a href="#local-6989586621683031929"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621683031930"><span class="annot"><span class="annottext">NotConcreteError
</span><a href="#local-6989586621683031930"><span class="hs-identifier hs-var">err0</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[NotConcreteError]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1028"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683031931"><span class="annot"><a href="#local-6989586621683031931"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CtLocEnv
-&gt; TcRnMessage
-&gt; Maybe SolverReportErrCtxt
-&gt; [SolverReportSupplementary]
-&gt; TcM (MsgEnvelope TcRnMessage)
</span><a href="GHC.Tc.Errors.html#mkErrorReport"><span class="hs-identifier hs-var">mkErrorReport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CtLoc -&gt; CtLocEnv
</span><a href="GHC.Tc.Types.CtLoc.html#ctLocEnv"><span class="hs-identifier hs-var">ctLocEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NotConcreteError -&gt; CtLoc
</span><a href="GHC.Tc.Types.Constraint.html#nce_loc"><span class="hs-identifier hs-var">nce_loc</span></a></span><span> </span><span class="annot"><span class="annottext">NotConcreteError
</span><a href="#local-6989586621683031930"><span class="hs-identifier hs-var">err0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TcRnMessage
</span><a href="#local-6989586621683031934"><span class="hs-identifier hs-var">diag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; Maybe SolverReportErrCtxt
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031928"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1029"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#reportDiagnostic"><span class="hs-identifier hs-type">reportDiagnostic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031931"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1030"></span><span>
</span><span id="line-1031"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1032"></span><span>
</span><span id="line-1033"></span><span>    </span><span id="local-6989586621683031935"><span class="annot"><span class="annottext">frr_origins :: [FixedRuntimeRepErrorInfo]
</span><a href="#local-6989586621683031935"><span class="hs-identifier hs-var hs-var">frr_origins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[NotConcreteError] -&gt; [FixedRuntimeRepErrorInfo]
</span><a href="#local-6989586621683031936"><span class="hs-identifier hs-var">acc_errors</span></a></span><span> </span><span class="annot"><span class="annottext">[NotConcreteError]
</span><a href="#local-6989586621683031929"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-1034"></span><span>    </span><span id="local-6989586621683031934"><span class="annot"><span class="annottext">diag :: TcRnMessage
</span><a href="#local-6989586621683031934"><span class="hs-identifier hs-var hs-var">diag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportWithCtxt -&gt; DiagnosticReason -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnSolverReport"><span class="hs-identifier hs-var">TcRnSolverReport</span></a></span><span>
</span><span id="line-1035"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TcSolverReportMsg -&gt; SolverReportWithCtxt
</span><a href="GHC.Tc.Errors.Types.html#SolverReportWithCtxt"><span class="hs-identifier hs-var">SolverReportWithCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031928"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FixedRuntimeRepErrorInfo] -&gt; TcSolverReportMsg
</span><a href="GHC.Tc.Errors.Types.html#FixedRuntimeRepError"><span class="hs-identifier hs-var">FixedRuntimeRepError</span></a></span><span> </span><span class="annot"><span class="annottext">[FixedRuntimeRepErrorInfo]
</span><a href="#local-6989586621683031935"><span class="hs-identifier hs-var">frr_origins</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1036"></span><span>             </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-var">ErrorWithoutFlag</span></a></span><span>
</span><span id="line-1037"></span><span>
</span><span id="line-1038"></span><span>    </span><span class="hs-comment">-- Accumulate the different kind of errors arising from syntactic equality.</span><span>
</span><span id="line-1039"></span><span>    </span><span class="hs-comment">-- (Only SynEq_FRR origin for the moment.)</span><span>
</span><span id="line-1040"></span><span>    </span><span id="local-6989586621683031936"><span class="annot"><span class="annottext">acc_errors :: [NotConcreteError] -&gt; [FixedRuntimeRepErrorInfo]
</span><a href="#local-6989586621683031936"><span class="hs-identifier hs-var hs-var">acc_errors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FixedRuntimeRepErrorInfo]
-&gt; [NotConcreteError] -&gt; [FixedRuntimeRepErrorInfo]
</span><a href="#local-6989586621683031938"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1041"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1042"></span><span>        </span><span id="local-6989586621683031938"><span class="annot"><span class="annottext">go :: [FixedRuntimeRepErrorInfo]
-&gt; [NotConcreteError] -&gt; [FixedRuntimeRepErrorInfo]
</span><a href="#local-6989586621683031938"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621683031939"><span class="annot"><span class="annottext">[FixedRuntimeRepErrorInfo]
</span><a href="#local-6989586621683031939"><span class="hs-identifier hs-var">frr_errs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FixedRuntimeRepErrorInfo]
</span><a href="#local-6989586621683031939"><span class="hs-identifier hs-var">frr_errs</span></a></span><span>
</span><span id="line-1043"></span><span>        </span><span class="annot"><a href="#local-6989586621683031938"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621683031940"><span class="annot"><span class="annottext">[FixedRuntimeRepErrorInfo]
</span><a href="#local-6989586621683031940"><span class="hs-identifier hs-var">frr_errs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683031941"><span class="annot"><span class="annottext">NotConcreteError
</span><a href="#local-6989586621683031941"><span class="hs-identifier hs-var">err</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621683031942"><span class="annot"><span class="annottext">[NotConcreteError]
</span><a href="#local-6989586621683031942"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1044"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621683031943"><span class="annot"><span class="annottext">[FixedRuntimeRepErrorInfo]
</span><a href="#local-6989586621683031943"><span class="hs-identifier hs-var">frr_errs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[FixedRuntimeRepErrorInfo]
-&gt; [NotConcreteError] -&gt; [FixedRuntimeRepErrorInfo]
</span><a href="#local-6989586621683031938"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[FixedRuntimeRepErrorInfo]
</span><a href="#local-6989586621683031940"><span class="hs-identifier hs-var">frr_errs</span></a></span><span> </span><span class="annot"><span class="annottext">[NotConcreteError]
</span><a href="#local-6989586621683031942"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-1045"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NotConcreteError
</span><a href="#local-6989586621683031941"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1046"></span><span>              </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#NCE_FRR"><span class="hs-identifier hs-type">NCE_FRR</span></a></span><span>
</span><span id="line-1047"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">nce_frr_origin :: NotConcreteError -&gt; FixedRuntimeRepOrigin
</span><a href="GHC.Tc.Types.Constraint.html#nce_frr_origin"><span class="hs-identifier hs-var">nce_frr_origin</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031946"><span class="annot"><span class="annottext">FixedRuntimeRepOrigin
</span><a href="#local-6989586621683031946"><span class="hs-identifier hs-var">frr_orig</span></a></span></span><span>
</span><span id="line-1048"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nce_reasons :: NotConcreteError -&gt; NonEmpty NotConcreteReason
</span><a href="GHC.Tc.Types.Constraint.html#nce_reasons"><span class="hs-identifier hs-var">nce_reasons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683031948"><span class="annot"><span class="annottext">NonEmpty NotConcreteReason
</span><a href="#local-6989586621683031948"><span class="hs-identifier hs-var">_not_conc</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1049"></span><span>                </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#FRR_Info"><span class="hs-identifier hs-type">FRR_Info</span></a></span><span>
</span><span id="line-1050"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">frr_info_origin :: FixedRuntimeRepOrigin
</span><a href="GHC.Tc.Errors.Types.html#frr_info_origin"><span class="hs-identifier hs-var">frr_info_origin</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepOrigin
</span><a href="#local-6989586621683031946"><span class="hs-identifier hs-var">frr_orig</span></a></span><span>
</span><span id="line-1051"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">frr_info_not_concrete :: Maybe (TcId, Type)
</span><a href="GHC.Tc.Errors.Types.html#frr_info_not_concrete"><span class="hs-identifier hs-var">frr_info_not_concrete</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TcId, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1052"></span><span>                </span><span class="annot"><span class="annottext">FixedRuntimeRepErrorInfo
-&gt; [FixedRuntimeRepErrorInfo] -&gt; [FixedRuntimeRepErrorInfo]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[FixedRuntimeRepErrorInfo]
</span><a href="#local-6989586621683031943"><span class="hs-identifier hs-var">frr_errs</span></a></span><span>
</span><span id="line-1053"></span><span>
</span><span id="line-1054"></span><span class="hs-comment">{- Note [Skip type holes rapidly]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Suppose we have module with a /lot/ of partial type signatures, and we
compile it while suppressing partial-type-signature warnings.  Then
we don't want to spend ages constructing error messages and lists of
relevant bindings that we never display! This happened in #14766, in
which partial type signatures in a Happy-generated parser cause a huge
increase in compile time.

The function ignoreThisHole short-circuits the error/warning generation
machinery, in cases where it is definitely going to be a no-op.
-}</span><span>
</span><span id="line-1066"></span><span>
</span><span id="line-1067"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkUserTypeErrorReporter"><span class="hs-identifier hs-type">mkUserTypeErrorReporter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#Reporter"><span class="hs-identifier hs-type">Reporter</span></a></span><span>
</span><span id="line-1068"></span><span id="mkUserTypeErrorReporter"><span class="annot"><span class="annottext">mkUserTypeErrorReporter :: Reporter
</span><a href="GHC.Tc.Errors.html#mkUserTypeErrorReporter"><span class="hs-identifier hs-var hs-var">mkUserTypeErrorReporter</span></a></span></span><span> </span><span id="local-6989586621683031952"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031952"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>
</span><span id="line-1069"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ErrorItem -&gt; TcM ()) -&gt; NonEmpty ErrorItem -&gt; TcM ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">((ErrorItem -&gt; TcM ()) -&gt; NonEmpty ErrorItem -&gt; TcM ())
-&gt; (ErrorItem -&gt; TcM ()) -&gt; NonEmpty ErrorItem -&gt; TcM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621683031953"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031953"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683031954"><span class="annot"><span class="annottext">err :: SolverReport
</span><a href="#local-6989586621683031954"><span class="hs-identifier hs-var hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TcSolverReportMsg -&gt; SolverReport
</span><a href="GHC.Tc.Errors.html#important"><span class="hs-identifier hs-var">important</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031952"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(TcSolverReportMsg -&gt; SolverReport)
-&gt; TcSolverReportMsg -&gt; SolverReport
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; TcSolverReportMsg
</span><a href="GHC.Tc.Errors.html#mkUserTypeError"><span class="hs-identifier hs-var">mkUserTypeError</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031953"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-1070"></span><span>                        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; SolverReport -&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#maybeReportError"><span class="hs-identifier hs-var">maybeReportError</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031952"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031953"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; [ErrorItem] -&gt; NonEmpty ErrorItem
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SolverReport
</span><a href="#local-6989586621683031954"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-1071"></span><span>                        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; SolverReport -&gt; ErrorItem -&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#addDeferredBinding"><span class="hs-identifier hs-var">addDeferredBinding</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031952"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReport
</span><a href="#local-6989586621683031954"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031953"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1072"></span><span>
</span><span id="line-1073"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkUserTypeError"><span class="hs-identifier hs-type">mkUserTypeError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcSolverReportMsg"><span class="hs-identifier hs-type">TcSolverReportMsg</span></a></span><span>
</span><span id="line-1074"></span><span id="mkUserTypeError"><span class="annot"><span class="annottext">mkUserTypeError :: ErrorItem -&gt; TcSolverReportMsg
</span><a href="GHC.Tc.Errors.html#mkUserTypeError"><span class="hs-identifier hs-var hs-var">mkUserTypeError</span></a></span></span><span> </span><span id="local-6989586621683031958"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031958"><span class="hs-identifier hs-var">item</span></a></span></span><span>
</span><span id="line-1075"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683031959"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031959"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Tc.Types.Constraint.html#getUserTypeErrorMsg"><span class="hs-identifier hs-var">getUserTypeErrorMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031961"><span class="hs-identifier hs-var">pty</span></a></span><span>
</span><span id="line-1076"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TcSolverReportMsg
</span><a href="GHC.Tc.Errors.Types.html#UserTypeError"><span class="hs-identifier hs-var">UserTypeError</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031959"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-1077"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683031963"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031963"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Tc.Types.Constraint.html#isUnsatisfiableCt_maybe"><span class="hs-identifier hs-var">isUnsatisfiableCt_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031961"><span class="hs-identifier hs-var">pty</span></a></span><span>
</span><span id="line-1078"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TcSolverReportMsg
</span><a href="GHC.Tc.Errors.Types.html#UnsatisfiableError"><span class="hs-identifier hs-var">UnsatisfiableError</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031963"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-1079"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1080"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcSolverReportMsg
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkUserTypeError&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031958"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1081"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1082"></span><span>    </span><span id="local-6989586621683031961"><span class="annot"><span class="annottext">pty :: Type
</span><a href="#local-6989586621683031961"><span class="hs-identifier hs-var hs-var">pty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Type
</span><a href="GHC.Tc.Errors.Types.html#errorItemPred"><span class="hs-identifier hs-var">errorItemPred</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031958"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-1083"></span><span>
</span><span id="line-1084"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkGivenErrorReporter"><span class="hs-identifier hs-type">mkGivenErrorReporter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#Reporter"><span class="hs-identifier hs-type">Reporter</span></a></span><span>
</span><span id="line-1085"></span><span class="hs-comment">-- See Note [Given errors]</span><span>
</span><span id="line-1086"></span><span id="mkGivenErrorReporter"><span class="annot"><span class="annottext">mkGivenErrorReporter :: Reporter
</span><a href="GHC.Tc.Errors.html#mkGivenErrorReporter"><span class="hs-identifier hs-var hs-var">mkGivenErrorReporter</span></a></span></span><span> </span><span id="local-6989586621683031966"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031966"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683031967"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031967"><span class="hs-identifier hs-var">item</span></a></span></span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span class="annot"><span class="annottext">[ErrorItem]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1087"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683031968"><span class="annot"><a href="#local-6989586621683031968"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031969"><span class="annot"><a href="#local-6989586621683031969"><span class="hs-identifier hs-var">relevant_binds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031970"><span class="annot"><a href="#local-6989586621683031970"><span class="hs-identifier hs-var">item</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; SolverReportErrCtxt
-&gt; ErrorItem
-&gt; TcM (SolverReportErrCtxt, RelevantBindings, ErrorItem)
</span><a href="GHC.Tc.Errors.html#relevantBindings"><span class="hs-identifier hs-var">relevantBindings</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031966"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031967"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-1088"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683031972"><span class="annot"><a href="#local-6989586621683031972"><span class="hs-identifier hs-var">implic</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_encl"><span class="hs-identifier hs-var">cec_encl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031968"><span class="hs-identifier hs-type">ctxt</span></a></span><span>
</span><span id="line-1089"></span><span>                 </span><span class="hs-comment">-- Always non-empty when mkGivenErrorReporter is called</span><span>
</span><span id="line-1090"></span><span>             </span><span id="local-6989586621683031973"><span class="annot"><a href="#local-6989586621683031973"><span class="hs-identifier hs-var hs-var">loc'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CtLoc -&gt; CtLocEnv -&gt; CtLoc
</span><a href="GHC.Tc.Types.CtLoc.html#setCtLocEnv"><span class="hs-identifier hs-var">setCtLocEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; CtLoc
</span><a href="GHC.Tc.Errors.Types.html#ei_loc"><span class="hs-identifier hs-var">ei_loc</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031970"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Implication -&gt; CtLocEnv
</span><a href="GHC.Tc.Types.Constraint.html#ic_env"><span class="hs-identifier hs-var">ic_env</span></a></span><span> </span><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683031972"><span class="hs-identifier hs-var">implic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1091"></span><span>             </span><span id="local-6989586621683031975"><span class="annot"><a href="#local-6989586621683031975"><span class="hs-identifier hs-var hs-var">item'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031970"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ei_loc"><span class="hs-identifier hs-var">ei_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683031973"><span class="hs-identifier hs-type">loc'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1092"></span><span>                   </span><span class="hs-comment">-- For given constraints we overwrite the env (and hence src-loc)</span><span>
</span><span id="line-1093"></span><span>                   </span><span class="hs-comment">-- with one from the immediately-enclosing implication.</span><span>
</span><span id="line-1094"></span><span>                   </span><span class="hs-comment">-- See Note [Inaccessible code]</span><span>
</span><span id="line-1095"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683031976"><span class="annot"><a href="#local-6989586621683031976"><span class="hs-identifier hs-var">eq_err_msg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#mkEqErr_help"><span class="hs-identifier hs-type">mkEqErr_help</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031968"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031975"><span class="hs-identifier hs-type">item'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031978"><span class="hs-identifier hs-type">ty1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031979"><span class="hs-identifier hs-type">ty2</span></a></span><span>
</span><span id="line-1096"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683031980"><span class="annot"><a href="#local-6989586621683031980"><span class="hs-identifier hs-var hs-var">supplementary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">RelevantBindings -&gt; SolverReportSupplementary
</span><a href="GHC.Tc.Errors.Types.html#SupplementaryBindings"><span class="hs-identifier hs-var">SupplementaryBindings</span></a></span><span> </span><span class="annot"><span class="annottext">RelevantBindings
</span><a href="#local-6989586621683031969"><span class="hs-identifier hs-var">relevant_binds</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1097"></span><span>             </span><span id="local-6989586621683031981"><span class="annot"><a href="#local-6989586621683031981"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Implication -&gt; SolverReportWithCtxt -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnInaccessibleCode"><span class="hs-identifier hs-var">TcRnInaccessibleCode</span></a></span><span> </span><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683031972"><span class="hs-identifier hs-var">implic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TcSolverReportMsg -&gt; SolverReportWithCtxt
</span><a href="GHC.Tc.Errors.Types.html#SolverReportWithCtxt"><span class="hs-identifier hs-var">SolverReportWithCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031968"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">TcSolverReportMsg
</span><a href="#local-6989586621683031976"><span class="hs-identifier hs-var">eq_err_msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1098"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683031983"><span class="annot"><a href="#local-6989586621683031983"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#mkErrorReport"><span class="hs-identifier hs-type">mkErrorReport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.CtLoc.html#ctLocEnv"><span class="hs-identifier hs-type">ctLocEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031973"><span class="hs-identifier hs-type">loc'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683031981"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621683031968"><span class="hs-identifier hs-type">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683031980"><span class="hs-identifier hs-type">supplementary</span></a></span><span>
</span><span id="line-1099"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#reportDiagnostic"><span class="hs-identifier hs-type">reportDiagnostic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683031983"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1100"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1101"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621683031978"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031978"><span class="hs-identifier hs-var">ty1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683031979"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031979"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type, Type)
</span><a href="GHC.Core.Predicate.html#getEqPredTys"><span class="hs-identifier hs-var">getEqPredTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; Type
</span><a href="GHC.Tc.Errors.Types.html#errorItemPred"><span class="hs-identifier hs-var">errorItemPred</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031967"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1102"></span><span>
</span><span id="line-1103"></span><span class="annot"><a href="GHC.Tc.Errors.html#ignoreErrorReporter"><span class="hs-identifier hs-type">ignoreErrorReporter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#Reporter"><span class="hs-identifier hs-type">Reporter</span></a></span><span>
</span><span id="line-1104"></span><span class="hs-comment">-- Discard Given errors that don't come from</span><span>
</span><span id="line-1105"></span><span class="hs-comment">-- a pattern match; maybe we should warn instead?</span><span>
</span><span id="line-1106"></span><span id="ignoreErrorReporter"><span class="annot"><span class="annottext">ignoreErrorReporter :: Reporter
</span><a href="GHC.Tc.Errors.html#ignoreErrorReporter"><span class="hs-identifier hs-var hs-var">ignoreErrorReporter</span></a></span></span><span> </span><span id="local-6989586621683031985"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031985"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683031986"><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683031986"><span class="hs-identifier hs-var">items</span></a></span></span><span>
</span><span id="line-1107"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkGivenErrorReporter no&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty ErrorItem -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683031986"><span class="hs-identifier hs-var">items</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[Implication] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; [Implication]
</span><a href="GHC.Tc.Errors.Types.html#cec_encl"><span class="hs-identifier hs-var">cec_encl</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031985"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1108"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcM ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1109"></span><span>
</span><span id="line-1110"></span><span>
</span><span id="line-1111"></span><span class="hs-comment">{- Note [Given errors]
~~~~~~~~~~~~~~~~~~~~~~
Given constraints represent things for which we have (or will have)
evidence, so they aren't errors.  But if a Given constraint is
insoluble, this code is inaccessible, and we might want to at least
warn about that.  A classic case is

   data T a where
     T1 :: T Int
     T2 :: T a
     T3 :: T Bool

   f :: T Int -&gt; Bool
   f T1 = ...
   f T2 = ...
   f T3 = ...  -- We want to report this case as inaccessible

We'd like to point out that the T3 match is inaccessible. It
will have a Given constraint [G] Int ~ Bool.

But we don't want to report ALL insoluble Given constraints.  See Trac
#12466 for a long discussion.  For example, if we aren't careful
we'll complain about
   f :: ((Int ~ Bool) =&gt; a -&gt; a) -&gt; Int
which arguably is OK.  It's more debatable for
   g :: (Int ~ Bool) =&gt; Int -&gt; Int
but it's tricky to distinguish these cases so we don't report
either.

The bottom line is this: has_gadt_match looks for an enclosing
pattern match which binds some equality constraints.  If we
find one, we report the insoluble Given.
-}</span><span>
</span><span id="line-1144"></span><span>
</span><span id="line-1145"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkGroupReporter"><span class="hs-identifier hs-type">mkGroupReporter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1146"></span><span>                             </span><span class="hs-comment">-- Make error message for a group</span><span>
</span><span id="line-1147"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#Reporter"><span class="hs-identifier hs-type">Reporter</span></a></span><span>  </span><span class="hs-comment">-- Deal with lots of constraints</span><span>
</span><span id="line-1148"></span><span class="hs-comment">-- Group together errors from same location,</span><span>
</span><span id="line-1149"></span><span class="hs-comment">-- and report only the first (to avoid a cascade)</span><span>
</span><span id="line-1150"></span><span id="mkGroupReporter"><span class="annot"><span class="annottext">mkGroupReporter :: (SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport)
-&gt; Reporter
</span><a href="GHC.Tc.Errors.html#mkGroupReporter"><span class="hs-identifier hs-var hs-var">mkGroupReporter</span></a></span></span><span> </span><span id="local-6989586621683031987"><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="#local-6989586621683031987"><span class="hs-identifier hs-var">mk_err</span></a></span></span><span> </span><span id="local-6989586621683031988"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031988"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683031989"><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683031989"><span class="hs-identifier hs-var">items</span></a></span></span><span>
</span><span id="line-1151"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NonEmpty ErrorItem -&gt; TcM ()) -&gt; [NonEmpty ErrorItem] -&gt; TcM ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport)
-&gt; Reporter
</span><a href="GHC.Tc.Errors.html#reportGroup"><span class="hs-identifier hs-var">reportGroup</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="#local-6989586621683031987"><span class="hs-identifier hs-var">mk_err</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683031988"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ErrorItem -&gt; ErrorItem -&gt; Ordering)
-&gt; [ErrorItem] -&gt; [NonEmpty ErrorItem]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [NonEmpty a]
</span><a href="GHC.Data.List.SetOps.html#equivClasses"><span class="hs-identifier hs-var">equivClasses</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; ErrorItem -&gt; Ordering
</span><a href="GHC.Tc.Errors.html#cmp_loc"><span class="hs-identifier hs-var">cmp_loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty ErrorItem -&gt; [ErrorItem]
forall a. NonEmpty a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683031989"><span class="hs-identifier hs-var">items</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1152"></span><span>
</span><span id="line-1153"></span><span class="annot"><a href="GHC.Tc.Errors.html#eq_lhs_type"><span class="hs-identifier hs-type">eq_lhs_type</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1154"></span><span id="eq_lhs_type"><span class="annot"><span class="annottext">eq_lhs_type :: ErrorItem -&gt; ErrorItem -&gt; Bool
</span><a href="GHC.Tc.Errors.html#eq_lhs_type"><span class="hs-identifier hs-var hs-var">eq_lhs_type</span></a></span></span><span> </span><span id="local-6989586621683031990"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031990"><span class="hs-identifier hs-var">item1</span></a></span></span><span> </span><span id="local-6989586621683031991"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031991"><span class="hs-identifier hs-var">item2</span></a></span></span><span>
</span><span id="line-1155"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Pred
</span><a href="GHC.Core.Predicate.html#classifyPredType"><span class="hs-identifier hs-var">classifyPredType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; Type
</span><a href="GHC.Tc.Errors.Types.html#errorItemPred"><span class="hs-identifier hs-var">errorItemPred</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031990"><span class="hs-identifier hs-var">item1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pred
</span><a href="GHC.Core.Predicate.html#classifyPredType"><span class="hs-identifier hs-var">classifyPredType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; Type
</span><a href="GHC.Tc.Errors.Types.html#errorItemPred"><span class="hs-identifier hs-var">errorItemPred</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031991"><span class="hs-identifier hs-var">item2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1156"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Predicate.html#EqPred"><span class="hs-identifier hs-type">EqPred</span></a></span><span> </span><span id="local-6989586621683031993"><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621683031993"><span class="hs-identifier hs-var">eq_rel1</span></a></span></span><span> </span><span id="local-6989586621683031994"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031994"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html#EqPred"><span class="hs-identifier hs-type">EqPred</span></a></span><span> </span><span id="local-6989586621683031995"><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621683031995"><span class="hs-identifier hs-var">eq_rel2</span></a></span></span><span> </span><span id="local-6989586621683031996"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031996"><span class="hs-identifier hs-var">ty2</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1157"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621683031993"><span class="hs-identifier hs-var">eq_rel1</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; EqRel -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621683031995"><span class="hs-identifier hs-var">eq_rel2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031994"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683031996"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1158"></span><span>       </span><span class="annot"><span class="annottext">(Pred, Pred)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Bool
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkSkolReporter&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031990"><span class="hs-identifier hs-var">item1</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031991"><span class="hs-identifier hs-var">item2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1159"></span><span>
</span><span id="line-1160"></span><span class="annot"><a href="GHC.Tc.Errors.html#cmp_loc"><span class="hs-identifier hs-type">cmp_loc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span>
</span><span id="line-1161"></span><span id="cmp_loc"><span class="annot"><span class="annottext">cmp_loc :: ErrorItem -&gt; ErrorItem -&gt; Ordering
</span><a href="GHC.Tc.Errors.html#cmp_loc"><span class="hs-identifier hs-var hs-var">cmp_loc</span></a></span></span><span> </span><span id="local-6989586621683031998"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031998"><span class="hs-identifier hs-var">item1</span></a></span></span><span> </span><span id="local-6989586621683031999"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031999"><span class="hs-identifier hs-var">item2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; RealSrcLoc
</span><a href="#local-6989586621683032000"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031998"><span class="hs-identifier hs-var">item1</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcLoc -&gt; RealSrcLoc -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; RealSrcLoc
</span><a href="#local-6989586621683032000"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683031999"><span class="hs-identifier hs-var">item2</span></a></span><span>
</span><span id="line-1162"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1163"></span><span>    </span><span id="local-6989586621683032000"><span class="annot"><span class="annottext">get :: ErrorItem -&gt; RealSrcLoc
</span><a href="#local-6989586621683032000"><span class="hs-identifier hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621683032002"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032002"><span class="hs-identifier hs-var">ei</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RealSrcSpan -&gt; RealSrcLoc
</span><a href="GHC.Types.SrcLoc.html#realSrcSpanStart"><span class="hs-identifier hs-var">realSrcSpanStart</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CtLoc -&gt; RealSrcSpan
</span><a href="GHC.Tc.Types.CtLoc.html#ctLocSpan"><span class="hs-identifier hs-var">ctLocSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; CtLoc
</span><a href="GHC.Tc.Errors.Types.html#errorItemCtLoc"><span class="hs-identifier hs-var">errorItemCtLoc</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032002"><span class="hs-identifier hs-var">ei</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1164"></span><span>             </span><span class="hs-comment">-- Reduce duplication by reporting only one error from each</span><span>
</span><span id="line-1165"></span><span>             </span><span class="hs-comment">-- /starting/ location even if the end location differs</span><span>
</span><span id="line-1166"></span><span>
</span><span id="line-1167"></span><span class="annot"><a href="GHC.Tc.Errors.html#reportGroup"><span class="hs-identifier hs-type">reportGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#Reporter"><span class="hs-identifier hs-type">Reporter</span></a></span><span>
</span><span id="line-1168"></span><span id="reportGroup"><span class="annot"><span class="annottext">reportGroup :: (SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport)
-&gt; Reporter
</span><a href="GHC.Tc.Errors.html#reportGroup"><span class="hs-identifier hs-var hs-var">reportGroup</span></a></span></span><span> </span><span id="local-6989586621683032006"><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="#local-6989586621683032006"><span class="hs-identifier hs-var">mk_err</span></a></span></span><span> </span><span id="local-6989586621683032007"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032007"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032008"><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683032008"><span class="hs-identifier hs-var">items</span></a></span></span><span>
</span><span id="line-1169"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683032009"><span class="annot"><a href="#local-6989586621683032009"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="#local-6989586621683032006"><span class="hs-identifier hs-var">mk_err</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032007"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683032008"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-1170"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-type">traceTc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;About to maybeReportErr&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1171"></span><span>         </span><span class="annot"><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Constraint:&quot;</span></span><span>             </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032008"><span class="hs-identifier hs-type">items</span></a></span><span>
</span><span id="line-1172"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;cec_suppress =&quot;</span></span><span>          </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_suppress"><span class="hs-identifier hs-var">cec_suppress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032007"><span class="hs-identifier hs-type">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1173"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;cec_defer_type_errors =&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_defer_type_errors"><span class="hs-identifier hs-var">cec_defer_type_errors</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032007"><span class="hs-identifier hs-type">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1174"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#maybeReportError"><span class="hs-identifier hs-type">maybeReportError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032007"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032008"><span class="hs-identifier hs-type">items</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032009"><span class="hs-identifier hs-type">err</span></a></span><span>
</span><span id="line-1175"></span><span>           </span><span class="hs-comment">-- But see Note [Always warn with -fdefer-type-errors]</span><span>
</span><span id="line-1176"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-type">traceTc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;reportGroup&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032008"><span class="hs-identifier hs-type">items</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1177"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.html#addDeferredBinding"><span class="hs-identifier hs-type">addDeferredBinding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032007"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032009"><span class="hs-identifier hs-type">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683032008"><span class="hs-identifier hs-type">items</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1178"></span><span>           </span><span class="hs-comment">-- Add deferred bindings for all</span><span>
</span><span id="line-1179"></span><span>           </span><span class="hs-comment">-- Redundant if we are going to abort compilation,</span><span>
</span><span id="line-1180"></span><span>           </span><span class="hs-comment">-- but that's hard to know for sure, and if we don't</span><span>
</span><span id="line-1181"></span><span>           </span><span class="hs-comment">-- abort, we need bindings for all (e.g. #12156)</span><span>
</span><span id="line-1182"></span><span>
</span><span id="line-1183"></span><span class="hs-comment">-- See Note [No deferring for multiplicity errors]</span><span>
</span><span id="line-1184"></span><span class="annot"><a href="GHC.Tc.Errors.html#nonDeferrableOrigin"><span class="hs-identifier hs-type">nonDeferrableOrigin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#CtOrigin"><span class="hs-identifier hs-type">CtOrigin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1185"></span><span id="nonDeferrableOrigin"><span class="annot"><span class="annottext">nonDeferrableOrigin :: CtOrigin -&gt; Bool
</span><a href="GHC.Tc.Errors.html#nonDeferrableOrigin"><span class="hs-identifier hs-var hs-var">nonDeferrableOrigin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Origin.html#NonLinearPatternOrigin"><span class="hs-identifier hs-type">NonLinearPatternOrigin</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1186"></span><span class="annot"><a href="GHC.Tc.Errors.html#nonDeferrableOrigin"><span class="hs-identifier hs-var">nonDeferrableOrigin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Origin.html#OmittedFieldOrigin"><span class="hs-identifier hs-type">OmittedFieldOrigin</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1187"></span><span class="annot"><a href="GHC.Tc.Errors.html#nonDeferrableOrigin"><span class="hs-identifier hs-var">nonDeferrableOrigin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Origin.html#UsageEnvironmentOf"><span class="hs-identifier hs-type">UsageEnvironmentOf</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1188"></span><span class="annot"><a href="GHC.Tc.Errors.html#nonDeferrableOrigin"><span class="hs-identifier hs-var">nonDeferrableOrigin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Origin.html#FRROrigin"><span class="hs-identifier hs-type">FRROrigin</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1189"></span><span class="annot"><a href="GHC.Tc.Errors.html#nonDeferrableOrigin"><span class="hs-identifier hs-var">nonDeferrableOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">CtOrigin
</span><span class="hs-identifier">_</span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1190"></span><span>
</span><span id="line-1191"></span><span class="annot"><a href="GHC.Tc.Errors.html#maybeReportError"><span class="hs-identifier hs-type">maybeReportError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span>
</span><span id="line-1192"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span>     </span><span class="hs-comment">-- items covered by the Report</span><span>
</span><span id="line-1193"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1194"></span><span id="maybeReportError"><span class="annot"><span class="annottext">maybeReportError :: SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; SolverReport -&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#maybeReportError"><span class="hs-identifier hs-var hs-var">maybeReportError</span></a></span></span><span> </span><span id="local-6989586621683032015"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032015"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032016"><span class="annot"><span class="annottext">items :: NonEmpty ErrorItem
</span><a href="#local-6989586621683032016"><span class="hs-identifier hs-var">items</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621683032017"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032017"><span class="hs-identifier hs-var">item1</span></a></span></span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span class="annot"><span class="annottext">[ErrorItem]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sr_important_msg :: SolverReport -&gt; SolverReportWithCtxt
</span><a href="GHC.Tc.Errors.Types.html#sr_important_msg"><span class="hs-identifier hs-var">sr_important_msg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032018"><span class="annot"><span class="annottext">SolverReportWithCtxt
</span><a href="#local-6989586621683032018"><span class="hs-identifier hs-var">important</span></a></span></span><span>
</span><span id="line-1195"></span><span>                                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sr_supplementary :: SolverReport -&gt; [SolverReportSupplementary]
</span><a href="GHC.Tc.Errors.Types.html#sr_supplementary"><span class="hs-identifier hs-var">sr_supplementary</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032019"><span class="annot"><span class="annottext">[SolverReportSupplementary]
</span><a href="#local-6989586621683032019"><span class="hs-identifier hs-var">supp</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1196"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TcM () -&gt; TcM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; Bool
</span><a href="GHC.Tc.Errors.Types.html#cec_suppress"><span class="hs-identifier hs-var">cec_suppress</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032015"><span class="hs-identifier hs-var">ctxt</span></a></span><span>  </span><span class="hs-comment">-- Some worse error has occurred, so suppress this diagnostic</span><span>
</span><span id="line-1197"></span><span>         </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(ErrorItem -&gt; Bool) -&gt; NonEmpty ErrorItem -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Bool
</span><a href="GHC.Tc.Errors.Types.html#ei_suppress"><span class="hs-identifier hs-var">ei_suppress</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683032016"><span class="hs-identifier hs-var">items</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcM () -&gt; TcM ()) -&gt; TcM () -&gt; TcM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1198"></span><span>                           </span><span class="hs-comment">-- if they're all to be suppressed, report nothing</span><span>
</span><span id="line-1199"></span><span>                           </span><span class="hs-comment">-- if at least one is not suppressed, do report:</span><span>
</span><span id="line-1200"></span><span>                           </span><span class="hs-comment">-- the function that generates the error message</span><span>
</span><span id="line-1201"></span><span>                           </span><span class="hs-comment">-- should look for an unsuppressed error item</span><span>
</span><span id="line-1202"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032020"><span class="annot"><span class="annottext">reason :: DiagnosticReason
</span><a href="#local-6989586621683032020"><span class="hs-identifier hs-var hs-var hs-var">reason</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(ErrorItem -&gt; Bool) -&gt; NonEmpty ErrorItem -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CtOrigin -&gt; Bool
</span><a href="GHC.Tc.Errors.html#nonDeferrableOrigin"><span class="hs-identifier hs-var">nonDeferrableOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">(CtOrigin -&gt; Bool) -&gt; (ErrorItem -&gt; CtOrigin) -&gt; ErrorItem -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; CtOrigin
</span><a href="GHC.Tc.Errors.Types.html#errorItemOrigin"><span class="hs-identifier hs-var">errorItemOrigin</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683032016"><span class="hs-identifier hs-var">items</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-var">ErrorWithoutFlag</span></a></span><span>
</span><span id="line-1203"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; DiagnosticReason
</span><a href="GHC.Tc.Errors.Types.html#cec_defer_type_errors"><span class="hs-identifier hs-var">cec_defer_type_errors</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032015"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-1204"></span><span>                  </span><span class="hs-comment">-- See Note [No deferring for multiplicity errors]</span><span>
</span><span id="line-1205"></span><span>           </span><span id="local-6989586621683032021"><span class="annot"><span class="annottext">diag :: TcRnMessage
</span><a href="#local-6989586621683032021"><span class="hs-identifier hs-var hs-var hs-var">diag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportWithCtxt -&gt; DiagnosticReason -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnSolverReport"><span class="hs-identifier hs-var">TcRnSolverReport</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportWithCtxt
</span><a href="#local-6989586621683032018"><span class="hs-identifier hs-var">important</span></a></span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="#local-6989586621683032020"><span class="hs-identifier hs-var">reason</span></a></span><span>
</span><span id="line-1206"></span><span>       </span><span id="local-6989586621683032022"><span class="annot"><a href="#local-6989586621683032022"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CtLocEnv
-&gt; TcRnMessage
-&gt; Maybe SolverReportErrCtxt
-&gt; [SolverReportSupplementary]
-&gt; TcM (MsgEnvelope TcRnMessage)
</span><a href="GHC.Tc.Errors.html#mkErrorReport"><span class="hs-identifier hs-var">mkErrorReport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CtLoc -&gt; CtLocEnv
</span><a href="GHC.Tc.Types.CtLoc.html#ctLocEnv"><span class="hs-identifier hs-var">ctLocEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; CtLoc
</span><a href="GHC.Tc.Errors.Types.html#errorItemCtLoc"><span class="hs-identifier hs-var">errorItemCtLoc</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032017"><span class="hs-identifier hs-var">item1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TcRnMessage
</span><a href="#local-6989586621683032021"><span class="hs-identifier hs-var">diag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; Maybe SolverReportErrCtxt
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032015"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SolverReportSupplementary]
</span><a href="#local-6989586621683032019"><span class="hs-identifier hs-var">supp</span></a></span><span>
</span><span id="line-1207"></span><span>       </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#reportDiagnostic"><span class="hs-identifier hs-type">reportDiagnostic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032022"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-1208"></span><span>
</span><span id="line-1209"></span><span class="annot"><a href="GHC.Tc.Errors.html#addDeferredBinding"><span class="hs-identifier hs-type">addDeferredBinding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1210"></span><span class="hs-comment">-- See Note [Deferring coercion errors to runtime]</span><span>
</span><span id="line-1211"></span><span id="addDeferredBinding"><span class="annot"><span class="annottext">addDeferredBinding :: SolverReportErrCtxt -&gt; SolverReport -&gt; ErrorItem -&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#addDeferredBinding"><span class="hs-identifier hs-var hs-var">addDeferredBinding</span></a></span></span><span> </span><span id="local-6989586621683032023"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032023"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032024"><span class="annot"><span class="annottext">SolverReport
</span><a href="#local-6989586621683032024"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#EI"><span class="hs-identifier hs-type">EI</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ei_evdest :: ErrorItem -&gt; Maybe TcEvDest
</span><a href="GHC.Tc.Errors.Types.html#ei_evdest"><span class="hs-identifier hs-var">ei_evdest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032025"><span class="annot"><span class="annottext">TcEvDest
</span><a href="#local-6989586621683032025"><span class="hs-identifier hs-var">dest</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ei_pred :: ErrorItem -&gt; Type
</span><a href="GHC.Tc.Errors.Types.html#ei_pred"><span class="hs-identifier hs-var">ei_pred</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032026"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032026"><span class="hs-identifier hs-var">item_ty</span></a></span></span><span>
</span><span id="line-1212"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ei_loc :: ErrorItem -&gt; CtLoc
</span><a href="GHC.Tc.Errors.Types.html#ei_loc"><span class="hs-identifier hs-var">ei_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032027"><span class="annot"><span class="annottext">CtLoc
</span><a href="#local-6989586621683032027"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1213"></span><span>     </span><span class="hs-comment">-- if evdest is Just, then the constraint was from a wanted</span><span>
</span><span id="line-1214"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; Bool
</span><a href="GHC.Tc.Errors.html#deferringAnyBindings"><span class="hs-identifier hs-var">deferringAnyBindings</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032023"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-1215"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683032028"><span class="annot"><a href="#local-6989586621683032028"><span class="hs-identifier hs-var">err_tm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; CtLoc -&gt; Type -&gt; SolverReport -&gt; TcM EvTerm
</span><a href="GHC.Tc.Errors.html#mkErrorTerm"><span class="hs-identifier hs-var">mkErrorTerm</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032023"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">CtLoc
</span><a href="#local-6989586621683032027"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032026"><span class="hs-identifier hs-var">item_ty</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReport
</span><a href="#local-6989586621683032024"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-1216"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032030"><span class="annot"><a href="#local-6989586621683032030"><span class="hs-identifier hs-var hs-var">ev_binds_var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; EvBindsVar
</span><a href="GHC.Tc.Errors.Types.html#cec_binds"><span class="hs-identifier hs-var">cec_binds</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032023"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-1217"></span><span>
</span><span id="line-1218"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621683032025"><span class="hs-identifier hs-type">dest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1219"></span><span>           </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#EvVarDest"><span class="hs-identifier hs-type">EvVarDest</span></a></span><span> </span><span id="local-6989586621683032032"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032032"><span class="hs-identifier hs-var">evar</span></a></span></span><span>
</span><span id="line-1220"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EvBindsVar -&gt; EvBind -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#addTcEvBind"><span class="hs-identifier hs-var">addTcEvBind</span></a></span><span> </span><span class="annot"><span class="annottext">EvBindsVar
</span><a href="#local-6989586621683032030"><span class="hs-identifier hs-var">ev_binds_var</span></a></span><span> </span><span class="annot"><span class="annottext">(EvBind -&gt; TcM ()) -&gt; EvBind -&gt; TcM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TcId -&gt; CanonicalEvidence -&gt; EvTerm -&gt; EvBind
</span><a href="GHC.Tc.Types.Evidence.html#mkWantedEvBind"><span class="hs-identifier hs-var">mkWantedEvBind</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032032"><span class="hs-identifier hs-var">evar</span></a></span><span> </span><span class="annot"><span class="annottext">CanonicalEvidence
</span><a href="GHC.Core.InstEnv.html#EvNonCanonical"><span class="hs-identifier hs-var">EvNonCanonical</span></a></span><span> </span><span class="annot"><span class="annottext">EvTerm
</span><a href="#local-6989586621683032028"><span class="hs-identifier hs-var">err_tm</span></a></span><span>
</span><span id="line-1221"></span><span>           </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#HoleDest"><span class="hs-identifier hs-type">HoleDest</span></a></span><span> </span><span id="local-6989586621683032037"><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621683032037"><span class="hs-identifier hs-var">hole</span></a></span></span><span>
</span><span id="line-1222"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- See Note [Deferred errors for coercion holes]</span><span>
</span><span id="line-1223"></span><span>                     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032038"><span class="annot"><span class="annottext">co_var :: TcId
</span><a href="#local-6989586621683032038"><span class="hs-identifier hs-var hs-var hs-var">co_var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoercionHole -&gt; TcId
</span><a href="GHC.Core.TyCo.Rep.html#coHoleCoVar"><span class="hs-identifier hs-var">coHoleCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621683032037"><span class="hs-identifier hs-var">hole</span></a></span><span>
</span><span id="line-1224"></span><span>                   </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">EvBindsVar -&gt; EvBind -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#addTcEvBind"><span class="hs-identifier hs-var">addTcEvBind</span></a></span><span> </span><span class="annot"><span class="annottext">EvBindsVar
</span><a href="#local-6989586621683032030"><span class="hs-identifier hs-var">ev_binds_var</span></a></span><span> </span><span class="annot"><span class="annottext">(EvBind -&gt; TcM ()) -&gt; EvBind -&gt; TcM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TcId -&gt; CanonicalEvidence -&gt; EvTerm -&gt; EvBind
</span><a href="GHC.Tc.Types.Evidence.html#mkWantedEvBind"><span class="hs-identifier hs-var">mkWantedEvBind</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032038"><span class="hs-identifier hs-var">co_var</span></a></span><span> </span><span class="annot"><span class="annottext">CanonicalEvidence
</span><a href="GHC.Core.InstEnv.html#EvNonCanonical"><span class="hs-identifier hs-var">EvNonCanonical</span></a></span><span> </span><span class="annot"><span class="annottext">EvTerm
</span><a href="#local-6989586621683032028"><span class="hs-identifier hs-var">err_tm</span></a></span><span>
</span><span id="line-1225"></span><span>                   </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">CoercionHole -&gt; TcCoercionN -&gt; TcM ()
</span><a href="GHC.Tc.Utils.TcMType.html#fillCoercionHole"><span class="hs-identifier hs-var">fillCoercionHole</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621683032037"><span class="hs-identifier hs-var">hole</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; TcCoercionN
</span><a href="GHC.Core.Coercion.html#mkCoVarCo"><span class="hs-identifier hs-var">mkCoVarCo</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032038"><span class="hs-identifier hs-var">co_var</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1226"></span><span class="annot"><a href="GHC.Tc.Errors.html#addDeferredBinding"><span class="hs-identifier hs-var">addDeferredBinding</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SolverReport
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcM ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Do not set any evidence for Given</span><span>
</span><span id="line-1227"></span><span>
</span><span id="line-1228"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkErrorTerm"><span class="hs-identifier hs-type">mkErrorTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.CtLoc.html#CtLoc"><span class="hs-identifier hs-type">CtLoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>  </span><span class="hs-comment">-- of the error term</span><span>
</span><span id="line-1229"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a></span><span>
</span><span id="line-1230"></span><span id="mkErrorTerm"><span class="annot"><span class="annottext">mkErrorTerm :: SolverReportErrCtxt -&gt; CtLoc -&gt; Type -&gt; SolverReport -&gt; TcM EvTerm
</span><a href="GHC.Tc.Errors.html#mkErrorTerm"><span class="hs-identifier hs-var hs-var">mkErrorTerm</span></a></span></span><span> </span><span id="local-6989586621683032042"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032042"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032043"><span class="annot"><span class="annottext">CtLoc
</span><a href="#local-6989586621683032043"><span class="hs-identifier hs-var">ct_loc</span></a></span></span><span> </span><span id="local-6989586621683032044"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032044"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sr_important_msg :: SolverReport -&gt; SolverReportWithCtxt
</span><a href="GHC.Tc.Errors.Types.html#sr_important_msg"><span class="hs-identifier hs-var">sr_important_msg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032045"><span class="annot"><span class="annottext">SolverReportWithCtxt
</span><a href="#local-6989586621683032045"><span class="hs-identifier hs-var">important</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sr_supplementary :: SolverReport -&gt; [SolverReportSupplementary]
</span><a href="GHC.Tc.Errors.Types.html#sr_supplementary"><span class="hs-identifier hs-var">sr_supplementary</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032046"><span class="annot"><span class="annottext">[SolverReportSupplementary]
</span><a href="#local-6989586621683032046"><span class="hs-identifier hs-var">supp</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1231"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683032047"><span class="annot"><a href="#local-6989586621683032047"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CtLocEnv
-&gt; TcRnMessage
-&gt; Maybe SolverReportErrCtxt
-&gt; [SolverReportSupplementary]
-&gt; TcM (MsgEnvelope TcRnMessage)
</span><a href="GHC.Tc.Errors.html#mkErrorReport"><span class="hs-identifier hs-var">mkErrorReport</span></a></span><span>
</span><span id="line-1232"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CtLoc -&gt; CtLocEnv
</span><a href="GHC.Tc.Types.CtLoc.html#ctLocEnv"><span class="hs-identifier hs-var">ctLocEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CtLoc
</span><a href="#local-6989586621683032043"><span class="hs-identifier hs-var">ct_loc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1233"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportWithCtxt -&gt; DiagnosticReason -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnSolverReport"><span class="hs-identifier hs-var">TcRnSolverReport</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportWithCtxt
</span><a href="#local-6989586621683032045"><span class="hs-identifier hs-var">important</span></a></span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="GHC.Types.Error.html#ErrorWithoutFlag"><span class="hs-identifier hs-var">ErrorWithoutFlag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; Maybe SolverReportErrCtxt
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032042"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SolverReportSupplementary]
</span><a href="#local-6989586621683032046"><span class="hs-identifier hs-var">supp</span></a></span><span>
</span><span id="line-1234"></span><span>         </span><span class="hs-comment">-- This will be reported at runtime, so we always want &quot;error:&quot; in the report, never &quot;warning:&quot;</span><span>
</span><span id="line-1235"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683032048"><span class="annot"><a href="#local-6989586621683032048"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-type">getDynFlags</span></a></span><span>
</span><span id="line-1236"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032049"><span class="annot"><a href="#local-6989586621683032049"><span class="hs-identifier hs-var hs-var">err_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiagnosticOpts TcRnMessage -&gt; MsgEnvelope TcRnMessage -&gt; SDoc
forall e. Diagnostic e =&gt; DiagnosticOpts e -&gt; MsgEnvelope e -&gt; SDoc
</span><a href="GHC.Utils.Error.html#pprLocMsgEnvelope"><span class="hs-identifier hs-var">pprLocMsgEnvelope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; DiagnosticOpts TcRnMessage
</span><a href="GHC.Driver.Config.Diagnostic.html#initTcMessageOpts"><span class="hs-identifier hs-var">initTcMessageOpts</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683032048"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MsgEnvelope TcRnMessage
</span><a href="#local-6989586621683032047"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-1237"></span><span>             </span><span id="local-6989586621683032051"><span class="annot"><a href="#local-6989586621683032051"><span class="hs-identifier hs-var hs-var">err_str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; SDoc -&gt; String
</span><a href="GHC.Driver.Ppr.html#showSDoc"><span class="hs-identifier hs-var">showSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683032048"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; String) -&gt; SDoc -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1238"></span><span>                       </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621683032049"><span class="hs-identifier hs-var">err_msg</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(deferred type error)&quot;</span></span><span>
</span><span id="line-1239"></span><span>
</span><span id="line-1240"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Types.EvTerm.html#evDelayedError"><span class="hs-identifier hs-type">evDelayedError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032044"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032051"><span class="hs-identifier hs-type">err_str</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1241"></span><span>
</span><span id="line-1242"></span><span class="annot"><a href="GHC.Tc.Errors.html#tryReporters"><span class="hs-identifier hs-type">tryReporters</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Errors.html#ReporterSpec"><span class="hs-identifier hs-type">ReporterSpec</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1243"></span><span class="hs-comment">-- Use the first reporter in the list whose predicate says True</span><span>
</span><span id="line-1244"></span><span id="tryReporters"><span class="annot"><span class="annottext">tryReporters :: SolverReportErrCtxt
-&gt; [ReporterSpec]
-&gt; [ErrorItem]
-&gt; TcM (SolverReportErrCtxt, [ErrorItem])
</span><a href="GHC.Tc.Errors.html#tryReporters"><span class="hs-identifier hs-var hs-var">tryReporters</span></a></span></span><span> </span><span id="local-6989586621683032054"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032054"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032055"><span class="annot"><span class="annottext">[ReporterSpec]
</span><a href="#local-6989586621683032055"><span class="hs-identifier hs-var">reporters</span></a></span></span><span> </span><span id="local-6989586621683032056"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032056"><span class="hs-identifier hs-var">items</span></a></span></span><span>
</span><span id="line-1245"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032057"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032057"><span class="hs-identifier hs-var hs-var">vis_items</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032058"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032058"><span class="hs-identifier hs-var hs-var">invis_items</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1246"></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ErrorItem -&gt; Bool) -&gt; [ErrorItem] -&gt; ([ErrorItem], [ErrorItem])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CtOrigin -&gt; Bool
</span><a href="GHC.Tc.Types.Origin.html#isVisibleOrigin"><span class="hs-identifier hs-var">isVisibleOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">(CtOrigin -&gt; Bool) -&gt; (ErrorItem -&gt; CtOrigin) -&gt; ErrorItem -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; CtOrigin
</span><a href="GHC.Tc.Errors.Types.html#errorItemOrigin"><span class="hs-identifier hs-var">errorItemOrigin</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032056"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-1247"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tryReporters {&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ErrorItem] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032057"><span class="hs-identifier hs-var">vis_items</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[ErrorItem] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032058"><span class="hs-identifier hs-var">invis_items</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1248"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032060"><span class="annot"><a href="#local-6989586621683032060"><span class="hs-identifier hs-var">ctxt'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032061"><span class="annot"><a href="#local-6989586621683032061"><span class="hs-identifier hs-var">items'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
-&gt; [ReporterSpec]
-&gt; [ErrorItem]
-&gt; [ErrorItem]
-&gt; TcM (SolverReportErrCtxt, [ErrorItem])
</span><a href="#local-6989586621683032062"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032054"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">[ReporterSpec]
</span><a href="#local-6989586621683032055"><span class="hs-identifier hs-var">reporters</span></a></span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032057"><span class="hs-identifier hs-var">vis_items</span></a></span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032058"><span class="hs-identifier hs-var">invis_items</span></a></span><span>
</span><span id="line-1249"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-type">traceTc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tryReporters }&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032061"><span class="hs-identifier hs-type">items'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1250"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683032060"><span class="hs-identifier hs-type">ctxt'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683032061"><span class="hs-identifier hs-type">items'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1251"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1252"></span><span>    </span><span id="local-6989586621683032062"><span class="annot"><span class="annottext">go :: SolverReportErrCtxt
-&gt; [ReporterSpec]
-&gt; [ErrorItem]
-&gt; [ErrorItem]
-&gt; TcM (SolverReportErrCtxt, [ErrorItem])
</span><a href="#local-6989586621683032062"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621683032066"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032066"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621683032067"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032067"><span class="hs-identifier hs-var">vis_items</span></a></span></span><span> </span><span id="local-6989586621683032068"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032068"><span class="hs-identifier hs-var">invis_items</span></a></span></span><span>
</span><span id="line-1253"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SolverReportErrCtxt, [ErrorItem])
-&gt; TcM (SolverReportErrCtxt, [ErrorItem])
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032066"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032067"><span class="hs-identifier hs-var">vis_items</span></a></span><span> </span><span class="annot"><span class="annottext">[ErrorItem] -&gt; [ErrorItem] -&gt; [ErrorItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032068"><span class="hs-identifier hs-var">invis_items</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1254"></span><span>
</span><span id="line-1255"></span><span>    </span><span class="annot"><a href="#local-6989586621683032062"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621683032069"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032069"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032070"><span class="annot"><span class="annottext">ReporterSpec
</span><a href="#local-6989586621683032070"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621683032071"><span class="annot"><span class="annottext">[ReporterSpec]
</span><a href="#local-6989586621683032071"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683032072"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032072"><span class="hs-identifier hs-var">vis_items</span></a></span></span><span> </span><span id="local-6989586621683032073"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032073"><span class="hs-identifier hs-var">invis_items</span></a></span></span><span>
</span><span id="line-1256"></span><span>       </span><span class="hs-comment">-- always look at *visible* Origins before invisible ones</span><span>
</span><span id="line-1257"></span><span>       </span><span class="hs-comment">-- this is the whole point of isVisibleOrigin</span><span>
</span><span id="line-1258"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032074"><span class="annot"><a href="#local-6989586621683032074"><span class="hs-identifier hs-var">ctxt'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032075"><span class="annot"><a href="#local-6989586621683032075"><span class="hs-identifier hs-var">vis_items'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
-&gt; ReporterSpec
-&gt; [ErrorItem]
-&gt; TcM (SolverReportErrCtxt, [ErrorItem])
</span><a href="GHC.Tc.Errors.html#tryReporter"><span class="hs-identifier hs-var">tryReporter</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032069"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ReporterSpec
</span><a href="#local-6989586621683032070"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032072"><span class="hs-identifier hs-var">vis_items</span></a></span><span>
</span><span id="line-1259"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032077"><span class="annot"><a href="#local-6989586621683032077"><span class="hs-identifier hs-var">ctxt''</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032078"><span class="annot"><a href="#local-6989586621683032078"><span class="hs-identifier hs-var">invis_items'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#tryReporter"><span class="hs-identifier hs-type">tryReporter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032074"><span class="hs-identifier hs-type">ctxt'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032070"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032073"><span class="hs-identifier hs-type">invis_items</span></a></span><span>
</span><span id="line-1260"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="#local-6989586621683032062"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032077"><span class="hs-identifier hs-type">ctxt''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032071"><span class="hs-identifier hs-type">rs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032075"><span class="hs-identifier hs-type">vis_items'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032078"><span class="hs-identifier hs-type">invis_items'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1261"></span><span>                </span><span class="hs-comment">-- Carry on with the rest, because we must make</span><span>
</span><span id="line-1262"></span><span>                </span><span class="hs-comment">-- deferred bindings for them if we have -fdefer-type-errors</span><span>
</span><span id="line-1263"></span><span>                </span><span class="hs-comment">-- But suppress their error messages</span><span>
</span><span id="line-1264"></span><span>
</span><span id="line-1265"></span><span class="annot"><a href="GHC.Tc.Errors.html#tryReporter"><span class="hs-identifier hs-type">tryReporter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#ReporterSpec"><span class="hs-identifier hs-type">ReporterSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1266"></span><span id="tryReporter"><span class="annot"><span class="annottext">tryReporter :: SolverReportErrCtxt
-&gt; ReporterSpec
-&gt; [ErrorItem]
-&gt; TcM (SolverReportErrCtxt, [ErrorItem])
</span><a href="GHC.Tc.Errors.html#tryReporter"><span class="hs-identifier hs-var hs-var">tryReporter</span></a></span></span><span> </span><span id="local-6989586621683032079"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032079"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032080"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621683032080"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032081"><span class="annot"><span class="annottext">ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683032081"><span class="hs-identifier hs-var">keep_me</span></a></span></span><span class="hs-special">,</span><span>  </span><span id="local-6989586621683032082"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032082"><span class="hs-identifier hs-var">suppress_after</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032083"><span class="annot"><span class="annottext">Reporter
</span><a href="#local-6989586621683032083"><span class="hs-identifier hs-var">reporter</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683032084"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032084"><span class="hs-identifier hs-var">items</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[ErrorItem] -&gt; Maybe (NonEmpty ErrorItem)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#nonEmpty"><span class="hs-identifier hs-var">nonEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032085"><span class="hs-identifier hs-var">yeses</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1267"></span><span>    </span><span class="annot"><span class="annottext">Maybe (NonEmpty ErrorItem)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(SolverReportErrCtxt, [ErrorItem])
-&gt; TcM (SolverReportErrCtxt, [ErrorItem])
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032079"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032084"><span class="hs-identifier hs-var">items</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1268"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032086"><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683032086"><span class="hs-identifier hs-var">yeses</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1269"></span><span>       </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tryReporter{ &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621683032080"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683032086"><span class="hs-identifier hs-var">yeses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1270"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032087"><span class="annot"><a href="#local-6989586621683032087"><span class="hs-identifier hs-var">no_errs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcM () -&gt; TcRn ((), Bool)
forall a. TcRn a -&gt; TcRn (a, Bool)
</span><a href="GHC.Tc.Utils.Monad.html#askNoErrs"><span class="hs-identifier hs-var">askNoErrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reporter
</span><a href="#local-6989586621683032083"><span class="hs-identifier hs-var">reporter</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032079"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683032086"><span class="hs-identifier hs-var">yeses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1271"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032088"><span class="annot"><a href="#local-6989586621683032088"><span class="hs-identifier hs-var hs-var">suppress_now</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032087"><span class="hs-identifier hs-var">no_errs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032082"><span class="hs-identifier hs-var">suppress_after</span></a></span><span>
</span><span id="line-1272"></span><span>                            </span><span class="hs-comment">-- See Note [Suppressing error messages]</span><span>
</span><span id="line-1273"></span><span>             </span><span id="local-6989586621683032089"><span class="annot"><a href="#local-6989586621683032089"><span class="hs-identifier hs-var hs-var">ctxt'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032079"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_suppress"><span class="hs-identifier hs-var">cec_suppress</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683032088"><span class="hs-identifier hs-type">suppress_now</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_suppress"><span class="hs-identifier hs-var">cec_suppress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032079"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1274"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-type">traceTc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tryReporter end }&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032080"><span class="hs-identifier hs-type">str</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_suppress"><span class="hs-identifier hs-var">cec_suppress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032079"><span class="hs-identifier hs-type">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032082"><span class="hs-identifier hs-type">suppress_after</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1275"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683032089"><span class="hs-identifier hs-type">ctxt'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683032090"><span class="hs-identifier hs-type">nos</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1276"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1277"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621683032085"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032085"><span class="hs-identifier hs-var">yeses</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032090"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032090"><span class="hs-identifier hs-var">nos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ErrorItem -&gt; Bool) -&gt; [ErrorItem] -&gt; ([ErrorItem], [ErrorItem])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Bool
</span><a href="#local-6989586621683032091"><span class="hs-identifier hs-var">keep</span></a></span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032084"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-1278"></span><span>    </span><span id="local-6989586621683032091"><span class="annot"><span class="annottext">keep :: ErrorItem -&gt; Bool
</span><a href="#local-6989586621683032091"><span class="hs-identifier hs-var hs-var">keep</span></a></span></span><span> </span><span id="local-6989586621683032092"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032092"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Pred -&gt; Bool
</span><a href="#local-6989586621683032081"><span class="hs-identifier hs-var">keep_me</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032092"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Pred
</span><a href="GHC.Core.Predicate.html#classifyPredType"><span class="hs-identifier hs-var">classifyPredType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; Type
</span><a href="GHC.Tc.Errors.Types.html#errorItemPred"><span class="hs-identifier hs-var">errorItemPred</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032092"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1279"></span><span>
</span><span id="line-1280"></span><span class="hs-comment">-- | Wrap an input 'TcRnMessage' with additional contextual information,</span><span>
</span><span id="line-1281"></span><span class="hs-comment">-- such as relevant bindings or valid hole fits.</span><span>
</span><span id="line-1282"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkErrorReport"><span class="hs-identifier hs-type">mkErrorReport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.CtLoc.html#CtLocEnv"><span class="hs-identifier hs-type">CtLocEnv</span></a></span><span>
</span><span id="line-1283"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnMessage"><span class="hs-identifier hs-type">TcRnMessage</span></a></span><span>
</span><span id="line-1284"></span><span>                  </span><span class="annot"><span class="hs-comment">-- ^ The main payload of the message.</span></span><span>
</span><span id="line-1285"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span>
</span><span id="line-1286"></span><span>                  </span><span class="hs-comment">-- ^ The context to add, after the main diagnostic</span><span>
</span><span id="line-1287"></span><span>                  </span><span class="hs-comment">-- but before the supplementary information.</span><span>
</span><span id="line-1288"></span><span>                  </span><span class="hs-comment">-- Nothing &lt;=&gt; don't add any context.</span><span>
</span><span id="line-1289"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportSupplementary"><span class="hs-identifier hs-type">SolverReportSupplementary</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1290"></span><span>                  </span><span class="annot"><span class="hs-comment">-- ^ Supplementary information, to be added at the end of the message.</span></span><span>
</span><span id="line-1291"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Error.html#MsgEnvelope"><span class="hs-identifier hs-type">MsgEnvelope</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnMessage"><span class="hs-identifier hs-type">TcRnMessage</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1292"></span><span id="mkErrorReport"><span class="annot"><span class="annottext">mkErrorReport :: CtLocEnv
-&gt; TcRnMessage
-&gt; Maybe SolverReportErrCtxt
-&gt; [SolverReportSupplementary]
-&gt; TcM (MsgEnvelope TcRnMessage)
</span><a href="GHC.Tc.Errors.html#mkErrorReport"><span class="hs-identifier hs-var hs-var">mkErrorReport</span></a></span></span><span> </span><span id="local-6989586621683032093"><span class="annot"><span class="annottext">CtLocEnv
</span><a href="#local-6989586621683032093"><span class="hs-identifier hs-var">tcl_env</span></a></span></span><span> </span><span id="local-6989586621683032094"><span class="annot"><span class="annottext">TcRnMessage
</span><a href="#local-6989586621683032094"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621683032095"><span class="annot"><span class="annottext">Maybe SolverReportErrCtxt
</span><a href="#local-6989586621683032095"><span class="hs-identifier hs-var">mb_ctxt</span></a></span></span><span> </span><span id="local-6989586621683032096"><span class="annot"><span class="annottext">[SolverReportSupplementary]
</span><a href="#local-6989586621683032096"><span class="hs-identifier hs-var">supplementary</span></a></span></span><span>
</span><span id="line-1293"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683032097"><span class="annot"><a href="#local-6989586621683032097"><span class="hs-identifier hs-var">mb_context</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SolverReportErrCtxt -&gt; IOEnv (Env TcGblEnv TcLclEnv) SDoc)
-&gt; Maybe SolverReportErrCtxt
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe SDoc)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Maybe a -&gt; f (Maybe b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683032099"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032099"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; [ErrCtxt] -&gt; IOEnv (Env TcGblEnv TcLclEnv) SDoc
</span><a href="GHC.Tc.Utils.Monad.html#mkErrInfo"><span class="hs-identifier hs-var">mkErrInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TidyEnv
</span><a href="GHC.Tc.Errors.Types.html#cec_tidy"><span class="hs-identifier hs-var">cec_tidy</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032099"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CtLocEnv -&gt; [ErrCtxt]
</span><a href="GHC.Tc.Types.CtLoc.html#ctl_ctxt"><span class="hs-identifier hs-var">ctl_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">CtLocEnv
</span><a href="#local-6989586621683032093"><span class="hs-identifier hs-var">tcl_env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe SolverReportErrCtxt
</span><a href="#local-6989586621683032095"><span class="hs-identifier hs-var">mb_ctxt</span></a></span><span>
</span><span id="line-1294"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683032102"><span class="annot"><a href="#local-6989586621683032102"><span class="hs-identifier hs-var">unit_state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Driver.Env.html#hsc_units"><span class="hs-identifier hs-type">hsc_units</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#getTopEnv"><span class="hs-identifier hs-type">getTopEnv</span></a></span><span>
</span><span id="line-1295"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683032104"><span class="annot"><a href="#local-6989586621683032104"><span class="hs-identifier hs-var">hfdc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Hole.html#getHoleFitDispConfig"><span class="hs-identifier hs-type">getHoleFitDispConfig</span></a></span><span>
</span><span id="line-1296"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-1297"></span><span>           </span><span id="local-6989586621683032105"><span class="annot"><a href="#local-6989586621683032105"><span class="hs-identifier hs-var hs-var">err_info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1298"></span><span>             </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; ErrInfo
</span><a href="GHC.Tc.Errors.Types.html#ErrInfo"><span class="hs-identifier hs-var">ErrInfo</span></a></span><span>
</span><span id="line-1299"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; Maybe SDoc -&gt; SDoc
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SDoc
</span><a href="#local-6989586621683032097"><span class="hs-identifier hs-var">mb_context</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1300"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; [SDoc] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SolverReportSupplementary -&gt; SDoc)
-&gt; [SolverReportSupplementary] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HoleFitDispConfig -&gt; SolverReportSupplementary -&gt; SDoc
</span><a href="GHC.Tc.Errors.html#pprSolverReportSupplementary"><span class="hs-identifier hs-var">pprSolverReportSupplementary</span></a></span><span> </span><span class="annot"><span class="annottext">HoleFitDispConfig
</span><a href="#local-6989586621683032104"><span class="hs-identifier hs-var">hfdc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SolverReportSupplementary]
</span><a href="#local-6989586621683032096"><span class="hs-identifier hs-var">supplementary</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1301"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032109"><span class="annot"><a href="#local-6989586621683032109"><span class="hs-identifier hs-var hs-var">detailed_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrInfo -&gt; TcRnMessage -&gt; TcRnMessageDetailed
</span><a href="GHC.Tc.Utils.Monad.html#mkDetailedMessage"><span class="hs-identifier hs-var">mkDetailedMessage</span></a></span><span> </span><span class="annot"><span class="annottext">ErrInfo
</span><a href="#local-6989586621683032105"><span class="hs-identifier hs-var">err_info</span></a></span><span> </span><span class="annot"><span class="annottext">TcRnMessage
</span><a href="#local-6989586621683032094"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-1302"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#mkTcRnMessage"><span class="hs-identifier hs-type">mkTcRnMessage</span></a></span><span>
</span><span id="line-1303"></span><span>           </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-type">RealSrcSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.CtLoc.html#ctl_loc"><span class="hs-identifier hs-var">ctl_loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032093"><span class="hs-identifier hs-type">tcl_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Data.Strict.html#Nothing"><span class="hs-identifier hs-type">Strict.Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1304"></span><span>           </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnMessageWithInfo"><span class="hs-identifier hs-type">TcRnMessageWithInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032102"><span class="hs-identifier hs-type">unit_state</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621683032109"><span class="hs-identifier hs-type">detailed_msg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1305"></span><span>
</span><span id="line-1306"></span><span>
</span><span id="line-1307"></span><span>
</span><span id="line-1308"></span><span class="annot"><span class="hs-comment">-- | Pretty-print supplementary information, to add to an error report.</span></span><span>
</span><span id="line-1309"></span><span class="annot"><a href="GHC.Tc.Errors.html#pprSolverReportSupplementary"><span class="hs-identifier hs-type">pprSolverReportSupplementary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#HoleFitDispConfig"><span class="hs-identifier hs-type">HoleFitDispConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportSupplementary"><span class="hs-identifier hs-type">SolverReportSupplementary</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1310"></span><span class="hs-comment">-- This function should be in &quot;GHC.Tc.Errors.Ppr&quot;,</span><span>
</span><span id="line-1311"></span><span class="hs-comment">-- but we need it here because 'TcRnMessageDetails' needs an 'SDoc'.</span><span>
</span><span id="line-1312"></span><span id="pprSolverReportSupplementary"><span class="annot"><span class="annottext">pprSolverReportSupplementary :: HoleFitDispConfig -&gt; SolverReportSupplementary -&gt; SDoc
</span><a href="GHC.Tc.Errors.html#pprSolverReportSupplementary"><span class="hs-identifier hs-var hs-var">pprSolverReportSupplementary</span></a></span></span><span> </span><span id="local-6989586621683032116"><span class="annot"><span class="annottext">HoleFitDispConfig
</span><a href="#local-6989586621683032116"><span class="hs-identifier hs-var">hfdc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1313"></span><span>  </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SupplementaryBindings"><span class="hs-identifier hs-type">SupplementaryBindings</span></a></span><span> </span><span id="local-6989586621683032117"><span class="annot"><span class="annottext">RelevantBindings
</span><a href="#local-6989586621683032117"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RelevantBindings -&gt; SDoc
</span><a href="GHC.Tc.Errors.Types.html#pprRelevantBindings"><span class="hs-identifier hs-var">pprRelevantBindings</span></a></span><span> </span><span class="annot"><span class="annottext">RelevantBindings
</span><a href="#local-6989586621683032117"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-1314"></span><span>  </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SupplementaryHoleFits"><span class="hs-identifier hs-type">SupplementaryHoleFits</span></a></span><span> </span><span id="local-6989586621683032120"><span class="annot"><span class="annottext">ValidHoleFits
</span><a href="#local-6989586621683032120"><span class="hs-identifier hs-var">fits</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HoleFitDispConfig -&gt; ValidHoleFits -&gt; SDoc
</span><a href="GHC.Tc.Errors.html#pprValidHoleFits"><span class="hs-identifier hs-var">pprValidHoleFits</span></a></span><span> </span><span class="annot"><span class="annottext">HoleFitDispConfig
</span><a href="#local-6989586621683032116"><span class="hs-identifier hs-var">hfdc</span></a></span><span> </span><span class="annot"><span class="annottext">ValidHoleFits
</span><a href="#local-6989586621683032120"><span class="hs-identifier hs-var">fits</span></a></span><span>
</span><span id="line-1315"></span><span>  </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SupplementaryCts"><span class="hs-identifier hs-type">SupplementaryCts</span></a></span><span>      </span><span id="local-6989586621683032123"><span class="annot"><span class="annottext">[(Type, RealSrcSpan)]
</span><a href="#local-6989586621683032123"><span class="hs-identifier hs-var">cts</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Type, RealSrcSpan)] -&gt; SDoc
</span><a href="GHC.Tc.Errors.html#pprConstraintsInclude"><span class="hs-identifier hs-var">pprConstraintsInclude</span></a></span><span> </span><span class="annot"><span class="annottext">[(Type, RealSrcSpan)]
</span><a href="#local-6989586621683032123"><span class="hs-identifier hs-var">cts</span></a></span><span>
</span><span id="line-1316"></span><span>
</span><span id="line-1317"></span><span class="annot"><span class="hs-comment">-- | Display a collection of valid hole fits.</span></span><span>
</span><span id="line-1318"></span><span class="annot"><a href="GHC.Tc.Errors.html#pprValidHoleFits"><span class="hs-identifier hs-type">pprValidHoleFits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#HoleFitDispConfig"><span class="hs-identifier hs-type">HoleFitDispConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ValidHoleFits"><span class="hs-identifier hs-type">ValidHoleFits</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1319"></span><span class="hs-comment">-- This function should be in &quot;GHC.Tc.Errors.Ppr&quot;,</span><span>
</span><span id="line-1320"></span><span class="hs-comment">-- but we need it here because 'TcRnMessageDetails' needs an 'SDoc'.</span><span>
</span><span id="line-1321"></span><span id="pprValidHoleFits"><span class="annot"><span class="annottext">pprValidHoleFits :: HoleFitDispConfig -&gt; ValidHoleFits -&gt; SDoc
</span><a href="GHC.Tc.Errors.html#pprValidHoleFits"><span class="hs-identifier hs-var hs-var">pprValidHoleFits</span></a></span></span><span> </span><span id="local-6989586621683032125"><span class="annot"><span class="annottext">HoleFitDispConfig
</span><a href="#local-6989586621683032125"><span class="hs-identifier hs-var">hfdc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ValidHoleFits"><span class="hs-identifier hs-type">ValidHoleFits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#Fits"><span class="hs-identifier hs-type">Fits</span></a></span><span> </span><span id="local-6989586621683032128"><span class="annot"><span class="annottext">[HoleFit]
</span><a href="#local-6989586621683032128"><span class="hs-identifier hs-var">fits</span></a></span></span><span> </span><span id="local-6989586621683032129"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032129"><span class="hs-identifier hs-var">discarded_fits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#Fits"><span class="hs-identifier hs-type">Fits</span></a></span><span> </span><span id="local-6989586621683032130"><span class="annot"><span class="annottext">[HoleFit]
</span><a href="#local-6989586621683032130"><span class="hs-identifier hs-var">refs</span></a></span></span><span> </span><span id="local-6989586621683032131"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032131"><span class="hs-identifier hs-var">discarded_refs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1322"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621683032132"><span class="hs-identifier hs-var">fits_msg</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621683032133"><span class="hs-identifier hs-var">refs_msg</span></a></span><span>
</span><span id="line-1323"></span><span>
</span><span id="line-1324"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1325"></span><span>    </span><span class="annot"><a href="#local-6989586621683032132"><span class="hs-identifier hs-type">fits_msg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683032133"><span class="hs-identifier hs-type">refs_msg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683032134"><span class="hs-identifier hs-type">fits_discard_msg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683032135"><span class="hs-identifier hs-type">refs_discard_msg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1326"></span><span>    </span><span id="local-6989586621683032132"><span class="annot"><span class="annottext">fits_msg :: SDoc
</span><a href="#local-6989586621683032132"><span class="hs-identifier hs-var hs-var">fits_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; SDoc
forall doc. IsOutput doc =&gt; Bool -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#ppUnless"><span class="hs-identifier hs-var">ppUnless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[HoleFit] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[HoleFit]
</span><a href="#local-6989586621683032128"><span class="hs-identifier hs-var">fits</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1327"></span><span>                    </span><span class="annot"><span class="annottext">SDoc -&gt; Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Valid hole fits include&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1328"></span><span>                    </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(HoleFit -&gt; SDoc) -&gt; [HoleFit] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HoleFitDispConfig -&gt; HoleFit -&gt; SDoc
</span><a href="GHC.Tc.Errors.Hole.html#pprHoleFit"><span class="hs-identifier hs-var">pprHoleFit</span></a></span><span> </span><span class="annot"><span class="annottext">HoleFitDispConfig
</span><a href="#local-6989586621683032125"><span class="hs-identifier hs-var">hfdc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[HoleFit]
</span><a href="#local-6989586621683032128"><span class="hs-identifier hs-var">fits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1329"></span><span>                      </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; SDoc
forall doc. IsOutput doc =&gt; Bool -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#ppWhen"><span class="hs-identifier hs-var">ppWhen</span></a></span><span>  </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032129"><span class="hs-identifier hs-var">discarded_fits</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621683032134"><span class="hs-identifier hs-var">fits_discard_msg</span></a></span><span>
</span><span id="line-1330"></span><span>    </span><span id="local-6989586621683032133"><span class="annot"><span class="annottext">refs_msg :: SDoc
</span><a href="#local-6989586621683032133"><span class="hs-identifier hs-var hs-var">refs_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; SDoc
forall doc. IsOutput doc =&gt; Bool -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#ppUnless"><span class="hs-identifier hs-var">ppUnless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[HoleFit] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[HoleFit]
</span><a href="#local-6989586621683032130"><span class="hs-identifier hs-var">refs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1331"></span><span>                  </span><span class="annot"><span class="annottext">SDoc -&gt; Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Valid refinement hole fits include&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1332"></span><span>                  </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(HoleFit -&gt; SDoc) -&gt; [HoleFit] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HoleFitDispConfig -&gt; HoleFit -&gt; SDoc
</span><a href="GHC.Tc.Errors.Hole.html#pprHoleFit"><span class="hs-identifier hs-var">pprHoleFit</span></a></span><span> </span><span class="annot"><span class="annottext">HoleFitDispConfig
</span><a href="#local-6989586621683032125"><span class="hs-identifier hs-var">hfdc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[HoleFit]
</span><a href="#local-6989586621683032130"><span class="hs-identifier hs-var">refs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1333"></span><span>                    </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; SDoc
forall doc. IsOutput doc =&gt; Bool -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#ppWhen"><span class="hs-identifier hs-var">ppWhen</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032131"><span class="hs-identifier hs-var">discarded_refs</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621683032135"><span class="hs-identifier hs-var">refs_discard_msg</span></a></span><span>
</span><span id="line-1334"></span><span>    </span><span id="local-6989586621683032134"><span class="annot"><span class="annottext">fits_discard_msg :: SDoc
</span><a href="#local-6989586621683032134"><span class="hs-identifier hs-var hs-var">fits_discard_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1335"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(Some hole fits suppressed;&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-1336"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;use -fmax-valid-hole-fits=N&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-1337"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;or -fno-max-valid-hole-fits)&quot;</span></span><span>
</span><span id="line-1338"></span><span>    </span><span id="local-6989586621683032135"><span class="annot"><span class="annottext">refs_discard_msg :: SDoc
</span><a href="#local-6989586621683032135"><span class="hs-identifier hs-var hs-var">refs_discard_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1339"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(Some refinement hole fits suppressed;&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-1340"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;use -fmax-refinement-hole-fits=N&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-1341"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;or -fno-max-refinement-hole-fits)&quot;</span></span><span>
</span><span id="line-1342"></span><span>
</span><span id="line-1343"></span><span class="hs-comment">-- | Add a &quot;Constraints include...&quot; message.</span><span>
</span><span id="line-1344"></span><span class="hs-comment">--</span><span>
</span><span id="line-1345"></span><span class="hs-comment">-- See Note [Constraints include ...]</span><span>
</span><span id="line-1346"></span><span class="annot"><a href="GHC.Tc.Errors.html#pprConstraintsInclude"><span class="hs-identifier hs-type">pprConstraintsInclude</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-type">RealSrcSpan</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1347"></span><span class="hs-comment">-- This function should be in &quot;GHC.Tc.Errors.Ppr&quot;,</span><span>
</span><span id="line-1348"></span><span class="hs-comment">-- but we need it here because 'TcRnMessageDetails' needs an 'SDoc'.</span><span>
</span><span id="line-1349"></span><span id="pprConstraintsInclude"><span class="annot"><span class="annottext">pprConstraintsInclude :: [(Type, RealSrcSpan)] -&gt; SDoc
</span><a href="GHC.Tc.Errors.html#pprConstraintsInclude"><span class="hs-identifier hs-var hs-var">pprConstraintsInclude</span></a></span></span><span> </span><span id="local-6989586621683032140"><span class="annot"><span class="annottext">[(Type, RealSrcSpan)]
</span><a href="#local-6989586621683032140"><span class="hs-identifier hs-var">cts</span></a></span></span><span>
</span><span id="line-1350"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; SDoc
forall doc. IsOutput doc =&gt; Bool -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#ppUnless"><span class="hs-identifier hs-var">ppUnless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Type, RealSrcSpan)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(Type, RealSrcSpan)]
</span><a href="#local-6989586621683032140"><span class="hs-identifier hs-var">cts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1351"></span><span>     </span><span class="annot"><span class="annottext">SDoc -&gt; Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Constraints include&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1352"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; [SDoc] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Type, RealSrcSpan) -&gt; SDoc) -&gt; [(Type, RealSrcSpan)] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Type, RealSrcSpan) -&gt; SDoc
forall {a} {a}. (Outputable a, Outputable a) =&gt; (a, a) -&gt; SDoc
</span><a href="#local-6989586621683032141"><span class="hs-identifier hs-var">pprConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">[(Type, RealSrcSpan)]
</span><a href="#local-6989586621683032140"><span class="hs-identifier hs-var">cts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1353"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1354"></span><span>    </span><span id="local-6989586621683032141"><span class="annot"><span class="annottext">pprConstraint :: (a, a) -&gt; SDoc
</span><a href="#local-6989586621683032141"><span class="hs-identifier hs-var hs-var">pprConstraint</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032150"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621683032150"><span class="hs-identifier hs-var">constraint</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032151"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621683032151"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1355"></span><span>      </span><span class="annot"><span class="annottext">a -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621683032150"><span class="hs-identifier hs-var">constraint</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;from&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621683032151"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1356"></span><span>
</span><span id="line-1357"></span><span class="hs-comment">{- Note [Always warn with -fdefer-type-errors]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When -fdefer-type-errors is on we warn about *all* type errors, even
if cec_suppress is on.  This can lead to a lot more warnings than you
would get errors without -fdefer-type-errors, but if we suppress any of
them you might get a runtime error that wasn't warned about at compile
time.

To be consistent, we should also report multiple warnings from a single
location in mkGroupReporter, when -fdefer-type-errors is on.  But that
is perhaps a bit *over*-consistent!

With #10283, you can now opt out of deferred type error warnings.

Note [No deferring for multiplicity errors]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
As explained in Note [Coercions returned from tcSubMult] in GHC.Tc.Utils.Unify,
linear types do not support casts and any nontrivial coercion will raise
an error during desugaring.

This means that even if we defer a multiplicity mismatch during typechecking,
the desugarer will refuse to compile anyway. Worse: the error raised
by the desugarer would shadow the type mismatch warnings (#20083).
As a solution, we refuse to defer submultiplicity constraints. Test: T20083.

To determine whether a constraint arose from a submultiplicity check, we
look at the CtOrigin. All calls to tcSubMult use origins which are not
used outside of linear types.

In the future, we should compile 'WpMultCoercion' to a runtime error with
-fdefer-type-errors, but the current implementation does not always
place the wrapper in the right place and the resulting program can fail Lint.
This plan is tracked in #20083.

Note [Deferred errors for coercion holes]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Suppose we need to defer a type error where the destination for the evidence
is a coercion hole. We can't just put the error in the hole, because we can't
make an erroneous coercion. (Remember that coercions are erased for runtime.)
Instead, we invent a new EvVar, bind it to an error and then make a coercion
from that EvVar, filling the hole with that coercion. Because coercions'
types are unlifted, the error is guaranteed to be hit before we get to the
coercion.

************************************************************************
*                                                                      *
                Irreducible predicate errors
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1407"></span><span>
</span><span id="line-1408"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkIrredErr"><span class="hs-identifier hs-type">mkIrredErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span>
</span><span id="line-1409"></span><span id="mkIrredErr"><span class="annot"><span class="annottext">mkIrredErr :: SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="GHC.Tc.Errors.html#mkIrredErr"><span class="hs-identifier hs-var hs-var">mkIrredErr</span></a></span></span><span> </span><span id="local-6989586621683032154"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032154"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032155"><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683032155"><span class="hs-identifier hs-var">items</span></a></span></span><span>
</span><span id="line-1410"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032156"><span class="annot"><a href="#local-6989586621683032156"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032157"><span class="annot"><a href="#local-6989586621683032157"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032158"><span class="annot"><a href="#local-6989586621683032158"><span class="hs-identifier hs-var">item1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; SolverReportErrCtxt
-&gt; ErrorItem
-&gt; TcM (SolverReportErrCtxt, RelevantBindings, ErrorItem)
</span><a href="GHC.Tc.Errors.html#relevantBindings"><span class="hs-identifier hs-var">relevantBindings</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032154"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032159"><span class="hs-identifier hs-var">item1</span></a></span><span>
</span><span id="line-1411"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032160"><span class="annot"><a href="#local-6989586621683032160"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TcSolverReportMsg -&gt; SolverReport
</span><a href="GHC.Tc.Errors.html#important"><span class="hs-identifier hs-var">important</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032156"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(TcSolverReportMsg -&gt; SolverReport)
-&gt; TcSolverReportMsg -&gt; SolverReport
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MismatchMsg -&gt; TcSolverReportMsg
</span><a href="GHC.Tc.Errors.Types.html#mkPlainMismatchMsg"><span class="hs-identifier hs-var">mkPlainMismatchMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(MismatchMsg -&gt; TcSolverReportMsg)
-&gt; MismatchMsg -&gt; TcSolverReportMsg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1412"></span><span>                   </span><span class="annot"><span class="annottext">[Implication]
-&gt; NonEmpty ErrorItem -&gt; Maybe CND_Extra -&gt; MismatchMsg
</span><a href="GHC.Tc.Errors.Types.html#CouldNotDeduce"><span class="hs-identifier hs-var">CouldNotDeduce</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; [Implication]
</span><a href="GHC.Tc.Errors.Types.html#getUserGivens"><span class="hs-identifier hs-var">getUserGivens</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032156"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032158"><span class="hs-identifier hs-var">item1</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; [ErrorItem] -&gt; NonEmpty ErrorItem
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032164"><span class="hs-identifier hs-var">others</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe CND_Extra
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1413"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#add_relevant_bindings"><span class="hs-identifier hs-type">add_relevant_bindings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032157"><span class="hs-identifier hs-type">binds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032160"><span class="hs-identifier hs-type">msg</span></a></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-1414"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1415"></span><span>    </span><span id="local-6989586621683032159"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032159"><span class="hs-identifier hs-var">item1</span></a></span></span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span id="local-6989586621683032164"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032164"><span class="hs-identifier hs-var">others</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ErrorItem -&gt; Bool) -&gt; NonEmpty ErrorItem -&gt; NonEmpty ErrorItem
forall a. (a -&gt; Bool) -&gt; NonEmpty a -&gt; NonEmpty a
</span><a href="GHC.Tc.Errors.html#tryFilter"><span class="hs-identifier hs-var">tryFilter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (ErrorItem -&gt; Bool) -&gt; ErrorItem -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Bool
</span><a href="GHC.Tc.Errors.Types.html#ei_suppress"><span class="hs-identifier hs-var">ei_suppress</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683032155"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-1416"></span><span>
</span><span id="line-1417"></span><span class="hs-comment">{- Note [Constructing Hole Errors]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Whether or not 'mkHoleError' returns an error is not influenced by cec_suppress. In other terms,
these &quot;hole&quot; errors are /not/ suppressed by cec_suppress. We want to see them!

There are two cases to consider:

1. For out-of-scope variables we always report an error, unless -fdefer-out-of-scope-variables is on,
   in which case the messages are discarded. See also #12170 and #12406. If deferring, report a warning
   only if -Wout-of-scope-variables is on.

2. For the general case, when -XPartialTypeSignatures is on, warnings (instead of errors) are generated
   for holes in partial type signatures, unless -Wpartial-type-signatures is not on, in which case
   the messages are discarded. If deferring, report a warning only if -Wtyped-holes is on.

The above can be summarised into the following table:

| Hole Type    | Active Flags                                             | Outcome          |
|--------------|----------------------------------------------------------|------------------|
| out-of-scope | None                                                     | Error            |
| out-of-scope | -fdefer-out-of-scope-variables, -Wout-of-scope-variables | Warning          |
| out-of-scope | -fdefer-out-of-scope-variables                           | Ignore (discard) |
| type         | None                                                     | Error            |
| type         | -XPartialTypeSignatures, -Wpartial-type-signatures       | Warning          |
| type         | -XPartialTypeSignatures                                  | Ignore (discard) |
| expression   | None                                                     | Error            |
| expression   | -Wdefer-typed-holes, -Wtyped-holes                       | Warning          |
| expression   | -Wdefer-typed-holes                                      | Ignore (discard) |

See also 'reportUnsolved'.

-}</span><span>
</span><span id="line-1449"></span><span>
</span><span id="line-1450"></span><span class="hs-comment">----------------</span><span>
</span><span id="line-1451"></span><span class="annot"><span class="hs-comment">-- | Constructs a new hole error, unless this is deferred. See Note [Constructing Hole Errors].</span></span><span>
</span><span id="line-1452"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkHoleError"><span class="hs-identifier hs-type">mkHoleError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Hole"><span class="hs-identifier hs-type">Hole</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Error.html#MsgEnvelope"><span class="hs-identifier hs-type">MsgEnvelope</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnMessage"><span class="hs-identifier hs-type">TcRnMessage</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1453"></span><span id="mkHoleError"><span class="annot"><span class="annottext">mkHoleError :: NameEnv Type
-&gt; [ErrorItem]
-&gt; SolverReportErrCtxt
-&gt; Hole
-&gt; TcM (MsgEnvelope TcRnMessage)
</span><a href="GHC.Tc.Errors.html#mkHoleError"><span class="hs-identifier hs-var hs-var">mkHoleError</span></a></span></span><span> </span><span class="annot"><span class="annottext">NameEnv Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683032166"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032166"><span class="hs-identifier hs-var">_tidy_simples</span></a></span></span><span> </span><span id="local-6989586621683032167"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032167"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032168"><span class="annot"><span class="annottext">hole :: Hole
</span><a href="#local-6989586621683032168"><span class="hs-identifier hs-var">hole</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Hole"><span class="hs-identifier hs-type">Hole</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hole_occ :: Hole -&gt; RdrName
</span><a href="GHC.Tc.Types.Constraint.html#hole_occ"><span class="hs-identifier hs-var">hole_occ</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032171"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683032171"><span class="hs-identifier hs-var">occ</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hole_loc :: Hole -&gt; CtLoc
</span><a href="GHC.Tc.Types.Constraint.html#hole_loc"><span class="hs-identifier hs-var">hole_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032172"><span class="annot"><span class="annottext">CtLoc
</span><a href="#local-6989586621683032172"><span class="hs-identifier hs-var">ct_loc</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1454"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Hole -&gt; Bool
</span><a href="GHC.Tc.Types.Constraint.html#isOutOfScopeHole"><span class="hs-identifier hs-var">isOutOfScopeHole</span></a></span><span> </span><span class="annot"><span class="annottext">Hole
</span><a href="#local-6989586621683032168"><span class="hs-identifier hs-var">hole</span></a></span><span>
</span><span id="line-1455"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032173"><span class="annot"><a href="#local-6989586621683032173"><span class="hs-identifier hs-var">imp_errs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032174"><span class="annot"><a href="#local-6989586621683032174"><span class="hs-identifier hs-var">hints</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1456"></span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LocalRdrEnv
-&gt; WhatLooking -&gt; RdrName -&gt; RnM ([ImportError], [GhcHint])
</span><a href="GHC.Rename.Unbound.html#unknownNameSuggestions"><span class="hs-identifier hs-var">unknownNameSuggestions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CtLocEnv -&gt; LocalRdrEnv
</span><a href="GHC.Tc.Types.CtLoc.html#ctl_rdr"><span class="hs-identifier hs-var">ctl_rdr</span></a></span><span> </span><span class="annot"><span class="annottext">CtLocEnv
</span><a href="#local-6989586621683032177"><span class="hs-identifier hs-var">lcl_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WhatLooking
</span><a href="GHC.Rename.Unbound.html#WL_Anything"><span class="hs-identifier hs-var">WL_Anything</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683032171"><span class="hs-identifier hs-var">occ</span></a></span><span>
</span><span id="line-1457"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-1458"></span><span>             </span><span id="local-6989586621683032179"><span class="annot"><a href="#local-6989586621683032179"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TcSolverReportMsg -&gt; SolverReportWithCtxt
</span><a href="GHC.Tc.Errors.Types.html#SolverReportWithCtxt"><span class="hs-identifier hs-var">SolverReportWithCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032167"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-1459"></span><span>                    </span><span class="annot"><span class="annottext">(TcSolverReportMsg -&gt; SolverReportWithCtxt)
-&gt; TcSolverReportMsg -&gt; SolverReportWithCtxt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Hole -&gt; HoleError -&gt; TcSolverReportMsg
</span><a href="GHC.Tc.Errors.Types.html#ReportHoleError"><span class="hs-identifier hs-var">ReportHoleError</span></a></span><span> </span><span class="annot"><span class="annottext">Hole
</span><a href="#local-6989586621683032168"><span class="hs-identifier hs-var">hole</span></a></span><span>
</span><span id="line-1460"></span><span>                    </span><span class="annot"><span class="annottext">(HoleError -&gt; TcSolverReportMsg) -&gt; HoleError -&gt; TcSolverReportMsg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ImportError] -&gt; [GhcHint] -&gt; HoleError
</span><a href="GHC.Tc.Errors.Types.html#OutOfScopeHole"><span class="hs-identifier hs-var">OutOfScopeHole</span></a></span><span> </span><span class="annot"><span class="annottext">[ImportError]
</span><a href="#local-6989586621683032173"><span class="hs-identifier hs-var">imp_errs</span></a></span><span> </span><span class="annot"><span class="annottext">[GhcHint]
</span><a href="#local-6989586621683032174"><span class="hs-identifier hs-var">hints</span></a></span><span>
</span><span id="line-1461"></span><span>             </span><span id="local-6989586621683032182"><span class="annot"><a href="#local-6989586621683032182"><span class="hs-identifier hs-var hs-var">report</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportWithCtxt -&gt; [SolverReportSupplementary] -&gt; SolverReport
</span><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-var">SolverReport</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportWithCtxt
</span><a href="#local-6989586621683032179"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1462"></span><span>
</span><span id="line-1463"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#maybeAddDeferredBindings"><span class="hs-identifier hs-type">maybeAddDeferredBindings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032167"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032168"><span class="hs-identifier hs-type">hole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032182"><span class="hs-identifier hs-type">report</span></a></span><span>
</span><span id="line-1464"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#mkErrorReport"><span class="hs-identifier hs-type">mkErrorReport</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032177"><span class="hs-identifier hs-type">lcl_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnSolverReport"><span class="hs-identifier hs-type">TcRnSolverReport</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032179"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_out_of_scope_holes"><span class="hs-identifier hs-var">cec_out_of_scope_holes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032167"><span class="hs-identifier hs-type">ctxt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1465"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1466"></span><span>          </span><span class="hs-comment">-- Pass the value 'Nothing' for the context, as it's generally not helpful</span><span>
</span><span id="line-1467"></span><span>          </span><span class="hs-comment">-- to include the context here.</span><span>
</span><span id="line-1468"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-1469"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1470"></span><span>    </span><span id="local-6989586621683032177"><span class="annot"><span class="annottext">lcl_env :: CtLocEnv
</span><a href="#local-6989586621683032177"><span class="hs-identifier hs-var hs-var">lcl_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CtLoc -&gt; CtLocEnv
</span><a href="GHC.Tc.Types.CtLoc.html#ctLocEnv"><span class="hs-identifier hs-var">ctLocEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CtLoc
</span><a href="#local-6989586621683032172"><span class="hs-identifier hs-var">ct_loc</span></a></span><span>
</span><span id="line-1471"></span><span>
</span><span id="line-1472"></span><span> </span><span class="hs-comment">-- general case: not an out-of-scope error</span><span>
</span><span id="line-1473"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkHoleError"><span class="hs-identifier hs-var">mkHoleError</span></a></span><span> </span><span id="local-6989586621683032184"><span class="annot"><span class="annottext">NameEnv Type
</span><a href="#local-6989586621683032184"><span class="hs-identifier hs-var">lcl_name_cache</span></a></span></span><span> </span><span id="local-6989586621683032185"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032185"><span class="hs-identifier hs-var">tidy_simples</span></a></span></span><span> </span><span id="local-6989586621683032186"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032186"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>
</span><span id="line-1474"></span><span>  </span><span id="local-6989586621683032187"><span class="annot"><span class="annottext">hole :: Hole
</span><a href="#local-6989586621683032187"><span class="hs-identifier hs-var">hole</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Hole"><span class="hs-identifier hs-type">Hole</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hole_ty :: Hole -&gt; Type
</span><a href="GHC.Tc.Types.Constraint.html#hole_ty"><span class="hs-identifier hs-var">hole_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032189"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032189"><span class="hs-identifier hs-var">hole_ty</span></a></span></span><span>
</span><span id="line-1475"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hole_sort :: Hole -&gt; HoleSort
</span><a href="GHC.Tc.Types.Constraint.html#hole_sort"><span class="hs-identifier hs-var">hole_sort</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032190"><span class="annot"><span class="annottext">HoleSort
</span><a href="#local-6989586621683032190"><span class="hs-identifier hs-var">sort</span></a></span></span><span>
</span><span id="line-1476"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hole_loc :: Hole -&gt; CtLoc
</span><a href="GHC.Tc.Types.Constraint.html#hole_loc"><span class="hs-identifier hs-var">hole_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032191"><span class="annot"><span class="annottext">CtLoc
</span><a href="#local-6989586621683032191"><span class="hs-identifier hs-var">ct_loc</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1477"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683032192"><span class="annot"><a href="#local-6989586621683032192"><span class="hs-identifier hs-var">rel_binds</span></a></span></span><span>
</span><span id="line-1478"></span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; CtLocEnv -&gt; NameEnv Type -&gt; TyCoVarSet -&gt; TcM RelevantBindings
</span><a href="GHC.Tc.Errors.html#relevant_bindings"><span class="hs-identifier hs-var">relevant_bindings</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">CtLocEnv
</span><a href="#local-6989586621683032194"><span class="hs-identifier hs-var">lcl_env</span></a></span><span> </span><span class="annot"><span class="annottext">NameEnv Type
</span><a href="#local-6989586621683032184"><span class="hs-identifier hs-var">lcl_name_cache</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032189"><span class="hs-identifier hs-var">hole_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1479"></span><span>               </span><span class="hs-comment">-- The 'False' means &quot;don't filter the bindings&quot;; see #8191</span><span>
</span><span id="line-1480"></span><span>
</span><span id="line-1481"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683032196"><span class="annot"><a href="#local-6989586621683032196"><span class="hs-identifier hs-var">show_hole_constraints</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#goptM"><span class="hs-identifier hs-type">goptM</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#Opt_ShowHoleConstraints"><span class="hs-identifier hs-type">Opt_ShowHoleConstraints</span></a></span><span>
</span><span id="line-1482"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032198"><span class="annot"><a href="#local-6989586621683032198"><span class="hs-identifier hs-var hs-var">relevant_cts</span></a></span></span><span>
</span><span id="line-1483"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#ExprHole"><span class="hs-identifier hs-type">ExprHole</span></a></span><span> </span><span class="annot"><span class="annottext">HoleExprRef
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HoleSort
</span><a href="#local-6989586621683032190"><span class="hs-identifier hs-var">sort</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032196"><span class="hs-identifier hs-var">show_hole_constraints</span></a></span><span>
</span><span id="line-1484"></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; [(Type, RealSrcSpan)]
</span><a href="GHC.Tc.Errors.html#givenConstraints"><span class="hs-identifier hs-var">givenConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032186"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-1485"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1486"></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1487"></span><span>
</span><span id="line-1488"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683032200"><span class="annot"><a href="#local-6989586621683032200"><span class="hs-identifier hs-var">show_valid_hole_fits</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#goptM"><span class="hs-identifier hs-type">goptM</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#Opt_ShowValidHoleFits"><span class="hs-identifier hs-type">Opt_ShowValidHoleFits</span></a></span><span>
</span><span id="line-1489"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032202"><span class="annot"><a href="#local-6989586621683032202"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032203"><span class="annot"><a href="#local-6989586621683032203"><span class="hs-identifier hs-var">hole_fits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621683032200"><span class="hs-identifier hs-type">show_valid_hole_fits</span></a></span><span>
</span><span id="line-1490"></span><span>                              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#validHoleFits"><span class="hs-identifier hs-type">validHoleFits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032186"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032185"><span class="hs-identifier hs-type">tidy_simples</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032187"><span class="hs-identifier hs-type">hole</span></a></span><span>
</span><span id="line-1491"></span><span>                              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683032186"><span class="hs-identifier hs-type">ctxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#noValidHoleFits"><span class="hs-identifier hs-type">noValidHoleFits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1492"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032206"><span class="annot"><a href="#local-6989586621683032206"><span class="hs-identifier hs-var">grouped_skvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032207"><span class="annot"><a href="#local-6989586621683032207"><span class="hs-identifier hs-var">other_tvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#liftZonkM"><span class="hs-identifier hs-type">liftZonkM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#zonkAndGroupSkolTvs"><span class="hs-identifier hs-type">zonkAndGroupSkolTvs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032189"><span class="hs-identifier hs-type">hole_ty</span></a></span><span>
</span><span id="line-1493"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032209"><span class="annot"><a href="#local-6989586621683032209"><span class="hs-identifier hs-var hs-var">reason</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#ExprHole"><span class="hs-identifier hs-type">ExprHole</span></a></span><span> </span><span class="annot"><span class="annottext">HoleExprRef
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HoleSort
</span><a href="#local-6989586621683032190"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; DiagnosticReason
</span><a href="GHC.Tc.Errors.Types.html#cec_expr_holes"><span class="hs-identifier hs-var">cec_expr_holes</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032202"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-1494"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; DiagnosticReason
</span><a href="GHC.Tc.Errors.Types.html#cec_type_holes"><span class="hs-identifier hs-var">cec_type_holes</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032202"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-1495"></span><span>             </span><span id="local-6989586621683032210"><span class="annot"><a href="#local-6989586621683032210"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TcSolverReportMsg -&gt; SolverReportWithCtxt
</span><a href="GHC.Tc.Errors.Types.html#SolverReportWithCtxt"><span class="hs-identifier hs-var">SolverReportWithCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032202"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-1496"></span><span>                  </span><span class="annot"><span class="annottext">(TcSolverReportMsg -&gt; SolverReportWithCtxt)
-&gt; TcSolverReportMsg -&gt; SolverReportWithCtxt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Hole -&gt; HoleError -&gt; TcSolverReportMsg
</span><a href="GHC.Tc.Errors.Types.html#ReportHoleError"><span class="hs-identifier hs-var">ReportHoleError</span></a></span><span> </span><span class="annot"><span class="annottext">Hole
</span><a href="#local-6989586621683032187"><span class="hs-identifier hs-var">hole</span></a></span><span>
</span><span id="line-1497"></span><span>                  </span><span class="annot"><span class="annottext">(HoleError -&gt; TcSolverReportMsg) -&gt; HoleError -&gt; TcSolverReportMsg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HoleSort -&gt; [TcId] -&gt; [(SkolemInfoAnon, [TcId])] -&gt; HoleError
</span><a href="GHC.Tc.Errors.Types.html#HoleError"><span class="hs-identifier hs-var">HoleError</span></a></span><span> </span><span class="annot"><span class="annottext">HoleSort
</span><a href="#local-6989586621683032190"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032207"><span class="hs-identifier hs-var">other_tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[(SkolemInfoAnon, [TcId])]
</span><a href="#local-6989586621683032206"><span class="hs-identifier hs-var">grouped_skvs</span></a></span><span>
</span><span id="line-1498"></span><span>             </span><span id="local-6989586621683032212"><span class="annot"><a href="#local-6989586621683032212"><span class="hs-identifier hs-var hs-var">supp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">RelevantBindings -&gt; SolverReportSupplementary
</span><a href="GHC.Tc.Errors.Types.html#SupplementaryBindings"><span class="hs-identifier hs-var">SupplementaryBindings</span></a></span><span> </span><span class="annot"><span class="annottext">RelevantBindings
</span><a href="#local-6989586621683032192"><span class="hs-identifier hs-var">rel_binds</span></a></span><span>
</span><span id="line-1499"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Type, RealSrcSpan)] -&gt; SolverReportSupplementary
</span><a href="GHC.Tc.Errors.Types.html#SupplementaryCts"><span class="hs-identifier hs-var">SupplementaryCts</span></a></span><span>      </span><span class="annot"><span class="annottext">[(Type, RealSrcSpan)]
</span><a href="#local-6989586621683032198"><span class="hs-identifier hs-var">relevant_cts</span></a></span><span>
</span><span id="line-1500"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ValidHoleFits -&gt; SolverReportSupplementary
</span><a href="GHC.Tc.Errors.Types.html#SupplementaryHoleFits"><span class="hs-identifier hs-var">SupplementaryHoleFits</span></a></span><span> </span><span class="annot"><span class="annottext">ValidHoleFits
</span><a href="#local-6989586621683032203"><span class="hs-identifier hs-var">hole_fits</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1501"></span><span>
</span><span id="line-1502"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#maybeAddDeferredBindings"><span class="hs-identifier hs-type">maybeAddDeferredBindings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032202"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032187"><span class="hs-identifier hs-type">hole</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032210"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032212"><span class="hs-identifier hs-type">supp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1503"></span><span>
</span><span id="line-1504"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#mkErrorReport"><span class="hs-identifier hs-type">mkErrorReport</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032194"><span class="hs-identifier hs-type">lcl_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnSolverReport"><span class="hs-identifier hs-type">TcRnSolverReport</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032210"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032209"><span class="hs-identifier hs-type">reason</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621683032202"><span class="hs-identifier hs-type">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683032212"><span class="hs-identifier hs-type">supp</span></a></span><span>
</span><span id="line-1505"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-1506"></span><span>
</span><span id="line-1507"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1508"></span><span>    </span><span id="local-6989586621683032194"><span class="annot"><span class="annottext">lcl_env :: CtLocEnv
</span><a href="#local-6989586621683032194"><span class="hs-identifier hs-var hs-var">lcl_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CtLoc -&gt; CtLocEnv
</span><a href="GHC.Tc.Types.CtLoc.html#ctLocEnv"><span class="hs-identifier hs-var">ctLocEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CtLoc
</span><a href="#local-6989586621683032191"><span class="hs-identifier hs-var">ct_loc</span></a></span><span>
</span><span id="line-1509"></span><span>
</span><span id="line-1510"></span><span class="hs-comment">-- | For all the skolem type variables in a type, zonk the skolem info and group together</span><span>
</span><span id="line-1511"></span><span class="hs-comment">-- all the type variables with the same origin.</span><span>
</span><span id="line-1512"></span><span class="annot"><a href="GHC.Tc.Errors.html#zonkAndGroupSkolTvs"><span class="hs-identifier hs-type">zonkAndGroupSkolTvs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Zonk.Monad.html#ZonkM"><span class="hs-identifier hs-type">ZonkM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Origin.html#SkolemInfoAnon"><span class="hs-identifier hs-type">SkolemInfoAnon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1513"></span><span id="zonkAndGroupSkolTvs"><span class="annot"><span class="annottext">zonkAndGroupSkolTvs :: Type -&gt; ZonkM ([(SkolemInfoAnon, [TcId])], [TcId])
</span><a href="GHC.Tc.Errors.html#zonkAndGroupSkolTvs"><span class="hs-identifier hs-var hs-var">zonkAndGroupSkolTvs</span></a></span></span><span> </span><span id="local-6989586621683032213"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032213"><span class="hs-identifier hs-var">hole_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1514"></span><span>  </span><span id="local-6989586621683032214"><span class="annot"><a href="#local-6989586621683032214"><span class="hs-identifier hs-var">zonked_info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((SkolemInfo, [(TcId, Int)]) -&gt; ZonkM (SkolemInfoAnon, [TcId]))
-&gt; [(SkolemInfo, [(TcId, Int)])]
-&gt; ZonkM [(SkolemInfoAnon, [TcId])]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">(SkolemInfo, [(TcId, Int)]) -&gt; ZonkM (SkolemInfoAnon, [TcId])
forall {f :: * -&gt; *} {b} {b}.
Functor f =&gt;
(SkolemInfo, f (b, b)) -&gt; ZonkM (SkolemInfoAnon, f b)
</span><a href="#local-6989586621683032216"><span class="hs-identifier hs-var">zonk_skolem_info</span></a></span><span> </span><span class="annot"><span class="annottext">[(SkolemInfo, [(TcId, Int)])]
</span><a href="#local-6989586621683032217"><span class="hs-identifier hs-var">skolem_list</span></a></span><span>
</span><span id="line-1515"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683032214"><span class="hs-identifier hs-type">zonked_info</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683032218"><span class="hs-identifier hs-type">other_tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1516"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1517"></span><span>    </span><span id="local-6989586621683032216"><span class="annot"><span class="annottext">zonk_skolem_info :: (SkolemInfo, f (b, b)) -&gt; ZonkM (SkolemInfoAnon, f b)
</span><a href="#local-6989586621683032216"><span class="hs-identifier hs-var hs-var">zonk_skolem_info</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032223"><span class="annot"><span class="annottext">SkolemInfo
</span><a href="#local-6989586621683032223"><span class="hs-identifier hs-var">sk</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032224"><span class="annot"><span class="annottext">f (b, b)
</span><a href="#local-6989586621683032224"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1518"></span><span>      </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683032225"><span class="annot"><a href="#local-6989586621683032225"><span class="hs-identifier hs-var">sk</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SkolemInfoAnon -&gt; ZonkM SkolemInfoAnon
</span><a href="GHC.Tc.Zonk.TcType.html#zonkSkolemInfoAnon"><span class="hs-identifier hs-var">zonkSkolemInfoAnon</span></a></span><span> </span><span class="annot"><span class="annottext">(SkolemInfoAnon -&gt; ZonkM SkolemInfoAnon)
-&gt; SkolemInfoAnon -&gt; ZonkM SkolemInfoAnon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SkolemInfo -&gt; SkolemInfoAnon
</span><a href="GHC.Tc.Types.Origin.html#getSkolemInfo"><span class="hs-identifier hs-var">getSkolemInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SkolemInfo
</span><a href="#local-6989586621683032223"><span class="hs-identifier hs-var">sk</span></a></span><span>
</span><span id="line-1519"></span><span>         </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683032225"><span class="hs-identifier hs-type">sk</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fst</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621683032224"><span class="hs-identifier hs-type">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1520"></span><span>    </span><span id="local-6989586621683032229"><span class="annot"><span class="annottext">tvs :: [TcId]
</span><a href="#local-6989586621683032229"><span class="hs-identifier hs-var hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [TcId]
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeList"><span class="hs-identifier hs-var">tyCoVarsOfTypeList</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032213"><span class="hs-identifier hs-var">hole_ty</span></a></span><span>
</span><span id="line-1521"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621683032231"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032231"><span class="hs-identifier hs-var">skol_tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032218"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032218"><span class="hs-identifier hs-var">other_tvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TcId -&gt; Bool) -&gt; [TcId] -&gt; ([TcId], [TcId])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; Bool
</span><a href="GHC.Types.Var.html#isTcTyVar"><span class="hs-identifier hs-var">isTcTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">(TcId -&gt; Bool) -&gt; (TcId -&gt; Bool) -&gt; TcId -&gt; Bool
forall (f :: * -&gt; *). Applicative f =&gt; f Bool -&gt; f Bool -&gt; f Bool
</span><a href="GHC.Utils.Misc.html#%3C%26%26%3E"><span class="hs-operator hs-var">&lt;&amp;&amp;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TcId -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isSkolemTyVar"><span class="hs-identifier hs-var">isSkolemTyVar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032229"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1522"></span><span>
</span><span id="line-1523"></span><span>    </span><span class="annot"><a href="#local-6989586621683032234"><span class="hs-identifier hs-type">group_skolems</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Map.html#UniqMap"><span class="hs-identifier hs-type">UM.UniqMap</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#SkolemInfo"><span class="hs-identifier hs-type">SkolemInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1524"></span><span>    </span><span id="local-6989586621683032234"><span class="annot"><span class="annottext">group_skolems :: UniqMap SkolemInfo [(TcId, Int)]
</span><a href="#local-6989586621683032234"><span class="hs-identifier hs-var hs-var">group_skolems</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bag (TcId, Int) -&gt; [(TcId, Int)]
forall a. Bag a -&gt; [a]
</span><a href="GHC.Data.Bag.html#bagToList"><span class="hs-identifier hs-var">bagToList</span></a></span><span> </span><span class="annot"><span class="annottext">(Bag (TcId, Int) -&gt; [(TcId, Int)])
-&gt; UniqMap SkolemInfo (Bag (TcId, Int))
-&gt; UniqMap SkolemInfo [(TcId, Int)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-1525"></span><span>      </span><span class="annot"><span class="annottext">(Bag (TcId, Int) -&gt; Bag (TcId, Int) -&gt; Bag (TcId, Int))
-&gt; [(SkolemInfo, Bag (TcId, Int))]
-&gt; UniqMap SkolemInfo (Bag (TcId, Int))
forall k a. Uniquable k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; UniqMap k a
</span><a href="GHC.Types.Unique.Map.html#listToUniqMap_C"><span class="hs-identifier hs-var">UM.listToUniqMap_C</span></a></span><span> </span><span class="annot"><span class="annottext">Bag (TcId, Int) -&gt; Bag (TcId, Int) -&gt; Bag (TcId, Int)
forall a. Bag a -&gt; Bag a -&gt; Bag a
</span><a href="GHC.Data.Bag.html#unionBags"><span class="hs-identifier hs-var">unionBags</span></a></span><span>
</span><span id="line-1526"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; SkolemInfo
</span><a href="GHC.Tc.Utils.TcType.html#skolemSkolInfo"><span class="hs-identifier hs-var">skolemSkolInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032238"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(TcId, Int) -&gt; Bag (TcId, Int)
forall a. a -&gt; Bag a
</span><a href="GHC.Data.Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032238"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621683032240"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621683032238"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032238"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032231"><span class="hs-identifier hs-var">skol_tvs</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621683032240"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621683032240"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1527"></span><span>
</span><span id="line-1528"></span><span>    </span><span id="local-6989586621683032217"><span class="annot"><span class="annottext">skolem_list :: [(SkolemInfo, [(TcId, Int)])]
</span><a href="#local-6989586621683032217"><span class="hs-identifier hs-var hs-var">skolem_list</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((SkolemInfo, [(TcId, Int)])
 -&gt; (SkolemInfo, [(TcId, Int)]) -&gt; Ordering)
-&gt; [(SkolemInfo, [(TcId, Int)])] -&gt; [(SkolemInfo, [(TcId, Int)])]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((SkolemInfo, [(TcId, Int)]) -&gt; [Int])
-&gt; (SkolemInfo, [(TcId, Int)])
-&gt; (SkolemInfo, [(TcId, Int)])
-&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; [Int]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; [Int])
-&gt; ((SkolemInfo, [(TcId, Int)]) -&gt; [Int])
-&gt; (SkolemInfo, [(TcId, Int)])
-&gt; [Int]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((TcId, Int) -&gt; Int) -&gt; [(TcId, Int)] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(TcId, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([(TcId, Int)] -&gt; [Int])
-&gt; ((SkolemInfo, [(TcId, Int)]) -&gt; [(TcId, Int)])
-&gt; (SkolemInfo, [(TcId, Int)])
-&gt; [Int]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SkolemInfo, [(TcId, Int)]) -&gt; [(TcId, Int)]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1529"></span><span>                </span><span class="annot"><span class="annottext">([(SkolemInfo, [(TcId, Int)])] -&gt; [(SkolemInfo, [(TcId, Int)])])
-&gt; [(SkolemInfo, [(TcId, Int)])] -&gt; [(SkolemInfo, [(TcId, Int)])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UniqMap SkolemInfo [(TcId, Int)] -&gt; [(SkolemInfo, [(TcId, Int)])]
forall k a. UniqMap k a -&gt; [(k, a)]
</span><a href="GHC.Types.Unique.Map.html#nonDetUniqMapToList"><span class="hs-identifier hs-var">UM.nonDetUniqMapToList</span></a></span><span> </span><span class="annot"><span class="annottext">UniqMap SkolemInfo [(TcId, Int)]
</span><a href="#local-6989586621683032234"><span class="hs-identifier hs-var">group_skolems</span></a></span><span>
</span><span id="line-1530"></span><span>
</span><span id="line-1531"></span><span class="hs-comment">{- Note [Adding deferred bindings]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When working with typed holes we have to deal with the case where
we want holes to be reported as warnings to users during compile time but
as errors during runtime. Therefore, we have to call 'maybeAddDeferredBindings'
so that the correct 'Severity' can be computed out of that later on.
-}</span><span>
</span><span id="line-1538"></span><span>
</span><span id="line-1539"></span><span>
</span><span id="line-1540"></span><span class="hs-comment">-- | Adds deferred bindings (as errors).</span><span>
</span><span id="line-1541"></span><span class="hs-comment">-- See Note [Adding deferred bindings].</span><span>
</span><span id="line-1542"></span><span class="annot"><a href="GHC.Tc.Errors.html#maybeAddDeferredBindings"><span class="hs-identifier hs-type">maybeAddDeferredBindings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span>
</span><span id="line-1543"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Hole"><span class="hs-identifier hs-type">Hole</span></a></span><span>
</span><span id="line-1544"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span>
</span><span id="line-1545"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1546"></span><span id="maybeAddDeferredBindings"><span class="annot"><span class="annottext">maybeAddDeferredBindings :: SolverReportErrCtxt -&gt; Hole -&gt; SolverReport -&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#maybeAddDeferredBindings"><span class="hs-identifier hs-var hs-var">maybeAddDeferredBindings</span></a></span></span><span> </span><span id="local-6989586621683032247"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032247"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032248"><span class="annot"><span class="annottext">Hole
</span><a href="#local-6989586621683032248"><span class="hs-identifier hs-var">hole</span></a></span></span><span> </span><span id="local-6989586621683032249"><span class="annot"><span class="annottext">SolverReport
</span><a href="#local-6989586621683032249"><span class="hs-identifier hs-var">report</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1547"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Hole -&gt; HoleSort
</span><a href="GHC.Tc.Types.Constraint.html#hole_sort"><span class="hs-identifier hs-var">hole_sort</span></a></span><span> </span><span class="annot"><span class="annottext">Hole
</span><a href="#local-6989586621683032248"><span class="hs-identifier hs-var">hole</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1548"></span><span>    </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#ExprHole"><span class="hs-identifier hs-type">ExprHole</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#HER"><span class="hs-identifier hs-type">HER</span></a></span><span> </span><span id="local-6989586621683032251"><span class="annot"><span class="annottext">IORef EvTerm
</span><a href="#local-6989586621683032251"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span id="local-6989586621683032252"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032252"><span class="hs-identifier hs-var">ref_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1549"></span><span>      </span><span class="hs-comment">-- Only add bindings for holes in expressions</span><span>
</span><span id="line-1550"></span><span>      </span><span class="hs-comment">-- not for holes in partial type signatures</span><span>
</span><span id="line-1551"></span><span>      </span><span class="hs-comment">-- cf. addDeferredBinding</span><span>
</span><span id="line-1552"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; TcM () -&gt; TcM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; Bool
</span><a href="GHC.Tc.Errors.html#deferringAnyBindings"><span class="hs-identifier hs-var">deferringAnyBindings</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032247"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcM () -&gt; TcM ()) -&gt; TcM () -&gt; TcM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1553"></span><span>        </span><span id="local-6989586621683032253"><span class="annot"><a href="#local-6989586621683032253"><span class="hs-identifier hs-var">err_tm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; CtLoc -&gt; Type -&gt; SolverReport -&gt; TcM EvTerm
</span><a href="GHC.Tc.Errors.html#mkErrorTerm"><span class="hs-identifier hs-var">mkErrorTerm</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032247"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hole -&gt; CtLoc
</span><a href="GHC.Tc.Types.Constraint.html#hole_loc"><span class="hs-identifier hs-var">hole_loc</span></a></span><span> </span><span class="annot"><span class="annottext">Hole
</span><a href="#local-6989586621683032248"><span class="hs-identifier hs-var">hole</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032252"><span class="hs-identifier hs-var">ref_ty</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReport
</span><a href="#local-6989586621683032249"><span class="hs-identifier hs-var">report</span></a></span><span>
</span><span id="line-1554"></span><span>          </span><span class="hs-comment">-- NB: ref_ty, not hole_ty. hole_ty might be rewritten.</span><span>
</span><span id="line-1555"></span><span>          </span><span class="hs-comment">-- See Note [Holes] in GHC.Tc.Types.Constraint</span><span>
</span><span id="line-1556"></span><span>        </span><span class="annot"><a href="GHC.Data.IOEnv.html#writeMutVar"><span class="hs-identifier hs-type">writeMutVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032251"><span class="hs-identifier hs-type">ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032253"><span class="hs-identifier hs-type">err_tm</span></a></span><span>
</span><span id="line-1557"></span><span>    </span><span class="annot"><span class="annottext">HoleSort
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcM ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1558"></span><span>
</span><span id="line-1559"></span><span class="hs-comment">-- We unwrap the SolverReportErrCtxt here, to avoid introducing a loop in module</span><span>
</span><span id="line-1560"></span><span class="hs-comment">-- imports</span><span>
</span><span id="line-1561"></span><span class="annot"><a href="GHC.Tc.Errors.html#validHoleFits"><span class="hs-identifier hs-type">validHoleFits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span>    </span><span class="hs-comment">-- ^ The context we're in, i.e. the</span><span>
</span><span id="line-1562"></span><span>                                        </span><span class="hs-comment">-- implications and the tidy environment</span><span>
</span><span id="line-1563"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span class="hs-special">]</span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Unsolved simple constraints</span></span><span>
</span><span id="line-1564"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Hole"><span class="hs-identifier hs-type">Hole</span></a></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ The hole</span></span><span>
</span><span id="line-1565"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ValidHoleFits"><span class="hs-identifier hs-type">ValidHoleFits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1566"></span><span>                </span><span class="hs-comment">-- ^ We return the new context</span><span>
</span><span id="line-1567"></span><span>                </span><span class="hs-comment">-- with a possibly updated</span><span>
</span><span id="line-1568"></span><span>                </span><span class="hs-comment">-- tidy environment, and</span><span>
</span><span id="line-1569"></span><span>                </span><span class="hs-comment">-- the valid hole fits.</span><span>
</span><span id="line-1570"></span><span id="validHoleFits"><span class="annot"><span class="annottext">validHoleFits :: SolverReportErrCtxt
-&gt; [ErrorItem] -&gt; Hole -&gt; TcM (SolverReportErrCtxt, ValidHoleFits)
</span><a href="GHC.Tc.Errors.html#validHoleFits"><span class="hs-identifier hs-var hs-var">validHoleFits</span></a></span></span><span> </span><span id="local-6989586621683032255"><span class="annot"><span class="annottext">ctxt :: SolverReportErrCtxt
</span><a href="#local-6989586621683032255"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#CEC"><span class="hs-identifier hs-type">CEC</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cec_encl :: SolverReportErrCtxt -&gt; [Implication]
</span><a href="GHC.Tc.Errors.Types.html#cec_encl"><span class="hs-identifier hs-var">cec_encl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032256"><span class="annot"><span class="annottext">[Implication]
</span><a href="#local-6989586621683032256"><span class="hs-identifier hs-var">implics</span></a></span></span><span>
</span><span id="line-1571"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cec_tidy :: SolverReportErrCtxt -&gt; TidyEnv
</span><a href="GHC.Tc.Errors.Types.html#cec_tidy"><span class="hs-identifier hs-var">cec_tidy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032257"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621683032257"><span class="hs-identifier hs-var">lcl_env</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683032258"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032258"><span class="hs-identifier hs-var">simps</span></a></span></span><span> </span><span id="local-6989586621683032259"><span class="annot"><span class="annottext">Hole
</span><a href="#local-6989586621683032259"><span class="hs-identifier hs-var">hole</span></a></span></span><span>
</span><span id="line-1572"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032260"><span class="annot"><a href="#local-6989586621683032260"><span class="hs-identifier hs-var">tidy_env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032261"><span class="annot"><a href="#local-6989586621683032261"><span class="hs-identifier hs-var">fits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TidyEnv
-&gt; [Implication]
-&gt; [CtEvidence]
-&gt; Hole
-&gt; TcM (TidyEnv, ValidHoleFits)
</span><a href="GHC.Tc.Errors.Hole.html#findValidHoleFits"><span class="hs-identifier hs-var">findValidHoleFits</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621683032257"><span class="hs-identifier hs-var">lcl_env</span></a></span><span> </span><span class="annot"><span class="annottext">[Implication]
</span><a href="#local-6989586621683032256"><span class="hs-identifier hs-var">implics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ErrorItem -&gt; Maybe CtEvidence) -&gt; [ErrorItem] -&gt; [CtEvidence]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Maybe CtEvidence
</span><a href="#local-6989586621683032263"><span class="hs-identifier hs-var">mk_wanted</span></a></span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032258"><span class="hs-identifier hs-var">simps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Hole
</span><a href="#local-6989586621683032259"><span class="hs-identifier hs-var">hole</span></a></span><span>
</span><span id="line-1573"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683032255"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_tidy"><span class="hs-identifier hs-var">cec_tidy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683032260"><span class="hs-identifier hs-type">tidy_env</span></a></span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683032261"><span class="hs-identifier hs-type">fits</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1574"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1575"></span><span>    </span><span class="annot"><a href="#local-6989586621683032263"><span class="hs-identifier hs-type">mk_wanted</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#CtEvidence"><span class="hs-identifier hs-type">CtEvidence</span></a></span><span>
</span><span id="line-1576"></span><span>    </span><span id="local-6989586621683032263"><span class="annot"><span class="annottext">mk_wanted :: ErrorItem -&gt; Maybe CtEvidence
</span><a href="#local-6989586621683032263"><span class="hs-identifier hs-var hs-var">mk_wanted</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#EI"><span class="hs-identifier hs-type">EI</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ei_pred :: ErrorItem -&gt; Type
</span><a href="GHC.Tc.Errors.Types.html#ei_pred"><span class="hs-identifier hs-var">ei_pred</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032264"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032264"><span class="hs-identifier hs-var">pred</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ei_evdest :: ErrorItem -&gt; Maybe TcEvDest
</span><a href="GHC.Tc.Errors.Types.html#ei_evdest"><span class="hs-identifier hs-var">ei_evdest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032265"><span class="annot"><span class="annottext">Maybe TcEvDest
</span><a href="#local-6989586621683032265"><span class="hs-identifier hs-var">m_dest</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ei_loc :: ErrorItem -&gt; CtLoc
</span><a href="GHC.Tc.Errors.Types.html#ei_loc"><span class="hs-identifier hs-var">ei_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032266"><span class="annot"><span class="annottext">CtLoc
</span><a href="#local-6989586621683032266"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1577"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032267"><span class="annot"><span class="annottext">TcEvDest
</span><a href="#local-6989586621683032267"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe TcEvDest
</span><a href="#local-6989586621683032265"><span class="hs-identifier hs-var">m_dest</span></a></span><span>
</span><span id="line-1578"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CtEvidence -&gt; Maybe CtEvidence
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#CtWanted"><span class="hs-identifier hs-type">CtWanted</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ctev_pred :: Type
</span><a href="GHC.Tc.Types.Constraint.html#ctev_pred"><span class="hs-identifier hs-var">ctev_pred</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032264"><span class="hs-identifier hs-var">pred</span></a></span><span>
</span><span id="line-1579"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ctev_dest :: TcEvDest
</span><a href="GHC.Tc.Types.Constraint.html#ctev_dest"><span class="hs-identifier hs-var">ctev_dest</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcEvDest
</span><a href="#local-6989586621683032267"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-1580"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ctev_loc :: CtLoc
</span><a href="GHC.Tc.Types.Constraint.html#ctev_loc"><span class="hs-identifier hs-var">ctev_loc</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CtLoc
</span><a href="#local-6989586621683032266"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-1581"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ctev_rewriters :: RewriterSet
</span><a href="GHC.Tc.Types.Constraint.html#ctev_rewriters"><span class="hs-identifier hs-var">ctev_rewriters</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RewriterSet
</span><a href="GHC.Tc.Types.Constraint.html#emptyRewriterSet"><span class="hs-identifier hs-var">emptyRewriterSet</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1582"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1583"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CtEvidence
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-comment">-- The ErrorItem was a Given</span><span>
</span><span id="line-1584"></span><span>
</span><span id="line-1585"></span><span>
</span><span id="line-1586"></span><span class="hs-comment">-- See Note [Constraints include ...]</span><span>
</span><span id="line-1587"></span><span class="annot"><a href="GHC.Tc.Errors.html#givenConstraints"><span class="hs-identifier hs-type">givenConstraints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-type">RealSrcSpan</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1588"></span><span id="givenConstraints"><span class="annot"><span class="annottext">givenConstraints :: SolverReportErrCtxt -&gt; [(Type, RealSrcSpan)]
</span><a href="GHC.Tc.Errors.html#givenConstraints"><span class="hs-identifier hs-var hs-var">givenConstraints</span></a></span></span><span> </span><span id="local-6989586621683032271"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032271"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>
</span><span id="line-1589"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683032272"><span class="annot"><a href="#local-6989586621683032272"><span class="hs-identifier hs-var">implic</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Implic"><span class="hs-identifier hs-type">Implic</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#ic_given"><span class="hs-identifier hs-var">ic_given</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032273"><span class="annot"><a href="#local-6989586621683032273"><span class="hs-identifier hs-var">given</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; [Implication]
</span><a href="GHC.Tc.Errors.Types.html#cec_encl"><span class="hs-identifier hs-var">cec_encl</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032271"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-1590"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683032274"><span class="annot"><a href="#local-6989586621683032274"><span class="hs-identifier hs-var">constraint</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683032273"><span class="hs-identifier hs-type">given</span></a></span><span>
</span><span id="line-1591"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032274"><span class="hs-identifier hs-type">constraint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.CtLoc.html#getCtLocEnvLoc"><span class="hs-identifier hs-type">getCtLocEnvLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#ic_env"><span class="hs-identifier hs-var">ic_env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032272"><span class="hs-identifier hs-type">implic</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1592"></span><span>
</span><span id="line-1593"></span><span class="hs-comment">----------------</span><span>
</span><span id="line-1594"></span><span>
</span><span id="line-1595"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkIPErr"><span class="hs-identifier hs-type">mkIPErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span>
</span><span id="line-1596"></span><span class="hs-comment">-- What would happen if an item is suppressed because of</span><span>
</span><span id="line-1597"></span><span class="hs-comment">-- Note [Wanteds rewrite Wanteds] in GHC.Tc.Types.Constraint? Very unclear</span><span>
</span><span id="line-1598"></span><span class="hs-comment">-- what's best. Let's not worry about this.</span><span>
</span><span id="line-1599"></span><span id="mkIPErr"><span class="annot"><span class="annottext">mkIPErr :: SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="GHC.Tc.Errors.html#mkIPErr"><span class="hs-identifier hs-var hs-var">mkIPErr</span></a></span></span><span> </span><span id="local-6989586621683032277"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032277"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032278"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032278"><span class="hs-identifier hs-var">item1</span></a></span></span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span id="local-6989586621683032279"><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032279"><span class="hs-identifier hs-var">others</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1600"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032280"><span class="annot"><a href="#local-6989586621683032280"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032281"><span class="annot"><a href="#local-6989586621683032281"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032282"><span class="annot"><a href="#local-6989586621683032282"><span class="hs-identifier hs-var">item1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; SolverReportErrCtxt
-&gt; ErrorItem
-&gt; TcM (SolverReportErrCtxt, RelevantBindings, ErrorItem)
</span><a href="GHC.Tc.Errors.html#relevantBindings"><span class="hs-identifier hs-var">relevantBindings</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032277"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032278"><span class="hs-identifier hs-var">item1</span></a></span><span>
</span><span id="line-1601"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032283"><span class="annot"><a href="#local-6989586621683032283"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TcSolverReportMsg -&gt; SolverReport
</span><a href="GHC.Tc.Errors.html#important"><span class="hs-identifier hs-var">important</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032280"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(TcSolverReportMsg -&gt; SolverReport)
-&gt; TcSolverReportMsg -&gt; SolverReport
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem -&gt; TcSolverReportMsg
</span><a href="GHC.Tc.Errors.Types.html#UnboundImplicitParams"><span class="hs-identifier hs-var">UnboundImplicitParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032282"><span class="hs-identifier hs-var">item1</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; [ErrorItem] -&gt; NonEmpty ErrorItem
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032279"><span class="hs-identifier hs-var">others</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1602"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#add_relevant_bindings"><span class="hs-identifier hs-type">add_relevant_bindings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032281"><span class="hs-identifier hs-type">binds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032283"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1603"></span><span>
</span><span id="line-1604"></span><span class="hs-comment">----------------</span><span>
</span><span id="line-1605"></span><span>
</span><span id="line-1606"></span><span class="hs-comment">-- | Report a representation-polymorphism error to the user:</span><span>
</span><span id="line-1607"></span><span class="hs-comment">-- a type is required to have a fixed runtime representation,</span><span>
</span><span id="line-1608"></span><span class="hs-comment">-- but doesn't.</span><span>
</span><span id="line-1609"></span><span class="hs-comment">--</span><span>
</span><span id="line-1610"></span><span class="hs-comment">-- See Note [Reporting representation-polymorphism errors] in GHC.Tc.Types.Origin.</span><span>
</span><span id="line-1611"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkFRRErr"><span class="hs-identifier hs-type">mkFRRErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span>
</span><span id="line-1612"></span><span id="mkFRRErr"><span class="annot"><span class="annottext">mkFRRErr :: HasDebugCallStack =&gt;
SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="GHC.Tc.Errors.html#mkFRRErr"><span class="hs-identifier hs-var hs-var">mkFRRErr</span></a></span></span><span> </span><span id="local-6989586621683032291"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032291"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032292"><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683032292"><span class="hs-identifier hs-var">items</span></a></span></span><span>
</span><span id="line-1613"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Process the error items.</span><span>
</span><span id="line-1614"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032293"><span class="annot"><a href="#local-6989586621683032293"><span class="hs-identifier hs-var">_tidy_env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032294"><span class="annot"><a href="#local-6989586621683032294"><span class="hs-identifier hs-var">frr_infos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1615"></span><span>          </span><span class="annot"><span class="annottext">ZonkM (TidyEnv, [FixedRuntimeRepErrorInfo])
-&gt; TcM (TidyEnv, [FixedRuntimeRepErrorInfo])
forall a. ZonkM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#liftZonkM"><span class="hs-identifier hs-var">liftZonkM</span></a></span><span> </span><span class="annot"><span class="annottext">(ZonkM (TidyEnv, [FixedRuntimeRepErrorInfo])
 -&gt; TcM (TidyEnv, [FixedRuntimeRepErrorInfo]))
-&gt; ZonkM (TidyEnv, [FixedRuntimeRepErrorInfo])
-&gt; TcM (TidyEnv, [FixedRuntimeRepErrorInfo])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TidyEnv
-&gt; [FixedRuntimeRepErrorInfo]
-&gt; ZonkM (TidyEnv, [FixedRuntimeRepErrorInfo])
</span><a href="GHC.Tc.Zonk.TcType.html#zonkTidyFRRInfos"><span class="hs-identifier hs-var">zonkTidyFRRInfos</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TidyEnv
</span><a href="GHC.Tc.Errors.Types.html#cec_tidy"><span class="hs-identifier hs-var">cec_tidy</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032291"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([FixedRuntimeRepErrorInfo]
 -&gt; ZonkM (TidyEnv, [FixedRuntimeRepErrorInfo]))
-&gt; [FixedRuntimeRepErrorInfo]
-&gt; ZonkM (TidyEnv, [FixedRuntimeRepErrorInfo])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1616"></span><span>            </span><span class="hs-comment">-- Zonk/tidy to show useful variable names.</span><span>
</span><span id="line-1617"></span><span>          </span><span class="annot"><span class="annottext">(FixedRuntimeRepErrorInfo -&gt; FixedRuntimeRepErrorInfo -&gt; Ordering)
-&gt; [FixedRuntimeRepErrorInfo] -&gt; [FixedRuntimeRepErrorInfo]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><a href="GHC.Data.List.SetOps.html#nubOrdBy"><span class="hs-identifier hs-var">nubOrdBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Ordering
</span><a href="GHC.Core.TyCo.Compare.html#nonDetCmpType"><span class="hs-identifier hs-var">nonDetCmpType</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Ordering)
-&gt; (FixedRuntimeRepErrorInfo -&gt; Type)
-&gt; FixedRuntimeRepErrorInfo
-&gt; FixedRuntimeRepErrorInfo
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FixedRuntimeRepOrigin -&gt; Type
</span><a href="GHC.Tc.Types.Origin.html#frr_type"><span class="hs-identifier hs-var">frr_type</span></a></span><span> </span><span class="annot"><span class="annottext">(FixedRuntimeRepOrigin -&gt; Type)
-&gt; (FixedRuntimeRepErrorInfo -&gt; FixedRuntimeRepOrigin)
-&gt; FixedRuntimeRepErrorInfo
-&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepErrorInfo -&gt; FixedRuntimeRepOrigin
</span><a href="GHC.Tc.Errors.Types.html#frr_info_origin"><span class="hs-identifier hs-var">frr_info_origin</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([FixedRuntimeRepErrorInfo] -&gt; [FixedRuntimeRepErrorInfo])
-&gt; [FixedRuntimeRepErrorInfo] -&gt; [FixedRuntimeRepErrorInfo]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1618"></span><span>            </span><span class="hs-comment">-- Remove duplicates: only one representation-polymorphism error per type.</span><span>
</span><span id="line-1619"></span><span>          </span><span class="annot"><span class="annottext">(ErrorItem -&gt; FixedRuntimeRepErrorInfo)
-&gt; [ErrorItem] -&gt; [FixedRuntimeRepErrorInfo]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
-&gt; Maybe FixedRuntimeRepErrorInfo -&gt; FixedRuntimeRepErrorInfo
forall a. HasDebugCallStack =&gt; String -&gt; Maybe a -&gt; a
</span><a href="GHC.Data.Maybe.html#expectJust"><span class="hs-identifier hs-var">expectJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkFRRErr&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe FixedRuntimeRepErrorInfo -&gt; FixedRuntimeRepErrorInfo)
-&gt; (ErrorItem -&gt; Maybe FixedRuntimeRepErrorInfo)
-&gt; ErrorItem
-&gt; FixedRuntimeRepErrorInfo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; ErrorItem -&gt; Maybe FixedRuntimeRepErrorInfo
ErrorItem -&gt; Maybe FixedRuntimeRepErrorInfo
</span><a href="GHC.Tc.Errors.html#fixedRuntimeRepOrigin_maybe"><span class="hs-identifier hs-var">fixedRuntimeRepOrigin_maybe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ErrorItem] -&gt; [FixedRuntimeRepErrorInfo])
-&gt; [ErrorItem] -&gt; [FixedRuntimeRepErrorInfo]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1620"></span><span>          </span><span class="annot"><span class="annottext">NonEmpty ErrorItem -&gt; [ErrorItem]
forall a. NonEmpty a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683032292"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-1621"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#important"><span class="hs-identifier hs-type">important</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032291"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#FixedRuntimeRepError"><span class="hs-identifier hs-type">FixedRuntimeRepError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032294"><span class="hs-identifier hs-type">frr_infos</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1622"></span><span>
</span><span id="line-1623"></span><span class="annot"><span class="hs-comment">-- | Whether to report something using the @FixedRuntimeRep@ mechanism.</span></span><span>
</span><span id="line-1624"></span><span class="annot"><a href="GHC.Tc.Errors.html#fixedRuntimeRepOrigin_maybe"><span class="hs-identifier hs-type">fixedRuntimeRepOrigin_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#FixedRuntimeRepErrorInfo"><span class="hs-identifier hs-type">FixedRuntimeRepErrorInfo</span></a></span><span>
</span><span id="line-1625"></span><span id="fixedRuntimeRepOrigin_maybe"><span class="annot"><span class="annottext">fixedRuntimeRepOrigin_maybe :: HasDebugCallStack =&gt; ErrorItem -&gt; Maybe FixedRuntimeRepErrorInfo
</span><a href="GHC.Tc.Errors.html#fixedRuntimeRepOrigin_maybe"><span class="hs-identifier hs-var hs-var">fixedRuntimeRepOrigin_maybe</span></a></span></span><span> </span><span id="local-6989586621683032300"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032300"><span class="hs-identifier hs-var">item</span></a></span></span><span>
</span><span id="line-1626"></span><span>  </span><span class="hs-comment">-- An error that arose directly from a representation-polymorphism check.</span><span>
</span><span id="line-1627"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#FRROrigin"><span class="hs-identifier hs-type">FRROrigin</span></a></span><span> </span><span id="local-6989586621683032301"><span class="annot"><span class="annottext">FixedRuntimeRepOrigin
</span><a href="#local-6989586621683032301"><span class="hs-identifier hs-var">frr_orig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; CtOrigin
</span><a href="GHC.Tc.Errors.Types.html#errorItemOrigin"><span class="hs-identifier hs-var">errorItemOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032300"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-1628"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepErrorInfo -&gt; Maybe FixedRuntimeRepErrorInfo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(FixedRuntimeRepErrorInfo -&gt; Maybe FixedRuntimeRepErrorInfo)
-&gt; FixedRuntimeRepErrorInfo -&gt; Maybe FixedRuntimeRepErrorInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#FRR_Info"><span class="hs-identifier hs-type">FRR_Info</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">frr_info_origin :: FixedRuntimeRepOrigin
</span><a href="GHC.Tc.Errors.Types.html#frr_info_origin"><span class="hs-identifier hs-var">frr_info_origin</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepOrigin
</span><a href="#local-6989586621683032301"><span class="hs-identifier hs-var">frr_orig</span></a></span><span>
</span><span id="line-1629"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">frr_info_not_concrete :: Maybe (TcId, Type)
</span><a href="GHC.Tc.Errors.Types.html#frr_info_not_concrete"><span class="hs-identifier hs-var">frr_info_not_concrete</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TcId, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1630"></span><span>  </span><span class="hs-comment">-- A nominal equality involving a concrete type variable,</span><span>
</span><span id="line-1631"></span><span>  </span><span class="hs-comment">-- such as @alpha[conc] ~# rr[sk]@ or @beta[conc] ~# RR@ for a</span><span>
</span><span id="line-1632"></span><span>  </span><span class="hs-comment">-- type family application @RR@.</span><span>
</span><span id="line-1633"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html#EqPred"><span class="hs-identifier hs-type">EqPred</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a></span><span> </span><span id="local-6989586621683032302"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032302"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621683032303"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032303"><span class="hs-identifier hs-var">ty2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pred
</span><a href="GHC.Core.Predicate.html#classifyPredType"><span class="hs-identifier hs-var">classifyPredType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; Type
</span><a href="GHC.Tc.Errors.Types.html#errorItemPred"><span class="hs-identifier hs-var">errorItemPred</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032300"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1634"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032304"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032304"><span class="hs-identifier hs-var">tv1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteFRR"><span class="hs-identifier hs-type">ConcreteFRR</span></a></span><span> </span><span id="local-6989586621683032306"><span class="annot"><span class="annottext">FixedRuntimeRepOrigin
</span><a href="#local-6989586621683032306"><span class="hs-identifier hs-var">frr1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TcId, ConcreteTvOrigin)
</span><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVarTy_maybe"><span class="hs-identifier hs-var">isConcreteTyVarTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032302"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-1635"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepErrorInfo -&gt; Maybe FixedRuntimeRepErrorInfo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(FixedRuntimeRepErrorInfo -&gt; Maybe FixedRuntimeRepErrorInfo)
-&gt; FixedRuntimeRepErrorInfo -&gt; Maybe FixedRuntimeRepErrorInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepOrigin
-&gt; Maybe (TcId, Type) -&gt; FixedRuntimeRepErrorInfo
</span><a href="GHC.Tc.Errors.Types.html#FRR_Info"><span class="hs-identifier hs-var">FRR_Info</span></a></span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepOrigin
</span><a href="#local-6989586621683032306"><span class="hs-identifier hs-var">frr1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TcId, Type) -&gt; Maybe (TcId, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032304"><span class="hs-identifier hs-var">tv1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032303"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1636"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032308"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032308"><span class="hs-identifier hs-var">tv2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteFRR"><span class="hs-identifier hs-type">ConcreteFRR</span></a></span><span> </span><span id="local-6989586621683032309"><span class="annot"><span class="annottext">FixedRuntimeRepOrigin
</span><a href="#local-6989586621683032309"><span class="hs-identifier hs-var">frr2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TcId, ConcreteTvOrigin)
</span><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVarTy_maybe"><span class="hs-identifier hs-var">isConcreteTyVarTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032303"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1637"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepErrorInfo -&gt; Maybe FixedRuntimeRepErrorInfo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(FixedRuntimeRepErrorInfo -&gt; Maybe FixedRuntimeRepErrorInfo)
-&gt; FixedRuntimeRepErrorInfo -&gt; Maybe FixedRuntimeRepErrorInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepOrigin
-&gt; Maybe (TcId, Type) -&gt; FixedRuntimeRepErrorInfo
</span><a href="GHC.Tc.Errors.Types.html#FRR_Info"><span class="hs-identifier hs-var">FRR_Info</span></a></span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepOrigin
</span><a href="#local-6989586621683032309"><span class="hs-identifier hs-var">frr2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TcId, Type) -&gt; Maybe (TcId, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032308"><span class="hs-identifier hs-var">tv2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032302"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1638"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1639"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FixedRuntimeRepErrorInfo
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1640"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1641"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FixedRuntimeRepErrorInfo
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1642"></span><span>
</span><span id="line-1643"></span><span class="hs-comment">{-
Note [Constraints include ...]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
'givenConstraintsMsg' returns the &quot;Constraints include ...&quot; message enabled by
-fshow-hole-constraints. For example, the following hole:

    foo :: (Eq a, Show a) =&gt; a -&gt; String
    foo x = _

would generate the message:

    Constraints include
      Eq a (from foo.hs:1:1-36)
      Show a (from foo.hs:1:1-36)

Constraints are displayed in order from innermost (closest to the hole) to
outermost. There's currently no filtering or elimination of duplicates.

************************************************************************
*                                                                      *
                Equality errors
*                                                                      *
************************************************************************

Note [Inaccessible code]
~~~~~~~~~~~~~~~~~~~~~~~~
Consider
   data T a where
     T1 :: T a
     T2 :: T Bool

   f :: (a ~ Int) =&gt; T a -&gt; Int
   f T1 = 3
   f T2 = 4   -- Unreachable code

Here the second equation is unreachable. The original constraint
(a~Int) from the signature gets rewritten by the pattern-match to
(Bool~Int), so the danger is that we report the error as coming from
the *signature* (#7293).  So, for Given errors we replace the
env (and hence src-loc) on its CtLoc with that from the immediately
enclosing implication.

Note [Error messages for untouchables]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider (#9109)
  data G a where { GBool :: G Bool }
  foo x = case x of GBool -&gt; True

Here we can't solve (t ~ Bool), where t is the untouchable result
meta-var 't', because of the (a ~ Bool) from the pattern match.
So we infer the type
   f :: forall a t. G a -&gt; t
making the meta-var 't' into a skolem.  So when we come to report
the unsolved (t ~ Bool), t won't look like an untouchable meta-var
any more.  So we don't assert that it is.
-}</span><span>
</span><span id="line-1699"></span><span>
</span><span id="line-1700"></span><span class="hs-comment">-- Don't have multiple equality errors from the same location</span><span>
</span><span id="line-1701"></span><span class="hs-comment">-- E.g.   (Int,Bool) ~ (Bool,Int)   one error will do!</span><span>
</span><span id="line-1702"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkEqErr"><span class="hs-identifier hs-type">mkEqErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span>
</span><span id="line-1703"></span><span id="mkEqErr"><span class="annot"><span class="annottext">mkEqErr :: SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="GHC.Tc.Errors.html#mkEqErr"><span class="hs-identifier hs-var hs-var">mkEqErr</span></a></span></span><span> </span><span id="local-6989586621683032310"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032310"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032311"><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683032311"><span class="hs-identifier hs-var">items</span></a></span></span><span>
</span><span id="line-1704"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621683032312"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032312"><span class="hs-identifier hs-var">item1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ErrorItem -&gt; Bool) -&gt; NonEmpty ErrorItem -&gt; NonEmpty ErrorItem
forall a. (a -&gt; Bool) -&gt; NonEmpty a -&gt; NonEmpty a
</span><a href="GHC.Tc.Errors.html#tryFilter"><span class="hs-identifier hs-var">tryFilter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (ErrorItem -&gt; Bool) -&gt; ErrorItem -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Bool
</span><a href="GHC.Tc.Errors.Types.html#ei_suppress"><span class="hs-identifier hs-var">ei_suppress</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683032311"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-1705"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; ErrorItem -&gt; TcM SolverReport
</span><a href="GHC.Tc.Errors.html#mkEqErr1"><span class="hs-identifier hs-var">mkEqErr1</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032310"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032312"><span class="hs-identifier hs-var">item1</span></a></span><span>
</span><span id="line-1706"></span><span>
</span><span id="line-1707"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkEqErr1"><span class="hs-identifier hs-type">mkEqErr1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span>
</span><span id="line-1708"></span><span id="mkEqErr1"><span class="annot"><span class="annottext">mkEqErr1 :: SolverReportErrCtxt -&gt; ErrorItem -&gt; TcM SolverReport
</span><a href="GHC.Tc.Errors.html#mkEqErr1"><span class="hs-identifier hs-var hs-var">mkEqErr1</span></a></span></span><span> </span><span id="local-6989586621683032314"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032314"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032315"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032315"><span class="hs-identifier hs-var">item</span></a></span></span><span>   </span><span class="hs-comment">-- Wanted only</span><span>
</span><span id="line-1709"></span><span>                     </span><span class="hs-comment">-- givens handled in mkGivenErrorReporter</span><span>
</span><span id="line-1710"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032316"><span class="annot"><a href="#local-6989586621683032316"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032317"><span class="annot"><a href="#local-6989586621683032317"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032318"><span class="annot"><a href="#local-6989586621683032318"><span class="hs-identifier hs-var">item</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; SolverReportErrCtxt
-&gt; ErrorItem
-&gt; TcM (SolverReportErrCtxt, RelevantBindings, ErrorItem)
</span><a href="GHC.Tc.Errors.html#relevantBindings"><span class="hs-identifier hs-var">relevantBindings</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032314"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032315"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-1711"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-type">traceTc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mkEqErr1&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032318"><span class="hs-identifier hs-type">item</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#pprCtOrigin"><span class="hs-identifier hs-type">pprCtOrigin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#errorItemOrigin"><span class="hs-identifier hs-type">errorItemOrigin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032318"><span class="hs-identifier hs-type">item</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1712"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683032320"><span class="annot"><a href="#local-6989586621683032320"><span class="hs-identifier hs-var">err_msg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#mkEqErr_help"><span class="hs-identifier hs-type">mkEqErr_help</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032316"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032318"><span class="hs-identifier hs-type">item</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032321"><span class="hs-identifier hs-type">ty1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032322"><span class="hs-identifier hs-type">ty2</span></a></span><span>
</span><span id="line-1713"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-1714"></span><span>           </span><span id="local-6989586621683032323"><span class="annot"><a href="#local-6989586621683032323"><span class="hs-identifier hs-var hs-var">report</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RelevantBindings -&gt; SolverReport -&gt; SolverReport
</span><a href="GHC.Tc.Errors.html#add_relevant_bindings"><span class="hs-identifier hs-var">add_relevant_bindings</span></a></span><span> </span><span class="annot"><span class="annottext">RelevantBindings
</span><a href="#local-6989586621683032317"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-1715"></span><span>                  </span><span class="annot"><span class="annottext">(SolverReport -&gt; SolverReport) -&gt; SolverReport -&gt; SolverReport
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TcSolverReportMsg -&gt; SolverReport
</span><a href="GHC.Tc.Errors.html#important"><span class="hs-identifier hs-var">important</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032316"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">TcSolverReportMsg
</span><a href="#local-6989586621683032320"><span class="hs-identifier hs-var">err_msg</span></a></span><span>
</span><span id="line-1716"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621683032323"><span class="hs-identifier hs-type">report</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1717"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1718"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621683032321"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032321"><span class="hs-identifier hs-var">ty1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032322"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032322"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type, Type)
</span><a href="GHC.Core.Predicate.html#getEqPredTys"><span class="hs-identifier hs-var">getEqPredTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; Type
</span><a href="GHC.Tc.Errors.Types.html#errorItemPred"><span class="hs-identifier hs-var">errorItemPred</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032315"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1719"></span><span>
</span><span id="line-1720"></span><span class="hs-comment">-- | This function tries to reconstruct why a &quot;Coercible ty1 ty2&quot; constraint</span><span>
</span><span id="line-1721"></span><span class="hs-comment">-- is left over.</span><span>
</span><span id="line-1722"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkCoercibleExplanation"><span class="hs-identifier hs-type">mkCoercibleExplanation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a></span><span>
</span><span id="line-1723"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#CoercibleMsg"><span class="hs-identifier hs-type">CoercibleMsg</span></a></span><span>
</span><span id="line-1724"></span><span id="mkCoercibleExplanation"><span class="annot"><span class="annottext">mkCoercibleExplanation :: GlobalRdrEnv -&gt; FamInstEnvs -&gt; Type -&gt; Type -&gt; Maybe CoercibleMsg
</span><a href="GHC.Tc.Errors.html#mkCoercibleExplanation"><span class="hs-identifier hs-var hs-var">mkCoercibleExplanation</span></a></span></span><span> </span><span id="local-6989586621683032326"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683032326"><span class="hs-identifier hs-var">rdr_env</span></a></span></span><span> </span><span id="local-6989586621683032327"><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621683032327"><span class="hs-identifier hs-var">fam_envs</span></a></span></span><span> </span><span id="local-6989586621683032328"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032328"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621683032329"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032329"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>
</span><span id="line-1725"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032330"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032330"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032331"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683032331"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032328"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-1726"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032332"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032332"><span class="hs-identifier hs-var">rep_tc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcCoercionN
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FamInstEnvs -&gt; TyCon -&gt; [Type] -&gt; (TyCon, [Type], TcCoercionN)
</span><a href="GHC.Tc.Instance.Family.html#tcLookupDataFamInst"><span class="hs-identifier hs-var">tcLookupDataFamInst</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621683032327"><span class="hs-identifier hs-var">fam_envs</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032330"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683032331"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1727"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032334"><span class="annot"><span class="annottext">CoercibleMsg
</span><a href="#local-6989586621683032334"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe CoercibleMsg
</span><a href="#local-6989586621683032335"><span class="hs-identifier hs-var">coercible_msg_for_tycon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032332"><span class="hs-identifier hs-var">rep_tc</span></a></span><span>
</span><span id="line-1728"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoercibleMsg -&gt; Maybe CoercibleMsg
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">CoercibleMsg
</span><a href="#local-6989586621683032334"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-1729"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032336"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032336"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032337"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683032337"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032329"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1730"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032339"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032339"><span class="hs-identifier hs-var">rep_tc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcCoercionN
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FamInstEnvs -&gt; TyCon -&gt; [Type] -&gt; (TyCon, [Type], TcCoercionN)
</span><a href="GHC.Tc.Instance.Family.html#tcLookupDataFamInst"><span class="hs-identifier hs-var">tcLookupDataFamInst</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621683032327"><span class="hs-identifier hs-var">fam_envs</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032336"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683032337"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1731"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032340"><span class="annot"><span class="annottext">CoercibleMsg
</span><a href="#local-6989586621683032340"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe CoercibleMsg
</span><a href="#local-6989586621683032335"><span class="hs-identifier hs-var">coercible_msg_for_tycon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032339"><span class="hs-identifier hs-var">rep_tc</span></a></span><span>
</span><span id="line-1732"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoercibleMsg -&gt; Maybe CoercibleMsg
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">CoercibleMsg
</span><a href="#local-6989586621683032340"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-1733"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032341"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032341"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier hs-var">tcSplitAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032328"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-1734"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032343"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032343"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier hs-var">tcSplitAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032329"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1735"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032341"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032343"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-1736"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621683032344"><span class="hs-identifier hs-var">has_unknown_roles</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032341"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-1737"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoercibleMsg -&gt; Maybe CoercibleMsg
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoercibleMsg -&gt; Maybe CoercibleMsg)
-&gt; CoercibleMsg -&gt; Maybe CoercibleMsg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; CoercibleMsg
</span><a href="GHC.Tc.Errors.Types.html#UnknownRoles"><span class="hs-identifier hs-var">UnknownRoles</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032341"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-1738"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1739"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoercibleMsg
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1740"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1741"></span><span>    </span><span id="local-6989586621683032335"><span class="annot"><span class="annottext">coercible_msg_for_tycon :: TyCon -&gt; Maybe CoercibleMsg
</span><a href="#local-6989586621683032335"><span class="hs-identifier hs-var hs-var">coercible_msg_for_tycon</span></a></span></span><span> </span><span id="local-6989586621683032346"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032346"><span class="hs-identifier hs-var">tc</span></a></span></span><span>
</span><span id="line-1742"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isAbstractTyCon"><span class="hs-identifier hs-var">isAbstractTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032346"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1743"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoercibleMsg -&gt; Maybe CoercibleMsg
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoercibleMsg -&gt; Maybe CoercibleMsg)
-&gt; CoercibleMsg -&gt; Maybe CoercibleMsg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; CoercibleMsg
</span><a href="GHC.Tc.Errors.Types.html#TyConIsAbstract"><span class="hs-identifier hs-var">TyConIsAbstract</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032346"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1744"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032346"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1745"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621683032350"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683032350"><span class="hs-identifier hs-var">data_con</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [DataCon]
</span><a href="GHC.Core.TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032346"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1746"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032352"><span class="annot"><span class="annottext">dc_name :: Name
</span><a href="#local-6989586621683032352"><span class="hs-identifier hs-var hs-var">dc_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Name
</span><a href="GHC.Core.DataCon.html#dataConName"><span class="hs-identifier hs-var">dataConName</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683032350"><span class="hs-identifier hs-var">data_con</span></a></span><span>
</span><span id="line-1747"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (GlobalRdrEltX GREInfo) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; Name -&gt; Maybe (GlobalRdrEltX GREInfo)
forall info.
Outputable info =&gt;
GlobalRdrEnvX info -&gt; Name -&gt; Maybe (GlobalRdrEltX info)
</span><a href="GHC.Types.Name.Reader.html#lookupGRE_Name"><span class="hs-identifier hs-var">lookupGRE_Name</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683032326"><span class="hs-identifier hs-var">rdr_env</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032352"><span class="hs-identifier hs-var">dc_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1748"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoercibleMsg -&gt; Maybe CoercibleMsg
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoercibleMsg -&gt; Maybe CoercibleMsg)
-&gt; CoercibleMsg -&gt; Maybe CoercibleMsg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; DataCon -&gt; CoercibleMsg
</span><a href="GHC.Tc.Errors.Types.html#OutOfScopeNewtypeConstructor"><span class="hs-identifier hs-var">OutOfScopeNewtypeConstructor</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032346"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683032350"><span class="hs-identifier hs-var">data_con</span></a></span><span>
</span><span id="line-1749"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoercibleMsg
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1750"></span><span>
</span><span id="line-1751"></span><span>    </span><span id="local-6989586621683032344"><span class="annot"><span class="annottext">has_unknown_roles :: Type -&gt; Bool
</span><a href="#local-6989586621683032344"><span class="hs-identifier hs-var hs-var">has_unknown_roles</span></a></span></span><span> </span><span id="local-6989586621683032358"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032358"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1752"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032359"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032359"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032360"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683032360"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032358"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1753"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683032360"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Int -&gt; Bool
forall a. [a] -&gt; Int -&gt; Bool
</span><a href="GHC.Utils.Misc.html#lengthAtLeast"><span class="hs-operator hs-var">`lengthAtLeast`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Int
</span><a href="GHC.Core.TyCon.html#tyConArity"><span class="hs-identifier hs-var">tyConArity</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032359"><span class="hs-identifier hs-var">tc</span></a></span><span>  </span><span class="hs-comment">-- oversaturated tycon</span><span>
</span><span id="line-1754"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032363"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032363"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier hs-var">tcSplitAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032358"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1755"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621683032344"><span class="hs-identifier hs-var">has_unknown_roles</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032363"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1756"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTyVarTy"><span class="hs-identifier hs-var">isTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032358"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1757"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1758"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1759"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1760"></span><span>
</span><span id="line-1761"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkEqErr_help"><span class="hs-identifier hs-type">mkEqErr_help</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span>
</span><span id="line-1762"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span>
</span><span id="line-1763"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcSolverReportMsg"><span class="hs-identifier hs-type">TcSolverReportMsg</span></a></span><span>
</span><span id="line-1764"></span><span id="mkEqErr_help"><span class="annot"><span class="annottext">mkEqErr_help :: SolverReportErrCtxt
-&gt; ErrorItem -&gt; Type -&gt; Type -&gt; TcM TcSolverReportMsg
</span><a href="GHC.Tc.Errors.html#mkEqErr_help"><span class="hs-identifier hs-var hs-var">mkEqErr_help</span></a></span></span><span> </span><span id="local-6989586621683032364"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032364"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032365"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032365"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span id="local-6989586621683032366"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032366"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621683032367"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032367"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>
</span><span id="line-1765"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032368"><span class="annot"><span class="annottext">(TcId, TcCoercionN)
</span><a href="#local-6989586621683032368"><span class="hs-identifier hs-var">casted_tv1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TcId, TcCoercionN)
</span><a href="GHC.Core.Type.html#getCastedTyVar_maybe"><span class="hs-identifier hs-var">getCastedTyVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032366"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-1766"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
-&gt; ErrorItem
-&gt; (TcId, TcCoercionN)
-&gt; Type
-&gt; TcM TcSolverReportMsg
</span><a href="GHC.Tc.Errors.html#mkTyVarEqErr"><span class="hs-identifier hs-var">mkTyVarEqErr</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032364"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032365"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">(TcId, TcCoercionN)
</span><a href="#local-6989586621683032368"><span class="hs-identifier hs-var">casted_tv1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032367"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1767"></span><span>
</span><span id="line-1768"></span><span>  </span><span class="hs-comment">-- ToDo: explain..  Cf T2627b   Dual (Dual a) ~ a</span><span>
</span><span id="line-1769"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032371"><span class="annot"><span class="annottext">(TcId, TcCoercionN)
</span><a href="#local-6989586621683032371"><span class="hs-identifier hs-var">casted_tv2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TcId, TcCoercionN)
</span><a href="GHC.Core.Type.html#getCastedTyVar_maybe"><span class="hs-identifier hs-var">getCastedTyVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032367"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1770"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
-&gt; ErrorItem
-&gt; (TcId, TcCoercionN)
-&gt; Type
-&gt; TcM TcSolverReportMsg
</span><a href="GHC.Tc.Errors.html#mkTyVarEqErr"><span class="hs-identifier hs-var">mkTyVarEqErr</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032364"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032365"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">(TcId, TcCoercionN)
</span><a href="#local-6989586621683032371"><span class="hs-identifier hs-var">casted_tv2</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032366"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-1771"></span><span>
</span><span id="line-1772"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1773"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
-&gt; ErrorItem -&gt; Type -&gt; Type -&gt; TcM TcSolverReportMsg
</span><a href="GHC.Tc.Errors.html#reportEqErr"><span class="hs-identifier hs-var">reportEqErr</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032364"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032365"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032366"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032367"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1774"></span><span>
</span><span id="line-1775"></span><span class="annot"><a href="GHC.Tc.Errors.html#reportEqErr"><span class="hs-identifier hs-type">reportEqErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span>
</span><span id="line-1776"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span>
</span><span id="line-1777"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span>
</span><span id="line-1778"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcSolverReportMsg"><span class="hs-identifier hs-type">TcSolverReportMsg</span></a></span><span>
</span><span id="line-1779"></span><span id="reportEqErr"><span class="annot"><span class="annottext">reportEqErr :: SolverReportErrCtxt
-&gt; ErrorItem -&gt; Type -&gt; Type -&gt; TcM TcSolverReportMsg
</span><a href="GHC.Tc.Errors.html#reportEqErr"><span class="hs-identifier hs-var hs-var">reportEqErr</span></a></span></span><span> </span><span id="local-6989586621683032373"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032373"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032374"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032374"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span id="local-6989586621683032375"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032375"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621683032376"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032376"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>
</span><span id="line-1780"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1781"></span><span>    </span><span id="local-6989586621683032377"><span class="annot"><a href="#local-6989586621683032377"><span class="hs-identifier hs-var">mb_coercible_info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; EqRel
</span><a href="GHC.Tc.Errors.Types.html#errorItemEqRel"><span class="hs-identifier hs-var">errorItemEqRel</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032374"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; EqRel -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a></span><span>
</span><span id="line-1782"></span><span>                         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; TcM (Maybe CoercibleMsg)
</span><a href="GHC.Tc.Errors.html#coercible_msg"><span class="hs-identifier hs-var">coercible_msg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032375"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032376"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1783"></span><span>                         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe CoercibleMsg -&gt; TcM (Maybe CoercibleMsg)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe CoercibleMsg
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1784"></span><span>    </span><span id="local-6989586621683032381"><span class="annot"><a href="#local-6989586621683032381"><span class="hs-identifier hs-var">tv_info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#getTyVar_maybe"><span class="hs-identifier hs-type">getTyVar_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032376"><span class="hs-identifier hs-type">ty2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1785"></span><span>                 </span><span class="annot"><span class="annottext">Maybe TcId
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe TyVarInfo -&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe TyVarInfo)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe TyVarInfo
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1786"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032382"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032382"><span class="hs-identifier hs-var">tv2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyVarInfo -&gt; Maybe TyVarInfo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(TyVarInfo -&gt; Maybe TyVarInfo)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) TyVarInfo
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe TyVarInfo)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TcId, Maybe Implication)
-&gt; Type -&gt; IOEnv (Env TcGblEnv TcLclEnv) TyVarInfo
</span><a href="GHC.Tc.Errors.html#extraTyVarEqInfo"><span class="hs-identifier hs-var">extraTyVarEqInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032382"><span class="hs-identifier hs-var">tv2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Implication
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032375"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-1787"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#Mismatch"><span class="hs-identifier hs-type">Mismatch</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#mismatchMsg"><span class="hs-identifier hs-var">mismatchMsg</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683032386"><span class="hs-identifier hs-type">mismatch</span></a></span><span>
</span><span id="line-1788"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#mismatchTyVarInfo"><span class="hs-identifier hs-var">mismatchTyVarInfo</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683032381"><span class="hs-identifier hs-type">tv_info</span></a></span><span>
</span><span id="line-1789"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#mismatchAmbiguityInfo"><span class="hs-identifier hs-var">mismatchAmbiguityInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683032389"><span class="hs-identifier hs-type">eqInfos</span></a></span><span>
</span><span id="line-1790"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#mismatchCoercibleInfo"><span class="hs-identifier hs-var">mismatchCoercibleInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683032377"><span class="hs-identifier hs-type">mb_coercible_info</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1791"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1792"></span><span>    </span><span id="local-6989586621683032386"><span class="annot"><span class="annottext">mismatch :: MismatchMsg
</span><a href="#local-6989586621683032386"><span class="hs-identifier hs-var hs-var">mismatch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; ErrorItem -&gt; Type -&gt; Type -&gt; MismatchMsg
</span><a href="GHC.Tc.Errors.html#misMatchOrCND"><span class="hs-identifier hs-var">misMatchOrCND</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032373"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032374"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032375"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032376"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1793"></span><span>    </span><span id="local-6989586621683032389"><span class="annot"><span class="annottext">eqInfos :: [AmbiguityInfo]
</span><a href="#local-6989586621683032389"><span class="hs-identifier hs-var hs-var">eqInfos</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [AmbiguityInfo]
</span><a href="GHC.Tc.Errors.html#eqInfoMsgs"><span class="hs-identifier hs-var">eqInfoMsgs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032375"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032376"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1794"></span><span>
</span><span id="line-1795"></span><span class="annot"><a href="GHC.Tc.Errors.html#coercible_msg"><span class="hs-identifier hs-type">coercible_msg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#CoercibleMsg"><span class="hs-identifier hs-type">CoercibleMsg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1796"></span><span id="coercible_msg"><span class="annot"><span class="annottext">coercible_msg :: Type -&gt; Type -&gt; TcM (Maybe CoercibleMsg)
</span><a href="GHC.Tc.Errors.html#coercible_msg"><span class="hs-identifier hs-var hs-var">coercible_msg</span></a></span></span><span> </span><span id="local-6989586621683032393"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032393"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621683032394"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032394"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>
</span><span id="line-1797"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1798"></span><span>    </span><span id="local-6989586621683032395"><span class="annot"><a href="#local-6989586621683032395"><span class="hs-identifier hs-var">rdr_env</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRn GlobalRdrEnv
</span><a href="GHC.Tc.Utils.Monad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a></span><span>
</span><span id="line-1799"></span><span>    </span><span id="local-6989586621683032397"><span class="annot"><a href="#local-6989586621683032397"><span class="hs-identifier hs-var">fam_envs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Instance.Family.html#tcGetFamInstEnvs"><span class="hs-identifier hs-type">tcGetFamInstEnvs</span></a></span><span>
</span><span id="line-1800"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#mkCoercibleExplanation"><span class="hs-identifier hs-type">mkCoercibleExplanation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032395"><span class="hs-identifier hs-type">rdr_env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032397"><span class="hs-identifier hs-type">fam_envs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032393"><span class="hs-identifier hs-type">ty1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032394"><span class="hs-identifier hs-type">ty2</span></a></span><span>
</span><span id="line-1801"></span><span>
</span><span id="line-1802"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkTyVarEqErr"><span class="hs-identifier hs-type">mkTyVarEqErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span>
</span><span id="line-1803"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcSolverReportMsg"><span class="hs-identifier hs-type">TcSolverReportMsg</span></a></span><span>
</span><span id="line-1804"></span><span class="hs-comment">-- tv1 and ty2 are already tidied</span><span>
</span><span id="line-1805"></span><span id="mkTyVarEqErr"><span class="annot"><span class="annottext">mkTyVarEqErr :: SolverReportErrCtxt
-&gt; ErrorItem
-&gt; (TcId, TcCoercionN)
-&gt; Type
-&gt; TcM TcSolverReportMsg
</span><a href="GHC.Tc.Errors.html#mkTyVarEqErr"><span class="hs-identifier hs-var hs-var">mkTyVarEqErr</span></a></span></span><span> </span><span id="local-6989586621683032399"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032399"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032400"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032400"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span id="local-6989586621683032401"><span class="annot"><span class="annottext">(TcId, TcCoercionN)
</span><a href="#local-6989586621683032401"><span class="hs-identifier hs-var">casted_tv1</span></a></span></span><span> </span><span id="local-6989586621683032402"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032402"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>
</span><span id="line-1806"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkTyVarEqErr&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032400"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">(TcId, TcCoercionN) -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">(TcId, TcCoercionN)
</span><a href="#local-6989586621683032401"><span class="hs-identifier hs-var">casted_tv1</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032402"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1807"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
-&gt; ErrorItem
-&gt; (TcId, TcCoercionN)
-&gt; Type
-&gt; TcM TcSolverReportMsg
</span><a href="GHC.Tc.Errors.html#mkTyVarEqErr%27"><span class="hs-identifier hs-var">mkTyVarEqErr'</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032399"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032400"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">(TcId, TcCoercionN)
</span><a href="#local-6989586621683032401"><span class="hs-identifier hs-var">casted_tv1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032402"><span class="hs-identifier hs-var">ty2</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1808"></span><span>
</span><span id="line-1809"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkTyVarEqErr%27"><span class="hs-identifier hs-type">mkTyVarEqErr'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span>
</span><span id="line-1810"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcSolverReportMsg"><span class="hs-identifier hs-type">TcSolverReportMsg</span></a></span><span>
</span><span id="line-1811"></span><span id="mkTyVarEqErr%27"><span class="annot"><span class="annottext">mkTyVarEqErr' :: SolverReportErrCtxt
-&gt; ErrorItem
-&gt; (TcId, TcCoercionN)
-&gt; Type
-&gt; TcM TcSolverReportMsg
</span><a href="GHC.Tc.Errors.html#mkTyVarEqErr%27"><span class="hs-identifier hs-var hs-var">mkTyVarEqErr'</span></a></span></span><span> </span><span id="local-6989586621683032404"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032404"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032405"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032405"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032406"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032407"><span class="annot"><span class="annottext">TcCoercionN
</span><a href="#local-6989586621683032407"><span class="hs-identifier hs-var">co1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683032408"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>
</span><span id="line-1812"></span><span>
</span><span id="line-1813"></span><span>  </span><span class="hs-comment">-- Is this a representation-polymorphism error, e.g.</span><span>
</span><span id="line-1814"></span><span>  </span><span class="hs-comment">-- alpha[conc] ~# rr[sk] ? If so, handle that first.</span><span>
</span><span id="line-1815"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032409"><span class="annot"><span class="annottext">FixedRuntimeRepErrorInfo
</span><a href="#local-6989586621683032409"><span class="hs-identifier hs-var">frr_info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe FixedRuntimeRepErrorInfo
</span><a href="#local-6989586621683032410"><span class="hs-identifier hs-var">mb_concrete_reason</span></a></span><span>
</span><span id="line-1816"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1817"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032411"><span class="annot"><a href="#local-6989586621683032411"><span class="hs-identifier hs-var">infos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ZonkM (TidyEnv, [FixedRuntimeRepErrorInfo])
-&gt; TcM (TidyEnv, [FixedRuntimeRepErrorInfo])
forall a. ZonkM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#liftZonkM"><span class="hs-identifier hs-var">liftZonkM</span></a></span><span> </span><span class="annot"><span class="annottext">(ZonkM (TidyEnv, [FixedRuntimeRepErrorInfo])
 -&gt; TcM (TidyEnv, [FixedRuntimeRepErrorInfo]))
-&gt; ZonkM (TidyEnv, [FixedRuntimeRepErrorInfo])
-&gt; TcM (TidyEnv, [FixedRuntimeRepErrorInfo])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TidyEnv
-&gt; [FixedRuntimeRepErrorInfo]
-&gt; ZonkM (TidyEnv, [FixedRuntimeRepErrorInfo])
</span><a href="GHC.Tc.Zonk.TcType.html#zonkTidyFRRInfos"><span class="hs-identifier hs-var">zonkTidyFRRInfos</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TidyEnv
</span><a href="GHC.Tc.Errors.Types.html#cec_tidy"><span class="hs-identifier hs-var">cec_tidy</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032404"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FixedRuntimeRepErrorInfo
</span><a href="#local-6989586621683032409"><span class="hs-identifier hs-var">frr_info</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1818"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#FixedRuntimeRepError"><span class="hs-identifier hs-type">FixedRuntimeRepError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032411"><span class="hs-identifier hs-type">infos</span></a></span><span>
</span><span id="line-1819"></span><span>
</span><span id="line-1820"></span><span>  </span><span class="hs-comment">-- Impredicativity is a simple error to understand;</span><span>
</span><span id="line-1821"></span><span>  </span><span class="hs-comment">-- try it before anything more complicated.</span><span>
</span><span id="line-1822"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CheckTyEqResult
</span><a href="#local-6989586621683032412"><span class="hs-identifier hs-var">check_eq_result</span></a></span><span> </span><span class="annot"><span class="annottext">CheckTyEqResult -&gt; CheckTyEqProblem -&gt; Bool
</span><a href="GHC.Tc.Types.Constraint.html#cterHasProblem"><span class="hs-operator hs-var">`cterHasProblem`</span></a></span><span> </span><span class="annot"><span class="annottext">CheckTyEqProblem
</span><a href="GHC.Tc.Types.Constraint.html#cteImpredicative"><span class="hs-identifier hs-var">cteImpredicative</span></a></span><span>
</span><span id="line-1823"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1824"></span><span>    </span><span id="local-6989586621683032415"><span class="annot"><a href="#local-6989586621683032415"><span class="hs-identifier hs-var">tyvar_eq_info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TcId, Maybe Implication)
-&gt; Type -&gt; IOEnv (Env TcGblEnv TcLclEnv) TyVarInfo
</span><a href="GHC.Tc.Errors.html#extraTyVarEqInfo"><span class="hs-identifier hs-var">extraTyVarEqInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Implication
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1825"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-1826"></span><span>        </span><span id="local-6989586621683032416"><span class="annot"><a href="#local-6989586621683032416"><span class="hs-identifier hs-var hs-var">poly_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem
-&gt; TcId -&gt; Type -&gt; Maybe TyVarInfo -&gt; CannotUnifyVariableReason
</span><a href="GHC.Tc.Errors.Types.html#CannotUnifyWithPolytype"><span class="hs-identifier hs-var">CannotUnifyWithPolytype</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032405"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TyVarInfo
</span><a href="#local-6989586621683032418"><span class="hs-identifier hs-var">mb_tv_info</span></a></span><span>
</span><span id="line-1827"></span><span>        </span><span id="local-6989586621683032418"><span class="annot"><a href="#local-6989586621683032418"><span class="hs-identifier hs-var hs-var">mb_tv_info</span></a></span></span><span>
</span><span id="line-1828"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TcId -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isSkolemTyVar"><span class="hs-identifier hs-var">isSkolemTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span><span>
</span><span id="line-1829"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVarInfo -&gt; Maybe TyVarInfo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TyVarInfo
</span><a href="#local-6989586621683032415"><span class="hs-identifier hs-var">tyvar_eq_info</span></a></span><span>
</span><span id="line-1830"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1831"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TyVarInfo
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1832"></span><span>        </span><span id="local-6989586621683032419"><span class="annot"><a href="#local-6989586621683032419"><span class="hs-identifier hs-var hs-var">main_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1833"></span><span>          </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#CannotUnifyVariable"><span class="hs-identifier hs-type">CannotUnifyVariable</span></a></span><span>
</span><span id="line-1834"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mismatchMsg :: MismatchMsg
</span><a href="GHC.Tc.Errors.Types.html#mismatchMsg"><span class="hs-identifier hs-var">mismatchMsg</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MismatchMsg
</span><a href="#local-6989586621683032421"><span class="hs-identifier hs-var">headline_msg</span></a></span><span>
</span><span id="line-1835"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cannotUnifyReason :: CannotUnifyVariableReason
</span><a href="GHC.Tc.Errors.Types.html#cannotUnifyReason"><span class="hs-identifier hs-var">cannotUnifyReason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CannotUnifyVariableReason
</span><a href="#local-6989586621683032416"><span class="hs-identifier hs-var">poly_msg</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1836"></span><span>        </span><span class="hs-comment">-- Unlike the other reports, this discards the old 'report_important'</span><span>
</span><span id="line-1837"></span><span>        </span><span class="hs-comment">-- instead of augmenting it.  This is because the details are not likely</span><span>
</span><span id="line-1838"></span><span>        </span><span class="hs-comment">-- to be helpful since this is just an unimplemented feature.</span><span>
</span><span id="line-1839"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621683032419"><span class="hs-identifier hs-type">main_msg</span></a></span><span>
</span><span id="line-1840"></span><span>
</span><span id="line-1841"></span><span>  </span><span class="hs-comment">-- Incompatible kinds</span><span>
</span><span id="line-1842"></span><span>  </span><span class="hs-comment">-- This is wrinkle (EIK2) in Note [Equalities with incompatible kinds]</span><span>
</span><span id="line-1843"></span><span>  </span><span class="hs-comment">-- in GHC.Tc.Solver.Equality</span><span>
</span><span id="line-1844"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TcCoercionN -&gt; Bool
</span><a href="GHC.Core.Coercion.html#hasCoercionHoleCo"><span class="hs-identifier hs-var">hasCoercionHoleCo</span></a></span><span> </span><span class="annot"><span class="annottext">TcCoercionN
</span><a href="#local-6989586621683032407"><span class="hs-identifier hs-var">co1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Coercion.html#hasCoercionHoleTy"><span class="hs-identifier hs-var">hasCoercionHoleTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1845"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcSolverReportMsg -&gt; TcM TcSolverReportMsg
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TcSolverReportMsg -&gt; TcM TcSolverReportMsg)
-&gt; TcSolverReportMsg -&gt; TcM TcSolverReportMsg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; TcSolverReportMsg
</span><a href="GHC.Tc.Errors.html#mkBlockedEqErr"><span class="hs-identifier hs-var">mkBlockedEqErr</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032405"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-1846"></span><span>
</span><span id="line-1847"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TcId -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isSkolemTyVar"><span class="hs-identifier hs-var">isSkolemTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span><span>  </span><span class="hs-comment">-- ty2 won't be a meta-tyvar; we would have</span><span>
</span><span id="line-1848"></span><span>                       </span><span class="hs-comment">-- swapped in Solver.Equality.canEqTyVarHomo</span><span>
</span><span id="line-1849"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">TcId -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isTyVarTyVar"><span class="hs-identifier hs-var">isTyVarTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTyVarTy"><span class="hs-identifier hs-var">isTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1850"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; EqRel
</span><a href="GHC.Tc.Errors.Types.html#errorItemEqRel"><span class="hs-identifier hs-var">errorItemEqRel</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032405"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; EqRel -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a></span><span>
</span><span id="line-1851"></span><span>     </span><span class="hs-comment">-- The cases below don't really apply to ReprEq (except occurs check)</span><span>
</span><span id="line-1852"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1853"></span><span>    </span><span id="local-6989586621683032426"><span class="annot"><a href="#local-6989586621683032426"><span class="hs-identifier hs-var">tv_extra</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TcId, Maybe Implication)
-&gt; Type -&gt; IOEnv (Env TcGblEnv TcLclEnv) TyVarInfo
</span><a href="GHC.Tc.Errors.html#extraTyVarEqInfo"><span class="hs-identifier hs-var">extraTyVarEqInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Implication
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1854"></span><span>    </span><span id="local-6989586621683032427"><span class="annot"><a href="#local-6989586621683032427"><span class="hs-identifier hs-var">reason</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#errorItemEqRel"><span class="hs-identifier hs-type">errorItemEqRel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032405"><span class="hs-identifier hs-type">item</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html#ReprEq"><span class="hs-identifier hs-type">ReprEq</span></a></span><span>
</span><span id="line-1855"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#RepresentationalEq"><span class="hs-identifier hs-type">RepresentationalEq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032426"><span class="hs-identifier hs-type">tv_extra</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#coercible_msg"><span class="hs-identifier hs-type">coercible_msg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032429"><span class="hs-identifier hs-type">ty1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032408"><span class="hs-identifier hs-type">ty2</span></a></span><span>
</span><span id="line-1856"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#DifferentTyVars"><span class="hs-identifier hs-type">DifferentTyVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032426"><span class="hs-identifier hs-type">tv_extra</span></a></span><span>
</span><span id="line-1857"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032431"><span class="annot"><a href="#local-6989586621683032431"><span class="hs-identifier hs-var hs-var">main_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#CannotUnifyVariable"><span class="hs-identifier hs-type">CannotUnifyVariable</span></a></span><span>
</span><span id="line-1858"></span><span>                     </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mismatchMsg :: MismatchMsg
</span><a href="GHC.Tc.Errors.Types.html#mismatchMsg"><span class="hs-identifier hs-var">mismatchMsg</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MismatchMsg
</span><a href="#local-6989586621683032421"><span class="hs-identifier hs-var">headline_msg</span></a></span><span>
</span><span id="line-1859"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cannotUnifyReason :: CannotUnifyVariableReason
</span><a href="GHC.Tc.Errors.Types.html#cannotUnifyReason"><span class="hs-identifier hs-var">cannotUnifyReason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CannotUnifyVariableReason
</span><a href="#local-6989586621683032427"><span class="hs-identifier hs-var">reason</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1860"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621683032431"><span class="hs-identifier hs-type">main_msg</span></a></span><span>
</span><span id="line-1861"></span><span>
</span><span id="line-1862"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span><span> </span><span class="annot"><span class="annottext">TcId -&gt; TyCoVarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1863"></span><span>    </span><span class="hs-comment">-- We report an &quot;occurs check&quot; even for  a ~ F t a, where F is a type</span><span>
</span><span id="line-1864"></span><span>    </span><span class="hs-comment">-- function; it's not insoluble (because in principle F could reduce)</span><span>
</span><span id="line-1865"></span><span>    </span><span class="hs-comment">-- but we have certainly been unable to solve it</span><span>
</span><span id="line-1866"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-1867"></span><span>    </span><span class="hs-comment">-- Use tyCoVarsOfType because it might have begun as the canonical</span><span>
</span><span id="line-1868"></span><span>    </span><span class="hs-comment">-- constraint (Dual (Dual a)) ~ a, and been swizzled by mkEqnErr_help</span><span>
</span><span id="line-1869"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032433"><span class="annot"><span class="annottext">ambiguity_infos :: [AmbiguityInfo]
</span><a href="#local-6989586621683032433"><span class="hs-identifier hs-var hs-var">ambiguity_infos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [AmbiguityInfo]
</span><a href="GHC.Tc.Errors.html#eqInfoMsgs"><span class="hs-identifier hs-var">eqInfoMsgs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032429"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1870"></span><span>
</span><span id="line-1871"></span><span>        </span><span id="local-6989586621683032434"><span class="annot"><span class="annottext">interesting_tyvars :: [TcId]
</span><a href="#local-6989586621683032434"><span class="hs-identifier hs-var hs-var">interesting_tyvars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TcId -&gt; Bool) -&gt; [TcId] -&gt; [TcId]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (TcId -&gt; Bool) -&gt; TcId -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfType"><span class="hs-identifier hs-var">noFreeVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; (TcId -&gt; Type) -&gt; TcId -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TcId -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([TcId] -&gt; [TcId]) -&gt; [TcId] -&gt; [TcId]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1872"></span><span>                             </span><span class="annot"><span class="annottext">(TcId -&gt; Bool) -&gt; [TcId] -&gt; [TcId]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">TcId -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">([TcId] -&gt; [TcId]) -&gt; [TcId] -&gt; [TcId]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1873"></span><span>                             </span><span class="annot"><span class="annottext">FV -&gt; [TcId]
</span><a href="GHC.Utils.FV.html#fvVarList"><span class="hs-identifier hs-var">fvVarList</span></a></span><span> </span><span class="annot"><span class="annottext">(FV -&gt; [TcId]) -&gt; FV -&gt; [TcId]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1874"></span><span>                             </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032429"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1875"></span><span>
</span><span id="line-1876"></span><span>        </span><span id="local-6989586621683032439"><span class="annot"><span class="annottext">occurs_err :: CannotUnifyVariableReason
</span><a href="#local-6989586621683032439"><span class="hs-identifier hs-var hs-var">occurs_err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1877"></span><span>          </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#OccursCheck"><span class="hs-identifier hs-type">OccursCheck</span></a></span><span>
</span><span id="line-1878"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">occursCheckInterestingTyVars :: [TcId]
</span><a href="GHC.Tc.Errors.Types.html#occursCheckInterestingTyVars"><span class="hs-identifier hs-var">occursCheckInterestingTyVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032434"><span class="hs-identifier hs-var">interesting_tyvars</span></a></span><span>
</span><span id="line-1879"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">occursCheckAmbiguityInfos :: [AmbiguityInfo]
</span><a href="GHC.Tc.Errors.Types.html#occursCheckAmbiguityInfos"><span class="hs-identifier hs-var">occursCheckAmbiguityInfos</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[AmbiguityInfo]
</span><a href="#local-6989586621683032433"><span class="hs-identifier hs-var">ambiguity_infos</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1880"></span><span>        </span><span id="local-6989586621683032443"><span class="annot"><span class="annottext">main_msg :: TcSolverReportMsg
</span><a href="#local-6989586621683032443"><span class="hs-identifier hs-var hs-var">main_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1881"></span><span>          </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#CannotUnifyVariable"><span class="hs-identifier hs-type">CannotUnifyVariable</span></a></span><span>
</span><span id="line-1882"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mismatchMsg :: MismatchMsg
</span><a href="GHC.Tc.Errors.Types.html#mismatchMsg"><span class="hs-identifier hs-var">mismatchMsg</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MismatchMsg
</span><a href="#local-6989586621683032421"><span class="hs-identifier hs-var">headline_msg</span></a></span><span>
</span><span id="line-1883"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cannotUnifyReason :: CannotUnifyVariableReason
</span><a href="GHC.Tc.Errors.Types.html#cannotUnifyReason"><span class="hs-identifier hs-var">cannotUnifyReason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CannotUnifyVariableReason
</span><a href="#local-6989586621683032439"><span class="hs-identifier hs-var">occurs_err</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1884"></span><span>
</span><span id="line-1885"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">TcSolverReportMsg -&gt; TcM TcSolverReportMsg
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TcSolverReportMsg
</span><a href="#local-6989586621683032443"><span class="hs-identifier hs-var">main_msg</span></a></span><span>
</span><span id="line-1886"></span><span>
</span><span id="line-1887"></span><span>  </span><span class="hs-comment">-- If the immediately-enclosing implication has 'tv' a skolem, and</span><span>
</span><span id="line-1888"></span><span>  </span><span class="hs-comment">-- we know by now its an InferSkol kind of skolem, then presumably</span><span>
</span><span id="line-1889"></span><span>  </span><span class="hs-comment">-- it started life as a TyVarTv, else it'd have been unified, given</span><span>
</span><span id="line-1890"></span><span>  </span><span class="hs-comment">-- that there's no occurs-check or forall problem</span><span>
</span><span id="line-1891"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032444"><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683032444"><span class="hs-identifier hs-var">implic</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Implication]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; [Implication]
</span><a href="GHC.Tc.Errors.Types.html#cec_encl"><span class="hs-identifier hs-var">cec_encl</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032404"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-1892"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Implic"><span class="hs-identifier hs-type">Implic</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ic_skols :: Implication -&gt; [TcId]
</span><a href="GHC.Tc.Types.Constraint.html#ic_skols"><span class="hs-identifier hs-var">ic_skols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032445"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032445"><span class="hs-identifier hs-var">skols</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683032444"><span class="hs-identifier hs-var">implic</span></a></span><span>
</span><span id="line-1893"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span><span> </span><span class="annot"><span class="annottext">TcId -&gt; [TcId] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032445"><span class="hs-identifier hs-var">skols</span></a></span><span>
</span><span id="line-1894"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1895"></span><span>    </span><span id="local-6989586621683032447"><span class="annot"><a href="#local-6989586621683032447"><span class="hs-identifier hs-var">tv_extra</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TcId, Maybe Implication)
-&gt; Type -&gt; IOEnv (Env TcGblEnv TcLclEnv) TyVarInfo
</span><a href="GHC.Tc.Errors.html#extraTyVarEqInfo"><span class="hs-identifier hs-var">extraTyVarEqInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Implication
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1896"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032448"><span class="annot"><a href="#local-6989586621683032448"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#Mismatch"><span class="hs-identifier hs-type">Mismatch</span></a></span><span>
</span><span id="line-1897"></span><span>               </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mismatchMsg :: MismatchMsg
</span><a href="GHC.Tc.Errors.Types.html#mismatchMsg"><span class="hs-identifier hs-var">mismatchMsg</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MismatchMsg
</span><a href="#local-6989586621683032449"><span class="hs-identifier hs-var">mismatch_msg</span></a></span><span>
</span><span id="line-1898"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mismatchTyVarInfo :: Maybe TyVarInfo
</span><a href="GHC.Tc.Errors.Types.html#mismatchTyVarInfo"><span class="hs-identifier hs-var">mismatchTyVarInfo</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVarInfo -&gt; Maybe TyVarInfo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TyVarInfo
</span><a href="#local-6989586621683032447"><span class="hs-identifier hs-var">tv_extra</span></a></span><span>
</span><span id="line-1899"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mismatchAmbiguityInfo :: [AmbiguityInfo]
</span><a href="GHC.Tc.Errors.Types.html#mismatchAmbiguityInfo"><span class="hs-identifier hs-var">mismatchAmbiguityInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1900"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mismatchCoercibleInfo :: Maybe CoercibleMsg
</span><a href="GHC.Tc.Errors.Types.html#mismatchCoercibleInfo"><span class="hs-identifier hs-var">mismatchCoercibleInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoercibleMsg
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1901"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621683032448"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-1902"></span><span>
</span><span id="line-1903"></span><span>  </span><span class="hs-comment">-- Check for skolem escape</span><span>
</span><span id="line-1904"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032450"><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683032450"><span class="hs-identifier hs-var">implic</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Implication]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; [Implication]
</span><a href="GHC.Tc.Errors.Types.html#cec_encl"><span class="hs-identifier hs-var">cec_encl</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032404"><span class="hs-identifier hs-var">ctxt</span></a></span><span>   </span><span class="hs-comment">-- Get the innermost context</span><span>
</span><span id="line-1905"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Implic"><span class="hs-identifier hs-type">Implic</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ic_skols :: Implication -&gt; [TcId]
</span><a href="GHC.Tc.Types.Constraint.html#ic_skols"><span class="hs-identifier hs-var">ic_skols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032451"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032451"><span class="hs-identifier hs-var">skols</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683032450"><span class="hs-identifier hs-var">implic</span></a></span><span>
</span><span id="line-1906"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032452"><span class="annot"><span class="annottext">esc_skols :: [TcId]
</span><a href="#local-6989586621683032452"><span class="hs-identifier hs-var hs-var">esc_skols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TcId -&gt; Bool) -&gt; [TcId] -&gt; [TcId]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; TyCoVarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032451"><span class="hs-identifier hs-var">skols</span></a></span><span>
</span><span id="line-1907"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TcId] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032452"><span class="hs-identifier hs-var">esc_skols</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1908"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032453"><span class="annot"><span class="annottext">main_msg :: TcSolverReportMsg
</span><a href="#local-6989586621683032453"><span class="hs-identifier hs-var hs-var">main_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1909"></span><span>          </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#CannotUnifyVariable"><span class="hs-identifier hs-type">CannotUnifyVariable</span></a></span><span>
</span><span id="line-1910"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mismatchMsg :: MismatchMsg
</span><a href="GHC.Tc.Errors.Types.html#mismatchMsg"><span class="hs-identifier hs-var">mismatchMsg</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MismatchMsg
</span><a href="#local-6989586621683032449"><span class="hs-identifier hs-var">mismatch_msg</span></a></span><span>
</span><span id="line-1911"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cannotUnifyReason :: CannotUnifyVariableReason
</span><a href="GHC.Tc.Errors.Types.html#cannotUnifyReason"><span class="hs-identifier hs-var">cannotUnifyReason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Implication -&gt; [TcId] -&gt; CannotUnifyVariableReason
</span><a href="GHC.Tc.Errors.Types.html#SkolemEscape"><span class="hs-identifier hs-var">SkolemEscape</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032405"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683032450"><span class="hs-identifier hs-var">implic</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032452"><span class="hs-identifier hs-var">esc_skols</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1912"></span><span>
</span><span id="line-1913"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">TcSolverReportMsg -&gt; TcM TcSolverReportMsg
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TcSolverReportMsg
</span><a href="#local-6989586621683032453"><span class="hs-identifier hs-var">main_msg</span></a></span><span>
</span><span id="line-1914"></span><span>
</span><span id="line-1915"></span><span>  </span><span class="hs-comment">-- Nastiest case: attempt to unify an untouchable variable</span><span>
</span><span id="line-1916"></span><span>  </span><span class="hs-comment">-- So tv is a meta tyvar (or started that way before we</span><span>
</span><span id="line-1917"></span><span>  </span><span class="hs-comment">-- generalised it).  So presumably it is an *untouchable*</span><span>
</span><span id="line-1918"></span><span>  </span><span class="hs-comment">-- meta tyvar or a TyVarTv, else it'd have been unified</span><span>
</span><span id="line-1919"></span><span>  </span><span class="hs-comment">-- See Note [Error messages for untouchables]</span><span>
</span><span id="line-1920"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032455"><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683032455"><span class="hs-identifier hs-var">implic</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Implication]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; [Implication]
</span><a href="GHC.Tc.Errors.Types.html#cec_encl"><span class="hs-identifier hs-var">cec_encl</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032404"><span class="hs-identifier hs-var">ctxt</span></a></span><span>   </span><span class="hs-comment">-- Get the innermost context</span><span>
</span><span id="line-1921"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Implic"><span class="hs-identifier hs-type">Implic</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ic_tclvl :: Implication -&gt; TcLevel
</span><a href="GHC.Tc.Types.Constraint.html#ic_tclvl"><span class="hs-identifier hs-var">ic_tclvl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032456"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621683032456"><span class="hs-identifier hs-var">lvl</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683032455"><span class="hs-identifier hs-var">implic</span></a></span><span>
</span><span id="line-1922"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; TcM TcSolverReportMsg -&gt; TcM TcSolverReportMsg
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcLevel -&gt; TcId -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isTouchableMetaTyVar"><span class="hs-identifier hs-var">isTouchableMetaTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621683032456"><span class="hs-identifier hs-var">lvl</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1923"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621683032456"><span class="hs-identifier hs-var">lvl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcM TcSolverReportMsg -&gt; TcM TcSolverReportMsg)
-&gt; TcM TcSolverReportMsg -&gt; TcM TcSolverReportMsg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- See Note [Error messages for untouchables]</span><span>
</span><span id="line-1924"></span><span>    </span><span id="local-6989586621683032458"><span class="annot"><a href="#local-6989586621683032458"><span class="hs-identifier hs-var">tv_extra</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TcId, Maybe Implication)
-&gt; Type -&gt; IOEnv (Env TcGblEnv TcLclEnv) TyVarInfo
</span><a href="GHC.Tc.Errors.html#extraTyVarEqInfo"><span class="hs-identifier hs-var">extraTyVarEqInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Implication -&gt; Maybe Implication
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683032455"><span class="hs-identifier hs-var">implic</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1925"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032459"><span class="annot"><a href="#local-6989586621683032459"><span class="hs-identifier hs-var hs-var">tv_extra'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVarInfo
</span><a href="#local-6989586621683032458"><span class="hs-identifier hs-var">tv_extra</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#thisTyVarIsUntouchable"><span class="hs-identifier hs-var">thisTyVarIsUntouchable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621683032455"><span class="hs-identifier hs-type">implic</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1926"></span><span>        </span><span id="local-6989586621683032461"><span class="annot"><a href="#local-6989586621683032461"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#Mismatch"><span class="hs-identifier hs-type">Mismatch</span></a></span><span>
</span><span id="line-1927"></span><span>               </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mismatchMsg :: MismatchMsg
</span><a href="GHC.Tc.Errors.Types.html#mismatchMsg"><span class="hs-identifier hs-var">mismatchMsg</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MismatchMsg
</span><a href="#local-6989586621683032449"><span class="hs-identifier hs-var">mismatch_msg</span></a></span><span>
</span><span id="line-1928"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mismatchTyVarInfo :: Maybe TyVarInfo
</span><a href="GHC.Tc.Errors.Types.html#mismatchTyVarInfo"><span class="hs-identifier hs-var">mismatchTyVarInfo</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVarInfo -&gt; Maybe TyVarInfo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TyVarInfo
</span><a href="#local-6989586621683032459"><span class="hs-identifier hs-var">tv_extra'</span></a></span><span>
</span><span id="line-1929"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mismatchAmbiguityInfo :: [AmbiguityInfo]
</span><a href="GHC.Tc.Errors.Types.html#mismatchAmbiguityInfo"><span class="hs-identifier hs-var">mismatchAmbiguityInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1930"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mismatchCoercibleInfo :: Maybe CoercibleMsg
</span><a href="GHC.Tc.Errors.Types.html#mismatchCoercibleInfo"><span class="hs-identifier hs-var">mismatchCoercibleInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoercibleMsg
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1931"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621683032461"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-1932"></span><span>
</span><span id="line-1933"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1934"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
-&gt; ErrorItem -&gt; Type -&gt; Type -&gt; TcM TcSolverReportMsg
</span><a href="GHC.Tc.Errors.html#reportEqErr"><span class="hs-identifier hs-var">reportEqErr</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032404"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032405"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1935"></span><span>        </span><span class="hs-comment">-- This *can* happen (#6123)</span><span>
</span><span id="line-1936"></span><span>        </span><span class="hs-comment">-- Consider an ambiguous top-level constraint (a ~ F a)</span><span>
</span><span id="line-1937"></span><span>        </span><span class="hs-comment">-- Not an occurs check, because F is a type function.</span><span>
</span><span id="line-1938"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1939"></span><span>    </span><span id="local-6989586621683032421"><span class="annot"><span class="annottext">headline_msg :: MismatchMsg
</span><a href="#local-6989586621683032421"><span class="hs-identifier hs-var hs-var">headline_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; ErrorItem -&gt; Type -&gt; Type -&gt; MismatchMsg
</span><a href="GHC.Tc.Errors.html#misMatchOrCND"><span class="hs-identifier hs-var">misMatchOrCND</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032404"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032405"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032429"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1940"></span><span>    </span><span id="local-6989586621683032449"><span class="annot"><span class="annottext">mismatch_msg :: MismatchMsg
</span><a href="#local-6989586621683032449"><span class="hs-identifier hs-var hs-var">mismatch_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Type -&gt; Type -&gt; MismatchMsg
</span><a href="GHC.Tc.Errors.html#mkMismatchMsg"><span class="hs-identifier hs-var">mkMismatchMsg</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032405"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032429"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1941"></span><span>
</span><span id="line-1942"></span><span>    </span><span class="hs-comment">-- The following doesn't use the cterHasProblem mechanism because</span><span>
</span><span id="line-1943"></span><span>    </span><span class="hs-comment">-- we need to retrieve the ConcreteTvOrigin. Just knowing whether</span><span>
</span><span id="line-1944"></span><span>    </span><span class="hs-comment">-- there is an error is not sufficient. See #21430.</span><span>
</span><span id="line-1945"></span><span>    </span><span id="local-6989586621683032410"><span class="annot"><span class="annottext">mb_concrete_reason :: Maybe FixedRuntimeRepErrorInfo
</span><a href="#local-6989586621683032410"><span class="hs-identifier hs-var hs-var">mb_concrete_reason</span></a></span></span><span>
</span><span id="line-1946"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032464"><span class="annot"><span class="annottext">ConcreteTvOrigin
</span><a href="#local-6989586621683032464"><span class="hs-identifier hs-var">frr_orig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcId -&gt; Maybe ConcreteTvOrigin
</span><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVar_maybe"><span class="hs-identifier hs-var">isConcreteTyVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span><span>
</span><span id="line-1947"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isConcreteType"><span class="hs-identifier hs-var">isConcreteType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1948"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepErrorInfo -&gt; Maybe FixedRuntimeRepErrorInfo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(FixedRuntimeRepErrorInfo -&gt; Maybe FixedRuntimeRepErrorInfo)
-&gt; FixedRuntimeRepErrorInfo -&gt; Maybe FixedRuntimeRepErrorInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConcreteTvOrigin -&gt; TcId -&gt; Type -&gt; FixedRuntimeRepErrorInfo
</span><a href="#local-6989586621683032467"><span class="hs-identifier hs-var">frr_reason</span></a></span><span> </span><span class="annot"><span class="annottext">ConcreteTvOrigin
</span><a href="#local-6989586621683032464"><span class="hs-identifier hs-var">frr_orig</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1949"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032468"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032468"><span class="hs-identifier hs-var">tv2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032469"><span class="annot"><span class="annottext">ConcreteTvOrigin
</span><a href="#local-6989586621683032469"><span class="hs-identifier hs-var">frr_orig</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TcId, ConcreteTvOrigin)
</span><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVarTy_maybe"><span class="hs-identifier hs-var">isConcreteTyVarTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032408"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1950"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVar"><span class="hs-identifier hs-var">isConcreteTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1951"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepErrorInfo -&gt; Maybe FixedRuntimeRepErrorInfo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(FixedRuntimeRepErrorInfo -&gt; Maybe FixedRuntimeRepErrorInfo)
-&gt; FixedRuntimeRepErrorInfo -&gt; Maybe FixedRuntimeRepErrorInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConcreteTvOrigin -&gt; TcId -&gt; Type -&gt; FixedRuntimeRepErrorInfo
</span><a href="#local-6989586621683032467"><span class="hs-identifier hs-var">frr_reason</span></a></span><span> </span><span class="annot"><span class="annottext">ConcreteTvOrigin
</span><a href="#local-6989586621683032469"><span class="hs-identifier hs-var">frr_orig</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032468"><span class="hs-identifier hs-var">tv2</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032429"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-1952"></span><span>      </span><span class="hs-comment">-- NB: if it's an unsolved equality in which both sides are concrete</span><span>
</span><span id="line-1953"></span><span>      </span><span class="hs-comment">-- (e.g. a concrete type variable on both sides), then it's not a</span><span>
</span><span id="line-1954"></span><span>      </span><span class="hs-comment">-- representation-polymorphism problem.</span><span>
</span><span id="line-1955"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1956"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FixedRuntimeRepErrorInfo
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1957"></span><span>    </span><span id="local-6989586621683032467"><span class="annot"><span class="annottext">frr_reason :: ConcreteTvOrigin -&gt; TcId -&gt; Type -&gt; FixedRuntimeRepErrorInfo
</span><a href="#local-6989586621683032467"><span class="hs-identifier hs-var hs-var">frr_reason</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteFRR"><span class="hs-identifier hs-type">ConcreteFRR</span></a></span><span> </span><span id="local-6989586621683032471"><span class="annot"><span class="annottext">FixedRuntimeRepOrigin
</span><a href="#local-6989586621683032471"><span class="hs-identifier hs-var">frr_orig</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683032472"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032472"><span class="hs-identifier hs-var">conc_tv</span></a></span></span><span> </span><span id="local-6989586621683032473"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032473"><span class="hs-identifier hs-var">not_conc</span></a></span></span><span>
</span><span id="line-1958"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#FRR_Info"><span class="hs-identifier hs-type">FRR_Info</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">frr_info_origin :: FixedRuntimeRepOrigin
</span><a href="GHC.Tc.Errors.Types.html#frr_info_origin"><span class="hs-identifier hs-var">frr_info_origin</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepOrigin
</span><a href="#local-6989586621683032471"><span class="hs-identifier hs-var">frr_orig</span></a></span><span>
</span><span id="line-1959"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">frr_info_not_concrete :: Maybe (TcId, Type)
</span><a href="GHC.Tc.Errors.Types.html#frr_info_not_concrete"><span class="hs-identifier hs-var">frr_info_not_concrete</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TcId, Type) -&gt; Maybe (TcId, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032472"><span class="hs-identifier hs-var">conc_tv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032473"><span class="hs-identifier hs-var">not_conc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1960"></span><span>
</span><span id="line-1961"></span><span>    </span><span id="local-6989586621683032429"><span class="annot"><span class="annottext">ty1 :: Type
</span><a href="#local-6989586621683032429"><span class="hs-identifier hs-var hs-var">ty1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcId -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032406"><span class="hs-identifier hs-var">tv1</span></a></span><span>
</span><span id="line-1962"></span><span>
</span><span id="line-1963"></span><span>    </span><span id="local-6989586621683032412"><span class="annot"><span class="annottext">check_eq_result :: CheckTyEqResult
</span><a href="#local-6989586621683032412"><span class="hs-identifier hs-var hs-var">check_eq_result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Maybe CtIrredReason
</span><a href="GHC.Tc.Errors.Types.html#ei_m_reason"><span class="hs-identifier hs-var">ei_m_reason</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032405"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1964"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#NonCanonicalReason"><span class="hs-identifier hs-type">NonCanonicalReason</span></a></span><span> </span><span id="local-6989586621683032475"><span class="annot"><span class="annottext">CheckTyEqResult
</span><a href="#local-6989586621683032475"><span class="hs-identifier hs-var">result</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckTyEqResult
</span><a href="#local-6989586621683032475"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-1965"></span><span>      </span><span class="annot"><span class="annottext">Maybe CtIrredReason
</span><span class="hs-identifier">_</span></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckTyEqResult
</span><a href="GHC.Tc.Types.Constraint.html#cteOK"><span class="hs-identifier hs-var">cteOK</span></a></span><span>
</span><span id="line-1966"></span><span>
</span><span id="line-1967"></span><span class="annot"><a href="GHC.Tc.Errors.html#eqInfoMsgs"><span class="hs-identifier hs-type">eqInfoMsgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#AmbiguityInfo"><span class="hs-identifier hs-type">AmbiguityInfo</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1968"></span><span class="hs-comment">-- Report (a) ambiguity if either side is a type function application</span><span>
</span><span id="line-1969"></span><span class="hs-comment">--            e.g. F a0 ~ Int</span><span>
</span><span id="line-1970"></span><span class="hs-comment">--        (b) warning about injectivity if both sides are the same</span><span>
</span><span id="line-1971"></span><span class="hs-comment">--            type function application   F a ~ F b</span><span>
</span><span id="line-1972"></span><span class="hs-comment">--            See Note [Non-injective type functions]</span><span>
</span><span id="line-1973"></span><span id="eqInfoMsgs"><span class="annot"><span class="annottext">eqInfoMsgs :: Type -&gt; Type -&gt; [AmbiguityInfo]
</span><a href="GHC.Tc.Errors.html#eqInfoMsgs"><span class="hs-identifier hs-var hs-var">eqInfoMsgs</span></a></span></span><span> </span><span id="local-6989586621683032477"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032477"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621683032478"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032478"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>
</span><span id="line-1974"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe AmbiguityInfo] -&gt; [AmbiguityInfo]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe AmbiguityInfo
</span><a href="#local-6989586621683032480"><span class="hs-identifier hs-var">tyfun_msg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe AmbiguityInfo
</span><a href="#local-6989586621683032481"><span class="hs-identifier hs-var">ambig_msg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1975"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1976"></span><span>    </span><span id="local-6989586621683032482"><span class="annot"><span class="annottext">mb_fun1 :: Maybe TyCon
</span><a href="#local-6989586621683032482"><span class="hs-identifier hs-var hs-var">mb_fun1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyCon
</span><a href="GHC.Tc.Errors.html#isTyFun_maybe"><span class="hs-identifier hs-var">isTyFun_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032477"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-1977"></span><span>    </span><span id="local-6989586621683032483"><span class="annot"><span class="annottext">mb_fun2 :: Maybe TyCon
</span><a href="#local-6989586621683032483"><span class="hs-identifier hs-var hs-var">mb_fun2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyCon
</span><a href="GHC.Tc.Errors.html#isTyFun_maybe"><span class="hs-identifier hs-var">isTyFun_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032478"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1978"></span><span>
</span><span id="line-1979"></span><span>    </span><span id="local-6989586621683032484"><span class="annot"><span class="annottext">ambig_tkvs1 :: ([TcId], [TcId])
</span><a href="#local-6989586621683032484"><span class="hs-identifier hs-var">ambig_tkvs1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621683032485"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032485"><span class="hs-identifier hs-var">kvs1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032486"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032486"><span class="hs-identifier hs-var">tvs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([TcId], [TcId])
</span><a href="GHC.Tc.Utils.TcType.html#ambigTkvsOfTy"><span class="hs-identifier hs-var">ambigTkvsOfTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032477"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-1980"></span><span>    </span><span id="local-6989586621683032488"><span class="annot"><span class="annottext">ambig_tkvs2 :: ([TcId], [TcId])
</span><a href="#local-6989586621683032488"><span class="hs-identifier hs-var">ambig_tkvs2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621683032489"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032489"><span class="hs-identifier hs-var">kvs2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032490"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032490"><span class="hs-identifier hs-var">tvs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([TcId], [TcId])
</span><a href="GHC.Tc.Utils.TcType.html#ambigTkvsOfTy"><span class="hs-identifier hs-var">ambigTkvsOfTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032478"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1981"></span><span>
</span><span id="line-1982"></span><span>      </span><span class="hs-comment">-- If a type isn't headed by a type function, then any ambiguous</span><span>
</span><span id="line-1983"></span><span>      </span><span class="hs-comment">-- variables need not be reported as such. e.g.: F a ~ t0 -&gt; t0, where a is a skolem</span><span>
</span><span id="line-1984"></span><span>    </span><span id="local-6989586621683032491"><span class="annot"><span class="annottext">ambig_tkvs :: ([TcId], [TcId])
</span><a href="#local-6989586621683032491"><span class="hs-identifier hs-var">ambig_tkvs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621683032492"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032492"><span class="hs-identifier hs-var">ambig_kvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032493"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032493"><span class="hs-identifier hs-var">ambig_tvs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1985"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe TyCon
</span><a href="#local-6989586621683032482"><span class="hs-identifier hs-var">mb_fun1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
</span><a href="#local-6989586621683032483"><span class="hs-identifier hs-var">mb_fun2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1986"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe TyCon
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1987"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([TcId], [TcId])
</span><a href="#local-6989586621683032484"><span class="hs-identifier hs-var">ambig_tkvs1</span></a></span><span>
</span><span id="line-1988"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe TyCon
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([TcId], [TcId])
</span><a href="#local-6989586621683032488"><span class="hs-identifier hs-var">ambig_tkvs2</span></a></span><span>
</span><span id="line-1989"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032485"><span class="hs-identifier hs-var">kvs1</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId] -&gt; [TcId] -&gt; [TcId]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">`union`</span></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032489"><span class="hs-identifier hs-var">kvs2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032486"><span class="hs-identifier hs-var">tvs1</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId] -&gt; [TcId] -&gt; [TcId]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">`union`</span></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032490"><span class="hs-identifier hs-var">tvs2</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Avoid dups</span><span>
</span><span id="line-1990"></span><span>
</span><span id="line-1991"></span><span>    </span><span id="local-6989586621683032481"><span class="annot"><span class="annottext">ambig_msg :: Maybe AmbiguityInfo
</span><a href="#local-6989586621683032481"><span class="hs-identifier hs-var hs-var">ambig_msg</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
</span><a href="#local-6989586621683032482"><span class="hs-identifier hs-var">mb_fun1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Maybe TyCon -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
</span><a href="#local-6989586621683032483"><span class="hs-identifier hs-var">mb_fun2</span></a></span><span>
</span><span id="line-1992"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TcId] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032492"><span class="hs-identifier hs-var">ambig_kvs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[TcId] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621683032493"><span class="hs-identifier hs-var">ambig_tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1993"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AmbiguityInfo -&gt; Maybe AmbiguityInfo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(AmbiguityInfo -&gt; Maybe AmbiguityInfo)
-&gt; AmbiguityInfo -&gt; Maybe AmbiguityInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ([TcId], [TcId]) -&gt; AmbiguityInfo
</span><a href="GHC.Tc.Errors.Types.html#Ambiguity"><span class="hs-identifier hs-var">Ambiguity</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">([TcId], [TcId])
</span><a href="#local-6989586621683032491"><span class="hs-identifier hs-var">ambig_tkvs</span></a></span><span>
</span><span id="line-1994"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1995"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe AmbiguityInfo
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1996"></span><span>
</span><span id="line-1997"></span><span>    </span><span id="local-6989586621683032480"><span class="annot"><span class="annottext">tyfun_msg :: Maybe AmbiguityInfo
</span><a href="#local-6989586621683032480"><span class="hs-identifier hs-var hs-var">tyfun_msg</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032495"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032495"><span class="hs-identifier hs-var">tc1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
</span><a href="#local-6989586621683032482"><span class="hs-identifier hs-var">mb_fun1</span></a></span><span>
</span><span id="line-1998"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032496"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032496"><span class="hs-identifier hs-var">tc2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
</span><a href="#local-6989586621683032483"><span class="hs-identifier hs-var">mb_fun2</span></a></span><span>
</span><span id="line-1999"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032495"><span class="hs-identifier hs-var">tc1</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; TyCon -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032496"><span class="hs-identifier hs-var">tc2</span></a></span><span>
</span><span id="line-2000"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Role -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isInjectiveTyCon"><span class="hs-identifier hs-var">isInjectiveTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032495"><span class="hs-identifier hs-var">tc1</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2001"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AmbiguityInfo -&gt; Maybe AmbiguityInfo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(AmbiguityInfo -&gt; Maybe AmbiguityInfo)
-&gt; AmbiguityInfo -&gt; Maybe AmbiguityInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; AmbiguityInfo
</span><a href="GHC.Tc.Errors.Types.html#NonInjectiveTyFam"><span class="hs-identifier hs-var">NonInjectiveTyFam</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032495"><span class="hs-identifier hs-var">tc1</span></a></span><span>
</span><span id="line-2002"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2003"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe AmbiguityInfo
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2004"></span><span>
</span><span id="line-2005"></span><span class="annot"><a href="GHC.Tc.Errors.html#misMatchOrCND"><span class="hs-identifier hs-type">misMatchOrCND</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span>
</span><span id="line-2006"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#MismatchMsg"><span class="hs-identifier hs-type">MismatchMsg</span></a></span><span>
</span><span id="line-2007"></span><span class="hs-comment">-- If oriented then ty1 is actual, ty2 is expected</span><span>
</span><span id="line-2008"></span><span id="misMatchOrCND"><span class="annot"><span class="annottext">misMatchOrCND :: SolverReportErrCtxt -&gt; ErrorItem -&gt; Type -&gt; Type -&gt; MismatchMsg
</span><a href="GHC.Tc.Errors.html#misMatchOrCND"><span class="hs-identifier hs-var hs-var">misMatchOrCND</span></a></span></span><span> </span><span id="local-6989586621683032500"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032500"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032501"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032501"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span id="local-6989586621683032502"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032502"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621683032503"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032503"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>
</span><span id="line-2009"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032504"><span class="hs-identifier hs-var">insoluble_item</span></a></span><span>   </span><span class="hs-comment">-- See Note [Insoluble mis-match]</span><span>
</span><span id="line-2010"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isRigidTy"><span class="hs-identifier hs-var">isRigidTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032502"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isRigidTy"><span class="hs-identifier hs-var">isRigidTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032503"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2011"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; CtFlavour
</span><a href="GHC.Tc.Errors.Types.html#ei_flavour"><span class="hs-identifier hs-var">ei_flavour</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032501"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">CtFlavour -&gt; CtFlavour -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CtFlavour
</span><a href="GHC.Tc.Types.Constraint.html#Given"><span class="hs-identifier hs-var">Given</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2012"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[Implication] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Implication]
</span><a href="#local-6989586621683032505"><span class="hs-identifier hs-var">givens</span></a></span><span>
</span><span id="line-2013"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- If the equality is unconditionally insoluble</span><span>
</span><span id="line-2014"></span><span>    </span><span class="hs-comment">-- or there is no context, don't report the context</span><span>
</span><span id="line-2015"></span><span>    </span><span class="annot"><span class="annottext">ErrorItem -&gt; Type -&gt; Type -&gt; MismatchMsg
</span><a href="GHC.Tc.Errors.html#mkMismatchMsg"><span class="hs-identifier hs-var">mkMismatchMsg</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032501"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032502"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032503"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-2016"></span><span>
</span><span id="line-2017"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2018"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Implication]
-&gt; NonEmpty ErrorItem -&gt; Maybe CND_Extra -&gt; MismatchMsg
</span><a href="GHC.Tc.Errors.Types.html#CouldNotDeduce"><span class="hs-identifier hs-var">CouldNotDeduce</span></a></span><span> </span><span class="annot"><span class="annottext">[Implication]
</span><a href="#local-6989586621683032505"><span class="hs-identifier hs-var">givens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032501"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; [ErrorItem] -&gt; NonEmpty ErrorItem
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CND_Extra -&gt; Maybe CND_Extra
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CND_Extra -&gt; Maybe CND_Extra) -&gt; CND_Extra -&gt; Maybe CND_Extra
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeOrKind -&gt; Type -&gt; Type -&gt; CND_Extra
</span><a href="GHC.Tc.Errors.Types.html#CND_Extra"><span class="hs-identifier hs-var">CND_Extra</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrKind
</span><a href="#local-6989586621683032507"><span class="hs-identifier hs-var">level</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032502"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032503"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2019"></span><span>
</span><span id="line-2020"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2021"></span><span>    </span><span id="local-6989586621683032504"><span class="annot"><span class="annottext">insoluble_item :: Bool
</span><a href="#local-6989586621683032504"><span class="hs-identifier hs-var hs-var">insoluble_item</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Maybe CtIrredReason
</span><a href="GHC.Tc.Errors.Types.html#ei_m_reason"><span class="hs-identifier hs-var">ei_m_reason</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032501"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2022"></span><span>                       </span><span class="annot"><span class="annottext">Maybe CtIrredReason
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2023"></span><span>                       </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032508"><span class="annot"><span class="annottext">CtIrredReason
</span><a href="#local-6989586621683032508"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CtIrredReason -&gt; Bool
</span><a href="GHC.Tc.Types.Constraint.html#isInsolubleReason"><span class="hs-identifier hs-var">isInsolubleReason</span></a></span><span> </span><span class="annot"><span class="annottext">CtIrredReason
</span><a href="#local-6989586621683032508"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2024"></span><span>
</span><span id="line-2025"></span><span>    </span><span id="local-6989586621683032507"><span class="annot"><span class="annottext">level :: TypeOrKind
</span><a href="#local-6989586621683032507"><span class="hs-identifier hs-var hs-var">level</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CtLoc -&gt; Maybe TypeOrKind
</span><a href="GHC.Tc.Types.CtLoc.html#ctLocTypeOrKind_maybe"><span class="hs-identifier hs-var">ctLocTypeOrKind_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; CtLoc
</span><a href="GHC.Tc.Errors.Types.html#errorItemCtLoc"><span class="hs-identifier hs-var">errorItemCtLoc</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032501"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe TypeOrKind -&gt; TypeOrKind -&gt; TypeOrKind
forall a. Maybe a -&gt; a -&gt; a
</span><a href="GHC.Data.Maybe.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrKind
</span><a href="GHC.Types.Basic.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a></span><span>
</span><span id="line-2026"></span><span>    </span><span id="local-6989586621683032505"><span class="annot"><span class="annottext">givens :: [Implication]
</span><a href="#local-6989586621683032505"><span class="hs-identifier hs-var hs-var">givens</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683032513"><span class="hs-identifier hs-var">given</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621683032513"><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683032513"><span class="hs-identifier hs-var">given</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; [Implication]
</span><a href="GHC.Tc.Errors.Types.html#getUserGivens"><span class="hs-identifier hs-var">getUserGivens</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032500"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Implication -&gt; HasGivenEqs
</span><a href="GHC.Tc.Types.Constraint.html#ic_given_eqs"><span class="hs-identifier hs-var">ic_given_eqs</span></a></span><span> </span><span class="annot"><span class="annottext">Implication
</span><a href="#local-6989586621683032513"><span class="hs-identifier hs-var">given</span></a></span><span> </span><span class="annot"><span class="annottext">HasGivenEqs -&gt; HasGivenEqs -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">HasGivenEqs
</span><a href="GHC.Tc.Types.Constraint.html#NoGivenEqs"><span class="hs-identifier hs-var">NoGivenEqs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2027"></span><span>              </span><span class="hs-comment">-- Keep only UserGivens that have some equalities.</span><span>
</span><span id="line-2028"></span><span>              </span><span class="hs-comment">-- See Note [Suppress redundant givens during error reporting]</span><span>
</span><span id="line-2029"></span><span>
</span><span id="line-2030"></span><span class="hs-comment">-- These are for the &quot;blocked&quot; equalities, as described in GHC.Tc.Solver.Equality</span><span>
</span><span id="line-2031"></span><span class="hs-comment">-- Note [Equalities with incompatible kinds], wrinkle (EIK2). There should</span><span>
</span><span id="line-2032"></span><span class="hs-comment">-- always be another unsolved wanted around, which will ordinarily suppress</span><span>
</span><span id="line-2033"></span><span class="hs-comment">-- this message. But this can still be printed out with -fdefer-type-errors</span><span>
</span><span id="line-2034"></span><span class="hs-comment">-- (sigh), so we must produce a message.</span><span>
</span><span id="line-2035"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkBlockedEqErr"><span class="hs-identifier hs-type">mkBlockedEqErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcSolverReportMsg"><span class="hs-identifier hs-type">TcSolverReportMsg</span></a></span><span>
</span><span id="line-2036"></span><span id="mkBlockedEqErr"><span class="annot"><span class="annottext">mkBlockedEqErr :: ErrorItem -&gt; TcSolverReportMsg
</span><a href="GHC.Tc.Errors.html#mkBlockedEqErr"><span class="hs-identifier hs-var hs-var">mkBlockedEqErr</span></a></span></span><span> </span><span id="local-6989586621683032514"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032514"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; TcSolverReportMsg
</span><a href="GHC.Tc.Errors.Types.html#BlockedEquality"><span class="hs-identifier hs-var">BlockedEquality</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032514"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-2037"></span><span>
</span><span id="line-2038"></span><span class="hs-comment">{-
Note [Suppress redundant givens during error reporting]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When GHC is unable to solve a constraint and prints out an error message, it
will print out what given constraints are in scope to provide some context to
the programmer. But we shouldn't print out /every/ given, since some of them
are not terribly helpful to diagnose type errors. Consider this example:

  foo :: Int :~: Int -&gt; a :~: b -&gt; a :~: c
  foo Refl Refl = Refl

When reporting that GHC can't solve (a ~ c), there are two givens in scope:
(Int ~ Int) and (a ~ b). But (Int ~ Int) is trivially soluble (i.e.,
redundant), so it's not terribly useful to report it in an error message.
To accomplish this, we discard any Implications that do not bind any
equalities by filtering the `givens` selected in `misMatchOrCND` (based on
the `ic_given_eqs` field of the Implication). Note that we discard givens
that have no equalities whatsoever, but we want to keep ones with only *local*
equalities, as these may be helpful to the user in understanding what went
wrong.

But this is not enough to avoid all redundant givens! Consider this example,
from #15361:

  goo :: forall (a :: Type) (b :: Type) (c :: Type).
         a :~~: b -&gt; a :~~: c
  goo HRefl = HRefl

Matching on HRefl brings the /single/ given (* ~ *, a ~ b) into scope.
The (* ~ *) part arises due the kinds of (:~~:) being unified. More
importantly, (* ~ *) is redundant, so we'd like not to report it. However,
the Implication (* ~ *, a ~ b) /does/ bind an equality (as reported by its
ic_given_eqs field), so the test above will keep it wholesale.

To refine this given, we apply mkMinimalBySCs on it to extract just the (a ~ b)
part. This works because mkMinimalBySCs eliminates reflexive equalities in
addition to superclasses (see Note [Remove redundant provided dicts]
in GHC.Tc.TyCl.PatSyn).
-}</span><span>
</span><span id="line-2077"></span><span>
</span><span id="line-2078"></span><span class="annot"><a href="GHC.Tc.Errors.html#extraTyVarEqInfo"><span class="hs-identifier hs-type">extraTyVarEqInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Implication"><span class="hs-identifier hs-type">Implication</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TyVarInfo"><span class="hs-identifier hs-type">TyVarInfo</span></a></span><span>
</span><span id="line-2079"></span><span class="hs-comment">-- Add on extra info about skolem constants</span><span>
</span><span id="line-2080"></span><span class="hs-comment">-- NB: The types themselves are already tidied</span><span>
</span><span id="line-2081"></span><span id="extraTyVarEqInfo"><span class="annot"><span class="annottext">extraTyVarEqInfo :: (TcId, Maybe Implication)
-&gt; Type -&gt; IOEnv (Env TcGblEnv TcLclEnv) TyVarInfo
</span><a href="GHC.Tc.Errors.html#extraTyVarEqInfo"><span class="hs-identifier hs-var hs-var">extraTyVarEqInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032516"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032516"><span class="hs-identifier hs-var">tv1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032517"><span class="annot"><span class="annottext">Maybe Implication
</span><a href="#local-6989586621683032517"><span class="hs-identifier hs-var">mb_implic</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683032518"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032518"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>
</span><span id="line-2082"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2083"></span><span>      </span><span id="local-6989586621683032519"><span class="annot"><a href="#local-6989586621683032519"><span class="hs-identifier hs-var">tv1_info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcId -&gt; TcM TcId
</span><a href="GHC.Tc.Errors.html#extraTyVarInfo"><span class="hs-identifier hs-var">extraTyVarInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032516"><span class="hs-identifier hs-var">tv1</span></a></span><span>
</span><span id="line-2084"></span><span>      </span><span id="local-6989586621683032521"><span class="annot"><a href="#local-6989586621683032521"><span class="hs-identifier hs-var">ty2_info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683032522"><span class="hs-identifier hs-type">ty_extra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032518"><span class="hs-identifier hs-type">ty2</span></a></span><span>
</span><span id="line-2085"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2086"></span><span>        </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TyVarInfo"><span class="hs-identifier hs-type">TyVarInfo</span></a></span><span>
</span><span id="line-2087"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#thisTyVar"><span class="hs-identifier hs-var">thisTyVar</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683032519"><span class="hs-identifier hs-type">tv1_info</span></a></span><span>
</span><span id="line-2088"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#thisTyVarIsUntouchable"><span class="hs-identifier hs-var">thisTyVarIsUntouchable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683032517"><span class="hs-identifier hs-type">mb_implic</span></a></span><span>
</span><span id="line-2089"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#otherTy"><span class="hs-identifier hs-var">otherTy</span></a></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683032521"><span class="hs-identifier hs-type">ty2_info</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2090"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2091"></span><span>    </span><span id="local-6989586621683032522"><span class="annot"><span class="annottext">ty_extra :: Type -&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe TcId)
</span><a href="#local-6989586621683032522"><span class="hs-identifier hs-var hs-var">ty_extra</span></a></span></span><span> </span><span id="local-6989586621683032528"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032528"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TcId, TcCoercionN)
</span><a href="GHC.Core.Type.html#getCastedTyVar_maybe"><span class="hs-identifier hs-var">getCastedTyVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032528"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2092"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032529"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032529"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcCoercionN
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcId -&gt; Maybe TcId
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(TcId -&gt; Maybe TcId)
-&gt; TcM TcId -&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe TcId)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TcId -&gt; TcM TcId
</span><a href="GHC.Tc.Errors.html#extraTyVarInfo"><span class="hs-identifier hs-var">extraTyVarInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032529"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-2093"></span><span>                    </span><span class="annot"><span class="annottext">Maybe (TcId, TcCoercionN)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe TcId -&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe TcId)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe TcId
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2094"></span><span>
</span><span id="line-2095"></span><span class="annot"><a href="GHC.Tc.Errors.html#extraTyVarInfo"><span class="hs-identifier hs-type">extraTyVarInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span>
</span><span id="line-2096"></span><span id="extraTyVarInfo"><span class="annot"><span class="annottext">extraTyVarInfo :: TcId -&gt; TcM TcId
</span><a href="GHC.Tc.Errors.html#extraTyVarInfo"><span class="hs-identifier hs-var hs-var">extraTyVarInfo</span></a></span></span><span> </span><span id="local-6989586621683032531"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032531"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; TcM TcId -&gt; TcM TcId
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032531"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032531"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcM TcId -&gt; TcM TcId) -&gt; TcM TcId -&gt; TcM TcId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2097"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TcId -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032531"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2098"></span><span>    </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SkolemTv"><span class="hs-identifier hs-type">SkolemTv</span></a></span><span> </span><span id="local-6989586621683032534"><span class="annot"><span class="annottext">SkolemInfo
</span><a href="#local-6989586621683032534"><span class="hs-identifier hs-var">skol_info</span></a></span></span><span> </span><span id="local-6989586621683032535"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621683032535"><span class="hs-identifier hs-var">lvl</span></a></span></span><span> </span><span id="local-6989586621683032536"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032536"><span class="hs-identifier hs-var">overlaps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2099"></span><span>      </span><span id="local-6989586621683032537"><span class="annot"><a href="#local-6989586621683032537"><span class="hs-identifier hs-var">new_skol_info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ZonkM SkolemInfo -&gt; TcM SkolemInfo
forall a. ZonkM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#liftZonkM"><span class="hs-identifier hs-var">liftZonkM</span></a></span><span> </span><span class="annot"><span class="annottext">(ZonkM SkolemInfo -&gt; TcM SkolemInfo)
-&gt; ZonkM SkolemInfo -&gt; TcM SkolemInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SkolemInfo -&gt; ZonkM SkolemInfo
</span><a href="GHC.Tc.Zonk.TcType.html#zonkSkolemInfo"><span class="hs-identifier hs-var">zonkSkolemInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SkolemInfo
</span><a href="#local-6989586621683032534"><span class="hs-identifier hs-var">skol_info</span></a></span><span>
</span><span id="line-2100"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#mkTcTyVar"><span class="hs-identifier hs-type">mkTcTyVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#tyVarName"><span class="hs-identifier hs-type">tyVarName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032531"><span class="hs-identifier hs-type">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-type">tyVarKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032531"><span class="hs-identifier hs-type">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SkolemTv"><span class="hs-identifier hs-type">SkolemTv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032537"><span class="hs-identifier hs-type">new_skol_info</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032535"><span class="hs-identifier hs-type">lvl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032536"><span class="hs-identifier hs-type">overlaps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2101"></span><span>    </span><span class="annot"><span class="annottext">TcTyVarDetails
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcId -&gt; TcM TcId
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032531"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-2102"></span><span>
</span><span id="line-2103"></span><span class="hs-comment">--------------------</span><span>
</span><span id="line-2104"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkMismatchMsg"><span class="hs-identifier hs-type">mkMismatchMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#MismatchMsg"><span class="hs-identifier hs-type">MismatchMsg</span></a></span><span>
</span><span id="line-2105"></span><span id="mkMismatchMsg"><span class="annot"><span class="annottext">mkMismatchMsg :: ErrorItem -&gt; Type -&gt; Type -&gt; MismatchMsg
</span><a href="GHC.Tc.Errors.html#mkMismatchMsg"><span class="hs-identifier hs-var hs-var">mkMismatchMsg</span></a></span></span><span> </span><span id="local-6989586621683032541"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032541"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span id="local-6989586621683032542"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032542"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621683032543"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032543"><span class="hs-identifier hs-var">ty2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2106"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CtOrigin
</span><a href="#local-6989586621683032544"><span class="hs-identifier hs-var">orig</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2107"></span><span>    </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#TypeEqOrigin"><span class="hs-identifier hs-type">TypeEqOrigin</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683032546"><span class="annot"><span class="annottext">Type
uo_actual :: Type
uo_actual :: CtOrigin -&gt; Type
</span><a href="#local-6989586621683032546"><span class="hs-identifier hs-var hs-var">uo_actual</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032548"><span class="annot"><span class="annottext">Type
uo_expected :: Type
uo_expected :: CtOrigin -&gt; Type
</span><a href="#local-6989586621683032548"><span class="hs-identifier hs-var hs-var">uo_expected</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uo_thing :: CtOrigin -&gt; Maybe TypedThing
</span><a href="GHC.Tc.Types.Origin.html#uo_thing"><span class="hs-identifier hs-var">uo_thing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032551"><span class="annot"><span class="annottext">Maybe TypedThing
</span><a href="#local-6989586621683032551"><span class="hs-identifier hs-var">mb_thing</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2108"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TypeEqMismatch"><span class="hs-identifier hs-type">TypeEqMismatch</span></a></span><span>
</span><span id="line-2109"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">teq_mismatch_item :: ErrorItem
</span><a href="GHC.Tc.Errors.Types.html#teq_mismatch_item"><span class="hs-identifier hs-var">teq_mismatch_item</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032541"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-2110"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">teq_mismatch_ty1 :: Type
</span><a href="GHC.Tc.Errors.Types.html#teq_mismatch_ty1"><span class="hs-identifier hs-var">teq_mismatch_ty1</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032542"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-2111"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">teq_mismatch_ty2 :: Type
</span><a href="GHC.Tc.Errors.Types.html#teq_mismatch_ty2"><span class="hs-identifier hs-var">teq_mismatch_ty2</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032543"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-2112"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">teq_mismatch_actual :: Type
</span><a href="GHC.Tc.Errors.Types.html#teq_mismatch_actual"><span class="hs-identifier hs-var">teq_mismatch_actual</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032546"><span class="hs-identifier hs-var">uo_actual</span></a></span><span>
</span><span id="line-2113"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">teq_mismatch_expected :: Type
</span><a href="GHC.Tc.Errors.Types.html#teq_mismatch_expected"><span class="hs-identifier hs-var">teq_mismatch_expected</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032548"><span class="hs-identifier hs-var">uo_expected</span></a></span><span>
</span><span id="line-2114"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">teq_mismatch_what :: Maybe TypedThing
</span><a href="GHC.Tc.Errors.Types.html#teq_mismatch_what"><span class="hs-identifier hs-var">teq_mismatch_what</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TypedThing
</span><a href="#local-6989586621683032551"><span class="hs-identifier hs-var">mb_thing</span></a></span><span>
</span><span id="line-2115"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">teq_mb_same_occ :: Maybe SameOccInfo
</span><a href="GHC.Tc.Errors.Types.html#teq_mb_same_occ"><span class="hs-identifier hs-var">teq_mb_same_occ</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Maybe SameOccInfo
</span><a href="GHC.Tc.Errors.html#sameOccExtras"><span class="hs-identifier hs-var">sameOccExtras</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032543"><span class="hs-identifier hs-var">ty2</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032542"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2116"></span><span>    </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#KindEqOrigin"><span class="hs-identifier hs-type">KindEqOrigin</span></a></span><span> </span><span id="local-6989586621683032562"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032562"><span class="hs-identifier hs-var">cty1</span></a></span></span><span> </span><span id="local-6989586621683032563"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032563"><span class="hs-identifier hs-var">cty2</span></a></span></span><span> </span><span id="local-6989586621683032564"><span class="annot"><span class="annottext">CtOrigin
</span><a href="#local-6989586621683032564"><span class="hs-identifier hs-var">sub_o</span></a></span></span><span> </span><span id="local-6989586621683032565"><span class="annot"><span class="annottext">Maybe TypeOrKind
</span><a href="#local-6989586621683032565"><span class="hs-identifier hs-var">mb_sub_t_or_k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#BasicMismatch"><span class="hs-identifier hs-type">BasicMismatch</span></a></span><span>
</span><span id="line-2117"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mismatch_ea :: MismatchEA
</span><a href="GHC.Tc.Errors.Types.html#mismatch_ea"><span class="hs-identifier hs-var">mismatch_ea</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MismatchEA
</span><a href="GHC.Tc.Errors.Types.html#NoEA"><span class="hs-identifier hs-var">NoEA</span></a></span><span>
</span><span id="line-2118"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mismatch_item :: ErrorItem
</span><a href="GHC.Tc.Errors.Types.html#mismatch_item"><span class="hs-identifier hs-var">mismatch_item</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032541"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-2119"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mismatch_ty1 :: Type
</span><a href="GHC.Tc.Errors.Types.html#mismatch_ty1"><span class="hs-identifier hs-var">mismatch_ty1</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032542"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-2120"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mismatch_ty2 :: Type
</span><a href="GHC.Tc.Errors.Types.html#mismatch_ty2"><span class="hs-identifier hs-var">mismatch_ty2</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032543"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-2121"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mismatch_whenMatching :: Maybe WhenMatching
</span><a href="GHC.Tc.Errors.Types.html#mismatch_whenMatching"><span class="hs-identifier hs-var">mismatch_whenMatching</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WhenMatching -&gt; Maybe WhenMatching
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(WhenMatching -&gt; Maybe WhenMatching)
-&gt; WhenMatching -&gt; Maybe WhenMatching
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; CtOrigin -&gt; Maybe TypeOrKind -&gt; WhenMatching
</span><a href="GHC.Tc.Errors.Types.html#WhenMatching"><span class="hs-identifier hs-var">WhenMatching</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032562"><span class="hs-identifier hs-var">cty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032563"><span class="hs-identifier hs-var">cty2</span></a></span><span> </span><span class="annot"><span class="annottext">CtOrigin
</span><a href="#local-6989586621683032564"><span class="hs-identifier hs-var">sub_o</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TypeOrKind
</span><a href="#local-6989586621683032565"><span class="hs-identifier hs-var">mb_sub_t_or_k</span></a></span><span>
</span><span id="line-2122"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mismatch_mb_same_occ :: Maybe SameOccInfo
</span><a href="GHC.Tc.Errors.Types.html#mismatch_mb_same_occ"><span class="hs-identifier hs-var">mismatch_mb_same_occ</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe SameOccInfo
</span><a href="#local-6989586621683032575"><span class="hs-identifier hs-var">mb_same_occ</span></a></span><span>
</span><span id="line-2123"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-2124"></span><span>    </span><span class="annot"><span class="annottext">CtOrigin
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#BasicMismatch"><span class="hs-identifier hs-type">BasicMismatch</span></a></span><span>
</span><span id="line-2125"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mismatch_ea :: MismatchEA
</span><a href="GHC.Tc.Errors.Types.html#mismatch_ea"><span class="hs-identifier hs-var">mismatch_ea</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MismatchEA
</span><a href="GHC.Tc.Errors.Types.html#NoEA"><span class="hs-identifier hs-var">NoEA</span></a></span><span>
</span><span id="line-2126"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mismatch_item :: ErrorItem
</span><a href="GHC.Tc.Errors.Types.html#mismatch_item"><span class="hs-identifier hs-var">mismatch_item</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032541"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-2127"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mismatch_ty1 :: Type
</span><a href="GHC.Tc.Errors.Types.html#mismatch_ty1"><span class="hs-identifier hs-var">mismatch_ty1</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032542"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-2128"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mismatch_ty2 :: Type
</span><a href="GHC.Tc.Errors.Types.html#mismatch_ty2"><span class="hs-identifier hs-var">mismatch_ty2</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032543"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-2129"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mismatch_whenMatching :: Maybe WhenMatching
</span><a href="GHC.Tc.Errors.Types.html#mismatch_whenMatching"><span class="hs-identifier hs-var">mismatch_whenMatching</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe WhenMatching
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2130"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mismatch_mb_same_occ :: Maybe SameOccInfo
</span><a href="GHC.Tc.Errors.Types.html#mismatch_mb_same_occ"><span class="hs-identifier hs-var">mismatch_mb_same_occ</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe SameOccInfo
</span><a href="#local-6989586621683032575"><span class="hs-identifier hs-var">mb_same_occ</span></a></span><span>
</span><span id="line-2131"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-2132"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2133"></span><span>    </span><span id="local-6989586621683032544"><span class="annot"><span class="annottext">orig :: CtOrigin
</span><a href="#local-6989586621683032544"><span class="hs-identifier hs-var hs-var">orig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; CtOrigin
</span><a href="GHC.Tc.Errors.Types.html#errorItemOrigin"><span class="hs-identifier hs-var">errorItemOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032541"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-2134"></span><span>    </span><span id="local-6989586621683032575"><span class="annot"><span class="annottext">mb_same_occ :: Maybe SameOccInfo
</span><a href="#local-6989586621683032575"><span class="hs-identifier hs-var hs-var">mb_same_occ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Maybe SameOccInfo
</span><a href="GHC.Tc.Errors.html#sameOccExtras"><span class="hs-identifier hs-var">sameOccExtras</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032543"><span class="hs-identifier hs-var">ty2</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032542"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-2135"></span><span>
</span><span id="line-2136"></span><span class="hs-comment">{- Note [Insoluble mis-match]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider [G] a ~ [a],  [W] a ~ [a] (#13674).  The Given is insoluble
so we don't use it for rewriting.  The Wanted is also insoluble, and
we don't solve it from the Given.  It's very confusing to say
    Cannot solve a ~ [a] from given constraints a ~ [a]

And indeed even thinking about the Givens is silly; [W] a ~ [a] is
just as insoluble as Int ~ Bool.

Exactly the same is true if we have [G] Int ~ Bool, [W] Int ~ Bool.

Conclusion: if there's an insoluble constraint (isInsolubleReason),
then report it directly, not in the &quot;cannot deduce X from Y&quot; form.
This is done in misMatchOrCND (via the insoluble_occurs_check arg)

(NB: there are potentially-soluble ones, like (a ~ F a b), and we don't
want to be as draconian with them.)
-}</span><span>
</span><span id="line-2155"></span><span>
</span><span id="line-2156"></span><span class="annot"><a href="GHC.Tc.Errors.html#sameOccExtras"><span class="hs-identifier hs-type">sameOccExtras</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SameOccInfo"><span class="hs-identifier hs-type">SameOccInfo</span></a></span><span>
</span><span id="line-2157"></span><span class="hs-comment">-- See Note [Disambiguating (X ~ X) errors]</span><span>
</span><span id="line-2158"></span><span id="sameOccExtras"><span class="annot"><span class="annottext">sameOccExtras :: Type -&gt; Type -&gt; Maybe SameOccInfo
</span><a href="GHC.Tc.Errors.html#sameOccExtras"><span class="hs-identifier hs-var hs-var">sameOccExtras</span></a></span></span><span> </span><span id="local-6989586621683032576"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032576"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621683032577"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032577"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>
</span><span id="line-2159"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032578"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032578"><span class="hs-identifier hs-var">tc1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032576"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-2160"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032579"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032579"><span class="hs-identifier hs-var">tc2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032577"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-2161"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032580"><span class="annot"><span class="annottext">n1 :: Name
</span><a href="#local-6989586621683032580"><span class="hs-identifier hs-var hs-var">n1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032578"><span class="hs-identifier hs-var">tc1</span></a></span><span>
</span><span id="line-2162"></span><span>        </span><span id="local-6989586621683032582"><span class="annot"><span class="annottext">n2 :: Name
</span><a href="#local-6989586621683032582"><span class="hs-identifier hs-var hs-var">n2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032579"><span class="hs-identifier hs-var">tc2</span></a></span><span>
</span><span id="line-2163"></span><span>        </span><span id="local-6989586621683032583"><span class="annot"><span class="annottext">same_occ :: Bool
</span><a href="#local-6989586621683032583"><span class="hs-identifier hs-var hs-var">same_occ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032580"><span class="hs-identifier hs-var">n1</span></a></span><span>                   </span><span class="annot"><span class="annottext">OccName -&gt; OccName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032582"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-2164"></span><span>        </span><span id="local-6989586621683032585"><span class="annot"><span class="annottext">same_pkg :: Bool
</span><a href="#local-6989586621683032585"><span class="hs-identifier hs-var hs-var">same_pkg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenModule Unit -&gt; Unit
forall unit. GenModule unit -&gt; unit
</span><a href="GHC.Unit.Types.html#moduleUnit"><span class="hs-identifier hs-var">moduleUnit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Name -&gt; GenModule Unit
Name -&gt; GenModule Unit
</span><a href="GHC.Types.Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032580"><span class="hs-identifier hs-var">n1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unit -&gt; Unit -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GenModule Unit -&gt; Unit
forall unit. GenModule unit -&gt; unit
</span><a href="GHC.Unit.Types.html#moduleUnit"><span class="hs-identifier hs-var">moduleUnit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Name -&gt; GenModule Unit
Name -&gt; GenModule Unit
</span><a href="GHC.Types.Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032582"><span class="hs-identifier hs-var">n2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2165"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032580"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032582"><span class="hs-identifier hs-var">n2</span></a></span><span>   </span><span class="hs-comment">-- Different Names</span><span>
</span><span id="line-2166"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032583"><span class="hs-identifier hs-var">same_occ</span></a></span><span>   </span><span class="hs-comment">-- but same OccName</span><span>
</span><span id="line-2167"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SameOccInfo -&gt; Maybe SameOccInfo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(SameOccInfo -&gt; Maybe SameOccInfo)
-&gt; SameOccInfo -&gt; Maybe SameOccInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Name -&gt; Name -&gt; SameOccInfo
</span><a href="GHC.Tc.Errors.Types.html#SameOcc"><span class="hs-identifier hs-var">SameOcc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032585"><span class="hs-identifier hs-var">same_pkg</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032580"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032582"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-2168"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2169"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe SameOccInfo
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2170"></span><span>
</span><span id="line-2171"></span><span class="hs-comment">{- Note [Disambiguating (X ~ X) errors]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
See #8278

Note [Reporting occurs-check errors]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Given (a ~ [a]), if 'a' is a rigid type variable bound by a user-supplied
type signature, then the best thing is to report that we can't unify
a with [a], because a is a skolem variable.  That avoids the confusing
&quot;occur-check&quot; error message.

But nowadays when inferring the type of a function with no type signature,
even if there are errors inside, we still generalise its signature and
carry on. For example
   f x = x:x
Here we will infer something like
   f :: forall a. a -&gt; [a]
with a deferred error of (a ~ [a]).  So in the deferred unsolved constraint
'a' is now a skolem, but not one bound by the programmer in the context!
Here we really should report an occurs check.

So isUserSkolem distinguishes the two.

Note [Non-injective type functions]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
It's very confusing to get a message like
     Couldn't match expected type `Depend s'
            against inferred type `Depend s1'
so mkTyFunInfoMsg adds:
       NB: `Depend' is type function, and hence may not be injective

Warn of loopy local equalities that were dropped.


************************************************************************
*                                                                      *
                 Type-class errors
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-2211"></span><span>
</span><span id="line-2212"></span><span class="annot"><a href="GHC.Tc.Errors.html#mkDictErr"><span class="hs-identifier hs-type">mkDictErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReport"><span class="hs-identifier hs-type">SolverReport</span></a></span><span>
</span><span id="line-2213"></span><span id="mkDictErr"><span class="annot"><span class="annottext">mkDictErr :: HasDebugCallStack =&gt;
SolverReportErrCtxt -&gt; NonEmpty ErrorItem -&gt; TcM SolverReport
</span><a href="GHC.Tc.Errors.html#mkDictErr"><span class="hs-identifier hs-var hs-var">mkDictErr</span></a></span></span><span> </span><span id="local-6989586621683032600"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032600"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032601"><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683032601"><span class="hs-identifier hs-var">orig_items</span></a></span></span><span>
</span><span id="line-2214"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683032602"><span class="annot"><a href="#local-6989586621683032602"><span class="hs-identifier hs-var">inst_envs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcM InstEnvs
</span><a href="GHC.Tc.Utils.Env.html#tcGetInstEnvs"><span class="hs-identifier hs-var">tcGetInstEnvs</span></a></span><span>
</span><span id="line-2215"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032604"><span class="annot"><a href="#local-6989586621683032604"><span class="hs-identifier hs-var hs-var">min_items</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem -&gt; [ErrorItem]
</span><a href="#local-6989586621683032605"><span class="hs-identifier hs-var">elim_superclasses</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683032606"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-2216"></span><span>             </span><span id="local-6989586621683032607"><span class="annot"><a href="#local-6989586621683032607"><span class="hs-identifier hs-var hs-var">lookups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ErrorItem -&gt; (ErrorItem, ClsInstLookupResult))
-&gt; [ErrorItem] -&gt; [(ErrorItem, ClsInstLookupResult)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstEnvs -&gt; ErrorItem -&gt; (ErrorItem, ClsInstLookupResult)
</span><a href="#local-6989586621683032608"><span class="hs-identifier hs-var">lookup_cls_inst</span></a></span><span> </span><span class="annot"><span class="annottext">InstEnvs
</span><a href="#local-6989586621683032602"><span class="hs-identifier hs-var">inst_envs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ErrorItem]
</span><a href="#local-6989586621683032604"><span class="hs-identifier hs-var">min_items</span></a></span><span>
</span><span id="line-2217"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621683032609"><span class="annot"><a href="#local-6989586621683032609"><span class="hs-identifier hs-var">no_inst_items</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032610"><span class="annot"><a href="#local-6989586621683032610"><span class="hs-identifier hs-var">overlap_items</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">partition</span></span><span> </span><span class="annot"><a href="#local-6989586621683032611"><span class="hs-identifier hs-type">is_no_inst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032607"><span class="hs-identifier hs-type">lookups</span></a></span><span>
</span><span id="line-2218"></span><span>
</span><span id="line-2219"></span><span>       </span><span class="hs-comment">-- Report definite no-instance errors,</span><span>
</span><span id="line-2220"></span><span>       </span><span class="hs-comment">-- or (iff there are none) overlap errors</span><span>
</span><span id="line-2221"></span><span>       </span><span class="hs-comment">-- But we report only one of them (hence 'head') because they all</span><span>
</span><span id="line-2222"></span><span>       </span><span class="hs-comment">-- have the same source-location origin, to try avoid a cascade</span><span>
</span><span id="line-2223"></span><span>       </span><span class="hs-comment">-- of error from one location</span><span>
</span><span id="line-2224"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683032612"><span class="annot"><a href="#local-6989586621683032612"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#mk_dict_err"><span class="hs-identifier hs-type">mk_dict_err</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032600"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Prelude.Basic.html#head"><span class="hs-identifier hs-type">head</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683032609"><span class="hs-identifier hs-type">no_inst_items</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621683032610"><span class="hs-identifier hs-type">overlap_items</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2225"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#important"><span class="hs-identifier hs-type">important</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032600"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032612"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2226"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2227"></span><span>    </span><span id="local-6989586621683032606"><span class="annot"><span class="annottext">items :: NonEmpty ErrorItem
</span><a href="#local-6989586621683032606"><span class="hs-identifier hs-var hs-var">items</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ErrorItem -&gt; Bool) -&gt; NonEmpty ErrorItem -&gt; NonEmpty ErrorItem
forall a. (a -&gt; Bool) -&gt; NonEmpty a -&gt; NonEmpty a
</span><a href="GHC.Tc.Errors.html#tryFilter"><span class="hs-identifier hs-var">tryFilter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (ErrorItem -&gt; Bool) -&gt; ErrorItem -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Bool
</span><a href="GHC.Tc.Errors.Types.html#ei_suppress"><span class="hs-identifier hs-var">ei_suppress</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem
</span><a href="#local-6989586621683032601"><span class="hs-identifier hs-var">orig_items</span></a></span><span>
</span><span id="line-2228"></span><span>
</span><span id="line-2229"></span><span>    </span><span id="local-6989586621683032615"><span class="annot"><span class="annottext">no_givens :: Bool
</span><a href="#local-6989586621683032615"><span class="hs-identifier hs-var hs-var">no_givens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Implication] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; [Implication]
</span><a href="GHC.Tc.Errors.Types.html#getUserGivens"><span class="hs-identifier hs-var">getUserGivens</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032600"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2230"></span><span>
</span><span id="line-2231"></span><span>    </span><span id="local-6989586621683032611"><span class="annot"><span class="annottext">is_no_inst :: (ErrorItem, ClsInstLookupResult) -&gt; Bool
</span><a href="#local-6989586621683032611"><span class="hs-identifier hs-var hs-var">is_no_inst</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032616"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032616"><span class="hs-identifier hs-var">item</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032617"><span class="annot"><span class="annottext">[InstMatch]
</span><a href="#local-6989586621683032617"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032618"><span class="annot"><span class="annottext">PotentialUnifiers
</span><a href="#local-6989586621683032618"><span class="hs-identifier hs-var">unifiers</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[InstMatch]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2232"></span><span>      </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032615"><span class="hs-identifier hs-var">no_givens</span></a></span><span>
</span><span id="line-2233"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[InstMatch] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[InstMatch]
</span><a href="#local-6989586621683032617"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-2234"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PotentialUnifiers -&gt; Bool
</span><a href="GHC.Core.InstEnv.html#nullUnifiers"><span class="hs-identifier hs-var">nullUnifiers</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialUnifiers
</span><a href="#local-6989586621683032618"><span class="hs-identifier hs-var">unifiers</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(TcId -&gt; Bool) -&gt; [TcId] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (TcId -&gt; Bool) -&gt; TcId -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TcId -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isAmbiguousTyVar"><span class="hs-identifier hs-var">isAmbiguousTyVar</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; [TcId]
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeList"><span class="hs-identifier hs-var">tyCoVarsOfTypeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; Type
</span><a href="GHC.Tc.Errors.Types.html#errorItemPred"><span class="hs-identifier hs-var">errorItemPred</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032616"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2235"></span><span>
</span><span id="line-2236"></span><span>    </span><span id="local-6989586621683032608"><span class="annot"><span class="annottext">lookup_cls_inst :: InstEnvs -&gt; ErrorItem -&gt; (ErrorItem, ClsInstLookupResult)
</span><a href="#local-6989586621683032608"><span class="hs-identifier hs-var hs-var">lookup_cls_inst</span></a></span></span><span> </span><span id="local-6989586621683032622"><span class="annot"><span class="annottext">InstEnvs
</span><a href="#local-6989586621683032622"><span class="hs-identifier hs-var">inst_envs</span></a></span></span><span> </span><span id="local-6989586621683032623"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032623"><span class="hs-identifier hs-var">item</span></a></span></span><span>
</span><span id="line-2237"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032623"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; InstEnvs -&gt; Class -&gt; [Type] -&gt; ClsInstLookupResult
</span><a href="GHC.Core.InstEnv.html#lookupInstEnv"><span class="hs-identifier hs-var">lookupInstEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">InstEnvs
</span><a href="#local-6989586621683032622"><span class="hs-identifier hs-var">inst_envs</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621683032625"><span class="hs-identifier hs-var">clas</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683032626"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2238"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-2239"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621683032625"><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621683032625"><span class="hs-identifier hs-var">clas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032626"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683032626"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; (Class, [Type])
Type -&gt; (Class, [Type])
</span><a href="GHC.Core.Predicate.html#getClassPredTys"><span class="hs-identifier hs-var">getClassPredTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; Type
</span><a href="GHC.Tc.Errors.Types.html#errorItemPred"><span class="hs-identifier hs-var">errorItemPred</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032623"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2240"></span><span>
</span><span id="line-2241"></span><span>
</span><span id="line-2242"></span><span>    </span><span class="hs-comment">-- When simplifying [W] Ord (Set a), we need</span><span>
</span><span id="line-2243"></span><span>    </span><span class="hs-comment">--    [W] Eq a, [W] Ord a</span><span>
</span><span id="line-2244"></span><span>    </span><span class="hs-comment">-- but we really only want to report the latter</span><span>
</span><span id="line-2245"></span><span>    </span><span id="local-6989586621683032605"><span class="annot"><span class="annottext">elim_superclasses :: NonEmpty ErrorItem -&gt; [ErrorItem]
</span><a href="#local-6989586621683032605"><span class="hs-identifier hs-var hs-var">elim_superclasses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ErrorItem -&gt; Type) -&gt; [ErrorItem] -&gt; [ErrorItem]
forall a. (a -&gt; Type) -&gt; [a] -&gt; [a]
</span><a href="GHC.Tc.Utils.TcType.html#mkMinimalBySCs"><span class="hs-identifier hs-var">mkMinimalBySCs</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Type
</span><a href="GHC.Tc.Errors.Types.html#errorItemPred"><span class="hs-identifier hs-var">errorItemPred</span></a></span><span> </span><span class="annot"><span class="annottext">([ErrorItem] -&gt; [ErrorItem])
-&gt; (NonEmpty ErrorItem -&gt; [ErrorItem])
-&gt; NonEmpty ErrorItem
-&gt; [ErrorItem]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty ErrorItem -&gt; [ErrorItem]
forall a. NonEmpty a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span>
</span><span id="line-2246"></span><span>
</span><span id="line-2247"></span><span class="hs-comment">-- Note [mk_dict_err]</span><span>
</span><span id="line-2248"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-2249"></span><span class="hs-comment">-- Different dictionary error messages are reported depending on the number of</span><span>
</span><span id="line-2250"></span><span class="hs-comment">-- matches and unifiers:</span><span>
</span><span id="line-2251"></span><span class="hs-comment">--</span><span>
</span><span id="line-2252"></span><span class="hs-comment">--   - No matches, regardless of unifiers: report &quot;No instance for ...&quot;.</span><span>
</span><span id="line-2253"></span><span class="hs-comment">--   - Two or more matches, regardless of unifiers: report &quot;Overlapping instances for ...&quot;,</span><span>
</span><span id="line-2254"></span><span class="hs-comment">--     and show the matching and unifying instances.</span><span>
</span><span id="line-2255"></span><span class="hs-comment">--   - One match, one or more unifiers: report &quot;Overlapping instances for&quot;, show the</span><span>
</span><span id="line-2256"></span><span class="hs-comment">--     matching and unifying instances, and say &quot;The choice depends on the instantion of ...,</span><span>
</span><span id="line-2257"></span><span class="hs-comment">--     and the result of evaluating ...&quot;.</span><span>
</span><span id="line-2258"></span><span class="annot"><a href="GHC.Tc.Errors.html#mk_dict_err"><span class="hs-identifier hs-type">mk_dict_err</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.InstEnv.html#ClsInstLookupResult"><span class="hs-identifier hs-type">ClsInstLookupResult</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2259"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcSolverReportMsg"><span class="hs-identifier hs-type">TcSolverReportMsg</span></a></span><span>
</span><span id="line-2260"></span><span id="mk_dict_err"><span class="annot"><span class="annottext">mk_dict_err :: HasCallStack =&gt;
SolverReportErrCtxt
-&gt; (ErrorItem, ClsInstLookupResult) -&gt; TcM TcSolverReportMsg
</span><a href="GHC.Tc.Errors.html#mk_dict_err"><span class="hs-identifier hs-var hs-var">mk_dict_err</span></a></span></span><span> </span><span id="local-6989586621683032665"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032665"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032666"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032666"><span class="hs-identifier hs-var">item</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032667"><span class="annot"><span class="annottext">[InstMatch]
</span><a href="#local-6989586621683032667"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032668"><span class="annot"><span class="annottext">PotentialUnifiers
</span><a href="#local-6989586621683032668"><span class="hs-identifier hs-var">unifiers</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032669"><span class="annot"><span class="annottext">[InstMatch]
</span><a href="#local-6989586621683032669"><span class="hs-identifier hs-var">unsafe_overlapped</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[InstMatch] -&gt; Maybe (NonEmpty InstMatch)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#nonEmpty"><span class="hs-identifier hs-var">NE.nonEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[InstMatch]
</span><a href="#local-6989586621683032667"><span class="hs-identifier hs-var">matches</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[InstMatch] -&gt; Maybe (NonEmpty InstMatch)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#nonEmpty"><span class="hs-identifier hs-var">NE.nonEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[InstMatch]
</span><a href="#local-6989586621683032669"><span class="hs-identifier hs-var">unsafe_overlapped</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2261"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (NonEmpty InstMatch)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (NonEmpty InstMatch)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- No matches but perhaps several unifiers</span><span>
</span><span id="line-2262"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032670"><span class="annot"><a href="#local-6989586621683032670"><span class="hs-identifier hs-var">rel_binds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032671"><span class="annot"><a href="#local-6989586621683032671"><span class="hs-identifier hs-var">item</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; SolverReportErrCtxt
-&gt; ErrorItem
-&gt; TcM (SolverReportErrCtxt, RelevantBindings, ErrorItem)
</span><a href="GHC.Tc.Errors.html#relevantBindings"><span class="hs-identifier hs-var">relevantBindings</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032665"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032666"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-2263"></span><span>    </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683032672"><span class="annot"><a href="#local-6989586621683032672"><span class="hs-identifier hs-var">candidate_insts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683032673"><span class="hs-identifier hs-type">get_candidate_instances</span></a></span><span>
</span><span id="line-2264"></span><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032674"><span class="annot"><a href="#local-6989586621683032674"><span class="hs-identifier hs-var">imp_errs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032675"><span class="annot"><a href="#local-6989586621683032675"><span class="hs-identifier hs-var">field_suggestions</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683032676"><span class="hs-identifier hs-type">record_field_suggestions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032671"><span class="hs-identifier hs-type">item</span></a></span><span>
</span><span id="line-2265"></span><span>    </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683032677"><span class="hs-identifier hs-type">cannot_resolve_msg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032671"><span class="hs-identifier hs-type">item</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032672"><span class="hs-identifier hs-type">candidate_insts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032670"><span class="hs-identifier hs-type">rel_binds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032674"><span class="hs-identifier hs-type">imp_errs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032675"><span class="hs-identifier hs-type">field_suggestions</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2266"></span><span>
</span><span id="line-2267"></span><span>  </span><span class="hs-comment">-- Some matches =&gt; overlap errors</span><span>
</span><span id="line-2268"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032678"><span class="annot"><span class="annottext">NonEmpty InstMatch
</span><a href="#local-6989586621683032678"><span class="hs-identifier hs-var">matchesNE</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (NonEmpty InstMatch)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcSolverReportMsg -&gt; TcM TcSolverReportMsg
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TcSolverReportMsg -&gt; TcM TcSolverReportMsg)
-&gt; TcSolverReportMsg -&gt; TcM TcSolverReportMsg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2269"></span><span>    </span><span class="annot"><span class="annottext">ErrorItem -&gt; NonEmpty ClsInst -&gt; [ClsInst] -&gt; TcSolverReportMsg
</span><a href="GHC.Tc.Errors.Types.html#OverlappingInstances"><span class="hs-identifier hs-var">OverlappingInstances</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032666"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(InstMatch -&gt; ClsInst) -&gt; NonEmpty InstMatch -&gt; NonEmpty ClsInst
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#map"><span class="hs-identifier hs-var">NE.map</span></a></span><span> </span><span class="annot"><span class="annottext">InstMatch -&gt; ClsInst
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty InstMatch
</span><a href="#local-6989586621683032678"><span class="hs-identifier hs-var">matchesNE</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PotentialUnifiers -&gt; [ClsInst]
</span><a href="GHC.Core.InstEnv.html#getCoherentUnifiers"><span class="hs-identifier hs-var">getCoherentUnifiers</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialUnifiers
</span><a href="#local-6989586621683032668"><span class="hs-identifier hs-var">unifiers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2270"></span><span>
</span><span id="line-2271"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032682"><span class="annot"><span class="annottext">InstMatch
</span><a href="#local-6989586621683032682"><span class="hs-identifier hs-var">match</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032683"><span class="annot"><span class="annottext">NonEmpty InstMatch
</span><a href="#local-6989586621683032683"><span class="hs-identifier hs-var">unsafe_overlappedNE</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcSolverReportMsg -&gt; TcM TcSolverReportMsg
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TcSolverReportMsg -&gt; TcM TcSolverReportMsg)
-&gt; TcSolverReportMsg -&gt; TcM TcSolverReportMsg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2272"></span><span>    </span><span class="annot"><span class="annottext">ErrorItem -&gt; ClsInst -&gt; NonEmpty ClsInst -&gt; TcSolverReportMsg
</span><a href="GHC.Tc.Errors.Types.html#UnsafeOverlap"><span class="hs-identifier hs-var">UnsafeOverlap</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032666"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstMatch -&gt; ClsInst
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">InstMatch
</span><a href="#local-6989586621683032682"><span class="hs-identifier hs-var">match</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(InstMatch -&gt; ClsInst) -&gt; NonEmpty InstMatch -&gt; NonEmpty ClsInst
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#map"><span class="hs-identifier hs-var">NE.map</span></a></span><span> </span><span class="annot"><span class="annottext">InstMatch -&gt; ClsInst
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty InstMatch
</span><a href="#local-6989586621683032683"><span class="hs-identifier hs-var">unsafe_overlappedNE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2273"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032685"><span class="annot"><span class="annottext">matches :: NonEmpty InstMatch
</span><a href="#local-6989586621683032685"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstMatch
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><span class="annottext">[InstMatch]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032686"><span class="annot"><span class="annottext">NonEmpty InstMatch
</span><a href="#local-6989586621683032686"><span class="hs-identifier hs-var">overlaps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM TcSolverReportMsg
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mk_dict_err: multiple matches with overlap&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; TcM TcSolverReportMsg) -&gt; SDoc -&gt; TcM TcSolverReportMsg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;matches:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty InstMatch -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty InstMatch
</span><a href="#local-6989586621683032685"><span class="hs-identifier hs-var">matches</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;overlaps:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty InstMatch -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty InstMatch
</span><a href="#local-6989586621683032686"><span class="hs-identifier hs-var">overlaps</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2274"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2275"></span><span>    </span><span id="local-6989586621683032687"><span class="annot"><span class="annottext">orig :: CtOrigin
</span><a href="#local-6989586621683032687"><span class="hs-identifier hs-var hs-var">orig</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; CtOrigin
</span><a href="GHC.Tc.Errors.Types.html#errorItemOrigin"><span class="hs-identifier hs-var">errorItemOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032666"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-2276"></span><span>    </span><span id="local-6989586621683032688"><span class="annot"><span class="annottext">pred :: Type
</span><a href="#local-6989586621683032688"><span class="hs-identifier hs-var hs-var">pred</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Type
</span><a href="GHC.Tc.Errors.Types.html#errorItemPred"><span class="hs-identifier hs-var">errorItemPred</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032666"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-2277"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621683032689"><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621683032689"><span class="hs-identifier hs-var">clas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032690"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683032690"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; (Class, [Type])
Type -&gt; (Class, [Type])
</span><a href="GHC.Core.Predicate.html#getClassPredTys"><span class="hs-identifier hs-var">getClassPredTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032688"><span class="hs-identifier hs-var">pred</span></a></span><span>
</span><span id="line-2278"></span><span>
</span><span id="line-2279"></span><span>    </span><span class="annot"><a href="#local-6989586621683032673"><span class="hs-identifier hs-type">get_candidate_instances</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.InstEnv.html#ClsInst"><span class="hs-identifier hs-type">ClsInst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2280"></span><span>    </span><span class="hs-comment">-- See Note [Report candidate instances]</span><span>
</span><span id="line-2281"></span><span>    </span><span id="local-6989586621683032673"><span class="annot"><span class="annottext">get_candidate_instances :: TcM [ClsInst]
</span><a href="#local-6989586621683032673"><span class="hs-identifier hs-var hs-var">get_candidate_instances</span></a></span></span><span>
</span><span id="line-2282"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span id="local-6989586621683032691"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032691"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683032690"><span class="hs-identifier hs-var">tys</span></a></span><span>   </span><span class="hs-comment">-- Only try for single-parameter classes</span><span>
</span><span id="line-2283"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683032692"><span class="annot"><a href="#local-6989586621683032692"><span class="hs-identifier hs-var">instEnvs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcM InstEnvs
</span><a href="GHC.Tc.Utils.Env.html#tcGetInstEnvs"><span class="hs-identifier hs-var">tcGetInstEnvs</span></a></span><span>
</span><span id="line-2284"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683032693"><span class="hs-identifier hs-type">is_candidate_inst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032691"><span class="hs-identifier hs-type">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2285"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.InstEnv.html#classInstances"><span class="hs-identifier hs-type">classInstances</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032692"><span class="hs-identifier hs-type">instEnvs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032689"><span class="hs-identifier hs-type">clas</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2286"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ClsInst] -&gt; TcM [ClsInst]
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2287"></span><span>
</span><span id="line-2288"></span><span>    </span><span id="local-6989586621683032693"><span class="annot"><span class="annottext">is_candidate_inst :: Type -&gt; ClsInst -&gt; Bool
</span><a href="#local-6989586621683032693"><span class="hs-identifier hs-var hs-var">is_candidate_inst</span></a></span></span><span> </span><span id="local-6989586621683032699"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032699"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621683032700"><span class="annot"><span class="annottext">ClsInst
</span><a href="#local-6989586621683032700"><span class="hs-identifier hs-var">inst</span></a></span></span><span> </span><span class="hs-comment">-- See Note [Report candidate instances]</span><span>
</span><span id="line-2289"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span id="local-6989586621683032701"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032701"><span class="hs-identifier hs-var">other_ty</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ClsInst -&gt; [Type]
</span><a href="GHC.Core.InstEnv.html#is_tys"><span class="hs-identifier hs-var">is_tys</span></a></span><span> </span><span class="annot"><span class="annottext">ClsInst
</span><a href="#local-6989586621683032700"><span class="hs-identifier hs-var">inst</span></a></span><span>
</span><span id="line-2290"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032703"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032703"><span class="hs-identifier hs-var">tc1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032699"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2291"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032704"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032704"><span class="hs-identifier hs-var">tc2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032701"><span class="hs-identifier hs-var">other_ty</span></a></span><span>
</span><span id="line-2292"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032705"><span class="annot"><span class="annottext">n1 :: Name
</span><a href="#local-6989586621683032705"><span class="hs-identifier hs-var hs-var">n1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032703"><span class="hs-identifier hs-var">tc1</span></a></span><span>
</span><span id="line-2293"></span><span>            </span><span id="local-6989586621683032706"><span class="annot"><span class="annottext">n2 :: Name
</span><a href="#local-6989586621683032706"><span class="hs-identifier hs-var hs-var">n2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032704"><span class="hs-identifier hs-var">tc2</span></a></span><span>
</span><span id="line-2294"></span><span>            </span><span id="local-6989586621683032707"><span class="annot"><span class="annottext">different_names :: Bool
</span><a href="#local-6989586621683032707"><span class="hs-identifier hs-var hs-var">different_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032705"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032706"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-2295"></span><span>            </span><span id="local-6989586621683032708"><span class="annot"><span class="annottext">same_occ_names :: Bool
</span><a href="#local-6989586621683032708"><span class="hs-identifier hs-var hs-var">same_occ_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032705"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">OccName -&gt; OccName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032706"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-2296"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032707"><span class="hs-identifier hs-var">different_names</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032708"><span class="hs-identifier hs-var">same_occ_names</span></a></span><span>
</span><span id="line-2297"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2298"></span><span>
</span><span id="line-2299"></span><span>    </span><span class="hs-comment">-- See Note [Out-of-scope fields with -XOverloadedRecordDot]</span><span>
</span><span id="line-2300"></span><span>    </span><span class="annot"><a href="#local-6989586621683032676"><span class="hs-identifier hs-type">record_field_suggestions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ImportError"><span class="hs-identifier hs-type">ImportError</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Hint.html#GhcHint"><span class="hs-identifier hs-type">GhcHint</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2301"></span><span>    </span><span id="local-6989586621683032676"><span class="annot"><span class="annottext">record_field_suggestions :: ErrorItem -&gt; RnM ([ImportError], [GhcHint])
</span><a href="#local-6989586621683032676"><span class="hs-identifier hs-var hs-var">record_field_suggestions</span></a></span></span><span> </span><span id="local-6989586621683032709"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032709"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((OccName -&gt; RnM ([ImportError], [GhcHint]))
 -&gt; Maybe OccName -&gt; RnM ([ImportError], [GhcHint]))
-&gt; Maybe OccName
-&gt; (OccName -&gt; RnM ([ImportError], [GhcHint]))
-&gt; RnM ([ImportError], [GhcHint])
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RnM ([ImportError], [GhcHint])
-&gt; (OccName -&gt; RnM ([ImportError], [GhcHint]))
-&gt; Maybe OccName
-&gt; RnM ([ImportError], [GhcHint])
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">(RnM ([ImportError], [GhcHint])
 -&gt; (OccName -&gt; RnM ([ImportError], [GhcHint]))
 -&gt; Maybe OccName
 -&gt; RnM ([ImportError], [GhcHint]))
-&gt; RnM ([ImportError], [GhcHint])
-&gt; (OccName -&gt; RnM ([ImportError], [GhcHint]))
-&gt; Maybe OccName
-&gt; RnM ([ImportError], [GhcHint])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([ImportError], [GhcHint]) -&gt; RnM ([ImportError], [GhcHint])
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[GhcHint]
</span><a href="GHC.Types.Error.html#noHints"><span class="hs-identifier hs-var">noHints</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe OccName
</span><a href="#local-6989586621683032713"><span class="hs-identifier hs-var">record_field</span></a></span><span> </span><span class="annot"><span class="annottext">((OccName -&gt; RnM ([ImportError], [GhcHint]))
 -&gt; RnM ([ImportError], [GhcHint]))
-&gt; (OccName -&gt; RnM ([ImportError], [GhcHint]))
-&gt; RnM ([ImportError], [GhcHint])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621683032714"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621683032714"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2302"></span><span>       </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683032715"><span class="annot"><a href="#local-6989586621683032715"><span class="hs-identifier hs-var">glb_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRn GlobalRdrEnv
</span><a href="GHC.Tc.Utils.Monad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a></span><span>
</span><span id="line-2303"></span><span>          </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683032716"><span class="annot"><a href="#local-6989586621683032716"><span class="hs-identifier hs-var">lcl_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#getLocalRdrEnv"><span class="hs-identifier hs-type">getLocalRdrEnv</span></a></span><span>
</span><span id="line-2304"></span><span>          </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032718"><span class="annot"><a href="#local-6989586621683032718"><span class="hs-identifier hs-var hs-var">field_name_hints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; [GhcHint]
</span><a href="#local-6989586621683032719"><span class="hs-identifier hs-var">report_no_fieldnames</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032709"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-2305"></span><span>          </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032720"><span class="annot"><a href="#local-6989586621683032720"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032721"><span class="annot"><a href="#local-6989586621683032721"><span class="hs-identifier hs-var">hints</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621683032722"><span class="hs-identifier hs-type">occ_name_in_scope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032715"><span class="hs-identifier hs-type">glb_env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032716"><span class="hs-identifier hs-type">lcl_env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032714"><span class="hs-identifier hs-type">name</span></a></span><span>
</span><span id="line-2306"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#noHints"><span class="hs-identifier hs-type">noHints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2307"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.Rename.Unbound.html#unknownNameSuggestions"><span class="hs-identifier hs-type">unknownNameSuggestions</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#emptyLocalRdrEnv"><span class="hs-identifier hs-type">emptyLocalRdrEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Rename.Unbound.html#WL_RecField"><span class="hs-identifier hs-type">WL_RecField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Reader.html#mkRdrUnqual"><span class="hs-identifier hs-type">mkRdrUnqual</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032714"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2308"></span><span>          </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683032720"><span class="hs-identifier hs-type">errs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683032721"><span class="hs-identifier hs-type">hints</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621683032718"><span class="hs-identifier hs-type">field_name_hints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2309"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-2310"></span><span>
</span><span id="line-2311"></span><span>    </span><span class="hs-comment">-- get type names from instance</span><span>
</span><span id="line-2312"></span><span>    </span><span class="hs-comment">-- resolve the type - if it's in scope is it a record?</span><span>
</span><span id="line-2313"></span><span>    </span><span class="hs-comment">-- if it's a record, report an error - the record name + the field that could not be found</span><span>
</span><span id="line-2314"></span><span>    </span><span class="annot"><a href="#local-6989586621683032719"><span class="hs-identifier hs-type">report_no_fieldnames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Hint.html#GhcHint"><span class="hs-identifier hs-type">GhcHint</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2315"></span><span>    </span><span id="local-6989586621683032719"><span class="annot"><span class="annottext">report_no_fieldnames :: ErrorItem -&gt; [GhcHint]
</span><a href="#local-6989586621683032719"><span class="hs-identifier hs-var hs-var">report_no_fieldnames</span></a></span></span><span> </span><span id="local-6989586621683032726"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032726"><span class="hs-identifier hs-var">item</span></a></span></span><span>
</span><span id="line-2316"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#EvVarDest"><span class="hs-identifier hs-type">EvVarDest</span></a></span><span> </span><span id="local-6989586621683032727"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032727"><span class="hs-identifier hs-var">evvar</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; Maybe TcEvDest
</span><a href="GHC.Tc.Errors.Types.html#ei_evdest"><span class="hs-identifier hs-var">ei_evdest</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032726"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-2317"></span><span>       </span><span class="hs-comment">-- we can assume that here we have a `HasField @Symbol x r a` instance</span><span>
</span><span id="line-2318"></span><span>       </span><span class="hs-comment">-- because of HasFieldOrigin in record_field</span><span>
</span><span id="line-2319"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621683032728"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032728"><span class="hs-identifier hs-var">_symbol</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032729"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032729"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032730"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032730"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032731"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032731"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032727"><span class="hs-identifier hs-var">evvar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2320"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032732"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032732"><span class="hs-identifier hs-var">r_tycon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032730"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2321"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032733"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683032733"><span class="hs-identifier hs-var">x_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe FastString
</span><a href="GHC.Core.Type.html#isStrLitTy"><span class="hs-identifier hs-var">isStrLitTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032729"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2322"></span><span>       </span><span class="hs-comment">-- we check that this is a record type by checking whether it has any</span><span>
</span><span id="line-2323"></span><span>       </span><span class="hs-comment">-- fields (in scope)</span><span>
</span><span id="line-2324"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; ([FieldLabel] -&gt; Bool) -&gt; [FieldLabel] -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[FieldLabel] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">([FieldLabel] -&gt; Bool) -&gt; [FieldLabel] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [FieldLabel]
</span><a href="GHC.Core.TyCon.html#tyConFieldLabels"><span class="hs-identifier hs-var">tyConFieldLabels</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683032732"><span class="hs-identifier hs-var">r_tycon</span></a></span><span>
</span><span id="line-2325"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FastString -&gt; Type -&gt; Type -&gt; GhcHint
</span><a href="GHC.Types.Hint.html#RemindRecordMissingField"><span class="hs-identifier hs-var">RemindRecordMissingField</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683032733"><span class="hs-identifier hs-var">x_name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032730"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032731"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2326"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2327"></span><span>
</span><span id="line-2328"></span><span>    </span><span id="local-6989586621683032722"><span class="annot"><span class="annottext">occ_name_in_scope :: GlobalRdrEnv -&gt; LocalRdrEnv -&gt; OccName -&gt; Bool
</span><a href="#local-6989586621683032722"><span class="hs-identifier hs-var hs-var">occ_name_in_scope</span></a></span></span><span> </span><span id="local-6989586621683032738"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683032738"><span class="hs-identifier hs-var">glb_env</span></a></span></span><span> </span><span id="local-6989586621683032739"><span class="annot"><span class="annottext">LocalRdrEnv
</span><a href="#local-6989586621683032739"><span class="hs-identifier hs-var">lcl_env</span></a></span></span><span> </span><span id="local-6989586621683032740"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621683032740"><span class="hs-identifier hs-var">occ_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2329"></span><span>      </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; LookupGRE GREInfo -&gt; [GlobalRdrEltX GREInfo]
forall info.
GlobalRdrEnvX info -&gt; LookupGRE info -&gt; [GlobalRdrEltX info]
</span><a href="GHC.Types.Name.Reader.html#lookupGRE"><span class="hs-identifier hs-var">lookupGRE</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683032738"><span class="hs-identifier hs-var">glb_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OccName -&gt; WhichGREs GREInfo -&gt; LookupGRE GREInfo
forall info. OccName -&gt; WhichGREs info -&gt; LookupGRE info
</span><a href="GHC.Types.Name.Reader.html#LookupOccName"><span class="hs-identifier hs-var">LookupOccName</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621683032740"><span class="hs-identifier hs-var">occ_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldsOrSelectors -&gt; WhichGREs GREInfo
</span><a href="GHC.Types.Name.Reader.html#RelevantGREsFOS"><span class="hs-identifier hs-var">RelevantGREsFOS</span></a></span><span> </span><span class="annot"><span class="annottext">FieldsOrSelectors
</span><a href="GHC.Types.Name.Reader.html#WantNormal"><span class="hs-identifier hs-var">WantNormal</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-2330"></span><span>      </span><span class="annot"><span class="annottext">Maybe Name -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalRdrEnv -&gt; OccName -&gt; Maybe Name
</span><a href="GHC.Types.Name.Reader.html#lookupLocalRdrOcc"><span class="hs-identifier hs-var">lookupLocalRdrOcc</span></a></span><span> </span><span class="annot"><span class="annottext">LocalRdrEnv
</span><a href="#local-6989586621683032739"><span class="hs-identifier hs-var">lcl_env</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621683032740"><span class="hs-identifier hs-var">occ_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2331"></span><span>
</span><span id="line-2332"></span><span>    </span><span id="local-6989586621683032713"><span class="annot"><span class="annottext">record_field :: Maybe OccName
</span><a href="#local-6989586621683032713"><span class="hs-identifier hs-var hs-var">record_field</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CtOrigin
</span><a href="#local-6989586621683032687"><span class="hs-identifier hs-var">orig</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2333"></span><span>      </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#HasFieldOrigin"><span class="hs-identifier hs-type">HasFieldOrigin</span></a></span><span> </span><span id="local-6989586621683032747"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683032747"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; Maybe OccName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#mkVarOccFS"><span class="hs-identifier hs-var">mkVarOccFS</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683032747"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2334"></span><span>      </span><span class="annot"><span class="annottext">CtOrigin
</span><span class="hs-identifier">_</span></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe OccName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2335"></span><span>
</span><span id="line-2336"></span><span>    </span><span class="annot"><a href="#local-6989586621683032677"><span class="hs-identifier hs-type">cannot_resolve_msg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.InstEnv.html#ClsInst"><span class="hs-identifier hs-type">ClsInst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#RelevantBindings"><span class="hs-identifier hs-type">RelevantBindings</span></a></span><span>
</span><span id="line-2337"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ImportError"><span class="hs-identifier hs-type">ImportError</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Hint.html#GhcHint"><span class="hs-identifier hs-type">GhcHint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcSolverReportMsg"><span class="hs-identifier hs-type">TcSolverReportMsg</span></a></span><span>
</span><span id="line-2338"></span><span>    </span><span id="local-6989586621683032677"><span class="annot"><span class="annottext">cannot_resolve_msg :: ErrorItem
-&gt; [ClsInst]
-&gt; RelevantBindings
-&gt; [ImportError]
-&gt; [GhcHint]
-&gt; TcSolverReportMsg
</span><a href="#local-6989586621683032677"><span class="hs-identifier hs-var hs-var">cannot_resolve_msg</span></a></span></span><span> </span><span id="local-6989586621683032749"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032749"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span id="local-6989586621683032750"><span class="annot"><span class="annottext">[ClsInst]
</span><a href="#local-6989586621683032750"><span class="hs-identifier hs-var">candidate_insts</span></a></span></span><span> </span><span id="local-6989586621683032751"><span class="annot"><span class="annottext">RelevantBindings
</span><a href="#local-6989586621683032751"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span id="local-6989586621683032752"><span class="annot"><span class="annottext">[ImportError]
</span><a href="#local-6989586621683032752"><span class="hs-identifier hs-var">imp_errs</span></a></span></span><span> </span><span id="local-6989586621683032753"><span class="annot"><span class="annottext">[GhcHint]
</span><a href="#local-6989586621683032753"><span class="hs-identifier hs-var">field_suggestions</span></a></span></span><span>
</span><span id="line-2339"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem
-&gt; [ClsInst]
-&gt; [ClsInst]
-&gt; [ImportError]
-&gt; [GhcHint]
-&gt; RelevantBindings
-&gt; TcSolverReportMsg
</span><a href="GHC.Tc.Errors.Types.html#CannotResolveInstance"><span class="hs-identifier hs-var">CannotResolveInstance</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032749"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PotentialUnifiers -&gt; [ClsInst]
</span><a href="GHC.Core.InstEnv.html#getCoherentUnifiers"><span class="hs-identifier hs-var">getCoherentUnifiers</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialUnifiers
</span><a href="#local-6989586621683032668"><span class="hs-identifier hs-var">unifiers</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ClsInst]
</span><a href="#local-6989586621683032750"><span class="hs-identifier hs-var">candidate_insts</span></a></span><span> </span><span class="annot"><span class="annottext">[ImportError]
</span><a href="#local-6989586621683032752"><span class="hs-identifier hs-var">imp_errs</span></a></span><span> </span><span class="annot"><span class="annottext">[GhcHint]
</span><a href="#local-6989586621683032753"><span class="hs-identifier hs-var">field_suggestions</span></a></span><span> </span><span class="annot"><span class="annottext">RelevantBindings
</span><a href="#local-6989586621683032751"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-2340"></span><span>
</span><span id="line-2341"></span><span class="hs-comment">{- Note [Report candidate instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
If we have an unsolved (Num Int), where `Int` is not the Prelude Int,
but comes from some other module, then it may be helpful to point out
that there are some similarly named instances elsewhere.  So we get
something like
    No instance for (Num Int) arising from the literal &#8216;3&#8217;
    There are instances for similar types:
      instance Num GHC.Types.Int -- Defined in &#8216;GHC.Num&#8217;
Discussion in #9611.

Note [Highlighting ambiguous type variables]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When we encounter ambiguous type variables (i.e. type variables
that remain metavariables after type inference), we need a few more
conditions before we can reason that *ambiguity* prevents constraints
from being solved:
  - We can't have any givens, as encountering a typeclass error
    with given constraints just means we couldn't deduce
    a solution satisfying those constraints and as such couldn't
    bind the type variable to a known type.
  - If we don't have any unifiers, we don't even have potential
    instances from which an ambiguity could arise.
  - Lastly, I don't want to mess with error reporting for
    unknown runtime types so we just fall back to the old message there.
Once these conditions are satisfied, we can safely say that ambiguity prevents
the constraint from being solved.

Note [Out-of-scope fields with -XOverloadedRecordDot]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
With -XOverloadedRecordDot, when a field isn't in scope, the error that appears
is produces here, and it says
    No instance for (GHC.Record.HasField &quot;&lt;fieldname&gt;&quot; ...).

Additionally, though, we want to suggest similar field names that are in scope
or could be in scope with different import lists.

However, we can still get an error about a missing HasField instance when a
field is in scope (if the types are wrong), and so it's important that we don't
suggest similar names here if the record field is in scope, either qualified or
unqualified, since qualification doesn't matter for -XOverloadedRecordDot.

Example:

    import Data.Monoid (Alt(..))

    foo = undefined.getAll

results in

     No instance for (GHC.Records.HasField &quot;getAll&quot; r0 a0)
        arising from selecting the field &#8216;getAll&#8217;
      Perhaps you meant &#8216;getAlt&#8217; (imported from Data.Monoid)
      Perhaps you want to add &#8216;getAll&#8217; to the import list
      in the import of &#8216;Data.Monoid&#8217;
-}</span><span>
</span><span id="line-2397"></span><span>
</span><span id="line-2398"></span><span class="hs-comment">-----------------------</span><span>
</span><span id="line-2399"></span><span class="hs-comment">-- relevantBindings looks at the value environment and finds values whose</span><span>
</span><span id="line-2400"></span><span class="hs-comment">-- types mention any of the offending type variables.  It has to be</span><span>
</span><span id="line-2401"></span><span class="hs-comment">-- careful to zonk the Id's type first, so it has to be in the monad.</span><span>
</span><span id="line-2402"></span><span class="hs-comment">-- We must be careful to pass it a zonked type variable, too.</span><span>
</span><span id="line-2403"></span><span class="hs-comment">--</span><span>
</span><span id="line-2404"></span><span class="hs-comment">-- We always remove closed top-level bindings, though,</span><span>
</span><span id="line-2405"></span><span class="hs-comment">-- since they are never relevant (cf #8233)</span><span>
</span><span id="line-2406"></span><span>
</span><span id="line-2407"></span><span class="annot"><a href="GHC.Tc.Errors.html#relevantBindings"><span class="hs-identifier hs-type">relevantBindings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>  </span><span class="hs-comment">-- True &lt;=&gt; filter by tyvar; False &lt;=&gt; no filtering</span><span>
</span><span id="line-2408"></span><span>                          </span><span class="hs-comment">-- See #8191</span><span>
</span><span id="line-2409"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span>
</span><span id="line-2410"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#SolverReportErrCtxt"><span class="hs-identifier hs-type">SolverReportErrCtxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#RelevantBindings"><span class="hs-identifier hs-type">RelevantBindings</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrorItem"><span class="hs-identifier hs-type">ErrorItem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2411"></span><span class="hs-comment">-- Also returns the zonked and tidied CtOrigin of the constraint</span><span>
</span><span id="line-2412"></span><span id="relevantBindings"><span class="annot"><span class="annottext">relevantBindings :: Bool
-&gt; SolverReportErrCtxt
-&gt; ErrorItem
-&gt; TcM (SolverReportErrCtxt, RelevantBindings, ErrorItem)
</span><a href="GHC.Tc.Errors.html#relevantBindings"><span class="hs-identifier hs-var hs-var">relevantBindings</span></a></span></span><span> </span><span id="local-6989586621683032755"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032755"><span class="hs-identifier hs-var">want_filtering</span></a></span></span><span> </span><span id="local-6989586621683032756"><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032756"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683032757"><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032757"><span class="hs-identifier hs-var">item</span></a></span></span><span>
</span><span id="line-2413"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;relevantBindings&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032757"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2414"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032758"><span class="annot"><a href="#local-6989586621683032758"><span class="hs-identifier hs-var">env1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032759"><span class="annot"><a href="#local-6989586621683032759"><span class="hs-identifier hs-var">tidy_orig</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ZonkM (TidyEnv, CtOrigin) -&gt; TcM (TidyEnv, CtOrigin)
forall a. ZonkM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#liftZonkM"><span class="hs-identifier hs-var">liftZonkM</span></a></span><span> </span><span class="annot"><span class="annottext">(ZonkM (TidyEnv, CtOrigin) -&gt; TcM (TidyEnv, CtOrigin))
-&gt; ZonkM (TidyEnv, CtOrigin) -&gt; TcM (TidyEnv, CtOrigin)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; CtOrigin -&gt; ZonkM (TidyEnv, CtOrigin)
</span><a href="GHC.Tc.Zonk.TcType.html#zonkTidyOrigin"><span class="hs-identifier hs-var">zonkTidyOrigin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SolverReportErrCtxt -&gt; TidyEnv
</span><a href="GHC.Tc.Errors.Types.html#cec_tidy"><span class="hs-identifier hs-var">cec_tidy</span></a></span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032756"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CtLoc -&gt; CtOrigin
</span><a href="GHC.Tc.Types.CtLoc.html#ctLocOrigin"><span class="hs-identifier hs-var">ctLocOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">CtLoc
</span><a href="#local-6989586621683032762"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2415"></span><span>
</span><span id="line-2416"></span><span>             </span><span class="hs-comment">-- For *kind* errors, report the relevant bindings of the</span><span>
</span><span id="line-2417"></span><span>             </span><span class="hs-comment">-- enclosing *type* equality, because that's more useful for the programmer</span><span>
</span><span id="line-2418"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032763"><span class="annot"><a href="#local-6989586621683032763"><span class="hs-identifier hs-var hs-var">extra_tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CtOrigin
</span><a href="#local-6989586621683032759"><span class="hs-identifier hs-var">tidy_orig</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2419"></span><span>                             </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#KindEqOrigin"><span class="hs-identifier hs-type">KindEqOrigin</span></a></span><span> </span><span id="local-6989586621683032764"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032764"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621683032765"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032765"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="annot"><span class="annottext">CtOrigin
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe TypeOrKind
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032764"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032765"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2420"></span><span>                             </span><span class="annot"><span class="annottext">CtOrigin
</span><span class="hs-identifier">_</span></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-2421"></span><span>             </span><span id="local-6989586621683032768"><span class="annot"><a href="#local-6989586621683032768"><span class="hs-identifier hs-var hs-var">ct_fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorItem -&gt; Type
</span><a href="GHC.Tc.Errors.Types.html#errorItemPred"><span class="hs-identifier hs-var">errorItemPred</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032757"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; TyCoVarSet -&gt; TyCoVarSet
</span><a href="GHC.Types.Var.Set.html#unionVarSet"><span class="hs-operator hs-var">`unionVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621683032763"><span class="hs-identifier hs-var">extra_tvs</span></a></span><span>
</span><span id="line-2422"></span><span>
</span><span id="line-2423"></span><span>             </span><span class="hs-comment">-- Put a zonked, tidied CtOrigin into the ErrorItem</span><span>
</span><span id="line-2424"></span><span>             </span><span id="local-6989586621683032770"><span class="annot"><a href="#local-6989586621683032770"><span class="hs-identifier hs-var hs-var">loc'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CtLoc -&gt; CtOrigin -&gt; CtLoc
</span><a href="GHC.Tc.Types.CtLoc.html#setCtLocOrigin"><span class="hs-identifier hs-var">setCtLocOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">CtLoc
</span><a href="#local-6989586621683032762"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">CtOrigin
</span><a href="#local-6989586621683032759"><span class="hs-identifier hs-var">tidy_orig</span></a></span><span>
</span><span id="line-2425"></span><span>             </span><span id="local-6989586621683032772"><span class="annot"><a href="#local-6989586621683032772"><span class="hs-identifier hs-var hs-var">item'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032757"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ei_loc"><span class="hs-identifier hs-var">ei_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683032770"><span class="hs-identifier hs-type">loc'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2426"></span><span>
</span><span id="line-2427"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032773"><span class="annot"><a href="#local-6989586621683032773"><span class="hs-identifier hs-var">env2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683032774"><span class="annot"><a href="#local-6989586621683032774"><span class="hs-identifier hs-var">lcl_name_cache</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#liftZonkM"><span class="hs-identifier hs-type">liftZonkM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#zonkTidyTcLclEnvs"><span class="hs-identifier hs-type">zonkTidyTcLclEnvs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032758"><span class="hs-identifier hs-type">env1</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683032775"><span class="hs-identifier hs-type">lcl_env</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2428"></span><span>
</span><span id="line-2429"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683032776"><span class="annot"><a href="#local-6989586621683032776"><span class="hs-identifier hs-var">relev_bds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.html#relevant_bindings"><span class="hs-identifier hs-type">relevant_bindings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032755"><span class="hs-identifier hs-type">want_filtering</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032775"><span class="hs-identifier hs-type">lcl_env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032774"><span class="hs-identifier hs-type">lcl_name_cache</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032768"><span class="hs-identifier hs-type">ct_fvs</span></a></span><span>
</span><span id="line-2430"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032777"><span class="annot"><a href="#local-6989586621683032777"><span class="hs-identifier hs-var hs-var">ctxt'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SolverReportErrCtxt
</span><a href="#local-6989586621683032756"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#cec_tidy"><span class="hs-identifier hs-var">cec_tidy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683032773"><span class="hs-identifier hs-type">env2</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2431"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683032777"><span class="hs-identifier hs-type">ctxt'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683032776"><span class="hs-identifier hs-type">relev_bds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683032772"><span class="hs-identifier hs-type">item'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2432"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2433"></span><span>    </span><span id="local-6989586621683032762"><span class="annot"><span class="annottext">loc :: CtLoc
</span><a href="#local-6989586621683032762"><span class="hs-identifier hs-var hs-var">loc</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorItem -&gt; CtLoc
</span><a href="GHC.Tc.Errors.Types.html#errorItemCtLoc"><span class="hs-identifier hs-var">errorItemCtLoc</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorItem
</span><a href="#local-6989586621683032757"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-2434"></span><span>    </span><span id="local-6989586621683032775"><span class="annot"><span class="annottext">lcl_env :: CtLocEnv
</span><a href="#local-6989586621683032775"><span class="hs-identifier hs-var hs-var">lcl_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CtLoc -&gt; CtLocEnv
</span><a href="GHC.Tc.Types.CtLoc.html#ctLocEnv"><span class="hs-identifier hs-var">ctLocEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CtLoc
</span><a href="#local-6989586621683032762"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-2435"></span><span>
</span><span id="line-2436"></span><span class="hs-comment">-- slightly more general version, to work also with holes</span><span>
</span><span id="line-2437"></span><span class="annot"><a href="GHC.Tc.Errors.html#relevant_bindings"><span class="hs-identifier hs-type">relevant_bindings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2438"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.CtLoc.html#CtLocEnv"><span class="hs-identifier hs-type">CtLocEnv</span></a></span><span>
</span><span id="line-2439"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-comment">-- Cache of already zonked and tidied types</span><span>
</span><span id="line-2440"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-2441"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#RelevantBindings"><span class="hs-identifier hs-type">RelevantBindings</span></a></span><span>
</span><span id="line-2442"></span><span id="relevant_bindings"><span class="annot"><span class="annottext">relevant_bindings :: Bool
-&gt; CtLocEnv -&gt; NameEnv Type -&gt; TyCoVarSet -&gt; TcM RelevantBindings
</span><a href="GHC.Tc.Errors.html#relevant_bindings"><span class="hs-identifier hs-var hs-var">relevant_bindings</span></a></span></span><span> </span><span id="local-6989586621683032778"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032778"><span class="hs-identifier hs-var">want_filtering</span></a></span></span><span> </span><span id="local-6989586621683032779"><span class="annot"><span class="annottext">CtLocEnv
</span><a href="#local-6989586621683032779"><span class="hs-identifier hs-var">lcl_env</span></a></span></span><span> </span><span id="local-6989586621683032780"><span class="annot"><span class="annottext">NameEnv Type
</span><a href="#local-6989586621683032780"><span class="hs-identifier hs-var">lcl_name_env</span></a></span></span><span> </span><span id="local-6989586621683032781"><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621683032781"><span class="hs-identifier hs-var">ct_tvs</span></a></span></span><span>
</span><span id="line-2443"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683032782"><span class="annot"><a href="#local-6989586621683032782"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-2444"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-type">traceTc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;relevant_bindings&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2445"></span><span>           </span><span class="annot"><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032781"><span class="hs-identifier hs-type">ct_tvs</span></a></span><span>
</span><span id="line-2446"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#pprWithCommas"><span class="hs-identifier hs-type">pprWithCommas</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">id</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032785"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-type">dcolon</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-type">idType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032785"><span class="hs-identifier hs-type">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2447"></span><span>                                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Tc.Types.BasicTypes.html#TcIdBndr"><span class="hs-identifier hs-type">TcIdBndr</span></a></span><span> </span><span id="local-6989586621683032785"><span class="annot"><a href="#local-6989586621683032785"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Types.CtLoc.html#ctl_bndrs"><span class="hs-identifier hs-var">ctl_bndrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032779"><span class="hs-identifier hs-type">lcl_env</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2448"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#pprWithCommas"><span class="hs-identifier hs-type">pprWithCommas</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">id</span></span><span>
</span><span id="line-2449"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032787"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Tc.Types.BasicTypes.html#TcIdBndr_ExpType"><span class="hs-identifier hs-type">TcIdBndr_ExpType</span></a></span><span> </span><span id="local-6989586621683032787"><span class="annot"><a href="#local-6989586621683032787"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Types.CtLoc.html#ctl_bndrs"><span class="hs-identifier hs-var">ctl_bndrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032779"><span class="hs-identifier hs-type">lcl_env</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2450"></span><span>
</span><span id="line-2451"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="#local-6989586621683032788"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032782"><span class="hs-identifier hs-type">dflags</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.DynFlags.html#maxRelevantBinds"><span class="hs-identifier hs-var">maxRelevantBinds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032782"><span class="hs-identifier hs-type">dflags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2452"></span><span>                    </span><span class="annot"><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-type">emptyVarSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#RelevantBindings"><span class="hs-identifier hs-type">RelevantBindings</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-2453"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#removeBindingShadowing"><span class="hs-identifier hs-type">removeBindingShadowing</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Types.CtLoc.html#ctl_bndrs"><span class="hs-identifier hs-var">ctl_bndrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032779"><span class="hs-identifier hs-type">lcl_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2454"></span><span>         </span><span class="hs-comment">-- tcl_bndrs has the innermost bindings first,</span><span>
</span><span id="line-2455"></span><span>         </span><span class="hs-comment">-- which are probably the most relevant ones</span><span>
</span><span id="line-2456"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-2457"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2458"></span><span>    </span><span class="annot"><a href="#local-6989586621683032792"><span class="hs-identifier hs-type">run_out</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2459"></span><span>    </span><span id="local-6989586621683032792"><span class="annot"><span class="annottext">run_out :: Maybe Int -&gt; Bool
</span><a href="#local-6989586621683032792"><span class="hs-identifier hs-var hs-var">run_out</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2460"></span><span>    </span><span class="annot"><a href="#local-6989586621683032792"><span class="hs-identifier hs-var">run_out</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032793"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621683032793"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621683032793"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2461"></span><span>
</span><span id="line-2462"></span><span>    </span><span class="annot"><a href="#local-6989586621683032795"><span class="hs-identifier hs-type">dec_max</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-2463"></span><span>    </span><span id="local-6989586621683032795"><span class="annot"><span class="annottext">dec_max :: Maybe Int -&gt; Maybe Int
</span><a href="#local-6989586621683032795"><span class="hs-identifier hs-var hs-var">dec_max</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Maybe Int -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621683032796"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621683032796"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621683032796"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-2464"></span><span>
</span><span id="line-2465"></span><span>
</span><span id="line-2466"></span><span>    </span><span class="annot"><a href="#local-6989586621683032788"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyVarSet"><span class="hs-identifier hs-type">TcTyVarSet</span></a></span><span>
</span><span id="line-2467"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#RelevantBindings"><span class="hs-identifier hs-type">RelevantBindings</span></a></span><span>
</span><span id="line-2468"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Types.BasicTypes.html#TcBinder"><span class="hs-identifier hs-type">TcBinder</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2469"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#RelevantBindings"><span class="hs-identifier hs-type">RelevantBindings</span></a></span><span>
</span><span id="line-2470"></span><span>    </span><span id="local-6989586621683032788"><span class="annot"><span class="annottext">go :: DynFlags
-&gt; Maybe Int
-&gt; TyCoVarSet
-&gt; RelevantBindings
-&gt; [TcBinder]
-&gt; TcM RelevantBindings
</span><a href="#local-6989586621683032788"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#RelevantBindings"><span class="hs-identifier hs-type">RelevantBindings</span></a></span><span> </span><span id="local-6989586621683032798"><span class="annot"><span class="annottext">[(Name, Type)]
</span><a href="#local-6989586621683032798"><span class="hs-identifier hs-var">bds</span></a></span></span><span> </span><span id="local-6989586621683032799"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032799"><span class="hs-identifier hs-var">discards</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2471"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RelevantBindings -&gt; TcM RelevantBindings
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(RelevantBindings -&gt; TcM RelevantBindings)
-&gt; RelevantBindings -&gt; TcM RelevantBindings
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Name, Type)] -&gt; Bool -&gt; RelevantBindings
</span><a href="GHC.Tc.Errors.Types.html#RelevantBindings"><span class="hs-identifier hs-var">RelevantBindings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Name, Type)] -&gt; [(Name, Type)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[(Name, Type)]
</span><a href="#local-6989586621683032798"><span class="hs-identifier hs-var">bds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032799"><span class="hs-identifier hs-var">discards</span></a></span><span>
</span><span id="line-2472"></span><span>    </span><span class="annot"><a href="#local-6989586621683032788"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621683032801"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683032801"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621683032802"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621683032802"><span class="hs-identifier hs-var">n_left</span></a></span></span><span> </span><span id="local-6989586621683032803"><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621683032803"><span class="hs-identifier hs-var">tvs_seen</span></a></span></span><span> </span><span id="local-6989586621683032804"><span class="annot"><span class="annottext">rels :: RelevantBindings
</span><a href="#local-6989586621683032804"><span class="hs-identifier hs-var">rels</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#RelevantBindings"><span class="hs-identifier hs-type">RelevantBindings</span></a></span><span> </span><span id="local-6989586621683032805"><span class="annot"><span class="annottext">[(Name, Type)]
</span><a href="#local-6989586621683032805"><span class="hs-identifier hs-var">bds</span></a></span></span><span> </span><span id="local-6989586621683032806"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032806"><span class="hs-identifier hs-var">discards</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683032807"><span class="annot"><span class="annottext">TcBinder
</span><a href="#local-6989586621683032807"><span class="hs-identifier hs-var">tc_bndr</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621683032808"><span class="annot"><span class="annottext">[TcBinder]
</span><a href="#local-6989586621683032808"><span class="hs-identifier hs-var">tc_bndrs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2473"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TcBinder
</span><a href="#local-6989586621683032807"><span class="hs-identifier hs-var">tc_bndr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2474"></span><span>          </span><span class="annot"><a href="GHC.Tc.Types.BasicTypes.html#TcTvBndr"><span class="hs-identifier hs-type">TcTvBndr</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcM RelevantBindings
</span><a href="#local-6989586621683032809"><span class="hs-identifier hs-var">discard_it</span></a></span><span>
</span><span id="line-2475"></span><span>          </span><span class="annot"><a href="GHC.Tc.Types.BasicTypes.html#TcIdBndr"><span class="hs-identifier hs-type">TcIdBndr</span></a></span><span> </span><span id="local-6989586621683032810"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032810"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span id="local-6989586621683032811"><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621683032811"><span class="hs-identifier hs-var">top_lvl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TopLevelFlag -&gt; TcM RelevantBindings
</span><a href="#local-6989586621683032812"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032810"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621683032811"><span class="hs-identifier hs-var">top_lvl</span></a></span><span>
</span><span id="line-2476"></span><span>          </span><span class="annot"><a href="GHC.Tc.Types.BasicTypes.html#TcIdBndr_ExpType"><span class="hs-identifier hs-type">TcIdBndr_ExpType</span></a></span><span> </span><span id="local-6989586621683032813"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032813"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621683032814"><span class="annot"><span class="annottext">ExpType
</span><a href="#local-6989586621683032814"><span class="hs-identifier hs-var">et</span></a></span></span><span> </span><span id="local-6989586621683032815"><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621683032815"><span class="hs-identifier hs-var">top_lvl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2477"></span><span>            </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683032816"><span class="annot"><a href="#local-6989586621683032816"><span class="hs-identifier hs-var">mb_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Type) -&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe Type)
forall a. IO a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Type) -&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe Type))
-&gt; IO (Maybe Type) -&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe Type)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExpType -&gt; IO (Maybe Type)
forall (m :: * -&gt; *). MonadIO m =&gt; ExpType -&gt; m (Maybe Type)
</span><a href="GHC.Tc.Utils.TcMType.html#readExpType_maybe"><span class="hs-identifier hs-var">readExpType_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">ExpType
</span><a href="#local-6989586621683032814"><span class="hs-identifier hs-var">et</span></a></span><span>
</span><span id="line-2478"></span><span>                   </span><span class="hs-comment">-- et really should be filled in by now. But there's a chance</span><span>
</span><span id="line-2479"></span><span>                   </span><span class="hs-comment">-- it hasn't, if, say, we're reporting a kind error en route to</span><span>
</span><span id="line-2480"></span><span>                   </span><span class="hs-comment">-- checking a term. See test indexed-types/should_fail/T8129</span><span>
</span><span id="line-2481"></span><span>                   </span><span class="hs-comment">-- Or we are reporting errors from the ambiguity check on</span><span>
</span><span id="line-2482"></span><span>                   </span><span class="hs-comment">-- a local type signature</span><span>
</span><span id="line-2483"></span><span>               </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621683032816"><span class="hs-identifier hs-type">mb_ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2484"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032817"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032817"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TopLevelFlag -&gt; TcM RelevantBindings
</span><a href="#local-6989586621683032812"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032813"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621683032815"><span class="hs-identifier hs-var">top_lvl</span></a></span><span>
</span><span id="line-2485"></span><span>                   </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcM RelevantBindings
</span><a href="#local-6989586621683032809"><span class="hs-identifier hs-var">discard_it</span></a></span><span>  </span><span class="hs-comment">-- No info; discard</span><span>
</span><span id="line-2486"></span><span>               </span><span class="hs-special">}</span><span>
</span><span id="line-2487"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-2488"></span><span>        </span><span id="local-6989586621683032809"><span class="annot"><span class="annottext">discard_it :: TcM RelevantBindings
</span><a href="#local-6989586621683032809"><span class="hs-identifier hs-var hs-var">discard_it</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags
-&gt; Maybe Int
-&gt; TyCoVarSet
-&gt; RelevantBindings
-&gt; [TcBinder]
-&gt; TcM RelevantBindings
</span><a href="#local-6989586621683032788"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683032801"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621683032802"><span class="hs-identifier hs-var">n_left</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621683032803"><span class="hs-identifier hs-var">tvs_seen</span></a></span><span> </span><span class="annot"><span class="annottext">RelevantBindings
</span><a href="#local-6989586621683032804"><span class="hs-identifier hs-var">rels</span></a></span><span> </span><span class="annot"><span class="annottext">[TcBinder]
</span><a href="#local-6989586621683032808"><span class="hs-identifier hs-var">tc_bndrs</span></a></span><span>
</span><span id="line-2489"></span><span>        </span><span id="local-6989586621683032812"><span class="annot"><span class="annottext">go2 :: Name -&gt; TopLevelFlag -&gt; TcM RelevantBindings
</span><a href="#local-6989586621683032812"><span class="hs-identifier hs-var hs-var">go2</span></a></span></span><span> </span><span id="local-6989586621683032818"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032818"><span class="hs-identifier hs-var">id_name</span></a></span></span><span> </span><span id="local-6989586621683032819"><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621683032819"><span class="hs-identifier hs-var">top_lvl</span></a></span></span><span>
</span><span id="line-2490"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032820"><span class="annot"><span class="annottext">tidy_ty :: Type
</span><a href="#local-6989586621683032820"><span class="hs-identifier hs-var hs-var hs-var">tidy_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NameEnv Type -&gt; Name -&gt; Maybe Type
forall a. NameEnv a -&gt; Name -&gt; Maybe a
</span><a href="GHC.Types.Name.Env.html#lookupNameEnv"><span class="hs-identifier hs-var">lookupNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">NameEnv Type
</span><a href="#local-6989586621683032780"><span class="hs-identifier hs-var">lcl_name_env</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032818"><span class="hs-identifier hs-var">id_name</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2491"></span><span>                                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683032822"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032822"><span class="hs-identifier hs-var">tty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032822"><span class="hs-identifier hs-var">tty</span></a></span><span>
</span><span id="line-2492"></span><span>                                  </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;relevant_bindings&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032818"><span class="hs-identifier hs-var">id_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2493"></span><span>               </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;relevantBindings 1&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032818"><span class="hs-identifier hs-var">id_name</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032820"><span class="hs-identifier hs-var">tidy_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2494"></span><span>               </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032823"><span class="annot"><span class="annottext">id_tvs :: TyCoVarSet
</span><a href="#local-6989586621683032823"><span class="hs-identifier hs-var hs-var">id_tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032820"><span class="hs-identifier hs-var">tidy_ty</span></a></span><span>
</span><span id="line-2495"></span><span>                     </span><span id="local-6989586621683032824"><span class="annot"><span class="annottext">bd :: (Name, Type)
</span><a href="#local-6989586621683032824"><span class="hs-identifier hs-var hs-var">bd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683032818"><span class="hs-identifier hs-var">id_name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032820"><span class="hs-identifier hs-var">tidy_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2496"></span><span>                     </span><span id="local-6989586621683032825"><span class="annot"><span class="annottext">new_seen :: TyCoVarSet
</span><a href="#local-6989586621683032825"><span class="hs-identifier hs-var hs-var">new_seen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621683032803"><span class="hs-identifier hs-var">tvs_seen</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; TyCoVarSet -&gt; TyCoVarSet
</span><a href="GHC.Types.Var.Set.html#unionVarSet"><span class="hs-operator hs-var">`unionVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621683032823"><span class="hs-identifier hs-var">id_tvs</span></a></span><span>
</span><span id="line-2497"></span><span>
</span><span id="line-2498"></span><span>               </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032778"><span class="hs-identifier hs-var">want_filtering</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Bool
</span><a href="GHC.Driver.DynFlags.html#hasPprDebug"><span class="hs-identifier hs-var">hasPprDebug</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683032801"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2499"></span><span>                                    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621683032823"><span class="hs-identifier hs-var">id_tvs</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; TyCoVarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#disjointVarSet"><span class="hs-operator hs-var">`disjointVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621683032781"><span class="hs-identifier hs-var">ct_tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2500"></span><span>                          </span><span class="hs-comment">-- We want to filter out this binding anyway</span><span>
</span><span id="line-2501"></span><span>                          </span><span class="hs-comment">-- so discard it silently</span><span>
</span><span id="line-2502"></span><span>                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TcM RelevantBindings
</span><a href="#local-6989586621683032809"><span class="hs-identifier hs-var">discard_it</span></a></span><span>
</span><span id="line-2503"></span><span>
</span><span id="line-2504"></span><span>                 </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TopLevelFlag -&gt; Bool
</span><a href="GHC.Types.Basic.html#isTopLevel"><span class="hs-identifier hs-var">isTopLevel</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621683032819"><span class="hs-identifier hs-var">top_lvl</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621683032802"><span class="hs-identifier hs-var">n_left</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2505"></span><span>                          </span><span class="hs-comment">-- It's a top-level binding and we have not specified</span><span>
</span><span id="line-2506"></span><span>                          </span><span class="hs-comment">-- -fno-max-relevant-bindings, so discard it silently</span><span>
</span><span id="line-2507"></span><span>                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TcM RelevantBindings
</span><a href="#local-6989586621683032809"><span class="hs-identifier hs-var">discard_it</span></a></span><span>
</span><span id="line-2508"></span><span>
</span><span id="line-2509"></span><span>                 </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Bool
</span><a href="#local-6989586621683032792"><span class="hs-identifier hs-var">run_out</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621683032802"><span class="hs-identifier hs-var">n_left</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621683032823"><span class="hs-identifier hs-var">id_tvs</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet -&gt; TyCoVarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#subVarSet"><span class="hs-operator hs-var">`subVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621683032803"><span class="hs-identifier hs-var">tvs_seen</span></a></span><span>
</span><span id="line-2510"></span><span>                          </span><span class="hs-comment">-- We've run out of n_left fuel and this binding only</span><span>
</span><span id="line-2511"></span><span>                          </span><span class="hs-comment">-- mentions already-seen type variables, so discard it</span><span>
</span><span id="line-2512"></span><span>                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DynFlags
-&gt; Maybe Int
-&gt; TyCoVarSet
-&gt; RelevantBindings
-&gt; [TcBinder]
-&gt; TcM RelevantBindings
</span><a href="#local-6989586621683032788"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683032801"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621683032802"><span class="hs-identifier hs-var">n_left</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621683032803"><span class="hs-identifier hs-var">tvs_seen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Name, Type)] -&gt; Bool -&gt; RelevantBindings
</span><a href="GHC.Tc.Errors.Types.html#RelevantBindings"><span class="hs-identifier hs-var">RelevantBindings</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name, Type)]
</span><a href="#local-6989586621683032805"><span class="hs-identifier hs-var">bds</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Record that we have now discarded something</span><span>
</span><span id="line-2513"></span><span>                         </span><span class="annot"><span class="annottext">[TcBinder]
</span><a href="#local-6989586621683032808"><span class="hs-identifier hs-var">tc_bndrs</span></a></span><span>
</span><span id="line-2514"></span><span>
</span><span id="line-2515"></span><span>                          </span><span class="hs-comment">-- Keep this binding, decrement fuel</span><span>
</span><span id="line-2516"></span><span>                 </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">DynFlags
-&gt; Maybe Int
-&gt; TyCoVarSet
-&gt; RelevantBindings
-&gt; [TcBinder]
-&gt; TcM RelevantBindings
</span><a href="#local-6989586621683032788"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683032801"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Maybe Int
</span><a href="#local-6989586621683032795"><span class="hs-identifier hs-var">dec_max</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621683032802"><span class="hs-identifier hs-var">n_left</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621683032825"><span class="hs-identifier hs-var">new_seen</span></a></span><span>
</span><span id="line-2517"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Name, Type)] -&gt; Bool -&gt; RelevantBindings
</span><a href="GHC.Tc.Errors.Types.html#RelevantBindings"><span class="hs-identifier hs-var">RelevantBindings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name, Type)
</span><a href="#local-6989586621683032824"><span class="hs-identifier hs-var">bd</span></a></span><span class="annot"><span class="annottext">(Name, Type) -&gt; [(Name, Type)] -&gt; [(Name, Type)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(Name, Type)]
</span><a href="#local-6989586621683032805"><span class="hs-identifier hs-var">bds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683032806"><span class="hs-identifier hs-var">discards</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TcBinder]
</span><a href="#local-6989586621683032808"><span class="hs-identifier hs-var">tc_bndrs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2518"></span><span>
</span><span id="line-2519"></span><span class="hs-comment">-----------------------</span><span>
</span><span id="line-2520"></span><span class="annot"><a href="GHC.Tc.Errors.html#warnDefaulting"><span class="hs-identifier hs-type">warnDefaulting</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#Ct"><span class="hs-identifier hs-type">Ct</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2521"></span><span id="warnDefaulting"><span class="annot"><span class="annottext">warnDefaulting :: [Ct] -&gt; TcId -&gt; Type -&gt; TcM ()
</span><a href="GHC.Tc.Errors.html#warnDefaulting"><span class="hs-identifier hs-var hs-var">warnDefaulting</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">TcId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-2522"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; TcM ()
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;warnDefaulting: empty Wanteds&quot;</span></span><span>
</span><span id="line-2523"></span><span class="annot"><a href="GHC.Tc.Errors.html#warnDefaulting"><span class="hs-identifier hs-var">warnDefaulting</span></a></span><span> </span><span id="local-6989586621683032831"><span class="annot"><span class="annottext">wanteds :: [Ct]
</span><a href="#local-6989586621683032831"><span class="hs-identifier hs-var">wanteds</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621683032832"><span class="annot"><span class="annottext">Ct
</span><a href="#local-6989586621683032832"><span class="hs-identifier hs-var">ct</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Ct]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683032833"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032833"><span class="hs-identifier hs-var">the_tv</span></a></span></span><span> </span><span id="local-6989586621683032834"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032834"><span class="hs-identifier hs-var">default_ty</span></a></span></span><span>
</span><span id="line-2524"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683032835"><span class="annot"><a href="#local-6989586621683032835"><span class="hs-identifier hs-var">warn_default</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; TcRnIf TcGblEnv TcLclEnv Bool
forall gbl lcl. WarningFlag -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#woptM"><span class="hs-identifier hs-var">woptM</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnTypeDefaults"><span class="hs-identifier hs-var">Opt_WarnTypeDefaults</span></a></span><span>
</span><span id="line-2525"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683032837"><span class="annot"><a href="#local-6989586621683032837"><span class="hs-identifier hs-var">env0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#liftZonkM"><span class="hs-identifier hs-type">liftZonkM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Zonk.TcType.html#tcInitTidyEnv"><span class="hs-identifier hs-type">tcInitTidyEnv</span></a></span><span>
</span><span id="line-2526"></span><span>            </span><span class="hs-comment">-- don't want to report all the superclass constraints, which</span><span>
</span><span id="line-2527"></span><span>            </span><span class="hs-comment">-- add unhelpful clutter</span><span>
</span><span id="line-2528"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683032839"><span class="annot"><a href="#local-6989586621683032839"><span class="hs-identifier hs-var hs-var">filtered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ct -&gt; Bool) -&gt; [Ct] -&gt; [Ct]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Ct -&gt; Bool) -&gt; Ct -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CtOrigin -&gt; Bool
</span><a href="GHC.Tc.Types.Origin.html#isWantedSuperclassOrigin"><span class="hs-identifier hs-var">isWantedSuperclassOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">(CtOrigin -&gt; Bool) -&gt; (Ct -&gt; CtOrigin) -&gt; Ct -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Ct -&gt; CtOrigin
</span><a href="GHC.Tc.Types.Constraint.html#ctOrigin"><span class="hs-identifier hs-var">ctOrigin</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ct]
</span><a href="#local-6989586621683032831"><span class="hs-identifier hs-var">wanteds</span></a></span><span>
</span><span id="line-2529"></span><span>             </span><span id="local-6989586621683032841"><span class="annot"><a href="#local-6989586621683032841"><span class="hs-identifier hs-var hs-var">tidy_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; [TcId] -&gt; TidyEnv
</span><a href="GHC.Core.TyCo.Tidy.html#tidyFreeTyCoVars"><span class="hs-identifier hs-var">tidyFreeTyCoVars</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621683032837"><span class="hs-identifier hs-var">env0</span></a></span><span> </span><span class="annot"><span class="annottext">([TcId] -&gt; TidyEnv) -&gt; [TcId] -&gt; TidyEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2530"></span><span>                        </span><span class="annot"><span class="annottext">Cts -&gt; [TcId]
</span><a href="GHC.Tc.Types.Constraint.html#tyCoVarsOfCtsList"><span class="hs-identifier hs-var">tyCoVarsOfCtsList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ct] -&gt; Cts
forall a. [a] -&gt; Bag a
</span><a href="GHC.Data.Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a></span><span> </span><span class="annot"><span class="annottext">[Ct]
</span><a href="#local-6989586621683032839"><span class="hs-identifier hs-var">filtered</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2531"></span><span>             </span><span id="local-6989586621683032844"><span class="annot"><a href="#local-6989586621683032844"><span class="hs-identifier hs-var hs-var">tidy_wanteds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ct -&gt; Ct) -&gt; [Ct] -&gt; [Ct]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv -&gt; Ct -&gt; Ct
</span><a href="GHC.Tc.Zonk.TcType.html#tidyCt"><span class="hs-identifier hs-var">tidyCt</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621683032841"><span class="hs-identifier hs-var">tidy_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ct]
</span><a href="#local-6989586621683032839"><span class="hs-identifier hs-var">filtered</span></a></span><span>
</span><span id="line-2532"></span><span>             </span><span id="local-6989586621683032845"><span class="annot"><a href="#local-6989586621683032845"><span class="hs-identifier hs-var hs-var">tidy_tv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqFM TcId TcId -&gt; TcId -&gt; Maybe TcId
forall a. VarEnv a -&gt; TcId -&gt; Maybe a
</span><a href="GHC.Types.Var.Env.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv -&gt; UniqFM TcId TcId
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621683032841"><span class="hs-identifier hs-var">tidy_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621683032833"><span class="hs-identifier hs-var">the_tv</span></a></span><span>
</span><span id="line-2533"></span><span>             </span><span id="local-6989586621683032847"><span class="annot"><a href="#local-6989586621683032847"><span class="hs-identifier hs-var hs-var">diag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Ct] -&gt; Maybe TcId -&gt; Type -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnWarnDefaulting"><span class="hs-identifier hs-var">TcRnWarnDefaulting</span></a></span><span> </span><span class="annot"><span class="annottext">[Ct]
</span><a href="#local-6989586621683032844"><span class="hs-identifier hs-var">tidy_wanteds</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TcId
</span><a href="#local-6989586621683032845"><span class="hs-identifier hs-var">tidy_tv</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683032834"><span class="hs-identifier hs-var">default_ty</span></a></span><span>
</span><span id="line-2534"></span><span>             </span><span id="local-6989586621683032849"><span class="annot"><a href="#local-6989586621683032849"><span class="hs-identifier hs-var hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ct -&gt; CtLoc
</span><a href="GHC.Tc.Types.Constraint.html#ctLoc"><span class="hs-identifier hs-var">ctLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ct
</span><a href="#local-6989586621683032832"><span class="hs-identifier hs-var">ct</span></a></span><span>
</span><span id="line-2535"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#setCtLocM"><span class="hs-identifier hs-type">setCtLocM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032849"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#diagnosticTc"><span class="hs-identifier hs-type">diagnosticTc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032835"><span class="hs-identifier hs-type">warn_default</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683032847"><span class="hs-identifier hs-type">diag</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2536"></span><span>
</span><span id="line-2537"></span><span class="hs-comment">{-
Note [Runtime skolems]
~~~~~~~~~~~~~~~~~~~~~~
We want to give a reasonably helpful error message for ambiguity
arising from *runtime* skolems in the debugger.  These
are created by in GHC.Runtime.Heap.Inspect.zonkRTTIType.
-}</span><span>
</span><span id="line-2544"></span><span>
</span><span id="line-2545"></span><span class="annot"><span class="hs-comment">{-**********************************************************************
*                                                                      *
                      GHC API helper functions
*                                                                      *
**********************************************************************-}</span></span><span>
</span><span id="line-2550"></span><span>
</span><span id="line-2551"></span><span class="hs-comment">-- | If the 'TcSolverReportMsg' is a type mismatch between</span><span>
</span><span id="line-2552"></span><span class="hs-comment">-- an actual and an expected type, return the actual and expected types</span><span>
</span><span id="line-2553"></span><span class="hs-comment">-- (in that order).</span><span>
</span><span id="line-2554"></span><span class="hs-comment">--</span><span>
</span><span id="line-2555"></span><span class="hs-comment">-- Prefer using this over manually inspecting the 'TcSolverReportMsg' datatype</span><span>
</span><span id="line-2556"></span><span class="hs-comment">-- if you just want this information, as the datatype itself is subject to change</span><span>
</span><span id="line-2557"></span><span class="hs-comment">-- across GHC versions.</span><span>
</span><span id="line-2558"></span><span class="annot"><a href="GHC.Tc.Errors.html#solverReportMsg_ExpectedActuals"><span class="hs-identifier hs-type">solverReportMsg_ExpectedActuals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcSolverReportMsg"><span class="hs-identifier hs-type">TcSolverReportMsg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2559"></span><span id="solverReportMsg_ExpectedActuals"><span class="annot"><span class="annottext">solverReportMsg_ExpectedActuals :: TcSolverReportMsg -&gt; Maybe (Type, Type)
</span><a href="GHC.Tc.Errors.html#solverReportMsg_ExpectedActuals"><span class="hs-identifier hs-var hs-var">solverReportMsg_ExpectedActuals</span></a></span></span><span>
</span><span id="line-2560"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-2561"></span><span>    </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#Mismatch"><span class="hs-identifier hs-type">Mismatch</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mismatchMsg :: TcSolverReportMsg -&gt; MismatchMsg
</span><a href="GHC.Tc.Errors.Types.html#mismatchMsg"><span class="hs-identifier hs-var">mismatchMsg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683032852"><span class="annot"><span class="annottext">MismatchMsg
</span><a href="#local-6989586621683032852"><span class="hs-identifier hs-var">mismatch_msg</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2562"></span><span>      </span><span class="annot"><span class="annottext">MismatchMsg -&gt; Maybe (Type, Type)
</span><a href="GHC.Tc.Errors.Ppr.html#mismatchMsg_ExpectedActuals"><span class="hs-identifier hs-var">mismatchMsg_ExpectedActuals</span></a></span><span> </span><span class="annot"><span class="annottext">MismatchMsg
</span><a href="#local-6989586621683032852"><span class="hs-identifier hs-var">mismatch_msg</span></a></span><span>
</span><span id="line-2563"></span><span>    </span><span class="annot"><span class="annottext">TcSolverReportMsg
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Type, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2564"></span><span>
</span><span id="line-2565"></span><span class="hs-comment">-- | Filter the list by the given predicate, but if that would be empty,</span><span>
</span><span id="line-2566"></span><span class="hs-comment">-- just give back the original list.</span><span>
</span><span id="line-2567"></span><span class="hs-comment">-- We use this as we must report something for fdefer-type-errors.</span><span>
</span><span id="line-2568"></span><span id="local-6989586621683030865"><span class="annot"><a href="GHC.Tc.Errors.html#tryFilter"><span class="hs-identifier hs-type">tryFilter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683030865"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621683030865"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621683030865"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-2569"></span><span id="tryFilter"><span class="annot"><span class="annottext">tryFilter :: forall a. (a -&gt; Bool) -&gt; NonEmpty a -&gt; NonEmpty a
</span><a href="GHC.Tc.Errors.html#tryFilter"><span class="hs-identifier hs-var hs-var">tryFilter</span></a></span></span><span> </span><span id="local-6989586621683032854"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621683032854"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621683032855"><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621683032855"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty a -&gt; Maybe (NonEmpty a) -&gt; NonEmpty a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621683032855"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (NonEmpty a) -&gt; NonEmpty a)
-&gt; Maybe (NonEmpty a) -&gt; NonEmpty a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Maybe (NonEmpty a)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#nonEmpty"><span class="hs-identifier hs-var">nonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621683032854"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty a -&gt; [a]
forall a. NonEmpty a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621683032855"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2570"></span></pre></body></html>