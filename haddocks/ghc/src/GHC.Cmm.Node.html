<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">-- CmmNode type for representation using Hoopl graphs.</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html"><span class="hs-identifier">GHC.Cmm.Node</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-9"></span><span>     </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier">CmmNode</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier">CmmFormal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier">CmmActual</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Tickish.html#CmmTickish"><span class="hs-identifier">CmmTickish</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>     </span><span class="annot"><a href="GHC.Cmm.Node.html#UpdFrameOffset"><span class="hs-identifier">UpdFrameOffset</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#Convention"><span class="hs-identifier">Convention</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>     </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier">ForeignConvention</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier">ForeignTarget</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#foreignTargetHints"><span class="hs-identifier">foreignTargetHints</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>     </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmReturnInfo"><span class="hs-identifier">CmmReturnInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>     </span><span class="annot"><a href="GHC.Cmm.Node.html#mapExp"><span class="hs-identifier">mapExp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#mapExpDeep"><span class="hs-identifier">mapExpDeep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#wrapRecExp"><span class="hs-identifier">wrapRecExp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#foldExp"><span class="hs-identifier">foldExp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#foldExpDeep"><span class="hs-identifier">foldExpDeep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#wrapRecExpf"><span class="hs-identifier">wrapRecExpf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>     </span><span class="annot"><a href="GHC.Cmm.Node.html#mapExpM"><span class="hs-identifier">mapExpM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#mapExpDeepM"><span class="hs-identifier">mapExpDeepM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#wrapRecExpM"><span class="hs-identifier">wrapRecExpM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#mapSuccessors"><span class="hs-identifier">mapSuccessors</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#mapCollectSuccessors"><span class="hs-identifier">mapCollectSuccessors</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span>     </span><span class="annot"><span class="hs-comment">-- * Tick scopes</span></span><span>
</span><span id="line-17"></span><span>     </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTickScope"><span class="hs-identifier">CmmTickScope</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#isTickSubScope"><span class="hs-identifier">isTickSubScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#combineTickScopes"><span class="hs-identifier">combineTickScopes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">succ</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.Regs.html"><span class="hs-identifier">GHC.Platform.Regs</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html"><span class="hs-identifier">GHC.Cmm.CLabel</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html"><span class="hs-identifier">GHC.Cmm.Expr</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Switch.html"><span class="hs-identifier">GHC.Cmm.Switch</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Pair.html"><span class="hs-identifier">GHC.Data.Pair</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.ForeignCall.html"><span class="hs-identifier">GHC.Types.ForeignCall</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Runtime.Heap.Layout.html"><span class="hs-identifier">GHC.Runtime.Heap.Layout</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Tickish.html"><span class="hs-identifier">GHC.Types.Tickish</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Tickish.html#CmmTickish"><span class="hs-identifier">CmmTickish</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html"><span class="hs-identifier">GHC.Types.Unique</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">U</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#FunctionOrData"><span class="hs-identifier">FunctionOrData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.html"><span class="hs-identifier">GHC.Platform</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html"><span class="hs-identifier">GHC.Cmm.Dataflow.Block</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Graph.html"><span class="hs-identifier">GHC.Cmm.Dataflow.Graph</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html"><span class="hs-identifier">GHC.Cmm.Dataflow.Label</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Foldable.html"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Functor.Classes.html"><span class="hs-identifier">Data.Functor.Classes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Functor.Classes.html#liftCompare"><span class="hs-identifier">liftCompare</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">tails</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">sortBy</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html"><span class="hs-identifier">GHC.Types.Unique</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.html#nonDetCmpUnique"><span class="hs-identifier">nonDetCmpUnique</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Constants.html"><span class="hs-identifier">GHC.Utils.Constants</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Constants.html#debugIsOn"><span class="hs-identifier">debugIsOn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-comment">------------------------</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- CmmNode</span><span class="hs-cpp">

#define ULabel {-# UNPACK #-} !Label
</span><span>
</span><span id="line-52"></span><span class="hs-keyword">data</span><span> </span><span id="CmmNode"><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-var">CmmNode</span></a></span></span><span> </span><span id="local-6989586621682803938"><span class="annot"><a href="#local-6989586621682803938"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621682803939"><span class="annot"><a href="#local-6989586621682803939"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-53"></span><span>  </span><span id="CmmEntry"><span class="annot"><a href="GHC.Cmm.Node.html#CmmEntry"><span class="hs-identifier hs-var">CmmEntry</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ULabel</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CmmTickScope</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CmmNode</span><span> </span><span class="hs-identifier">C</span><span> </span><span class="hs-identifier">O</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>  </span><span id="CmmComment"><span class="annot"><a href="GHC.Cmm.Node.html#CmmComment"><span class="hs-identifier hs-var">CmmComment</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-comment">-- Tick annotation, covering Cmm code in our tick scope. We only</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-comment">-- expect non-code @Tickish@ at this point (e.g. @SourceNote@).</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-comment">-- See Note [CmmTick scoping details]</span><span>
</span><span id="line-60"></span><span>  </span><span id="CmmTick"><span class="annot"><a href="GHC.Cmm.Node.html#CmmTick"><span class="hs-identifier hs-var">CmmTick</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Types.Tickish.html#CmmTickish"><span class="hs-identifier hs-type">CmmTickish</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-comment">-- Unwind pseudo-instruction, encoding stack unwinding</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-comment">-- instructions for a debugger. This describes how to reconstruct</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-comment">-- the &quot;old&quot; value of a register if we want to navigate the stack</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-comment">-- up one frame. Having unwind information for @Sp@ will allow the</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-comment">-- debugger to &quot;walk&quot; the stack.</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-comment">-- See Note [What is this unwinding business?] in &quot;GHC.Cmm.DebugBlock&quot;</span><span>
</span><span id="line-69"></span><span>  </span><span id="CmmUnwind"><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnwind"><span class="hs-identifier hs-var">CmmUnwind</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalReg"><span class="hs-identifier hs-type">GlobalReg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span>  </span><span id="CmmAssign"><span class="annot"><a href="GHC.Cmm.Node.html#CmmAssign"><span class="hs-identifier hs-var">CmmAssign</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-comment">-- Assign to register</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>  </span><span id="CmmStore"><span class="annot"><a href="GHC.Cmm.Node.html#CmmStore"><span class="hs-identifier hs-var">CmmStore</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Cmm.Expr.html#AlignmentSpec"><span class="hs-identifier hs-type">AlignmentSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-comment">-- Assign to memory location.  Size is</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-comment">-- given by cmmExprType of the rhs.</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span>  </span><span id="CmmUnsafeForeignCall"><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnsafeForeignCall"><span class="hs-identifier hs-var">CmmUnsafeForeignCall</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>       </span><span class="hs-comment">-- An unsafe foreign call;</span><span>
</span><span id="line-79"></span><span>                                </span><span class="hs-comment">-- see Note [Foreign calls]</span><span>
</span><span id="line-80"></span><span>                                </span><span class="hs-comment">-- Like a &quot;fat machine instruction&quot;; can occur</span><span>
</span><span id="line-81"></span><span>                                </span><span class="hs-comment">-- in the middle of a block</span><span>
</span><span id="line-82"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>          </span><span class="hs-comment">-- call target</span><span>
</span><span id="line-83"></span><span>      </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>            </span><span class="hs-comment">-- zero or more results</span><span>
</span><span id="line-84"></span><span>      </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>            </span><span class="hs-comment">-- zero or more arguments</span><span>
</span><span id="line-85"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span>
</span><span id="line-86"></span><span>      </span><span class="hs-comment">-- Semantics: clobbers any GlobalRegs for which callerSaves r == True</span><span>
</span><span id="line-87"></span><span>      </span><span class="hs-comment">-- See Note [Unsafe foreign calls clobber caller-save registers]</span><span>
</span><span id="line-88"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-89"></span><span>      </span><span class="hs-comment">-- Invariant: the arguments and the ForeignTarget must not</span><span>
</span><span id="line-90"></span><span>      </span><span class="hs-comment">-- mention any registers for which GHC.Platform.callerSaves</span><span>
</span><span id="line-91"></span><span>      </span><span class="hs-comment">-- is True.  See Note [Register parameter passing].</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>  </span><span id="CmmBranch"><span class="annot"><a href="GHC.Cmm.Node.html#CmmBranch"><span class="hs-identifier hs-var">CmmBranch</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ULabel</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CmmNode</span><span> </span><span class="hs-identifier">O</span><span> </span><span class="hs-identifier">C</span><span>
</span><span id="line-94"></span><span>                                   </span><span class="hs-comment">-- Goto another block in the same procedure</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>  </span><span id="CmmCondBranch"><span class="annot"><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-var">CmmCondBranch</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">{</span><span>                 </span><span class="hs-comment">-- conditional branch</span><span>
</span><span id="line-97"></span><span>      </span><span id="cml_pred"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed -&gt; CmmExpr
</span><a href="GHC.Cmm.Node.html#cml_pred"><span class="hs-identifier hs-var hs-var">cml_pred</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>      </span><span id="cml_true"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed -&gt; Label
</span><a href="GHC.Cmm.Node.html#cml_true"><span class="hs-identifier hs-var hs-var">cml_true</span></a></span></span><span class="hs-special">,</span><span> </span><span id="cml_false"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed -&gt; Label
</span><a href="GHC.Cmm.Node.html#cml_false"><span class="hs-identifier hs-var hs-var">cml_false</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ULabel</span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>      </span><span id="cml_likely"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed -&gt; Maybe Bool
</span><a href="GHC.Cmm.Node.html#cml_likely"><span class="hs-identifier hs-var hs-var">cml_likely</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>       </span><span class="hs-comment">-- likely result of the conditional,</span><span>
</span><span id="line-100"></span><span>                                     </span><span class="hs-comment">-- if known</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#C"><span class="hs-identifier hs-type">C</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span>  </span><span id="CmmSwitch"><span class="annot"><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-var">CmmSwitch</span></a></span></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>       </span><span class="hs-comment">-- Scrutinee, of some integral type</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Switch.html#SwitchTargets"><span class="hs-identifier hs-type">SwitchTargets</span></a></span><span> </span><span class="hs-comment">-- Cases. See Note [SwitchTargets]</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#C"><span class="hs-identifier hs-type">C</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span>  </span><span id="CmmCall"><span class="annot"><a href="GHC.Cmm.Node.html#CmmCall"><span class="hs-identifier hs-var">CmmCall</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">{</span><span>                </span><span class="hs-comment">-- A native call or tail call</span><span>
</span><span id="line-109"></span><span>      </span><span id="cml_target"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed -&gt; CmmExpr
</span><a href="GHC.Cmm.Node.html#cml_target"><span class="hs-identifier hs-var hs-var">cml_target</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- never a CmmPrim to a CallishMachOp!</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span>      </span><span id="cml_cont"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed -&gt; Maybe Label
</span><a href="GHC.Cmm.Node.html#cml_cont"><span class="hs-identifier hs-var hs-var">cml_cont</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>          </span><span class="hs-comment">-- Label of continuation (Nothing for return or tail call)</span><span>
</span><span id="line-113"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-114"></span><span>          </span><span class="hs-comment">-- Note [Continuation BlockIds]</span><span>
</span><span id="line-115"></span><span>          </span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-116"></span><span>          </span><span class="hs-comment">-- These BlockIds are called</span><span>
</span><span id="line-117"></span><span>          </span><span class="hs-comment">-- Continuation BlockIds, and are the only BlockIds that can</span><span>
</span><span id="line-118"></span><span>          </span><span class="hs-comment">-- occur in CmmExprs, namely as (CmmLit (CmmBlock b)) or</span><span>
</span><span id="line-119"></span><span>          </span><span class="hs-comment">-- (CmmStackSlot (Young b) _).</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span>      </span><span id="cml_args_regs"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed -&gt; [GlobalRegUse]
</span><a href="GHC.Cmm.Node.html#cml_args_regs"><span class="hs-identifier hs-var hs-var">cml_args_regs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-type">GlobalRegUse</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-122"></span><span>          </span><span class="hs-comment">-- The argument GlobalRegs (Rx, Fx, Dx, Lx) that are passed</span><span>
</span><span id="line-123"></span><span>          </span><span class="hs-comment">-- to the call.  This is essential information for the</span><span>
</span><span id="line-124"></span><span>          </span><span class="hs-comment">-- native code generator's register allocator; without</span><span>
</span><span id="line-125"></span><span>          </span><span class="hs-comment">-- knowing which GlobalRegs are live it has to assume that</span><span>
</span><span id="line-126"></span><span>          </span><span class="hs-comment">-- they are all live.  This list should only include</span><span>
</span><span id="line-127"></span><span>          </span><span class="hs-comment">-- GlobalRegs that are mapped to real machine registers on</span><span>
</span><span id="line-128"></span><span>          </span><span class="hs-comment">-- the target platform.</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span>      </span><span id="cml_args"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed -&gt; ByteOff
</span><a href="GHC.Cmm.Node.html#cml_args"><span class="hs-identifier hs-var hs-var">cml_args</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Runtime.Heap.Layout.html#ByteOff"><span class="hs-identifier hs-type">ByteOff</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-131"></span><span>          </span><span class="hs-comment">-- Byte offset, from the *old* end of the Area associated with</span><span>
</span><span id="line-132"></span><span>          </span><span class="hs-comment">-- the Label (if cml_cont = Nothing, then Old area), of</span><span>
</span><span id="line-133"></span><span>          </span><span class="hs-comment">-- youngest outgoing arg.  Set the stack pointer to this before</span><span>
</span><span id="line-134"></span><span>          </span><span class="hs-comment">-- transferring control.</span><span>
</span><span id="line-135"></span><span>          </span><span class="hs-comment">-- (NB: an update frame might also have been stored in the Old</span><span>
</span><span id="line-136"></span><span>          </span><span class="hs-comment">--      area, but it'll be in an older part than the args.)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span>      </span><span id="cml_ret_args"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed -&gt; ByteOff
</span><a href="GHC.Cmm.Node.html#cml_ret_args"><span class="hs-identifier hs-var hs-var">cml_ret_args</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Runtime.Heap.Layout.html#ByteOff"><span class="hs-identifier hs-type">ByteOff</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-139"></span><span>          </span><span class="hs-comment">-- For calls *only*, the byte offset for youngest returned value</span><span>
</span><span id="line-140"></span><span>          </span><span class="hs-comment">-- This is really needed at the *return* point rather than here</span><span>
</span><span id="line-141"></span><span>          </span><span class="hs-comment">-- at the call, but in practice it's convenient to record it here.</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>      </span><span id="cml_ret_off"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed -&gt; ByteOff
</span><a href="GHC.Cmm.Node.html#cml_ret_off"><span class="hs-identifier hs-var hs-var">cml_ret_off</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Runtime.Heap.Layout.html#ByteOff"><span class="hs-identifier hs-type">ByteOff</span></a></span><span>
</span><span id="line-144"></span><span>        </span><span class="hs-comment">-- For calls *only*, the byte offset of the base of the frame that</span><span>
</span><span id="line-145"></span><span>        </span><span class="hs-comment">-- must be described by the info table for the return point.</span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-comment">-- The older words are an update frames, which have their own</span><span>
</span><span id="line-147"></span><span>        </span><span class="hs-comment">-- info-table and layout information</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-comment">-- From a liveness point of view, the stack words older than</span><span>
</span><span id="line-150"></span><span>        </span><span class="hs-comment">-- cml_ret_off are treated as live, even if the sequel of</span><span>
</span><span id="line-151"></span><span>        </span><span class="hs-comment">-- the call goes into a loop.</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#C"><span class="hs-identifier hs-type">C</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span>  </span><span id="CmmForeignCall"><span class="annot"><a href="GHC.Cmm.Node.html#CmmForeignCall"><span class="hs-identifier hs-var">CmmForeignCall</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">{</span><span>           </span><span class="hs-comment">-- A safe foreign call; see Note [Foreign calls]</span><span>
</span><span id="line-155"></span><span>                                </span><span class="hs-comment">-- Always the last node of a block</span><span>
</span><span id="line-156"></span><span>      </span><span id="tgt"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed -&gt; ForeignTarget
</span><a href="GHC.Cmm.Node.html#tgt"><span class="hs-identifier hs-var hs-var">tgt</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- call target and convention</span><span>
</span><span id="line-157"></span><span>      </span><span id="res"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed -&gt; [CmmFormal]
</span><a href="GHC.Cmm.Node.html#res"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- zero or more results</span><span>
</span><span id="line-158"></span><span>      </span><span id="args"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed -&gt; [CmmExpr]
</span><a href="GHC.Cmm.Node.html#args"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- zero or more arguments; see Note [Register parameter passing]</span><span>
</span><span id="line-159"></span><span>      </span><span id="succ"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed -&gt; Label
</span><a href="GHC.Cmm.Node.html#succ"><span class="hs-identifier hs-var hs-var">succ</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ULabel</span><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- Label of continuation</span><span>
</span><span id="line-160"></span><span>      </span><span id="ret_args"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed -&gt; ByteOff
</span><a href="GHC.Cmm.Node.html#ret_args"><span class="hs-identifier hs-var hs-var">ret_args</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Runtime.Heap.Layout.html#ByteOff"><span class="hs-identifier hs-type">ByteOff</span></a></span><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- same as cml_ret_args</span><span>
</span><span id="line-161"></span><span>      </span><span id="ret_off"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed -&gt; ByteOff
</span><a href="GHC.Cmm.Node.html#ret_off"><span class="hs-identifier hs-var hs-var">ret_off</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Runtime.Heap.Layout.html#ByteOff"><span class="hs-identifier hs-type">ByteOff</span></a></span><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- same as cml_ret_off</span><span>
</span><span id="line-162"></span><span>      </span><span id="intrbl"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed -&gt; Bool
</span><a href="GHC.Cmm.Node.html#intrbl"><span class="hs-identifier hs-var hs-var">intrbl</span></a></span></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>             </span><span class="hs-comment">-- whether or not the call is interruptible</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#C"><span class="hs-identifier hs-type">C</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682803535"><span id="local-6989586621682803536"><span class="annot"><a href="GHC.Utils.Outputable.html#OutputableP"><span class="hs-identifier hs-type">OutputableP</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803535"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803536"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621682804008"><span class="annot"><span class="annottext">pdoc :: Platform -&gt; CmmNode e x -&gt; SDoc
</span><a href="#local-6989586621682804008"><span class="hs-identifier hs-var hs-var hs-var">pdoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmNode e x -&gt; SDoc
forall (e :: Extensibility) (x :: Extensibility).
Platform -&gt; CmmNode e x -&gt; SDoc
</span><a href="GHC.Cmm.Node.html#pprNode"><span class="hs-identifier hs-var">pprNode</span></a></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span id="local-6989586621682804011"><span id="local-6989586621682804012"><span class="annot"><a href="GHC.Cmm.Node.html#pprNode"><span class="hs-identifier hs-type">pprNode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682804011"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682804012"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span></span></span><span>
</span><span id="line-169"></span><span id="pprNode"><span class="annot"><span class="annottext">pprNode :: forall (e :: Extensibility) (x :: Extensibility).
Platform -&gt; CmmNode e x -&gt; SDoc
</span><a href="GHC.Cmm.Node.html#pprNode"><span class="hs-identifier hs-var hs-var">pprNode</span></a></span></span><span> </span><span id="local-6989586621682804018"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804018"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682804019"><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682804019"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682804020"><span class="hs-identifier hs-var">pp_node</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682804022"><span class="hs-identifier hs-var">pp_debug</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><a href="#local-6989586621682804020"><span class="hs-identifier hs-type">pp_node</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span id="local-6989586621682804020"><span class="annot"><span class="annottext">pp_node :: SDoc
</span><a href="#local-6989586621682804020"><span class="hs-identifier hs-var hs-var">pp_node</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682804019"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-173"></span><span>      </span><span class="hs-comment">-- label:</span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmEntry"><span class="hs-identifier hs-type">CmmEntry</span></a></span><span> </span><span id="local-6989586621682804035"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804035"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span id="local-6989586621682804036"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682804036"><span class="hs-identifier hs-var">tscope</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-175"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SDocContext -&gt; Bool) -&gt; (Bool -&gt; SDoc) -&gt; SDoc
forall a. (SDocContext -&gt; a) -&gt; (a -&gt; SDoc) -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#sdocOption"><span class="hs-identifier hs-var">sdocOption</span></a></span><span> </span><span class="annot"><span class="annottext">SDocContext -&gt; Bool
</span><a href="GHC.Utils.Outputable.html#sdocSuppressUniques"><span class="hs-identifier hs-var">sdocSuppressUniques</span></a></span><span> </span><span class="annot"><span class="annottext">((Bool -&gt; SDoc) -&gt; SDoc) -&gt; (Bool -&gt; SDoc) -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-176"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_lbl_&quot;</span></span><span>
</span><span id="line-177"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Label -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804035"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-178"></span><span>         </span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>         </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a></span><span>
</span><span id="line-180"></span><span>         </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(SDocContext -&gt; Bool) -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppUnlessOption"><span class="hs-identifier hs-var">ppUnlessOption</span></a></span><span> </span><span class="annot"><span class="annottext">SDocContext -&gt; Bool
</span><a href="GHC.Utils.Outputable.html#sdocSuppressTicks"><span class="hs-identifier hs-var">sdocSuppressTicks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;//&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682804036"><span class="hs-identifier hs-var">tscope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>      </span><span class="hs-comment">-- // text</span><span>
</span><span id="line-183"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmComment"><span class="hs-identifier hs-type">CmmComment</span></a></span><span> </span><span id="local-6989586621682804050"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682804050"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;//&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FastString -&gt; SDoc
forall doc. IsLine doc =&gt; FastString -&gt; doc
</span><a href="GHC.Utils.Outputable.html#ftext"><span class="hs-identifier hs-var">ftext</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682804050"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>      </span><span class="hs-comment">-- //tick bla&lt;...&gt;</span><span>
</span><span id="line-186"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTick"><span class="hs-identifier hs-type">CmmTick</span></a></span><span> </span><span id="local-6989586621682804061"><span class="annot"><span class="annottext">CmmTickish
</span><a href="#local-6989586621682804061"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(SDocContext -&gt; Bool) -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppUnlessOption"><span class="hs-identifier hs-var">ppUnlessOption</span></a></span><span> </span><span class="annot"><span class="annottext">SDocContext -&gt; Bool
</span><a href="GHC.Utils.Outputable.html#sdocSuppressTicks"><span class="hs-identifier hs-var">sdocSuppressTicks</span></a></span><span>
</span><span id="line-187"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;//tick&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickish -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickish
</span><a href="#local-6989586621682804061"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>      </span><span class="hs-comment">-- unwind reg = expr;</span><span>
</span><span id="line-190"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnwind"><span class="hs-identifier hs-type">CmmUnwind</span></a></span><span> </span><span id="local-6989586621682804075"><span class="annot"><span class="annottext">[(GlobalReg, Maybe CmmExpr)]
</span><a href="#local-6989586621682804075"><span class="hs-identifier hs-var">regs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-191"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unwind &quot;</span></span><span>
</span><span id="line-192"></span><span>          </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="#local-6989586621682804076"><span class="hs-identifier hs-var">commafy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((GlobalReg, Maybe CmmExpr) -&gt; SDoc)
-&gt; [(GlobalReg, Maybe CmmExpr)] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621682804077"><span class="annot"><span class="annottext">GlobalReg
</span><a href="#local-6989586621682804077"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682804078"><span class="annot"><span class="annottext">Maybe CmmExpr
</span><a href="#local-6989586621682804078"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GlobalReg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="#local-6989586621682804077"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Maybe CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804018"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CmmExpr
</span><a href="#local-6989586621682804078"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(GlobalReg, Maybe CmmExpr)]
</span><a href="#local-6989586621682804075"><span class="hs-identifier hs-var">regs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#semi"><span class="hs-identifier hs-var">semi</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span>      </span><span class="hs-comment">-- reg = expr;</span><span>
</span><span id="line-195"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmAssign"><span class="hs-identifier hs-type">CmmAssign</span></a></span><span> </span><span id="local-6989586621682804091"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682804091"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682804092"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804092"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682804091"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#equals"><span class="hs-identifier hs-var">equals</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804018"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804092"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#semi"><span class="hs-identifier hs-var">semi</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>      </span><span class="hs-comment">-- rep[lv] = expr;</span><span>
</span><span id="line-198"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmStore"><span class="hs-identifier hs-type">CmmStore</span></a></span><span> </span><span id="local-6989586621682804110"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804110"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span id="local-6989586621682804111"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804111"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621682804112"><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="#local-6989586621682804112"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682804113"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682804114"><span class="hs-identifier hs-var">align_mark</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804018"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804110"><span class="hs-identifier hs-var">lv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#equals"><span class="hs-identifier hs-var">equals</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804018"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804111"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#semi"><span class="hs-identifier hs-var">semi</span></a></span><span>
</span><span id="line-199"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-200"></span><span>            </span><span id="local-6989586621682804114"><span class="annot"><span class="annottext">align_mark :: SDoc
</span><a href="#local-6989586621682804114"><span class="hs-identifier hs-var hs-var">align_mark</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="#local-6989586621682804112"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-201"></span><span>                           </span><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="GHC.Cmm.Expr.html#Unaligned"><span class="hs-identifier hs-var">Unaligned</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;^&quot;</span></span><span>
</span><span id="line-202"></span><span>                           </span><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="GHC.Cmm.Expr.html#NaturallyAligned"><span class="hs-identifier hs-var">NaturallyAligned</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-203"></span><span>            </span><span id="local-6989586621682804113"><span class="annot"><span class="annottext">rep :: SDoc
</span><a href="#local-6989586621682804113"><span class="hs-identifier hs-var hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804018"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804111"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>      </span><span class="hs-comment">-- call &quot;ccall&quot; foo(x, y)[r1, r2];</span><span>
</span><span id="line-206"></span><span>      </span><span class="hs-comment">-- ToDo ppr volatile</span><span>
</span><span id="line-207"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnsafeForeignCall"><span class="hs-identifier hs-type">CmmUnsafeForeignCall</span></a></span><span> </span><span id="local-6989586621682804139"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804139"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621682804140"><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682804140"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span id="local-6989586621682804141"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804141"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-208"></span><span>          </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; SDoc
forall doc. IsOutput doc =&gt; Bool -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#ppUnless"><span class="hs-identifier hs-var">ppUnless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CmmFormal] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682804140"><span class="hs-identifier hs-var">results</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-209"></span><span>                    </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="#local-6989586621682804076"><span class="hs-identifier hs-var">commafy</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; [SDoc] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(CmmFormal -&gt; SDoc) -&gt; [CmmFormal] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CmmFormal -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682804140"><span class="hs-identifier hs-var">results</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#equals"><span class="hs-identifier hs-var">equals</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-210"></span><span>                 </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;call&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-211"></span><span>                 </span><span class="annot"><span class="annottext">Platform -&gt; ForeignTarget -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804018"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804139"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="#local-6989586621682804076"><span class="hs-identifier hs-var">commafy</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; [SDoc] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; SDoc) -&gt; [CmmExpr] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804018"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804141"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#semi"><span class="hs-identifier hs-var">semi</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span>      </span><span class="hs-comment">-- goto label;</span><span>
</span><span id="line-214"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmBranch"><span class="hs-identifier hs-type">CmmBranch</span></a></span><span> </span><span id="local-6989586621682804153"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804153"><span class="hs-identifier hs-var">ident</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;goto&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Label -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804153"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#semi"><span class="hs-identifier hs-var">semi</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span>      </span><span class="hs-comment">-- if (expr) goto t; else goto f;</span><span>
</span><span id="line-217"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-type">CmmCondBranch</span></a></span><span> </span><span id="local-6989586621682804174"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804174"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621682804175"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804175"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621682804176"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804176"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682804177"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621682804177"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-218"></span><span>          </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;if&quot;</span></span><span>
</span><span id="line-219"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804018"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804174"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621682804177"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-221"></span><span>                   </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-222"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682804178"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682804178"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;likely:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682804178"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;goto&quot;</span></span><span>
</span><span id="line-224"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Label -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804175"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#semi"><span class="hs-identifier hs-var">semi</span></a></span><span>
</span><span id="line-225"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;else goto&quot;</span></span><span>
</span><span id="line-226"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Label -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804176"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#semi"><span class="hs-identifier hs-var">semi</span></a></span><span>
</span><span id="line-227"></span><span>               </span><span class="hs-special">]</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-type">CmmSwitch</span></a></span><span> </span><span id="local-6989586621682804211"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804211"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621682804212"><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682804212"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-230"></span><span>          </span><span class="annot"><span class="annottext">SDoc -&gt; ByteOff -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;switch&quot;</span></span><span>
</span><span id="line-231"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682804214"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-232"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Bool
</span><a href="GHC.Cmm.Expr.html#isTrivialCmmExpr"><span class="hs-identifier hs-var">isTrivialCmmExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804211"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-233"></span><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804018"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804211"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-234"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804018"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804211"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{&quot;</span></span><span>
</span><span id="line-236"></span><span>                     </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>             </span><span class="annot"><span class="annottext">ByteOff
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((NonEmpty Integer, Label) -&gt; SDoc)
-&gt; [(NonEmpty Integer, Label)] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty Integer, Label) -&gt; SDoc
forall {t :: * -&gt; *} {a}.
(Foldable t, Functor t, Outputable a) =&gt;
(t Integer, a) -&gt; SDoc
</span><a href="#local-6989586621682804217"><span class="hs-identifier hs-var">ppCase</span></a></span><span> </span><span class="annot"><span class="annottext">[(NonEmpty Integer, Label)]
</span><a href="#local-6989586621682804218"><span class="hs-identifier hs-var">cases</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682804220"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#rbrace"><span class="hs-identifier hs-var">rbrace</span></a></span><span>
</span><span id="line-238"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-239"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682804218"><span class="annot"><span class="annottext">[(NonEmpty Integer, Label)]
</span><a href="#local-6989586621682804218"><span class="hs-identifier hs-var">cases</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682804222"><span class="annot"><span class="annottext">Maybe Label
</span><a href="#local-6989586621682804222"><span class="hs-identifier hs-var">mbdef</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SwitchTargets -&gt; ([(NonEmpty Integer, Label)], Maybe Label)
</span><a href="GHC.Cmm.Switch.html#switchTargetsFallThrough"><span class="hs-identifier hs-var">switchTargetsFallThrough</span></a></span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682804212"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-240"></span><span>            </span><span id="local-6989586621682804217"><span class="annot"><span class="annottext">ppCase :: (t Integer, a) -&gt; SDoc
</span><a href="#local-6989586621682804217"><span class="hs-identifier hs-var hs-var">ppCase</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682804236"><span class="annot"><span class="annottext">t Integer
</span><a href="#local-6989586621682804236"><span class="hs-identifier hs-var">is</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682804237"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682804237"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span>
</span><span id="line-241"></span><span>                            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;case&quot;</span></span><span>
</span><span id="line-242"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="#local-6989586621682804076"><span class="hs-identifier hs-var">commafy</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; [SDoc] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">t SDoc -&gt; [SDoc]
forall a. t a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">(t SDoc -&gt; [SDoc]) -&gt; t SDoc -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; SDoc) -&gt; t Integer -&gt; t SDoc
forall a b. (a -&gt; b) -&gt; t a -&gt; t b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; SDoc
forall doc. IsLine doc =&gt; Integer -&gt; doc
</span><a href="GHC.Utils.Outputable.html#integer"><span class="hs-identifier hs-var">integer</span></a></span><span> </span><span class="annot"><span class="annottext">t Integer
</span><a href="#local-6989586621682804236"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-243"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: goto&quot;</span></span><span>
</span><span id="line-244"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682804237"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#semi"><span class="hs-identifier hs-var">semi</span></a></span><span>
</span><span id="line-245"></span><span>                            </span><span class="hs-special">]</span><span>
</span><span id="line-246"></span><span>            </span><span id="local-6989586621682804220"><span class="annot"><span class="annottext">def :: SDoc
</span><a href="#local-6989586621682804220"><span class="hs-identifier hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682804239"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804239"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Label
</span><a href="#local-6989586621682804222"><span class="hs-identifier hs-var">mbdef</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span>
</span><span id="line-247"></span><span>                            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;default:&quot;</span></span><span>
</span><span id="line-248"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;goto&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Label -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804239"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#semi"><span class="hs-identifier hs-var">semi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>                            </span><span class="hs-special">]</span><span>
</span><span id="line-250"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>            </span><span id="local-6989586621682804214"><span class="annot"><span class="annottext">range :: SDoc
</span><a href="#local-6989586621682804214"><span class="hs-identifier hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer -&gt; SDoc
forall doc. IsLine doc =&gt; Integer -&gt; doc
</span><a href="GHC.Utils.Outputable.html#integer"><span class="hs-identifier hs-var">integer</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682804241"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;..&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; SDoc
forall doc. IsLine doc =&gt; Integer -&gt; doc
</span><a href="GHC.Utils.Outputable.html#integer"><span class="hs-identifier hs-var">integer</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682804242"><span class="hs-identifier hs-var">hi</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-253"></span><span>              </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682804241"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682804241"><span class="hs-identifier hs-var">lo</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682804242"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682804242"><span class="hs-identifier hs-var">hi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SwitchTargets -&gt; (Integer, Integer)
</span><a href="GHC.Cmm.Switch.html#switchTargetsRange"><span class="hs-identifier hs-var">switchTargetsRange</span></a></span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682804212"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCall"><span class="hs-identifier hs-type">CmmCall</span></a></span><span> </span><span id="local-6989586621682804280"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804280"><span class="hs-identifier hs-var">tgt</span></a></span></span><span> </span><span id="local-6989586621682804281"><span class="annot"><span class="annottext">Maybe Label
</span><a href="#local-6989586621682804281"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621682804282"><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682804282"><span class="hs-identifier hs-var">regs</span></a></span></span><span> </span><span id="local-6989586621682804283"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804283"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span id="local-6989586621682804284"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804284"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span id="local-6989586621682804285"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804285"><span class="hs-identifier hs-var">updfr_off</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-256"></span><span>          </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hcat"><span class="hs-identifier hs-var">hcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;call&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#space"><span class="hs-identifier hs-var">space</span></a></span><span>
</span><span id="line-257"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; SDoc
</span><a href="#local-6989586621682804288"><span class="hs-identifier hs-var">pprFun</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804280"><span class="hs-identifier hs-var">tgt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GlobalRegUse] -&gt; SDoc
forall a. Outputable a =&gt; [a] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#interpp%27SP"><span class="hs-identifier hs-var">interpp'SP</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682804282"><span class="hs-identifier hs-var">regs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#space"><span class="hs-identifier hs-var">space</span></a></span><span>
</span><span id="line-258"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682804290"><span class="hs-identifier hs-var">returns</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-259"></span><span>                 </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;args: &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804283"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-260"></span><span>                 </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;res: &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804284"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-261"></span><span>                 </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;upd: &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804285"><span class="hs-identifier hs-var">updfr_off</span></a></span><span>
</span><span id="line-262"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#semi"><span class="hs-identifier hs-var">semi</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-263"></span><span>          </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682804288"><span class="annot"><span class="annottext">pprFun :: CmmExpr -&gt; SDoc
</span><a href="#local-6989586621682804288"><span class="hs-identifier hs-var hs-var">pprFun</span></a></span></span><span> </span><span id="local-6989586621682804292"><span class="annot"><span class="annottext">f :: CmmExpr
</span><a href="#local-6989586621682804292"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804018"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804292"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-264"></span><span>                </span><span class="annot"><a href="#local-6989586621682804288"><span class="hs-identifier hs-var">pprFun</span></a></span><span> </span><span id="local-6989586621682804294"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804294"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804018"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804294"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span>                </span><span id="local-6989586621682804290"><span class="annot"><span class="annottext">returns :: SDoc
</span><a href="#local-6989586621682804290"><span class="hs-identifier hs-var hs-var">returns</span></a></span></span><span>
</span><span id="line-267"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682804295"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804295"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Label
</span><a href="#local-6989586621682804281"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;returns to&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Label -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804295"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a></span><span>
</span><span id="line-268"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmForeignCall"><span class="hs-identifier hs-type">CmmForeignCall</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">tgt :: CmmNode 'Open 'Closed -&gt; ForeignTarget
</span><a href="GHC.Cmm.Node.html#tgt"><span class="hs-identifier hs-var">tgt</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804328"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804328"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">res :: CmmNode 'Open 'Closed -&gt; [CmmFormal]
</span><a href="GHC.Cmm.Node.html#res"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804329"><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682804329"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">args :: CmmNode 'Open 'Closed -&gt; [CmmExpr]
</span><a href="GHC.Cmm.Node.html#args"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804330"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804330"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">succ :: CmmNode 'Open 'Closed -&gt; Label
</span><a href="GHC.Cmm.Node.html#succ"><span class="hs-identifier hs-var">succ</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804331"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804331"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ret_args :: CmmNode 'Open 'Closed -&gt; ByteOff
</span><a href="GHC.Cmm.Node.html#ret_args"><span class="hs-identifier hs-var">ret_args</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804332"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804332"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ret_off :: CmmNode 'Open 'Closed -&gt; ByteOff
</span><a href="GHC.Cmm.Node.html#ret_off"><span class="hs-identifier hs-var">ret_off</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804333"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804333"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">intrbl :: CmmNode 'Open 'Closed -&gt; Bool
</span><a href="GHC.Cmm.Node.html#intrbl"><span class="hs-identifier hs-var">intrbl</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804334"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682804334"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-271"></span><span>          </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hcat"><span class="hs-identifier hs-var">hcat</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; [SDoc] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682804334"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;interruptible&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#space"><span class="hs-identifier hs-var">space</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; [SDoc] -&gt; [SDoc]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-272"></span><span>               </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;foreign call&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#space"><span class="hs-identifier hs-var">space</span></a></span><span>
</span><span id="line-273"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ForeignTarget -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804018"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804328"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(...)&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#space"><span class="hs-identifier hs-var">space</span></a></span><span>
</span><span id="line-274"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;returns to&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Label -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804331"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-275"></span><span>                    </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;args:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; [CmmExpr] -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804018"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804330"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>                    </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ress:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CmmFormal] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682804329"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ret_args:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804332"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-278"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ret_off:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804333"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-279"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#semi"><span class="hs-identifier hs-var">semi</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><a href="#local-6989586621682804022"><span class="hs-identifier hs-type">pp_debug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span id="local-6989586621682804022"><span class="annot"><span class="annottext">pp_debug :: SDoc
</span><a href="#local-6989586621682804022"><span class="hs-identifier hs-var hs-var">pp_debug</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-283"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="GHC.Utils.Constants.html#debugIsOn"><span class="hs-identifier hs-var">debugIsOn</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-284"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682804019"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-285"></span><span>             </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmEntry"><span class="hs-identifier hs-type">CmmEntry</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="hs-comment">-- Looks terrible with text &quot;  // CmmEntry&quot;</span><span>
</span><span id="line-286"></span><span>             </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmComment"><span class="hs-identifier hs-type">CmmComment</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="hs-comment">-- Looks also terrible with text &quot;  // CmmComment&quot;</span><span>
</span><span id="line-287"></span><span>             </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTick"><span class="hs-identifier hs-type">CmmTick</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-288"></span><span>             </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnwind"><span class="hs-identifier hs-type">CmmUnwind</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  // CmmUnwind&quot;</span></span><span>
</span><span id="line-289"></span><span>             </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmAssign"><span class="hs-identifier hs-type">CmmAssign</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  // CmmAssign&quot;</span></span><span>
</span><span id="line-290"></span><span>             </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmStore"><span class="hs-identifier hs-type">CmmStore</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  // CmmStore&quot;</span></span><span>
</span><span id="line-291"></span><span>             </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnsafeForeignCall"><span class="hs-identifier hs-type">CmmUnsafeForeignCall</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  // CmmUnsafeForeignCall&quot;</span></span><span>
</span><span id="line-292"></span><span>             </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmBranch"><span class="hs-identifier hs-type">CmmBranch</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  // CmmBranch&quot;</span></span><span>
</span><span id="line-293"></span><span>             </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-type">CmmCondBranch</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  // CmmCondBranch&quot;</span></span><span>
</span><span id="line-294"></span><span>             </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-type">CmmSwitch</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  // CmmSwitch&quot;</span></span><span>
</span><span id="line-295"></span><span>             </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCall"><span class="hs-identifier hs-type">CmmCall</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  // CmmCall&quot;</span></span><span>
</span><span id="line-296"></span><span>             </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmForeignCall"><span class="hs-identifier hs-type">CmmForeignCall</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  // CmmForeignCall&quot;</span></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><a href="#local-6989586621682804076"><span class="hs-identifier hs-type">commafy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-299"></span><span>    </span><span id="local-6989586621682804076"><span class="annot"><span class="annottext">commafy :: [SDoc] -&gt; SDoc
</span><a href="#local-6989586621682804076"><span class="hs-identifier hs-var hs-var">commafy</span></a></span></span><span> </span><span id="local-6989586621682804372"><span class="annot"><span class="annottext">[SDoc]
</span><a href="#local-6989586621682804372"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; [SDoc] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; [SDoc] -&gt; [SDoc]
forall doc. IsLine doc =&gt; doc -&gt; [doc] -&gt; [doc]
</span><a href="GHC.Utils.Outputable.html#punctuate"><span class="hs-identifier hs-var">punctuate</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a></span><span> </span><span class="annot"><span class="annottext">[SDoc]
</span><a href="#local-6989586621682804372"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#OutputableP"><span class="hs-identifier hs-type">OutputableP</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#C"><span class="hs-identifier hs-type">C</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#C"><span class="hs-identifier hs-type">C</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-302"></span><span>    </span><span id="local-6989586621682804378"><span class="annot"><span class="annottext">pdoc :: Platform -&gt; Block CmmNode 'Closed 'Closed -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var hs-var hs-var">pdoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Block CmmNode 'Closed 'Closed -&gt; SDoc
Platform
-&gt; Block CmmNode 'Closed 'Closed -&gt; IndexedCO 'Closed SDoc SDoc
forall (x :: Extensibility) (e :: Extensibility).
(IndexedCO x SDoc SDoc ~ SDoc) =&gt;
Platform -&gt; Block CmmNode e x -&gt; IndexedCO e SDoc SDoc
</span><a href="GHC.Cmm.Node.html#pprBlock"><span class="hs-identifier hs-var">pprBlock</span></a></span><span>
</span><span id="line-303"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#OutputableP"><span class="hs-identifier hs-type">OutputableP</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#C"><span class="hs-identifier hs-type">C</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-304"></span><span>    </span><span id="local-6989586621682804384"><span class="annot"><span class="annottext">pdoc :: Platform -&gt; Block CmmNode 'Closed 'Open -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var hs-var hs-var">pdoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Block CmmNode 'Closed 'Open -&gt; SDoc
Platform
-&gt; Block CmmNode 'Closed 'Open -&gt; IndexedCO 'Closed SDoc SDoc
forall (x :: Extensibility) (e :: Extensibility).
(IndexedCO x SDoc SDoc ~ SDoc) =&gt;
Platform -&gt; Block CmmNode e x -&gt; IndexedCO e SDoc SDoc
</span><a href="GHC.Cmm.Node.html#pprBlock"><span class="hs-identifier hs-var">pprBlock</span></a></span><span>
</span><span id="line-305"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#OutputableP"><span class="hs-identifier hs-type">OutputableP</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#C"><span class="hs-identifier hs-type">C</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-306"></span><span>    </span><span id="local-6989586621682804389"><span class="annot"><span class="annottext">pdoc :: Platform -&gt; Block CmmNode 'Open 'Closed -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var hs-var hs-var">pdoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Block CmmNode 'Open 'Closed -&gt; SDoc
Platform
-&gt; Block CmmNode 'Open 'Closed -&gt; IndexedCO 'Open SDoc SDoc
forall (x :: Extensibility) (e :: Extensibility).
(IndexedCO x SDoc SDoc ~ SDoc) =&gt;
Platform -&gt; Block CmmNode e x -&gt; IndexedCO e SDoc SDoc
</span><a href="GHC.Cmm.Node.html#pprBlock"><span class="hs-identifier hs-var">pprBlock</span></a></span><span>
</span><span id="line-307"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#OutputableP"><span class="hs-identifier hs-type">OutputableP</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-308"></span><span>    </span><span id="local-6989586621682804394"><span class="annot"><span class="annottext">pdoc :: Platform -&gt; Block CmmNode 'Open 'Open -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var hs-var hs-var">pdoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Block CmmNode 'Open 'Open -&gt; SDoc
Platform -&gt; Block CmmNode 'Open 'Open -&gt; IndexedCO 'Open SDoc SDoc
forall (x :: Extensibility) (e :: Extensibility).
(IndexedCO x SDoc SDoc ~ SDoc) =&gt;
Platform -&gt; Block CmmNode e x -&gt; IndexedCO e SDoc SDoc
</span><a href="GHC.Cmm.Node.html#pprBlock"><span class="hs-identifier hs-var">pprBlock</span></a></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682803589"><span id="local-6989586621682803590"><span class="annot"><a href="GHC.Utils.Outputable.html#OutputableP"><span class="hs-identifier hs-type">OutputableP</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Dataflow.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803589"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803590"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-311"></span><span>    </span><span id="local-6989586621682804397"><span class="annot"><span class="annottext">pdoc :: Platform -&gt; Graph CmmNode e x -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var hs-var hs-var">pdoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Graph CmmNode e x -&gt; SDoc
forall (e :: Extensibility) (x :: Extensibility).
Platform -&gt; Graph CmmNode e x -&gt; SDoc
</span><a href="GHC.Cmm.Node.html#pprGraph"><span class="hs-identifier hs-var">pprGraph</span></a></span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span id="local-6989586621682803584"><span id="local-6989586621682803585"><span class="annot"><a href="GHC.Cmm.Node.html#pprBlock"><span class="hs-identifier hs-type">pprBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#IndexedCO"><span class="hs-identifier hs-type">IndexedCO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803584"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-314"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803585"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803584"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#IndexedCO"><span class="hs-identifier hs-type">IndexedCO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803585"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span></span></span><span>
</span><span id="line-315"></span><span id="pprBlock"><span class="annot"><span class="annottext">pprBlock :: forall (x :: Extensibility) (e :: Extensibility).
(IndexedCO x SDoc SDoc ~ SDoc) =&gt;
Platform -&gt; Block CmmNode e x -&gt; IndexedCO e SDoc SDoc
</span><a href="GHC.Cmm.Node.html#pprBlock"><span class="hs-identifier hs-var hs-var">pprBlock</span></a></span></span><span> </span><span id="local-6989586621682804408"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804408"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682804409"><span class="annot"><span class="annottext">Block CmmNode e x
</span><a href="#local-6989586621682804409"><span class="hs-identifier hs-var">block</span></a></span></span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CmmNode 'Closed 'Open -&gt; SDoc -&gt; SDoc,
 CmmNode 'Open 'Open -&gt; SDoc -&gt; SDoc,
 CmmNode 'Open 'Closed -&gt; SDoc -&gt; SDoc)
-&gt; forall (e :: Extensibility) (x :: Extensibility).
   Block CmmNode e x -&gt; IndexedCO x SDoc SDoc -&gt; IndexedCO e SDoc SDoc
forall (n :: Extensibility -&gt; Extensibility -&gt; *) a b c.
(n 'Closed 'Open -&gt; b -&gt; c, n 'Open 'Open -&gt; b -&gt; b,
 n 'Open 'Closed -&gt; a -&gt; b)
-&gt; forall (e :: Extensibility) (x :: Extensibility).
   Block n e x -&gt; IndexedCO x a b -&gt; IndexedCO e c b
</span><a href="GHC.Cmm.Dataflow.Block.html#foldBlockNodesB3"><span class="hs-identifier hs-var">foldBlockNodesB3</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">($$)</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc -&gt; SDoc)
-&gt; (CmmNode 'Closed 'Open -&gt; SDoc)
-&gt; CmmNode 'Closed 'Open
-&gt; SDoc
-&gt; SDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmNode 'Closed 'Open -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804408"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-317"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">($$)</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc -&gt; SDoc)
-&gt; (CmmNode 'Open 'Open -&gt; SDoc)
-&gt; CmmNode 'Open 'Open
-&gt; SDoc
-&gt; SDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteOff -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc)
-&gt; (CmmNode 'Open 'Open -&gt; SDoc) -&gt; CmmNode 'Open 'Open -&gt; SDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmNode 'Open 'Open -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804408"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-318"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">($$)</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc -&gt; SDoc)
-&gt; (CmmNode 'Open 'Closed -&gt; SDoc)
-&gt; CmmNode 'Open 'Closed
-&gt; SDoc
-&gt; SDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteOff -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc)
-&gt; (CmmNode 'Open 'Closed -&gt; SDoc) -&gt; CmmNode 'Open 'Closed -&gt; SDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmNode 'Open 'Closed -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804408"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-319"></span><span>                       </span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>                       </span><span class="annot"><span class="annottext">Block CmmNode e x
</span><a href="#local-6989586621682804409"><span class="hs-identifier hs-var">block</span></a></span><span>
</span><span id="line-321"></span><span>                       </span><span class="annot"><span class="annottext">SDoc
IndexedCO x SDoc SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span id="local-6989586621682804413"><span id="local-6989586621682804414"><span class="annot"><a href="GHC.Cmm.Node.html#pprGraph"><span class="hs-identifier hs-type">pprGraph</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682804413"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682804414"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span></span></span><span>
</span><span id="line-324"></span><span id="pprGraph"><span class="annot"><span class="annottext">pprGraph :: forall (e :: Extensibility) (x :: Extensibility).
Platform -&gt; Graph CmmNode e x -&gt; SDoc
</span><a href="GHC.Cmm.Node.html#pprGraph"><span class="hs-identifier hs-var hs-var">pprGraph</span></a></span></span><span> </span><span id="local-6989586621682804425"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804425"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-325"></span><span>   </span><span class="annot"><span class="annottext">Graph CmmNode e x
</span><a href="GHC.Cmm.Dataflow.Graph.html#GNil"><span class="hs-identifier hs-var">GNil</span></a></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-326"></span><span>   </span><span class="annot"><a href="GHC.Cmm.Dataflow.Graph.html#GUnit"><span class="hs-identifier hs-type">GUnit</span></a></span><span> </span><span id="local-6989586621682804434"><span class="annot"><span class="annottext">Block CmmNode 'Open 'Open
</span><a href="#local-6989586621682804434"><span class="hs-identifier hs-var">block</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Block CmmNode 'Open 'Open -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804425"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Block CmmNode 'Open 'Open
</span><a href="#local-6989586621682804434"><span class="hs-identifier hs-var">block</span></a></span><span>
</span><span id="line-327"></span><span>   </span><span class="annot"><a href="GHC.Cmm.Dataflow.Graph.html#GMany"><span class="hs-identifier hs-type">GMany</span></a></span><span> </span><span id="local-6989586621682804436"><span class="annot"><span class="annottext">MaybeO e (Block CmmNode 'Open 'Closed)
</span><a href="#local-6989586621682804436"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span id="local-6989586621682804437"><span class="annot"><span class="annottext">Body' LabelMap Block CmmNode
</span><a href="#local-6989586621682804437"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621682804438"><span class="annot"><span class="annottext">MaybeO x (Block CmmNode 'Closed 'Open)
</span><a href="#local-6989586621682804438"><span class="hs-identifier hs-var">exit</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-328"></span><span>         </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{&quot;</span></span><span>
</span><span id="line-329"></span><span>      </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MaybeO e (Block CmmNode 'Open 'Closed) -&gt; SDoc
forall (e :: Extensibility) (x :: Extensibility)
       (ex :: Extensibility).
OutputableP Platform (Block CmmNode e x) =&gt;
MaybeO ex (Block CmmNode e x) -&gt; SDoc
</span><a href="#local-6989586621682804439"><span class="hs-identifier hs-var">pprMaybeO</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeO e (Block CmmNode 'Open 'Closed)
</span><a href="#local-6989586621682804436"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; [SDoc] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Block CmmNode 'Closed 'Closed -&gt; SDoc)
-&gt; [Block CmmNode 'Closed 'Closed] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Block CmmNode 'Closed 'Closed -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804425"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Block CmmNode 'Closed 'Closed] -&gt; [SDoc])
-&gt; [Block CmmNode 'Closed 'Closed] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Body' LabelMap Block CmmNode -&gt; [Block CmmNode 'Closed 'Closed]
forall (n :: Extensibility -&gt; Extensibility -&gt; *).
Body LabelMap n -&gt; [Block n 'Closed 'Closed]
</span><a href="GHC.Cmm.Dataflow.Graph.html#bodyToBlockList"><span class="hs-identifier hs-var">bodyToBlockList</span></a></span><span> </span><span class="annot"><span class="annottext">Body' LabelMap Block CmmNode
</span><a href="#local-6989586621682804437"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeO x (Block CmmNode 'Closed 'Open) -&gt; SDoc
forall (e :: Extensibility) (x :: Extensibility)
       (ex :: Extensibility).
OutputableP Platform (Block CmmNode e x) =&gt;
MaybeO ex (Block CmmNode e x) -&gt; SDoc
</span><a href="#local-6989586621682804439"><span class="hs-identifier hs-var">pprMaybeO</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeO x (Block CmmNode 'Closed 'Open)
</span><a href="#local-6989586621682804438"><span class="hs-identifier hs-var">exit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>      </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-331"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682803607"><span id="local-6989586621682803608"><span id="local-6989586621682803609"><span class="annot"><a href="#local-6989586621682804439"><span class="hs-identifier hs-type">pprMaybeO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#OutputableP"><span class="hs-identifier hs-type">OutputableP</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803607"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803608"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#MaybeO"><span class="hs-identifier hs-type">MaybeO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803609"><span class="hs-identifier hs-type">ex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803607"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803608"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span></span></span></span><span>
</span><span id="line-333"></span><span>            </span><span id="local-6989586621682804439"><span class="annot"><span class="annottext">pprMaybeO :: forall (e :: Extensibility) (x :: Extensibility)
       (ex :: Extensibility).
OutputableP Platform (Block CmmNode e x) =&gt;
MaybeO ex (Block CmmNode e x) -&gt; SDoc
</span><a href="#local-6989586621682804439"><span class="hs-identifier hs-var hs-var">pprMaybeO</span></a></span></span><span> </span><span class="annot"><span class="annottext">MaybeO ex (Block CmmNode e x)
</span><a href="GHC.Cmm.Dataflow.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-334"></span><span>            </span><span class="annot"><a href="#local-6989586621682804439"><span class="hs-identifier hs-var">pprMaybeO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#JustO"><span class="hs-identifier hs-type">JustO</span></a></span><span> </span><span id="local-6989586621682804448"><span class="annot"><span class="annottext">Block CmmNode e x
</span><a href="#local-6989586621682804448"><span class="hs-identifier hs-var">block</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Block CmmNode e x -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804425"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Block CmmNode e x
</span><a href="#local-6989586621682804448"><span class="hs-identifier hs-var">block</span></a></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-comment">{- Note [Foreign calls]
~~~~~~~~~~~~~~~~~~~~~~~
A CmmUnsafeForeignCall is used for *unsafe* foreign calls;
a CmmForeignCall call is used for *safe* foreign calls.

Unsafe ones are mostly easy: think of them as a &quot;fat machine
instruction&quot;.  In particular, they do *not* kill all live registers,
just the registers they return to (there was a bit of code in GHC that
conservatively assumed otherwise.)  However, see [Register parameter passing].

Safe ones are trickier.  A safe foreign call
     r = f(x)
ultimately expands to
     push &quot;return address&quot;      -- Never used to return to;
                                -- just points an info table
     save registers into TSO
     call suspendThread
     r = f(x)                   -- Make the call
     call resumeThread
     restore registers
     pop &quot;return address&quot;
We cannot &quot;lower&quot; a safe foreign call to this sequence of Cmms, because
after we've saved Sp all the Cmm optimiser's assumptions are broken.

Note that a safe foreign call needs an info table.

So Safe Foreign Calls must remain as last nodes until the stack is
made manifest in GHC.Cmm.LayoutStack, where they are lowered into the above
sequence.
-}</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">{- Note [Unsafe foreign calls clobber caller-save registers]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
A foreign call is defined to clobber any GlobalRegs that are mapped to
caller-saves machine registers (according to the prevailing C ABI).
GHC.StgToCmm.Utils.callerSaves tells you which GlobalRegs are caller-saves.

This is a design choice that makes it easier to generate code later.
We could instead choose to say that foreign calls do *not* clobber
caller-saves regs, but then we would have to figure out which regs
were live across the call later and insert some saves/restores.

Furthermore when we generate code we never have any GlobalRegs live
across a call, because they are always copied-in to LocalRegs and
copied-out again before making a call/jump.  So all we have to do is
avoid any code motion that would make a caller-saves GlobalReg live
across a foreign call during subsequent optimisations.
-}</span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="hs-comment">{- Note [Register parameter passing]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
On certain architectures, some registers are utilized for parameter
passing in the C calling convention.  For example, in x86-64 Linux
convention, rdi, rsi, rdx and rcx (as well as r8 and r9) may be used for
argument passing.  These are registers R3-R6, which our generated
code may also be using; as a result, it's necessary to save these
values before doing a foreign call.  This is done during initial
code generation in callerSaveVolatileRegs in GHC.StgToCmm.Utils.

However, one result of doing this is that the contents of these registers may
mysteriously change if referenced inside the arguments.  This is dangerous, so
you'll need to disable inlining much in the same way is done in GHC.Cmm.Sink
currently.  We should fix this!
-}</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">---------------------------------------------</span><span>
</span><span id="line-402"></span><span class="hs-comment">-- Eq instance of CmmNode</span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span id="local-6989586621682803618"><span id="local-6989586621682803619"><span id="local-6989586621682804450"><span id="local-6989586621682804455"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803618"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803619"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="hs-comment">----------------------------------------------</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- Hoopl instances of CmmNode</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-410"></span><span>  </span><span id="local-6989586621682804463"><span class="annot"><span class="annottext">entryLabel :: forall (x :: Extensibility). CmmNode 'Closed x -&gt; Label
</span><a href="#local-6989586621682804463"><span class="hs-identifier hs-var hs-var hs-var">entryLabel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmEntry"><span class="hs-identifier hs-type">CmmEntry</span></a></span><span> </span><span id="local-6989586621682804467"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804467"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804467"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span>  </span><span id="local-6989586621682804468"><span class="annot"><span class="annottext">successors :: forall (e :: Extensibility). CmmNode e 'Closed -&gt; [Label]
</span><a href="#local-6989586621682804468"><span class="hs-identifier hs-var hs-var hs-var">successors</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmBranch"><span class="hs-identifier hs-type">CmmBranch</span></a></span><span> </span><span id="local-6989586621682804472"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804472"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804472"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-413"></span><span>  </span><span class="annot"><a href="GHC.Cmm.Dataflow.Graph.html#successors"><span class="hs-identifier hs-var">successors</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-type">CmmCondBranch</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">cml_true :: CmmNode 'Open 'Closed -&gt; Label
</span><a href="GHC.Cmm.Node.html#cml_true"><span class="hs-identifier hs-var">cml_true</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804475"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804475"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cml_false :: CmmNode 'Open 'Closed -&gt; Label
</span><a href="GHC.Cmm.Node.html#cml_false"><span class="hs-identifier hs-var">cml_false</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804476"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804476"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804476"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804475"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- meets layout constraint</span><span>
</span><span id="line-414"></span><span>  </span><span class="annot"><a href="GHC.Cmm.Dataflow.Graph.html#successors"><span class="hs-identifier hs-var">successors</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-type">CmmSwitch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682804479"><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682804479"><span class="hs-identifier hs-var">ids</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SwitchTargets -&gt; [Label]
</span><a href="GHC.Cmm.Switch.html#switchTargetsToList"><span class="hs-identifier hs-var">switchTargetsToList</span></a></span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682804479"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-415"></span><span>  </span><span class="annot"><a href="GHC.Cmm.Dataflow.Graph.html#successors"><span class="hs-identifier hs-var">successors</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCall"><span class="hs-identifier hs-type">CmmCall</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">cml_cont :: CmmNode 'Open 'Closed -&gt; Maybe Label
</span><a href="GHC.Cmm.Node.html#cml_cont"><span class="hs-identifier hs-var">cml_cont</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804483"><span class="annot"><span class="annottext">Maybe Label
</span><a href="#local-6989586621682804483"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Label -&gt; [Label]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">Maybe Label
</span><a href="#local-6989586621682804483"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-416"></span><span>  </span><span class="annot"><a href="GHC.Cmm.Dataflow.Graph.html#successors"><span class="hs-identifier hs-var">successors</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmForeignCall"><span class="hs-identifier hs-type">CmmForeignCall</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">succ :: CmmNode 'Open 'Closed -&gt; Label
</span><a href="GHC.Cmm.Node.html#succ"><span class="hs-identifier hs-var">succ</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804487"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804487"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804487"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-420"></span><span class="hs-comment">-- Various helper types</span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="hs-keyword">type</span><span> </span><span id="CmmActual"><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-var">CmmActual</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-423"></span><span class="hs-keyword">type</span><span> </span><span id="CmmFormal"><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-var">CmmFormal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="hs-keyword">type</span><span> </span><span id="UpdFrameOffset"><span class="annot"><a href="GHC.Cmm.Node.html#UpdFrameOffset"><span class="hs-identifier hs-var">UpdFrameOffset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Runtime.Heap.Layout.html#ByteOff"><span class="hs-identifier hs-type">ByteOff</span></a></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="hs-comment">-- | A convention maps a list of values (function arguments or return</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- values) to registers or stack locations.</span><span>
</span><span id="line-429"></span><span class="hs-keyword">data</span><span> </span><span id="Convention"><span class="annot"><a href="GHC.Cmm.Node.html#Convention"><span class="hs-identifier hs-var">Convention</span></a></span></span><span>
</span><span id="line-430"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="NativeDirectCall"><span class="annot"><a href="GHC.Cmm.Node.html#NativeDirectCall"><span class="hs-identifier hs-var">NativeDirectCall</span></a></span></span><span>
</span><span id="line-431"></span><span>       </span><span class="hs-comment">-- ^ top-level Haskell functions use @NativeDirectCall@, which</span><span>
</span><span id="line-432"></span><span>       </span><span class="hs-comment">-- maps arguments to registers starting with R2, according to</span><span>
</span><span id="line-433"></span><span>       </span><span class="hs-comment">-- how many registers are available on the platform.  This</span><span>
</span><span id="line-434"></span><span>       </span><span class="hs-comment">-- convention ignores R1, because for a top-level function call</span><span>
</span><span id="line-435"></span><span>       </span><span class="hs-comment">-- the function closure is implicit, and doesn't need to be passed.</span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NativeNodeCall"><span class="annot"><a href="GHC.Cmm.Node.html#NativeNodeCall"><span class="hs-identifier hs-var">NativeNodeCall</span></a></span></span><span>
</span><span id="line-437"></span><span>       </span><span class="hs-comment">-- ^ non-top-level Haskell functions, which pass the address of</span><span>
</span><span id="line-438"></span><span>       </span><span class="hs-comment">-- the function closure in R1 (regardless of whether R1 is a</span><span>
</span><span id="line-439"></span><span>       </span><span class="hs-comment">-- real register or not), and the rest of the arguments in</span><span>
</span><span id="line-440"></span><span>       </span><span class="hs-comment">-- registers or on the stack.</span><span>
</span><span id="line-441"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NativeReturn"><span class="annot"><a href="GHC.Cmm.Node.html#NativeReturn"><span class="hs-identifier hs-var">NativeReturn</span></a></span></span><span>
</span><span id="line-442"></span><span>       </span><span class="hs-comment">-- ^ a native return.  The convention for returns depends on</span><span>
</span><span id="line-443"></span><span>       </span><span class="hs-comment">-- how many values are returned: for just one value returned,</span><span>
</span><span id="line-444"></span><span>       </span><span class="hs-comment">-- the appropriate register is used (R1, F1, etc.). regardless</span><span>
</span><span id="line-445"></span><span>       </span><span class="hs-comment">-- of whether it is a real register or not.  For multiple</span><span>
</span><span id="line-446"></span><span>       </span><span class="hs-comment">-- values returned, they are mapped to registers or the stack.</span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Slow"><span class="annot"><a href="GHC.Cmm.Node.html#Slow"><span class="hs-identifier hs-var">Slow</span></a></span></span><span>
</span><span id="line-448"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Slow entry points: all args pushed on the stack</span></span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GC"><span class="annot"><a href="GHC.Cmm.Node.html#GC"><span class="hs-identifier hs-var">GC</span></a></span></span><span>
</span><span id="line-450"></span><span>       </span><span class="hs-comment">-- ^ Entry to the garbage collector: uses the node reg!</span><span>
</span><span id="line-451"></span><span>       </span><span class="hs-comment">-- (TODO: I don't think we need this --SDM)</span><span>
</span><span id="line-452"></span><span>  </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span> </span><span id="local-6989586621682804495"><span id="local-6989586621682804499"><span class="annot"><span class="annottext">Convention -&gt; Convention -&gt; Bool
(Convention -&gt; Convention -&gt; Bool)
-&gt; (Convention -&gt; Convention -&gt; Bool) -&gt; Eq Convention
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Convention -&gt; Convention -&gt; Bool
== :: Convention -&gt; Convention -&gt; Bool
$c/= :: Convention -&gt; Convention -&gt; Bool
/= :: Convention -&gt; Convention -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="hs-keyword">data</span><span> </span><span id="ForeignConvention"><span class="annot"><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-var">ForeignConvention</span></a></span></span><span>
</span><span id="line-455"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ForeignConvention"><span class="annot"><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-var">ForeignConvention</span></a></span></span><span>
</span><span id="line-456"></span><span>        </span><span class="annot"><a href="GHC.Types.ForeignCall.html#CCallConv"><span class="hs-identifier hs-type">CCallConv</span></a></span><span>               </span><span class="hs-comment">-- Which foreign-call convention</span><span>
</span><span id="line-457"></span><span>        </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Type.html#ForeignHint"><span class="hs-identifier hs-type">ForeignHint</span></a></span><span class="hs-special">]</span><span>           </span><span class="hs-comment">-- Extra info about the args</span><span>
</span><span id="line-458"></span><span>        </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Type.html#ForeignHint"><span class="hs-identifier hs-type">ForeignHint</span></a></span><span class="hs-special">]</span><span>           </span><span class="hs-comment">-- Extra info about the result</span><span>
</span><span id="line-459"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmReturnInfo"><span class="hs-identifier hs-type">CmmReturnInfo</span></a></span><span>
</span><span id="line-460"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621682804504"><span id="local-6989586621682804513"><span class="annot"><span class="annottext">ForeignConvention -&gt; ForeignConvention -&gt; Bool
(ForeignConvention -&gt; ForeignConvention -&gt; Bool)
-&gt; (ForeignConvention -&gt; ForeignConvention -&gt; Bool)
-&gt; Eq ForeignConvention
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ForeignConvention -&gt; ForeignConvention -&gt; Bool
== :: ForeignConvention -&gt; ForeignConvention -&gt; Bool
$c/= :: ForeignConvention -&gt; ForeignConvention -&gt; Bool
/= :: ForeignConvention -&gt; ForeignConvention -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-type">ForeignConvention</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-463"></span><span>    </span><span id="local-6989586621682804519"><span class="annot"><span class="annottext">ppr :: ForeignConvention -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignConvention -&gt; SDoc
</span><a href="GHC.Cmm.Node.html#pprForeignConvention"><span class="hs-identifier hs-var">pprForeignConvention</span></a></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="annot"><a href="GHC.Cmm.Node.html#pprForeignConvention"><span class="hs-identifier hs-type">pprForeignConvention</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-type">ForeignConvention</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-466"></span><span id="pprForeignConvention"><span class="annot"><span class="annottext">pprForeignConvention :: ForeignConvention -&gt; SDoc
</span><a href="GHC.Cmm.Node.html#pprForeignConvention"><span class="hs-identifier hs-var hs-var">pprForeignConvention</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-type">ForeignConvention</span></a></span><span> </span><span id="local-6989586621682804521"><span class="annot"><span class="annottext">CCallConv
</span><a href="#local-6989586621682804521"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682804522"><span class="annot"><span class="annottext">[ForeignHint]
</span><a href="#local-6989586621682804522"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682804523"><span class="annot"><span class="annottext">[ForeignHint]
</span><a href="#local-6989586621682804523"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span id="local-6989586621682804524"><span class="annot"><span class="annottext">CmmReturnInfo
</span><a href="#local-6989586621682804524"><span class="hs-identifier hs-var">ret</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-467"></span><span>    </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#doubleQuotes"><span class="hs-identifier hs-var">doubleQuotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CCallConv -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CCallConv
</span><a href="#local-6989586621682804521"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arg hints: &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[ForeignHint] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[ForeignHint]
</span><a href="#local-6989586621682804522"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; result hints: &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[ForeignHint] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[ForeignHint]
</span><a href="#local-6989586621682804523"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReturnInfo -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReturnInfo
</span><a href="#local-6989586621682804524"><span class="hs-identifier hs-var">ret</span></a></span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span class="hs-keyword">data</span><span> </span><span id="CmmReturnInfo"><span class="annot"><a href="GHC.Cmm.Node.html#CmmReturnInfo"><span class="hs-identifier hs-var">CmmReturnInfo</span></a></span></span><span>
</span><span id="line-470"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="CmmMayReturn"><span class="annot"><a href="GHC.Cmm.Node.html#CmmMayReturn"><span class="hs-identifier hs-var">CmmMayReturn</span></a></span></span><span>
</span><span id="line-471"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CmmNeverReturns"><span class="annot"><a href="GHC.Cmm.Node.html#CmmNeverReturns"><span class="hs-identifier hs-var">CmmNeverReturns</span></a></span></span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span> </span><span id="local-6989586621682804529"><span id="local-6989586621682804533"><span class="annot"><span class="annottext">CmmReturnInfo -&gt; CmmReturnInfo -&gt; Bool
(CmmReturnInfo -&gt; CmmReturnInfo -&gt; Bool)
-&gt; (CmmReturnInfo -&gt; CmmReturnInfo -&gt; Bool) -&gt; Eq CmmReturnInfo
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: CmmReturnInfo -&gt; CmmReturnInfo -&gt; Bool
== :: CmmReturnInfo -&gt; CmmReturnInfo -&gt; Bool
$c/= :: CmmReturnInfo -&gt; CmmReturnInfo -&gt; Bool
/= :: CmmReturnInfo -&gt; CmmReturnInfo -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmReturnInfo"><span class="hs-identifier hs-type">CmmReturnInfo</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-475"></span><span>    </span><span id="local-6989586621682804536"><span class="annot"><span class="annottext">ppr :: CmmReturnInfo -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmReturnInfo -&gt; SDoc
</span><a href="GHC.Cmm.Node.html#pprReturnInfo"><span class="hs-identifier hs-var">pprReturnInfo</span></a></span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span class="annot"><a href="GHC.Cmm.Node.html#pprReturnInfo"><span class="hs-identifier hs-type">pprReturnInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmReturnInfo"><span class="hs-identifier hs-type">CmmReturnInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-478"></span><span id="pprReturnInfo"><span class="annot"><span class="annottext">pprReturnInfo :: CmmReturnInfo -&gt; SDoc
</span><a href="GHC.Cmm.Node.html#pprReturnInfo"><span class="hs-identifier hs-var hs-var">pprReturnInfo</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmReturnInfo
</span><a href="GHC.Cmm.Node.html#CmmMayReturn"><span class="hs-identifier hs-var">CmmMayReturn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-479"></span><span class="annot"><a href="GHC.Cmm.Node.html#pprReturnInfo"><span class="hs-identifier hs-var">pprReturnInfo</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReturnInfo
</span><a href="GHC.Cmm.Node.html#CmmNeverReturns"><span class="hs-identifier hs-var">CmmNeverReturns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;never returns&quot;</span></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span class="hs-keyword">data</span><span> </span><span id="ForeignTarget"><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-var">ForeignTarget</span></a></span></span><span>        </span><span class="hs-comment">-- The target of a foreign call</span><span>
</span><span id="line-482"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ForeignTarget"><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-var">ForeignTarget</span></a></span></span><span>                </span><span class="hs-comment">-- A foreign procedure</span><span>
</span><span id="line-483"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>                  </span><span class="hs-comment">-- Its address</span><span>
</span><span id="line-484"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-type">ForeignConvention</span></a></span><span>        </span><span class="hs-comment">-- Its calling convention</span><span>
</span><span id="line-485"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimTarget"><span class="annot"><a href="GHC.Cmm.Node.html#PrimTarget"><span class="hs-identifier hs-var">PrimTarget</span></a></span></span><span>            </span><span class="hs-comment">-- A possibly-side-effecting machine operation</span><span>
</span><span id="line-486"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#CallishMachOp"><span class="hs-identifier hs-type">CallishMachOp</span></a></span><span>            </span><span class="hs-comment">-- Which one</span><span>
</span><span id="line-487"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621682804541"><span id="local-6989586621682804549"><span class="annot"><span class="annottext">ForeignTarget -&gt; ForeignTarget -&gt; Bool
(ForeignTarget -&gt; ForeignTarget -&gt; Bool)
-&gt; (ForeignTarget -&gt; ForeignTarget -&gt; Bool) -&gt; Eq ForeignTarget
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ForeignTarget -&gt; ForeignTarget -&gt; Bool
== :: ForeignTarget -&gt; ForeignTarget -&gt; Bool
$c/= :: ForeignTarget -&gt; ForeignTarget -&gt; Bool
/= :: ForeignTarget -&gt; ForeignTarget -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#OutputableP"><span class="hs-identifier hs-type">OutputableP</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-490"></span><span>    </span><span id="local-6989586621682804552"><span class="annot"><span class="annottext">pdoc :: Platform -&gt; ForeignTarget -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var hs-var hs-var">pdoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ForeignTarget -&gt; SDoc
</span><a href="GHC.Cmm.Node.html#pprForeignTarget"><span class="hs-identifier hs-var">pprForeignTarget</span></a></span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="annot"><a href="GHC.Cmm.Node.html#pprForeignTarget"><span class="hs-identifier hs-type">pprForeignTarget</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-493"></span><span id="pprForeignTarget"><span class="annot"><span class="annottext">pprForeignTarget :: Platform -&gt; ForeignTarget -&gt; SDoc
</span><a href="GHC.Cmm.Node.html#pprForeignTarget"><span class="hs-identifier hs-var hs-var">pprForeignTarget</span></a></span></span><span> </span><span id="local-6989586621682804554"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804554"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span id="local-6989586621682804555"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804555"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621682804556"><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682804556"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-494"></span><span>    </span><span class="annot"><span class="annottext">ForeignConvention -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682804556"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; SDoc
</span><a href="#local-6989586621682804557"><span class="hs-identifier hs-var">ppr_target</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804555"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-496"></span><span>    </span><span class="annot"><a href="#local-6989586621682804557"><span class="hs-identifier hs-type">ppr_target</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-497"></span><span>    </span><span id="local-6989586621682804557"><span class="annot"><span class="annottext">ppr_target :: CmmExpr -&gt; SDoc
</span><a href="#local-6989586621682804557"><span class="hs-identifier hs-var hs-var">ppr_target</span></a></span></span><span> </span><span id="local-6989586621682804558"><span class="annot"><span class="annottext">t :: CmmExpr
</span><a href="#local-6989586621682804558"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804554"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804558"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><a href="#local-6989586621682804557"><span class="hs-identifier hs-var">ppr_target</span></a></span><span> </span><span id="local-6989586621682804559"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804559"><span class="hs-identifier hs-var">fn'</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804554"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804559"><span class="hs-identifier hs-var">fn'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span class="annot"><a href="GHC.Cmm.Node.html#pprForeignTarget"><span class="hs-identifier hs-var">pprForeignTarget</span></a></span><span> </span><span id="local-6989586621682804560"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804560"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#PrimTarget"><span class="hs-identifier hs-type">PrimTarget</span></a></span><span> </span><span id="local-6989586621682804561"><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682804561"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span> </span><span class="hs-comment">-- HACK: We're just using a ForeignLabel to get this printed, the label</span><span>
</span><span id="line-501"></span><span> </span><span class="hs-comment">--       might not really be foreign.</span><span>
</span><span id="line-502"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CLabel -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804560"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-503"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; ForeignLabelSource -&gt; FunctionOrData -&gt; CLabel
</span><a href="GHC.Cmm.CLabel.html#mkForeignLabel"><span class="hs-identifier hs-var">mkForeignLabel</span></a></span><span>
</span><span id="line-504"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallishMachOp -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682804561"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>                          </span><span class="annot"><span class="annottext">ForeignLabelSource
</span><a href="GHC.Cmm.CLabel.html#ForeignLabelInThisPackage"><span class="hs-identifier hs-var">ForeignLabelInThisPackage</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionOrData
</span><a href="GHC.Types.Basic.html#IsFunction"><span class="hs-identifier hs-var">IsFunction</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#Convention"><span class="hs-identifier hs-type">Convention</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-508"></span><span>  </span><span id="local-6989586621682804569"><span class="annot"><span class="annottext">ppr :: Convention -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Convention -&gt; SDoc
</span><a href="GHC.Cmm.Node.html#pprConvention"><span class="hs-identifier hs-var">pprConvention</span></a></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="annot"><a href="GHC.Cmm.Node.html#pprConvention"><span class="hs-identifier hs-type">pprConvention</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#Convention"><span class="hs-identifier hs-type">Convention</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-511"></span><span id="pprConvention"><span class="annot"><span class="annottext">pprConvention :: Convention -&gt; SDoc
</span><a href="GHC.Cmm.Node.html#pprConvention"><span class="hs-identifier hs-var hs-var">pprConvention</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#NativeNodeCall"><span class="hs-identifier hs-type">NativeNodeCall</span></a></span><span>   </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;native-node-call-convention&gt;&quot;</span></span><span>
</span><span id="line-512"></span><span class="annot"><a href="GHC.Cmm.Node.html#pprConvention"><span class="hs-identifier hs-var">pprConvention</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#NativeDirectCall"><span class="hs-identifier hs-type">NativeDirectCall</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;native-direct-call-convention&gt;&quot;</span></span><span>
</span><span id="line-513"></span><span class="annot"><a href="GHC.Cmm.Node.html#pprConvention"><span class="hs-identifier hs-var">pprConvention</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#NativeReturn"><span class="hs-identifier hs-type">NativeReturn</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;native-ret-convention&gt;&quot;</span></span><span>
</span><span id="line-514"></span><span class="annot"><a href="GHC.Cmm.Node.html#pprConvention"><span class="hs-identifier hs-var">pprConvention</span></a></span><span>  </span><span class="annot"><span class="annottext">Convention
</span><a href="GHC.Cmm.Node.html#Slow"><span class="hs-identifier hs-var">Slow</span></a></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;slow-convention&gt;&quot;</span></span><span>
</span><span id="line-515"></span><span class="annot"><a href="GHC.Cmm.Node.html#pprConvention"><span class="hs-identifier hs-var">pprConvention</span></a></span><span>  </span><span class="annot"><span class="annottext">Convention
</span><a href="GHC.Cmm.Node.html#GC"><span class="hs-identifier hs-var">GC</span></a></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;gc-convention&gt;&quot;</span></span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span class="annot"><a href="GHC.Cmm.Node.html#foreignTargetHints"><span class="hs-identifier hs-type">foreignTargetHints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Type.html#ForeignHint"><span class="hs-identifier hs-type">ForeignHint</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Type.html#ForeignHint"><span class="hs-identifier hs-type">ForeignHint</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span id="foreignTargetHints"><span class="annot"><span class="annottext">foreignTargetHints :: ForeignTarget -&gt; ([ForeignHint], [ForeignHint])
</span><a href="GHC.Cmm.Node.html#foreignTargetHints"><span class="hs-identifier hs-var hs-var">foreignTargetHints</span></a></span></span><span> </span><span id="local-6989586621682804571"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804571"><span class="hs-identifier hs-var">target</span></a></span></span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[ForeignHint]
</span><a href="#local-6989586621682804572"><span class="hs-identifier hs-var">res_hints</span></a></span><span> </span><span class="annot"><span class="annottext">[ForeignHint] -&gt; [ForeignHint] -&gt; [ForeignHint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ForeignHint -&gt; [ForeignHint]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">ForeignHint
</span><a href="GHC.Cmm.Type.html#NoHint"><span class="hs-identifier hs-var">NoHint</span></a></span><span>
</span><span id="line-521"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ForeignHint]
</span><a href="#local-6989586621682804575"><span class="hs-identifier hs-var">arg_hints</span></a></span><span> </span><span class="annot"><span class="annottext">[ForeignHint] -&gt; [ForeignHint] -&gt; [ForeignHint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ForeignHint -&gt; [ForeignHint]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">ForeignHint
</span><a href="GHC.Cmm.Type.html#NoHint"><span class="hs-identifier hs-var">NoHint</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-523"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682804572"><span class="annot"><span class="annottext">[ForeignHint]
</span><a href="#local-6989586621682804572"><span class="hs-identifier hs-var">res_hints</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682804575"><span class="annot"><span class="annottext">[ForeignHint]
</span><a href="#local-6989586621682804575"><span class="hs-identifier hs-var">arg_hints</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-524"></span><span>       </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804571"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-525"></span><span>          </span><span class="annot"><a href="GHC.Cmm.Node.html#PrimTarget"><span class="hs-identifier hs-type">PrimTarget</span></a></span><span> </span><span id="local-6989586621682804576"><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682804576"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CallishMachOp -&gt; ([ForeignHint], [ForeignHint])
</span><a href="GHC.Cmm.MachOp.html#callishMachOpHints"><span class="hs-identifier hs-var">callishMachOpHints</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682804576"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-526"></span><span>          </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-type">ForeignConvention</span></a></span><span> </span><span class="annot"><span class="annottext">CCallConv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682804578"><span class="annot"><span class="annottext">[ForeignHint]
</span><a href="#local-6989586621682804578"><span class="hs-identifier hs-var">arg_hints</span></a></span></span><span> </span><span id="local-6989586621682804579"><span class="annot"><span class="annottext">[ForeignHint]
</span><a href="#local-6989586621682804579"><span class="hs-identifier hs-var">res_hints</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmReturnInfo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-527"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ForeignHint]
</span><a href="#local-6989586621682804579"><span class="hs-identifier hs-var">res_hints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ForeignHint]
</span><a href="#local-6989586621682804578"><span class="hs-identifier hs-var">arg_hints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>
</span><span id="line-529"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-530"></span><span class="hs-comment">-- Instances of register and slot users / definers</span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682803639"><span id="local-6989586621682803640"><span class="annot"><a href="GHC.Cmm.Expr.html#UserOfRegs"><span class="hs-identifier hs-type">UserOfRegs</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803639"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803640"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-533"></span><span>  </span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#foldRegsUsed"><span class="hs-pragma hs-type">foldRegsUsed</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-534"></span><span>  </span><span id="local-6989586621682804587"><span class="annot"><span class="annottext">foldRegsUsed :: forall b.
Platform -&gt; (b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; CmmNode e x -&gt; b
</span><a href="GHC.Cmm.Expr.html#foldRegsUsed"><span class="hs-identifier hs-var hs-var hs-var">foldRegsUsed</span></a></span></span><span> </span><span id="local-6989586621682804588"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804588"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682804589"><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804589"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682804590"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804590"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621682804591"><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682804591"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682804591"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-535"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmAssign"><span class="hs-identifier hs-type">CmmAssign</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682804599"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804599"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; CmmExpr -&gt; b
forall a b.
UserOfRegs CmmFormal a =&gt;
(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804600"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804589"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804590"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804599"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-536"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmStore"><span class="hs-identifier hs-type">CmmStore</span></a></span><span> </span><span id="local-6989586621682804607"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804607"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682804608"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804608"><span class="hs-identifier hs-var">rval</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; CmmExpr -&gt; b
forall a b.
UserOfRegs CmmFormal a =&gt;
(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804600"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804589"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; CmmExpr -&gt; b
forall a b.
UserOfRegs CmmFormal a =&gt;
(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804600"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804589"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804590"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804607"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804608"><span class="hs-identifier hs-var">rval</span></a></span><span>
</span><span id="line-537"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnsafeForeignCall"><span class="hs-identifier hs-type">CmmUnsafeForeignCall</span></a></span><span> </span><span id="local-6989586621682804618"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804618"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682804619"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804619"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; [CmmExpr] -&gt; b
forall a b.
UserOfRegs CmmFormal a =&gt;
(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804600"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804589"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; ForeignTarget -&gt; b
forall a b.
UserOfRegs CmmFormal a =&gt;
(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804600"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804589"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804590"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804618"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804619"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-538"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-type">CmmCondBranch</span></a></span><span> </span><span id="local-6989586621682804625"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804625"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; CmmExpr -&gt; b
forall a b.
UserOfRegs CmmFormal a =&gt;
(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804600"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804589"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804590"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804625"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-539"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-type">CmmSwitch</span></a></span><span> </span><span id="local-6989586621682804631"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804631"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; CmmExpr -&gt; b
forall a b.
UserOfRegs CmmFormal a =&gt;
(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804600"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804589"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804590"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804631"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-540"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCall"><span class="hs-identifier hs-type">CmmCall</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">cml_target :: CmmNode 'Open 'Closed -&gt; CmmExpr
</span><a href="GHC.Cmm.Node.html#cml_target"><span class="hs-identifier hs-var">cml_target</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804637"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804637"><span class="hs-identifier hs-var">tgt</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; CmmExpr -&gt; b
forall a b.
UserOfRegs CmmFormal a =&gt;
(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804600"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804589"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804590"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804637"><span class="hs-identifier hs-var">tgt</span></a></span><span>
</span><span id="line-541"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmForeignCall"><span class="hs-identifier hs-type">CmmForeignCall</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">tgt :: CmmNode 'Open 'Closed -&gt; ForeignTarget
</span><a href="GHC.Cmm.Node.html#tgt"><span class="hs-identifier hs-var">tgt</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804645"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804645"><span class="hs-identifier hs-var">tgt</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">args :: CmmNode 'Open 'Closed -&gt; [CmmExpr]
</span><a href="GHC.Cmm.Node.html#args"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804646"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804646"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; [CmmExpr] -&gt; b
forall a b.
UserOfRegs CmmFormal a =&gt;
(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804600"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804589"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; ForeignTarget -&gt; b
forall a b.
UserOfRegs CmmFormal a =&gt;
(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804600"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804589"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804590"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804645"><span class="hs-identifier hs-var">tgt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804646"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-542"></span><span>    </span><span class="annot"><span class="annottext">CmmNode e x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804590"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-543"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="#local-6989586621682804600"><span class="hs-identifier hs-type">fold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682803643"><span class="annot"><a href="#local-6989586621682803643"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621682803644"><span class="annot"><a href="#local-6989586621682803644"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#UserOfRegs"><span class="hs-identifier hs-type">UserOfRegs</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803643"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-544"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682803644"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803644"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803644"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803643"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803644"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-545"></span><span>          </span><span id="local-6989586621682804600"><span class="annot"><span class="annottext">fold :: forall a b.
UserOfRegs CmmFormal a =&gt;
(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804600"><span class="hs-identifier hs-var hs-var">fold</span></a></span></span><span> </span><span id="local-6989586621682804649"><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804649"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682804650"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804650"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621682804651"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682804651"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; (b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
forall b. Platform -&gt; (b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
forall r a b.
UserOfRegs r a =&gt;
Platform -&gt; (b -&gt; r -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="GHC.Cmm.Expr.html#foldRegsUsed"><span class="hs-identifier hs-var">foldRegsUsed</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804588"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804649"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804650"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682804651"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682803652"><span id="local-6989586621682803653"><span class="annot"><a href="GHC.Cmm.Expr.html#UserOfRegs"><span class="hs-identifier hs-type">UserOfRegs</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-type">GlobalRegUse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803652"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803653"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-548"></span><span>  </span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#foldRegsUsed"><span class="hs-pragma hs-type">foldRegsUsed</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-549"></span><span>  </span><span id="local-6989586621682804657"><span class="annot"><span class="annottext">foldRegsUsed :: forall b.
Platform -&gt; (b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; CmmNode e x -&gt; b
</span><a href="GHC.Cmm.Expr.html#foldRegsUsed"><span class="hs-identifier hs-var hs-var hs-var">foldRegsUsed</span></a></span></span><span> </span><span id="local-6989586621682804658"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804658"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682804659"><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804659"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682804660"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804660"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621682804661"><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682804661"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682804661"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-550"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmAssign"><span class="hs-identifier hs-type">CmmAssign</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682804668"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804668"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; CmmExpr -&gt; b
forall a b.
UserOfRegs GlobalRegUse a =&gt;
(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804669"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804660"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804668"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-551"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmStore"><span class="hs-identifier hs-type">CmmStore</span></a></span><span> </span><span id="local-6989586621682804676"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804676"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682804677"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804677"><span class="hs-identifier hs-var">rval</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; CmmExpr -&gt; b
forall a b.
UserOfRegs GlobalRegUse a =&gt;
(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804669"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; CmmExpr -&gt; b
forall a b.
UserOfRegs GlobalRegUse a =&gt;
(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804669"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804660"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804676"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804677"><span class="hs-identifier hs-var">rval</span></a></span><span>
</span><span id="line-552"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnsafeForeignCall"><span class="hs-identifier hs-type">CmmUnsafeForeignCall</span></a></span><span> </span><span id="local-6989586621682804685"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804685"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682804686"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804686"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; [CmmExpr] -&gt; b
forall a b.
UserOfRegs GlobalRegUse a =&gt;
(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804669"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; ForeignTarget -&gt; b
forall a b.
UserOfRegs GlobalRegUse a =&gt;
(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804669"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804660"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804685"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804686"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-553"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-type">CmmCondBranch</span></a></span><span> </span><span id="local-6989586621682804692"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804692"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; CmmExpr -&gt; b
forall a b.
UserOfRegs GlobalRegUse a =&gt;
(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804669"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804660"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804692"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-554"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-type">CmmSwitch</span></a></span><span> </span><span id="local-6989586621682804698"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804698"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; CmmExpr -&gt; b
forall a b.
UserOfRegs GlobalRegUse a =&gt;
(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804669"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804660"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804698"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-555"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCall"><span class="hs-identifier hs-type">CmmCall</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">cml_target :: CmmNode 'Open 'Closed -&gt; CmmExpr
</span><a href="GHC.Cmm.Node.html#cml_target"><span class="hs-identifier hs-var">cml_target</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804707"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804707"><span class="hs-identifier hs-var">tgt</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cml_args_regs :: CmmNode 'Open 'Closed -&gt; [GlobalRegUse]
</span><a href="GHC.Cmm.Node.html#cml_args_regs"><span class="hs-identifier hs-var">cml_args_regs</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804708"><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682804708"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; CmmExpr -&gt; b
forall a b.
UserOfRegs GlobalRegUse a =&gt;
(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804669"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; [GlobalRegUse] -&gt; b
forall a b.
UserOfRegs GlobalRegUse a =&gt;
(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804669"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804660"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682804708"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804707"><span class="hs-identifier hs-var">tgt</span></a></span><span>
</span><span id="line-556"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmForeignCall"><span class="hs-identifier hs-type">CmmForeignCall</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">tgt :: CmmNode 'Open 'Closed -&gt; ForeignTarget
</span><a href="GHC.Cmm.Node.html#tgt"><span class="hs-identifier hs-var">tgt</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804716"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804716"><span class="hs-identifier hs-var">tgt</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">args :: CmmNode 'Open 'Closed -&gt; [CmmExpr]
</span><a href="GHC.Cmm.Node.html#args"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804717"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804717"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; [CmmExpr] -&gt; b
forall a b.
UserOfRegs GlobalRegUse a =&gt;
(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804669"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; ForeignTarget -&gt; b
forall a b.
UserOfRegs GlobalRegUse a =&gt;
(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804669"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804660"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804716"><span class="hs-identifier hs-var">tgt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804717"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-557"></span><span>    </span><span class="annot"><span class="annottext">CmmNode e x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804660"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-558"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="#local-6989586621682804669"><span class="hs-identifier hs-type">fold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682803655"><span class="annot"><a href="#local-6989586621682803655"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621682803656"><span class="annot"><a href="#local-6989586621682803656"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span>  </span><span class="annot"><a href="GHC.Cmm.Expr.html#UserOfRegs"><span class="hs-identifier hs-type">UserOfRegs</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-type">GlobalRegUse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803655"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-559"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682803656"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-type">GlobalRegUse</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803656"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803656"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803655"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803656"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-560"></span><span>          </span><span id="local-6989586621682804669"><span class="annot"><span class="annottext">fold :: forall a b.
UserOfRegs GlobalRegUse a =&gt;
(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804669"><span class="hs-identifier hs-var hs-var">fold</span></a></span></span><span> </span><span id="local-6989586621682804720"><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804720"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682804721"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804721"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621682804722"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682804722"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; (b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
forall b. Platform -&gt; (b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
forall r a b.
UserOfRegs r a =&gt;
Platform -&gt; (b -&gt; r -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="GHC.Cmm.Expr.html#foldRegsUsed"><span class="hs-identifier hs-var">foldRegsUsed</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804658"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804720"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804721"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682804722"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-561"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682803647"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621682803647"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#UserOfRegs"><span class="hs-identifier hs-type">UserOfRegs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803647"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#UserOfRegs"><span class="hs-identifier hs-type">UserOfRegs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803647"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-562"></span><span>  </span><span class="hs-comment">-- The (Ord r) in the context is necessary here</span><span>
</span><span id="line-563"></span><span>  </span><span class="hs-comment">-- See Note [Recursive superclasses] in GHC.Tc.TyCl.Instance</span><span>
</span><span id="line-564"></span><span>  </span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#foldRegsUsed"><span class="hs-pragma hs-type">foldRegsUsed</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-565"></span><span>  </span><span id="local-6989586621682804729"><span class="annot"><span class="annottext">foldRegsUsed :: forall b. Platform -&gt; (b -&gt; r -&gt; b) -&gt; b -&gt; ForeignTarget -&gt; b
</span><a href="GHC.Cmm.Expr.html#foldRegsUsed"><span class="hs-identifier hs-var hs-var hs-var">foldRegsUsed</span></a></span></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span class="annot"><span class="annottext">b -&gt; r -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682804730"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804730"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#PrimTarget"><span class="hs-identifier hs-type">PrimTarget</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804730"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-566"></span><span>  </span><span class="annot"><a href="GHC.Cmm.Expr.html#foldRegsUsed"><span class="hs-identifier hs-var">foldRegsUsed</span></a></span><span> </span><span id="local-6989586621682804731"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804731"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682804732"><span class="annot"><span class="annottext">b -&gt; r -&gt; b
</span><a href="#local-6989586621682804732"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682804733"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804733"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span id="local-6989586621682804734"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804734"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForeignConvention
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; (b -&gt; r -&gt; b) -&gt; b -&gt; CmmExpr -&gt; b
forall b. Platform -&gt; (b -&gt; r -&gt; b) -&gt; b -&gt; CmmExpr -&gt; b
forall r a b.
UserOfRegs r a =&gt;
Platform -&gt; (b -&gt; r -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="GHC.Cmm.Expr.html#foldRegsUsed"><span class="hs-identifier hs-var">foldRegsUsed</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804731"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; r -&gt; b
</span><a href="#local-6989586621682804732"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804733"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804734"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-567"></span><span>
</span><span id="line-568"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682803668"><span id="local-6989586621682803669"><span class="annot"><a href="GHC.Cmm.Expr.html#DefinerOfRegs"><span class="hs-identifier hs-type">DefinerOfRegs</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803668"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803669"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-569"></span><span>  </span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#foldRegsDefd"><span class="hs-pragma hs-type">foldRegsDefd</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-570"></span><span>  </span><span id="local-6989586621682804741"><span class="annot"><span class="annottext">foldRegsDefd :: forall b.
Platform -&gt; (b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; CmmNode e x -&gt; b
</span><a href="GHC.Cmm.Expr.html#foldRegsDefd"><span class="hs-identifier hs-var hs-var hs-var">foldRegsDefd</span></a></span></span><span> </span><span id="local-6989586621682804742"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804742"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682804743"><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804743"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682804744"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804744"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621682804745"><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682804745"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682804745"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-571"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmAssign"><span class="hs-identifier hs-type">CmmAssign</span></a></span><span> </span><span id="local-6989586621682804750"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682804750"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; CmmReg -&gt; b
forall a b.
DefinerOfRegs CmmFormal a =&gt;
(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804751"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804743"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804744"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682804750"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-572"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnsafeForeignCall"><span class="hs-identifier hs-type">CmmUnsafeForeignCall</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682804759"><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682804759"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; [CmmFormal] -&gt; b
forall a b.
DefinerOfRegs CmmFormal a =&gt;
(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804751"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804743"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804744"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682804759"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-573"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmForeignCall"><span class="hs-identifier hs-type">CmmForeignCall</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">res :: CmmNode 'Open 'Closed -&gt; [CmmFormal]
</span><a href="GHC.Cmm.Node.html#res"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804765"><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682804765"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; [CmmFormal] -&gt; b
forall a b.
DefinerOfRegs CmmFormal a =&gt;
(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804751"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804743"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804744"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682804765"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-574"></span><span>    </span><span class="annot"><span class="annottext">CmmNode e x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804744"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-575"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="#local-6989586621682804751"><span class="hs-identifier hs-type">fold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682803671"><span class="annot"><a href="#local-6989586621682803671"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621682803672"><span class="annot"><a href="#local-6989586621682803672"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#DefinerOfRegs"><span class="hs-identifier hs-type">DefinerOfRegs</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803671"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-576"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682803672"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803672"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803672"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803671"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803672"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-577"></span><span>          </span><span id="local-6989586621682804751"><span class="annot"><span class="annottext">fold :: forall a b.
DefinerOfRegs CmmFormal a =&gt;
(b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804751"><span class="hs-identifier hs-var hs-var">fold</span></a></span></span><span> </span><span id="local-6989586621682804768"><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804768"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682804769"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804769"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621682804770"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682804770"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; (b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
forall b. Platform -&gt; (b -&gt; CmmFormal -&gt; b) -&gt; b -&gt; a -&gt; b
forall r a b.
DefinerOfRegs r a =&gt;
Platform -&gt; (b -&gt; r -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="GHC.Cmm.Expr.html#foldRegsDefd"><span class="hs-identifier hs-var">foldRegsDefd</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804742"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; CmmFormal -&gt; b
</span><a href="#local-6989586621682804768"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804769"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682804770"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682803680"><span id="local-6989586621682803681"><span class="annot"><a href="GHC.Cmm.Expr.html#DefinerOfRegs"><span class="hs-identifier hs-type">DefinerOfRegs</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-type">GlobalRegUse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803680"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803681"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-580"></span><span>  </span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#foldRegsDefd"><span class="hs-pragma hs-type">foldRegsDefd</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-581"></span><span>  </span><span id="local-6989586621682804775"><span class="annot"><span class="annottext">foldRegsDefd :: forall b.
Platform -&gt; (b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; CmmNode e x -&gt; b
</span><a href="GHC.Cmm.Expr.html#foldRegsDefd"><span class="hs-identifier hs-var hs-var hs-var">foldRegsDefd</span></a></span></span><span> </span><span id="local-6989586621682804776"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804776"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682804777"><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804777"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682804778"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804778"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621682804779"><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682804779"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682804779"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-582"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmAssign"><span class="hs-identifier hs-type">CmmAssign</span></a></span><span> </span><span id="local-6989586621682804784"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682804784"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; CmmReg -&gt; b
forall a b.
DefinerOfRegs GlobalRegUse a =&gt;
(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804785"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804777"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804778"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682804784"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-583"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnsafeForeignCall"><span class="hs-identifier hs-type">CmmUnsafeForeignCall</span></a></span><span> </span><span id="local-6989586621682804791"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804791"><span class="hs-identifier hs-var">tgt</span></a></span></span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; [GlobalRegUse] -&gt; b
forall a b.
DefinerOfRegs GlobalRegUse a =&gt;
(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804785"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804777"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804778"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignTarget -&gt; [GlobalRegUse]
</span><a href="#local-6989586621682804792"><span class="hs-identifier hs-var">foreignTargetRegs</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804791"><span class="hs-identifier hs-var">tgt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-584"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCall"><span class="hs-identifier hs-type">CmmCall</span></a></span><span>        </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; [GlobalRegUse] -&gt; b
forall a b.
DefinerOfRegs GlobalRegUse a =&gt;
(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804785"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804777"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804778"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682804798"><span class="hs-identifier hs-var">activeRegs</span></a></span><span>
</span><span id="line-585"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmForeignCall"><span class="hs-identifier hs-type">CmmForeignCall</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; [GlobalRegUse] -&gt; b
forall a b.
DefinerOfRegs GlobalRegUse a =&gt;
(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804785"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804777"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804778"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682804798"><span class="hs-identifier hs-var">activeRegs</span></a></span><span>
</span><span id="line-586"></span><span>                      </span><span class="hs-comment">-- See Note [Safe foreign calls clobber STG registers]</span><span>
</span><span id="line-587"></span><span>    </span><span class="annot"><span class="annottext">CmmNode e x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804778"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-588"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="#local-6989586621682804785"><span class="hs-identifier hs-type">fold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682803683"><span class="annot"><a href="#local-6989586621682803683"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621682803684"><span class="annot"><a href="#local-6989586621682803684"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#DefinerOfRegs"><span class="hs-identifier hs-type">DefinerOfRegs</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-type">GlobalRegUse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803683"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-589"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682803684"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-type">GlobalRegUse</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803684"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803684"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803683"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803684"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-590"></span><span>          </span><span id="local-6989586621682804785"><span class="annot"><span class="annottext">fold :: forall a b.
DefinerOfRegs GlobalRegUse a =&gt;
(b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621682804785"><span class="hs-identifier hs-var hs-var">fold</span></a></span></span><span> </span><span id="local-6989586621682804806"><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804806"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682804807"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804807"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621682804808"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682804808"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; (b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
forall b. Platform -&gt; (b -&gt; GlobalRegUse -&gt; b) -&gt; b -&gt; a -&gt; b
forall r a b.
DefinerOfRegs r a =&gt;
Platform -&gt; (b -&gt; r -&gt; b) -&gt; b -&gt; a -&gt; b
</span><a href="GHC.Cmm.Expr.html#foldRegsDefd"><span class="hs-identifier hs-var">foldRegsDefd</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804776"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; GlobalRegUse -&gt; b
</span><a href="#local-6989586621682804806"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682804807"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682804808"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span>          </span><span class="annot"><a href="#local-6989586621682804798"><span class="hs-identifier hs-type">activeRegs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-type">GlobalRegUse</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-593"></span><span>          </span><span id="local-6989586621682804798"><span class="annot"><span class="annottext">activeRegs :: [GlobalRegUse]
</span><a href="#local-6989586621682804798"><span class="hs-identifier hs-var hs-var">activeRegs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GlobalReg -&gt; GlobalRegUse) -&gt; [GlobalReg] -&gt; [GlobalRegUse]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682804809"><span class="annot"><span class="annottext">GlobalReg
</span><a href="#local-6989586621682804809"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GlobalReg -&gt; CmmType -&gt; GlobalRegUse
</span><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-var">GlobalRegUse</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="#local-6989586621682804809"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; GlobalReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#globalRegSpillType"><span class="hs-identifier hs-var">globalRegSpillType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804776"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="#local-6989586621682804809"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([GlobalReg] -&gt; [GlobalRegUse]) -&gt; [GlobalReg] -&gt; [GlobalRegUse]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; [GlobalReg]
</span><a href="GHC.Platform.Regs.html#activeStgRegs"><span class="hs-identifier hs-var">activeStgRegs</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804776"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-594"></span><span>          </span><span id="local-6989586621682804813"><span class="annot"><span class="annottext">activeCallerSavesRegs :: [GlobalRegUse]
</span><a href="#local-6989586621682804813"><span class="hs-identifier hs-var hs-var">activeCallerSavesRegs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GlobalRegUse -&gt; Bool) -&gt; [GlobalRegUse] -&gt; [GlobalRegUse]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; GlobalReg -&gt; Bool
</span><a href="GHC.Platform.Regs.html#callerSaves"><span class="hs-identifier hs-var">callerSaves</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682804776"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">(GlobalReg -&gt; Bool)
-&gt; (GlobalRegUse -&gt; GlobalReg) -&gt; GlobalRegUse -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GlobalRegUse -&gt; GlobalReg
</span><a href="GHC.Cmm.Reg.html#globalRegUse_reg"><span class="hs-identifier hs-var">globalRegUse_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682804798"><span class="hs-identifier hs-var">activeRegs</span></a></span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span>          </span><span id="local-6989586621682804792"><span class="annot"><span class="annottext">foreignTargetRegs :: ForeignTarget -&gt; [GlobalRegUse]
</span><a href="#local-6989586621682804792"><span class="hs-identifier hs-var hs-var">foreignTargetRegs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-type">ForeignConvention</span></a></span><span> </span><span class="annot"><span class="annottext">CCallConv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ForeignHint]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ForeignHint]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmReturnInfo
</span><a href="GHC.Cmm.Node.html#CmmNeverReturns"><span class="hs-identifier hs-var">CmmNeverReturns</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-597"></span><span>          </span><span class="annot"><a href="#local-6989586621682804792"><span class="hs-identifier hs-var">foreignTargetRegs</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682804813"><span class="hs-identifier hs-var">activeCallerSavesRegs</span></a></span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="hs-comment">-- Note [Safe foreign calls clobber STG registers]</span><span>
</span><span id="line-600"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-601"></span><span class="hs-comment">-- During stack layout phase every safe foreign call is expanded into a block</span><span>
</span><span id="line-602"></span><span class="hs-comment">-- that contains unsafe foreign call (instead of safe foreign call) and ends</span><span>
</span><span id="line-603"></span><span class="hs-comment">-- with a normal call (See Note [Foreign calls]). This means that we must</span><span>
</span><span id="line-604"></span><span class="hs-comment">-- treat safe foreign call as if it was a normal call (because eventually it</span><span>
</span><span id="line-605"></span><span class="hs-comment">-- will be). This is important if we try to run sinking pass before stack</span><span>
</span><span id="line-606"></span><span class="hs-comment">-- layout phase. Consider this example of what might go wrong (this is cmm</span><span>
</span><span id="line-607"></span><span class="hs-comment">-- code from stablename001 test). Here is code after common block elimination</span><span>
</span><span id="line-608"></span><span class="hs-comment">-- (before stack layout):</span><span>
</span><span id="line-609"></span><span class="hs-comment">--</span><span>
</span><span id="line-610"></span><span class="hs-comment">--  c1q6:</span><span>
</span><span id="line-611"></span><span class="hs-comment">--      _s1pf::P64 = R1;</span><span>
</span><span id="line-612"></span><span class="hs-comment">--      _c1q8::I64 = performMajorGC;</span><span>
</span><span id="line-613"></span><span class="hs-comment">--      I64[(young&lt;c1q9&gt; + 8)] = c1q9;</span><span>
</span><span id="line-614"></span><span class="hs-comment">--      foreign call &quot;ccall&quot; arg hints:  []  result hints:  [] (_c1q8::I64)(...)</span><span>
</span><span id="line-615"></span><span class="hs-comment">--                   returns to c1q9 args: ([]) ress: ([])ret_args: 8ret_off: 8;</span><span>
</span><span id="line-616"></span><span class="hs-comment">--  c1q9:</span><span>
</span><span id="line-617"></span><span class="hs-comment">--      I64[(young&lt;c1qb&gt; + 8)] = c1qb;</span><span>
</span><span id="line-618"></span><span class="hs-comment">--      R1 = _s1pc::P64;</span><span>
</span><span id="line-619"></span><span class="hs-comment">--      call stg_makeStableName#(R1) returns to c1qb, args: 8, res: 8, upd: 8;</span><span>
</span><span id="line-620"></span><span class="hs-comment">--</span><span>
</span><span id="line-621"></span><span class="hs-comment">-- If we run sinking pass now (still before stack layout) we will get this:</span><span>
</span><span id="line-622"></span><span class="hs-comment">--</span><span>
</span><span id="line-623"></span><span class="hs-comment">--  c1q6:</span><span>
</span><span id="line-624"></span><span class="hs-comment">--      I64[(young&lt;c1q9&gt; + 8)] = c1q9;</span><span>
</span><span id="line-625"></span><span class="hs-comment">--      foreign call &quot;ccall&quot; arg hints:  []  result hints:  [] performMajorGC(...)</span><span>
</span><span id="line-626"></span><span class="hs-comment">--                   returns to c1q9 args: ([]) ress: ([])ret_args: 8ret_off: 8;</span><span>
</span><span id="line-627"></span><span class="hs-comment">--  c1q9:</span><span>
</span><span id="line-628"></span><span class="hs-comment">--      I64[(young&lt;c1qb&gt; + 8)] = c1qb;</span><span>
</span><span id="line-629"></span><span class="hs-comment">--      _s1pf::P64 = R1;         &lt;------ _s1pf sunk past safe foreign call</span><span>
</span><span id="line-630"></span><span class="hs-comment">--      R1 = _s1pc::P64;</span><span>
</span><span id="line-631"></span><span class="hs-comment">--      call stg_makeStableName#(R1) returns to c1qb, args: 8, res: 8, upd: 8;</span><span>
</span><span id="line-632"></span><span class="hs-comment">--</span><span>
</span><span id="line-633"></span><span class="hs-comment">-- Notice that _s1pf was sunk past a foreign call. When we run stack layout</span><span>
</span><span id="line-634"></span><span class="hs-comment">-- safe call to performMajorGC will be turned into:</span><span>
</span><span id="line-635"></span><span class="hs-comment">--</span><span>
</span><span id="line-636"></span><span class="hs-comment">--  c1q6:</span><span>
</span><span id="line-637"></span><span class="hs-comment">--      _s1pc::P64 = P64[Sp + 8];</span><span>
</span><span id="line-638"></span><span class="hs-comment">--      I64[Sp - 8] = c1q9;</span><span>
</span><span id="line-639"></span><span class="hs-comment">--      Sp = Sp - 8;</span><span>
</span><span id="line-640"></span><span class="hs-comment">--      I64[I64[CurrentTSO + 24] + 16] = Sp;</span><span>
</span><span id="line-641"></span><span class="hs-comment">--      P64[CurrentNursery + 8] = Hp + 8;</span><span>
</span><span id="line-642"></span><span class="hs-comment">--      (_u1qI::I64) = call &quot;ccall&quot; arg hints:  [PtrHint,]</span><span>
</span><span id="line-643"></span><span class="hs-comment">--                           result hints:  [PtrHint] suspendThread(BaseReg, 0);</span><span>
</span><span id="line-644"></span><span class="hs-comment">--      call &quot;ccall&quot; arg hints:  []  result hints:  [] performMajorGC();</span><span>
</span><span id="line-645"></span><span class="hs-comment">--      (_u1qJ::I64) = call &quot;ccall&quot; arg hints:  [PtrHint]</span><span>
</span><span id="line-646"></span><span class="hs-comment">--                           result hints:  [PtrHint] resumeThread(_u1qI::I64);</span><span>
</span><span id="line-647"></span><span class="hs-comment">--      BaseReg = _u1qJ::I64;</span><span>
</span><span id="line-648"></span><span class="hs-comment">--      _u1qK::P64 = CurrentTSO;</span><span>
</span><span id="line-649"></span><span class="hs-comment">--      _u1qL::P64 = I64[_u1qK::P64 + 24];</span><span>
</span><span id="line-650"></span><span class="hs-comment">--      Sp = I64[_u1qL::P64 + 16];</span><span>
</span><span id="line-651"></span><span class="hs-comment">--      SpLim = _u1qL::P64 + 192;</span><span>
</span><span id="line-652"></span><span class="hs-comment">--      HpAlloc = 0;</span><span>
</span><span id="line-653"></span><span class="hs-comment">--      Hp = I64[CurrentNursery + 8] - 8;</span><span>
</span><span id="line-654"></span><span class="hs-comment">--      HpLim = I64[CurrentNursery] + (%MO_SS_Conv_W32_W64(I32[CurrentNursery + 48]) * 4096 - 1);</span><span>
</span><span id="line-655"></span><span class="hs-comment">--      call (I64[Sp])() returns to c1q9, args: 8, res: 8, upd: 8;</span><span>
</span><span id="line-656"></span><span class="hs-comment">--  c1q9:</span><span>
</span><span id="line-657"></span><span class="hs-comment">--      I64[(young&lt;c1qb&gt; + 8)] = c1qb;</span><span>
</span><span id="line-658"></span><span class="hs-comment">--      _s1pf::P64 = R1;         &lt;------ INCORRECT!</span><span>
</span><span id="line-659"></span><span class="hs-comment">--      R1 = _s1pc::P64;</span><span>
</span><span id="line-660"></span><span class="hs-comment">--      call stg_makeStableName#(R1) returns to c1qb, args: 8, res: 8, upd: 8;</span><span>
</span><span id="line-661"></span><span class="hs-comment">--</span><span>
</span><span id="line-662"></span><span class="hs-comment">-- Notice that c1q6 now ends with a call. Sinking _s1pf::P64 = R1 past that</span><span>
</span><span id="line-663"></span><span class="hs-comment">-- call is clearly incorrect. This is what would happen if we assumed that</span><span>
</span><span id="line-664"></span><span class="hs-comment">-- safe foreign call has the same semantics as unsafe foreign call. To prevent</span><span>
</span><span id="line-665"></span><span class="hs-comment">-- this we need to treat safe foreign call as if was normal call.</span><span>
</span><span id="line-666"></span><span>
</span><span id="line-667"></span><span class="hs-comment">-----------------------------------</span><span>
</span><span id="line-668"></span><span class="hs-comment">-- mapping Expr in GHC.Cmm.Node</span><span>
</span><span id="line-669"></span><span>
</span><span id="line-670"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapForeignTarget"><span class="hs-identifier hs-type">mapForeignTarget</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span>
</span><span id="line-671"></span><span id="mapForeignTarget"><span class="annot"><span class="annottext">mapForeignTarget :: (CmmExpr -&gt; CmmExpr) -&gt; ForeignTarget -&gt; ForeignTarget
</span><a href="GHC.Cmm.Node.html#mapForeignTarget"><span class="hs-identifier hs-var hs-var">mapForeignTarget</span></a></span></span><span> </span><span id="local-6989586621682804817"><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804817"><span class="hs-identifier hs-var">exp</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span id="local-6989586621682804818"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804818"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682804819"><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682804819"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; ForeignConvention -&gt; ForeignTarget
</span><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-var">ForeignTarget</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804817"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804818"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682804819"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-672"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapForeignTarget"><span class="hs-identifier hs-var">mapForeignTarget</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621682804820"><span class="annot"><span class="annottext">m :: ForeignTarget
</span><a href="#local-6989586621682804820"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#PrimTarget"><span class="hs-identifier hs-type">PrimTarget</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804820"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span class="annot"><a href="GHC.Cmm.Node.html#wrapRecExp"><span class="hs-identifier hs-type">wrapRecExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-675"></span><span class="hs-comment">-- Take a transformer on expressions and apply it recursively.</span><span>
</span><span id="line-676"></span><span class="hs-comment">-- (wrapRecExp f e) first recursively applies itself to sub-expressions of e</span><span>
</span><span id="line-677"></span><span class="hs-comment">--                  then  uses f to rewrite the resulting expression</span><span>
</span><span id="line-678"></span><span id="wrapRecExp"><span class="annot"><span class="annottext">wrapRecExp :: (CmmExpr -&gt; CmmExpr) -&gt; CmmExpr -&gt; CmmExpr
</span><a href="GHC.Cmm.Node.html#wrapRecExp"><span class="hs-identifier hs-var hs-var">wrapRecExp</span></a></span></span><span> </span><span id="local-6989586621682804821"><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804821"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682804823"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682804823"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682804824"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804824"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804821"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682804823"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">([CmmExpr] -&gt; CmmExpr) -&gt; [CmmExpr] -&gt; CmmExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmExpr) -&gt; [CmmExpr] -&gt; [CmmExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmExpr) -&gt; CmmExpr -&gt; CmmExpr
</span><a href="GHC.Cmm.Node.html#wrapRecExp"><span class="hs-identifier hs-var">wrapRecExp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804821"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804824"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-679"></span><span class="annot"><a href="GHC.Cmm.Node.html#wrapRecExp"><span class="hs-identifier hs-var">wrapRecExp</span></a></span><span> </span><span id="local-6989586621682804825"><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804825"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682804827"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804827"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682804828"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682804828"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682804829"><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="#local-6989586621682804829"><span class="hs-identifier hs-var">align</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804825"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmType -&gt; AlignmentSpec -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-var">CmmLoad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmExpr) -&gt; CmmExpr -&gt; CmmExpr
</span><a href="GHC.Cmm.Node.html#wrapRecExp"><span class="hs-identifier hs-var">wrapRecExp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804825"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804827"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682804828"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="#local-6989586621682804829"><span class="hs-identifier hs-var">align</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-680"></span><span class="annot"><a href="GHC.Cmm.Node.html#wrapRecExp"><span class="hs-identifier hs-var">wrapRecExp</span></a></span><span> </span><span id="local-6989586621682804830"><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804830"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682804831"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804831"><span class="hs-identifier hs-var">e</span></a></span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804830"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804831"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-681"></span><span>
</span><span id="line-682"></span><span id="local-6989586621682803689"><span id="local-6989586621682803690"><span class="annot"><a href="GHC.Cmm.Node.html#mapExp"><span class="hs-identifier hs-type">mapExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803689"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803690"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803689"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803690"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-683"></span><span id="mapExp"><span class="annot"><span class="annottext">mapExp :: forall (e :: Extensibility) (x :: Extensibility).
(CmmExpr -&gt; CmmExpr) -&gt; CmmNode e x -&gt; CmmNode e x
</span><a href="GHC.Cmm.Node.html#mapExp"><span class="hs-identifier hs-var hs-var">mapExp</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682804832"><span class="annot"><span class="annottext">f :: CmmNode e x
</span><a href="#local-6989586621682804832"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmEntry"><span class="hs-identifier hs-type">CmmEntry</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682804832"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-684"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExp"><span class="hs-identifier hs-var">mapExp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682804835"><span class="annot"><span class="annottext">m :: CmmNode e x
</span><a href="#local-6989586621682804835"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmComment"><span class="hs-identifier hs-type">CmmComment</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682804835"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-685"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExp"><span class="hs-identifier hs-var">mapExp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682804838"><span class="annot"><span class="annottext">m :: CmmNode e x
</span><a href="#local-6989586621682804838"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTick"><span class="hs-identifier hs-type">CmmTick</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickish
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682804838"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-686"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExp"><span class="hs-identifier hs-var">mapExp</span></a></span><span> </span><span id="local-6989586621682804841"><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804841"><span class="hs-identifier hs-var">f</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnwind"><span class="hs-identifier hs-type">CmmUnwind</span></a></span><span> </span><span id="local-6989586621682804847"><span class="annot"><span class="annottext">[(GlobalReg, Maybe CmmExpr)]
</span><a href="#local-6989586621682804847"><span class="hs-identifier hs-var">regs</span></a></span></span><span class="hs-special">)</span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(GlobalReg, Maybe CmmExpr)] -&gt; CmmNode 'Open 'Open
</span><a href="GHC.Cmm.Node.html#CmmUnwind"><span class="hs-identifier hs-var">CmmUnwind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((GlobalReg, Maybe CmmExpr) -&gt; (GlobalReg, Maybe CmmExpr))
-&gt; [(GlobalReg, Maybe CmmExpr)] -&gt; [(GlobalReg, Maybe CmmExpr)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe CmmExpr -&gt; Maybe CmmExpr)
-&gt; (GlobalReg, Maybe CmmExpr) -&gt; (GlobalReg, Maybe CmmExpr)
forall a b. (a -&gt; b) -&gt; (GlobalReg, a) -&gt; (GlobalReg, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmExpr) -&gt; Maybe CmmExpr -&gt; Maybe CmmExpr
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804841"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(GlobalReg, Maybe CmmExpr)]
</span><a href="#local-6989586621682804847"><span class="hs-identifier hs-var">regs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExp"><span class="hs-identifier hs-var">mapExp</span></a></span><span> </span><span id="local-6989586621682804848"><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804848"><span class="hs-identifier hs-var">f</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmAssign"><span class="hs-identifier hs-type">CmmAssign</span></a></span><span> </span><span id="local-6989586621682804851"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682804851"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682804852"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804852"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; CmmExpr -&gt; CmmNode 'Open 'Open
</span><a href="GHC.Cmm.Node.html#CmmAssign"><span class="hs-identifier hs-var">CmmAssign</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682804851"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804848"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804852"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-688"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExp"><span class="hs-identifier hs-var">mapExp</span></a></span><span> </span><span id="local-6989586621682804853"><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804853"><span class="hs-identifier hs-var">f</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmStore"><span class="hs-identifier hs-type">CmmStore</span></a></span><span> </span><span id="local-6989586621682804856"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804856"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682804857"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804857"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682804858"><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="#local-6989586621682804858"><span class="hs-identifier hs-var">align</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr -&gt; AlignmentSpec -&gt; CmmNode 'Open 'Open
</span><a href="GHC.Cmm.Node.html#CmmStore"><span class="hs-identifier hs-var">CmmStore</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804853"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804856"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804853"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804857"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="#local-6989586621682804858"><span class="hs-identifier hs-var">align</span></a></span><span>
</span><span id="line-689"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExp"><span class="hs-identifier hs-var">mapExp</span></a></span><span> </span><span id="local-6989586621682804859"><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804859"><span class="hs-identifier hs-var">f</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnsafeForeignCall"><span class="hs-identifier hs-type">CmmUnsafeForeignCall</span></a></span><span> </span><span id="local-6989586621682804862"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804862"><span class="hs-identifier hs-var">tgt</span></a></span></span><span> </span><span id="local-6989586621682804863"><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682804863"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621682804864"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804864"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignTarget -&gt; [CmmFormal] -&gt; [CmmExpr] -&gt; CmmNode 'Open 'Open
</span><a href="GHC.Cmm.Node.html#CmmUnsafeForeignCall"><span class="hs-identifier hs-var">CmmUnsafeForeignCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmExpr) -&gt; ForeignTarget -&gt; ForeignTarget
</span><a href="GHC.Cmm.Node.html#mapForeignTarget"><span class="hs-identifier hs-var">mapForeignTarget</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804859"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804862"><span class="hs-identifier hs-var">tgt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682804863"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmExpr) -&gt; [CmmExpr] -&gt; [CmmExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804859"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804864"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-690"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExp"><span class="hs-identifier hs-var">mapExp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682804865"><span class="annot"><span class="annottext">l :: CmmNode e x
</span><a href="#local-6989586621682804865"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmBranch"><span class="hs-identifier hs-type">CmmBranch</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682804865"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-691"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExp"><span class="hs-identifier hs-var">mapExp</span></a></span><span> </span><span id="local-6989586621682804868"><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804868"><span class="hs-identifier hs-var">f</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-type">CmmCondBranch</span></a></span><span> </span><span id="local-6989586621682804871"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804871"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682804872"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804872"><span class="hs-identifier hs-var">ti</span></a></span></span><span> </span><span id="local-6989586621682804873"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804873"><span class="hs-identifier hs-var">fi</span></a></span></span><span> </span><span id="local-6989586621682804874"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621682804874"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Label -&gt; Label -&gt; Maybe Bool -&gt; CmmNode 'Open 'Closed
</span><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-var">CmmCondBranch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804868"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804871"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804872"><span class="hs-identifier hs-var">ti</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804873"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621682804874"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-692"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExp"><span class="hs-identifier hs-var">mapExp</span></a></span><span> </span><span id="local-6989586621682804875"><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804875"><span class="hs-identifier hs-var">f</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-type">CmmSwitch</span></a></span><span> </span><span id="local-6989586621682804878"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804878"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682804879"><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682804879"><span class="hs-identifier hs-var">ids</span></a></span></span><span class="hs-special">)</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; SwitchTargets -&gt; CmmNode 'Open 'Closed
</span><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-var">CmmSwitch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804875"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804878"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682804879"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-693"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExp"><span class="hs-identifier hs-var">mapExp</span></a></span><span> </span><span id="local-6989586621682804880"><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804880"><span class="hs-identifier hs-var">f</span></a></span></span><span>   </span><span id="local-6989586621682804881"><span class="annot"><span class="annottext">n :: CmmNode e x
</span><a href="#local-6989586621682804881"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCall"><span class="hs-identifier hs-type">CmmCall</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">cml_target :: CmmNode 'Open 'Closed -&gt; CmmExpr
</span><a href="GHC.Cmm.Node.html#cml_target"><span class="hs-identifier hs-var">cml_target</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682804884"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804884"><span class="hs-identifier hs-var">tgt</span></a></span></span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682804881"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">{</span><span class="annot"><a href="GHC.Cmm.Node.html#cml_target"><span class="hs-identifier hs-var">cml_target</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682804880"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682804884"><span class="hs-identifier hs-type">tgt</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-694"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExp"><span class="hs-identifier hs-var">mapExp</span></a></span><span> </span><span id="local-6989586621682804885"><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804885"><span class="hs-identifier hs-var">f</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmForeignCall"><span class="hs-identifier hs-type">CmmForeignCall</span></a></span><span> </span><span id="local-6989586621682804888"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804888"><span class="hs-identifier hs-var">tgt</span></a></span></span><span> </span><span id="local-6989586621682804889"><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682804889"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621682804890"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804890"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621682804891"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804891"><span class="hs-identifier hs-var">succ</span></a></span></span><span> </span><span id="local-6989586621682804892"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804892"><span class="hs-identifier hs-var">ret_args</span></a></span></span><span> </span><span id="local-6989586621682804893"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804893"><span class="hs-identifier hs-var">updfr</span></a></span></span><span> </span><span id="local-6989586621682804894"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682804894"><span class="hs-identifier hs-var">intrbl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignTarget
-&gt; [CmmFormal]
-&gt; [CmmExpr]
-&gt; Label
-&gt; ByteOff
-&gt; ByteOff
-&gt; Bool
-&gt; CmmNode 'Open 'Closed
</span><a href="GHC.Cmm.Node.html#CmmForeignCall"><span class="hs-identifier hs-var">CmmForeignCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmExpr) -&gt; ForeignTarget -&gt; ForeignTarget
</span><a href="GHC.Cmm.Node.html#mapForeignTarget"><span class="hs-identifier hs-var">mapForeignTarget</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804885"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804888"><span class="hs-identifier hs-var">tgt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682804889"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmExpr) -&gt; [CmmExpr] -&gt; [CmmExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804885"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804890"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804891"><span class="hs-identifier hs-var">succ</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804892"><span class="hs-identifier hs-var">ret_args</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804893"><span class="hs-identifier hs-var">updfr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682804894"><span class="hs-identifier hs-var">intrbl</span></a></span><span>
</span><span id="line-695"></span><span>
</span><span id="line-696"></span><span id="local-6989586621682804895"><span id="local-6989586621682804896"><span class="annot"><a href="GHC.Cmm.Node.html#mapExpDeep"><span class="hs-identifier hs-type">mapExpDeep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682804895"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682804896"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682804895"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682804896"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-697"></span><span id="mapExpDeep"><span class="annot"><span class="annottext">mapExpDeep :: forall (e :: Extensibility) (x :: Extensibility).
(CmmExpr -&gt; CmmExpr) -&gt; CmmNode e x -&gt; CmmNode e x
</span><a href="GHC.Cmm.Node.html#mapExpDeep"><span class="hs-identifier hs-var hs-var">mapExpDeep</span></a></span></span><span> </span><span id="local-6989586621682804897"><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804897"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmExpr) -&gt; CmmNode e x -&gt; CmmNode e x
forall (e :: Extensibility) (x :: Extensibility).
(CmmExpr -&gt; CmmExpr) -&gt; CmmNode e x -&gt; CmmNode e x
</span><a href="GHC.Cmm.Node.html#mapExp"><span class="hs-identifier hs-var">mapExp</span></a></span><span> </span><span class="annot"><span class="annottext">((CmmExpr -&gt; CmmExpr) -&gt; CmmNode e x -&gt; CmmNode e x)
-&gt; (CmmExpr -&gt; CmmExpr) -&gt; CmmNode e x -&gt; CmmNode e x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmExpr) -&gt; CmmExpr -&gt; CmmExpr
</span><a href="GHC.Cmm.Node.html#wrapRecExp"><span class="hs-identifier hs-var">wrapRecExp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr
</span><a href="#local-6989586621682804897"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-700"></span><span class="hs-comment">-- mapping Expr in GHC.Cmm.Node, but not performing allocation if no changes</span><span>
</span><span id="line-701"></span><span>
</span><span id="line-702"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapForeignTargetM"><span class="hs-identifier hs-type">mapForeignTargetM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span>
</span><span id="line-703"></span><span id="mapForeignTargetM"><span class="annot"><span class="annottext">mapForeignTargetM :: (CmmExpr -&gt; Maybe CmmExpr) -&gt; ForeignTarget -&gt; Maybe ForeignTarget
</span><a href="GHC.Cmm.Node.html#mapForeignTargetM"><span class="hs-identifier hs-var hs-var">mapForeignTargetM</span></a></span></span><span> </span><span id="local-6989586621682804899"><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804899"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span id="local-6989586621682804900"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804900"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682804901"><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682804901"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682804902"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804902"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; ForeignConvention -&gt; ForeignTarget
</span><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-var">ForeignTarget</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804902"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682804901"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; ForeignTarget) -&gt; Maybe CmmExpr -&gt; Maybe ForeignTarget
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804899"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804900"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-704"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapForeignTargetM"><span class="hs-identifier hs-var">mapForeignTargetM</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#PrimTarget"><span class="hs-identifier hs-type">PrimTarget</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ForeignTarget
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-705"></span><span>
</span><span id="line-706"></span><span class="annot"><a href="GHC.Cmm.Node.html#wrapRecExpM"><span class="hs-identifier hs-type">wrapRecExpM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-707"></span><span class="hs-comment">-- (wrapRecExpM f e) first recursively applies itself to sub-expressions of e</span><span>
</span><span id="line-708"></span><span class="hs-comment">--                   then  gives f a chance to rewrite the resulting expression</span><span>
</span><span id="line-709"></span><span id="wrapRecExpM"><span class="annot"><span class="annottext">wrapRecExpM :: (CmmExpr -&gt; Maybe CmmExpr) -&gt; CmmExpr -&gt; Maybe CmmExpr
</span><a href="GHC.Cmm.Node.html#wrapRecExpM"><span class="hs-identifier hs-var hs-var">wrapRecExpM</span></a></span></span><span> </span><span id="local-6989586621682804903"><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804903"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682804904"><span class="annot"><span class="annottext">n :: CmmExpr
</span><a href="#local-6989586621682804904"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682804905"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682804905"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682804906"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804906"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CmmExpr
-&gt; ([CmmExpr] -&gt; Maybe CmmExpr) -&gt; Maybe [CmmExpr] -&gt; Maybe CmmExpr
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804903"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804904"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804903"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; Maybe CmmExpr)
-&gt; ([CmmExpr] -&gt; CmmExpr) -&gt; [CmmExpr] -&gt; Maybe CmmExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682804905"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; Maybe CmmExpr) -&gt; [CmmExpr] -&gt; Maybe [CmmExpr]
forall a. (a -&gt; Maybe a) -&gt; [a] -&gt; Maybe [a]
</span><a href="GHC.Cmm.Node.html#mapListM"><span class="hs-identifier hs-var">mapListM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; Maybe CmmExpr) -&gt; CmmExpr -&gt; Maybe CmmExpr
</span><a href="GHC.Cmm.Node.html#wrapRecExpM"><span class="hs-identifier hs-var">wrapRecExpM</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804903"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804906"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-710"></span><span class="annot"><a href="GHC.Cmm.Node.html#wrapRecExpM"><span class="hs-identifier hs-var">wrapRecExpM</span></a></span><span> </span><span id="local-6989586621682804909"><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804909"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682804910"><span class="annot"><span class="annottext">n :: CmmExpr
</span><a href="#local-6989586621682804910"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682804911"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804911"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682804912"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682804912"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682804913"><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="#local-6989586621682804913"><span class="hs-identifier hs-var">align</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CmmExpr
-&gt; (CmmExpr -&gt; Maybe CmmExpr) -&gt; Maybe CmmExpr -&gt; Maybe CmmExpr
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804909"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804910"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682804914"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804914"><span class="hs-identifier hs-var">addr'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804909"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; Maybe CmmExpr) -&gt; CmmExpr -&gt; Maybe CmmExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmType -&gt; AlignmentSpec -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-var">CmmLoad</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804914"><span class="hs-identifier hs-var">addr'</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682804912"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="#local-6989586621682804913"><span class="hs-identifier hs-var">align</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; Maybe CmmExpr) -&gt; CmmExpr -&gt; Maybe CmmExpr
</span><a href="GHC.Cmm.Node.html#wrapRecExpM"><span class="hs-identifier hs-var">wrapRecExpM</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804909"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804911"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span class="annot"><a href="GHC.Cmm.Node.html#wrapRecExpM"><span class="hs-identifier hs-var">wrapRecExpM</span></a></span><span> </span><span id="local-6989586621682804915"><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804915"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682804916"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804916"><span class="hs-identifier hs-var">e</span></a></span></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804915"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804916"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-712"></span><span>
</span><span id="line-713"></span><span id="local-6989586621682803697"><span id="local-6989586621682803698"><span class="annot"><a href="GHC.Cmm.Node.html#mapExpM"><span class="hs-identifier hs-type">mapExpM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803697"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803698"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803697"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803698"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-714"></span><span id="mapExpM"><span class="annot"><span class="annottext">mapExpM :: forall (e :: Extensibility) (x :: Extensibility).
(CmmExpr -&gt; Maybe CmmExpr) -&gt; CmmNode e x -&gt; Maybe (CmmNode e x)
</span><a href="GHC.Cmm.Node.html#mapExpM"><span class="hs-identifier hs-var hs-var">mapExpM</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmEntry"><span class="hs-identifier hs-type">CmmEntry</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (CmmNode e x)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-715"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExpM"><span class="hs-identifier hs-var">mapExpM</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmComment"><span class="hs-identifier hs-type">CmmComment</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (CmmNode e x)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-716"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExpM"><span class="hs-identifier hs-var">mapExpM</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTick"><span class="hs-identifier hs-type">CmmTick</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickish
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (CmmNode e x)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-717"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExpM"><span class="hs-identifier hs-var">mapExpM</span></a></span><span> </span><span id="local-6989586621682804923"><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804923"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnwind"><span class="hs-identifier hs-type">CmmUnwind</span></a></span><span> </span><span id="local-6989586621682804937"><span class="annot"><span class="annottext">[(GlobalReg, Maybe CmmExpr)]
</span><a href="#local-6989586621682804937"><span class="hs-identifier hs-var">regs</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(GlobalReg, Maybe CmmExpr)] -&gt; CmmNode e x
[(GlobalReg, Maybe CmmExpr)] -&gt; CmmNode 'Open 'Open
</span><a href="GHC.Cmm.Node.html#CmmUnwind"><span class="hs-identifier hs-var">CmmUnwind</span></a></span><span> </span><span class="annot"><span class="annottext">([(GlobalReg, Maybe CmmExpr)] -&gt; CmmNode e x)
-&gt; Maybe [(GlobalReg, Maybe CmmExpr)] -&gt; Maybe (CmmNode e x)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">((GlobalReg, Maybe CmmExpr) -&gt; Maybe (GlobalReg, Maybe CmmExpr))
-&gt; [(GlobalReg, Maybe CmmExpr)]
-&gt; Maybe [(GlobalReg, Maybe CmmExpr)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621682804939"><span class="annot"><span class="annottext">GlobalReg
</span><a href="#local-6989586621682804939"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682804940"><span class="annot"><span class="annottext">Maybe CmmExpr
</span><a href="#local-6989586621682804940"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; Maybe CmmExpr)
-&gt; Maybe CmmExpr -&gt; Maybe (Maybe CmmExpr)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Maybe a -&gt; m (Maybe b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804923"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CmmExpr
</span><a href="#local-6989586621682804940"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Maybe CmmExpr)
-&gt; (Maybe CmmExpr -&gt; Maybe (GlobalReg, Maybe CmmExpr))
-&gt; Maybe (GlobalReg, Maybe CmmExpr)
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682804941"><span class="annot"><span class="annottext">Maybe CmmExpr
</span><a href="#local-6989586621682804941"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(GlobalReg, Maybe CmmExpr) -&gt; Maybe (GlobalReg, Maybe CmmExpr)
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalReg
</span><a href="#local-6989586621682804939"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe CmmExpr
</span><a href="#local-6989586621682804941"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(GlobalReg, Maybe CmmExpr)]
</span><a href="#local-6989586621682804937"><span class="hs-identifier hs-var">regs</span></a></span><span>
</span><span id="line-718"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExpM"><span class="hs-identifier hs-var">mapExpM</span></a></span><span> </span><span id="local-6989586621682804942"><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804942"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmAssign"><span class="hs-identifier hs-type">CmmAssign</span></a></span><span> </span><span id="local-6989586621682804946"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682804946"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682804947"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804947"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; CmmExpr -&gt; CmmNode 'Open 'Open
</span><a href="GHC.Cmm.Node.html#CmmAssign"><span class="hs-identifier hs-var">CmmAssign</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682804946"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmNode e x) -&gt; Maybe CmmExpr -&gt; Maybe (CmmNode e x)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804942"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804947"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-719"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExpM"><span class="hs-identifier hs-var">mapExpM</span></a></span><span> </span><span id="local-6989586621682804948"><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804948"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmStore"><span class="hs-identifier hs-type">CmmStore</span></a></span><span> </span><span id="local-6989586621682804955"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804955"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682804956"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804956"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682804957"><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="#local-6989586621682804957"><span class="hs-identifier hs-var">align</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621682804959"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804959"><span class="hs-identifier hs-var">addr'</span></a></span></span><span> </span><span id="local-6989586621682804960"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804960"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr -&gt; AlignmentSpec -&gt; CmmNode 'Open 'Open
</span><a href="GHC.Cmm.Node.html#CmmStore"><span class="hs-identifier hs-var">CmmStore</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804959"><span class="hs-identifier hs-var">addr'</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804960"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="#local-6989586621682804957"><span class="hs-identifier hs-var">align</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Pair CmmExpr -&gt; CmmNode e x)
-&gt; Maybe (Pair CmmExpr) -&gt; Maybe (CmmNode e x)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; Maybe CmmExpr) -&gt; Pair CmmExpr -&gt; Maybe (Pair CmmExpr)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Pair a -&gt; f (Pair b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804948"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr -&gt; Pair CmmExpr
forall a. a -&gt; a -&gt; Pair a
</span><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804955"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804956"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-720"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExpM"><span class="hs-identifier hs-var">mapExpM</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmBranch"><span class="hs-identifier hs-type">CmmBranch</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (CmmNode e x)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-721"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExpM"><span class="hs-identifier hs-var">mapExpM</span></a></span><span> </span><span id="local-6989586621682804964"><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804964"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-type">CmmCondBranch</span></a></span><span> </span><span id="local-6989586621682804968"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804968"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682804969"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804969"><span class="hs-identifier hs-var">ti</span></a></span></span><span> </span><span id="local-6989586621682804970"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804970"><span class="hs-identifier hs-var">fi</span></a></span></span><span> </span><span id="local-6989586621682804971"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621682804971"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682804972"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804972"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Label -&gt; Label -&gt; Maybe Bool -&gt; CmmNode 'Open 'Closed
</span><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-var">CmmCondBranch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804972"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804969"><span class="hs-identifier hs-var">ti</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682804970"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621682804971"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmNode e x) -&gt; Maybe CmmExpr -&gt; Maybe (CmmNode e x)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804964"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804968"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-722"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExpM"><span class="hs-identifier hs-var">mapExpM</span></a></span><span> </span><span id="local-6989586621682804973"><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804973"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-type">CmmSwitch</span></a></span><span> </span><span id="local-6989586621682804977"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804977"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682804978"><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682804978"><span class="hs-identifier hs-var">tbl</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682804979"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804979"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; SwitchTargets -&gt; CmmNode 'Open 'Closed
</span><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-var">CmmSwitch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804979"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682804978"><span class="hs-identifier hs-var">tbl</span></a></span><span class="hs-special">)</span><span>       </span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmNode e x) -&gt; Maybe CmmExpr -&gt; Maybe (CmmNode e x)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804973"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804977"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-723"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExpM"><span class="hs-identifier hs-var">mapExpM</span></a></span><span> </span><span id="local-6989586621682804980"><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804980"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCall"><span class="hs-identifier hs-type">CmmCall</span></a></span><span> </span><span id="local-6989586621682804984"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804984"><span class="hs-identifier hs-var">tgt</span></a></span></span><span> </span><span id="local-6989586621682804985"><span class="annot"><span class="annottext">Maybe Label
</span><a href="#local-6989586621682804985"><span class="hs-identifier hs-var">mb_id</span></a></span></span><span> </span><span id="local-6989586621682804986"><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682804986"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682804987"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804987"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621682804988"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804988"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682804989"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804989"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682804990"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804990"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr
-&gt; Maybe Label
-&gt; [GlobalRegUse]
-&gt; ByteOff
-&gt; ByteOff
-&gt; ByteOff
-&gt; CmmNode 'Open 'Closed
</span><a href="GHC.Cmm.Node.html#CmmCall"><span class="hs-identifier hs-var">CmmCall</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804990"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Label
</span><a href="#local-6989586621682804985"><span class="hs-identifier hs-var">mb_id</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682804986"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804987"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804988"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682804989"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmNode e x) -&gt; Maybe CmmExpr -&gt; Maybe (CmmNode e x)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804980"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682804984"><span class="hs-identifier hs-var">tgt</span></a></span><span>
</span><span id="line-724"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExpM"><span class="hs-identifier hs-var">mapExpM</span></a></span><span> </span><span id="local-6989586621682804991"><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804991"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnsafeForeignCall"><span class="hs-identifier hs-type">CmmUnsafeForeignCall</span></a></span><span> </span><span id="local-6989586621682804995"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804995"><span class="hs-identifier hs-var">tgt</span></a></span></span><span> </span><span id="local-6989586621682804996"><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682804996"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621682804997"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804997"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; Maybe CmmExpr) -&gt; ForeignTarget -&gt; Maybe ForeignTarget
</span><a href="GHC.Cmm.Node.html#mapForeignTargetM"><span class="hs-identifier hs-var">mapForeignTargetM</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804991"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804995"><span class="hs-identifier hs-var">tgt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-726"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682804998"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804998"><span class="hs-identifier hs-var">tgt'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmNode e x -&gt; Maybe (CmmNode e x)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignTarget -&gt; [CmmFormal] -&gt; [CmmExpr] -&gt; CmmNode 'Open 'Open
</span><a href="GHC.Cmm.Node.html#CmmUnsafeForeignCall"><span class="hs-identifier hs-var">CmmUnsafeForeignCall</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804998"><span class="hs-identifier hs-var">tgt'</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682804996"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; Maybe CmmExpr) -&gt; [CmmExpr] -&gt; [CmmExpr]
forall a. (a -&gt; Maybe a) -&gt; [a] -&gt; [a]
</span><a href="GHC.Cmm.Node.html#mapListJ"><span class="hs-identifier hs-var">mapListJ</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804991"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804997"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-727"></span><span>        </span><span class="annot"><span class="annottext">Maybe ForeignTarget
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682805000"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682805000"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ForeignTarget -&gt; [CmmFormal] -&gt; [CmmExpr] -&gt; CmmNode 'Open 'Open
</span><a href="GHC.Cmm.Node.html#CmmUnsafeForeignCall"><span class="hs-identifier hs-var">CmmUnsafeForeignCall</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682804995"><span class="hs-identifier hs-var">tgt</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682804996"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682805000"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([CmmExpr] -&gt; CmmNode e x)
-&gt; Maybe [CmmExpr] -&gt; Maybe (CmmNode e x)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; Maybe CmmExpr) -&gt; [CmmExpr] -&gt; Maybe [CmmExpr]
forall a. (a -&gt; Maybe a) -&gt; [a] -&gt; Maybe [a]
</span><a href="GHC.Cmm.Node.html#mapListM"><span class="hs-identifier hs-var">mapListM</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682804991"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682804997"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-728"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapExpM"><span class="hs-identifier hs-var">mapExpM</span></a></span><span> </span><span id="local-6989586621682805001"><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682805001"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmForeignCall"><span class="hs-identifier hs-type">CmmForeignCall</span></a></span><span> </span><span id="local-6989586621682805005"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682805005"><span class="hs-identifier hs-var">tgt</span></a></span></span><span> </span><span id="local-6989586621682805006"><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682805006"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621682805007"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682805007"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621682805008"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805008"><span class="hs-identifier hs-var">succ</span></a></span></span><span> </span><span id="local-6989586621682805009"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682805009"><span class="hs-identifier hs-var">ret_args</span></a></span></span><span> </span><span id="local-6989586621682805010"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682805010"><span class="hs-identifier hs-var">updfr</span></a></span></span><span> </span><span id="local-6989586621682805011"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682805011"><span class="hs-identifier hs-var">intrbl</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-729"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; Maybe CmmExpr) -&gt; ForeignTarget -&gt; Maybe ForeignTarget
</span><a href="GHC.Cmm.Node.html#mapForeignTargetM"><span class="hs-identifier hs-var">mapForeignTargetM</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682805001"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682805005"><span class="hs-identifier hs-var">tgt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-730"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682805012"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682805012"><span class="hs-identifier hs-var">tgt'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmNode e x -&gt; Maybe (CmmNode e x)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignTarget
-&gt; [CmmFormal]
-&gt; [CmmExpr]
-&gt; Label
-&gt; ByteOff
-&gt; ByteOff
-&gt; Bool
-&gt; CmmNode 'Open 'Closed
</span><a href="GHC.Cmm.Node.html#CmmForeignCall"><span class="hs-identifier hs-var">CmmForeignCall</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682805012"><span class="hs-identifier hs-var">tgt'</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682805006"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; Maybe CmmExpr) -&gt; [CmmExpr] -&gt; [CmmExpr]
forall a. (a -&gt; Maybe a) -&gt; [a] -&gt; [a]
</span><a href="GHC.Cmm.Node.html#mapListJ"><span class="hs-identifier hs-var">mapListJ</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682805001"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682805007"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805008"><span class="hs-identifier hs-var">succ</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682805009"><span class="hs-identifier hs-var">ret_args</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682805010"><span class="hs-identifier hs-var">updfr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682805011"><span class="hs-identifier hs-var">intrbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-731"></span><span>        </span><span class="annot"><span class="annottext">Maybe ForeignTarget
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682805013"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682805013"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ForeignTarget
-&gt; [CmmFormal]
-&gt; [CmmExpr]
-&gt; Label
-&gt; ByteOff
-&gt; ByteOff
-&gt; Bool
-&gt; CmmNode 'Open 'Closed
</span><a href="GHC.Cmm.Node.html#CmmForeignCall"><span class="hs-identifier hs-var">CmmForeignCall</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682805005"><span class="hs-identifier hs-var">tgt</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682805006"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682805013"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805008"><span class="hs-identifier hs-var">succ</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682805009"><span class="hs-identifier hs-var">ret_args</span></a></span><span> </span><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682805010"><span class="hs-identifier hs-var">updfr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682805011"><span class="hs-identifier hs-var">intrbl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([CmmExpr] -&gt; CmmNode e x)
-&gt; Maybe [CmmExpr] -&gt; Maybe (CmmNode e x)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; Maybe CmmExpr) -&gt; [CmmExpr] -&gt; Maybe [CmmExpr]
forall a. (a -&gt; Maybe a) -&gt; [a] -&gt; Maybe [a]
</span><a href="GHC.Cmm.Node.html#mapListM"><span class="hs-identifier hs-var">mapListM</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682805001"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682805007"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-732"></span><span>
</span><span id="line-733"></span><span class="hs-comment">-- share as much as possible</span><span>
</span><span id="line-734"></span><span id="local-6989586621682803696"><span class="annot"><a href="GHC.Cmm.Node.html#mapListM"><span class="hs-identifier hs-type">mapListM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682803696"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682803696"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682803696"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682803696"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-735"></span><span id="mapListM"><span class="annot"><span class="annottext">mapListM :: forall a. (a -&gt; Maybe a) -&gt; [a] -&gt; Maybe [a]
</span><a href="GHC.Cmm.Node.html#mapListM"><span class="hs-identifier hs-var hs-var">mapListM</span></a></span></span><span> </span><span id="local-6989586621682805014"><span class="annot"><span class="annottext">a -&gt; Maybe a
</span><a href="#local-6989586621682805014"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682805015"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805015"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682805016"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682805016"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682805017"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805017"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; [a] -&gt; (Bool, [a])
forall a. (a -&gt; Maybe a) -&gt; [a] -&gt; (Bool, [a])
</span><a href="GHC.Cmm.Node.html#mapListT"><span class="hs-identifier hs-var">mapListT</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
</span><a href="#local-6989586621682805014"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805015"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-736"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682805016"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Maybe [a]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805017"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe [a]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-737"></span><span>
</span><span id="line-738"></span><span id="local-6989586621682803715"><span class="annot"><a href="GHC.Cmm.Node.html#mapListJ"><span class="hs-identifier hs-type">mapListJ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682803715"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682803715"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682803715"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682803715"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-739"></span><span id="mapListJ"><span class="annot"><span class="annottext">mapListJ :: forall a. (a -&gt; Maybe a) -&gt; [a] -&gt; [a]
</span><a href="GHC.Cmm.Node.html#mapListJ"><span class="hs-identifier hs-var hs-var">mapListJ</span></a></span></span><span> </span><span id="local-6989586621682805019"><span class="annot"><span class="annottext">a -&gt; Maybe a
</span><a href="#local-6989586621682805019"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682805020"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805020"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool, [a]) -&gt; [a]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; [a] -&gt; (Bool, [a])
forall a. (a -&gt; Maybe a) -&gt; [a] -&gt; (Bool, [a])
</span><a href="GHC.Cmm.Node.html#mapListT"><span class="hs-identifier hs-var">mapListT</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
</span><a href="#local-6989586621682805019"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805020"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-740"></span><span>
</span><span id="line-741"></span><span id="local-6989586621682803717"><span class="annot"><a href="GHC.Cmm.Node.html#mapListT"><span class="hs-identifier hs-type">mapListT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682803717"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682803717"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682803717"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682803717"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-742"></span><span id="mapListT"><span class="annot"><span class="annottext">mapListT :: forall a. (a -&gt; Maybe a) -&gt; [a] -&gt; (Bool, [a])
</span><a href="GHC.Cmm.Node.html#mapListT"><span class="hs-identifier hs-var hs-var">mapListT</span></a></span></span><span> </span><span id="local-6989586621682805023"><span class="annot"><span class="annottext">a -&gt; Maybe a
</span><a href="#local-6989586621682805023"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682805024"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805024"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([a], a, Maybe a) -&gt; (Bool, [a]) -&gt; (Bool, [a]))
-&gt; (Bool, [a]) -&gt; [([a], a, Maybe a)] -&gt; (Bool, [a])
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">([a], a, Maybe a) -&gt; (Bool, [a]) -&gt; (Bool, [a])
forall {a}. ([a], a, Maybe a) -&gt; (Bool, [a]) -&gt; (Bool, [a])
</span><a href="#local-6989586621682805026"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[a]] -&gt; [a] -&gt; [Maybe a] -&gt; [([a], a, Maybe a)]
forall a b c. [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]
</span><span class="hs-identifier hs-var">zip3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [[a]]
forall a. [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">tails</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805024"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805024"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; [a] -&gt; [Maybe a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
</span><a href="#local-6989586621682805023"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805024"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-743"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682805026"><span class="annot"><span class="annottext">g :: ([a], a, Maybe a) -&gt; (Bool, [a]) -&gt; (Bool, [a])
</span><a href="#local-6989586621682805026"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>   </span><span id="local-6989586621682805028"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682805028"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682805029"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805029"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682805028"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805029"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-744"></span><span>          </span><span class="annot"><a href="#local-6989586621682805026"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682805030"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682805030"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682805031"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805031"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682805030"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805031"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-745"></span><span>          </span><span class="annot"><a href="#local-6989586621682805026"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682805032"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805032"><span class="hs-identifier hs-var">ys'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805032"><span class="hs-identifier hs-var">ys'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-746"></span><span>          </span><span class="annot"><a href="#local-6989586621682805026"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682805033"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682805033"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682805034"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805034"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682805033"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682805034"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-747"></span><span>
</span><span id="line-748"></span><span id="local-6989586621682805035"><span id="local-6989586621682805036"><span class="annot"><a href="GHC.Cmm.Node.html#mapExpDeepM"><span class="hs-identifier hs-type">mapExpDeepM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682805035"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682805036"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682805035"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682805036"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-749"></span><span id="mapExpDeepM"><span class="annot"><span class="annottext">mapExpDeepM :: forall (e :: Extensibility) (x :: Extensibility).
(CmmExpr -&gt; Maybe CmmExpr) -&gt; CmmNode e x -&gt; Maybe (CmmNode e x)
</span><a href="GHC.Cmm.Node.html#mapExpDeepM"><span class="hs-identifier hs-var hs-var">mapExpDeepM</span></a></span></span><span> </span><span id="local-6989586621682805037"><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682805037"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; Maybe CmmExpr) -&gt; CmmNode e x -&gt; Maybe (CmmNode e x)
forall (e :: Extensibility) (x :: Extensibility).
(CmmExpr -&gt; Maybe CmmExpr) -&gt; CmmNode e x -&gt; Maybe (CmmNode e x)
</span><a href="GHC.Cmm.Node.html#mapExpM"><span class="hs-identifier hs-var">mapExpM</span></a></span><span> </span><span class="annot"><span class="annottext">((CmmExpr -&gt; Maybe CmmExpr) -&gt; CmmNode e x -&gt; Maybe (CmmNode e x))
-&gt; (CmmExpr -&gt; Maybe CmmExpr) -&gt; CmmNode e x -&gt; Maybe (CmmNode e x)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; Maybe CmmExpr) -&gt; CmmExpr -&gt; Maybe CmmExpr
</span><a href="GHC.Cmm.Node.html#wrapRecExpM"><span class="hs-identifier hs-var">wrapRecExpM</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
</span><a href="#local-6989586621682805037"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-750"></span><span>
</span><span id="line-751"></span><span class="hs-comment">-----------------------------------</span><span>
</span><span id="line-752"></span><span class="hs-comment">-- folding Expr in GHC.Cmm.Node</span><span>
</span><span id="line-753"></span><span>
</span><span id="line-754"></span><span id="local-6989586621682803731"><span class="annot"><a href="GHC.Cmm.Node.html#foldExpForeignTarget"><span class="hs-identifier hs-type">foldExpForeignTarget</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803731"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803731"><span class="hs-identifier hs-type">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803731"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803731"><span class="hs-identifier hs-type">z</span></a></span></span><span>
</span><span id="line-755"></span><span id="foldExpForeignTarget"><span class="annot"><span class="annottext">foldExpForeignTarget :: forall z. (CmmExpr -&gt; z -&gt; z) -&gt; ForeignTarget -&gt; z -&gt; z
</span><a href="GHC.Cmm.Node.html#foldExpForeignTarget"><span class="hs-identifier hs-var hs-var">foldExpForeignTarget</span></a></span></span><span> </span><span id="local-6989586621682805039"><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805039"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span id="local-6989586621682805040"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805040"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForeignConvention
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682805041"><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805041"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805039"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805040"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805041"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-756"></span><span class="annot"><a href="GHC.Cmm.Node.html#foldExpForeignTarget"><span class="hs-identifier hs-var">foldExpForeignTarget</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#PrimTarget"><span class="hs-identifier hs-type">PrimTarget</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span id="local-6989586621682805042"><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805042"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805042"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-757"></span><span>
</span><span id="line-758"></span><span class="hs-comment">-- Take a folder on expressions and apply it recursively.</span><span>
</span><span id="line-759"></span><span class="hs-comment">-- Specifically (wrapRecExpf f e z) deals with CmmMachOp and CmmLoad</span><span>
</span><span id="line-760"></span><span class="hs-comment">-- itself, delegating all the other CmmExpr forms to 'f'.</span><span>
</span><span id="line-761"></span><span id="local-6989586621682803733"><span class="annot"><a href="GHC.Cmm.Node.html#wrapRecExpf"><span class="hs-identifier hs-type">wrapRecExpf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803733"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803733"><span class="hs-identifier hs-type">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803733"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803733"><span class="hs-identifier hs-type">z</span></a></span></span><span>
</span><span id="line-762"></span><span id="wrapRecExpf"><span class="annot"><span class="annottext">wrapRecExpf :: forall z. (CmmExpr -&gt; z -&gt; z) -&gt; CmmExpr -&gt; z -&gt; z
</span><a href="GHC.Cmm.Node.html#wrapRecExpf"><span class="hs-identifier hs-var hs-var">wrapRecExpf</span></a></span></span><span> </span><span id="local-6989586621682805044"><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805044"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682805045"><span class="annot"><span class="annottext">e :: CmmExpr
</span><a href="#local-6989586621682805045"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682805046"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682805046"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span>   </span><span id="local-6989586621682805047"><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805047"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; z -&gt; z) -&gt; z -&gt; [CmmExpr] -&gt; z
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; z -&gt; z) -&gt; CmmExpr -&gt; z -&gt; z
forall z. (CmmExpr -&gt; z -&gt; z) -&gt; CmmExpr -&gt; z -&gt; z
</span><a href="GHC.Cmm.Node.html#wrapRecExpf"><span class="hs-identifier hs-var">wrapRecExpf</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805044"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805044"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805045"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805047"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682805046"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-763"></span><span class="annot"><a href="GHC.Cmm.Node.html#wrapRecExpf"><span class="hs-identifier hs-var">wrapRecExpf</span></a></span><span> </span><span id="local-6989586621682805048"><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805048"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682805049"><span class="annot"><span class="annottext">e :: CmmExpr
</span><a href="#local-6989586621682805049"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682805050"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805050"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682805051"><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805051"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; z -&gt; z) -&gt; CmmExpr -&gt; z -&gt; z
forall z. (CmmExpr -&gt; z -&gt; z) -&gt; CmmExpr -&gt; z -&gt; z
</span><a href="GHC.Cmm.Node.html#wrapRecExpf"><span class="hs-identifier hs-var">wrapRecExpf</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805048"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805050"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805048"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805049"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805051"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-764"></span><span class="annot"><a href="GHC.Cmm.Node.html#wrapRecExpf"><span class="hs-identifier hs-var">wrapRecExpf</span></a></span><span> </span><span id="local-6989586621682805052"><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805052"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682805053"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805053"><span class="hs-identifier hs-var">e</span></a></span></span><span>                    </span><span id="local-6989586621682805054"><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805054"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805052"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805053"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805054"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-765"></span><span>
</span><span id="line-766"></span><span id="local-6989586621682803735"><span id="local-6989586621682803736"><span id="local-6989586621682803737"><span class="annot"><a href="GHC.Cmm.Node.html#foldExp"><span class="hs-identifier hs-type">foldExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803735"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803735"><span class="hs-identifier hs-type">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803736"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682803737"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803735"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682803735"><span class="hs-identifier hs-type">z</span></a></span></span></span></span><span>
</span><span id="line-767"></span><span id="foldExp"><span class="annot"><span class="annottext">foldExp :: forall z (e :: Extensibility) (x :: Extensibility).
(CmmExpr -&gt; z -&gt; z) -&gt; CmmNode e x -&gt; z -&gt; z
</span><a href="GHC.Cmm.Node.html#foldExp"><span class="hs-identifier hs-var hs-var">foldExp</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmEntry"><span class="hs-identifier hs-type">CmmEntry</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682805057"><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805057"><span class="hs-identifier hs-var">z</span></a></span></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805057"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-768"></span><span class="annot"><a href="GHC.Cmm.Node.html#foldExp"><span class="hs-identifier hs-var">foldExp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmComment"><span class="hs-identifier hs-type">CmmComment</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682805060"><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805060"><span class="hs-identifier hs-var">z</span></a></span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805060"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-769"></span><span class="annot"><a href="GHC.Cmm.Node.html#foldExp"><span class="hs-identifier hs-var">foldExp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTick"><span class="hs-identifier hs-type">CmmTick</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682805063"><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805063"><span class="hs-identifier hs-var">z</span></a></span></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805063"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-770"></span><span class="annot"><a href="GHC.Cmm.Node.html#foldExp"><span class="hs-identifier hs-var">foldExp</span></a></span><span> </span><span id="local-6989586621682805064"><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805064"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnwind"><span class="hs-identifier hs-type">CmmUnwind</span></a></span><span> </span><span id="local-6989586621682805068"><span class="annot"><span class="annottext">[(GlobalReg, Maybe CmmExpr)]
</span><a href="#local-6989586621682805068"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682805069"><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805069"><span class="hs-identifier hs-var">z</span></a></span></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe CmmExpr -&gt; z -&gt; z) -&gt; z -&gt; [Maybe CmmExpr] -&gt; z
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(z -&gt; z) -&gt; (CmmExpr -&gt; z -&gt; z) -&gt; Maybe CmmExpr -&gt; z -&gt; z
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">z -&gt; z
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805064"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805069"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((GlobalReg, Maybe CmmExpr) -&gt; Maybe CmmExpr)
-&gt; [(GlobalReg, Maybe CmmExpr)] -&gt; [Maybe CmmExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(GlobalReg, Maybe CmmExpr) -&gt; Maybe CmmExpr
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(GlobalReg, Maybe CmmExpr)]
</span><a href="#local-6989586621682805068"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-771"></span><span class="annot"><a href="GHC.Cmm.Node.html#foldExp"><span class="hs-identifier hs-var">foldExp</span></a></span><span> </span><span id="local-6989586621682805071"><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805071"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmAssign"><span class="hs-identifier hs-type">CmmAssign</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682805074"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805074"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682805075"><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805075"><span class="hs-identifier hs-var">z</span></a></span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805071"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805074"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805075"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-772"></span><span class="annot"><a href="GHC.Cmm.Node.html#foldExp"><span class="hs-identifier hs-var">foldExp</span></a></span><span> </span><span id="local-6989586621682805076"><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805076"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmStore"><span class="hs-identifier hs-type">CmmStore</span></a></span><span> </span><span id="local-6989586621682805079"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805079"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682805080"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805080"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682805081"><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805081"><span class="hs-identifier hs-var">z</span></a></span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805076"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805079"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">(z -&gt; z) -&gt; z -&gt; z
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805076"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805080"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805081"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-773"></span><span class="annot"><a href="GHC.Cmm.Node.html#foldExp"><span class="hs-identifier hs-var">foldExp</span></a></span><span> </span><span id="local-6989586621682805082"><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805082"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnsafeForeignCall"><span class="hs-identifier hs-type">CmmUnsafeForeignCall</span></a></span><span> </span><span id="local-6989586621682805086"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682805086"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682805087"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682805087"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682805088"><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805088"><span class="hs-identifier hs-var">z</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; z -&gt; z) -&gt; z -&gt; [CmmExpr] -&gt; z
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805082"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; z -&gt; z) -&gt; ForeignTarget -&gt; z -&gt; z
forall z. (CmmExpr -&gt; z -&gt; z) -&gt; ForeignTarget -&gt; z -&gt; z
</span><a href="GHC.Cmm.Node.html#foldExpForeignTarget"><span class="hs-identifier hs-var">foldExpForeignTarget</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805082"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682805086"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805088"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682805087"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-774"></span><span class="annot"><a href="GHC.Cmm.Node.html#foldExp"><span class="hs-identifier hs-var">foldExp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmBranch"><span class="hs-identifier hs-type">CmmBranch</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682805091"><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805091"><span class="hs-identifier hs-var">z</span></a></span></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805091"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-775"></span><span class="annot"><a href="GHC.Cmm.Node.html#foldExp"><span class="hs-identifier hs-var">foldExp</span></a></span><span> </span><span id="local-6989586621682805092"><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805092"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-type">CmmCondBranch</span></a></span><span> </span><span id="local-6989586621682805095"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805095"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682805096"><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805096"><span class="hs-identifier hs-var">z</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805092"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805095"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805096"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-776"></span><span class="annot"><a href="GHC.Cmm.Node.html#foldExp"><span class="hs-identifier hs-var">foldExp</span></a></span><span> </span><span id="local-6989586621682805097"><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805097"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-type">CmmSwitch</span></a></span><span> </span><span id="local-6989586621682805100"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805100"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682805101"><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805101"><span class="hs-identifier hs-var">z</span></a></span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805097"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805100"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805101"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-777"></span><span class="annot"><a href="GHC.Cmm.Node.html#foldExp"><span class="hs-identifier hs-var">foldExp</span></a></span><span> </span><span id="local-6989586621682805102"><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805102"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCall"><span class="hs-identifier hs-type">CmmCall</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">cml_target :: CmmNode 'Open 'Closed -&gt; CmmExpr
</span><a href="GHC.Cmm.Node.html#cml_target"><span class="hs-identifier hs-var">cml_target</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682805105"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805105"><span class="hs-identifier hs-var">tgt</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682805106"><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805106"><span class="hs-identifier hs-var">z</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805102"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805105"><span class="hs-identifier hs-var">tgt</span></a></span><span> </span><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805106"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-778"></span><span class="annot"><a href="GHC.Cmm.Node.html#foldExp"><span class="hs-identifier hs-var">foldExp</span></a></span><span> </span><span id="local-6989586621682805107"><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805107"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmForeignCall"><span class="hs-identifier hs-type">CmmForeignCall</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">tgt :: CmmNode 'Open 'Closed -&gt; ForeignTarget
</span><a href="GHC.Cmm.Node.html#tgt"><span class="hs-identifier hs-var">tgt</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682805111"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682805111"><span class="hs-identifier hs-var">tgt</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">args :: CmmNode 'Open 'Closed -&gt; [CmmExpr]
</span><a href="GHC.Cmm.Node.html#args"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682805112"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682805112"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682805113"><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805113"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; z -&gt; z) -&gt; z -&gt; [CmmExpr] -&gt; z
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805107"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; z -&gt; z) -&gt; ForeignTarget -&gt; z -&gt; z
forall z. (CmmExpr -&gt; z -&gt; z) -&gt; ForeignTarget -&gt; z -&gt; z
</span><a href="GHC.Cmm.Node.html#foldExpForeignTarget"><span class="hs-identifier hs-var">foldExpForeignTarget</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805107"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682805111"><span class="hs-identifier hs-var">tgt</span></a></span><span> </span><span class="annot"><span class="annottext">z
</span><a href="#local-6989586621682805113"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682805112"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-779"></span><span>
</span><span id="line-780"></span><span id="local-6989586621682805114"><span id="local-6989586621682805115"><span id="local-6989586621682805116"><span class="annot"><a href="GHC.Cmm.Node.html#foldExpDeep"><span class="hs-identifier hs-type">foldExpDeep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682805114"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682805114"><span class="hs-identifier hs-type">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682805115"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682805116"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682805114"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682805114"><span class="hs-identifier hs-type">z</span></a></span></span></span></span><span>
</span><span id="line-781"></span><span id="foldExpDeep"><span class="annot"><span class="annottext">foldExpDeep :: forall z (e :: Extensibility) (x :: Extensibility).
(CmmExpr -&gt; z -&gt; z) -&gt; CmmNode e x -&gt; z -&gt; z
</span><a href="GHC.Cmm.Node.html#foldExpDeep"><span class="hs-identifier hs-var hs-var">foldExpDeep</span></a></span></span><span> </span><span id="local-6989586621682805117"><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805117"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; z -&gt; z) -&gt; CmmNode e x -&gt; z -&gt; z
forall z (e :: Extensibility) (x :: Extensibility).
(CmmExpr -&gt; z -&gt; z) -&gt; CmmNode e x -&gt; z -&gt; z
</span><a href="GHC.Cmm.Node.html#foldExp"><span class="hs-identifier hs-var">foldExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; z -&gt; z) -&gt; CmmExpr -&gt; z -&gt; z
forall z. (CmmExpr -&gt; z -&gt; z) -&gt; CmmExpr -&gt; z -&gt; z
</span><a href="GHC.Cmm.Node.html#wrapRecExpf"><span class="hs-identifier hs-var">wrapRecExpf</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; z -&gt; z
</span><a href="#local-6989586621682805117"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-782"></span><span>
</span><span id="line-783"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-784"></span><span>
</span><span id="line-785"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapSuccessors"><span class="hs-identifier hs-type">mapSuccessors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#C"><span class="hs-identifier hs-type">C</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#C"><span class="hs-identifier hs-type">C</span></a></span><span>
</span><span id="line-786"></span><span id="mapSuccessors"><span class="annot"><span class="annottext">mapSuccessors :: (Label -&gt; Label) -&gt; CmmNode 'Open 'Closed -&gt; CmmNode 'Open 'Closed
</span><a href="GHC.Cmm.Node.html#mapSuccessors"><span class="hs-identifier hs-var hs-var">mapSuccessors</span></a></span></span><span> </span><span id="local-6989586621682805118"><span class="annot"><span class="annottext">Label -&gt; Label
</span><a href="#local-6989586621682805118"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmBranch"><span class="hs-identifier hs-type">CmmBranch</span></a></span><span> </span><span id="local-6989586621682805121"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805121"><span class="hs-identifier hs-var">bid</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; CmmNode 'Open 'Closed
</span><a href="GHC.Cmm.Node.html#CmmBranch"><span class="hs-identifier hs-var">CmmBranch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Label -&gt; Label
</span><a href="#local-6989586621682805118"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805121"><span class="hs-identifier hs-var">bid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-787"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapSuccessors"><span class="hs-identifier hs-var">mapSuccessors</span></a></span><span> </span><span id="local-6989586621682805122"><span class="annot"><span class="annottext">Label -&gt; Label
</span><a href="#local-6989586621682805122"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-type">CmmCondBranch</span></a></span><span> </span><span id="local-6989586621682805125"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805125"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621682805126"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805126"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621682805127"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805127"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682805128"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621682805128"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Label -&gt; Label -&gt; Maybe Bool -&gt; CmmNode 'Open 'Closed
</span><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-var">CmmCondBranch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805125"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Label -&gt; Label
</span><a href="#local-6989586621682805122"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805126"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Label -&gt; Label
</span><a href="#local-6989586621682805122"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805127"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621682805128"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-788"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapSuccessors"><span class="hs-identifier hs-var">mapSuccessors</span></a></span><span> </span><span id="local-6989586621682805129"><span class="annot"><span class="annottext">Label -&gt; Label
</span><a href="#local-6989586621682805129"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-type">CmmSwitch</span></a></span><span> </span><span id="local-6989586621682805132"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805132"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682805133"><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682805133"><span class="hs-identifier hs-var">ids</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; SwitchTargets -&gt; CmmNode 'Open 'Closed
</span><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-var">CmmSwitch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805132"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Label -&gt; Label) -&gt; SwitchTargets -&gt; SwitchTargets
</span><a href="GHC.Cmm.Switch.html#mapSwitchTargets"><span class="hs-identifier hs-var">mapSwitchTargets</span></a></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Label
</span><a href="#local-6989586621682805129"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682805133"><span class="hs-identifier hs-var">ids</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-789"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapSuccessors"><span class="hs-identifier hs-var">mapSuccessors</span></a></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Label
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682805135"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed
</span><a href="#local-6989586621682805135"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmNode 'Open 'Closed
</span><a href="#local-6989586621682805135"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-790"></span><span>
</span><span id="line-791"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapCollectSuccessors"><span class="hs-identifier hs-type">mapCollectSuccessors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682803745"><span class="annot"><a href="#local-6989586621682803745"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682803745"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#C"><span class="hs-identifier hs-type">C</span></a></span><span>
</span><span id="line-792"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#C"><span class="hs-identifier hs-type">C</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682803745"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-793"></span><span id="mapCollectSuccessors"><span class="annot"><span class="annottext">mapCollectSuccessors :: forall a.
(Label -&gt; (Label, a))
-&gt; CmmNode 'Open 'Closed -&gt; (CmmNode 'Open 'Closed, [a])
</span><a href="GHC.Cmm.Node.html#mapCollectSuccessors"><span class="hs-identifier hs-var hs-var">mapCollectSuccessors</span></a></span></span><span> </span><span id="local-6989586621682805136"><span class="annot"><span class="annottext">Label -&gt; (Label, a)
</span><a href="#local-6989586621682805136"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmBranch"><span class="hs-identifier hs-type">CmmBranch</span></a></span><span> </span><span id="local-6989586621682805139"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805139"><span class="hs-identifier hs-var">bid</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-794"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682805140"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805140"><span class="hs-identifier hs-var">bid'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682805141"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682805141"><span class="hs-identifier hs-var">acc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; (Label, a)
</span><a href="#local-6989586621682805136"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805139"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Label -&gt; CmmNode 'Open 'Closed
</span><a href="GHC.Cmm.Node.html#CmmBranch"><span class="hs-identifier hs-var">CmmBranch</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805140"><span class="hs-identifier hs-var">bid'</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682805141"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-795"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapCollectSuccessors"><span class="hs-identifier hs-var">mapCollectSuccessors</span></a></span><span> </span><span id="local-6989586621682805142"><span class="annot"><span class="annottext">Label -&gt; (Label, a)
</span><a href="#local-6989586621682805142"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-type">CmmCondBranch</span></a></span><span> </span><span id="local-6989586621682805145"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805145"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621682805146"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805146"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621682805147"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805147"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682805148"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621682805148"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-796"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682805149"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805149"><span class="hs-identifier hs-var">bidt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682805150"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682805150"><span class="hs-identifier hs-var">acct</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; (Label, a)
</span><a href="#local-6989586621682805142"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805146"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-797"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682805151"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805151"><span class="hs-identifier hs-var">bidf</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682805152"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682805152"><span class="hs-identifier hs-var">accf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; (Label, a)
</span><a href="#local-6989586621682805142"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805147"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-798"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; Label -&gt; Label -&gt; Maybe Bool -&gt; CmmNode 'Open 'Closed
</span><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-var">CmmCondBranch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805145"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805149"><span class="hs-identifier hs-var">bidt</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805151"><span class="hs-identifier hs-var">bidf</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621682805148"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682805152"><span class="hs-identifier hs-var">accf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682805150"><span class="hs-identifier hs-var">acct</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-799"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapCollectSuccessors"><span class="hs-identifier hs-var">mapCollectSuccessors</span></a></span><span> </span><span id="local-6989586621682805153"><span class="annot"><span class="annottext">Label -&gt; (Label, a)
</span><a href="#local-6989586621682805153"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-type">CmmSwitch</span></a></span><span> </span><span id="local-6989586621682805158"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805158"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682805159"><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682805159"><span class="hs-identifier hs-var">ids</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-800"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682805160"><span class="annot"><span class="annottext">lbls :: [Label]
</span><a href="#local-6989586621682805160"><span class="hs-identifier hs-var hs-var">lbls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SwitchTargets -&gt; [Label]
</span><a href="GHC.Cmm.Switch.html#switchTargetsToList"><span class="hs-identifier hs-var">switchTargetsToList</span></a></span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682805159"><span class="hs-identifier hs-var">ids</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-801"></span><span>        </span><span id="local-6989586621682805161"><span class="annot"><span class="annottext">lblMap :: LabelMap (Label, a)
</span><a href="#local-6989586621682805161"><span class="hs-identifier hs-var hs-var">lblMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Label, (Label, a))] -&gt; LabelMap (Label, a)
forall v. [(Label, v)] -&gt; LabelMap v
</span><a href="GHC.Cmm.Dataflow.Label.html#mapFromList"><span class="hs-identifier hs-var">mapFromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Label, (Label, a))] -&gt; LabelMap (Label, a))
-&gt; [(Label, (Label, a))] -&gt; LabelMap (Label, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Label] -&gt; [(Label, a)] -&gt; [(Label, (Label, a))]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Label]
</span><a href="#local-6989586621682805160"><span class="hs-identifier hs-var">lbls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Label -&gt; (Label, a)) -&gt; [Label] -&gt; [(Label, a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; (Label, a)
</span><a href="#local-6989586621682805153"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Label]
</span><a href="#local-6989586621682805160"><span class="hs-identifier hs-var">lbls</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682803745"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-802"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; SwitchTargets -&gt; CmmNode 'Open 'Closed
</span><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-var">CmmSwitch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682805158"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-803"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Label -&gt; Label) -&gt; SwitchTargets -&gt; SwitchTargets
</span><a href="GHC.Cmm.Switch.html#mapSwitchTargets"><span class="hs-identifier hs-var">mapSwitchTargets</span></a></span><span>
</span><span id="line-804"></span><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682805163"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805163"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Label, a) -&gt; Label
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Label, a) -&gt; Label) -&gt; (Label, a) -&gt; Label
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Label, a) -&gt; Label -&gt; LabelMap (Label, a) -&gt; (Label, a)
forall a. a -&gt; Label -&gt; LabelMap a -&gt; a
</span><a href="GHC.Cmm.Dataflow.Label.html#mapFindWithDefault"><span class="hs-identifier hs-var">mapFindWithDefault</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; (Label, a)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682805163"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMap (Label, a)
</span><a href="#local-6989586621682805161"><span class="hs-identifier hs-var">lblMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682805159"><span class="hs-identifier hs-var">ids</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-805"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">((Label, a) -&gt; a) -&gt; [(Label, a)] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Label, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LabelMap (Label, a) -&gt; [(Label, a)]
forall a. LabelMap a -&gt; [a]
</span><a href="GHC.Cmm.Dataflow.Label.html#mapElems"><span class="hs-identifier hs-var">mapElems</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMap (Label, a)
</span><a href="#local-6989586621682805161"><span class="hs-identifier hs-var">lblMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-806"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-807"></span><span class="annot"><a href="GHC.Cmm.Node.html#mapCollectSuccessors"><span class="hs-identifier hs-var">mapCollectSuccessors</span></a></span><span> </span><span class="annot"><span class="annottext">Label -&gt; (Label, a)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682805168"><span class="annot"><span class="annottext">CmmNode 'Open 'Closed
</span><a href="#local-6989586621682805168"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmNode 'Open 'Closed
</span><a href="#local-6989586621682805168"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-808"></span><span>
</span><span id="line-809"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-810"></span><span>
</span><span id="line-811"></span><span class="hs-comment">-- | Tick scope identifier, allowing us to reason about what</span><span>
</span><span id="line-812"></span><span class="hs-comment">-- annotations in a Cmm block should scope over. We especially take</span><span>
</span><span id="line-813"></span><span class="hs-comment">-- care to allow optimisations to reorganise blocks without losing</span><span>
</span><span id="line-814"></span><span class="hs-comment">-- tick association in the process.</span><span>
</span><span id="line-815"></span><span class="hs-keyword">data</span><span> </span><span id="CmmTickScope"><span class="annot"><a href="GHC.Cmm.Node.html#CmmTickScope"><span class="hs-identifier hs-var">CmmTickScope</span></a></span></span><span>
</span><span id="line-816"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="GlobalScope"><span class="annot"><a href="GHC.Cmm.Node.html#GlobalScope"><span class="hs-identifier hs-var">GlobalScope</span></a></span></span><span>
</span><span id="line-817"></span><span>    </span><span class="hs-comment">-- ^ The global scope is the &quot;root&quot; of the scope graph. Every</span><span>
</span><span id="line-818"></span><span>    </span><span class="hs-comment">-- scope is a sub-scope of the global scope. It doesn't make sense</span><span>
</span><span id="line-819"></span><span>    </span><span class="hs-comment">-- to add ticks to this scope. On the other hand, this means that</span><span>
</span><span id="line-820"></span><span>    </span><span class="hs-comment">-- setting this scope on a block means no ticks apply to it.</span><span>
</span><span id="line-821"></span><span>
</span><span id="line-822"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SubScope"><span class="annot"><a href="GHC.Cmm.Node.html#SubScope"><span class="hs-identifier hs-var">SubScope</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">U.Unique</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTickScope"><span class="hs-identifier hs-type">CmmTickScope</span></a></span><span>
</span><span id="line-823"></span><span>    </span><span class="hs-comment">-- ^ Constructs a new sub-scope to an existing scope. This allows</span><span>
</span><span id="line-824"></span><span>    </span><span class="hs-comment">-- us to translate Core-style scoping rules (see @tickishScoped@)</span><span>
</span><span id="line-825"></span><span>    </span><span class="hs-comment">-- into the Cmm world. Suppose the following code:</span><span>
</span><span id="line-826"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-827"></span><span>    </span><span class="hs-comment">--   tick&lt;1&gt; case ... of</span><span>
</span><span id="line-828"></span><span>    </span><span class="hs-comment">--             A -&gt; tick&lt;2&gt; ...</span><span>
</span><span id="line-829"></span><span>    </span><span class="hs-comment">--             B -&gt; tick&lt;3&gt; ...</span><span>
</span><span id="line-830"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-831"></span><span>    </span><span class="hs-comment">-- We want the top-level tick annotation to apply to blocks</span><span>
</span><span id="line-832"></span><span>    </span><span class="hs-comment">-- generated for the A and B alternatives. We can achieve that by</span><span>
</span><span id="line-833"></span><span>    </span><span class="hs-comment">-- generating tick&lt;1&gt; into a block with scope a, while the code</span><span>
</span><span id="line-834"></span><span>    </span><span class="hs-comment">-- for alternatives A and B gets generated into sub-scopes a/b and</span><span>
</span><span id="line-835"></span><span>    </span><span class="hs-comment">-- a/c respectively.</span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CombinedScope"><span class="annot"><a href="GHC.Cmm.Node.html#CombinedScope"><span class="hs-identifier hs-var">CombinedScope</span></a></span></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTickScope"><span class="hs-identifier hs-type">CmmTickScope</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTickScope"><span class="hs-identifier hs-type">CmmTickScope</span></a></span><span>
</span><span id="line-838"></span><span>    </span><span class="hs-comment">-- ^ A combined scope scopes over everything that the two given</span><span>
</span><span id="line-839"></span><span>    </span><span class="hs-comment">-- scopes cover. It is therefore a sub-scope of either scope. This</span><span>
</span><span id="line-840"></span><span>    </span><span class="hs-comment">-- is required for optimisations. Consider common block elimination:</span><span>
</span><span id="line-841"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-842"></span><span>    </span><span class="hs-comment">--   A -&gt; tick&lt;2&gt; case ... of</span><span>
</span><span id="line-843"></span><span>    </span><span class="hs-comment">--     C -&gt; [common]</span><span>
</span><span id="line-844"></span><span>    </span><span class="hs-comment">--   B -&gt; tick&lt;3&gt; case ... of</span><span>
</span><span id="line-845"></span><span>    </span><span class="hs-comment">--     D -&gt; [common]</span><span>
</span><span id="line-846"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-847"></span><span>    </span><span class="hs-comment">-- We will generate code for the C and D alternatives, and figure</span><span>
</span><span id="line-848"></span><span>    </span><span class="hs-comment">-- out afterwards that it's actually common code. Scoping rules</span><span>
</span><span id="line-849"></span><span>    </span><span class="hs-comment">-- dictate that the resulting common block needs to be covered by</span><span>
</span><span id="line-850"></span><span>    </span><span class="hs-comment">-- both tick&lt;2&gt; and tick&lt;3&gt;, therefore we need to construct a</span><span>
</span><span id="line-851"></span><span>    </span><span class="hs-comment">-- scope that is a child to *both* scope. Now we can do that - if</span><span>
</span><span id="line-852"></span><span>    </span><span class="hs-comment">-- we assign the scopes a/c and b/d to the common-ed up blocks,</span><span>
</span><span id="line-853"></span><span>    </span><span class="hs-comment">-- the new block could have a combined tick scope a/c+b/d, which</span><span>
</span><span id="line-854"></span><span>    </span><span class="hs-comment">-- both tick&lt;2&gt; and tick&lt;3&gt; apply to.</span><span>
</span><span id="line-855"></span><span>
</span><span id="line-856"></span><span class="hs-comment">-- Note [CmmTick scoping details]</span><span>
</span><span id="line-857"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-858"></span><span class="hs-comment">-- The scope of a @CmmTick@ is given by the @CmmEntry@ node of the</span><span>
</span><span id="line-859"></span><span class="hs-comment">-- same block. Note that as a result of this, optimisations making</span><span>
</span><span id="line-860"></span><span class="hs-comment">-- tick scopes more specific can *reduce* the amount of code a tick</span><span>
</span><span id="line-861"></span><span class="hs-comment">-- scopes over. Fixing this would require a separate @CmmTickScope@</span><span>
</span><span id="line-862"></span><span class="hs-comment">-- field for @CmmTick@. Right now we do not do this simply because I</span><span>
</span><span id="line-863"></span><span class="hs-comment">-- couldn't find an example where it actually mattered -- multiple</span><span>
</span><span id="line-864"></span><span class="hs-comment">-- blocks within the same scope generally jump to each other, which</span><span>
</span><span id="line-865"></span><span class="hs-comment">-- prevents common block elimination from happening in the first</span><span>
</span><span id="line-866"></span><span class="hs-comment">-- place. But this is no strong reason, so if Cmm optimisations become</span><span>
</span><span id="line-867"></span><span class="hs-comment">-- more involved in future this might have to be revisited.</span><span>
</span><span id="line-868"></span><span>
</span><span id="line-869"></span><span class="annot"><span class="hs-comment">-- | Output all scope paths.</span></span><span>
</span><span id="line-870"></span><span class="annot"><a href="GHC.Cmm.Node.html#scopeToPaths"><span class="hs-identifier hs-type">scopeToPaths</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTickScope"><span class="hs-identifier hs-type">CmmTickScope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">U.Unique</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-871"></span><span id="scopeToPaths"><span class="annot"><span class="annottext">scopeToPaths :: CmmTickScope -&gt; [[Unique]]
</span><a href="GHC.Cmm.Node.html#scopeToPaths"><span class="hs-identifier hs-var hs-var">scopeToPaths</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="GHC.Cmm.Node.html#GlobalScope"><span class="hs-identifier hs-var">GlobalScope</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-872"></span><span class="annot"><a href="GHC.Cmm.Node.html#scopeToPaths"><span class="hs-identifier hs-var">scopeToPaths</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#SubScope"><span class="hs-identifier hs-type">SubScope</span></a></span><span> </span><span id="local-6989586621682805173"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805173"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621682805174"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805174"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Unique] -&gt; [Unique]) -&gt; [[Unique]] -&gt; [[Unique]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805173"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Unique -&gt; [Unique] -&gt; [Unique]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmTickScope -&gt; [[Unique]]
</span><a href="GHC.Cmm.Node.html#scopeToPaths"><span class="hs-identifier hs-var">scopeToPaths</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805174"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-873"></span><span class="annot"><a href="GHC.Cmm.Node.html#scopeToPaths"><span class="hs-identifier hs-var">scopeToPaths</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CombinedScope"><span class="hs-identifier hs-type">CombinedScope</span></a></span><span> </span><span id="local-6989586621682805175"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805175"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621682805176"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805176"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmTickScope -&gt; [[Unique]]
</span><a href="GHC.Cmm.Node.html#scopeToPaths"><span class="hs-identifier hs-var">scopeToPaths</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805175"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">[[Unique]] -&gt; [[Unique]] -&gt; [[Unique]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope -&gt; [[Unique]]
</span><a href="GHC.Cmm.Node.html#scopeToPaths"><span class="hs-identifier hs-var">scopeToPaths</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805176"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-874"></span><span>
</span><span id="line-875"></span><span class="hs-comment">-- | Returns the head uniques of the scopes. This is based on the</span><span>
</span><span id="line-876"></span><span class="hs-comment">-- assumption that the @Unique@ of @SubScope@ identifies the</span><span>
</span><span id="line-877"></span><span class="hs-comment">-- underlying super-scope. Used for efficient equality and comparison,</span><span>
</span><span id="line-878"></span><span class="hs-comment">-- see below.</span><span>
</span><span id="line-879"></span><span class="annot"><a href="GHC.Cmm.Node.html#scopeUniques"><span class="hs-identifier hs-type">scopeUniques</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTickScope"><span class="hs-identifier hs-type">CmmTickScope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">U.Unique</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-880"></span><span id="scopeUniques"><span class="annot"><span class="annottext">scopeUniques :: CmmTickScope -&gt; [Unique]
</span><a href="GHC.Cmm.Node.html#scopeUniques"><span class="hs-identifier hs-var hs-var">scopeUniques</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="GHC.Cmm.Node.html#GlobalScope"><span class="hs-identifier hs-var">GlobalScope</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-881"></span><span class="annot"><a href="GHC.Cmm.Node.html#scopeUniques"><span class="hs-identifier hs-var">scopeUniques</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#SubScope"><span class="hs-identifier hs-type">SubScope</span></a></span><span> </span><span id="local-6989586621682805178"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805178"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805178"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-882"></span><span class="annot"><a href="GHC.Cmm.Node.html#scopeUniques"><span class="hs-identifier hs-var">scopeUniques</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CombinedScope"><span class="hs-identifier hs-type">CombinedScope</span></a></span><span> </span><span id="local-6989586621682805179"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805179"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621682805180"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805180"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmTickScope -&gt; [Unique]
</span><a href="GHC.Cmm.Node.html#scopeUniques"><span class="hs-identifier hs-var">scopeUniques</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805179"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">[Unique] -&gt; [Unique] -&gt; [Unique]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope -&gt; [Unique]
</span><a href="GHC.Cmm.Node.html#scopeUniques"><span class="hs-identifier hs-var">scopeUniques</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805180"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-883"></span><span>
</span><span id="line-884"></span><span class="hs-comment">-- Equality and order is based on the head uniques defined above. We</span><span>
</span><span id="line-885"></span><span class="hs-comment">-- take care to short-cut the (extremely) common cases.</span><span>
</span><span id="line-886"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682805183"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTickScope"><span class="hs-identifier hs-type">CmmTickScope</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-887"></span><span>  </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="GHC.Cmm.Node.html#GlobalScope"><span class="hs-identifier hs-var">GlobalScope</span></a></span><span>    </span><span id="local-6989586621682805188"><span class="annot"><span class="annottext">== :: CmmTickScope -&gt; CmmTickScope -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="GHC.Cmm.Node.html#GlobalScope"><span class="hs-identifier hs-var">GlobalScope</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-888"></span><span>  </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="GHC.Cmm.Node.html#GlobalScope"><span class="hs-identifier hs-var">GlobalScope</span></a></span><span>    </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-889"></span><span>  </span><span class="annot"><span class="annottext">CmmTickScope
</span><span class="hs-identifier">_</span></span><span>              </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="GHC.Cmm.Node.html#GlobalScope"><span class="hs-identifier hs-var">GlobalScope</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-890"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#SubScope"><span class="hs-identifier hs-type">SubScope</span></a></span><span> </span><span id="local-6989586621682805189"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805189"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#SubScope"><span class="hs-identifier hs-type">SubScope</span></a></span><span> </span><span id="local-6989586621682805190"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805190"><span class="hs-identifier hs-var">u'</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805189"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805190"><span class="hs-identifier hs-var">u'</span></a></span><span>
</span><span id="line-891"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#SubScope"><span class="hs-identifier hs-type">SubScope</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-892"></span><span>  </span><span class="annot"><span class="annottext">CmmTickScope
</span><span class="hs-identifier">_</span></span><span>              </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#SubScope"><span class="hs-identifier hs-type">SubScope</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-893"></span><span>  </span><span id="local-6989586621682805191"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805191"><span class="hs-identifier hs-var">scope</span></a></span></span><span>          </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span id="local-6989586621682805192"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805192"><span class="hs-identifier hs-var">scope'</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span>
</span><span id="line-894"></span><span>    </span><span class="annot"><span class="annottext">(Unique -&gt; Unique -&gt; Ordering) -&gt; [Unique] -&gt; [Unique]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Ordering
</span><a href="GHC.Types.Unique.html#nonDetCmpUnique"><span class="hs-identifier hs-var">nonDetCmpUnique</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmTickScope -&gt; [Unique]
</span><a href="GHC.Cmm.Node.html#scopeUniques"><span class="hs-identifier hs-var">scopeUniques</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805191"><span class="hs-identifier hs-var">scope</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Unique] -&gt; [Unique] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span>
</span><span id="line-895"></span><span>    </span><span class="annot"><span class="annottext">(Unique -&gt; Unique -&gt; Ordering) -&gt; [Unique] -&gt; [Unique]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Ordering
</span><a href="GHC.Types.Unique.html#nonDetCmpUnique"><span class="hs-identifier hs-var">nonDetCmpUnique</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmTickScope -&gt; [Unique]
</span><a href="GHC.Cmm.Node.html#scopeUniques"><span class="hs-identifier hs-var">scopeUniques</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805192"><span class="hs-identifier hs-var">scope'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-896"></span><span>    </span><span class="hs-comment">-- This is still deterministic because</span><span>
</span><span id="line-897"></span><span>    </span><span class="hs-comment">-- the order is the same for equal lists</span><span>
</span><span id="line-898"></span><span>
</span><span id="line-899"></span><span class="hs-comment">-- This is non-deterministic but we do not currently support deterministic</span><span>
</span><span id="line-900"></span><span class="hs-comment">-- code-generation. See Note [Unique Determinism and code generation]</span><span>
</span><span id="line-901"></span><span class="hs-comment">-- See Note [No Ord for Unique]</span><span>
</span><span id="line-902"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682805197"><span id="local-6989586621682805201"><span id="local-6989586621682805204"><span id="local-6989586621682805207"><span id="local-6989586621682805210"><span id="local-6989586621682805213"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTickScope"><span class="hs-identifier hs-type">CmmTickScope</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-903"></span><span>  </span><span id="local-6989586621682805218"><span class="annot"><span class="annottext">compare :: CmmTickScope -&gt; CmmTickScope -&gt; Ordering
</span><a href="#local-6989586621682805218"><span class="hs-identifier hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="GHC.Cmm.Node.html#GlobalScope"><span class="hs-identifier hs-var">GlobalScope</span></a></span><span>    </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="GHC.Cmm.Node.html#GlobalScope"><span class="hs-identifier hs-var">GlobalScope</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-904"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="GHC.Cmm.Node.html#GlobalScope"><span class="hs-identifier hs-var">GlobalScope</span></a></span><span>    </span><span class="annot"><span class="annottext">CmmTickScope
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-905"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><span class="hs-identifier">_</span></span><span>              </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="GHC.Cmm.Node.html#GlobalScope"><span class="hs-identifier hs-var">GlobalScope</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-906"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#SubScope"><span class="hs-identifier hs-type">SubScope</span></a></span><span> </span><span id="local-6989586621682805220"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805220"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#SubScope"><span class="hs-identifier hs-type">SubScope</span></a></span><span> </span><span id="local-6989586621682805221"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805221"><span class="hs-identifier hs-var">u'</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Ordering
</span><a href="GHC.Types.Unique.html#nonDetCmpUnique"><span class="hs-identifier hs-var">nonDetCmpUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805220"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805221"><span class="hs-identifier hs-var">u'</span></a></span><span>
</span><span id="line-907"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span id="local-6989586621682805222"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805222"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span id="local-6989586621682805223"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805223"><span class="hs-identifier hs-var">scope'</span></a></span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Unique -&gt; Unique -&gt; Ordering) -&gt; [Unique] -&gt; [Unique] -&gt; Ordering
forall a b. (a -&gt; b -&gt; Ordering) -&gt; [a] -&gt; [b] -&gt; Ordering
forall (f :: * -&gt; *) a b.
Ord1 f =&gt;
(a -&gt; b -&gt; Ordering) -&gt; f a -&gt; f b -&gt; Ordering
</span><a href="../../base-4.21.0.0-ae91/src/Data.Functor.Classes.html#liftCompare"><span class="hs-identifier hs-var">liftCompare</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Ordering
</span><a href="GHC.Types.Unique.html#nonDetCmpUnique"><span class="hs-identifier hs-var">nonDetCmpUnique</span></a></span><span>
</span><span id="line-908"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Unique -&gt; Unique -&gt; Ordering) -&gt; [Unique] -&gt; [Unique]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Ordering
</span><a href="GHC.Types.Unique.html#nonDetCmpUnique"><span class="hs-identifier hs-var">nonDetCmpUnique</span></a></span><span> </span><span class="annot"><span class="annottext">([Unique] -&gt; [Unique]) -&gt; [Unique] -&gt; [Unique]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope -&gt; [Unique]
</span><a href="GHC.Cmm.Node.html#scopeUniques"><span class="hs-identifier hs-var">scopeUniques</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805222"><span class="hs-identifier hs-var">scope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-909"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Unique -&gt; Unique -&gt; Ordering) -&gt; [Unique] -&gt; [Unique]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Ordering
</span><a href="GHC.Types.Unique.html#nonDetCmpUnique"><span class="hs-identifier hs-var">nonDetCmpUnique</span></a></span><span> </span><span class="annot"><span class="annottext">([Unique] -&gt; [Unique]) -&gt; [Unique] -&gt; [Unique]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope -&gt; [Unique]
</span><a href="GHC.Cmm.Node.html#scopeUniques"><span class="hs-identifier hs-var">scopeUniques</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805223"><span class="hs-identifier hs-var">scope'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-910"></span><span>
</span><span id="line-911"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTickScope"><span class="hs-identifier hs-type">CmmTickScope</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-912"></span><span>  </span><span id="local-6989586621682805241"><span class="annot"><span class="annottext">ppr :: CmmTickScope -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="GHC.Cmm.Node.html#GlobalScope"><span class="hs-identifier hs-var">GlobalScope</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;global&quot;</span></span><span>
</span><span id="line-913"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#SubScope"><span class="hs-identifier hs-type">SubScope</span></a></span><span> </span><span id="local-6989586621682805242"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805242"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="GHC.Cmm.Node.html#GlobalScope"><span class="hs-identifier hs-var">GlobalScope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-914"></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805242"><span class="hs-identifier hs-var">us</span></a></span><span>
</span><span id="line-915"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#SubScope"><span class="hs-identifier hs-type">SubScope</span></a></span><span> </span><span id="local-6989586621682805243"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805243"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span id="local-6989586621682805244"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805244"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmTickScope -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805244"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805243"><span class="hs-identifier hs-var">us</span></a></span><span>
</span><span id="line-916"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span id="local-6989586621682805245"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805245"><span class="hs-identifier hs-var">combined</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hcat"><span class="hs-identifier hs-var">hcat</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; [SDoc] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; [SDoc] -&gt; [SDoc]
forall doc. IsLine doc =&gt; doc -&gt; [doc] -&gt; [doc]
</span><a href="GHC.Utils.Outputable.html#punctuate"><span class="hs-identifier hs-var">punctuate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'+'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; [SDoc]) -&gt; [SDoc] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-917"></span><span>                        </span><span class="annot"><span class="annottext">([Unique] -&gt; SDoc) -&gt; [[Unique]] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hcat"><span class="hs-identifier hs-var">hcat</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; ([Unique] -&gt; [SDoc]) -&gt; [Unique] -&gt; SDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; [SDoc] -&gt; [SDoc]
forall doc. IsLine doc =&gt; doc -&gt; [doc] -&gt; [doc]
</span><a href="GHC.Utils.Outputable.html#punctuate"><span class="hs-identifier hs-var">punctuate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; [SDoc]) -&gt; ([Unique] -&gt; [SDoc]) -&gt; [Unique] -&gt; [SDoc]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Unique -&gt; SDoc) -&gt; [Unique] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">([Unique] -&gt; [SDoc])
-&gt; ([Unique] -&gt; [Unique]) -&gt; [Unique] -&gt; [SDoc]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Unique] -&gt; [Unique]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[Unique]] -&gt; [SDoc]) -&gt; [[Unique]] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-918"></span><span>                        </span><span class="annot"><span class="annottext">CmmTickScope -&gt; [[Unique]]
</span><a href="GHC.Cmm.Node.html#scopeToPaths"><span class="hs-identifier hs-var">scopeToPaths</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805245"><span class="hs-identifier hs-var">combined</span></a></span><span>
</span><span id="line-919"></span><span>
</span><span id="line-920"></span><span class="hs-comment">-- | Checks whether two tick scopes are sub-scopes of each other. True</span><span>
</span><span id="line-921"></span><span class="hs-comment">-- if the two scopes are equal.</span><span>
</span><span id="line-922"></span><span class="annot"><a href="GHC.Cmm.Node.html#isTickSubScope"><span class="hs-identifier hs-type">isTickSubScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTickScope"><span class="hs-identifier hs-type">CmmTickScope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTickScope"><span class="hs-identifier hs-type">CmmTickScope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-923"></span><span id="isTickSubScope"><span class="annot"><span class="annottext">isTickSubScope :: CmmTickScope -&gt; CmmTickScope -&gt; Bool
</span><a href="GHC.Cmm.Node.html#isTickSubScope"><span class="hs-identifier hs-var hs-var">isTickSubScope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmTickScope -&gt; CmmTickScope -&gt; Bool
</span><a href="#local-6989586621682805247"><span class="hs-identifier hs-var">cmp</span></a></span><span>
</span><span id="line-924"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682805247"><span class="annot"><span class="annottext">cmp :: CmmTickScope -&gt; CmmTickScope -&gt; Bool
</span><a href="#local-6989586621682805247"><span class="hs-identifier hs-var hs-var">cmp</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><span class="hs-identifier">_</span></span><span>              </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="GHC.Cmm.Node.html#GlobalScope"><span class="hs-identifier hs-var">GlobalScope</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-925"></span><span>        </span><span class="annot"><a href="#local-6989586621682805247"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="GHC.Cmm.Node.html#GlobalScope"><span class="hs-identifier hs-var">GlobalScope</span></a></span><span>    </span><span class="annot"><span class="annottext">CmmTickScope
</span><span class="hs-identifier">_</span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-926"></span><span>        </span><span class="annot"><a href="#local-6989586621682805247"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CombinedScope"><span class="hs-identifier hs-type">CombinedScope</span></a></span><span> </span><span id="local-6989586621682805249"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805249"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621682805250"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805250"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682805251"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805251"><span class="hs-identifier hs-var">s'</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmTickScope -&gt; CmmTickScope -&gt; Bool
</span><a href="#local-6989586621682805247"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805249"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805251"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope -&gt; CmmTickScope -&gt; Bool
</span><a href="#local-6989586621682805247"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805250"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805251"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-927"></span><span>        </span><span class="annot"><a href="#local-6989586621682805247"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span id="local-6989586621682805253"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805253"><span class="hs-identifier hs-var">s</span></a></span></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#CombinedScope"><span class="hs-identifier hs-type">CombinedScope</span></a></span><span> </span><span id="local-6989586621682805254"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805254"><span class="hs-identifier hs-var">s1'</span></a></span></span><span> </span><span id="local-6989586621682805255"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805255"><span class="hs-identifier hs-var">s2'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmTickScope -&gt; CmmTickScope -&gt; Bool
</span><a href="#local-6989586621682805247"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805253"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805254"><span class="hs-identifier hs-var">s1'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope -&gt; CmmTickScope -&gt; Bool
</span><a href="#local-6989586621682805247"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805253"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805255"><span class="hs-identifier hs-var">s2'</span></a></span><span>
</span><span id="line-928"></span><span>        </span><span class="annot"><a href="#local-6989586621682805247"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#SubScope"><span class="hs-identifier hs-type">SubScope</span></a></span><span> </span><span id="local-6989586621682805257"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805257"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621682805258"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805258"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682805259"><span class="annot"><span class="annottext">s' :: CmmTickScope
</span><a href="#local-6989586621682805259"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#SubScope"><span class="hs-identifier hs-type">SubScope</span></a></span><span> </span><span id="local-6989586621682805260"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805260"><span class="hs-identifier hs-var">u'</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805257"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682805260"><span class="hs-identifier hs-var">u'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">CmmTickScope -&gt; CmmTickScope -&gt; Bool
</span><a href="#local-6989586621682805247"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805258"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805259"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-929"></span><span>
</span><span id="line-930"></span><span class="hs-comment">-- | Combine two tick scopes. The new scope should be sub-scope of</span><span>
</span><span id="line-931"></span><span class="hs-comment">-- both parameters. We simplify automatically if one tick scope is a</span><span>
</span><span id="line-932"></span><span class="hs-comment">-- sub-scope of the other already.</span><span>
</span><span id="line-933"></span><span class="annot"><a href="GHC.Cmm.Node.html#combineTickScopes"><span class="hs-identifier hs-type">combineTickScopes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTickScope"><span class="hs-identifier hs-type">CmmTickScope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTickScope"><span class="hs-identifier hs-type">CmmTickScope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTickScope"><span class="hs-identifier hs-type">CmmTickScope</span></a></span><span>
</span><span id="line-934"></span><span id="combineTickScopes"><span class="annot"><span class="annottext">combineTickScopes :: CmmTickScope -&gt; CmmTickScope -&gt; CmmTickScope
</span><a href="GHC.Cmm.Node.html#combineTickScopes"><span class="hs-identifier hs-var hs-var">combineTickScopes</span></a></span></span><span> </span><span id="local-6989586621682805261"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805261"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621682805262"><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805262"><span class="hs-identifier hs-var">s2</span></a></span></span><span>
</span><span id="line-935"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805261"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope -&gt; CmmTickScope -&gt; Bool
</span><a href="GHC.Cmm.Node.html#isTickSubScope"><span class="hs-operator hs-var">`isTickSubScope`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805262"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805261"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-936"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805262"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope -&gt; CmmTickScope -&gt; Bool
</span><a href="GHC.Cmm.Node.html#isTickSubScope"><span class="hs-operator hs-var">`isTickSubScope`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805261"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805262"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-937"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmTickScope -&gt; CmmTickScope -&gt; CmmTickScope
</span><a href="GHC.Cmm.Node.html#CombinedScope"><span class="hs-identifier hs-var">CombinedScope</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805261"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">CmmTickScope
</span><a href="#local-6989586621682805262"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-938"></span></pre></body></html>