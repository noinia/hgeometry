<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies        #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-uni-patterns #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-comment">{-
(c) The University of Glasgow 2011

-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="annot"><span class="hs-comment">-- | The deriving code for the Generic class</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html"><span class="hs-identifier">GHC.Tc.Deriv.Generics</span></a></span><span>
</span><span id="line-15"></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#canDoGenerics"><span class="hs-identifier">canDoGenerics</span></a></span><span>
</span><span id="line-16"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#canDoGenerics1"><span class="hs-identifier">canDoGenerics1</span></a></span><span>
</span><span id="line-17"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#GenericKind"><span class="hs-identifier">GenericKind</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#gen_Generic_binds"><span class="hs-identifier">gen_Generic_binds</span></a></span><span>
</span><span id="line-19"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#gen_Generic_fam_inst"><span class="hs-identifier">gen_Generic_fam_inst</span></a></span><span>
</span><span id="line-20"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#get_gen1_constrained_tys"><span class="hs-identifier">get_gen1_constrained_tys</span></a></span><span>
</span><span id="line-21"></span><span>   </span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Prelude.Basic.html#head"><span class="hs-identifier">head</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">init</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">last</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Prelude.Basic.html#tail"><span class="hs-identifier">tail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Hs.html"><span class="hs-identifier">GHC.Hs</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html"><span class="hs-identifier">GHC.Tc.Utils.TcType</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generate.html"><span class="hs-identifier">GHC.Tc.Deriv.Generate</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Functor.html"><span class="hs-identifier">GHC.Tc.Deriv.Functor</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html"><span class="hs-identifier">GHC.Tc.Errors.Types</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Instantiate.html"><span class="hs-identifier">GHC.Tc.Utils.Instantiate</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Instantiate.html#newFamInst"><span class="hs-identifier">newFamInst</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html"><span class="hs-identifier">GHC.Tc.Utils.Env</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html"><span class="hs-identifier">GHC.Tc.Utils.Monad</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html"><span class="hs-identifier">GHC.Core.DataCon</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html"><span class="hs-identifier">GHC.Core.FamInstEnv</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#FamInst"><span class="hs-identifier">FamInst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#FamFlavor"><span class="hs-identifier">FamFlavor</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#mkSingleCoAxiom"><span class="hs-identifier">mkSingleCoAxiom</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html"><span class="hs-identifier">GHC.Unit.Module</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#moduleName"><span class="hs-identifier">moduleName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#moduleUnit"><span class="hs-identifier">moduleUnit</span></a></span><span>
</span><span id="line-41"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#unitFS"><span class="hs-identifier">unitFS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html#getModule"><span class="hs-identifier">getModule</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Iface.Env.html"><span class="hs-identifier">GHC.Iface.Env</span></a></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Iface.Env.html#newGlobalBinder"><span class="hs-identifier">newGlobalBinder</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#varName"><span class="hs-identifier">varName</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html"><span class="hs-identifier">GHC.Types.Name.Reader</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SourceText.html"><span class="hs-identifier">GHC.Types.SourceText</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Fixity.html"><span class="hs-identifier">GHC.Types.Fixity</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html"><span class="hs-identifier">GHC.Types.Var.Env</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html"><span class="hs-identifier">GHC.Types.Var.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-identifier">elemVarSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.Prim.html"><span class="hs-identifier">GHC.Builtin.Types.Prim</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html"><span class="hs-identifier">GHC.Builtin.Types</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html"><span class="hs-identifier">GHC.Utils.Error</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier">Validity'</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#andValid"><span class="hs-identifier">andValid</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html"><span class="hs-identifier">GHC.Driver.DynFlags</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html"><span class="hs-identifier">Language.Haskell.Syntax.Basic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#FieldLabelString"><span class="hs-identifier">FieldLabelString</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mplus</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">zip4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">partition</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Partial</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">last</span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#nonEmpty"><span class="hs-identifier">nonEmpty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Bindings for the new generic deriving mechanism}
*                                                                      *
************************************************************************

For the generic representation we need to generate:
\begin{itemize}
\item A Generic instance
\item A Rep type instance
\item Many auxiliary datatypes and instances for them (for the meta-information)
\end{itemize}
-}</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#gen_Generic_binds"><span class="hs-identifier hs-type">gen_Generic_binds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#GenericKind"><span class="hs-identifier hs-type">GenericKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generate.html#DerivInstTys"><span class="hs-identifier hs-type">DerivInstTys</span></a></span><span>
</span><span id="line-91"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span id="gen_Generic_binds"><span class="annot"><span class="annottext">gen_Generic_binds :: GenericKind
-&gt; SrcSpan -&gt; DerivInstTys -&gt; TcM (LHsBinds GhcPs, [LSig GhcPs])
</span><a href="GHC.Tc.Deriv.Generics.html#gen_Generic_binds"><span class="hs-identifier hs-var hs-var">gen_Generic_binds</span></a></span></span><span> </span><span id="local-6989586621683094268"><span class="annot"><span class="annottext">GenericKind
</span><a href="#local-6989586621683094268"><span class="hs-identifier hs-var">gk</span></a></span></span><span> </span><span id="local-6989586621683094269"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683094269"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683094270"><span class="annot"><span class="annottext">DerivInstTys
</span><a href="#local-6989586621683094270"><span class="hs-identifier hs-var">dit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-93"></span><span>  </span><span id="local-6989586621683094271"><span class="annot"><a href="#local-6989586621683094271"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#mkBindsRep"><span class="hs-identifier hs-type">mkBindsRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094271"><span class="hs-identifier hs-type">dflags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094268"><span class="hs-identifier hs-type">gk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094269"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094270"><span class="hs-identifier hs-type">dit</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Generating representation types}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | Called by 'GHC.Tc.Deriv.Infer.inferConstraints'; generates a list of</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- types, each of which must be a 'Functor' in order for the 'Generic1'</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- instance to work. For instance, if we have:</span><span>
</span><span id="line-107"></span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- data Foo a = MkFoo Int a (Maybe a) (Either Int (Maybe a))</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-111"></span><span class="hs-comment">--</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- Then @'get_gen1_constrained_tys' a (f (g a))@ would return @[Either Int]@,</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- as a derived 'Generic1' instance would need to call 'fmap' at that type.</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- Invoking @'get_gen1_constrained_tys' a@ on any of the other fields would</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- return @[]@.</span><span>
</span><span id="line-116"></span><span class="hs-comment">--</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- 'get_gen1_constrained_tys' is very similar in spirit to</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- 'deepSubtypesContaining' in &quot;GHC.Tc.Deriv.Functor&quot;. Just like with</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- 'deepSubtypesContaining', it is important that the 'TyVar' argument come</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- from 'dataConUnivTyVars'. (See #22167 for what goes wrong if 'tyConTyVars'</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- is used.)</span><span>
</span><span id="line-122"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#get_gen1_constrained_tys"><span class="hs-identifier hs-type">get_gen1_constrained_tys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span id="get_gen1_constrained_tys"><span class="annot"><span class="annottext">get_gen1_constrained_tys :: TyVar -&gt; Type -&gt; [Type]
</span><a href="GHC.Tc.Deriv.Generics.html#get_gen1_constrained_tys"><span class="hs-identifier hs-var hs-var">get_gen1_constrained_tys</span></a></span></span><span> </span><span id="local-6989586621683094277"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094277"><span class="hs-identifier hs-var">argVar</span></a></span></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; ArgTyAlg [Type] -&gt; Type -&gt; [Type]
forall a. TyVar -&gt; ArgTyAlg a -&gt; Type -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#argTyFold"><span class="hs-identifier hs-var">argTyFold</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094277"><span class="hs-identifier hs-var">argVar</span></a></span><span> </span><span class="annot"><span class="annottext">(ArgTyAlg [Type] -&gt; Type -&gt; [Type])
-&gt; ArgTyAlg [Type] -&gt; Type -&gt; [Type]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#ArgTyAlg"><span class="hs-identifier hs-type">ArgTyAlg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ata_rec0 :: Type -&gt; [Type]
</span><a href="GHC.Tc.Deriv.Generics.html#ata_rec0"><span class="hs-identifier hs-var">ata_rec0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Type -&gt; [Type]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ata_par1 :: [Type]
</span><a href="GHC.Tc.Deriv.Generics.html#ata_par1"><span class="hs-identifier hs-var">ata_par1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ata_rec1 :: Type -&gt; [Type]
</span><a href="GHC.Tc.Deriv.Generics.html#ata_rec1"><span class="hs-identifier hs-var">ata_rec1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Type -&gt; [Type]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-126"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ata_comp :: Type -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Tc.Deriv.Generics.html#ata_comp"><span class="hs-identifier hs-var">ata_comp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">{-

Note [Requirements for deriving Generic and Rep]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

In the following, T, Tfun, and Targ are &quot;meta-variables&quot; ranging over type
expressions.

(Generic T) and (Rep T) are derivable for some type expression T if the
following constraints are satisfied.

  (a) D is a type constructor *value*. In other words, D is either a type
      constructor or it is equivalent to the head of a data family instance (up to
      alpha-renaming).

  (b) D cannot have a &quot;stupid context&quot;.
      See Note [The stupid context] in GHC.Core.DataCon.

  (c) The right-hand side of D cannot include existential types, universally
      quantified types, or &quot;exotic&quot; unlifted types. An exotic unlifted type
      is one which is not listed in the definition of allowedUnliftedTy
      (i.e., one for which we have no representation type).
      See Note [Generics and unlifted types]

  (d) T :: *.

(Generic1 T) and (Rep1 T) are derivable for some type expression T if the
following constraints are satisfied.

  (a),(b),(c) As above.

  (d) T must expect arguments, and its last parameter must have kind *.

      We use `a' to denote the parameter of D that corresponds to the last
      parameter of T.

  (e) For any type-level application (Tfun Targ) in the right-hand side of D
      where the head of Tfun is not a tuple constructor:

      (b1) `a' must not occur in Tfun.

      (b2) If `a' occurs in Targ, then Tfun :: * -&gt; *.

-}</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#canDoGenerics"><span class="hs-identifier hs-type">canDoGenerics</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generate.html#DerivInstTys"><span class="hs-identifier hs-type">DerivInstTys</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#DeriveGenericsErrReason"><span class="hs-identifier hs-type">DeriveGenericsErrReason</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- canDoGenerics determines if Generic/Rep can be derived.</span><span>
</span><span id="line-175"></span><span class="hs-comment">--</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- Check (a) from Note [Requirements for deriving Generic and Rep] is taken</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- care of because canDoGenerics is applied to rep tycons.</span><span>
</span><span id="line-178"></span><span class="hs-comment">--</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- It returns IsValid if deriving is possible. It returns (NotValid reason)</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- if not.</span><span>
</span><span id="line-181"></span><span id="canDoGenerics"><span class="annot"><span class="annottext">canDoGenerics :: DerivInstTys -&gt; Validity' [DeriveGenericsErrReason]
</span><a href="GHC.Tc.Deriv.Generics.html#canDoGenerics"><span class="hs-identifier hs-var hs-var">canDoGenerics</span></a></span></span><span> </span><span id="local-6989586621683094285"><span class="annot"><span class="annottext">dit :: DerivInstTys
</span><a href="#local-6989586621683094285"><span class="hs-identifier hs-var">dit</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Deriv.Generate.html#DerivInstTys"><span class="hs-identifier hs-type">DerivInstTys</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">dit_rep_tc :: DerivInstTys -&gt; TyCon
</span><a href="GHC.Tc.Deriv.Generate.html#dit_rep_tc"><span class="hs-identifier hs-var">dit_rep_tc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683094288"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094288"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Validity' DeriveGenericsErrReason]
-&gt; Validity' [DeriveGenericsErrReason]
forall a. [Validity' a] -&gt; Validity' [a]
</span><a href="GHC.Tc.Deriv.Generics.html#mergeErrors"><span class="hs-identifier hs-var">mergeErrors</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-183"></span><span>          </span><span class="hs-comment">-- Check (b) from Note [Requirements for deriving Generic and Rep].</span><span>
</span><span id="line-184"></span><span>              </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type]
</span><a href="GHC.Core.TyCon.html#tyConStupidTheta"><span class="hs-identifier hs-var">tyConStupidTheta</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094288"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DeriveGenericsErrReason -&gt; Validity' DeriveGenericsErrReason
forall a. a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="annot"><span class="annottext">(DeriveGenericsErrReason -&gt; Validity' DeriveGenericsErrReason)
-&gt; DeriveGenericsErrReason -&gt; Validity' DeriveGenericsErrReason
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; DeriveGenericsErrReason
</span><a href="GHC.Tc.Errors.Types.html#DerivErrGenericsMustNotHaveDatatypeContext"><span class="hs-identifier hs-var">DerivErrGenericsMustNotHaveDatatypeContext</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094295"><span class="hs-identifier hs-var">tc_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Validity' DeriveGenericsErrReason
forall a. Validity' a
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>          </span><span class="hs-comment">-- See comment below</span><span>
</span><span id="line-188"></span><span>            </span><span class="annot"><span class="annottext">Validity' DeriveGenericsErrReason
-&gt; [Validity' DeriveGenericsErrReason]
-&gt; [Validity' DeriveGenericsErrReason]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DataCon -&gt; Validity' DeriveGenericsErrReason)
-&gt; [DataCon] -&gt; [Validity' DeriveGenericsErrReason]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Validity' DeriveGenericsErrReason
</span><a href="#local-6989586621683094297"><span class="hs-identifier hs-var">bad_con</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [DataCon]
</span><a href="GHC.Core.TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094288"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-comment">-- The tc can be a representation tycon. When we want to display it to the</span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-comment">-- user (in an error message) we should print its parent</span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621683094295"><span class="annot"><span class="annottext">tc_name :: TyCon
</span><a href="#local-6989586621683094295"><span class="hs-identifier hs-var hs-var">tc_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.TyCon.html#tyConFamInst_maybe"><span class="hs-identifier hs-var">tyConFamInst_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094288"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-193"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683094300"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094300"><span class="hs-identifier hs-var">ptc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094300"><span class="hs-identifier hs-var">ptc</span></a></span><span>
</span><span id="line-194"></span><span>        </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094288"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span>        </span><span class="hs-comment">-- Check (c) from Note [Requirements for deriving Generic and Rep].</span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-198"></span><span>        </span><span class="hs-comment">-- If any of the constructors has an exotic unlifted type as argument,</span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-comment">-- then we can't build the embedding-projection pair, because</span><span>
</span><span id="line-200"></span><span>        </span><span class="hs-comment">-- it relies on instantiating *polymorphic* sum and product types</span><span>
</span><span id="line-201"></span><span>        </span><span class="hs-comment">-- at the argument types of the constructors</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><a href="#local-6989586621683094297"><span class="hs-identifier hs-type">bad_con</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#DeriveGenericsErrReason"><span class="hs-identifier hs-type">DeriveGenericsErrReason</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621683094297"><span class="annot"><span class="annottext">bad_con :: DataCon -&gt; Validity' DeriveGenericsErrReason
</span><a href="#local-6989586621683094297"><span class="hs-identifier hs-var hs-var">bad_con</span></a></span></span><span> </span><span id="local-6989586621683094301"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094301"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621683094303"><span class="hs-identifier hs-var">bad_arg_type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; DerivInstTys -&gt; [Type]
</span><a href="GHC.Tc.Deriv.Generate.html#derivDataConInstArgTys"><span class="hs-identifier hs-var">derivDataConInstArgTys</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094301"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">DerivInstTys
</span><a href="#local-6989586621683094285"><span class="hs-identifier hs-var">dit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DeriveGenericsErrReason -&gt; Validity' DeriveGenericsErrReason
forall a. a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="annot"><span class="annottext">(DeriveGenericsErrReason -&gt; Validity' DeriveGenericsErrReason)
-&gt; DeriveGenericsErrReason -&gt; Validity' DeriveGenericsErrReason
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; DeriveGenericsErrReason
</span><a href="GHC.Tc.Errors.Types.html#DerivErrGenericsMustNotHaveExoticArgs"><span class="hs-identifier hs-var">DerivErrGenericsMustNotHaveExoticArgs</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094301"><span class="hs-identifier hs-var">dc</span></a></span><span>
</span><span id="line-205"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isVanillaDataCon"><span class="hs-identifier hs-var">isVanillaDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094301"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>                          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DeriveGenericsErrReason -&gt; Validity' DeriveGenericsErrReason
forall a. a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="annot"><span class="annottext">(DeriveGenericsErrReason -&gt; Validity' DeriveGenericsErrReason)
-&gt; DeriveGenericsErrReason -&gt; Validity' DeriveGenericsErrReason
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; DeriveGenericsErrReason
</span><a href="GHC.Tc.Errors.Types.html#DerivErrGenericsMustBeVanillaDataCon"><span class="hs-identifier hs-var">DerivErrGenericsMustBeVanillaDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094301"><span class="hs-identifier hs-var">dc</span></a></span><span>
</span><span id="line-207"></span><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Validity' DeriveGenericsErrReason
forall a. Validity' a
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>        </span><span class="hs-comment">-- Nor can we do the job if it's an existential data constructor,</span><span>
</span><span id="line-210"></span><span>        </span><span class="hs-comment">-- Nor if the args are polymorphic types (I don't think)</span><span>
</span><span id="line-211"></span><span>    </span><span id="local-6989586621683094303"><span class="annot"><span class="annottext">bad_arg_type :: Type -&gt; Bool
</span><a href="#local-6989586621683094303"><span class="hs-identifier hs-var hs-var">bad_arg_type</span></a></span></span><span> </span><span id="local-6989586621683094308"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094308"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#mightBeUnliftedType"><span class="hs-identifier hs-var">mightBeUnliftedType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094308"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Deriv.Generics.html#allowedUnliftedTy"><span class="hs-identifier hs-var">allowedUnliftedTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094308"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>                      </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094308"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- Returns True the Type argument is an unlifted type which has a</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- corresponding generic representation type. For example,</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- (allowedUnliftedTy Int#) would return True since there is the UInt</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- representation type.</span><span>
</span><span id="line-218"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#allowedUnliftedTy"><span class="hs-identifier hs-type">allowedUnliftedTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-219"></span><span id="allowedUnliftedTy"><span class="annot"><span class="annottext">allowedUnliftedTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Deriv.Generics.html#allowedUnliftedTy"><span class="hs-identifier hs-var hs-var">allowedUnliftedTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (RdrName, RdrName) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (RdrName, RdrName) -&gt; Bool)
-&gt; (Type -&gt; Maybe (RdrName, RdrName)) -&gt; Type -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (RdrName, RdrName)
</span><a href="GHC.Tc.Deriv.Generics.html#unboxedRepRDRs"><span class="hs-identifier hs-var">unboxedRepRDRs</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span id="local-6989586621683093777"><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#mergeErrors"><span class="hs-identifier hs-type">mergeErrors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683093777"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683093777"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-222"></span><span id="mergeErrors"><span class="annot"><span class="annottext">mergeErrors :: forall a. [Validity' a] -&gt; Validity' [a]
</span><a href="GHC.Tc.Deriv.Generics.html#mergeErrors"><span class="hs-identifier hs-var hs-var">mergeErrors</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Validity' [a]
forall a. Validity' a
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-223"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#mergeErrors"><span class="hs-identifier hs-var">mergeErrors</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-type">NotValid</span></a></span><span> </span><span id="local-6989586621683094316"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621683094316"><span class="hs-identifier hs-var">s</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621683094317"><span class="annot"><span class="annottext">[Validity' a]
</span><a href="#local-6989586621683094317"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Validity' a] -&gt; Validity' [a]
forall a. [Validity' a] -&gt; Validity' [a]
</span><a href="GHC.Tc.Deriv.Generics.html#mergeErrors"><span class="hs-identifier hs-var">mergeErrors</span></a></span><span> </span><span class="annot"><span class="annottext">[Validity' a]
</span><a href="#local-6989586621683094317"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><span class="annottext">Validity' [a]
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Validity' [a]
forall a. a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621683094316"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-type">NotValid</span></a></span><span> </span><span id="local-6989586621683094318"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621683094318"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Validity' [a]
forall a. a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621683094316"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621683094318"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#mergeErrors"><span class="hs-identifier hs-var">mergeErrors</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Validity' a
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621683094319"><span class="annot"><span class="annottext">[Validity' a]
</span><a href="#local-6989586621683094319"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Validity' a] -&gt; Validity' [a]
forall a. [Validity' a] -&gt; Validity' [a]
</span><a href="GHC.Tc.Deriv.Generics.html#mergeErrors"><span class="hs-identifier hs-var">mergeErrors</span></a></span><span> </span><span class="annot"><span class="annottext">[Validity' a]
</span><a href="#local-6989586621683094319"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-comment">-- NotValid s' -&gt; NotValid (s &lt;&gt; text &quot;, and&quot; $$ s')</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-comment">-- A datatype used only inside of canDoGenerics1. It's the result of analysing</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- a type term.</span><span>
</span><span id="line-231"></span><span class="hs-keyword">data</span><span> </span><span id="Check_for_CanDoGenerics1"><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#Check_for_CanDoGenerics1"><span class="hs-identifier hs-var">Check_for_CanDoGenerics1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CCDG1"><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#CCDG1"><span class="hs-identifier hs-var">CCDG1</span></a></span></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_ccdg1_hasParam"><span class="annot"><span class="annottext">Check_for_CanDoGenerics1 -&gt; Bool
</span><a href="GHC.Tc.Deriv.Generics.html#_ccdg1_hasParam"><span class="hs-identifier hs-var hs-var">_ccdg1_hasParam</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>       </span><span class="hs-comment">-- does the parameter of interest occurs in</span><span>
</span><span id="line-233"></span><span>                                  </span><span class="hs-comment">-- this type?</span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_ccdg1_errors"><span class="annot"><span class="annottext">Check_for_CanDoGenerics1 -&gt; Validity' DeriveGenericsErrReason
</span><a href="GHC.Tc.Deriv.Generics.html#_ccdg1_errors"><span class="hs-identifier hs-var hs-var">_ccdg1_errors</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#DeriveGenericsErrReason"><span class="hs-identifier hs-type">DeriveGenericsErrReason</span></a></span><span> </span><span class="hs-comment">-- errors generated by this type</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">{-

Note [degenerate use of FFoldType]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

We use foldDataConArgs here only for its ability to treat tuples
specially. foldDataConArgs also tracks covariance (though it assumes all
higher-order type parameters are covariant) and has hooks for special handling
of functions and polytypes, but we do *not* use those.

The key issue is that Generic1 deriving currently offers no sophisticated
support for functions. For example, we cannot handle

  data F a = F ((a -&gt; Int) -&gt; Int)

even though a is occurring covariantly.

In fact, our rule is harsh: a is simply not allowed to occur within the first
argument of (-&gt;). We treat (-&gt;) the same as any other non-tuple tycon.

Unfortunately, this means we have to track &quot;the parameter occurs in this type&quot;
explicitly, even though foldDataConArgs is also doing this internally.

-}</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">-- canDoGenerics1 determines if a Generic1/Rep1 can be derived.</span><span>
</span><span id="line-263"></span><span class="hs-comment">--</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- Checks (a) through (c) from Note [Requirements for deriving Generic and Rep]</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- are taken care of by the call to canDoGenerics.</span><span>
</span><span id="line-266"></span><span class="hs-comment">--</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- It returns IsValid if deriving is possible. It returns (NotValid reason)</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- if not.</span><span>
</span><span id="line-269"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#canDoGenerics1"><span class="hs-identifier hs-type">canDoGenerics1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generate.html#DerivInstTys"><span class="hs-identifier hs-type">DerivInstTys</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#DeriveGenericsErrReason"><span class="hs-identifier hs-type">DeriveGenericsErrReason</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-270"></span><span id="canDoGenerics1"><span class="annot"><span class="annottext">canDoGenerics1 :: DerivInstTys -&gt; Validity' [DeriveGenericsErrReason]
</span><a href="GHC.Tc.Deriv.Generics.html#canDoGenerics1"><span class="hs-identifier hs-var hs-var">canDoGenerics1</span></a></span></span><span> </span><span id="local-6989586621683094323"><span class="annot"><span class="annottext">dit :: DerivInstTys
</span><a href="#local-6989586621683094323"><span class="hs-identifier hs-var">dit</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Deriv.Generate.html#DerivInstTys"><span class="hs-identifier hs-type">DerivInstTys</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">dit_rep_tc :: DerivInstTys -&gt; TyCon
</span><a href="GHC.Tc.Deriv.Generate.html#dit_rep_tc"><span class="hs-identifier hs-var">dit_rep_tc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683094324"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094324"><span class="hs-identifier hs-var">rep_tc</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><span class="annottext">DerivInstTys -&gt; Validity' [DeriveGenericsErrReason]
</span><a href="GHC.Tc.Deriv.Generics.html#canDoGenerics"><span class="hs-identifier hs-var">canDoGenerics</span></a></span><span> </span><span class="annot"><span class="annottext">DerivInstTys
</span><a href="#local-6989586621683094323"><span class="hs-identifier hs-var">dit</span></a></span><span> </span><span class="annot"><span class="annottext">Validity' [DeriveGenericsErrReason]
-&gt; Validity' [DeriveGenericsErrReason]
-&gt; Validity' [DeriveGenericsErrReason]
forall a. Validity' a -&gt; Validity' a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#andValid"><span class="hs-operator hs-var">`andValid`</span></a></span><span> </span><span class="annot"><span class="annottext">Validity' [DeriveGenericsErrReason]
</span><a href="#local-6989586621683094325"><span class="hs-identifier hs-var">additionalChecks</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621683094325"><span class="annot"><span class="annottext">additionalChecks :: Validity' [DeriveGenericsErrReason]
</span><a href="#local-6989586621683094325"><span class="hs-identifier hs-var hs-var">additionalChecks</span></a></span></span><span>
</span><span id="line-274"></span><span>        </span><span class="hs-comment">-- check (d) from Note [Requirements for deriving Generic and Rep]</span><span>
</span><span id="line-275"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [TyVar]
</span><a href="GHC.Core.TyCon.html#tyConTyVars"><span class="hs-identifier hs-var">tyConTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094324"><span class="hs-identifier hs-var">rep_tc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DeriveGenericsErrReason] -&gt; Validity' [DeriveGenericsErrReason]
forall a. a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-276"></span><span>          </span><span class="annot"><span class="annottext">TyCon -&gt; DeriveGenericsErrReason
</span><a href="GHC.Tc.Errors.Types.html#DerivErrGenericsMustHaveSomeTypeParams"><span class="hs-identifier hs-var">DerivErrGenericsMustHaveSomeTypeParams</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094324"><span class="hs-identifier hs-var">rep_tc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Validity' DeriveGenericsErrReason]
-&gt; Validity' [DeriveGenericsErrReason]
forall a. [Validity' a] -&gt; Validity' [a]
</span><a href="GHC.Tc.Deriv.Generics.html#mergeErrors"><span class="hs-identifier hs-var">mergeErrors</span></a></span><span> </span><span class="annot"><span class="annottext">([Validity' DeriveGenericsErrReason]
 -&gt; Validity' [DeriveGenericsErrReason])
-&gt; [Validity' DeriveGenericsErrReason]
-&gt; Validity' [DeriveGenericsErrReason]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(DataCon -&gt; [Validity' DeriveGenericsErrReason])
-&gt; [DataCon] -&gt; [Validity' DeriveGenericsErrReason]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [Validity' DeriveGenericsErrReason]
</span><a href="#local-6989586621683094328"><span class="hs-identifier hs-var">check_con</span></a></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621683094329"><span class="hs-identifier hs-var">data_cons</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621683094329"><span class="annot"><span class="annottext">data_cons :: [DataCon]
</span><a href="#local-6989586621683094329"><span class="hs-identifier hs-var hs-var">data_cons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [DataCon]
</span><a href="GHC.Core.TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094324"><span class="hs-identifier hs-var">rep_tc</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span id="local-6989586621683094328"><span class="annot"><span class="annottext">check_con :: DataCon -&gt; [Validity' DeriveGenericsErrReason]
</span><a href="#local-6989586621683094328"><span class="hs-identifier hs-var hs-var">check_con</span></a></span></span><span> </span><span id="local-6989586621683094330"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094330"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Validity' DeriveGenericsErrReason
</span><a href="#local-6989586621683094331"><span class="hs-identifier hs-var">check_vanilla</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094330"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-282"></span><span>      </span><span id="local-6989586621683094332"><span class="annot"><span class="annottext">j :: Validity' DeriveGenericsErrReason
</span><a href="#local-6989586621683094332"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-type">NotValid</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Validity' DeriveGenericsErrReason
</span><a href="#local-6989586621683094332"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-283"></span><span>      </span><span class="annot"><span class="annottext">Validity' DeriveGenericsErrReason
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Check_for_CanDoGenerics1 -&gt; Validity' DeriveGenericsErrReason
</span><a href="GHC.Tc.Deriv.Generics.html#_ccdg1_errors"><span class="hs-identifier hs-var">_ccdg1_errors</span></a></span><span> </span><span class="annot"><span class="annottext">(Check_for_CanDoGenerics1 -&gt; Validity' DeriveGenericsErrReason)
-&gt; [Check_for_CanDoGenerics1]
-&gt; [Validity' DeriveGenericsErrReason]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-operator hs-var">`map`</span></span><span> </span><span class="annot"><span class="annottext">FFoldType Check_for_CanDoGenerics1
-&gt; DataCon -&gt; DerivInstTys -&gt; [Check_for_CanDoGenerics1]
forall a. FFoldType a -&gt; DataCon -&gt; DerivInstTys -&gt; [a]
</span><a href="GHC.Tc.Deriv.Functor.html#foldDataConArgs"><span class="hs-identifier hs-var">foldDataConArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; FFoldType Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094334"><span class="hs-identifier hs-var">ft_check</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094330"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094330"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">DerivInstTys
</span><a href="#local-6989586621683094323"><span class="hs-identifier hs-var">dit</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><a href="#local-6989586621683094331"><span class="hs-identifier hs-type">check_vanilla</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#DeriveGenericsErrReason"><span class="hs-identifier hs-type">DeriveGenericsErrReason</span></a></span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621683094331"><span class="annot"><span class="annottext">check_vanilla :: DataCon -&gt; Validity' DeriveGenericsErrReason
</span><a href="#local-6989586621683094331"><span class="hs-identifier hs-var hs-var">check_vanilla</span></a></span></span><span> </span><span id="local-6989586621683094335"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094335"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isVanillaDataCon"><span class="hs-identifier hs-var">isVanillaDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094335"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Validity' DeriveGenericsErrReason
forall a. Validity' a
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-287"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeriveGenericsErrReason -&gt; Validity' DeriveGenericsErrReason
forall a. a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="annot"><span class="annottext">(DeriveGenericsErrReason -&gt; Validity' DeriveGenericsErrReason)
-&gt; DeriveGenericsErrReason -&gt; Validity' DeriveGenericsErrReason
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; DeriveGenericsErrReason
</span><a href="GHC.Tc.Errors.Types.html#DerivErrGenericsMustNotHaveExistentials"><span class="hs-identifier hs-var">DerivErrGenericsMustNotHaveExistentials</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094335"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span>    </span><span id="local-6989586621683094337"><span class="annot"><span class="annottext">bmzero :: Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094337"><span class="hs-identifier hs-var hs-var">bmzero</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Validity' DeriveGenericsErrReason -&gt; Check_for_CanDoGenerics1
</span><a href="GHC.Tc.Deriv.Generics.html#CCDG1"><span class="hs-identifier hs-var">CCDG1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Validity' DeriveGenericsErrReason
forall a. Validity' a
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-290"></span><span>    </span><span id="local-6989586621683094338"><span class="annot"><span class="annottext">bmbad :: DataCon -&gt; Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094338"><span class="hs-identifier hs-var hs-var">bmbad</span></a></span></span><span> </span><span id="local-6989586621683094339"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094339"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Validity' DeriveGenericsErrReason -&gt; Check_for_CanDoGenerics1
</span><a href="GHC.Tc.Deriv.Generics.html#CCDG1"><span class="hs-identifier hs-var">CCDG1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">(Validity' DeriveGenericsErrReason -&gt; Check_for_CanDoGenerics1)
-&gt; Validity' DeriveGenericsErrReason -&gt; Check_for_CanDoGenerics1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DeriveGenericsErrReason -&gt; Validity' DeriveGenericsErrReason
forall a. a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; DeriveGenericsErrReason
</span><a href="GHC.Tc.Errors.Types.html#DerivErrGenericsWrongArgKind"><span class="hs-identifier hs-var">DerivErrGenericsWrongArgKind</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094339"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621683094341"><span class="annot"><span class="annottext">bmplus :: Check_for_CanDoGenerics1
-&gt; Check_for_CanDoGenerics1 -&gt; Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094341"><span class="hs-identifier hs-var hs-var">bmplus</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#CCDG1"><span class="hs-identifier hs-type">CCDG1</span></a></span><span> </span><span id="local-6989586621683094342"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683094342"><span class="hs-identifier hs-var">b1</span></a></span></span><span> </span><span id="local-6989586621683094343"><span class="annot"><span class="annottext">Validity' DeriveGenericsErrReason
</span><a href="#local-6989586621683094343"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#CCDG1"><span class="hs-identifier hs-type">CCDG1</span></a></span><span> </span><span id="local-6989586621683094344"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683094344"><span class="hs-identifier hs-var">b2</span></a></span></span><span> </span><span id="local-6989586621683094345"><span class="annot"><span class="annottext">Validity' DeriveGenericsErrReason
</span><a href="#local-6989586621683094345"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Validity' DeriveGenericsErrReason -&gt; Check_for_CanDoGenerics1
</span><a href="GHC.Tc.Deriv.Generics.html#CCDG1"><span class="hs-identifier hs-var">CCDG1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683094342"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683094344"><span class="hs-identifier hs-var">b2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Validity' DeriveGenericsErrReason
</span><a href="#local-6989586621683094343"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Validity' DeriveGenericsErrReason
-&gt; Validity' DeriveGenericsErrReason
-&gt; Validity' DeriveGenericsErrReason
forall a. Validity' a -&gt; Validity' a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#andValid"><span class="hs-operator hs-var">`andValid`</span></a></span><span> </span><span class="annot"><span class="annottext">Validity' DeriveGenericsErrReason
</span><a href="#local-6989586621683094345"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-comment">-- check (e) from Note [Requirements for deriving Generic and Rep]</span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-comment">-- See also Note [degenerate use of FFoldType]</span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><a href="#local-6989586621683094334"><span class="hs-identifier hs-type">ft_check</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Functor.html#FFoldType"><span class="hs-identifier hs-type">FFoldType</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#Check_for_CanDoGenerics1"><span class="hs-identifier hs-type">Check_for_CanDoGenerics1</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span id="local-6989586621683094334"><span class="annot"><span class="annottext">ft_check :: DataCon -&gt; FFoldType Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094334"><span class="hs-identifier hs-var hs-var">ft_check</span></a></span></span><span> </span><span id="local-6989586621683094346"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094346"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Functor.html#FT"><span class="hs-identifier hs-type">FT</span></a></span><span>
</span><span id="line-297"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_triv :: Check_for_CanDoGenerics1
</span><a href="GHC.Tc.Deriv.Functor.html#ft_triv"><span class="hs-identifier hs-var">ft_triv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094337"><span class="hs-identifier hs-var">bmzero</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_var :: Check_for_CanDoGenerics1
</span><a href="GHC.Tc.Deriv.Functor.html#ft_var"><span class="hs-identifier hs-var">ft_var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094350"><span class="hs-identifier hs-var">caseVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_co_var :: Check_for_CanDoGenerics1
</span><a href="GHC.Tc.Deriv.Functor.html#ft_co_var"><span class="hs-identifier hs-var">ft_co_var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094350"><span class="hs-identifier hs-var">caseVar</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-comment">-- (component_0,component_1,...,component_n)</span><span>
</span><span id="line-302"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_tup :: TyCon -&gt; [Check_for_CanDoGenerics1] -&gt; Check_for_CanDoGenerics1
</span><a href="GHC.Tc.Deriv.Functor.html#ft_tup"><span class="hs-identifier hs-var">ft_tup</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683094353"><span class="annot"><span class="annottext">[Check_for_CanDoGenerics1]
</span><a href="#local-6989586621683094353"><span class="hs-identifier hs-var">components</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Check_for_CanDoGenerics1]
-&gt; Maybe (NonEmpty Check_for_CanDoGenerics1)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#nonEmpty"><span class="hs-identifier hs-var">nonEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[Check_for_CanDoGenerics1]
</span><a href="#local-6989586621683094353"><span class="hs-identifier hs-var">components</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-303"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683094354"><span class="annot"><span class="annottext">NonEmpty Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094354"><span class="hs-identifier hs-var">components'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Check_for_CanDoGenerics1 -&gt; Bool)
-&gt; [Check_for_CanDoGenerics1] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Check_for_CanDoGenerics1 -&gt; Bool
</span><a href="GHC.Tc.Deriv.Generics.html#_ccdg1_hasParam"><span class="hs-identifier hs-var">_ccdg1_hasParam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty Check_for_CanDoGenerics1 -&gt; [Check_for_CanDoGenerics1]
forall a. NonEmpty a -&gt; [a]
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#init"><span class="hs-identifier hs-var">NE.init</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094354"><span class="hs-identifier hs-var">components'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094338"><span class="hs-identifier hs-var">bmbad</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094346"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-304"></span><span>            </span><span class="annot"><span class="annottext">Maybe (NonEmpty Check_for_CanDoGenerics1)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Check_for_CanDoGenerics1
 -&gt; Check_for_CanDoGenerics1 -&gt; Check_for_CanDoGenerics1)
-&gt; Check_for_CanDoGenerics1
-&gt; [Check_for_CanDoGenerics1]
-&gt; Check_for_CanDoGenerics1
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Check_for_CanDoGenerics1
-&gt; Check_for_CanDoGenerics1 -&gt; Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094341"><span class="hs-identifier hs-var">bmplus</span></a></span><span> </span><span class="annot"><span class="annottext">Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094337"><span class="hs-identifier hs-var">bmzero</span></a></span><span> </span><span class="annot"><span class="annottext">[Check_for_CanDoGenerics1]
</span><a href="#local-6989586621683094353"><span class="hs-identifier hs-var">components</span></a></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span>      </span><span class="hs-comment">-- (dom -&gt; rng), where the head of ty is not a tuple tycon</span><span>
</span><span id="line-307"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_fun :: Check_for_CanDoGenerics1
-&gt; Check_for_CanDoGenerics1 -&gt; Check_for_CanDoGenerics1
</span><a href="GHC.Tc.Deriv.Functor.html#ft_fun"><span class="hs-identifier hs-var">ft_fun</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621683094358"><span class="annot"><span class="annottext">Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094358"><span class="hs-identifier hs-var">dom</span></a></span></span><span> </span><span id="local-6989586621683094359"><span class="annot"><span class="annottext">Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094359"><span class="hs-identifier hs-var">rng</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- cf #8516</span><span>
</span><span id="line-308"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Check_for_CanDoGenerics1 -&gt; Bool
</span><a href="GHC.Tc.Deriv.Generics.html#_ccdg1_hasParam"><span class="hs-identifier hs-var">_ccdg1_hasParam</span></a></span><span> </span><span class="annot"><span class="annottext">Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094358"><span class="hs-identifier hs-var">dom</span></a></span><span>
</span><span id="line-309"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094338"><span class="hs-identifier hs-var">bmbad</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094346"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-310"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Check_for_CanDoGenerics1
-&gt; Check_for_CanDoGenerics1 -&gt; Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094341"><span class="hs-identifier hs-var">bmplus</span></a></span><span> </span><span class="annot"><span class="annottext">Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094358"><span class="hs-identifier hs-var">dom</span></a></span><span> </span><span class="annot"><span class="annottext">Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094359"><span class="hs-identifier hs-var">rng</span></a></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span>      </span><span class="hs-comment">-- (ty arg), where head of ty is neither (-&gt;) nor a tuple constructor and</span><span>
</span><span id="line-313"></span><span>      </span><span class="hs-comment">-- the parameter of interest does not occur in ty</span><span>
</span><span id="line-314"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_ty_app :: Type
-&gt; Type -&gt; Check_for_CanDoGenerics1 -&gt; Check_for_CanDoGenerics1
</span><a href="GHC.Tc.Deriv.Functor.html#ft_ty_app"><span class="hs-identifier hs-var">ft_ty_app</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683094361"><span class="annot"><span class="annottext">Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094361"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094361"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_bad_app :: Check_for_CanDoGenerics1
</span><a href="GHC.Tc.Deriv.Functor.html#ft_bad_app"><span class="hs-identifier hs-var">ft_bad_app</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094338"><span class="hs-identifier hs-var">bmbad</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094346"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-317"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_forall :: TyVar -&gt; Check_for_CanDoGenerics1 -&gt; Check_for_CanDoGenerics1
</span><a href="GHC.Tc.Deriv.Functor.html#ft_forall"><span class="hs-identifier hs-var">ft_forall</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683094364"><span class="annot"><span class="annottext">Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094364"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094364"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-comment">-- polytypes are handled elsewhere</span><span>
</span><span id="line-318"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-319"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-320"></span><span>        </span><span id="local-6989586621683094350"><span class="annot"><span class="annottext">caseVar :: Check_for_CanDoGenerics1
</span><a href="#local-6989586621683094350"><span class="hs-identifier hs-var hs-var">caseVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Validity' DeriveGenericsErrReason -&gt; Check_for_CanDoGenerics1
</span><a href="GHC.Tc.Deriv.Generics.html#CCDG1"><span class="hs-identifier hs-var">CCDG1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Validity' DeriveGenericsErrReason
forall a. Validity' a
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Generating the RHS of a generic default method}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="hs-keyword">type</span><span> </span><span id="US"><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#US"><span class="hs-identifier hs-var">US</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>   </span><span class="hs-comment">-- Local unique supply, just a plain Int</span><span>
</span><span id="line-331"></span><span class="hs-keyword">type</span><span> </span><span id="Alt"><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Pat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-comment">-- GenericKind serves to mark if a datatype derives Generic (Gen0) or</span><span>
</span><span id="line-334"></span><span class="hs-comment">-- Generic1 (Gen1).</span><span>
</span><span id="line-335"></span><span class="hs-keyword">data</span><span> </span><span id="GenericKind"><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#GenericKind"><span class="hs-identifier hs-var">GenericKind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Gen0"><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#Gen0"><span class="hs-identifier hs-var">Gen0</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Gen1"><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a></span></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="hs-comment">-- Like 'GenericKind', but with a payload of a datacon's last universally</span><span>
</span><span id="line-338"></span><span class="hs-comment">-- quantified 'TyVar' in the 'Generic1' case.</span><span>
</span><span id="line-339"></span><span class="hs-comment">--</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- Note that for GADTs, the last TyVar's Name will be different in each data</span><span>
</span><span id="line-341"></span><span class="hs-comment">-- constructor, so it is not correct to simply use the last TyVar in</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- 'tyConTyVars' in 'Gen1_DC'. (See #21185 for an example of what would happen</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- if you tried.)</span><span>
</span><span id="line-344"></span><span class="hs-keyword">data</span><span> </span><span id="GenericKind_DC"><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#GenericKind_DC"><span class="hs-identifier hs-var">GenericKind_DC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Gen0_DC"><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#Gen0_DC"><span class="hs-identifier hs-var">Gen0_DC</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Gen1_DC"><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#Gen1_DC"><span class="hs-identifier hs-var">Gen1_DC</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-comment">-- Construct a 'GenericKind_DC', retrieving the last universally quantified</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- type variable of a 'DataCon' in the 'Generic1' case.</span><span>
</span><span id="line-348"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#gk2gkDC"><span class="hs-identifier hs-type">gk2gkDC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#GenericKind"><span class="hs-identifier hs-type">GenericKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#GenericKind_DC"><span class="hs-identifier hs-type">GenericKind_DC</span></a></span><span>
</span><span id="line-349"></span><span id="gk2gkDC"><span class="annot"><span class="annottext">gk2gkDC :: GenericKind -&gt; DataCon -&gt; [Type] -&gt; GenericKind_DC
</span><a href="GHC.Tc.Deriv.Generics.html#gk2gkDC"><span class="hs-identifier hs-var hs-var">gk2gkDC</span></a></span></span><span> </span><span class="annot"><span class="annottext">GenericKind
</span><a href="GHC.Tc.Deriv.Generics.html#Gen0"><span class="hs-identifier hs-var">Gen0</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenericKind_DC
</span><a href="GHC.Tc.Deriv.Generics.html#Gen0_DC"><span class="hs-identifier hs-var">Gen0_DC</span></a></span><span>
</span><span id="line-350"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#gk2gkDC"><span class="hs-identifier hs-var">gk2gkDC</span></a></span><span> </span><span class="annot"><span class="annottext">GenericKind
</span><a href="GHC.Tc.Deriv.Generics.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a></span><span> </span><span id="local-6989586621683094370"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094370"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span id="local-6989586621683094371"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094371"><span class="hs-identifier hs-var">tc_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; GenericKind_DC
</span><a href="GHC.Tc.Deriv.Generics.html#Gen1_DC"><span class="hs-identifier hs-var">Gen1_DC</span></a></span><span> </span><span class="annot"><span class="annottext">(TyVar -&gt; GenericKind_DC) -&gt; TyVar -&gt; GenericKind_DC
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TyVar -&gt; TyVar
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTyVarTy"><span class="hs-identifier hs-var">isTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094374"><span class="hs-identifier hs-var">last_dc_inst_univ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>                                  </span><span class="annot"><span class="annottext">(TyVar -&gt; TyVar) -&gt; TyVar -&gt; TyVar
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; TyVar
Type -&gt; TyVar
</span><a href="GHC.Core.Type.html#getTyVar"><span class="hs-identifier hs-var">getTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094374"><span class="hs-identifier hs-var">last_dc_inst_univ</span></a></span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-353"></span><span>    </span><span id="local-6989586621683094376"><span class="annot"><span class="annottext">dc_inst_univs :: [Type]
</span><a href="#local-6989586621683094376"><span class="hs-identifier hs-var hs-var">dc_inst_univs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.DataCon.html#dataConInstUnivs"><span class="hs-identifier hs-var">dataConInstUnivs</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094370"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094371"><span class="hs-identifier hs-var">tc_args</span></a></span><span>
</span><span id="line-354"></span><span>    </span><span id="local-6989586621683094374"><span class="annot"><span class="annottext">last_dc_inst_univ :: Type
</span><a href="#local-6989586621683094374"><span class="hs-identifier hs-var hs-var">last_dc_inst_univ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; Type
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094376"><span class="hs-identifier hs-var">dc_inst_univs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-355"></span><span>                        </span><span class="annot"><span class="annottext">[Type] -&gt; Type
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">Partial.last</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094376"><span class="hs-identifier hs-var">dc_inst_univs</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-comment">-- Bindings for the Generic instance</span><span>
</span><span id="line-359"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#mkBindsRep"><span class="hs-identifier hs-type">mkBindsRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#GenericKind"><span class="hs-identifier hs-type">GenericKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generate.html#DerivInstTys"><span class="hs-identifier hs-type">DerivInstTys</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span id="mkBindsRep"><span class="annot"><span class="annottext">mkBindsRep :: DynFlags
-&gt; GenericKind
-&gt; SrcSpan
-&gt; DerivInstTys
-&gt; (LHsBinds GhcPs, [LSig GhcPs])
</span><a href="GHC.Tc.Deriv.Generics.html#mkBindsRep"><span class="hs-identifier hs-var hs-var">mkBindsRep</span></a></span></span><span> </span><span id="local-6989586621683094378"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683094378"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621683094379"><span class="annot"><span class="annottext">GenericKind
</span><a href="#local-6989586621683094379"><span class="hs-identifier hs-var">gk</span></a></span></span><span> </span><span id="local-6989586621683094380"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683094380"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683094381"><span class="annot"><span class="annottext">dit :: DerivInstTys
</span><a href="#local-6989586621683094381"><span class="hs-identifier hs-var">dit</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Deriv.Generate.html#DerivInstTys"><span class="hs-identifier hs-type">DerivInstTys</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">dit_rep_tc :: DerivInstTys -&gt; TyCon
</span><a href="GHC.Tc.Deriv.Generate.html#dit_rep_tc"><span class="hs-identifier hs-var">dit_rep_tc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683094382"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094382"><span class="hs-identifier hs-var">tycon</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsBinds GhcPs
[GenLocated SrcSpanAnnA (HsBindLR GhcPs GhcPs)]
</span><a href="#local-6989586621683094383"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[LSig GhcPs]
[GenLocated SrcSpanAnnA (Sig GhcPs)]
</span><a href="#local-6989586621683094384"><span class="hs-identifier hs-var">sigs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-362"></span><span>        </span><span id="local-6989586621683094383"><span class="annot"><span class="annottext">binds :: [GenLocated SrcSpanAnnA (HsBindLR GhcPs GhcPs)]
</span><a href="#local-6989586621683094383"><span class="hs-identifier hs-var hs-var">binds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocatedN RdrName -&gt; [LMatch GhcPs (LHsExpr GhcPs)] -&gt; LHsBind GhcPs
</span><a href="GHC.Tc.Deriv.Generate.html#mkRdrFunBind"><span class="hs-identifier hs-var">mkRdrFunBind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnN -&gt; RdrName -&gt; LocatedN RdrName
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><a href="#local-6989586621683094387"><span class="hs-identifier hs-var">loc'</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683094388"><span class="hs-identifier hs-var">from01_RDR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LMatch GhcPs (LHsExpr GhcPs)
GenLocated SrcSpanAnnA (Match GhcPs (LocatedA (HsExpr GhcPs)))
</span><a href="#local-6989586621683094389"><span class="hs-identifier hs-var">from_eqn</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-363"></span><span>              </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (HsBindLR GhcPs GhcPs)]
-&gt; [GenLocated SrcSpanAnnA (HsBindLR GhcPs GhcPs)]
-&gt; [GenLocated SrcSpanAnnA (HsBindLR GhcPs GhcPs)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-364"></span><span>                </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocatedN RdrName -&gt; [LMatch GhcPs (LHsExpr GhcPs)] -&gt; LHsBind GhcPs
</span><a href="GHC.Tc.Deriv.Generate.html#mkRdrFunBind"><span class="hs-identifier hs-var">mkRdrFunBind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnN -&gt; RdrName -&gt; LocatedN RdrName
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><a href="#local-6989586621683094387"><span class="hs-identifier hs-var">loc'</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683094390"><span class="hs-identifier hs-var">to01_RDR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LMatch GhcPs (LHsExpr GhcPs)
GenLocated SrcSpanAnnA (Match GhcPs (LocatedA (HsExpr GhcPs)))
</span><a href="#local-6989586621683094391"><span class="hs-identifier hs-var">to_eqn</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span>        </span><span class="hs-comment">-- See Note [Generics performance tricks]</span><span>
</span><span id="line-367"></span><span>        </span><span id="local-6989586621683094384"><span class="annot"><span class="annottext">sigs :: [GenLocated SrcSpanAnnA (Sig GhcPs)]
</span><a href="#local-6989586621683094384"><span class="hs-identifier hs-var hs-var">sigs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span>     </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_InlineGenericsAggressively"><span class="hs-identifier hs-var">Opt_InlineGenericsAggressively</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683094378"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-368"></span><span>                  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_InlineGenerics"><span class="hs-identifier hs-var">Opt_InlineGenerics</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683094378"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683094395"><span class="hs-identifier hs-var">inlining_useful</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>               </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RdrName -&gt; GenLocated SrcSpanAnnA (Sig GhcPs)
</span><a href="#local-6989586621683094396"><span class="hs-identifier hs-var">inline1</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683094388"><span class="hs-identifier hs-var">from01_RDR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; GenLocated SrcSpanAnnA (Sig GhcPs)
</span><a href="#local-6989586621683094396"><span class="hs-identifier hs-var">inline1</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683094390"><span class="hs-identifier hs-var">to01_RDR</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-370"></span><span>               </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-371"></span><span>         </span><span class="hs-keyword">where</span><span>
</span><span id="line-372"></span><span>           </span><span id="local-6989586621683094395"><span class="annot"><span class="annottext">inlining_useful :: Bool
</span><a href="#local-6989586621683094395"><span class="hs-identifier hs-var hs-var">inlining_useful</span></a></span></span><span>
</span><span id="line-373"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094397"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">1</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-374"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094397"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">4</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094399"><span class="hs-identifier hs-var">max_fields</span></a></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">5</span></span><span>
</span><span id="line-375"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094397"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">8</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094399"><span class="hs-identifier hs-var">max_fields</span></a></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">2</span></span><span>
</span><span id="line-376"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094397"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">16</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094399"><span class="hs-identifier hs-var">max_fields</span></a></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">1</span></span><span>
</span><span id="line-377"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094397"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">24</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094399"><span class="hs-identifier hs-var">max_fields</span></a></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">0</span></span><span>
</span><span id="line-378"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-379"></span><span>             </span><span class="hs-keyword">where</span><span>
</span><span id="line-380"></span><span>               </span><span id="local-6989586621683094397"><span class="annot"><span class="annottext">cons :: US
</span><a href="#local-6989586621683094397"><span class="hs-identifier hs-var hs-var">cons</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DataCon] -&gt; US
forall a. [a] -&gt; US
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; US
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621683094401"><span class="hs-identifier hs-var">datacons</span></a></span><span>
</span><span id="line-381"></span><span>               </span><span id="local-6989586621683094399"><span class="annot"><span class="annottext">max_fields :: US
</span><a href="#local-6989586621683094399"><span class="hs-identifier hs-var hs-var">max_fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[US] -&gt; US
forall a. Ord a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">([US] -&gt; US) -&gt; [US] -&gt; US
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(DataCon -&gt; US) -&gt; [DataCon] -&gt; [US]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; US
</span><a href="GHC.Core.DataCon.html#dataConSourceArity"><span class="hs-identifier hs-var">dataConSourceArity</span></a></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621683094401"><span class="hs-identifier hs-var">datacons</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span>           </span><span id="local-6989586621683094396"><span class="annot"><span class="annottext">inline1 :: RdrName -&gt; GenLocated SrcSpanAnnA (Sig GhcPs)
</span><a href="#local-6989586621683094396"><span class="hs-identifier hs-var hs-var">inline1</span></a></span></span><span> </span><span id="local-6989586621683094404"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683094404"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; Sig GhcPs -&gt; GenLocated SrcSpanAnnA (Sig GhcPs)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683094405"><span class="hs-identifier hs-var">loc''</span></a></span><span> </span><span class="annot"><span class="annottext">(Sig GhcPs -&gt; GenLocated SrcSpanAnnA (Sig GhcPs))
-&gt; (InlinePragma -&gt; Sig GhcPs)
-&gt; InlinePragma
-&gt; GenLocated SrcSpanAnnA (Sig GhcPs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XInlineSig GhcPs -&gt; LIdP GhcPs -&gt; InlinePragma -&gt; Sig GhcPs
forall pass.
XInlineSig pass -&gt; LIdP pass -&gt; InlinePragma -&gt; Sig pass
</span><a href="Language.Haskell.Syntax.Binds.html#InlineSig"><span class="hs-identifier hs-var">InlineSig</span></a></span><span> </span><span class="annot"><span class="annottext">XInlineSig GhcPs
forall a. NoAnn a =&gt; a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnN -&gt; RdrName -&gt; LocatedN RdrName
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><a href="#local-6989586621683094387"><span class="hs-identifier hs-var">loc'</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683094404"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>                     </span><span class="annot"><span class="annottext">(InlinePragma -&gt; GenLocated SrcSpanAnnA (Sig GhcPs))
-&gt; InlinePragma -&gt; GenLocated SrcSpanAnnA (Sig GhcPs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="GHC.Types.Basic.html#alwaysInlinePragma"><span class="hs-identifier hs-var">alwaysInlinePragma</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#inl_act"><span class="hs-identifier hs-var">inl_act</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#ActiveAfter"><span class="hs-identifier hs-type">ActiveAfter</span></a></span><span> </span><span class="annot"><a href="GHC.Types.SourceText.html#NoSourceText"><span class="hs-identifier hs-type">NoSourceText</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span>        </span><span class="hs-comment">-- The topmost M1 (the datatype metadata) has the exact same type</span><span>
</span><span id="line-387"></span><span>        </span><span class="hs-comment">-- across all cases of a from/to definition, and can be factored out</span><span>
</span><span id="line-388"></span><span>        </span><span class="hs-comment">-- to save some allocations during typechecking.</span><span>
</span><span id="line-389"></span><span>        </span><span class="hs-comment">-- See Note [Generics compilation speed tricks]</span><span>
</span><span id="line-390"></span><span>        </span><span id="local-6989586621683094389"><span class="annot"><span class="annottext">from_eqn :: LMatch GhcPs (LocatedA (HsExpr GhcPs))
</span><a href="#local-6989586621683094389"><span class="hs-identifier hs-var hs-var">from_eqn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcPs
-&gt; LocatedA (HsExpr GhcPs)
-&gt; LMatch GhcPs (LocatedA (HsExpr GhcPs))
forall (p :: Pass) (body :: * -&gt; *).
(Anno (GRHS (GhcPass p) (LocatedA (body (GhcPass p))))
 ~ EpAnn NoEpAnns,
 Anno (Match (GhcPass p) (LocatedA (body (GhcPass p))))
 ~ SrcSpanAnnA) =&gt;
LPat (GhcPass p)
-&gt; LocatedA (body (GhcPass p))
-&gt; LMatch (GhcPass p) (LocatedA (body (GhcPass p)))
</span><a href="GHC.Hs.Utils.html#mkHsCaseAlt"><span class="hs-identifier hs-var">mkHsCaseAlt</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#x_Pat"><span class="hs-identifier hs-var">x_Pat</span></a></span><span> </span><span class="annot"><span class="annottext">(LocatedA (HsExpr GhcPs) -&gt; LMatch GhcPs (LocatedA (HsExpr GhcPs)))
-&gt; LocatedA (HsExpr GhcPs)
-&gt; LMatch GhcPs (LocatedA (HsExpr GhcPs))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#mkM1_E"><span class="hs-identifier hs-var">mkM1_E</span></a></span><span>
</span><span id="line-391"></span><span>                                       </span><span class="annot"><span class="annottext">(LHsExpr GhcPs -&gt; LHsExpr GhcPs) -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass).
IsPass p =&gt;
LHsExpr (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsPar"><span class="hs-identifier hs-var">nlHsPar</span></a></span><span> </span><span class="annot"><span class="annottext">(LHsExpr GhcPs -&gt; LHsExpr GhcPs) -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; [LMatch GhcPs (LHsExpr GhcPs)] -&gt; LHsExpr GhcPs
</span><a href="GHC.Hs.Utils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#x_Expr"><span class="hs-identifier hs-var">x_Expr</span></a></span><span> </span><span class="annot"><span class="annottext">[LMatch GhcPs (LHsExpr GhcPs)]
[GenLocated SrcSpanAnnA (Match GhcPs (LocatedA (HsExpr GhcPs)))]
</span><a href="#local-6989586621683094421"><span class="hs-identifier hs-var">from_matches</span></a></span><span>
</span><span id="line-392"></span><span>        </span><span id="local-6989586621683094391"><span class="annot"><span class="annottext">to_eqn :: LMatch GhcPs (LocatedA (HsExpr GhcPs))
</span><a href="#local-6989586621683094391"><span class="hs-identifier hs-var hs-var">to_eqn</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcPs
-&gt; LocatedA (HsExpr GhcPs)
-&gt; LMatch GhcPs (LocatedA (HsExpr GhcPs))
forall (p :: Pass) (body :: * -&gt; *).
(Anno (GRHS (GhcPass p) (LocatedA (body (GhcPass p))))
 ~ EpAnn NoEpAnns,
 Anno (Match (GhcPass p) (LocatedA (body (GhcPass p))))
 ~ SrcSpanAnnA) =&gt;
LPat (GhcPass p)
-&gt; LocatedA (body (GhcPass p))
-&gt; LMatch (GhcPass p) (LocatedA (body (GhcPass p)))
</span><a href="GHC.Hs.Utils.html#mkHsCaseAlt"><span class="hs-identifier hs-var">mkHsCaseAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LPat GhcPs -&gt; LPat GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#mkM1_P"><span class="hs-identifier hs-var">mkM1_P</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#x_Pat"><span class="hs-identifier hs-var">x_Pat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LocatedA (HsExpr GhcPs) -&gt; LMatch GhcPs (LocatedA (HsExpr GhcPs)))
-&gt; LocatedA (HsExpr GhcPs)
-&gt; LMatch GhcPs (LocatedA (HsExpr GhcPs))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; [LMatch GhcPs (LHsExpr GhcPs)] -&gt; LHsExpr GhcPs
</span><a href="GHC.Hs.Utils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#x_Expr"><span class="hs-identifier hs-var">x_Expr</span></a></span><span> </span><span class="annot"><span class="annottext">[LMatch GhcPs (LHsExpr GhcPs)]
[GenLocated SrcSpanAnnA (Match GhcPs (LocatedA (HsExpr GhcPs)))]
</span><a href="#local-6989586621683094425"><span class="hs-identifier hs-var">to_matches</span></a></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span>        </span><span id="local-6989586621683094421"><span class="annot"><span class="annottext">from_matches :: [GenLocated SrcSpanAnnA (Match GhcPs (LocatedA (HsExpr GhcPs)))]
</span><a href="#local-6989586621683094421"><span class="hs-identifier hs-var hs-var">from_matches</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LPat GhcPs
-&gt; LocatedA (HsExpr GhcPs)
-&gt; LMatch GhcPs (LocatedA (HsExpr GhcPs))
forall (p :: Pass) (body :: * -&gt; *).
(Anno (GRHS (GhcPass p) (LocatedA (body (GhcPass p))))
 ~ EpAnn NoEpAnns,
 Anno (Match (GhcPass p) (LocatedA (body (GhcPass p))))
 ~ SrcSpanAnnA) =&gt;
LPat (GhcPass p)
-&gt; LocatedA (body (GhcPass p))
-&gt; LMatch (GhcPass p) (LocatedA (body (GhcPass p)))
</span><a href="GHC.Hs.Utils.html#mkHsCaseAlt"><span class="hs-identifier hs-var">mkHsCaseAlt</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcPs
GenLocated SrcSpanAnnA (Pat GhcPs)
</span><a href="#local-6989586621683094430"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">LocatedA (HsExpr GhcPs)
</span><a href="#local-6989586621683094431"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683094430"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Pat GhcPs)
</span><a href="#local-6989586621683094430"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621683094431"><span class="annot"><span class="annottext">LocatedA (HsExpr GhcPs)
</span><a href="#local-6989586621683094431"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Alt]
[(GenLocated SrcSpanAnnA (Pat GhcPs), LocatedA (HsExpr GhcPs))]
</span><a href="#local-6989586621683094432"><span class="hs-identifier hs-var">from_alts</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-395"></span><span>        </span><span id="local-6989586621683094425"><span class="annot"><span class="annottext">to_matches :: [GenLocated SrcSpanAnnA (Match GhcPs (LocatedA (HsExpr GhcPs)))]
</span><a href="#local-6989586621683094425"><span class="hs-identifier hs-var hs-var">to_matches</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LPat GhcPs
-&gt; LocatedA (HsExpr GhcPs)
-&gt; LMatch GhcPs (LocatedA (HsExpr GhcPs))
forall (p :: Pass) (body :: * -&gt; *).
(Anno (GRHS (GhcPass p) (LocatedA (body (GhcPass p))))
 ~ EpAnn NoEpAnns,
 Anno (Match (GhcPass p) (LocatedA (body (GhcPass p))))
 ~ SrcSpanAnnA) =&gt;
LPat (GhcPass p)
-&gt; LocatedA (body (GhcPass p))
-&gt; LMatch (GhcPass p) (LocatedA (body (GhcPass p)))
</span><a href="GHC.Hs.Utils.html#mkHsCaseAlt"><span class="hs-identifier hs-var">mkHsCaseAlt</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcPs
GenLocated SrcSpanAnnA (Pat GhcPs)
</span><a href="#local-6989586621683094437"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">LocatedA (HsExpr GhcPs)
</span><a href="#local-6989586621683094438"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683094437"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Pat GhcPs)
</span><a href="#local-6989586621683094437"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621683094438"><span class="annot"><span class="annottext">LocatedA (HsExpr GhcPs)
</span><a href="#local-6989586621683094438"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Alt]
[(GenLocated SrcSpanAnnA (Pat GhcPs), LocatedA (HsExpr GhcPs))]
</span><a href="#local-6989586621683094439"><span class="hs-identifier hs-var">to_alts</span></a></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-396"></span><span>        </span><span id="local-6989586621683094387"><span class="annot"><span class="annottext">loc' :: SrcSpanAnnN
</span><a href="#local-6989586621683094387"><span class="hs-identifier hs-var hs-var">loc'</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; SrcSpanAnnN
forall e. HasAnnotation e =&gt; SrcSpan -&gt; e
</span><a href="GHC.Parser.Annotation.html#noAnnSrcSpan"><span class="hs-identifier hs-var">noAnnSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683094380"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-397"></span><span>        </span><span id="local-6989586621683094405"><span class="annot"><span class="annottext">loc'' :: SrcSpanAnnA
</span><a href="#local-6989586621683094405"><span class="hs-identifier hs-var hs-var">loc''</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; SrcSpanAnnA
forall e. HasAnnotation e =&gt; SrcSpan -&gt; e
</span><a href="GHC.Parser.Annotation.html#noAnnSrcSpan"><span class="hs-identifier hs-var">noAnnSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683094380"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-398"></span><span>        </span><span id="local-6989586621683094401"><span class="annot"><span class="annottext">datacons :: [DataCon]
</span><a href="#local-6989586621683094401"><span class="hs-identifier hs-var hs-var">datacons</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [DataCon]
</span><a href="GHC.Core.TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094382"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621683094388"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683094388"><span class="hs-identifier hs-var">from01_RDR</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683094390"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683094390"><span class="hs-identifier hs-var">to01_RDR</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GenericKind
</span><a href="#local-6989586621683094379"><span class="hs-identifier hs-var">gk</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-401"></span><span>                                   </span><span class="annot"><span class="annottext">GenericKind
</span><a href="GHC.Tc.Deriv.Generics.html#Gen0"><span class="hs-identifier hs-var">Gen0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#from_RDR"><span class="hs-identifier hs-var">from_RDR</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#to_RDR"><span class="hs-identifier hs-var">to_RDR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>                                   </span><span class="annot"><span class="annottext">GenericKind
</span><a href="GHC.Tc.Deriv.Generics.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#from1_RDR"><span class="hs-identifier hs-var">from1_RDR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#to1_RDR"><span class="hs-identifier hs-var">to1_RDR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span>        </span><span class="hs-comment">-- Recurse over the sum first</span><span>
</span><span id="line-405"></span><span>        </span><span class="annot"><a href="#local-6989586621683094432"><span class="hs-identifier hs-type">from_alts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683094439"><span class="hs-identifier hs-type">to_alts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-406"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621683094432"><span class="annot"><span class="annottext">[Alt]
[(GenLocated SrcSpanAnnA (Pat GhcPs), LocatedA (HsExpr GhcPs))]
</span><a href="#local-6989586621683094432"><span class="hs-identifier hs-var">from_alts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683094439"><span class="annot"><span class="annottext">[Alt]
[(GenLocated SrcSpanAnnA (Pat GhcPs), LocatedA (HsExpr GhcPs))]
</span><a href="#local-6989586621683094439"><span class="hs-identifier hs-var">to_alts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenericKind -&gt; US -&gt; DerivInstTys -&gt; [DataCon] -&gt; ([Alt], [Alt])
</span><a href="GHC.Tc.Deriv.Generics.html#mkSum"><span class="hs-identifier hs-var">mkSum</span></a></span><span> </span><span class="annot"><span class="annottext">GenericKind
</span><a href="#local-6989586621683094379"><span class="hs-identifier hs-var">gk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">US
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#US"><span class="hs-identifier hs-type">US</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DerivInstTys
</span><a href="#local-6989586621683094381"><span class="hs-identifier hs-var">dit</span></a></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621683094401"><span class="hs-identifier hs-var">datacons</span></a></span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-409"></span><span class="hs-comment">-- The type synonym instance and synonym</span><span>
</span><span id="line-410"></span><span class="hs-comment">--       type instance Rep (D a b) = Rep_D a b</span><span>
</span><span id="line-411"></span><span class="hs-comment">--       type Rep_D a b = ...representation type for D ...</span><span>
</span><span id="line-412"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#gen_Generic_fam_inst"><span class="hs-identifier hs-type">gen_Generic_fam_inst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#GenericKind"><span class="hs-identifier hs-type">GenericKind</span></a></span><span>      </span><span class="hs-comment">-- Gen0 or Gen1</span><span>
</span><span id="line-415"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Get the Fixity for a data constructor Name</span><span>
</span><span id="line-416"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span>          </span><span class="hs-comment">-- The current source location</span><span>
</span><span id="line-417"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generate.html#DerivInstTys"><span class="hs-identifier hs-type">DerivInstTys</span></a></span><span>     </span><span class="hs-comment">-- Information about the type(s) to which</span><span>
</span><span id="line-418"></span><span>                                         </span><span class="hs-comment">-- Generic(1) is applied in the generated</span><span>
</span><span id="line-419"></span><span>                                         </span><span class="hs-comment">-- instance, including the data type's TyCon</span><span>
</span><span id="line-420"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#FamInst"><span class="hs-identifier hs-type">FamInst</span></a></span><span>      </span><span class="hs-comment">-- Generated representation0 coercion</span><span>
</span><span id="line-421"></span><span id="gen_Generic_fam_inst"><span class="annot"><span class="annottext">gen_Generic_fam_inst :: GenericKind
-&gt; (Name -&gt; Fixity) -&gt; SrcSpan -&gt; DerivInstTys -&gt; TcM FamInst
</span><a href="GHC.Tc.Deriv.Generics.html#gen_Generic_fam_inst"><span class="hs-identifier hs-var hs-var">gen_Generic_fam_inst</span></a></span></span><span> </span><span id="local-6989586621683094446"><span class="annot"><span class="annottext">GenericKind
</span><a href="#local-6989586621683094446"><span class="hs-identifier hs-var">gk</span></a></span></span><span> </span><span id="local-6989586621683094447"><span class="annot"><span class="annottext">Name -&gt; Fixity
</span><a href="#local-6989586621683094447"><span class="hs-identifier hs-var">get_fixity</span></a></span></span><span> </span><span id="local-6989586621683094448"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683094448"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-422"></span><span>       </span><span id="local-6989586621683094449"><span class="annot"><span class="annottext">dit :: DerivInstTys
</span><a href="#local-6989586621683094449"><span class="hs-identifier hs-var">dit</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Deriv.Generate.html#DerivInstTys"><span class="hs-identifier hs-type">DerivInstTys</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dit_cls_tys :: DerivInstTys -&gt; [Type]
</span><a href="GHC.Tc.Deriv.Generate.html#dit_cls_tys"><span class="hs-identifier hs-var">dit_cls_tys</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683094451"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094451"><span class="hs-identifier hs-var">cls_tys</span></a></span></span><span>
</span><span id="line-423"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dit_tc :: DerivInstTys -&gt; TyCon
</span><a href="GHC.Tc.Deriv.Generate.html#dit_tc"><span class="hs-identifier hs-var">dit_tc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683094453"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094453"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dit_tc_args :: DerivInstTys -&gt; [Type]
</span><a href="GHC.Tc.Deriv.Generate.html#dit_tc_args"><span class="hs-identifier hs-var">dit_tc_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683094455"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094455"><span class="hs-identifier hs-var">tc_args</span></a></span></span><span>
</span><span id="line-424"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dit_rep_tc :: DerivInstTys -&gt; TyCon
</span><a href="GHC.Tc.Deriv.Generate.html#dit_rep_tc"><span class="hs-identifier hs-var">dit_rep_tc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683094456"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094456"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-425"></span><span>       </span><span class="hs-comment">-- Consider the example input tycon `D`, where data D a b = D_ a</span><span>
</span><span id="line-426"></span><span>       </span><span class="hs-comment">-- Also consider `R:DInt`, where { data family D x y :: * -&gt; *</span><span>
</span><span id="line-427"></span><span>       </span><span class="hs-comment">--                               ; data instance D Int a b = D_ a }</span><span>
</span><span id="line-428"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- `rep` = GHC.Generics.Rep or GHC.Generics.Rep1 (type family)</span><span>
</span><span id="line-429"></span><span>       </span><span id="local-6989586621683094457"><span class="annot"><a href="#local-6989586621683094457"><span class="hs-identifier hs-var">fam_tc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GenericKind
</span><a href="#local-6989586621683094446"><span class="hs-identifier hs-var">gk</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-430"></span><span>         </span><span class="annot"><span class="annottext">GenericKind
</span><a href="GHC.Tc.Deriv.Generics.html#Gen0"><span class="hs-identifier hs-var">Gen0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) TyCon
</span><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-var">tcLookupTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#repTyConName"><span class="hs-identifier hs-var">repTyConName</span></a></span><span>
</span><span id="line-431"></span><span>         </span><span class="annot"><span class="annottext">GenericKind
</span><a href="GHC.Tc.Deriv.Generics.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) TyCon
</span><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-var">tcLookupTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#rep1TyConName"><span class="hs-identifier hs-var">rep1TyConName</span></a></span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- If the derived instance is</span><span>
</span><span id="line-434"></span><span>           </span><span class="hs-comment">--   instance Generic (Foo x)</span><span>
</span><span id="line-435"></span><span>           </span><span class="hs-comment">-- then:</span><span>
</span><span id="line-436"></span><span>           </span><span class="hs-comment">--   `arg_ki` = *, `inst_ty` = Foo x :: *</span><span>
</span><span id="line-437"></span><span>           </span><span class="hs-comment">--</span><span>
</span><span id="line-438"></span><span>           </span><span class="hs-comment">-- If the derived instance is</span><span>
</span><span id="line-439"></span><span>           </span><span class="hs-comment">--   instance Generic1 (Bar x :: k -&gt; *)</span><span>
</span><span id="line-440"></span><span>           </span><span class="hs-comment">-- then:</span><span>
</span><span id="line-441"></span><span>           </span><span class="hs-comment">--   `arg_k` = k, `inst_ty` = Bar x :: k -&gt; *</span><span>
</span><span id="line-442"></span><span>           </span><span id="local-6989586621683094461"><span class="annot"><a href="#local-6989586621683094461"><span class="hs-identifier hs-var hs-var">arg_ki</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericKind
</span><a href="#local-6989586621683094446"><span class="hs-identifier hs-var">gk</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094451"><span class="hs-identifier hs-var">cls_tys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-443"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericKind
</span><a href="GHC.Tc.Deriv.Generics.html#Gen0"><span class="hs-identifier hs-var">Gen0</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a></span><span>
</span><span id="line-444"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericKind
</span><a href="GHC.Tc.Deriv.Generics.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621683094463"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094463"><span class="hs-identifier hs-var">arg_k</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094463"><span class="hs-identifier hs-var">arg_k</span></a></span><span>
</span><span id="line-445"></span><span>             </span><span class="annot"><span class="annottext">(GenericKind, [Type])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;gen_Generic_fam_insts&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094451"><span class="hs-identifier hs-var">cls_tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>           </span><span id="local-6989586621683094466"><span class="annot"><a href="#local-6989586621683094466"><span class="hs-identifier hs-var hs-var">inst_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094453"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094455"><span class="hs-identifier hs-var">tc_args</span></a></span><span>
</span><span id="line-447"></span><span>           </span><span id="local-6989586621683094468"><span class="annot"><a href="#local-6989586621683094468"><span class="hs-identifier hs-var hs-var">inst_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094451"><span class="hs-identifier hs-var">cls_tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094466"><span class="hs-identifier hs-var">inst_ty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span>       </span><span class="hs-comment">-- `repTy` = D1 ... (C1 ... (S1 ... (Rec0 a))) :: * -&gt; *</span><span>
</span><span id="line-450"></span><span>     </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683094469"><span class="annot"><a href="#local-6989586621683094469"><span class="hs-identifier hs-var">repTy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#tc_mkRepTy"><span class="hs-identifier hs-type">tc_mkRepTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094446"><span class="hs-identifier hs-type">gk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094447"><span class="hs-identifier hs-type">get_fixity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094449"><span class="hs-identifier hs-type">dit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094461"><span class="hs-identifier hs-type">arg_ki</span></a></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span>       </span><span class="hs-comment">-- `rep_name` is a name we generate for the synonym</span><span>
</span><span id="line-453"></span><span>     </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683094471"><span class="annot"><a href="#local-6989586621683094471"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html#getModule"><span class="hs-identifier hs-type">getModule</span></a></span><span>
</span><span id="line-454"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683094472"><span class="annot"><a href="#local-6989586621683094472"><span class="hs-identifier hs-var hs-var">tc_occ</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094456"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>           </span><span id="local-6989586621683094475"><span class="annot"><a href="#local-6989586621683094475"><span class="hs-identifier hs-var hs-var">rep_occ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GenericKind
</span><a href="#local-6989586621683094446"><span class="hs-identifier hs-var">gk</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">GenericKind
</span><a href="GHC.Tc.Deriv.Generics.html#Gen0"><span class="hs-identifier hs-var">Gen0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#mkGenR"><span class="hs-identifier hs-var">mkGenR</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621683094472"><span class="hs-identifier hs-var">tc_occ</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">GenericKind
</span><a href="GHC.Tc.Deriv.Generics.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#mkGen1R"><span class="hs-identifier hs-var">mkGen1R</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621683094472"><span class="hs-identifier hs-var">tc_occ</span></a></span><span>
</span><span id="line-456"></span><span>     </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683094478"><span class="annot"><a href="#local-6989586621683094478"><span class="hs-identifier hs-var">rep_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Iface.Env.html#newGlobalBinder"><span class="hs-identifier hs-type">newGlobalBinder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094471"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094475"><span class="hs-identifier hs-type">rep_occ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094448"><span class="hs-identifier hs-type">loc</span></a></span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683094479"><span class="annot"><a href="#local-6989586621683094479"><span class="hs-identifier hs-var hs-var">tcv</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [TyVar]
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeList"><span class="hs-identifier hs-var">tyCoVarsOfTypeList</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094466"><span class="hs-identifier hs-var">inst_ty</span></a></span><span>
</span><span id="line-459"></span><span>           </span><span class="hs-special">(</span><span id="local-6989586621683094481"><span class="annot"><a href="#local-6989586621683094481"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683094482"><span class="annot"><a href="#local-6989586621683094482"><span class="hs-identifier hs-var">cv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">partition</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-type">isTyVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094479"><span class="hs-identifier hs-type">tcv</span></a></span><span>
</span><span id="line-460"></span><span>           </span><span id="local-6989586621683094484"><span class="annot"><a href="#local-6989586621683094484"><span class="hs-identifier hs-var hs-var">tvs</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; [TyVar]
</span><a href="GHC.Core.TyCo.FVs.html#scopedSort"><span class="hs-identifier hs-var">scopedSort</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621683094481"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-461"></span><span>           </span><span id="local-6989586621683094486"><span class="annot"><a href="#local-6989586621683094486"><span class="hs-identifier hs-var hs-var">cvs</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; [TyVar]
</span><a href="GHC.Core.TyCo.FVs.html#scopedSort"><span class="hs-identifier hs-var">scopedSort</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621683094482"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-462"></span><span>           </span><span id="local-6989586621683094487"><span class="annot"><a href="#local-6989586621683094487"><span class="hs-identifier hs-var hs-var">axiom</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Role
-&gt; Name
-&gt; [TyVar]
-&gt; [TyVar]
-&gt; [TyVar]
-&gt; TyCon
-&gt; [Type]
-&gt; Type
-&gt; CoAxiom Unbranched
</span><a href="GHC.Core.FamInstEnv.html#mkSingleCoAxiom"><span class="hs-identifier hs-var">mkSingleCoAxiom</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683094478"><span class="hs-identifier hs-var">rep_name</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621683094484"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621683094486"><span class="hs-identifier hs-var">cvs</span></a></span><span>
</span><span id="line-463"></span><span>                                      </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094457"><span class="hs-identifier hs-var">fam_tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094468"><span class="hs-identifier hs-var">inst_tys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094469"><span class="hs-identifier hs-var">repTy</span></a></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Instantiate.html#newFamInst"><span class="hs-identifier hs-type">newFamInst</span></a></span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#SynFamilyInst"><span class="hs-identifier hs-type">SynFamilyInst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094487"><span class="hs-identifier hs-type">axiom</span></a></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- Type representation</span><span>
</span><span id="line-469"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span class="hs-comment">-- | See documentation of 'argTyFold'; that function uses the fields of this</span><span>
</span><span id="line-472"></span><span class="hs-comment">-- type to interpret the structure of a type when that type is considered as an</span><span>
</span><span id="line-473"></span><span class="hs-comment">-- argument to a constructor that is being represented with 'Rep1'.</span><span>
</span><span id="line-474"></span><span class="hs-keyword">data</span><span> </span><span id="ArgTyAlg"><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#ArgTyAlg"><span class="hs-identifier hs-var">ArgTyAlg</span></a></span></span><span> </span><span id="local-6989586621683093858"><span class="annot"><a href="#local-6989586621683093858"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ArgTyAlg"><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#ArgTyAlg"><span class="hs-identifier hs-var">ArgTyAlg</span></a></span></span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="ata_rec0"><span class="annot"><span class="annottext">forall a. ArgTyAlg a -&gt; Type -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#ata_rec0"><span class="hs-identifier hs-var hs-var">ata_rec0</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683093858"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ata_par1"><span class="annot"><span class="annottext">forall a. ArgTyAlg a -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#ata_par1"><span class="hs-identifier hs-var hs-var">ata_par1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621683093858"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span id="ata_rec1"><span class="annot"><span class="annottext">forall a. ArgTyAlg a -&gt; Type -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#ata_rec1"><span class="hs-identifier hs-var hs-var">ata_rec1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683093858"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ata_comp"><span class="annot"><span class="annottext">forall a. ArgTyAlg a -&gt; Type -&gt; a -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#ata_comp"><span class="hs-identifier hs-var hs-var">ata_comp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683093858"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683093858"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span class="hs-comment">-- | @argTyFold@ implements a generalised and safer variant of the @arg@</span><span>
</span><span id="line-481"></span><span class="hs-comment">-- function from Figure 3 in &lt;http://dreixel.net/research/pdf/gdmh.pdf&gt;. @arg@</span><span>
</span><span id="line-482"></span><span class="hs-comment">-- is conceptually equivalent to:</span><span>
</span><span id="line-483"></span><span class="hs-comment">--</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- &gt; arg t = case t of</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- &gt;   _ | isTyVar t         -&gt; if (t == argVar) then Par1 else Par0 t</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- &gt;   App f [t'] |</span><span>
</span><span id="line-487"></span><span class="hs-comment">-- &gt;     representable1 f &amp;&amp;</span><span>
</span><span id="line-488"></span><span class="hs-comment">-- &gt;     t' == argVar        -&gt; Rec1 f</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- &gt;   App f [t'] |</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- &gt;     representable1 f &amp;&amp;</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- &gt;     t' has tyvars       -&gt; f :.: (arg t')</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- &gt;   _                     -&gt; Rec0 t</span><span>
</span><span id="line-493"></span><span class="hs-comment">--</span><span>
</span><span id="line-494"></span><span class="hs-comment">-- where @argVar@ is the last type variable in the data type declaration we are</span><span>
</span><span id="line-495"></span><span class="hs-comment">-- finding the representation for.</span><span>
</span><span id="line-496"></span><span class="hs-comment">--</span><span>
</span><span id="line-497"></span><span class="hs-comment">-- @argTyFold@ is more general than @arg@ because it uses 'ArgTyAlg' to</span><span>
</span><span id="line-498"></span><span class="hs-comment">-- abstract out the concrete invocations of @Par0@, @Rec0@, @Par1@, @Rec1@, and</span><span>
</span><span id="line-499"></span><span class="hs-comment">-- @:.:@.</span><span>
</span><span id="line-500"></span><span class="hs-comment">--</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- @argTyFold@ is safer than @arg@ because @arg@ would lead to a GHC panic for</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- some data types. The problematic case is when @t@ is an application of a</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- non-representable type @f@ to @argVar@: @App f [argVar]@ is caught by the</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- @_@ pattern, and ends up represented as @Rec0 t@. This type occurs /free/ in</span><span>
</span><span id="line-505"></span><span class="hs-comment">-- the RHS of the eventual @Rep1@ instance, which is therefore ill-formed. Some</span><span>
</span><span id="line-506"></span><span class="hs-comment">-- representable1 checks have been relaxed, and others were moved to</span><span>
</span><span id="line-507"></span><span class="hs-comment">-- @canDoGenerics1@.</span><span>
</span><span id="line-508"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#argTyFold"><span class="hs-identifier hs-type">argTyFold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621683093771"><span class="annot"><a href="#local-6989586621683093771"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#ArgTyAlg"><span class="hs-identifier hs-type">ArgTyAlg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683093771"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683093771"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-509"></span><span id="argTyFold"><span class="annot"><span class="annottext">argTyFold :: forall a. TyVar -&gt; ArgTyAlg a -&gt; Type -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#argTyFold"><span class="hs-identifier hs-var hs-var">argTyFold</span></a></span></span><span> </span><span id="local-6989586621683094500"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094500"><span class="hs-identifier hs-var">argVar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#ArgTyAlg"><span class="hs-identifier hs-type">ArgTyAlg</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">ata_rec0 :: forall a. ArgTyAlg a -&gt; Type -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#ata_rec0"><span class="hs-identifier hs-var">ata_rec0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683094501"><span class="annot"><span class="annottext">Type -&gt; a
</span><a href="#local-6989586621683094501"><span class="hs-identifier hs-var">mkRec0</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-510"></span><span>                            </span><span class="annot"><span class="annottext">ata_par1 :: forall a. ArgTyAlg a -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#ata_par1"><span class="hs-identifier hs-var">ata_par1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683094502"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621683094502"><span class="hs-identifier hs-var">mkPar1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ata_rec1 :: forall a. ArgTyAlg a -&gt; Type -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#ata_rec1"><span class="hs-identifier hs-var">ata_rec1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683094503"><span class="annot"><span class="annottext">Type -&gt; a
</span><a href="#local-6989586621683094503"><span class="hs-identifier hs-var">mkRec1</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-511"></span><span>                            </span><span class="annot"><span class="annottext">ata_comp :: forall a. ArgTyAlg a -&gt; Type -&gt; a -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#ata_comp"><span class="hs-identifier hs-var">ata_comp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683094504"><span class="annot"><span class="annottext">Type -&gt; a -&gt; a
</span><a href="#local-6989586621683094504"><span class="hs-identifier hs-var">mkComp</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-comment">-- mkRec0 is the default; use it if there is no interesting structure</span><span>
</span><span id="line-513"></span><span>  </span><span class="hs-comment">-- (e.g. occurrences of parameters or recursive occurrences)</span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-glyph">\</span><span id="local-6989586621683094505"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094505"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a -&gt; a) -&gt; Maybe a -&gt; a
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; a
</span><a href="#local-6989586621683094501"><span class="hs-identifier hs-var">mkRec0</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094505"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; a) -&gt; Maybe a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe a
</span><a href="#local-6989586621683094508"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094505"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-515"></span><span>  </span><span class="annot"><a href="#local-6989586621683094508"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- type to fold through</span><span>
</span><span id="line-516"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621683093771"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- the result (e.g. representation type), unless it's trivial</span><span>
</span><span id="line-517"></span><span>  </span><span id="local-6989586621683094508"><span class="annot"><span class="annottext">go :: Type -&gt; Maybe a
</span><a href="#local-6989586621683094508"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621683094509"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094509"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621683094510"><span class="hs-identifier hs-var">isParam</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe a -&gt; Maybe a
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-operator hs-var">`mplus`</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621683094511"><span class="hs-identifier hs-var">isApp</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span>    </span><span id="local-6989586621683094510"><span class="annot"><span class="annottext">isParam :: Maybe a
</span><a href="#local-6989586621683094510"><span class="hs-identifier hs-var hs-var">isParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- handles parameters</span><span>
</span><span id="line-520"></span><span>      </span><span id="local-6989586621683094512"><span class="annot"><a href="#local-6989586621683094512"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyVar
</span><a href="GHC.Core.Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094509"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-521"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621683094512"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621683094500"><span class="hs-identifier hs-type">argVar</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="#local-6989586621683094502"><span class="hs-identifier hs-type">mkPar1</span></a></span><span> </span><span class="hs-comment">-- moreover, it is &quot;the&quot; parameter</span><span>
</span><span id="line-522"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621683094501"><span class="hs-identifier hs-type">mkRec0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094509"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-comment">-- NB mkRec0 instead of the conventional mkPar0</span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span>    </span><span id="local-6989586621683094511"><span class="annot"><span class="annottext">isApp :: Maybe a
</span><a href="#local-6989586621683094511"><span class="hs-identifier hs-var hs-var">isApp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- handles applications</span><span>
</span><span id="line-525"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621683094514"><span class="annot"><a href="#local-6989586621683094514"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683094515"><span class="annot"><a href="#local-6989586621683094515"><span class="hs-identifier hs-var">beta</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier hs-var">tcSplitAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094509"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683094517"><span class="annot"><a href="#local-6989586621683094517"><span class="hs-identifier hs-var hs-var">interesting</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094500"><span class="hs-identifier hs-var">argVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Tc.Utils.TcType.html#exactTyCoVarsOfType"><span class="hs-identifier hs-var">exactTyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094515"><span class="hs-identifier hs-var">beta</span></a></span><span>
</span><span id="line-528"></span><span>
</span><span id="line-529"></span><span>      </span><span class="hs-comment">-- Does it have no interesting structure to represent?</span><span>
</span><span id="line-530"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><a href="#local-6989586621683094517"><span class="hs-identifier hs-type">interesting</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-531"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-comment">-- Is the argument the parameter? Special case for mkRec1.</span><span>
</span><span id="line-532"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621683094500"><span class="hs-identifier hs-type">argVar</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Core.Type.html#getTyVar_maybe"><span class="hs-identifier hs-type">getTyVar_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094515"><span class="hs-identifier hs-type">beta</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621683094503"><span class="hs-identifier hs-type">mkRec1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094514"><span class="hs-identifier hs-type">phi</span></a></span><span>
</span><span id="line-533"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621683094504"><span class="hs-identifier hs-type">mkComp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094514"><span class="hs-identifier hs-type">phi</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`fmap`</span></span><span> </span><span class="annot"><a href="#local-6989586621683094508"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094515"><span class="hs-identifier hs-type">beta</span></a></span><span> </span><span class="hs-comment">-- It must be a composition.</span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#tc_mkRepTy"><span class="hs-identifier hs-type">tc_mkRepTy</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-comment">-- Gen0 or Gen1, for Rep or Rep1</span><span>
</span><span id="line-537"></span><span>               </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#GenericKind"><span class="hs-identifier hs-type">GenericKind</span></a></span><span>
</span><span id="line-538"></span><span>               </span><span class="hs-comment">-- Get the Fixity for a data constructor Name</span><span>
</span><span id="line-539"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-540"></span><span>               </span><span class="hs-comment">-- Information about the last type argument to Generic(1)</span><span>
</span><span id="line-541"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generate.html#DerivInstTys"><span class="hs-identifier hs-type">DerivInstTys</span></a></span><span>
</span><span id="line-542"></span><span>               </span><span class="hs-comment">-- The kind of the representation type's argument</span><span>
</span><span id="line-543"></span><span>               </span><span class="hs-comment">-- See Note [Handling kinds in a Rep instance]</span><span>
</span><span id="line-544"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span>
</span><span id="line-545"></span><span>               </span><span class="hs-comment">-- Generated representation0 type</span><span>
</span><span id="line-546"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-547"></span><span id="tc_mkRepTy"><span class="annot"><span class="annottext">tc_mkRepTy :: GenericKind -&gt; (Name -&gt; Fixity) -&gt; DerivInstTys -&gt; Type -&gt; TcM Type
</span><a href="GHC.Tc.Deriv.Generics.html#tc_mkRepTy"><span class="hs-identifier hs-var hs-var">tc_mkRepTy</span></a></span></span><span> </span><span id="local-6989586621683094520"><span class="annot"><span class="annottext">GenericKind
</span><a href="#local-6989586621683094520"><span class="hs-identifier hs-var">gk</span></a></span></span><span> </span><span id="local-6989586621683094521"><span class="annot"><span class="annottext">Name -&gt; Fixity
</span><a href="#local-6989586621683094521"><span class="hs-identifier hs-var">get_fixity</span></a></span></span><span> </span><span id="local-6989586621683094522"><span class="annot"><span class="annottext">dit :: DerivInstTys
</span><a href="#local-6989586621683094522"><span class="hs-identifier hs-var">dit</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Deriv.Generate.html#DerivInstTys"><span class="hs-identifier hs-type">DerivInstTys</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dit_rep_tc :: DerivInstTys -&gt; TyCon
</span><a href="GHC.Tc.Deriv.Generate.html#dit_rep_tc"><span class="hs-identifier hs-var">dit_rep_tc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683094523"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094523"><span class="hs-identifier hs-var">tycon</span></a></span></span><span>
</span><span id="line-548"></span><span>                                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dit_rep_tc_args :: DerivInstTys -&gt; [Type]
</span><a href="GHC.Tc.Deriv.Generate.html#dit_rep_tc_args"><span class="hs-identifier hs-var">dit_rep_tc_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683094525"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094525"><span class="hs-identifier hs-var">tycon_args</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683094526"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094526"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-549"></span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-550"></span><span>    </span><span id="local-6989586621683094527"><span class="annot"><a href="#local-6989586621683094527"><span class="hs-identifier hs-var">d1</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) TyCon
</span><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-var">tcLookupTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#d1TyConName"><span class="hs-identifier hs-var">d1TyConName</span></a></span><span>
</span><span id="line-551"></span><span>    </span><span id="local-6989586621683094529"><span class="annot"><a href="#local-6989586621683094529"><span class="hs-identifier hs-var">c1</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-type">tcLookupTyCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#c1TyConName"><span class="hs-identifier hs-type">c1TyConName</span></a></span><span>
</span><span id="line-552"></span><span>    </span><span id="local-6989586621683094531"><span class="annot"><a href="#local-6989586621683094531"><span class="hs-identifier hs-var">s1</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-type">tcLookupTyCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#s1TyConName"><span class="hs-identifier hs-type">s1TyConName</span></a></span><span>
</span><span id="line-553"></span><span>    </span><span id="local-6989586621683094533"><span class="annot"><a href="#local-6989586621683094533"><span class="hs-identifier hs-var">rec0</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-type">tcLookupTyCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#rec0TyConName"><span class="hs-identifier hs-type">rec0TyConName</span></a></span><span>
</span><span id="line-554"></span><span>    </span><span id="local-6989586621683094535"><span class="annot"><a href="#local-6989586621683094535"><span class="hs-identifier hs-var">rec1</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-type">tcLookupTyCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#rec1TyConName"><span class="hs-identifier hs-type">rec1TyConName</span></a></span><span>
</span><span id="line-555"></span><span>    </span><span id="local-6989586621683094537"><span class="annot"><a href="#local-6989586621683094537"><span class="hs-identifier hs-var">par1</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-type">tcLookupTyCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#par1TyConName"><span class="hs-identifier hs-type">par1TyConName</span></a></span><span>
</span><span id="line-556"></span><span>    </span><span id="local-6989586621683094539"><span class="annot"><a href="#local-6989586621683094539"><span class="hs-identifier hs-var">u1</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-type">tcLookupTyCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#u1TyConName"><span class="hs-identifier hs-type">u1TyConName</span></a></span><span>
</span><span id="line-557"></span><span>    </span><span id="local-6989586621683094541"><span class="annot"><a href="#local-6989586621683094541"><span class="hs-identifier hs-var">v1</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-type">tcLookupTyCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#v1TyConName"><span class="hs-identifier hs-type">v1TyConName</span></a></span><span>
</span><span id="line-558"></span><span>    </span><span id="local-6989586621683094543"><span class="annot"><a href="#local-6989586621683094543"><span class="hs-identifier hs-var">plus</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-type">tcLookupTyCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#sumTyConName"><span class="hs-identifier hs-type">sumTyConName</span></a></span><span>
</span><span id="line-559"></span><span>    </span><span id="local-6989586621683094545"><span class="annot"><a href="#local-6989586621683094545"><span class="hs-identifier hs-var">times</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-type">tcLookupTyCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#prodTyConName"><span class="hs-identifier hs-type">prodTyConName</span></a></span><span>
</span><span id="line-560"></span><span>    </span><span id="local-6989586621683094547"><span class="annot"><a href="#local-6989586621683094547"><span class="hs-identifier hs-var">comp</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-type">tcLookupTyCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#compTyConName"><span class="hs-identifier hs-type">compTyConName</span></a></span><span>
</span><span id="line-561"></span><span>    </span><span id="local-6989586621683094549"><span class="annot"><a href="#local-6989586621683094549"><span class="hs-identifier hs-var">uAddr</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-type">tcLookupTyCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#uAddrTyConName"><span class="hs-identifier hs-type">uAddrTyConName</span></a></span><span>
</span><span id="line-562"></span><span>    </span><span id="local-6989586621683094551"><span class="annot"><a href="#local-6989586621683094551"><span class="hs-identifier hs-var">uChar</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-type">tcLookupTyCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#uCharTyConName"><span class="hs-identifier hs-type">uCharTyConName</span></a></span><span>
</span><span id="line-563"></span><span>    </span><span id="local-6989586621683094553"><span class="annot"><a href="#local-6989586621683094553"><span class="hs-identifier hs-var">uDouble</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-type">tcLookupTyCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#uDoubleTyConName"><span class="hs-identifier hs-type">uDoubleTyConName</span></a></span><span>
</span><span id="line-564"></span><span>    </span><span id="local-6989586621683094555"><span class="annot"><a href="#local-6989586621683094555"><span class="hs-identifier hs-var">uFloat</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-type">tcLookupTyCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#uFloatTyConName"><span class="hs-identifier hs-type">uFloatTyConName</span></a></span><span>
</span><span id="line-565"></span><span>    </span><span id="local-6989586621683094557"><span class="annot"><a href="#local-6989586621683094557"><span class="hs-identifier hs-var">uInt</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-type">tcLookupTyCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#uIntTyConName"><span class="hs-identifier hs-type">uIntTyConName</span></a></span><span>
</span><span id="line-566"></span><span>    </span><span id="local-6989586621683094559"><span class="annot"><a href="#local-6989586621683094559"><span class="hs-identifier hs-var">uWord</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-type">tcLookupTyCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#uWordTyConName"><span class="hs-identifier hs-type">uWordTyConName</span></a></span><span>
</span><span id="line-567"></span><span>
</span><span id="line-568"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683094563"><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-var hs-var">tcLookupPromDataCon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DataCon -&gt; TyCon)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) DataCon
-&gt; IOEnv (Env TcGblEnv TcLclEnv) TyCon
forall a b.
(a -&gt; b)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) a
-&gt; IOEnv (Env TcGblEnv TcLclEnv) b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; TyCon
</span><a href="GHC.Core.DataCon.html#promoteDataCon"><span class="hs-identifier hs-var">promoteDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">(IOEnv (Env TcGblEnv TcLclEnv) DataCon
 -&gt; IOEnv (Env TcGblEnv TcLclEnv) TyCon)
-&gt; (Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) DataCon)
-&gt; Name
-&gt; IOEnv (Env TcGblEnv TcLclEnv) TyCon
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) DataCon
</span><a href="GHC.Tc.Utils.Env.html#tcLookupDataCon"><span class="hs-identifier hs-var">tcLookupDataCon</span></a></span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span>    </span><span id="local-6989586621683094566"><span class="annot"><a href="#local-6989586621683094566"><span class="hs-identifier hs-var">md</span></a></span></span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-type">tcLookupPromDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#metaDataDataConName"><span class="hs-identifier hs-type">metaDataDataConName</span></a></span><span>
</span><span id="line-571"></span><span>    </span><span id="local-6989586621683094568"><span class="annot"><a href="#local-6989586621683094568"><span class="hs-identifier hs-var">mc</span></a></span></span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-type">tcLookupPromDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#metaConsDataConName"><span class="hs-identifier hs-type">metaConsDataConName</span></a></span><span>
</span><span id="line-572"></span><span>    </span><span id="local-6989586621683094570"><span class="annot"><a href="#local-6989586621683094570"><span class="hs-identifier hs-var">ms</span></a></span></span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-type">tcLookupPromDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#metaSelDataConName"><span class="hs-identifier hs-type">metaSelDataConName</span></a></span><span>
</span><span id="line-573"></span><span>    </span><span id="local-6989586621683094572"><span class="annot"><a href="#local-6989586621683094572"><span class="hs-identifier hs-var">pPrefix</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-type">tcLookupPromDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#prefixIDataConName"><span class="hs-identifier hs-type">prefixIDataConName</span></a></span><span>
</span><span id="line-574"></span><span>    </span><span id="local-6989586621683094574"><span class="annot"><a href="#local-6989586621683094574"><span class="hs-identifier hs-var">pInfix</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-type">tcLookupPromDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#infixIDataConName"><span class="hs-identifier hs-type">infixIDataConName</span></a></span><span>
</span><span id="line-575"></span><span>    </span><span id="local-6989586621683094576"><span class="annot"><a href="#local-6989586621683094576"><span class="hs-identifier hs-var">pLA</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-type">tcLookupPromDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#leftAssociativeDataConName"><span class="hs-identifier hs-type">leftAssociativeDataConName</span></a></span><span>
</span><span id="line-576"></span><span>    </span><span id="local-6989586621683094578"><span class="annot"><a href="#local-6989586621683094578"><span class="hs-identifier hs-var">pRA</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-type">tcLookupPromDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#rightAssociativeDataConName"><span class="hs-identifier hs-type">rightAssociativeDataConName</span></a></span><span>
</span><span id="line-577"></span><span>    </span><span id="local-6989586621683094580"><span class="annot"><a href="#local-6989586621683094580"><span class="hs-identifier hs-var">pNA</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-type">tcLookupPromDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#notAssociativeDataConName"><span class="hs-identifier hs-type">notAssociativeDataConName</span></a></span><span>
</span><span id="line-578"></span><span>    </span><span id="local-6989586621683094582"><span class="annot"><a href="#local-6989586621683094582"><span class="hs-identifier hs-var">pSUpk</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-type">tcLookupPromDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#sourceUnpackDataConName"><span class="hs-identifier hs-type">sourceUnpackDataConName</span></a></span><span>
</span><span id="line-579"></span><span>    </span><span id="local-6989586621683094584"><span class="annot"><a href="#local-6989586621683094584"><span class="hs-identifier hs-var">pSNUpk</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-type">tcLookupPromDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#sourceNoUnpackDataConName"><span class="hs-identifier hs-type">sourceNoUnpackDataConName</span></a></span><span>
</span><span id="line-580"></span><span>    </span><span id="local-6989586621683094586"><span class="annot"><a href="#local-6989586621683094586"><span class="hs-identifier hs-var">pNSUpkness</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-type">tcLookupPromDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#noSourceUnpackednessDataConName"><span class="hs-identifier hs-type">noSourceUnpackednessDataConName</span></a></span><span>
</span><span id="line-581"></span><span>    </span><span id="local-6989586621683094588"><span class="annot"><a href="#local-6989586621683094588"><span class="hs-identifier hs-var">pSLzy</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-type">tcLookupPromDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#sourceLazyDataConName"><span class="hs-identifier hs-type">sourceLazyDataConName</span></a></span><span>
</span><span id="line-582"></span><span>    </span><span id="local-6989586621683094590"><span class="annot"><a href="#local-6989586621683094590"><span class="hs-identifier hs-var">pSStr</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-type">tcLookupPromDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#sourceStrictDataConName"><span class="hs-identifier hs-type">sourceStrictDataConName</span></a></span><span>
</span><span id="line-583"></span><span>    </span><span id="local-6989586621683094592"><span class="annot"><a href="#local-6989586621683094592"><span class="hs-identifier hs-var">pNSStrness</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-type">tcLookupPromDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#noSourceStrictnessDataConName"><span class="hs-identifier hs-type">noSourceStrictnessDataConName</span></a></span><span>
</span><span id="line-584"></span><span>    </span><span id="local-6989586621683094594"><span class="annot"><a href="#local-6989586621683094594"><span class="hs-identifier hs-var">pDLzy</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-type">tcLookupPromDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#decidedLazyDataConName"><span class="hs-identifier hs-type">decidedLazyDataConName</span></a></span><span>
</span><span id="line-585"></span><span>    </span><span id="local-6989586621683094596"><span class="annot"><a href="#local-6989586621683094596"><span class="hs-identifier hs-var">pDStr</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-type">tcLookupPromDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#decidedStrictDataConName"><span class="hs-identifier hs-type">decidedStrictDataConName</span></a></span><span>
</span><span id="line-586"></span><span>    </span><span id="local-6989586621683094598"><span class="annot"><a href="#local-6989586621683094598"><span class="hs-identifier hs-var">pDUpk</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683094563"><span class="hs-identifier hs-type">tcLookupPromDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#decidedUnpackDataConName"><span class="hs-identifier hs-type">decidedUnpackDataConName</span></a></span><span>
</span><span id="line-587"></span><span>
</span><span id="line-588"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683094600"><span class="annot"><a href="#local-6989586621683094600"><span class="hs-identifier hs-var hs-var">mkSum'</span></a></span></span><span> </span><span id="local-6989586621683094601"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094601"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621683094602"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094602"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094543"><span class="hs-identifier hs-var">plus</span></a></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094526"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094601"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094602"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-589"></span><span>        </span><span id="local-6989586621683094603"><span class="annot"><a href="#local-6989586621683094603"><span class="hs-identifier hs-var hs-var">mkProd</span></a></span></span><span> </span><span id="local-6989586621683094604"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094604"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621683094605"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094605"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094545"><span class="hs-identifier hs-var">times</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094526"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094604"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094605"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-590"></span><span>        </span><span id="local-6989586621683094606"><span class="annot"><a href="#local-6989586621683094606"><span class="hs-identifier hs-var hs-var">mkRec0</span></a></span></span><span> </span><span id="local-6989586621683094607"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094607"><span class="hs-identifier hs-var">a</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon
-&gt; TyCon
-&gt; TyCon
-&gt; TyCon
-&gt; TyCon
-&gt; TyCon
-&gt; TyCon
-&gt; Type
-&gt; Type
-&gt; Type
</span><a href="GHC.Tc.Deriv.Generics.html#mkBoxTy"><span class="hs-identifier hs-var">mkBoxTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094549"><span class="hs-identifier hs-var">uAddr</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094551"><span class="hs-identifier hs-var">uChar</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094553"><span class="hs-identifier hs-var">uDouble</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094555"><span class="hs-identifier hs-var">uFloat</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094557"><span class="hs-identifier hs-var">uInt</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094559"><span class="hs-identifier hs-var">uWord</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094533"><span class="hs-identifier hs-var">rec0</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094526"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094607"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-591"></span><span>        </span><span id="local-6989586621683094609"><span class="annot"><a href="#local-6989586621683094609"><span class="hs-identifier hs-var hs-var">mkRec1</span></a></span></span><span> </span><span id="local-6989586621683094610"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094610"><span class="hs-identifier hs-var">a</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094535"><span class="hs-identifier hs-var">rec1</span></a></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094526"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094610"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-592"></span><span>        </span><span id="local-6989586621683094611"><span class="annot"><a href="#local-6989586621683094611"><span class="hs-identifier hs-var hs-var">mkPar1</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#mkTyConTy"><span class="hs-identifier hs-var">mkTyConTy</span></a></span><span>  </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094537"><span class="hs-identifier hs-var">par1</span></a></span><span>
</span><span id="line-593"></span><span>        </span><span id="local-6989586621683094613"><span class="annot"><a href="#local-6989586621683094613"><span class="hs-identifier hs-var hs-var">mkD</span></a></span></span><span>    </span><span id="local-6989586621683094614"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094614"><span class="hs-identifier hs-var">a</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094527"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094526"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094615"><span class="hs-identifier hs-var">metaDataTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DataCon] -&gt; Type
</span><a href="#local-6989586621683094616"><span class="hs-identifier hs-var">sumP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [DataCon]
</span><a href="GHC.Core.TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094614"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-594"></span><span>        </span><span id="local-6989586621683094617"><span class="annot"><a href="#local-6989586621683094617"><span class="hs-identifier hs-var hs-var">mkC</span></a></span></span><span>      </span><span id="local-6989586621683094618"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094618"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094529"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094526"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-595"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Type
</span><a href="#local-6989586621683094619"><span class="hs-identifier hs-var">metaConsTy</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094618"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-596"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenericKind_DC
-&gt; [Type] -&gt; [HsSrcBang] -&gt; [HsImplBang] -&gt; [FieldLabel] -&gt; Type
</span><a href="#local-6989586621683094620"><span class="hs-identifier hs-var">prod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericKind -&gt; DataCon -&gt; [Type] -&gt; GenericKind_DC
</span><a href="GHC.Tc.Deriv.Generics.html#gk2gkDC"><span class="hs-identifier hs-var">gk2gkDC</span></a></span><span> </span><span class="annot"><span class="annottext">GenericKind
</span><a href="#local-6989586621683094520"><span class="hs-identifier hs-var">gk</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094618"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094525"><span class="hs-identifier hs-var">tycon_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-597"></span><span>                                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; DerivInstTys -&gt; [Type]
</span><a href="GHC.Tc.Deriv.Generate.html#derivDataConInstArgTys"><span class="hs-identifier hs-var">derivDataConInstArgTys</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094618"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">DerivInstTys
</span><a href="#local-6989586621683094522"><span class="hs-identifier hs-var">dit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>                                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; [HsSrcBang]
</span><a href="GHC.Core.DataCon.html#dataConSrcBangs"><span class="hs-identifier hs-var">dataConSrcBangs</span></a></span><span>    </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094618"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>                                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; [HsImplBang]
</span><a href="GHC.Core.DataCon.html#dataConImplBangs"><span class="hs-identifier hs-var">dataConImplBangs</span></a></span><span>   </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094618"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-600"></span><span>                                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; [FieldLabel]
</span><a href="GHC.Core.DataCon.html#dataConFieldLabels"><span class="hs-identifier hs-var">dataConFieldLabels</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094618"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-601"></span><span>        </span><span id="local-6989586621683094624"><span class="annot"><a href="#local-6989586621683094624"><span class="hs-identifier hs-var hs-var">mkS</span></a></span></span><span> </span><span id="local-6989586621683094625"><span class="annot"><span class="annottext">Maybe FieldLabel
</span><a href="#local-6989586621683094625"><span class="hs-identifier hs-var">mlbl</span></a></span></span><span> </span><span id="local-6989586621683094626"><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="#local-6989586621683094626"><span class="hs-identifier hs-var">su</span></a></span></span><span> </span><span id="local-6989586621683094627"><span class="annot"><span class="annottext">SrcStrictness
</span><a href="#local-6989586621683094627"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span id="local-6989586621683094628"><span class="annot"><span class="annottext">HsImplBang
</span><a href="#local-6989586621683094628"><span class="hs-identifier hs-var">ib</span></a></span></span><span> </span><span id="local-6989586621683094629"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094629"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094531"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094526"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe FieldLabel
-&gt; SrcUnpackedness -&gt; SrcStrictness -&gt; HsImplBang -&gt; Type
</span><a href="#local-6989586621683094630"><span class="hs-identifier hs-var">metaSelTy</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FieldLabel
</span><a href="#local-6989586621683094625"><span class="hs-identifier hs-var">mlbl</span></a></span><span> </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="#local-6989586621683094626"><span class="hs-identifier hs-var">su</span></a></span><span> </span><span class="annot"><span class="annottext">SrcStrictness
</span><a href="#local-6989586621683094627"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="annot"><span class="annottext">HsImplBang
</span><a href="#local-6989586621683094628"><span class="hs-identifier hs-var">ib</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094629"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span>        </span><span class="hs-comment">-- Sums and products are done in the same way for both Rep and Rep1</span><span>
</span><span id="line-604"></span><span>        </span><span id="local-6989586621683094616"><span class="annot"><a href="#local-6989586621683094616"><span class="hs-identifier hs-var hs-var">sumP</span></a></span></span><span> </span><span id="local-6989586621683094631"><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621683094631"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall a. (a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#foldBal"><span class="hs-identifier hs-var">foldBal</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="#local-6989586621683094600"><span class="hs-identifier hs-var">mkSum'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094541"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094526"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; Type) -&gt; ([DataCon] -&gt; [Type]) -&gt; [DataCon] -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DataCon -&gt; Type) -&gt; [DataCon] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Type
</span><a href="#local-6989586621683094617"><span class="hs-identifier hs-var">mkC</span></a></span><span> </span><span class="annot"><span class="annottext">([DataCon] -&gt; Type) -&gt; [DataCon] -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621683094631"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-605"></span><span>        </span><span class="hs-comment">-- The Bool is True if this constructor has labelled fields</span><span>
</span><span id="line-606"></span><span>        </span><span class="annot"><a href="#local-6989586621683094620"><span class="hs-identifier hs-type">prod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#GenericKind_DC"><span class="hs-identifier hs-type">GenericKind_DC</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.DataCon.html#HsSrcBang"><span class="hs-identifier hs-type">HsSrcBang</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.DataCon.html#HsImplBang"><span class="hs-identifier hs-type">HsImplBang</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-607"></span><span>        </span><span id="local-6989586621683094620"><span class="annot"><a href="#local-6989586621683094620"><span class="hs-identifier hs-var hs-var">prod</span></a></span></span><span> </span><span id="local-6989586621683094633"><span class="annot"><span class="annottext">GenericKind_DC
</span><a href="#local-6989586621683094633"><span class="hs-identifier hs-var">gk_</span></a></span></span><span> </span><span id="local-6989586621683094634"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094634"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621683094635"><span class="annot"><span class="annottext">[HsSrcBang]
</span><a href="#local-6989586621683094635"><span class="hs-identifier hs-var">sb</span></a></span></span><span> </span><span id="local-6989586621683094636"><span class="annot"><span class="annottext">[HsImplBang]
</span><a href="#local-6989586621683094636"><span class="hs-identifier hs-var">ib</span></a></span></span><span> </span><span id="local-6989586621683094637"><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621683094637"><span class="hs-identifier hs-var">fl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall a. (a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#foldBal"><span class="hs-identifier hs-var">foldBal</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="#local-6989586621683094603"><span class="hs-identifier hs-var">mkProd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094539"><span class="hs-identifier hs-var">u1</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094526"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>                                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; Type
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FieldLabel] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621683094637"><span class="hs-identifier hs-var">fl</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[FieldLabel] -&gt; US -&gt; Bool
forall a. [a] -&gt; US -&gt; Bool
</span><a href="GHC.Utils.Misc.html#lengthExceeds"><span class="hs-identifier hs-var">lengthExceeds</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621683094637"><span class="hs-identifier hs-var">fl</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094639"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-609"></span><span>                                    </span><span class="annot"><span class="annottext">GenericKind_DC
-&gt; Type -&gt; HsSrcBang -&gt; HsImplBang -&gt; Maybe FieldLabel -&gt; Type
</span><a href="#local-6989586621683094640"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">GenericKind_DC
</span><a href="#local-6989586621683094633"><span class="hs-identifier hs-var">gk_</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094641"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">HsSrcBang
</span><a href="#local-6989586621683094642"><span class="hs-identifier hs-var">sb'</span></a></span><span> </span><span class="annot"><span class="annottext">HsImplBang
</span><a href="#local-6989586621683094643"><span class="hs-identifier hs-var">ib'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[FieldLabel] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621683094637"><span class="hs-identifier hs-var">fl</span></a></span><span>
</span><span id="line-610"></span><span>                                                       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe FieldLabel
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-611"></span><span>                                                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FieldLabel -&gt; Maybe FieldLabel
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621683094637"><span class="hs-identifier hs-var">fl</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLabel] -&gt; US -&gt; FieldLabel
forall a. HasCallStack =&gt; [a] -&gt; US -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094639"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>                                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683094641"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094641"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621683094642"><span class="annot"><span class="annottext">HsSrcBang
</span><a href="#local-6989586621683094642"><span class="hs-identifier hs-var">sb'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621683094643"><span class="annot"><span class="annottext">HsImplBang
</span><a href="#local-6989586621683094643"><span class="hs-identifier hs-var">ib'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621683094639"><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094639"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Type]
-&gt; [HsSrcBang]
-&gt; [HsImplBang]
-&gt; [US]
-&gt; [(Type, HsSrcBang, HsImplBang, US)]
forall a b c d. [a] -&gt; [b] -&gt; [c] -&gt; [d] -&gt; [(a, b, c, d)]
</span><span class="hs-identifier hs-var">zip4</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094634"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[HsSrcBang]
</span><a href="#local-6989586621683094635"><span class="hs-identifier hs-var">sb</span></a></span><span> </span><span class="annot"><span class="annottext">[HsImplBang]
</span><a href="#local-6989586621683094636"><span class="hs-identifier hs-var">ib</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">US
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span>        </span><span class="annot"><a href="#local-6989586621683094640"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#GenericKind_DC"><span class="hs-identifier hs-type">GenericKind_DC</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#HsSrcBang"><span class="hs-identifier hs-type">HsSrcBang</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#HsImplBang"><span class="hs-identifier hs-type">HsImplBang</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-615"></span><span>        </span><span id="local-6989586621683094640"><span class="annot"><a href="#local-6989586621683094640"><span class="hs-identifier hs-var hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621683094645"><span class="annot"><span class="annottext">GenericKind_DC
</span><a href="#local-6989586621683094645"><span class="hs-identifier hs-var">gk_</span></a></span></span><span> </span><span id="local-6989586621683094646"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094646"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.DataCon.html#HsSrcBang"><span class="hs-identifier hs-type">HsSrcBang</span></a></span><span> </span><span class="annot"><span class="annottext">SourceText
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#HsBang"><span class="hs-identifier hs-type">HsBang</span></a></span><span> </span><span id="local-6989586621683094649"><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="#local-6989586621683094649"><span class="hs-identifier hs-var">su</span></a></span></span><span> </span><span id="local-6989586621683094650"><span class="annot"><span class="annottext">SrcStrictness
</span><a href="#local-6989586621683094650"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683094651"><span class="annot"><span class="annottext">HsImplBang
</span><a href="#local-6989586621683094651"><span class="hs-identifier hs-var">ib</span></a></span></span><span> </span><span id="local-6989586621683094652"><span class="annot"><span class="annottext">Maybe FieldLabel
</span><a href="#local-6989586621683094652"><span class="hs-identifier hs-var">fl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FieldLabel
-&gt; SrcUnpackedness -&gt; SrcStrictness -&gt; HsImplBang -&gt; Type -&gt; Type
</span><a href="#local-6989586621683094624"><span class="hs-identifier hs-var">mkS</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FieldLabel
</span><a href="#local-6989586621683094652"><span class="hs-identifier hs-var">fl</span></a></span><span> </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="#local-6989586621683094649"><span class="hs-identifier hs-var">su</span></a></span><span> </span><span class="annot"><span class="annottext">SrcStrictness
</span><a href="#local-6989586621683094650"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="annot"><span class="annottext">HsImplBang
</span><a href="#local-6989586621683094651"><span class="hs-identifier hs-var">ib</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GenericKind_DC
</span><a href="#local-6989586621683094645"><span class="hs-identifier hs-var">gk_</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-616"></span><span>            </span><span class="hs-comment">-- Here we previously used Par0 if t was a type variable, but we</span><span>
</span><span id="line-617"></span><span>            </span><span class="hs-comment">-- realized that we can't always guarantee that we are wrapping-up</span><span>
</span><span id="line-618"></span><span>            </span><span class="hs-comment">-- all type variables in Par0. So we decided to stop using Par0</span><span>
</span><span id="line-619"></span><span>            </span><span class="hs-comment">-- altogether, and use Rec0 all the time.</span><span>
</span><span id="line-620"></span><span>                      </span><span class="annot"><span class="annottext">GenericKind_DC
</span><a href="GHC.Tc.Deriv.Generics.html#Gen0_DC"><span class="hs-identifier hs-var">Gen0_DC</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621683094606"><span class="hs-identifier hs-var">mkRec0</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094646"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-621"></span><span>                      </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#Gen1_DC"><span class="hs-identifier hs-type">Gen1_DC</span></a></span><span> </span><span id="local-6989586621683094653"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094653"><span class="hs-identifier hs-var">argVar</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type -&gt; Type
</span><a href="#local-6989586621683094654"><span class="hs-identifier hs-var">argPar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094653"><span class="hs-identifier hs-var">argVar</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094646"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-622"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-623"></span><span>            </span><span class="hs-comment">-- Builds argument representation for Rep1 (more complicated due to</span><span>
</span><span id="line-624"></span><span>            </span><span class="hs-comment">-- the presence of composition).</span><span>
</span><span id="line-625"></span><span>            </span><span id="local-6989586621683094654"><span class="annot"><span class="annottext">argPar :: TyVar -&gt; Type -&gt; Type
</span><a href="#local-6989586621683094654"><span class="hs-identifier hs-var hs-var">argPar</span></a></span></span><span> </span><span id="local-6989586621683094655"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094655"><span class="hs-identifier hs-var">argVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-626"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- If deriving Generic1, make sure to substitute the last</span><span>
</span><span id="line-627"></span><span>                  </span><span class="hs-comment">-- type variable with Any in the generated Rep1 instance.</span><span>
</span><span id="line-628"></span><span>                  </span><span class="hs-comment">-- This avoids issues like what is documented in the</span><span>
</span><span id="line-629"></span><span>                  </span><span class="hs-comment">-- &quot;wrinkle&quot; section of</span><span>
</span><span id="line-630"></span><span>                  </span><span class="hs-comment">-- Note [Generating a correctly typed Rep instance].</span><span>
</span><span id="line-631"></span><span>                  </span><span id="local-6989586621683094656"><span class="annot"><span class="annottext">env :: TvSubstEnv
</span><a href="#local-6989586621683094656"><span class="hs-identifier hs-var hs-var">env</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; [Type] -&gt; TvSubstEnv
HasDebugCallStack =&gt; [TyVar] -&gt; [Type] -&gt; TvSubstEnv
</span><a href="GHC.Core.TyCo.Subst.html#zipTyEnv"><span class="hs-identifier hs-var">zipTyEnv</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094655"><span class="hs-identifier hs-var">argVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Builtin.Types.html#anyTypeOfKind"><span class="hs-identifier hs-var">anyTypeOfKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094655"><span class="hs-identifier hs-var">argVar</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-632"></span><span>                  </span><span id="local-6989586621683094660"><span class="annot"><span class="annottext">in_scope :: InScopeSet
</span><a href="#local-6989586621683094660"><span class="hs-identifier hs-var hs-var">in_scope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094525"><span class="hs-identifier hs-var">tycon_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>                  </span><span id="local-6989586621683094663"><span class="annot"><span class="annottext">subst :: Subst
</span><a href="#local-6989586621683094663"><span class="hs-identifier hs-var hs-var">subst</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#mkTvSubst"><span class="hs-identifier hs-var">mkTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621683094660"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621683094656"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span>              </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Subst -&gt; Type -&gt; Type
Subst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621683094663"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; (Type -&gt; Type) -&gt; Type -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; ArgTyAlg Type -&gt; Type -&gt; Type
forall a. TyVar -&gt; ArgTyAlg a -&gt; Type -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#argTyFold"><span class="hs-identifier hs-var">argTyFold</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094655"><span class="hs-identifier hs-var">argVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#ArgTyAlg"><span class="hs-identifier hs-type">ArgTyAlg</span></a></span><span>
</span><span id="line-636"></span><span>              </span><span class="hs-special">{</span><span class="annot"><span class="annottext">ata_rec0 :: Type -&gt; Type
</span><a href="GHC.Tc.Deriv.Generics.html#ata_rec0"><span class="hs-identifier hs-var">ata_rec0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621683094606"><span class="hs-identifier hs-var">mkRec0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ata_par1 :: Type
</span><a href="GHC.Tc.Deriv.Generics.html#ata_par1"><span class="hs-identifier hs-var">ata_par1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094611"><span class="hs-identifier hs-var">mkPar1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-637"></span><span>               </span><span class="annot"><span class="annottext">ata_rec1 :: Type -&gt; Type
</span><a href="GHC.Tc.Deriv.Generics.html#ata_rec1"><span class="hs-identifier hs-var">ata_rec1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621683094609"><span class="hs-identifier hs-var">mkRec1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ata_comp :: Type -&gt; Type -&gt; Type
</span><a href="GHC.Tc.Deriv.Generics.html#ata_comp"><span class="hs-identifier hs-var">ata_comp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Type -&gt; Type -&gt; Type -&gt; Type
</span><a href="GHC.Tc.Deriv.Generics.html#mkComp"><span class="hs-identifier hs-var">mkComp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094547"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094526"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>
</span><span id="line-639"></span><span>        </span><span id="local-6989586621683094667"><span class="annot"><a href="#local-6989586621683094667"><span class="hs-identifier hs-var hs-var">tyConName_user</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.TyCon.html#tyConFamInst_maybe"><span class="hs-identifier hs-var">tyConFamInst_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094523"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-640"></span><span>                           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683094668"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094668"><span class="hs-identifier hs-var">ptycon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094668"><span class="hs-identifier hs-var">ptycon</span></a></span><span>
</span><span id="line-641"></span><span>                           </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><span class="hs-identifier hs-var">Nothing</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094523"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-642"></span><span>
</span><span id="line-643"></span><span>        </span><span id="local-6989586621683094669"><span class="annot"><a href="#local-6989586621683094669"><span class="hs-identifier hs-var hs-var">dtName</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Type
</span><a href="GHC.Core.Type.html#mkStrLitTy"><span class="hs-identifier hs-var">mkStrLitTy</span></a></span><span> </span><span class="annot"><span class="annottext">(FastString -&gt; Type) -&gt; (Name -&gt; FastString) -&gt; Name -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OccName -&gt; FastString
</span><a href="GHC.Types.Name.Occurrence.html#occNameFS"><span class="hs-identifier hs-var">occNameFS</span></a></span><span> </span><span class="annot"><span class="annottext">(OccName -&gt; FastString) -&gt; (Name -&gt; OccName) -&gt; Name -&gt; FastString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Type) -&gt; Name -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683094667"><span class="hs-identifier hs-var">tyConName_user</span></a></span><span>
</span><span id="line-644"></span><span>        </span><span id="local-6989586621683094672"><span class="annot"><a href="#local-6989586621683094672"><span class="hs-identifier hs-var hs-var">mdName</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Type
</span><a href="GHC.Core.Type.html#mkStrLitTy"><span class="hs-identifier hs-var">mkStrLitTy</span></a></span><span> </span><span class="annot"><span class="annottext">(FastString -&gt; Type) -&gt; (TyCon -&gt; FastString) -&gt; TyCon -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; FastString
</span><a href="Language.Haskell.Syntax.Module.Name.html#moduleNameFS"><span class="hs-identifier hs-var">moduleNameFS</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; FastString)
-&gt; (TyCon -&gt; ModuleName) -&gt; TyCon -&gt; FastString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Module -&gt; ModuleName
forall unit. GenModule unit -&gt; ModuleName
</span><a href="GHC.Unit.Types.html#moduleName"><span class="hs-identifier hs-var">moduleName</span></a></span><span>
</span><span id="line-645"></span><span>                </span><span class="annot"><span class="annottext">(Module -&gt; ModuleName) -&gt; (TyCon -&gt; Module) -&gt; TyCon -&gt; ModuleName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Name -&gt; Module
Name -&gt; Module
</span><a href="GHC.Types.Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Module) -&gt; (TyCon -&gt; Name) -&gt; TyCon -&gt; Module
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; Type) -&gt; TyCon -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094523"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-646"></span><span>        </span><span id="local-6989586621683094675"><span class="annot"><a href="#local-6989586621683094675"><span class="hs-identifier hs-var hs-var">pkgName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Type
</span><a href="GHC.Core.Type.html#mkStrLitTy"><span class="hs-identifier hs-var">mkStrLitTy</span></a></span><span> </span><span class="annot"><span class="annottext">(FastString -&gt; Type) -&gt; (TyCon -&gt; FastString) -&gt; TyCon -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Unit -&gt; FastString
forall u. IsUnitId u =&gt; u -&gt; FastString
</span><a href="GHC.Unit.Types.html#unitFS"><span class="hs-identifier hs-var">unitFS</span></a></span><span> </span><span class="annot"><span class="annottext">(Unit -&gt; FastString) -&gt; (TyCon -&gt; Unit) -&gt; TyCon -&gt; FastString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Module -&gt; Unit
forall unit. GenModule unit -&gt; unit
</span><a href="GHC.Unit.Types.html#moduleUnit"><span class="hs-identifier hs-var">moduleUnit</span></a></span><span>
</span><span id="line-647"></span><span>                </span><span class="annot"><span class="annottext">(Module -&gt; Unit) -&gt; (TyCon -&gt; Module) -&gt; TyCon -&gt; Unit
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Name -&gt; Module
Name -&gt; Module
</span><a href="GHC.Types.Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Module) -&gt; (TyCon -&gt; Name) -&gt; TyCon -&gt; Module
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; Type) -&gt; TyCon -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094523"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-648"></span><span>        </span><span id="local-6989586621683094676"><span class="annot"><a href="#local-6989586621683094676"><span class="hs-identifier hs-var hs-var">isNT</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#mkTyConTy"><span class="hs-identifier hs-var">mkTyConTy</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; Type) -&gt; TyCon -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094523"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-649"></span><span>                              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.html#promotedTrueDataCon"><span class="hs-identifier hs-var">promotedTrueDataCon</span></a></span><span>
</span><span id="line-650"></span><span>                              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.html#promotedFalseDataCon"><span class="hs-identifier hs-var">promotedFalseDataCon</span></a></span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span>        </span><span id="local-6989586621683094680"><span class="annot"><a href="#local-6989586621683094680"><span class="hs-identifier hs-var hs-var">ctName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Type
</span><a href="GHC.Core.Type.html#mkStrLitTy"><span class="hs-identifier hs-var">mkStrLitTy</span></a></span><span> </span><span class="annot"><span class="annottext">(FastString -&gt; Type) -&gt; (DataCon -&gt; FastString) -&gt; DataCon -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OccName -&gt; FastString
</span><a href="GHC.Types.Name.Occurrence.html#occNameFS"><span class="hs-identifier hs-var">occNameFS</span></a></span><span> </span><span class="annot"><span class="annottext">(OccName -&gt; FastString)
-&gt; (DataCon -&gt; OccName) -&gt; DataCon -&gt; FastString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; OccName) -&gt; (DataCon -&gt; Name) -&gt; DataCon -&gt; OccName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Name
</span><a href="GHC.Core.DataCon.html#dataConName"><span class="hs-identifier hs-var">dataConName</span></a></span><span>
</span><span id="line-653"></span><span>        </span><span id="local-6989586621683094682"><span class="annot"><a href="#local-6989586621683094682"><span class="hs-identifier hs-var hs-var">ctFix</span></a></span></span><span> </span><span id="local-6989586621683094683"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094683"><span class="hs-identifier hs-var">c</span></a></span></span><span>
</span><span id="line-654"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="GHC.Core.DataCon.html#dataConIsInfix"><span class="hs-identifier hs-var">dataConIsInfix</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094683"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-655"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Fixity
</span><a href="#local-6989586621683094521"><span class="hs-identifier hs-var">get_fixity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; Name
</span><a href="GHC.Core.DataCon.html#dataConName"><span class="hs-identifier hs-var">dataConName</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094683"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-656"></span><span>                   </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a></span><span> </span><span id="local-6989586621683094686"><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094686"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">FixityDirection
</span><a href="Language.Haskell.Syntax.Basic.html#InfixL"><span class="hs-identifier hs-var">InfixL</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">US -&gt; TyCon -&gt; Type
</span><a href="#local-6989586621683094688"><span class="hs-identifier hs-var">buildFix</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094686"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094576"><span class="hs-identifier hs-var">pLA</span></a></span><span>
</span><span id="line-657"></span><span>                   </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a></span><span> </span><span id="local-6989586621683094689"><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094689"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">FixityDirection
</span><a href="Language.Haskell.Syntax.Basic.html#InfixR"><span class="hs-identifier hs-var">InfixR</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">US -&gt; TyCon -&gt; Type
</span><a href="#local-6989586621683094688"><span class="hs-identifier hs-var">buildFix</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094689"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094578"><span class="hs-identifier hs-var">pRA</span></a></span><span>
</span><span id="line-658"></span><span>                   </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a></span><span> </span><span id="local-6989586621683094691"><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094691"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">FixityDirection
</span><a href="Language.Haskell.Syntax.Basic.html#InfixN"><span class="hs-identifier hs-var">InfixN</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">US -&gt; TyCon -&gt; Type
</span><a href="#local-6989586621683094688"><span class="hs-identifier hs-var">buildFix</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094691"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094580"><span class="hs-identifier hs-var">pNA</span></a></span><span>
</span><span id="line-659"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#mkTyConTy"><span class="hs-identifier hs-var">mkTyConTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094572"><span class="hs-identifier hs-var">pPrefix</span></a></span><span>
</span><span id="line-660"></span><span>        </span><span id="local-6989586621683094688"><span class="annot"><a href="#local-6989586621683094688"><span class="hs-identifier hs-var hs-var">buildFix</span></a></span></span><span> </span><span id="local-6989586621683094693"><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094693"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621683094694"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094694"><span class="hs-identifier hs-var">assoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094574"><span class="hs-identifier hs-var">pInfix</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#mkTyConTy"><span class="hs-identifier hs-var">mkTyConTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094694"><span class="hs-identifier hs-var">assoc</span></a></span><span>
</span><span id="line-661"></span><span>                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Type
</span><a href="GHC.Core.Type.html#mkNumLitTy"><span class="hs-identifier hs-var">mkNumLitTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">US -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094693"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span>        </span><span id="local-6989586621683094696"><span class="annot"><a href="#local-6989586621683094696"><span class="hs-identifier hs-var hs-var">isRec</span></a></span></span><span> </span><span id="local-6989586621683094697"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094697"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#mkTyConTy"><span class="hs-identifier hs-var">mkTyConTy</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; Type) -&gt; TyCon -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [FieldLabel]
</span><a href="GHC.Core.DataCon.html#dataConFieldLabels"><span class="hs-identifier hs-var">dataConFieldLabels</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094697"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLabel] -&gt; US -&gt; Bool
forall a. [a] -&gt; US -&gt; Bool
</span><a href="GHC.Utils.Misc.html#lengthExceeds"><span class="hs-operator hs-var">`lengthExceeds`</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">0</span></span><span>
</span><span id="line-664"></span><span>                              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.html#promotedTrueDataCon"><span class="hs-identifier hs-var">promotedTrueDataCon</span></a></span><span>
</span><span id="line-665"></span><span>                              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.html#promotedFalseDataCon"><span class="hs-identifier hs-var">promotedFalseDataCon</span></a></span><span>
</span><span id="line-666"></span><span>
</span><span id="line-667"></span><span>        </span><span id="local-6989586621683094698"><span class="annot"><a href="#local-6989586621683094698"><span class="hs-identifier hs-var hs-var">selName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Type
</span><a href="GHC.Core.Type.html#mkStrLitTy"><span class="hs-identifier hs-var">mkStrLitTy</span></a></span><span> </span><span class="annot"><span class="annottext">(FastString -&gt; Type)
-&gt; (FieldLabel -&gt; FastString) -&gt; FieldLabel -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FieldLabelString -&gt; FastString
</span><a href="Language.Haskell.Syntax.Basic.html#field_label"><span class="hs-identifier hs-var">field_label</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldLabelString -&gt; FastString)
-&gt; (FieldLabel -&gt; FieldLabelString) -&gt; FieldLabel -&gt; FastString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FieldLabel -&gt; FieldLabelString
</span><a href="GHC.Types.FieldLabel.html#flLabel"><span class="hs-identifier hs-var">flLabel</span></a></span><span>
</span><span id="line-668"></span><span>
</span><span id="line-669"></span><span>        </span><span id="local-6989586621683094701"><span class="annot"><a href="#local-6989586621683094701"><span class="hs-identifier hs-var hs-var">mbSel</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe FieldLabel
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.html#promotedNothingDataCon"><span class="hs-identifier hs-var">promotedNothingDataCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#typeSymbolKind"><span class="hs-identifier hs-var">typeSymbolKind</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-670"></span><span>        </span><span class="annot"><a href="#local-6989586621683094701"><span class="hs-identifier hs-var">mbSel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683094704"><span class="annot"><span class="annottext">FieldLabel
</span><a href="#local-6989586621683094704"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.html#promotedJustDataCon"><span class="hs-identifier hs-var">promotedJustDataCon</span></a></span><span>
</span><span id="line-671"></span><span>                                    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#typeSymbolKind"><span class="hs-identifier hs-var">typeSymbolKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FieldLabel -&gt; Type
</span><a href="#local-6989586621683094698"><span class="hs-identifier hs-var">selName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldLabel
</span><a href="#local-6989586621683094704"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-672"></span><span>
</span><span id="line-673"></span><span>        </span><span id="local-6989586621683094615"><span class="annot"><a href="#local-6989586621683094615"><span class="hs-identifier hs-var hs-var">metaDataTy</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094566"><span class="hs-identifier hs-var">md</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094669"><span class="hs-identifier hs-var">dtName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094672"><span class="hs-identifier hs-var">mdName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094675"><span class="hs-identifier hs-var">pkgName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094676"><span class="hs-identifier hs-var">isNT</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-674"></span><span>        </span><span id="local-6989586621683094619"><span class="annot"><a href="#local-6989586621683094619"><span class="hs-identifier hs-var hs-var">metaConsTy</span></a></span></span><span> </span><span id="local-6989586621683094706"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094706"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094568"><span class="hs-identifier hs-var">mc</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DataCon -&gt; Type
</span><a href="#local-6989586621683094680"><span class="hs-identifier hs-var">ctName</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094706"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Type
</span><a href="#local-6989586621683094682"><span class="hs-identifier hs-var">ctFix</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094706"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Type
</span><a href="#local-6989586621683094696"><span class="hs-identifier hs-var">isRec</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094706"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-675"></span><span>        </span><span id="local-6989586621683094630"><span class="annot"><a href="#local-6989586621683094630"><span class="hs-identifier hs-var hs-var">metaSelTy</span></a></span></span><span> </span><span id="local-6989586621683094707"><span class="annot"><span class="annottext">Maybe FieldLabel
</span><a href="#local-6989586621683094707"><span class="hs-identifier hs-var">mlbl</span></a></span></span><span> </span><span id="local-6989586621683094708"><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="#local-6989586621683094708"><span class="hs-identifier hs-var">su</span></a></span></span><span> </span><span id="local-6989586621683094709"><span class="annot"><span class="annottext">SrcStrictness
</span><a href="#local-6989586621683094709"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span id="local-6989586621683094710"><span class="annot"><span class="annottext">HsImplBang
</span><a href="#local-6989586621683094710"><span class="hs-identifier hs-var">ib</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-676"></span><span>            </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094570"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe FieldLabel -&gt; Type
</span><a href="#local-6989586621683094701"><span class="hs-identifier hs-var">mbSel</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FieldLabel
</span><a href="#local-6989586621683094707"><span class="hs-identifier hs-var">mlbl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094711"><span class="hs-identifier hs-var">pSUpkness</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094712"><span class="hs-identifier hs-var">pSStrness</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094713"><span class="hs-identifier hs-var">pDStrness</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-677"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-678"></span><span>            </span><span id="local-6989586621683094711"><span class="annot"><span class="annottext">pSUpkness :: Type
</span><a href="#local-6989586621683094711"><span class="hs-identifier hs-var hs-var">pSUpkness</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#mkTyConTy"><span class="hs-identifier hs-var">mkTyConTy</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; Type) -&gt; TyCon -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="#local-6989586621683094708"><span class="hs-identifier hs-var">su</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-679"></span><span>                                         </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="Language.Haskell.Syntax.Basic.html#SrcUnpack"><span class="hs-identifier hs-var">SrcUnpack</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094582"><span class="hs-identifier hs-var">pSUpk</span></a></span><span>
</span><span id="line-680"></span><span>                                         </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="Language.Haskell.Syntax.Basic.html#SrcNoUnpack"><span class="hs-identifier hs-var">SrcNoUnpack</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094584"><span class="hs-identifier hs-var">pSNUpk</span></a></span><span>
</span><span id="line-681"></span><span>                                         </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="Language.Haskell.Syntax.Basic.html#NoSrcUnpack"><span class="hs-identifier hs-var">NoSrcUnpack</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094586"><span class="hs-identifier hs-var">pNSUpkness</span></a></span><span>
</span><span id="line-682"></span><span>
</span><span id="line-683"></span><span>            </span><span id="local-6989586621683094712"><span class="annot"><span class="annottext">pSStrness :: Type
</span><a href="#local-6989586621683094712"><span class="hs-identifier hs-var hs-var">pSStrness</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#mkTyConTy"><span class="hs-identifier hs-var">mkTyConTy</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; Type) -&gt; TyCon -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SrcStrictness
</span><a href="#local-6989586621683094709"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-684"></span><span>                                         </span><span class="annot"><span class="annottext">SrcStrictness
</span><a href="Language.Haskell.Syntax.Basic.html#SrcLazy"><span class="hs-identifier hs-var">SrcLazy</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094588"><span class="hs-identifier hs-var">pSLzy</span></a></span><span>
</span><span id="line-685"></span><span>                                         </span><span class="annot"><span class="annottext">SrcStrictness
</span><a href="Language.Haskell.Syntax.Basic.html#SrcStrict"><span class="hs-identifier hs-var">SrcStrict</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094590"><span class="hs-identifier hs-var">pSStr</span></a></span><span>
</span><span id="line-686"></span><span>                                         </span><span class="annot"><span class="annottext">SrcStrictness
</span><a href="Language.Haskell.Syntax.Basic.html#NoSrcStrict"><span class="hs-identifier hs-var">NoSrcStrict</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094592"><span class="hs-identifier hs-var">pNSStrness</span></a></span><span>
</span><span id="line-687"></span><span>
</span><span id="line-688"></span><span>            </span><span id="local-6989586621683094713"><span class="annot"><span class="annottext">pDStrness :: Type
</span><a href="#local-6989586621683094713"><span class="hs-identifier hs-var hs-var">pDStrness</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#mkTyConTy"><span class="hs-identifier hs-var">mkTyConTy</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; Type) -&gt; TyCon -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsImplBang
</span><a href="#local-6989586621683094710"><span class="hs-identifier hs-var">ib</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-689"></span><span>                                         </span><span class="annot"><span class="annottext">HsImplBang
</span><a href="GHC.Core.DataCon.html#HsLazy"><span class="hs-identifier hs-var">HsLazy</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094594"><span class="hs-identifier hs-var">pDLzy</span></a></span><span>
</span><span id="line-690"></span><span>                                         </span><span class="annot"><a href="GHC.Core.DataCon.html#HsStrict"><span class="hs-identifier hs-type">HsStrict</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094596"><span class="hs-identifier hs-var">pDStr</span></a></span><span>
</span><span id="line-691"></span><span>                                         </span><span class="annot"><a href="GHC.Core.DataCon.html#HsUnpack"><span class="hs-identifier hs-type">HsUnpack</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094598"><span class="hs-identifier hs-var">pDUpk</span></a></span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683094613"><span class="hs-identifier hs-type">mkD</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683094523"><span class="hs-identifier hs-type">tycon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-694"></span><span>
</span><span id="line-695"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#mkComp"><span class="hs-identifier hs-type">mkComp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-696"></span><span id="mkComp"><span class="annot"><span class="annottext">mkComp :: TyCon -&gt; Type -&gt; Type -&gt; Type -&gt; Type
</span><a href="GHC.Tc.Deriv.Generics.html#mkComp"><span class="hs-identifier hs-var hs-var">mkComp</span></a></span></span><span> </span><span id="local-6989586621683094723"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094723"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span id="local-6989586621683094724"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094724"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621683094725"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094725"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621683094726"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094726"><span class="hs-identifier hs-var">g</span></a></span></span><span>
</span><span id="line-697"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683094727"><span class="hs-identifier hs-var">k1_first</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094723"><span class="hs-identifier hs-var">comp</span></a></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094724"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094725"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094726"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-698"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094723"><span class="hs-identifier hs-var">comp</span></a></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094724"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094725"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094726"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-699"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-700"></span><span>    </span><span class="hs-comment">-- Which of these is the case?</span><span>
</span><span id="line-701"></span><span>    </span><span class="hs-comment">--     newtype (:.:) {k1} {k2} (f :: k2-&gt;*) (g :: k1-&gt;k2) (p :: k1) = ...</span><span>
</span><span id="line-702"></span><span>    </span><span class="hs-comment">-- or  newtype (:.:) {k2} {k1} (f :: k2-&gt;*) (g :: k1-&gt;k2) (p :: k1) = ...</span><span>
</span><span id="line-703"></span><span>    </span><span class="hs-comment">-- We want to instantiate with k1=k, and k2=*</span><span>
</span><span id="line-704"></span><span>    </span><span class="hs-comment">--    Reason for k2=*: see Note [Handling kinds in a Rep instance]</span><span>
</span><span id="line-705"></span><span>    </span><span class="hs-comment">-- But we need to know which way round!</span><span>
</span><span id="line-706"></span><span>    </span><span id="local-6989586621683094727"><span class="annot"><span class="annottext">k1_first :: Bool
</span><a href="#local-6989586621683094727"><span class="hs-identifier hs-var hs-var">k1_first</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094728"><span class="hs-identifier hs-var">k_first</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TyVar -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094729"><span class="hs-identifier hs-var">p_kind_var</span></a></span><span>
</span><span id="line-707"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621683094728"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094728"><span class="hs-identifier hs-var">k_first</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621683094730"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094730"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [TyVar]
</span><a href="GHC.Core.TyCon.html#tyConTyVars"><span class="hs-identifier hs-var">tyConTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094723"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-708"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683094729"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094729"><span class="hs-identifier hs-var">p_kind_var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyVar
</span><a href="GHC.Core.Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094730"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-709"></span><span>
</span><span id="line-710"></span><span class="hs-comment">-- Given the TyCons for each URec-related type synonym, check to see if the</span><span>
</span><span id="line-711"></span><span class="hs-comment">-- given type is an unlifted type that generics understands. If so, return</span><span>
</span><span id="line-712"></span><span class="hs-comment">-- its representation type. Otherwise, return Rec0.</span><span>
</span><span id="line-713"></span><span class="hs-comment">-- See Note [Generics and unlifted types]</span><span>
</span><span id="line-714"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#mkBoxTy"><span class="hs-identifier hs-type">mkBoxTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-comment">-- UAddr</span><span>
</span><span id="line-715"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-comment">-- UChar</span><span>
</span><span id="line-716"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-comment">-- UDouble</span><span>
</span><span id="line-717"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-comment">-- UFloat</span><span>
</span><span id="line-718"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-comment">-- UInt</span><span>
</span><span id="line-719"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-comment">-- UWord</span><span>
</span><span id="line-720"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-comment">-- Rec0</span><span>
</span><span id="line-721"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span>  </span><span class="hs-comment">-- What to instantiate Rec0's kind variable with</span><span>
</span><span id="line-722"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-723"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-724"></span><span id="mkBoxTy"><span class="annot"><span class="annottext">mkBoxTy :: TyCon
-&gt; TyCon
-&gt; TyCon
-&gt; TyCon
-&gt; TyCon
-&gt; TyCon
-&gt; TyCon
-&gt; Type
-&gt; Type
-&gt; Type
</span><a href="GHC.Tc.Deriv.Generics.html#mkBoxTy"><span class="hs-identifier hs-var hs-var">mkBoxTy</span></a></span></span><span> </span><span id="local-6989586621683094731"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094731"><span class="hs-identifier hs-var">uAddr</span></a></span></span><span> </span><span id="local-6989586621683094732"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094732"><span class="hs-identifier hs-var">uChar</span></a></span></span><span> </span><span id="local-6989586621683094733"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094733"><span class="hs-identifier hs-var">uDouble</span></a></span></span><span> </span><span id="local-6989586621683094734"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094734"><span class="hs-identifier hs-var">uFloat</span></a></span></span><span> </span><span id="local-6989586621683094735"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094735"><span class="hs-identifier hs-var">uInt</span></a></span></span><span> </span><span id="local-6989586621683094736"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094736"><span class="hs-identifier hs-var">uWord</span></a></span></span><span> </span><span id="local-6989586621683094737"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094737"><span class="hs-identifier hs-var">rec0</span></a></span></span><span> </span><span id="local-6989586621683094738"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094738"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621683094739"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094739"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-725"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094739"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#addrPrimTy"><span class="hs-identifier hs-var">addrPrimTy</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094731"><span class="hs-identifier hs-var">uAddr</span></a></span><span>   </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094738"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-726"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094739"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#charPrimTy"><span class="hs-identifier hs-var">charPrimTy</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094732"><span class="hs-identifier hs-var">uChar</span></a></span><span>   </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094738"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-727"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094739"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#doublePrimTy"><span class="hs-identifier hs-var">doublePrimTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094733"><span class="hs-identifier hs-var">uDouble</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094738"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-728"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094739"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#floatPrimTy"><span class="hs-identifier hs-var">floatPrimTy</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094734"><span class="hs-identifier hs-var">uFloat</span></a></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094738"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-729"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094739"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#intPrimTy"><span class="hs-identifier hs-var">intPrimTy</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094735"><span class="hs-identifier hs-var">uInt</span></a></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094738"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-730"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094739"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#wordPrimTy"><span class="hs-identifier hs-var">wordPrimTy</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094736"><span class="hs-identifier hs-var">uWord</span></a></span><span>   </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094738"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-731"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683094737"><span class="hs-identifier hs-var">rec0</span></a></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094738"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094739"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-732"></span><span>
</span><span id="line-733"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-734"></span><span class="hs-comment">-- Dealing with sums</span><span>
</span><span id="line-735"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-736"></span><span>
</span><span id="line-737"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#mkSum"><span class="hs-identifier hs-type">mkSum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#GenericKind"><span class="hs-identifier hs-type">GenericKind</span></a></span><span>  </span><span class="hs-comment">-- Generic or Generic1?</span><span>
</span><span id="line-738"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#US"><span class="hs-identifier hs-type">US</span></a></span><span>           </span><span class="hs-comment">-- Base for generating unique names</span><span>
</span><span id="line-739"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generate.html#DerivInstTys"><span class="hs-identifier hs-type">DerivInstTys</span></a></span><span> </span><span class="hs-comment">-- Information about the last type argument to Generic(1)</span><span>
</span><span id="line-740"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- The data constructors</span><span>
</span><span id="line-741"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- Alternatives for the T-&gt;Trep &quot;from&quot; function</span><span>
</span><span id="line-742"></span><span>          </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- Alternatives for the Trep-&gt;T &quot;to&quot; function</span><span>
</span><span id="line-743"></span><span>
</span><span id="line-744"></span><span class="hs-comment">-- Datatype without any constructors</span><span>
</span><span id="line-745"></span><span id="mkSum"><span class="annot"><span class="annottext">mkSum :: GenericKind -&gt; US -&gt; DerivInstTys -&gt; [DataCon] -&gt; ([Alt], [Alt])
</span><a href="GHC.Tc.Deriv.Generics.html#mkSum"><span class="hs-identifier hs-var hs-var">mkSum</span></a></span></span><span> </span><span class="annot"><span class="annottext">GenericKind
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DerivInstTys
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Alt
(GenLocated SrcSpanAnnA (Pat GhcPs), LocatedA (HsExpr GhcPs))
</span><a href="#local-6989586621683094747"><span class="hs-identifier hs-var">from_alt</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Alt
(GenLocated SrcSpanAnnA (Pat GhcPs), LocatedA (HsExpr GhcPs))
</span><a href="#local-6989586621683094748"><span class="hs-identifier hs-var">to_alt</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-746"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-747"></span><span>    </span><span id="local-6989586621683094747"><span class="annot"><span class="annottext">from_alt :: (GenLocated SrcSpanAnnA (Pat GhcPs), LocatedA (HsExpr GhcPs))
</span><a href="#local-6989586621683094747"><span class="hs-identifier hs-var hs-var">from_alt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LPat GhcPs
GenLocated SrcSpanAnnA (Pat GhcPs)
</span><a href="GHC.Tc.Deriv.Generics.html#x_Pat"><span class="hs-identifier hs-var">x_Pat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; [LMatch GhcPs (LHsExpr GhcPs)] -&gt; LHsExpr GhcPs
</span><a href="GHC.Hs.Utils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#x_Expr"><span class="hs-identifier hs-var">x_Expr</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-748"></span><span>    </span><span id="local-6989586621683094748"><span class="annot"><span class="annottext">to_alt :: (GenLocated SrcSpanAnnA (Pat GhcPs), LocatedA (HsExpr GhcPs))
</span><a href="#local-6989586621683094748"><span class="hs-identifier hs-var hs-var">to_alt</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LPat GhcPs
GenLocated SrcSpanAnnA (Pat GhcPs)
</span><a href="GHC.Tc.Deriv.Generics.html#x_Pat"><span class="hs-identifier hs-var">x_Pat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; [LMatch GhcPs (LHsExpr GhcPs)] -&gt; LHsExpr GhcPs
</span><a href="GHC.Hs.Utils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#x_Expr"><span class="hs-identifier hs-var">x_Expr</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-749"></span><span>               </span><span class="hs-comment">-- These M1s are meta-information for the datatype</span><span>
</span><span id="line-750"></span><span>
</span><span id="line-751"></span><span class="hs-comment">-- Datatype with at least one constructor</span><span>
</span><span id="line-752"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#mkSum"><span class="hs-identifier hs-var">mkSum</span></a></span><span> </span><span id="local-6989586621683094749"><span class="annot"><span class="annottext">GenericKind
</span><a href="#local-6989586621683094749"><span class="hs-identifier hs-var">gk</span></a></span></span><span> </span><span id="local-6989586621683094750"><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094750"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span id="local-6989586621683094751"><span class="annot"><span class="annottext">DerivInstTys
</span><a href="#local-6989586621683094751"><span class="hs-identifier hs-var">dit</span></a></span></span><span> </span><span id="local-6989586621683094752"><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621683094752"><span class="hs-identifier hs-var">datacons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-753"></span><span>  </span><span class="hs-comment">-- switch the payload of gk_ to be datacon-centric instead of tycon-centric</span><span>
</span><span id="line-754"></span><span> </span><span class="annot"><span class="annottext">[((GenLocated SrcSpanAnnA (Pat GhcPs), LocatedA (HsExpr GhcPs)),
  (GenLocated SrcSpanAnnA (Pat GhcPs), LocatedA (HsExpr GhcPs)))]
-&gt; ([(GenLocated SrcSpanAnnA (Pat GhcPs),
      LocatedA (HsExpr GhcPs))],
    [(GenLocated SrcSpanAnnA (Pat GhcPs), LocatedA (HsExpr GhcPs))])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">GenericKind
-&gt; US -&gt; US -&gt; US -&gt; DerivInstTys -&gt; DataCon -&gt; (Alt, Alt)
</span><a href="GHC.Tc.Deriv.Generics.html#mk1Sum"><span class="hs-identifier hs-var">mk1Sum</span></a></span><span> </span><span class="annot"><span class="annottext">GenericKind
</span><a href="#local-6989586621683094749"><span class="hs-identifier hs-var">gk</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094750"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094755"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DataCon] -&gt; US
forall a. [a] -&gt; US
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; US
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621683094752"><span class="hs-identifier hs-var">datacons</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DerivInstTys
</span><a href="#local-6989586621683094751"><span class="hs-identifier hs-var">dit</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094756"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-755"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683094756"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094756"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621683094755"><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094755"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[DataCon] -&gt; [US] -&gt; [(DataCon, US)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621683094752"><span class="hs-identifier hs-var">datacons</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">US
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-756"></span><span>
</span><span id="line-757"></span><span class="hs-comment">-- Build the sum for a particular constructor</span><span>
</span><span id="line-758"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#mk1Sum"><span class="hs-identifier hs-type">mk1Sum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#GenericKind"><span class="hs-identifier hs-type">GenericKind</span></a></span><span>  </span><span class="hs-comment">-- Generic or Generic1?</span><span>
</span><span id="line-759"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#US"><span class="hs-identifier hs-type">US</span></a></span><span>           </span><span class="hs-comment">-- Base for generating unique names</span><span>
</span><span id="line-760"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>          </span><span class="hs-comment">-- The index of this constructor</span><span>
</span><span id="line-761"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>          </span><span class="hs-comment">-- Total number of constructors</span><span>
</span><span id="line-762"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generate.html#DerivInstTys"><span class="hs-identifier hs-type">DerivInstTys</span></a></span><span> </span><span class="hs-comment">-- Information about the last type argument to Generic(1)</span><span>
</span><span id="line-763"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span>      </span><span class="hs-comment">-- The data constructor</span><span>
</span><span id="line-764"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- Alternative for the T-&gt;Trep &quot;from&quot; function</span><span>
</span><span id="line-765"></span><span>           </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span class="hs-special">)</span><span>        </span><span class="hs-comment">-- Alternative for the Trep-&gt;T &quot;to&quot; function</span><span>
</span><span id="line-766"></span><span id="mk1Sum"><span class="annot"><span class="annottext">mk1Sum :: GenericKind
-&gt; US -&gt; US -&gt; US -&gt; DerivInstTys -&gt; DataCon -&gt; (Alt, Alt)
</span><a href="GHC.Tc.Deriv.Generics.html#mk1Sum"><span class="hs-identifier hs-var hs-var">mk1Sum</span></a></span></span><span> </span><span id="local-6989586621683094757"><span class="annot"><span class="annottext">GenericKind
</span><a href="#local-6989586621683094757"><span class="hs-identifier hs-var">gk</span></a></span></span><span> </span><span id="local-6989586621683094758"><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094758"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span id="local-6989586621683094759"><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094759"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621683094760"><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094760"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621683094761"><span class="annot"><span class="annottext">dit :: DerivInstTys
</span><a href="#local-6989586621683094761"><span class="hs-identifier hs-var">dit</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Deriv.Generate.html#DerivInstTys"><span class="hs-identifier hs-type">DerivInstTys</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">dit_rep_tc_args :: DerivInstTys -&gt; [Type]
</span><a href="GHC.Tc.Deriv.Generate.html#dit_rep_tc_args"><span class="hs-identifier hs-var">dit_rep_tc_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683094762"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094762"><span class="hs-identifier hs-var">tc_args</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683094763"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094763"><span class="hs-identifier hs-var">datacon</span></a></span></span><span>
</span><span id="line-767"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Alt
(GenLocated SrcSpanAnnA (Pat GhcPs), LocatedA (HsExpr GhcPs))
</span><a href="#local-6989586621683094764"><span class="hs-identifier hs-var">from_alt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Alt
(GenLocated SrcSpanAnnA (Pat GhcPs), LocatedA (HsExpr GhcPs))
</span><a href="#local-6989586621683094765"><span class="hs-identifier hs-var">to_alt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-768"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-769"></span><span>    </span><span id="local-6989586621683094766"><span class="annot"><span class="annottext">gk_ :: GenericKind_DC
</span><a href="#local-6989586621683094766"><span class="hs-identifier hs-var hs-var">gk_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenericKind -&gt; DataCon -&gt; [Type] -&gt; GenericKind_DC
</span><a href="GHC.Tc.Deriv.Generics.html#gk2gkDC"><span class="hs-identifier hs-var">gk2gkDC</span></a></span><span> </span><span class="annot"><span class="annottext">GenericKind
</span><a href="#local-6989586621683094757"><span class="hs-identifier hs-var">gk</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094763"><span class="hs-identifier hs-var">datacon</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094762"><span class="hs-identifier hs-var">tc_args</span></a></span><span>
</span><span id="line-770"></span><span>
</span><span id="line-771"></span><span>    </span><span class="hs-comment">-- Existentials already excluded</span><span>
</span><span id="line-772"></span><span>    </span><span id="local-6989586621683094767"><span class="annot"><span class="annottext">argTys :: [Type]
</span><a href="#local-6989586621683094767"><span class="hs-identifier hs-var hs-var">argTys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; DerivInstTys -&gt; [Type]
</span><a href="GHC.Tc.Deriv.Generate.html#derivDataConInstArgTys"><span class="hs-identifier hs-var">derivDataConInstArgTys</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094763"><span class="hs-identifier hs-var">datacon</span></a></span><span> </span><span class="annot"><span class="annottext">DerivInstTys
</span><a href="#local-6989586621683094761"><span class="hs-identifier hs-var">dit</span></a></span><span>
</span><span id="line-773"></span><span>    </span><span id="local-6989586621683094768"><span class="annot"><span class="annottext">n_args :: US
</span><a href="#local-6989586621683094768"><span class="hs-identifier hs-var hs-var">n_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; US
</span><a href="GHC.Core.DataCon.html#dataConSourceArity"><span class="hs-identifier hs-var">dataConSourceArity</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094763"><span class="hs-identifier hs-var">datacon</span></a></span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span>    </span><span id="local-6989586621683094769"><span class="annot"><span class="annottext">datacon_varTys :: [(RdrName, Type)]
</span><a href="#local-6989586621683094769"><span class="hs-identifier hs-var hs-var">datacon_varTys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RdrName] -&gt; [Type] -&gt; [(RdrName, Type)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(US -&gt; RdrName) -&gt; [US] -&gt; [RdrName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">US -&gt; RdrName
</span><a href="GHC.Tc.Deriv.Generics.html#mkGenericLocal"><span class="hs-identifier hs-var">mkGenericLocal</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094758"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094758"><span class="hs-identifier hs-var">us</span></a></span><span class="annot"><span class="annottext">US -&gt; US -&gt; US
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094768"><span class="hs-identifier hs-var">n_args</span></a></span><span class="annot"><span class="annottext">US -&gt; US -&gt; US
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">US
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621683094767"><span class="hs-identifier hs-var">argTys</span></a></span><span>
</span><span id="line-776"></span><span>    </span><span id="local-6989586621683094772"><span class="annot"><span class="annottext">datacon_vars :: [RdrName]
</span><a href="#local-6989586621683094772"><span class="hs-identifier hs-var hs-var">datacon_vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((RdrName, Type) -&gt; RdrName) -&gt; [(RdrName, Type)] -&gt; [RdrName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(RdrName, Type) -&gt; RdrName
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(RdrName, Type)]
</span><a href="#local-6989586621683094769"><span class="hs-identifier hs-var">datacon_varTys</span></a></span><span>
</span><span id="line-777"></span><span>
</span><span id="line-778"></span><span>    </span><span id="local-6989586621683094774"><span class="annot"><span class="annottext">datacon_rdr :: RdrName
</span><a href="#local-6989586621683094774"><span class="hs-identifier hs-var hs-var">datacon_rdr</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; RdrName
forall thing. NamedThing thing =&gt; thing -&gt; RdrName
</span><a href="GHC.Types.Name.Reader.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683094763"><span class="hs-identifier hs-var">datacon</span></a></span><span>
</span><span id="line-779"></span><span>
</span><span id="line-780"></span><span>    </span><span id="local-6989586621683094764"><span class="annot"><span class="annottext">from_alt :: (GenLocated SrcSpanAnnA (Pat GhcPs), LocatedA (HsExpr GhcPs))
</span><a href="#local-6989586621683094764"><span class="hs-identifier hs-var hs-var">from_alt</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName -&gt; [RdrName] -&gt; LPat GhcPs
</span><a href="GHC.Hs.Utils.html#nlConVarPat"><span class="hs-identifier hs-var">nlConVarPat</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683094774"><span class="hs-identifier hs-var">datacon_rdr</span></a></span><span> </span><span class="annot"><span class="annottext">[RdrName]
</span><a href="#local-6989586621683094772"><span class="hs-identifier hs-var">datacon_vars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
LocatedA (HsExpr GhcPs)
</span><a href="#local-6989586621683094777"><span class="hs-identifier hs-var">from_alt_rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-781"></span><span>    </span><span id="local-6989586621683094777"><span class="annot"><span class="annottext">from_alt_rhs :: LHsExpr GhcPs
</span><a href="#local-6989586621683094777"><span class="hs-identifier hs-var hs-var">from_alt_rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#genLR_E"><span class="hs-identifier hs-var">genLR_E</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094759"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094760"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericKind_DC -&gt; [(RdrName, Type)] -&gt; LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#mkProd_E"><span class="hs-identifier hs-var">mkProd_E</span></a></span><span> </span><span class="annot"><span class="annottext">GenericKind_DC
</span><a href="#local-6989586621683094766"><span class="hs-identifier hs-var">gk_</span></a></span><span> </span><span class="annot"><span class="annottext">[(RdrName, Type)]
</span><a href="#local-6989586621683094769"><span class="hs-identifier hs-var">datacon_varTys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-782"></span><span>
</span><span id="line-783"></span><span>    </span><span id="local-6989586621683094765"><span class="annot"><span class="annottext">to_alt :: (GenLocated SrcSpanAnnA (Pat GhcPs), LocatedA (HsExpr GhcPs))
</span><a href="#local-6989586621683094765"><span class="hs-identifier hs-var hs-var">to_alt</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; LPat GhcPs -&gt; LPat GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#genLR_P"><span class="hs-identifier hs-var">genLR_P</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094759"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094760"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericKind -&gt; [(RdrName, Type)] -&gt; LPat GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#mkProd_P"><span class="hs-identifier hs-var">mkProd_P</span></a></span><span> </span><span class="annot"><span class="annottext">GenericKind
</span><a href="#local-6989586621683094757"><span class="hs-identifier hs-var">gk</span></a></span><span> </span><span class="annot"><span class="annottext">[(RdrName, Type)]
</span><a href="#local-6989586621683094769"><span class="hs-identifier hs-var">datacon_varTys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-784"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
LocatedA (HsExpr GhcPs)
</span><a href="#local-6989586621683094782"><span class="hs-identifier hs-var">to_alt_rhs</span></a></span><span>
</span><span id="line-785"></span><span>                 </span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- These M1s are meta-information for the datatype</span><span>
</span><span id="line-786"></span><span>    </span><span id="local-6989586621683094782"><span class="annot"><span class="annottext">to_alt_rhs :: LHsExpr GhcPs
</span><a href="#local-6989586621683094782"><span class="hs-identifier hs-var hs-var">to_alt_rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GenericKind_DC
</span><a href="#local-6989586621683094766"><span class="hs-identifier hs-var">gk_</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-787"></span><span>      </span><span class="annot"><span class="annottext">GenericKind_DC
</span><a href="GHC.Tc.Deriv.Generics.html#Gen0_DC"><span class="hs-identifier hs-var">Gen0_DC</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; [IdP GhcPs] -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; [IdP (GhcPass p)] -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="#local-6989586621683094774"><span class="hs-identifier hs-var">datacon_rdr</span></a></span><span> </span><span class="annot"><span class="annottext">[IdP GhcPs]
[RdrName]
</span><a href="#local-6989586621683094772"><span class="hs-identifier hs-var">datacon_vars</span></a></span><span>
</span><span id="line-788"></span><span>      </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#Gen1_DC"><span class="hs-identifier hs-type">Gen1_DC</span></a></span><span> </span><span id="local-6989586621683094784"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094784"><span class="hs-identifier hs-var">argVar</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; [LHsExpr GhcPs] -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; [LHsExpr (GhcPass p)] -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="#local-6989586621683094774"><span class="hs-identifier hs-var">datacon_rdr</span></a></span><span> </span><span class="annot"><span class="annottext">([LHsExpr GhcPs] -&gt; LHsExpr GhcPs)
-&gt; [LHsExpr GhcPs] -&gt; LHsExpr GhcPs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((RdrName, Type) -&gt; LHsExpr GhcPs)
-&gt; [(RdrName, Type)] -&gt; [LHsExpr GhcPs]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(RdrName, Type) -&gt; LHsExpr GhcPs
</span><a href="#local-6989586621683094786"><span class="hs-identifier hs-var">argTo</span></a></span><span> </span><span class="annot"><span class="annottext">[(RdrName, Type)]
</span><a href="#local-6989586621683094769"><span class="hs-identifier hs-var">datacon_varTys</span></a></span><span>
</span><span id="line-789"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-790"></span><span>          </span><span id="local-6989586621683094786"><span class="annot"><span class="annottext">argTo :: (RdrName, Type) -&gt; LHsExpr GhcPs
</span><a href="#local-6989586621683094786"><span class="hs-identifier hs-var hs-var">argTo</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683094787"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683094787"><span class="hs-identifier hs-var">var</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683094788"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094788"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; LocatedA (HsExpr GhcPs)
</span><a href="#local-6989586621683094789"><span class="hs-identifier hs-var">converter</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094788"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
forall (id :: Pass).
IsPass id =&gt;
LHsExpr (GhcPass id)
-&gt; LHsExpr (GhcPass id) -&gt; LHsExpr (GhcPass id)
</span><a href="GHC.Hs.Utils.html#nlHsApp"><span class="hs-operator hs-var">`nlHsApp`</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="#local-6989586621683094787"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-791"></span><span>            </span><span id="local-6989586621683094789"><span class="annot"><span class="annottext">converter :: Type -&gt; LocatedA (HsExpr GhcPs)
</span><a href="#local-6989586621683094789"><span class="hs-identifier hs-var hs-var">converter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar
-&gt; ArgTyAlg (LocatedA (HsExpr GhcPs))
-&gt; Type
-&gt; LocatedA (HsExpr GhcPs)
forall a. TyVar -&gt; ArgTyAlg a -&gt; Type -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#argTyFold"><span class="hs-identifier hs-var">argTyFold</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094784"><span class="hs-identifier hs-var">argVar</span></a></span><span> </span><span class="annot"><span class="annottext">(ArgTyAlg (LocatedA (HsExpr GhcPs))
 -&gt; Type -&gt; LocatedA (HsExpr GhcPs))
-&gt; ArgTyAlg (LocatedA (HsExpr GhcPs))
-&gt; Type
-&gt; LocatedA (HsExpr GhcPs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#ArgTyAlg"><span class="hs-identifier hs-type">ArgTyAlg</span></a></span><span>
</span><span id="line-792"></span><span>              </span><span class="hs-special">{</span><span class="annot"><span class="annottext">ata_rec0 :: Type -&gt; LocatedA (HsExpr GhcPs)
</span><a href="GHC.Tc.Deriv.Generics.html#ata_rec0"><span class="hs-identifier hs-var">ata_rec0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LHsExpr GhcPs
RdrName -&gt; LocatedA (HsExpr GhcPs)
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">(RdrName -&gt; LocatedA (HsExpr GhcPs))
-&gt; (Type -&gt; RdrName) -&gt; Type -&gt; LocatedA (HsExpr GhcPs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; RdrName
</span><a href="GHC.Tc.Deriv.Generics.html#unboxRepRDR"><span class="hs-identifier hs-var">unboxRepRDR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-793"></span><span>               </span><span class="annot"><span class="annottext">ata_par1 :: LocatedA (HsExpr GhcPs)
</span><a href="GHC.Tc.Deriv.Generics.html#ata_par1"><span class="hs-identifier hs-var">ata_par1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="GHC.Builtin.Names.html#unPar1_RDR"><span class="hs-identifier hs-var">unPar1_RDR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-794"></span><span>               </span><span class="annot"><span class="annottext">ata_rec1 :: Type -&gt; LocatedA (HsExpr GhcPs)
</span><a href="GHC.Tc.Deriv.Generics.html#ata_rec1"><span class="hs-identifier hs-var">ata_rec1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocatedA (HsExpr GhcPs) -&gt; Type -&gt; LocatedA (HsExpr GhcPs)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(LocatedA (HsExpr GhcPs) -&gt; Type -&gt; LocatedA (HsExpr GhcPs))
-&gt; LocatedA (HsExpr GhcPs) -&gt; Type -&gt; LocatedA (HsExpr GhcPs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="GHC.Builtin.Names.html#unRec1_RDR"><span class="hs-identifier hs-var">unRec1_RDR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-795"></span><span>               </span><span class="annot"><span class="annottext">ata_comp :: Type -&gt; LocatedA (HsExpr GhcPs) -&gt; LocatedA (HsExpr GhcPs)
</span><a href="GHC.Tc.Deriv.Generics.html#ata_comp"><span class="hs-identifier hs-var">ata_comp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683094795"><span class="annot"><span class="annottext">LocatedA (HsExpr GhcPs)
</span><a href="#local-6989586621683094795"><span class="hs-identifier hs-var">cnv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="GHC.Builtin.Names.html#fmap_RDR"><span class="hs-identifier hs-var">fmap_RDR</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
forall (id :: Pass).
IsPass id =&gt;
LHsExpr (GhcPass id)
-&gt; LHsExpr (GhcPass id) -&gt; LHsExpr (GhcPass id)
</span><a href="GHC.Hs.Utils.html#nlHsApp"><span class="hs-operator hs-var">`nlHsApp`</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
LocatedA (HsExpr GhcPs)
</span><a href="#local-6989586621683094795"><span class="hs-identifier hs-var">cnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-796"></span><span>                                    </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#nlHsCompose"><span class="hs-operator hs-var">`nlHsCompose`</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="GHC.Builtin.Names.html#unComp1_RDR"><span class="hs-identifier hs-var">unComp1_RDR</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-797"></span><span>
</span><span id="line-798"></span><span>
</span><span id="line-799"></span><span class="hs-comment">-- Generates the L1/R1 sum pattern</span><span>
</span><span id="line-800"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#genLR_P"><span class="hs-identifier hs-type">genLR_P</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Pat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Pat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-801"></span><span id="genLR_P"><span class="annot"><span class="annottext">genLR_P :: US -&gt; US -&gt; LPat GhcPs -&gt; LPat GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#genLR_P"><span class="hs-identifier hs-var hs-var">genLR_P</span></a></span></span><span> </span><span id="local-6989586621683094799"><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094799"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621683094800"><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094800"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621683094801"><span class="annot"><span class="annottext">LPat GhcPs
</span><a href="#local-6989586621683094801"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-802"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094800"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">0</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; GenLocated SrcSpanAnnA (Pat GhcPs)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>
</span><span id="line-803"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094800"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">1</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcPs
</span><a href="#local-6989586621683094801"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-804"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094799"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; US
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094800"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcPs -&gt; LPat GhcPs
forall (p :: Pass).
IsPass p =&gt;
LPat (GhcPass p) -&gt; LPat (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlParPat"><span class="hs-identifier hs-var">nlParPat</span></a></span><span> </span><span class="annot"><span class="annottext">(LPat GhcPs -&gt; LPat GhcPs) -&gt; LPat GhcPs -&gt; LPat GhcPs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; [LPat GhcPs] -&gt; LPat GhcPs
</span><a href="GHC.Hs.Utils.html#nlConPat"><span class="hs-identifier hs-var">nlConPat</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#l1DataCon_RDR"><span class="hs-identifier hs-var">l1DataCon_RDR</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">US -&gt; US -&gt; LPat GhcPs -&gt; LPat GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#genLR_P"><span class="hs-identifier hs-var">genLR_P</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094799"><span class="hs-identifier hs-var">i</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">US -&gt; US -&gt; US
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094800"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LPat GhcPs
</span><a href="#local-6989586621683094801"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-805"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcPs -&gt; LPat GhcPs
forall (p :: Pass).
IsPass p =&gt;
LPat (GhcPass p) -&gt; LPat (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlParPat"><span class="hs-identifier hs-var">nlParPat</span></a></span><span> </span><span class="annot"><span class="annottext">(LPat GhcPs -&gt; LPat GhcPs) -&gt; LPat GhcPs -&gt; LPat GhcPs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; [LPat GhcPs] -&gt; LPat GhcPs
</span><a href="GHC.Hs.Utils.html#nlConPat"><span class="hs-identifier hs-var">nlConPat</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#r1DataCon_RDR"><span class="hs-identifier hs-var">r1DataCon_RDR</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">US -&gt; US -&gt; LPat GhcPs -&gt; LPat GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#genLR_P"><span class="hs-identifier hs-var">genLR_P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094799"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">US -&gt; US -&gt; US
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094808"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094800"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">US -&gt; US -&gt; US
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094808"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="annottext">LPat GhcPs
</span><a href="#local-6989586621683094801"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-806"></span><span>                     </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621683094808"><span class="annot"><span class="annottext">m :: US
</span><a href="#local-6989586621683094808"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; US
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094800"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">2</span></span><span>
</span><span id="line-807"></span><span>
</span><span id="line-808"></span><span class="hs-comment">-- Generates the L1/R1 sum expression</span><span>
</span><span id="line-809"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#genLR_E"><span class="hs-identifier hs-type">genLR_E</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-810"></span><span id="genLR_E"><span class="annot"><span class="annottext">genLR_E :: US -&gt; US -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#genLR_E"><span class="hs-identifier hs-var hs-var">genLR_E</span></a></span></span><span> </span><span id="local-6989586621683094809"><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094809"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621683094810"><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094810"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621683094811"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621683094811"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-811"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094810"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">0</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; LocatedA (HsExpr GhcPs)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>
</span><span id="line-812"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094810"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">1</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621683094811"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-813"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094809"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; US
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094810"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="GHC.Builtin.Names.html#l1DataCon_RDR"><span class="hs-identifier hs-var">l1DataCon_RDR</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
forall (id :: Pass).
IsPass id =&gt;
LHsExpr (GhcPass id)
-&gt; LHsExpr (GhcPass id) -&gt; LHsExpr (GhcPass id)
</span><a href="GHC.Hs.Utils.html#nlHsApp"><span class="hs-operator hs-var">`nlHsApp`</span></a></span><span>
</span><span id="line-814"></span><span>                                            </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass).
IsPass p =&gt;
LHsExpr (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsPar"><span class="hs-identifier hs-var">nlHsPar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">US -&gt; US -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#genLR_E"><span class="hs-identifier hs-var">genLR_E</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094809"><span class="hs-identifier hs-var">i</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">US -&gt; US -&gt; US
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094810"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621683094811"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-815"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="GHC.Builtin.Names.html#r1DataCon_RDR"><span class="hs-identifier hs-var">r1DataCon_RDR</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
forall (id :: Pass).
IsPass id =&gt;
LHsExpr (GhcPass id)
-&gt; LHsExpr (GhcPass id) -&gt; LHsExpr (GhcPass id)
</span><a href="GHC.Hs.Utils.html#nlHsApp"><span class="hs-operator hs-var">`nlHsApp`</span></a></span><span>
</span><span id="line-816"></span><span>                                            </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass).
IsPass p =&gt;
LHsExpr (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsPar"><span class="hs-identifier hs-var">nlHsPar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">US -&gt; US -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#genLR_E"><span class="hs-identifier hs-var">genLR_E</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094809"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">US -&gt; US -&gt; US
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094812"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094810"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">US -&gt; US -&gt; US
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094812"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621683094811"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-817"></span><span>                     </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621683094812"><span class="annot"><span class="annottext">m :: US
</span><a href="#local-6989586621683094812"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; US
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094810"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">2</span></span><span>
</span><span id="line-818"></span><span>
</span><span id="line-819"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-820"></span><span class="hs-comment">-- Dealing with products</span><span>
</span><span id="line-821"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-822"></span><span>
</span><span id="line-823"></span><span class="hs-comment">-- Build a product expression</span><span>
</span><span id="line-824"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#mkProd_E"><span class="hs-identifier hs-type">mkProd_E</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#GenericKind_DC"><span class="hs-identifier hs-type">GenericKind_DC</span></a></span><span>    </span><span class="hs-comment">-- Generic or Generic1?</span><span>
</span><span id="line-825"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-826"></span><span>                       </span><span class="hs-comment">-- List of variables matched on the lhs and their types</span><span>
</span><span id="line-827"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>   </span><span class="hs-comment">-- Resulting product expression</span><span>
</span><span id="line-828"></span><span id="mkProd_E"><span class="annot"><span class="annottext">mkProd_E :: GenericKind_DC -&gt; [(RdrName, Type)] -&gt; LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#mkProd_E"><span class="hs-identifier hs-var hs-var">mkProd_E</span></a></span></span><span> </span><span id="local-6989586621683094813"><span class="annot"><span class="annottext">GenericKind_DC
</span><a href="#local-6989586621683094813"><span class="hs-identifier hs-var">gk_</span></a></span></span><span> </span><span id="local-6989586621683094814"><span class="annot"><span class="annottext">[(RdrName, Type)]
</span><a href="#local-6989586621683094814"><span class="hs-identifier hs-var">varTys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#mkM1_E"><span class="hs-identifier hs-var">mkM1_E</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LocatedA (HsExpr GhcPs)
 -&gt; LocatedA (HsExpr GhcPs) -&gt; LocatedA (HsExpr GhcPs))
-&gt; LocatedA (HsExpr GhcPs)
-&gt; [LocatedA (HsExpr GhcPs)]
-&gt; LocatedA (HsExpr GhcPs)
forall a. (a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#foldBal"><span class="hs-identifier hs-var">foldBal</span></a></span><span> </span><span class="annot"><span class="annottext">LocatedA (HsExpr GhcPs)
-&gt; LocatedA (HsExpr GhcPs) -&gt; LocatedA (HsExpr GhcPs)
forall {p :: Pass}.
(IdGhcP p ~ RdrName, IsPass p) =&gt;
GenLocated SrcSpanAnnA (HsExpr (GhcPass p))
-&gt; GenLocated SrcSpanAnnA (HsExpr (GhcPass p))
-&gt; GenLocated SrcSpanAnnA (HsExpr (GhcPass p))
</span><a href="#local-6989586621683094815"><span class="hs-identifier hs-var">prod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="GHC.Builtin.Names.html#u1DataCon_RDR"><span class="hs-identifier hs-var">u1DataCon_RDR</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LocatedA (HsExpr GhcPs)]
</span><a href="#local-6989586621683094817"><span class="hs-identifier hs-var">appVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-829"></span><span>                      </span><span class="hs-comment">-- These M1s are meta-information for the constructor</span><span>
</span><span id="line-830"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-831"></span><span>    </span><span id="local-6989586621683094817"><span class="annot"><span class="annottext">appVars :: [LocatedA (HsExpr GhcPs)]
</span><a href="#local-6989586621683094817"><span class="hs-identifier hs-var hs-var">appVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((RdrName, Type) -&gt; LocatedA (HsExpr GhcPs))
-&gt; [(RdrName, Type)] -&gt; [LocatedA (HsExpr GhcPs)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericKind_DC -&gt; (RdrName, Type) -&gt; LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#wrapArg_E"><span class="hs-identifier hs-var">wrapArg_E</span></a></span><span> </span><span class="annot"><span class="annottext">GenericKind_DC
</span><a href="#local-6989586621683094813"><span class="hs-identifier hs-var">gk_</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(RdrName, Type)]
</span><a href="#local-6989586621683094814"><span class="hs-identifier hs-var">varTys</span></a></span><span>
</span><span id="line-832"></span><span>    </span><span id="local-6989586621683094815"><span class="annot"><span class="annottext">prod :: GenLocated SrcSpanAnnA (HsExpr (GhcPass p))
-&gt; GenLocated SrcSpanAnnA (HsExpr (GhcPass p))
-&gt; LHsExpr (GhcPass p)
</span><a href="#local-6989586621683094815"><span class="hs-identifier hs-var hs-var">prod</span></a></span></span><span> </span><span id="local-6989586621683094840"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr (GhcPass p))
</span><a href="#local-6989586621683094840"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621683094841"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr (GhcPass p))
</span><a href="#local-6989586621683094841"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdP (GhcPass p)
RdrName
</span><a href="GHC.Builtin.Names.html#prodDataCon_RDR"><span class="hs-identifier hs-var">prodDataCon_RDR</span></a></span><span> </span><span class="annot"><span class="annottext">IdP (GhcPass p) -&gt; [LHsExpr (GhcPass p)] -&gt; LHsExpr (GhcPass p)
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; [LHsExpr (GhcPass p)] -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsApps"><span class="hs-operator hs-var">`nlHsApps`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LHsExpr (GhcPass p)
GenLocated SrcSpanAnnA (HsExpr (GhcPass p))
</span><a href="#local-6989586621683094840"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">LHsExpr (GhcPass p)
GenLocated SrcSpanAnnA (HsExpr (GhcPass p))
</span><a href="#local-6989586621683094841"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-833"></span><span>
</span><span id="line-834"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#wrapArg_E"><span class="hs-identifier hs-type">wrapArg_E</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#GenericKind_DC"><span class="hs-identifier hs-type">GenericKind_DC</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-835"></span><span id="wrapArg_E"><span class="annot"><span class="annottext">wrapArg_E :: GenericKind_DC -&gt; (RdrName, Type) -&gt; LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#wrapArg_E"><span class="hs-identifier hs-var hs-var">wrapArg_E</span></a></span></span><span> </span><span class="annot"><span class="annottext">GenericKind_DC
</span><a href="GHC.Tc.Deriv.Generics.html#Gen0_DC"><span class="hs-identifier hs-var">Gen0_DC</span></a></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621683094843"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683094843"><span class="hs-identifier hs-var">var</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683094844"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094844"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#mkM1_E"><span class="hs-identifier hs-var">mkM1_E</span></a></span><span> </span><span class="annot"><span class="annottext">(LHsExpr GhcPs -&gt; LHsExpr GhcPs) -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-836"></span><span>                            </span><span class="annot"><span class="annottext">Type -&gt; RdrName
</span><a href="GHC.Tc.Deriv.Generics.html#boxRepRDR"><span class="hs-identifier hs-var">boxRepRDR</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094844"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; [IdP GhcPs] -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; [IdP (GhcPass p)] -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVarApps"><span class="hs-operator hs-var">`nlHsVarApps`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="#local-6989586621683094843"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-837"></span><span>                         </span><span class="hs-comment">-- This M1 is meta-information for the selector</span><span>
</span><span id="line-838"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#wrapArg_E"><span class="hs-identifier hs-var">wrapArg_E</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#Gen1_DC"><span class="hs-identifier hs-type">Gen1_DC</span></a></span><span> </span><span id="local-6989586621683094846"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094846"><span class="hs-identifier hs-var">argVar</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683094847"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683094847"><span class="hs-identifier hs-var">var</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683094848"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094848"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#mkM1_E"><span class="hs-identifier hs-var">mkM1_E</span></a></span><span> </span><span class="annot"><span class="annottext">(LHsExpr GhcPs -&gt; LHsExpr GhcPs) -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-839"></span><span>                            </span><span class="annot"><span class="annottext">Type -&gt; LocatedA (HsExpr GhcPs)
</span><a href="#local-6989586621683094849"><span class="hs-identifier hs-var">converter</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094848"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
forall (id :: Pass).
IsPass id =&gt;
LHsExpr (GhcPass id)
-&gt; LHsExpr (GhcPass id) -&gt; LHsExpr (GhcPass id)
</span><a href="GHC.Hs.Utils.html#nlHsApp"><span class="hs-operator hs-var">`nlHsApp`</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="#local-6989586621683094847"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-840"></span><span>                         </span><span class="hs-comment">-- This M1 is meta-information for the selector</span><span>
</span><span id="line-841"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621683094849"><span class="annot"><span class="annottext">converter :: Type -&gt; LocatedA (HsExpr GhcPs)
</span><a href="#local-6989586621683094849"><span class="hs-identifier hs-var hs-var">converter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar
-&gt; ArgTyAlg (LocatedA (HsExpr GhcPs))
-&gt; Type
-&gt; LocatedA (HsExpr GhcPs)
forall a. TyVar -&gt; ArgTyAlg a -&gt; Type -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#argTyFold"><span class="hs-identifier hs-var">argTyFold</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621683094846"><span class="hs-identifier hs-var">argVar</span></a></span><span> </span><span class="annot"><span class="annottext">(ArgTyAlg (LocatedA (HsExpr GhcPs))
 -&gt; Type -&gt; LocatedA (HsExpr GhcPs))
-&gt; ArgTyAlg (LocatedA (HsExpr GhcPs))
-&gt; Type
-&gt; LocatedA (HsExpr GhcPs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#ArgTyAlg"><span class="hs-identifier hs-type">ArgTyAlg</span></a></span><span>
</span><span id="line-842"></span><span>          </span><span class="hs-special">{</span><span class="annot"><span class="annottext">ata_rec0 :: Type -&gt; LocatedA (HsExpr GhcPs)
</span><a href="GHC.Tc.Deriv.Generics.html#ata_rec0"><span class="hs-identifier hs-var">ata_rec0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LHsExpr GhcPs
RdrName -&gt; LocatedA (HsExpr GhcPs)
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">(RdrName -&gt; LocatedA (HsExpr GhcPs))
-&gt; (Type -&gt; RdrName) -&gt; Type -&gt; LocatedA (HsExpr GhcPs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; RdrName
</span><a href="GHC.Tc.Deriv.Generics.html#boxRepRDR"><span class="hs-identifier hs-var">boxRepRDR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-843"></span><span>           </span><span class="annot"><span class="annottext">ata_par1 :: LocatedA (HsExpr GhcPs)
</span><a href="GHC.Tc.Deriv.Generics.html#ata_par1"><span class="hs-identifier hs-var">ata_par1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="GHC.Builtin.Names.html#par1DataCon_RDR"><span class="hs-identifier hs-var">par1DataCon_RDR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-844"></span><span>           </span><span class="annot"><span class="annottext">ata_rec1 :: Type -&gt; LocatedA (HsExpr GhcPs)
</span><a href="GHC.Tc.Deriv.Generics.html#ata_rec1"><span class="hs-identifier hs-var">ata_rec1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocatedA (HsExpr GhcPs) -&gt; Type -&gt; LocatedA (HsExpr GhcPs)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(LocatedA (HsExpr GhcPs) -&gt; Type -&gt; LocatedA (HsExpr GhcPs))
-&gt; LocatedA (HsExpr GhcPs) -&gt; Type -&gt; LocatedA (HsExpr GhcPs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="GHC.Builtin.Names.html#rec1DataCon_RDR"><span class="hs-identifier hs-var">rec1DataCon_RDR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-845"></span><span>           </span><span class="annot"><span class="annottext">ata_comp :: Type -&gt; LocatedA (HsExpr GhcPs) -&gt; LocatedA (HsExpr GhcPs)
</span><a href="GHC.Tc.Deriv.Generics.html#ata_comp"><span class="hs-identifier hs-var">ata_comp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683094852"><span class="annot"><span class="annottext">LocatedA (HsExpr GhcPs)
</span><a href="#local-6989586621683094852"><span class="hs-identifier hs-var">cnv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="GHC.Builtin.Names.html#comp1DataCon_RDR"><span class="hs-identifier hs-var">comp1DataCon_RDR</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#nlHsCompose"><span class="hs-operator hs-var">`nlHsCompose`</span></a></span><span>
</span><span id="line-846"></span><span>                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="GHC.Builtin.Names.html#fmap_RDR"><span class="hs-identifier hs-var">fmap_RDR</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
forall (id :: Pass).
IsPass id =&gt;
LHsExpr (GhcPass id)
-&gt; LHsExpr (GhcPass id) -&gt; LHsExpr (GhcPass id)
</span><a href="GHC.Hs.Utils.html#nlHsApp"><span class="hs-operator hs-var">`nlHsApp`</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
LocatedA (HsExpr GhcPs)
</span><a href="#local-6989586621683094852"><span class="hs-identifier hs-var">cnv</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-847"></span><span>
</span><span id="line-848"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#boxRepRDR"><span class="hs-identifier hs-type">boxRepRDR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span>
</span><span id="line-849"></span><span id="boxRepRDR"><span class="annot"><span class="annottext">boxRepRDR :: Type -&gt; RdrName
</span><a href="GHC.Tc.Deriv.Generics.html#boxRepRDR"><span class="hs-identifier hs-var hs-var">boxRepRDR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RdrName
-&gt; ((RdrName, RdrName) -&gt; RdrName)
-&gt; Maybe (RdrName, RdrName)
-&gt; RdrName
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#k1DataCon_RDR"><span class="hs-identifier hs-var">k1DataCon_RDR</span></a></span><span> </span><span class="annot"><span class="annottext">(RdrName, RdrName) -&gt; RdrName
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (RdrName, RdrName) -&gt; RdrName)
-&gt; (Type -&gt; Maybe (RdrName, RdrName)) -&gt; Type -&gt; RdrName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (RdrName, RdrName)
</span><a href="GHC.Tc.Deriv.Generics.html#unboxedRepRDRs"><span class="hs-identifier hs-var">unboxedRepRDRs</span></a></span><span>
</span><span id="line-850"></span><span>
</span><span id="line-851"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#unboxRepRDR"><span class="hs-identifier hs-type">unboxRepRDR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span>
</span><span id="line-852"></span><span id="unboxRepRDR"><span class="annot"><span class="annottext">unboxRepRDR :: Type -&gt; RdrName
</span><a href="GHC.Tc.Deriv.Generics.html#unboxRepRDR"><span class="hs-identifier hs-var hs-var">unboxRepRDR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RdrName
-&gt; ((RdrName, RdrName) -&gt; RdrName)
-&gt; Maybe (RdrName, RdrName)
-&gt; RdrName
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#unK1_RDR"><span class="hs-identifier hs-var">unK1_RDR</span></a></span><span> </span><span class="annot"><span class="annottext">(RdrName, RdrName) -&gt; RdrName
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (RdrName, RdrName) -&gt; RdrName)
-&gt; (Type -&gt; Maybe (RdrName, RdrName)) -&gt; Type -&gt; RdrName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (RdrName, RdrName)
</span><a href="GHC.Tc.Deriv.Generics.html#unboxedRepRDRs"><span class="hs-identifier hs-var">unboxedRepRDRs</span></a></span><span>
</span><span id="line-853"></span><span>
</span><span id="line-854"></span><span class="hs-comment">-- Retrieve the RDRs associated with each URec data family instance</span><span>
</span><span id="line-855"></span><span class="hs-comment">-- constructor. See Note [Generics and unlifted types]</span><span>
</span><span id="line-856"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#unboxedRepRDRs"><span class="hs-identifier hs-type">unboxedRepRDRs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-857"></span><span id="unboxedRepRDRs"><span class="annot"><span class="annottext">unboxedRepRDRs :: Type -&gt; Maybe (RdrName, RdrName)
</span><a href="GHC.Tc.Deriv.Generics.html#unboxedRepRDRs"><span class="hs-identifier hs-var hs-var">unboxedRepRDRs</span></a></span></span><span> </span><span id="local-6989586621683094857"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094857"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-858"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094857"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#addrPrimTy"><span class="hs-identifier hs-var">addrPrimTy</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RdrName, RdrName) -&gt; Maybe (RdrName, RdrName)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#uAddrDataCon_RDR"><span class="hs-identifier hs-var">uAddrDataCon_RDR</span></a></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#uAddrHash_RDR"><span class="hs-identifier hs-var">uAddrHash_RDR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-859"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094857"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#charPrimTy"><span class="hs-identifier hs-var">charPrimTy</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RdrName, RdrName) -&gt; Maybe (RdrName, RdrName)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#uCharDataCon_RDR"><span class="hs-identifier hs-var">uCharDataCon_RDR</span></a></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#uCharHash_RDR"><span class="hs-identifier hs-var">uCharHash_RDR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-860"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094857"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#doublePrimTy"><span class="hs-identifier hs-var">doublePrimTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RdrName, RdrName) -&gt; Maybe (RdrName, RdrName)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#uDoubleDataCon_RDR"><span class="hs-identifier hs-var">uDoubleDataCon_RDR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#uDoubleHash_RDR"><span class="hs-identifier hs-var">uDoubleHash_RDR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-861"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094857"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#floatPrimTy"><span class="hs-identifier hs-var">floatPrimTy</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RdrName, RdrName) -&gt; Maybe (RdrName, RdrName)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#uFloatDataCon_RDR"><span class="hs-identifier hs-var">uFloatDataCon_RDR</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#uFloatHash_RDR"><span class="hs-identifier hs-var">uFloatHash_RDR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-862"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094857"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#intPrimTy"><span class="hs-identifier hs-var">intPrimTy</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RdrName, RdrName) -&gt; Maybe (RdrName, RdrName)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#uIntDataCon_RDR"><span class="hs-identifier hs-var">uIntDataCon_RDR</span></a></span><span class="hs-special">,</span><span>    </span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#uIntHash_RDR"><span class="hs-identifier hs-var">uIntHash_RDR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-863"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094857"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#wordPrimTy"><span class="hs-identifier hs-var">wordPrimTy</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RdrName, RdrName) -&gt; Maybe (RdrName, RdrName)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#uWordDataCon_RDR"><span class="hs-identifier hs-var">uWordDataCon_RDR</span></a></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#uWordHash_RDR"><span class="hs-identifier hs-var">uWordHash_RDR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-864"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (RdrName, RdrName)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-865"></span><span>
</span><span id="line-866"></span><span class="hs-comment">-- Build a product pattern</span><span>
</span><span id="line-867"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#mkProd_P"><span class="hs-identifier hs-type">mkProd_P</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#GenericKind"><span class="hs-identifier hs-type">GenericKind</span></a></span><span>       </span><span class="hs-comment">-- Gen0 or Gen1</span><span>
</span><span id="line-868"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- List of variables to match,</span><span>
</span><span id="line-869"></span><span>                              </span><span class="hs-comment">--   along with their types</span><span>
</span><span id="line-870"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Pat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>      </span><span class="hs-comment">-- Resulting product pattern</span><span>
</span><span id="line-871"></span><span id="mkProd_P"><span class="annot"><span class="annottext">mkProd_P :: GenericKind -&gt; [(RdrName, Type)] -&gt; LPat GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#mkProd_P"><span class="hs-identifier hs-var hs-var">mkProd_P</span></a></span></span><span> </span><span id="local-6989586621683094870"><span class="annot"><span class="annottext">GenericKind
</span><a href="#local-6989586621683094870"><span class="hs-identifier hs-var">gk</span></a></span></span><span> </span><span id="local-6989586621683094871"><span class="annot"><span class="annottext">[(RdrName, Type)]
</span><a href="#local-6989586621683094871"><span class="hs-identifier hs-var">varTys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcPs -&gt; LPat GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#mkM1_P"><span class="hs-identifier hs-var">mkM1_P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (Pat GhcPs)
 -&gt; GenLocated SrcSpanAnnA (Pat GhcPs)
 -&gt; GenLocated SrcSpanAnnA (Pat GhcPs))
-&gt; GenLocated SrcSpanAnnA (Pat GhcPs)
-&gt; [GenLocated SrcSpanAnnA (Pat GhcPs)]
-&gt; GenLocated SrcSpanAnnA (Pat GhcPs)
forall a. (a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#foldBal"><span class="hs-identifier hs-var">foldBal</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Pat GhcPs)
-&gt; GenLocated SrcSpanAnnA (Pat GhcPs)
-&gt; GenLocated SrcSpanAnnA (Pat GhcPs)
</span><a href="#local-6989586621683094872"><span class="hs-identifier hs-var">prod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName -&gt; LPat GhcPs
</span><a href="GHC.Hs.Utils.html#nlNullaryConPat"><span class="hs-identifier hs-var">nlNullaryConPat</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#u1DataCon_RDR"><span class="hs-identifier hs-var">u1DataCon_RDR</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (Pat GhcPs)]
</span><a href="#local-6989586621683094874"><span class="hs-identifier hs-var">appVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-872"></span><span>                     </span><span class="hs-comment">-- These M1s are meta-information for the constructor</span><span>
</span><span id="line-873"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-874"></span><span>    </span><span id="local-6989586621683094874"><span class="annot"><span class="annottext">appVars :: [GenLocated SrcSpanAnnA (Pat GhcPs)]
</span><a href="#local-6989586621683094874"><span class="hs-identifier hs-var hs-var">appVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RdrName -&gt; Type -&gt; GenLocated SrcSpanAnnA (Pat GhcPs))
-&gt; [(RdrName, Type)] -&gt; [GenLocated SrcSpanAnnA (Pat GhcPs)]
forall a b c. (a -&gt; b -&gt; c) -&gt; [(a, b)] -&gt; [c]
</span><a href="GHC.Utils.Misc.html#unzipWith"><span class="hs-identifier hs-var">unzipWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericKind -&gt; RdrName -&gt; Type -&gt; LPat GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#wrapArg_P"><span class="hs-identifier hs-var">wrapArg_P</span></a></span><span> </span><span class="annot"><span class="annottext">GenericKind
</span><a href="#local-6989586621683094870"><span class="hs-identifier hs-var">gk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(RdrName, Type)]
</span><a href="#local-6989586621683094871"><span class="hs-identifier hs-var">varTys</span></a></span><span>
</span><span id="line-875"></span><span>    </span><span id="local-6989586621683094872"><span class="annot"><span class="annottext">prod :: GenLocated SrcSpanAnnA (Pat GhcPs)
-&gt; GenLocated SrcSpanAnnA (Pat GhcPs) -&gt; LPat GhcPs
</span><a href="#local-6989586621683094872"><span class="hs-identifier hs-var hs-var">prod</span></a></span></span><span> </span><span id="local-6989586621683094878"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Pat GhcPs)
</span><a href="#local-6989586621683094878"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621683094879"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Pat GhcPs)
</span><a href="#local-6989586621683094879"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcPs -&gt; LPat GhcPs
forall (p :: Pass).
IsPass p =&gt;
LPat (GhcPass p) -&gt; LPat (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlParPat"><span class="hs-identifier hs-var">nlParPat</span></a></span><span> </span><span class="annot"><span class="annottext">(LPat GhcPs -&gt; LPat GhcPs) -&gt; LPat GhcPs -&gt; LPat GhcPs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#prodDataCon_RDR"><span class="hs-identifier hs-var">prodDataCon_RDR</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; [LPat GhcPs] -&gt; LPat GhcPs
</span><a href="GHC.Hs.Utils.html#nlConPat"><span class="hs-operator hs-var">`nlConPat`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LPat GhcPs
GenLocated SrcSpanAnnA (Pat GhcPs)
</span><a href="#local-6989586621683094878"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">LPat GhcPs
GenLocated SrcSpanAnnA (Pat GhcPs)
</span><a href="#local-6989586621683094879"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-876"></span><span>
</span><span id="line-877"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#wrapArg_P"><span class="hs-identifier hs-type">wrapArg_P</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#GenericKind"><span class="hs-identifier hs-type">GenericKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Pat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-878"></span><span id="wrapArg_P"><span class="annot"><span class="annottext">wrapArg_P :: GenericKind -&gt; RdrName -&gt; Type -&gt; LPat GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#wrapArg_P"><span class="hs-identifier hs-var hs-var">wrapArg_P</span></a></span></span><span> </span><span class="annot"><span class="annottext">GenericKind
</span><a href="GHC.Tc.Deriv.Generics.html#Gen0"><span class="hs-identifier hs-var">Gen0</span></a></span><span> </span><span id="local-6989586621683094880"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683094880"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621683094881"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094881"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcPs -&gt; LPat GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#mkM1_P"><span class="hs-identifier hs-var">mkM1_P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LPat GhcPs -&gt; LPat GhcPs
forall (p :: Pass).
IsPass p =&gt;
LPat (GhcPass p) -&gt; LPat (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlParPat"><span class="hs-identifier hs-var">nlParPat</span></a></span><span> </span><span class="annot"><span class="annottext">(LPat GhcPs -&gt; LPat GhcPs) -&gt; LPat GhcPs -&gt; LPat GhcPs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; RdrName
</span><a href="GHC.Tc.Deriv.Generics.html#boxRepRDR"><span class="hs-identifier hs-var">boxRepRDR</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683094881"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; [RdrName] -&gt; LPat GhcPs
</span><a href="GHC.Hs.Utils.html#nlConVarPat"><span class="hs-operator hs-var">`nlConVarPat`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683094880"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-879"></span><span>                   </span><span class="hs-comment">-- This M1 is meta-information for the selector</span><span>
</span><span id="line-880"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#wrapArg_P"><span class="hs-identifier hs-var">wrapArg_P</span></a></span><span> </span><span class="annot"><span class="annottext">GenericKind
</span><a href="GHC.Tc.Deriv.Generics.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a></span><span> </span><span id="local-6989586621683094882"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683094882"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcPs -&gt; LPat GhcPs
forall (p :: Pass).
IsPass p =&gt;
LPat (GhcPass p) -&gt; LPat (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlParPat"><span class="hs-identifier hs-var">nlParPat</span></a></span><span> </span><span class="annot"><span class="annottext">(LPat GhcPs -&gt; LPat GhcPs) -&gt; LPat GhcPs -&gt; LPat GhcPs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#m1DataCon_RDR"><span class="hs-identifier hs-var">m1DataCon_RDR</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; [RdrName] -&gt; LPat GhcPs
</span><a href="GHC.Hs.Utils.html#nlConVarPat"><span class="hs-operator hs-var">`nlConVarPat`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683094882"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-881"></span><span>
</span><span id="line-882"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#mkGenericLocal"><span class="hs-identifier hs-type">mkGenericLocal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#US"><span class="hs-identifier hs-type">US</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span>
</span><span id="line-883"></span><span id="mkGenericLocal"><span class="annot"><span class="annottext">mkGenericLocal :: US -&gt; RdrName
</span><a href="GHC.Tc.Deriv.Generics.html#mkGenericLocal"><span class="hs-identifier hs-var hs-var">mkGenericLocal</span></a></span></span><span> </span><span id="local-6989586621683094884"><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094884"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; RdrName
</span><a href="GHC.Types.Name.Reader.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;g&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">US -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094884"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-884"></span><span>
</span><span id="line-885"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#x_RDR"><span class="hs-identifier hs-type">x_RDR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span>
</span><span id="line-886"></span><span id="x_RDR"><span class="annot"><span class="annottext">x_RDR :: RdrName
</span><a href="GHC.Tc.Deriv.Generics.html#x_RDR"><span class="hs-identifier hs-var hs-var">x_RDR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; RdrName
</span><a href="GHC.Types.Name.Reader.html#mkVarUnqual"><span class="hs-identifier hs-var">mkVarUnqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;x&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-887"></span><span>
</span><span id="line-888"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#x_Expr"><span class="hs-identifier hs-type">x_Expr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-889"></span><span id="x_Expr"><span class="annot"><span class="annottext">x_Expr :: LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#x_Expr"><span class="hs-identifier hs-var hs-var">x_Expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="GHC.Tc.Deriv.Generics.html#x_RDR"><span class="hs-identifier hs-var">x_RDR</span></a></span><span>
</span><span id="line-890"></span><span>
</span><span id="line-891"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#x_Pat"><span class="hs-identifier hs-type">x_Pat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Pat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-892"></span><span id="x_Pat"><span class="annot"><span class="annottext">x_Pat :: LPat GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#x_Pat"><span class="hs-identifier hs-var hs-var">x_Pat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LPat GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LPat (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="GHC.Tc.Deriv.Generics.html#x_RDR"><span class="hs-identifier hs-var">x_RDR</span></a></span><span>
</span><span id="line-893"></span><span>
</span><span id="line-894"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#mkM1_E"><span class="hs-identifier hs-type">mkM1_E</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-895"></span><span id="mkM1_E"><span class="annot"><span class="annottext">mkM1_E :: LHsExpr GhcPs -&gt; LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#mkM1_E"><span class="hs-identifier hs-var hs-var">mkM1_E</span></a></span></span><span> </span><span id="local-6989586621683094891"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621683094891"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="GHC.Builtin.Names.html#m1DataCon_RDR"><span class="hs-identifier hs-var">m1DataCon_RDR</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
forall (id :: Pass).
IsPass id =&gt;
LHsExpr (GhcPass id)
-&gt; LHsExpr (GhcPass id) -&gt; LHsExpr (GhcPass id)
</span><a href="GHC.Hs.Utils.html#nlHsApp"><span class="hs-operator hs-var">`nlHsApp`</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621683094891"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-896"></span><span>
</span><span id="line-897"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#mkM1_P"><span class="hs-identifier hs-type">mkM1_P</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Pat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Pat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-898"></span><span id="mkM1_P"><span class="annot"><span class="annottext">mkM1_P :: LPat GhcPs -&gt; LPat GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#mkM1_P"><span class="hs-identifier hs-var hs-var">mkM1_P</span></a></span></span><span> </span><span id="local-6989586621683094892"><span class="annot"><span class="annottext">LPat GhcPs
</span><a href="#local-6989586621683094892"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcPs -&gt; LPat GhcPs
forall (p :: Pass).
IsPass p =&gt;
LPat (GhcPass p) -&gt; LPat (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlParPat"><span class="hs-identifier hs-var">nlParPat</span></a></span><span> </span><span class="annot"><span class="annottext">(LPat GhcPs -&gt; LPat GhcPs) -&gt; LPat GhcPs -&gt; LPat GhcPs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#m1DataCon_RDR"><span class="hs-identifier hs-var">m1DataCon_RDR</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; [LPat GhcPs] -&gt; LPat GhcPs
</span><a href="GHC.Hs.Utils.html#nlConPat"><span class="hs-operator hs-var">`nlConPat`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LPat GhcPs
</span><a href="#local-6989586621683094892"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-899"></span><span>
</span><span id="line-900"></span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#nlHsCompose"><span class="hs-identifier hs-type">nlHsCompose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-901"></span><span id="nlHsCompose"><span class="annot"><span class="annottext">nlHsCompose :: LHsExpr GhcPs -&gt; LHsExpr GhcPs -&gt; LHsExpr GhcPs
</span><a href="GHC.Tc.Deriv.Generics.html#nlHsCompose"><span class="hs-identifier hs-var hs-var">nlHsCompose</span></a></span></span><span> </span><span id="local-6989586621683094893"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621683094893"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621683094894"><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621683094894"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="GHC.Builtin.Names.html#compose_RDR"><span class="hs-identifier hs-var">compose_RDR</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; [LHsExpr GhcPs] -&gt; LHsExpr GhcPs
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; [LHsExpr (GhcPass p)] -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsApps"><span class="hs-operator hs-var">`nlHsApps`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621683094893"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcPs
</span><a href="#local-6989586621683094894"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-902"></span><span>
</span><span id="line-903"></span><span class="annot"><span class="hs-comment">-- | Variant of foldr for producing balanced lists</span></span><span>
</span><span id="line-904"></span><span id="local-6989586621683093881"><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#foldBal"><span class="hs-identifier hs-type">foldBal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683093881"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683093881"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683093881"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683093881"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683093881"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683093881"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-905"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Tc.Deriv.Generics.html#foldBal"><span class="hs-pragma hs-type">foldBal</span></a></span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-comment">-- inlined to produce specialised code for each op</span><span>
</span><span id="line-906"></span><span id="foldBal"><span class="annot"><span class="annottext">foldBal :: forall a. (a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
</span><a href="GHC.Tc.Deriv.Generics.html#foldBal"><span class="hs-identifier hs-var hs-var">foldBal</span></a></span></span><span> </span><span id="local-6989586621683094897"><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621683094897"><span class="hs-identifier hs-var">op0</span></a></span></span><span> </span><span id="local-6989586621683094898"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621683094898"><span class="hs-identifier hs-var">x0</span></a></span></span><span> </span><span id="local-6989586621683094899"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621683094899"><span class="hs-identifier hs-var">xs0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; a -&gt; US -&gt; [a] -&gt; a
forall {t}. (t -&gt; t -&gt; t) -&gt; t -&gt; US -&gt; [t] -&gt; t
</span><a href="#local-6989586621683094900"><span class="hs-identifier hs-var">fold_bal</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621683094897"><span class="hs-identifier hs-var">op0</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621683094898"><span class="hs-identifier hs-var">x0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; US
forall a. [a] -&gt; US
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; US
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621683094899"><span class="hs-identifier hs-var">xs0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621683094899"><span class="hs-identifier hs-var">xs0</span></a></span><span>
</span><span id="line-907"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-908"></span><span>    </span><span id="local-6989586621683094900"><span class="annot"><span class="annottext">fold_bal :: (t -&gt; t -&gt; t) -&gt; t -&gt; US -&gt; [t] -&gt; t
</span><a href="#local-6989586621683094900"><span class="hs-identifier hs-var hs-var">fold_bal</span></a></span></span><span> </span><span id="local-6989586621683094904"><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><a href="#local-6989586621683094904"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621683094905"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621683094905"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621683094906"><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094906"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621683094907"><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621683094907"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621683094907"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-909"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621683094905"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-910"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621683094908"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621683094908"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621683094908"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-911"></span><span>      </span><span class="annot"><span class="annottext">[t]
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621683094909"><span class="annot"><span class="annottext">nl :: US
</span><a href="#local-6989586621683094909"><span class="hs-identifier hs-var hs-var">nl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094906"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; US
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">US
</span><span class="hs-number">2</span></span><span>
</span><span id="line-912"></span><span>                 </span><span class="hs-glyph">!</span><span id="local-6989586621683094910"><span class="annot"><span class="annottext">nr :: US
</span><a href="#local-6989586621683094910"><span class="hs-identifier hs-var hs-var">nr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094906"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">US -&gt; US -&gt; US
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094909"><span class="hs-identifier hs-var">nl</span></a></span><span>
</span><span id="line-913"></span><span>                 </span><span class="hs-special">(</span><span id="local-6989586621683094911"><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621683094911"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621683094912"><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621683094912"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">US -&gt; [t] -&gt; ([t], [t])
forall a. US -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094909"><span class="hs-identifier hs-var">nl</span></a></span><span> </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621683094907"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-914"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(t -&gt; t -&gt; t) -&gt; t -&gt; US -&gt; [t] -&gt; t
</span><a href="#local-6989586621683094900"><span class="hs-identifier hs-var">fold_bal</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><a href="#local-6989586621683094904"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621683094905"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094909"><span class="hs-identifier hs-var">nl</span></a></span><span> </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621683094911"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-915"></span><span>                </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><a href="#local-6989586621683094904"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">(t -&gt; t -&gt; t) -&gt; t -&gt; US -&gt; [t] -&gt; t
</span><a href="#local-6989586621683094900"><span class="hs-identifier hs-var">fold_bal</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><a href="#local-6989586621683094904"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621683094905"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">US
</span><a href="#local-6989586621683094910"><span class="hs-identifier hs-var">nr</span></a></span><span> </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621683094912"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-916"></span><span>
</span><span id="line-917"></span><span class="hs-comment">{-
Note [Generics and unlifted types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Normally, all constants are marked with K1/Rec0. The exception to this rule is
when a data constructor has an unlifted argument (e.g., Int#, Char#, etc.). In
that case, we must use a data family instance of URec (from GHC.Generics) to
mark it. As a result, before we can generate K1 or unK1, we must first check
to see if the type is actually one of the unlifted types for which URec has a
data family instance; if so, we generate that instead.

See wiki:commentary/compiler/generic-deriving#handling-unlifted-types for more
details on why URec is implemented the way it is.

Note [Generating a correctly typed Rep instance]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tc_mkRepTy derives the RHS of the Rep(1) type family instance when deriving
Generic(1). For example, given the following data declaration:

    data Foo a = MkFoo a
      deriving stock Generic

tc_mkRepTy would generate the `Rec0 a` portion of this instance:

    instance Generic (Foo a) where
      type Rep (Foo a) = Rec0 a
      ...

(The full `Rep` instance is more complicated than this, but we have simplified
it for presentation purposes.)

`tc_mkRepTy` figures out the field types to use in the RHS by inspecting a
DerivInstTys, which contains the instantiated field types for each data
constructor. (See Note [Instantiating field types in stock deriving] for a
description of how this works.) As a result, `tc_mkRepTy` &quot;just works&quot; even
when dealing with StandaloneDeriving, such as in this example:

    deriving stock instance Generic (Foo Int)
      ===&gt;
    instance Generic (Foo Int) where
      type Rep (Foo Int) = Rec0 Int -- The `a` has been instantiated here

A wrinkle in all of this: what happens when deriving a Generic1 instance where
the last type variable appears in a type synonym that discards it? That is,
what should happen in this example (taken from #15012)?

    type FakeOut a = Int
    data T a = MkT (FakeOut a)
      deriving Generic1

MkT is a particularly wily data constructor. Although the last type variable
`a` technically appears in `FakeOut a`, it's just a smokescreen, as `FakeOut a`
simply expands to `Int`. As a result, `MkT` doesn't really *use* the last type
variable. Therefore, T's `Rep` instance would use Rec0 to represent MkT's
field. But we must be careful not to produce code like this:

   instance Generic1 T where
     type Rep1 T = Rec0 (FakeOut a)
     ...

Oh no! Now we have `a` on the RHS, but it's completely unbound. This can cause
issues like what was observed in #15012. To avoid this, we ensure that `a` is
instantiated to Any:

   instance Generic1 T where
     type Rep1 T = Rec0 (FakeOut Any)
     ...

And now all is good.

Alternatively, we could have avoided this problem by expanding all type
synonyms on the RHSes of Rep1 instances. But we might blow up the size of
these types even further by doing this, so we choose not to do so.

Note [Handling kinds in a Rep instance]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Because Generic1 is poly-kinded, the representation types were generalized to
be kind-polymorphic as well. As a result, tc_mkRepTy must explicitly apply
the kind of the instance being derived to all the representation type
constructors. For instance, if you have

    data Empty (a :: k) = Empty deriving Generic1

Then the generated code is now approximately (with -fprint-explicit-kinds
syntax):

    instance Generic1 k (Empty k) where
      type Rep1 k (Empty k) = U1 k

Most representation types have only one kind variable, making them easy to deal
with. The only non-trivial case is (:.:), which is only used in Generic1
instances:

    newtype (:.:) (f :: k2 -&gt; *) (g :: k1 -&gt; k2) (p :: k1) =
        Comp1 { unComp1 :: f (g p) }

Here, we do something a bit counter-intuitive: we make k1 be the kind of the
instance being derived, and we always make k2 be *. Why *? It's because
the code that GHC generates using (:.:) is always of the form x :.: Rec1 y
for some types x and y. In other words, the second type to which (:.:) is
applied always has kind k -&gt; *, for some kind k, so k2 cannot possibly be
anything other than * in a generated Generic1 instance.

Note [Generics compilation speed tricks]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Deriving Generic(1) is known to have a large constant factor during
compilation, which contributes to noticeable compilation slowdowns when
deriving Generic(1) for large datatypes (see #5642).

To ease the pain, there is a trick one can play when generating definitions for
to(1) and from(1). If you have a datatype like:

  data Letter = A | B | C | D

then a na&#239;ve Generic instance for Letter would be:

  instance Generic Letter where
    type Rep Letter = D1 ('MetaData ...) ...

    to (M1 (L1 (L1 (M1 U1)))) = A
    to (M1 (L1 (R1 (M1 U1)))) = B
    to (M1 (R1 (L1 (M1 U1)))) = C
    to (M1 (R1 (R1 (M1 U1)))) = D

    from A = M1 (L1 (L1 (M1 U1)))
    from B = M1 (L1 (R1 (M1 U1)))
    from C = M1 (R1 (L1 (M1 U1)))
    from D = M1 (R1 (R1 (M1 U1)))

Notice that in every LHS pattern-match of the 'to' definition, and in every RHS
expression in the 'from' definition, the topmost constructor is M1. This
corresponds to the datatype-specific metadata (the D1 in the Rep Letter
instance). But this is wasteful from a typechecking perspective, since this
definition requires GHC to typecheck an application of M1 in every single case,
leading to an O(n) increase in the number of coercions the typechecker has to
solve, which in turn increases allocations and degrades compilation speed.

Luckily, since the topmost M1 has the exact same type across every case, we can
factor it out reduce the typechecker's burden:

  instance Generic Letter where
    type Rep Letter = D1 ('MetaData ...) ...

    to (M1 x) = case x of
      L1 (L1 (M1 U1)) -&gt; A
      L1 (R1 (M1 U1)) -&gt; B
      R1 (L1 (M1 U1)) -&gt; C
      R1 (R1 (M1 U1)) -&gt; D

    from x = M1 (case x of
      A -&gt; L1 (L1 (M1 U1))
      B -&gt; L1 (R1 (M1 U1))
      C -&gt; R1 (L1 (M1 U1))
      D -&gt; R1 (R1 (M1 U1)))

A simple change, but one that pays off, since it goes turns an O(n) amount of
coercions to an O(1) amount.

Note [Generics performance tricks]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Generics-based algorithms tend to rely on GHC optimizing away the intermediate
representation for optimal performance. However, the default unfolding threshold
is usually too small for GHC to do that.

The recommended approach thus far was to increase unfolding threshold, but this
makes GHC inline more aggressively in general, whereas it should only be more
aggressive with generics-based code.

The solution is to use a heuristic that'll annotate Generic class methods with
INLINE[1] pragmas (the explicit phase is used to give users phase control as
they can annotate their functions with INLINE[2] or INLINE[0] if appropriate).

The current heuristic was chosen by looking at how annotating Generic methods
INLINE[1] helps with optimal code generation for several types of generic
algorithms:

* Round trip through the generic representation.

* Generation of NFData instances.

* Generation of field lenses.

The experimentation was done by picking data types having N constructors with M
fields each and using their derived Generic instances to generate code with the
above algorithms.

The results are threshold values for N and M (contained in
`mkBindsRep.inlining_useful`) for which inlining is beneficial, i.e. it usually
leads to performance improvements at both compile time (the simplifier has to do
more work, but then there's much less code left for subsequent phases to work
with) and run time (the generic representation of a data type is optimized
away).

The T11068 test case, which includes the algorithms mentioned above, tests that
the generic representations of several data types optimize away using the
threshold values in `mkBindsRep.inlining_useful`.

If one uses threshold values higher what is found in
`mkBindsRep.inlining_useful`, then annotating Generic class methods with INLINE
pragmas tends to be at best useless and at worst lead to code size blowup
without runtime performance improvements.
-}</span><span>
</span><span id="line-1118"></span></pre></body></html>