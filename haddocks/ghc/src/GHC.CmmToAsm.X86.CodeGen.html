<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DuplicateRecordFields #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ParallelListComp #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE NondecreasingIndentation #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-uni-patterns #-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Generating machine code (instruction selection)</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- (c) The University of Glasgow 1996-2004</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-comment">-- This is a big module, but, if you pay attention to</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- (a) the sectioning, and (b) the type signatures, the</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- structure should not be too overwhelming.</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html"><span class="hs-identifier">GHC.CmmToAsm.X86.CodeGen</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#cmmTopCodeGen"><span class="hs-identifier">cmmTopCodeGen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#generateJumpTableForInstr"><span class="hs-identifier">generateJumpTableForInstr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#extractUnwindPoints"><span class="hs-identifier">extractUnwindPoints</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#invertCondBranches"><span class="hs-identifier">invertCondBranches</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier">InstrBlock</span></a></span><span>
</span><span id="line-29"></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">where</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- NCG stuff:</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html"><span class="hs-identifier">GHC.CmmToAsm.X86.Instr</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html"><span class="hs-identifier">GHC.CmmToAsm.X86.Cond</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html"><span class="hs-identifier">GHC.CmmToAsm.X86.Regs</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Ppr.html"><span class="hs-identifier">GHC.CmmToAsm.X86.Ppr</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.RegInfo.html"><span class="hs-identifier">GHC.CmmToAsm.X86.RegInfo</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.Regs.html"><span class="hs-identifier">GHC.Platform.Regs</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.CPrim.html"><span class="hs-identifier">GHC.CmmToAsm.CPrim</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Types.html"><span class="hs-identifier">GHC.CmmToAsm.Types</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html"><span class="hs-identifier">GHC.Cmm.DebugBlock</span></a></span><span>
</span><span id="line-46"></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#DebugBlock"><span class="hs-identifier">DebugBlock</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#UnwindPoint"><span class="hs-identifier">UnwindPoint</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#UnwindTable"><span class="hs-identifier">UnwindTable</span></a></span><span>
</span><span id="line-47"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#UnwindExpr"><span class="hs-identifier">UnwindExpr</span></a></span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#UwReg"><span class="hs-identifier">UwReg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#toUnwindExpr"><span class="hs-identifier">toUnwindExpr</span></a></span><span>
</span><span id="line-48"></span><span>   </span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html"><span class="hs-identifier">GHC.CmmToAsm.PIC</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html"><span class="hs-identifier">GHC.CmmToAsm.Monad</span></a></span><span>
</span><span id="line-51"></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier">NatM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier">getNewRegNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewLabelNat"><span class="hs-identifier">getNewLabelNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier">setDeltaNat</span></a></span><span>
</span><span id="line-52"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier">getDeltaNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getBlockIdNat"><span class="hs-identifier">getBlockIdNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPicBaseNat"><span class="hs-identifier">getPicBaseNat</span></a></span><span>
</span><span id="line-53"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier">Reg64</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier">RegCode64</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier">getNewReg64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier">localReg64</span></a></span><span>
</span><span id="line-54"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPicBaseMaybeNat"><span class="hs-identifier">getPicBaseMaybeNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDebugBlock"><span class="hs-identifier">getDebugBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getFileId"><span class="hs-identifier">getFileId</span></a></span><span>
</span><span id="line-55"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#addImmediateSuccessorNat"><span class="hs-identifier">addImmediateSuccessorNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#updateCfgNat"><span class="hs-identifier">updateCfgNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier">getConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier">getPlatform</span></a></span><span>
</span><span id="line-56"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getCfgWeights"><span class="hs-identifier">getCfgWeights</span></a></span><span>
</span><span id="line-57"></span><span>   </span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.CFG.html"><span class="hs-identifier">GHC.CmmToAsm.CFG</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html"><span class="hs-identifier">GHC.CmmToAsm.Format</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html"><span class="hs-identifier">GHC.CmmToAsm.Config</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html"><span class="hs-identifier">GHC.Platform.Reg</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.html"><span class="hs-identifier">GHC.Platform</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- Our intermediate code:</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html"><span class="hs-identifier">GHC.Cmm.BlockId</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html"><span class="hs-identifier">GHC.Unit.Types</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#primUnitId"><span class="hs-identifier">primUnitId</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Utils.html"><span class="hs-identifier">GHC.Cmm.Utils</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Switch.html"><span class="hs-identifier">GHC.Cmm.Switch</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.html"><span class="hs-identifier">GHC.Cmm</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html"><span class="hs-identifier">GHC.Cmm.Dataflow.Block</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Graph.html"><span class="hs-identifier">GHC.Cmm.Dataflow.Graph</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html"><span class="hs-identifier">GHC.Cmm.Dataflow.Label</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html"><span class="hs-identifier">GHC.Cmm.CLabel</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Tickish.html"><span class="hs-identifier">GHC.Types.Tickish</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Tickish.html#GenTickish"><span class="hs-identifier">GenTickish</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#srcSpanFile"><span class="hs-identifier">srcSpanFile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#srcSpanStartLine"><span class="hs-identifier">srcSpanStartLine</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#srcSpanStartCol"><span class="hs-identifier">srcSpanStartCol</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- The rest:</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html"><span class="hs-identifier">GHC.Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html#expectJust"><span class="hs-identifier">expectJust</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.ForeignCall.html"><span class="hs-identifier">GHC.Types.ForeignCall</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.ForeignCall.html#CCallConv"><span class="hs-identifier">CCallConv</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html"><span class="hs-identifier">GHC.Data.OrdList</span></a></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Constants.html"><span class="hs-identifier">GHC.Utils.Constants</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Constants.html#debugIsOn"><span class="hs-identifier">debugIsOn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Monad.html"><span class="hs-identifier">GHC.Utils.Monad</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Utils.Monad.html#foldMapM"><span class="hs-identifier">foldMapM</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSM.html"><span class="hs-identifier">GHC.Types.Unique.DSM</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSM.html#getUniqueM"><span class="hs-identifier">getUniqueM</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Semigroup.html"><span class="hs-identifier">Data.Semigroup</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#StateT"><span class="hs-identifier">StateT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#evalStateT"><span class="hs-identifier">evalStateT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#get"><span class="hs-identifier">get</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#put"><span class="hs-identifier">put</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.Class.html"><span class="hs-identifier">Control.Monad.Trans.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier">lift</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Foldable.html"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fold</span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Int.html"><span class="hs-identifier">Data.Int</span></a></span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-type">is32BitPlatform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-104"></span><span id="is32BitPlatform"><span class="annot"><span class="annottext">is32BitPlatform :: NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var hs-var">is32BitPlatform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-105"></span><span>    </span><span id="local-6989586621682854989"><span class="annot"><a href="#local-6989586621682854989"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Platform.html#target32Bit"><span class="hs-identifier hs-type">target32Bit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682854989"><span class="hs-identifier hs-type">platform</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#sse4_1Enabled"><span class="hs-identifier hs-type">sse4_1Enabled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-109"></span><span id="sse4_1Enabled"><span class="annot"><span class="annottext">sse4_1Enabled :: NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#sse4_1Enabled"><span class="hs-identifier hs-var hs-var">sse4_1Enabled</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621682854992"><span class="annot"><a href="#local-6989586621682854992"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgSseVersion"><span class="hs-identifier hs-var">ncgSseVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682854992"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="GHC.Platform.html#SSE4"><span class="hs-identifier hs-type">SSE4</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#sse4_2Enabled"><span class="hs-identifier hs-type">sse4_2Enabled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-114"></span><span id="sse4_2Enabled"><span class="annot"><span class="annottext">sse4_2Enabled :: NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#sse4_2Enabled"><span class="hs-identifier hs-var hs-var">sse4_2Enabled</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-115"></span><span>  </span><span id="local-6989586621682854996"><span class="annot"><a href="#local-6989586621682854996"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgSseVersion"><span class="hs-identifier hs-var">ncgSseVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682854996"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="GHC.Platform.html#SSE42"><span class="hs-identifier hs-type">SSE42</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#avxEnabled"><span class="hs-identifier hs-type">avxEnabled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-119"></span><span id="avxEnabled"><span class="annot"><span class="annottext">avxEnabled :: NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#avxEnabled"><span class="hs-identifier hs-var hs-var">avxEnabled</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-120"></span><span>  </span><span id="local-6989586621682854999"><span class="annot"><a href="#local-6989586621682854999"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgAvxEnabled"><span class="hs-identifier hs-var">ncgAvxEnabled</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682854999"><span class="hs-identifier hs-type">config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#cmmTopCodeGen"><span class="hs-identifier hs-type">cmmTopCodeGen</span></a></span><span>
</span><span id="line-124"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmDecl"><span class="hs-identifier hs-type">RawCmmDecl</span></a></span><span>
</span><span id="line-125"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatCmmDecl"><span class="hs-identifier hs-type">NatCmmDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmStatics"><span class="hs-identifier hs-type">RawCmmStatics</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span id="cmmTopCodeGen"><span class="annot"><span class="annottext">cmmTopCodeGen :: RawCmmDecl -&gt; NatM [NatCmmDecl (Alignment, RawCmmStatics) Instr]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#cmmTopCodeGen"><span class="hs-identifier hs-var hs-var">cmmTopCodeGen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#CmmProc"><span class="hs-identifier hs-type">CmmProc</span></a></span><span> </span><span id="local-6989586621682855002"><span class="annot"><span class="annottext">LabelMap RawCmmStatics
</span><a href="#local-6989586621682855002"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621682855003"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682855003"><span class="hs-identifier hs-var">lab</span></a></span></span><span> </span><span id="local-6989586621682855004"><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682855004"><span class="hs-identifier hs-var">live</span></a></span></span><span> </span><span id="local-6989586621682855005"><span class="annot"><span class="annottext">CmmGraph
</span><a href="#local-6989586621682855005"><span class="hs-identifier hs-var">graph</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682855006"><span class="annot"><span class="annottext">blocks :: [CmmBlock]
</span><a href="#local-6989586621682855006"><span class="hs-identifier hs-var hs-var hs-var">blocks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmGraph -&gt; [CmmBlock]
</span><a href="GHC.Cmm.Utils.html#toBlockListEntryFirst"><span class="hs-identifier hs-var">toBlockListEntryFirst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmGraph
</span><a href="#local-6989586621682855005"><span class="hs-identifier hs-var">graph</span></a></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682855008"><span class="annot"><a href="#local-6989586621682855008"><span class="hs-identifier hs-var">nat_blocks</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855009"><span class="annot"><a href="#local-6989586621682855009"><span class="hs-identifier hs-var">statics</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CmmBlock
 -&gt; NatM
      ([NatBasicBlock Instr],
       [NatCmmDecl (Alignment, RawCmmStatics) Instr]))
-&gt; [CmmBlock]
-&gt; NatM
     ([[NatBasicBlock Instr]],
      [[NatCmmDecl (Alignment, RawCmmStatics) Instr]])
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; m (b, c)) -&gt; [a] -&gt; m ([b], [c])
</span><span class="hs-identifier hs-var">mapAndUnzipM</span></span><span> </span><span class="annot"><span class="annottext">CmmBlock
-&gt; NatM
     ([NatBasicBlock Instr],
      [NatCmmDecl (Alignment, RawCmmStatics) Instr])
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#basicBlockCodeGen"><span class="hs-identifier hs-var">basicBlockCodeGen</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmBlock]
</span><a href="#local-6989586621682855006"><span class="hs-identifier hs-var">blocks</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621682855012"><span class="annot"><a href="#local-6989586621682855012"><span class="hs-identifier hs-var">picBaseMb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPicBaseMaybeNat"><span class="hs-identifier hs-type">getPicBaseMaybeNat</span></a></span><span>
</span><span id="line-131"></span><span>  </span><span id="local-6989586621682855013"><span class="annot"><a href="#local-6989586621682855013"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682855014"><span class="annot"><a href="#local-6989586621682855014"><span class="hs-identifier hs-var hs-var">proc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LabelMap RawCmmStatics
-&gt; CLabel
-&gt; [GlobalRegUse]
-&gt; ListGraph Instr
-&gt; NatCmmDecl (Alignment, RawCmmStatics) Instr
forall d h g.
h -&gt; CLabel -&gt; [GlobalRegUse] -&gt; g -&gt; GenCmmDecl d h g
</span><a href="GHC.Cmm.html#CmmProc"><span class="hs-identifier hs-var">CmmProc</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMap RawCmmStatics
</span><a href="#local-6989586621682855002"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682855003"><span class="hs-identifier hs-var">lab</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682855004"><span class="hs-identifier hs-var">live</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[NatBasicBlock Instr] -&gt; ListGraph Instr
forall i. [GenBasicBlock i] -&gt; ListGraph i
</span><a href="GHC.Cmm.html#ListGraph"><span class="hs-identifier hs-var">ListGraph</span></a></span><span> </span><span class="annot"><span class="annottext">([NatBasicBlock Instr] -&gt; ListGraph Instr)
-&gt; [NatBasicBlock Instr] -&gt; ListGraph Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[NatBasicBlock Instr]] -&gt; [NatBasicBlock Instr]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[NatBasicBlock Instr]]
</span><a href="#local-6989586621682855008"><span class="hs-identifier hs-var">nat_blocks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>      </span><span id="local-6989586621682855017"><span class="annot"><a href="#local-6989586621682855017"><span class="hs-identifier hs-var hs-var">tops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NatCmmDecl (Alignment, RawCmmStatics) Instr
</span><a href="#local-6989586621682855014"><span class="hs-identifier hs-var">proc</span></a></span><span> </span><span class="annot"><span class="annottext">NatCmmDecl (Alignment, RawCmmStatics) Instr
-&gt; [NatCmmDecl (Alignment, RawCmmStatics) Instr]
-&gt; [NatCmmDecl (Alignment, RawCmmStatics) Instr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[[NatCmmDecl (Alignment, RawCmmStatics) Instr]]
-&gt; [NatCmmDecl (Alignment, RawCmmStatics) Instr]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[NatCmmDecl (Alignment, RawCmmStatics) Instr]]
</span><a href="#local-6989586621682855009"><span class="hs-identifier hs-var">statics</span></a></span><span>
</span><span id="line-134"></span><span>      </span><span id="local-6989586621682855018"><span class="annot"><a href="#local-6989586621682855018"><span class="hs-identifier hs-var hs-var">os</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682855013"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682855012"><span class="hs-identifier hs-type">picBaseMb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682855020"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855020"><span class="hs-identifier hs-var">picBase</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OS
-&gt; Reg
-&gt; [NatCmmDecl (Alignment, RawCmmStatics) Instr]
-&gt; NatM [NatCmmDecl (Alignment, RawCmmStatics) Instr]
</span><a href="GHC.CmmToAsm.PIC.html#initializePicBase_x86"><span class="hs-identifier hs-var">initializePicBase_x86</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="#local-6989586621682855018"><span class="hs-identifier hs-var">os</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855020"><span class="hs-identifier hs-var">picBase</span></a></span><span> </span><span class="annot"><span class="annottext">[NatCmmDecl (Alignment, RawCmmStatics) Instr]
</span><a href="#local-6989586621682855017"><span class="hs-identifier hs-var">tops</span></a></span><span>
</span><span id="line-138"></span><span>      </span><span class="annot"><span class="annottext">Maybe Reg
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[NatCmmDecl (Alignment, RawCmmStatics) Instr]
-&gt; NatM [NatCmmDecl (Alignment, RawCmmStatics) Instr]
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[NatCmmDecl (Alignment, RawCmmStatics) Instr]
</span><a href="#local-6989586621682855017"><span class="hs-identifier hs-var">tops</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#cmmTopCodeGen"><span class="hs-identifier hs-var">cmmTopCodeGen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#CmmData"><span class="hs-identifier hs-type">CmmData</span></a></span><span> </span><span id="local-6989586621682855023"><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682855023"><span class="hs-identifier hs-var">sec</span></a></span></span><span> </span><span id="local-6989586621682855024"><span class="annot"><span class="annottext">RawCmmStatics
</span><a href="#local-6989586621682855024"><span class="hs-identifier hs-var">dat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><span class="annottext">[NatCmmDecl (Alignment, RawCmmStatics) Instr]
-&gt; NatM [NatCmmDecl (Alignment, RawCmmStatics) Instr]
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Section
-&gt; (Alignment, RawCmmStatics)
-&gt; NatCmmDecl (Alignment, RawCmmStatics) Instr
forall d h g. Section -&gt; d -&gt; GenCmmDecl d h g
</span><a href="GHC.Cmm.html#CmmData"><span class="hs-identifier hs-var">CmmData</span></a></span><span> </span><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682855023"><span class="hs-identifier hs-var">sec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Alignment
</span><a href="GHC.Types.Basic.html#mkAlignment"><span class="hs-identifier hs-var">mkAlignment</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RawCmmStatics
</span><a href="#local-6989586621682855024"><span class="hs-identifier hs-var">dat</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- no translation, we just use CmmStatic</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">{- Note [Verifying basic blocks]
   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   We want to guarantee a few things about the results
   of instruction selection.

   Namely that each basic blocks consists of:
    * A (potentially empty) sequence of straight line instructions
  followed by
    * A (potentially empty) sequence of jump like instructions.

    We can verify this by going through the instructions and
    making sure that any non-jumpish instruction can't appear
    after a jumpish instruction.

    There are gotchas however:
    * CALLs are strictly speaking control flow but here we care
      not about them. Hence we treat them as regular instructions.

      It's safe for them to appear inside a basic block
      as (ignoring side effects inside the call) they will result in
      straight line code.

    * NEWBLOCK marks the start of a new basic block so can
      be followed by any instructions.
-}</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">-- Verifying basic blocks is cheap, but not cheap enough to enable it unconditionally.</span><span>
</span><span id="line-170"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#verifyBasicBlock"><span class="hs-identifier hs-type">verifyBasicBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span id="verifyBasicBlock"><span class="annot"><span class="annottext">verifyBasicBlock :: Platform -&gt; [Instr] -&gt; ()
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#verifyBasicBlock"><span class="hs-identifier hs-var hs-var">verifyBasicBlock</span></a></span></span><span> </span><span id="local-6989586621682855027"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682855027"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682855028"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682855028"><span class="hs-identifier hs-var">instrs</span></a></span></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="GHC.Utils.Constants.html#debugIsOn"><span class="hs-identifier hs-var">debugIsOn</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Instr] -&gt; ()
</span><a href="#local-6989586621682855029"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682855028"><span class="hs-identifier hs-var">instrs</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621682855029"><span class="annot"><span class="annottext">go :: Bool -&gt; [Instr] -&gt; ()
</span><a href="#local-6989586621682855029"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><a href="#local-6989586621682855029"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682855030"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682855030"><span class="hs-identifier hs-var">atEnd</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682855031"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682855031"><span class="hs-identifier hs-var">i</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682855032"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682855032"><span class="hs-identifier hs-var">instr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682855031"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-178"></span><span>            </span><span class="hs-comment">-- Start a new basic block</span><span>
</span><span id="line-179"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-type">NEWBLOCK</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Instr] -&gt; ()
</span><a href="#local-6989586621682855029"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682855032"><span class="hs-identifier hs-var">instr</span></a></span><span>
</span><span id="line-180"></span><span>            </span><span class="hs-comment">-- Calls are not viable block terminators</span><span>
</span><span id="line-181"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CALL"><span class="hs-identifier hs-type">CALL</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682855030"><span class="hs-identifier hs-var">atEnd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; ()
</span><a href="#local-6989586621682855035"><span class="hs-identifier hs-var">faultyBlockWith</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682855031"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-182"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682855030"><span class="hs-identifier hs-var">atEnd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Instr] -&gt; ()
</span><a href="#local-6989586621682855029"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682855030"><span class="hs-identifier hs-var">atEnd</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682855032"><span class="hs-identifier hs-var">instr</span></a></span><span>
</span><span id="line-183"></span><span>            </span><span class="hs-comment">-- All instructions ok, check if we reached the end and continue.</span><span>
</span><span id="line-184"></span><span>            </span><span class="annot"><span class="annottext">Instr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682855030"><span class="hs-identifier hs-var">atEnd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Instr] -&gt; ()
</span><a href="#local-6989586621682855029"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.Instr.html#isJumpishInstr"><span class="hs-identifier hs-var">isJumpishInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682855031"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682855032"><span class="hs-identifier hs-var">instr</span></a></span><span>
</span><span id="line-185"></span><span>              </span><span class="hs-comment">-- Only jumps allowed at the end of basic blocks.</span><span>
</span><span id="line-186"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.Instr.html#isJumpishInstr"><span class="hs-identifier hs-var">isJumpishInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682855031"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-187"></span><span>                                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Instr] -&gt; ()
</span><a href="#local-6989586621682855029"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682855032"><span class="hs-identifier hs-var">instr</span></a></span><span>
</span><span id="line-188"></span><span>                                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; ()
</span><a href="#local-6989586621682855035"><span class="hs-identifier hs-var">faultyBlockWith</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682855031"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621682855035"><span class="annot"><span class="annottext">faultyBlockWith :: Instr -&gt; ()
</span><a href="#local-6989586621682855035"><span class="hs-identifier hs-var hs-var">faultyBlockWith</span></a></span></span><span> </span><span id="local-6989586621682855038"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682855038"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-190"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; ()
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non control flow instructions after end of basic block.&quot;</span></span><span>
</span><span id="line-191"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Instr -&gt; SDoc
forall doc. IsDoc doc =&gt; Platform -&gt; Instr -&gt; doc
</span><a href="GHC.CmmToAsm.X86.Ppr.html#pprInstr"><span class="hs-identifier hs-var">pprInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682855027"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682855038"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;in:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Instr -&gt; SDoc) -&gt; [Instr] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Instr -&gt; SDoc
forall doc. IsDoc doc =&gt; Platform -&gt; Instr -&gt; doc
</span><a href="GHC.CmmToAsm.X86.Ppr.html#pprInstr"><span class="hs-identifier hs-var">pprInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682855027"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682855028"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#basicBlockCodeGen"><span class="hs-identifier hs-type">basicBlockCodeGen</span></a></span><span>
</span><span id="line-194"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.html#CmmBlock"><span class="hs-identifier hs-type">CmmBlock</span></a></span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatBasicBlock"><span class="hs-identifier hs-type">NatBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-196"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatCmmDecl"><span class="hs-identifier hs-type">NatCmmDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmStatics"><span class="hs-identifier hs-type">RawCmmStatics</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span id="basicBlockCodeGen"><span class="annot"><span class="annottext">basicBlockCodeGen :: CmmBlock
-&gt; NatM
     ([NatBasicBlock Instr],
      [NatCmmDecl (Alignment, RawCmmStatics) Instr])
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#basicBlockCodeGen"><span class="hs-identifier hs-var hs-var">basicBlockCodeGen</span></a></span></span><span> </span><span id="local-6989586621682855045"><span class="annot"><span class="annottext">CmmBlock
</span><a href="#local-6989586621682855045"><span class="hs-identifier hs-var">block</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmNode C O
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682855046"><span class="annot"><span class="annottext">Block CmmNode O O
</span><a href="#local-6989586621682855046"><span class="hs-identifier hs-var hs-var">nodes</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682855047"><span class="annot"><span class="annottext">CmmNode O C
</span><a href="#local-6989586621682855047"><span class="hs-identifier hs-var hs-var">tail</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmBlock -&gt; (CmmNode C O, Block CmmNode O O, CmmNode O C)
forall (n :: Extensibility -&gt; Extensibility -&gt; *).
Block n C C -&gt; (n C O, Block n O O, n O C)
</span><a href="GHC.Cmm.Dataflow.Block.html#blockSplit"><span class="hs-identifier hs-var">blockSplit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmBlock
</span><a href="#local-6989586621682855045"><span class="hs-identifier hs-var">block</span></a></span><span>
</span><span id="line-200"></span><span>      </span><span id="local-6989586621682855049"><span class="annot"><span class="annottext">id :: Label
</span><a href="#local-6989586621682855049"><span class="hs-identifier hs-var hs-var hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmBlock -&gt; Label
forall (x :: Extensibility). Block CmmNode C x -&gt; Label
forall (thing :: Extensibility -&gt; Extensibility -&gt; *)
       (x :: Extensibility).
NonLocal thing =&gt;
thing C x -&gt; Label
</span><a href="GHC.Cmm.Dataflow.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a></span><span> </span><span class="annot"><span class="annottext">CmmBlock
</span><a href="#local-6989586621682855045"><span class="hs-identifier hs-var">block</span></a></span><span>
</span><span id="line-201"></span><span>      </span><span id="local-6989586621682855051"><span class="annot"><span class="annottext">stmts :: [CmmNode O O]
</span><a href="#local-6989586621682855051"><span class="hs-identifier hs-var hs-var hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Block CmmNode O O -&gt; [CmmNode O O]
forall (n :: Extensibility -&gt; Extensibility -&gt; *).
Block n O O -&gt; [n O O]
</span><a href="GHC.Cmm.Dataflow.Block.html#blockToList"><span class="hs-identifier hs-var">blockToList</span></a></span><span> </span><span class="annot"><span class="annottext">Block CmmNode O O
</span><a href="#local-6989586621682855046"><span class="hs-identifier hs-var">nodes</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-comment">-- Generate location directive</span><span>
</span><span id="line-203"></span><span>  </span><span id="local-6989586621682855053"><span class="annot"><a href="#local-6989586621682855053"><span class="hs-identifier hs-var">dbg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Label -&gt; NatM (Maybe DebugBlock)
</span><a href="GHC.CmmToAsm.Monad.html#getDebugBlock"><span class="hs-identifier hs-var">getDebugBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmBlock -&gt; Label
forall (x :: Extensibility). Block CmmNode C x -&gt; Label
forall (thing :: Extensibility -&gt; Extensibility -&gt; *)
       (x :: Extensibility).
NonLocal thing =&gt;
thing C x -&gt; Label
</span><a href="GHC.Cmm.Dataflow.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a></span><span> </span><span class="annot"><span class="annottext">CmmBlock
</span><a href="#local-6989586621682855045"><span class="hs-identifier hs-var">block</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621682855054"><span class="annot"><a href="#local-6989586621682855054"><span class="hs-identifier hs-var">loc_instrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#dblSourceTick"><span class="hs-identifier hs-var">dblSourceTick</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682855053"><span class="hs-identifier hs-type">dbg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Tickish.html#SourceNote"><span class="hs-identifier hs-type">SourceNote</span></a></span><span> </span><span id="local-6989586621682855058"><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682855058"><span class="hs-identifier hs-var">span</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.FastString.html#LexicalFastString"><span class="hs-identifier hs-type">LexicalFastString</span></a></span><span> </span><span id="local-6989586621682855060"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682855060"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682855061"><span class="annot"><a href="#local-6989586621682855061"><span class="hs-identifier hs-var">fileId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM Int
</span><a href="GHC.CmmToAsm.Monad.html#getFileId"><span class="hs-identifier hs-var">getFileId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcSpan -&gt; FastString
</span><a href="GHC.Types.SrcLoc.html#srcSpanFile"><span class="hs-identifier hs-var">srcSpanFile</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682855058"><span class="hs-identifier hs-var">span</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682855062"><span class="annot"><a href="#local-6989586621682855062"><span class="hs-identifier hs-var hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RealSrcSpan -&gt; Int
</span><a href="GHC.Types.SrcLoc.html#srcSpanStartLine"><span class="hs-identifier hs-var">srcSpanStartLine</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682855058"><span class="hs-identifier hs-var">span</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621682855063"><span class="annot"><a href="#local-6989586621682855063"><span class="hs-identifier hs-var hs-var">col</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RealSrcSpan -&gt; Int
</span><a href="GHC.Types.SrcLoc.html#srcSpanStartCol"><span class="hs-identifier hs-var">srcSpanStartCol</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682855058"><span class="hs-identifier hs-var">span</span></a></span><span>
</span><span id="line-208"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#LOCATION"><span class="hs-identifier hs-type">LOCATION</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855061"><span class="hs-identifier hs-type">fileId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855062"><span class="hs-identifier hs-type">line</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855063"><span class="hs-identifier hs-type">col</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.FastString.html#unpackFS"><span class="hs-identifier hs-type">unpackFS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855060"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><span class="annottext">Maybe CmmTickish
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; NatM InstrBlock
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682855068"><span class="annot"><a href="#local-6989586621682855068"><span class="hs-identifier hs-var">mid_instrs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855069"><span class="annot"><a href="#local-6989586621682855069"><span class="hs-identifier hs-var">mid_bid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stmtsToInstrs"><span class="hs-identifier hs-type">stmtsToInstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855049"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855051"><span class="hs-identifier hs-type">stmts</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621682855071"><span class="annot"><a href="#local-6989586621682855071"><span class="hs-identifier hs-var">tail_instrs</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stmtToInstrs"><span class="hs-identifier hs-type">stmtToInstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855069"><span class="hs-identifier hs-type">mid_bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855047"><span class="hs-identifier hs-type">tail</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682855073"><span class="annot"><a href="#local-6989586621682855073"><span class="hs-identifier hs-var hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855054"><span class="hs-identifier hs-var">loc_instrs</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855068"><span class="hs-identifier hs-var">mid_instrs</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855071"><span class="hs-identifier hs-var">tail_instrs</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621682855075"><span class="annot"><a href="#local-6989586621682855075"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#verifyBasicBlock"><span class="hs-identifier hs-type">verifyBasicBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855075"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#fromOL"><span class="hs-identifier hs-type">fromOL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855073"><span class="hs-identifier hs-type">instrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>  </span><span id="local-6989586621682855078"><span class="annot"><a href="#local-6989586621682855078"><span class="hs-identifier hs-var">instrs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fold</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#addSpUnwindings"><span class="hs-identifier hs-type">addSpUnwindings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855073"><span class="hs-identifier hs-type">instrs</span></a></span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-comment">-- code generation may introduce new basic block boundaries, which</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-comment">-- are indicated by the NEWBLOCK instruction.  We must split up the</span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-comment">-- instruction stream into basic blocks again.  Also, we extract</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-comment">-- LDATAs here too.</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-221"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682855082"><span class="annot"><a href="#local-6989586621682855082"><span class="hs-identifier hs-var">top</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855083"><span class="annot"><a href="#local-6989586621682855083"><span class="hs-identifier hs-var">other_blocks</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855084"><span class="annot"><a href="#local-6989586621682855084"><span class="hs-identifier hs-var">statics</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#foldrOL"><span class="hs-identifier hs-type">foldrOL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855086"><span class="hs-identifier hs-type">mkBlocks</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682855078"><span class="hs-identifier hs-type">instrs'</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span>        </span><span id="local-6989586621682855086"><span class="annot"><a href="#local-6989586621682855086"><span class="hs-identifier hs-var hs-var">mkBlocks</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-type">NEWBLOCK</span></a></span><span> </span><span id="local-6989586621682855087"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855087"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682855088"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682855088"><span class="hs-identifier hs-var">instrs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855089"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682855089"><span class="hs-identifier hs-var">blocks</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855090"><span class="annot"><span class="annottext">[GenCmmDecl (Alignment, RawCmmStatics) h g]
</span><a href="#local-6989586621682855090"><span class="hs-identifier hs-var">statics</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Label -&gt; [Instr] -&gt; NatBasicBlock Instr
forall i. Label -&gt; [i] -&gt; GenBasicBlock i
</span><a href="GHC.Cmm.html#BasicBlock"><span class="hs-identifier hs-var">BasicBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855087"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682855088"><span class="hs-identifier hs-var">instrs</span></a></span><span> </span><span class="annot"><span class="annottext">NatBasicBlock Instr
-&gt; [NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682855089"><span class="hs-identifier hs-var">blocks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[GenCmmDecl (Alignment, RawCmmStatics) h g]
</span><a href="#local-6989586621682855090"><span class="hs-identifier hs-var">statics</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>        </span><span class="annot"><a href="#local-6989586621682855086"><span class="hs-identifier hs-var">mkBlocks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#LDATA"><span class="hs-identifier hs-type">LDATA</span></a></span><span> </span><span id="local-6989586621682855093"><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682855093"><span class="hs-identifier hs-var">sec</span></a></span></span><span> </span><span id="local-6989586621682855094"><span class="annot"><span class="annottext">(Alignment, RawCmmStatics)
</span><a href="#local-6989586621682855094"><span class="hs-identifier hs-var">dat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682855095"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682855095"><span class="hs-identifier hs-var">instrs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855096"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682855096"><span class="hs-identifier hs-var">blocks</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855097"><span class="annot"><span class="annottext">[GenCmmDecl (Alignment, RawCmmStatics) h g]
</span><a href="#local-6989586621682855097"><span class="hs-identifier hs-var">statics</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682855095"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682855096"><span class="hs-identifier hs-var">blocks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Section
-&gt; (Alignment, RawCmmStatics)
-&gt; GenCmmDecl (Alignment, RawCmmStatics) h g
forall d h g. Section -&gt; d -&gt; GenCmmDecl d h g
</span><a href="GHC.Cmm.html#CmmData"><span class="hs-identifier hs-var">CmmData</span></a></span><span> </span><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682855093"><span class="hs-identifier hs-var">sec</span></a></span><span> </span><span class="annot"><span class="annottext">(Alignment, RawCmmStatics)
</span><a href="#local-6989586621682855094"><span class="hs-identifier hs-var">dat</span></a></span><span class="annot"><span class="annottext">GenCmmDecl (Alignment, RawCmmStatics) h g
-&gt; [GenCmmDecl (Alignment, RawCmmStatics) h g]
-&gt; [GenCmmDecl (Alignment, RawCmmStatics) h g]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[GenCmmDecl (Alignment, RawCmmStatics) h g]
</span><a href="#local-6989586621682855097"><span class="hs-identifier hs-var">statics</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>        </span><span class="annot"><a href="#local-6989586621682855086"><span class="hs-identifier hs-var">mkBlocks</span></a></span><span> </span><span id="local-6989586621682855098"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682855098"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682855099"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682855099"><span class="hs-identifier hs-var">instrs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855100"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682855100"><span class="hs-identifier hs-var">blocks</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855101"><span class="annot"><span class="annottext">[GenCmmDecl (Alignment, RawCmmStatics) h g]
</span><a href="#local-6989586621682855101"><span class="hs-identifier hs-var">statics</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682855098"><span class="hs-identifier hs-var">instr</span></a></span><span class="annot"><span class="annottext">Instr -&gt; [Instr] -&gt; [Instr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682855099"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682855100"><span class="hs-identifier hs-var">blocks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[GenCmmDecl (Alignment, RawCmmStatics) h g]
</span><a href="#local-6989586621682855101"><span class="hs-identifier hs-var">statics</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#BasicBlock"><span class="hs-identifier hs-type">BasicBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855049"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855082"><span class="hs-identifier hs-type">top</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621682855083"><span class="hs-identifier hs-type">other_blocks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682855084"><span class="hs-identifier hs-type">statics</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- | Convert 'DELTA' instructions into 'UNWIND' instructions to capture changes</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- in the @sp@ register. See Note [What is this unwinding business?] in &quot;GHC.Cmm.DebugBlock&quot;</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- for details.</span><span>
</span><span id="line-234"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#addSpUnwindings"><span class="hs-identifier hs-type">addSpUnwindings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span id="addSpUnwindings"><span class="annot"><span class="annottext">addSpUnwindings :: Instr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#addSpUnwindings"><span class="hs-identifier hs-var hs-var">addSpUnwindings</span></a></span></span><span> </span><span id="local-6989586621682855104"><span class="annot"><span class="annottext">instr :: Instr
</span><a href="#local-6989586621682855104"><span class="hs-identifier hs-var">instr</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span id="local-6989586621682855105"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682855105"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-236"></span><span>    </span><span id="local-6989586621682855106"><span class="annot"><a href="#local-6989586621682855106"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682855107"><span class="annot"><a href="#local-6989586621682855107"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682855106"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgDwarfUnwindings"><span class="hs-identifier hs-var">ncgDwarfUnwindings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855106"><span class="hs-identifier hs-type">config</span></a></span><span>
</span><span id="line-239"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682855110"><span class="annot"><a href="#local-6989586621682855110"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html#mkAsmTempLabel"><span class="hs-identifier hs-type">mkAsmTempLabel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSM.html#getUniqueM"><span class="hs-identifier hs-type">getUniqueM</span></a></span><span>
</span><span id="line-240"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682855112"><span class="annot"><a href="#local-6989586621682855112"><span class="hs-identifier hs-var hs-var">unwind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalReg -&gt; Maybe UnwindExpr -&gt; Map GlobalReg (Maybe UnwindExpr)
forall k a. k -&gt; a -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#singleton"><span class="hs-identifier hs-var">Map.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="GHC.Cmm.Reg.html#MachSp"><span class="hs-identifier hs-var">MachSp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnwindExpr -&gt; Maybe UnwindExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(UnwindExpr -&gt; Maybe UnwindExpr) -&gt; UnwindExpr -&gt; Maybe UnwindExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GlobalRegUse -&gt; Int -&gt; UnwindExpr
</span><a href="GHC.Cmm.DebugBlock.html#UwReg"><span class="hs-identifier hs-var">UwReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalReg -&gt; CmmType -&gt; GlobalRegUse
</span><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-var">GlobalRegUse</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="GHC.Cmm.Reg.html#MachSp"><span class="hs-identifier hs-var">MachSp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmType
</span><a href="GHC.Cmm.Type.html#bWord"><span class="hs-identifier hs-var">bWord</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682855107"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; UnwindExpr) -&gt; Int -&gt; UnwindExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682855105"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="#local-6989586621682855104"><span class="hs-identifier hs-type">instr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#UNWIND"><span class="hs-identifier hs-type">UNWIND</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855110"><span class="hs-identifier hs-type">lbl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855112"><span class="hs-identifier hs-type">unwind</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-242"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855104"><span class="hs-identifier hs-type">instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#addSpUnwindings"><span class="hs-identifier hs-var">addSpUnwindings</span></a></span><span> </span><span id="local-6989586621682855118"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682855118"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; NatM InstrBlock
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(InstrBlock -&gt; NatM InstrBlock) -&gt; InstrBlock -&gt; NatM InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682855118"><span class="hs-identifier hs-var">instr</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">{- Note [Keeping track of the current block]
   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When generating instructions for Cmm we sometimes require
the current block for things like retry loops.

We also sometimes change the current block, if a MachOP
results in branching control flow.

Issues arise if we have two statements in the same block,
which both depend on the current block id *and* change the
basic block after them. This happens for atomic primops
in the X86 backend where we want to update the CFG data structure
when introducing new basic blocks.

For example in #17334 we got this Cmm code:

        c3Bf: // global
            (_s3t1::I64) = call MO_AtomicRMW W64 AMO_And(_s3sQ::P64 + 88, 18);
            (_s3t4::I64) = call MO_AtomicRMW W64 AMO_Or(_s3sQ::P64 + 88, 0);
            _s3sT::I64 = _s3sV::I64;
            goto c3B1;

This resulted in two new basic blocks being inserted:

        c3Bf:
                movl $18,%vI_n3Bo
                movq 88(%vI_s3sQ),%rax
                jmp _n3Bp
        n3Bp:
                ...
                cmpxchgq %vI_n3Bq,88(%vI_s3sQ)
                jne _n3Bp
                ...
                jmp _n3Bs
        n3Bs:
                ...
                cmpxchgq %vI_n3Bt,88(%vI_s3sQ)
                jne _n3Bs
                ...
                jmp _c3B1
        ...

Based on the Cmm we called stmtToInstrs we translated both atomic operations under
the assumption they would be placed into their Cmm basic block `c3Bf`.
However for the retry loop we introduce new labels, so this is not the case
for the second statement.
This resulted in a desync between the explicit control flow graph
we construct as a separate data type and the actual control flow graph in the code.

Instead we now return the new basic block if a statement causes a change
in the current block and use the block for all following statements.

For this reason genForeignCall is also split into two parts.  One for calls which
*won't* change the basic blocks in which successive instructions will be
placed (since they only evaluate CmmExpr, which can only contain MachOps, which
cannot introduce basic blocks in their lowerings).  A different one for calls
which *are* known to change the basic block.

-}</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">-- See Note [Keeping track of the current block] for why</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- we pass the BlockId.</span><span>
</span><span id="line-307"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stmtsToInstrs"><span class="hs-identifier hs-type">stmtsToInstrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Basic block these statement will start to be placed in.</span></span><span>
</span><span id="line-308"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Cmm Statement</span></span><span>
</span><span id="line-309"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Resulting instruction</span></span><span>
</span><span id="line-310"></span><span id="stmtsToInstrs"><span class="annot"><span class="annottext">stmtsToInstrs :: Label -&gt; [CmmNode O O] -&gt; NatM (InstrBlock, Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stmtsToInstrs"><span class="hs-identifier hs-var hs-var">stmtsToInstrs</span></a></span></span><span> </span><span id="local-6989586621682855120"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855120"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682855121"><span class="annot"><span class="annottext">[CmmNode O O]
</span><a href="#local-6989586621682855121"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><span class="annottext">Label -&gt; [CmmNode O O] -&gt; InstrBlock -&gt; NatM (InstrBlock, Label)
forall {e :: Extensibility} {x :: Extensibility}.
Label -&gt; [CmmNode e x] -&gt; InstrBlock -&gt; NatM (InstrBlock, Label)
</span><a href="#local-6989586621682855122"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855120"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmNode O O]
</span><a href="#local-6989586621682855121"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span>    </span><span id="local-6989586621682855122"><span class="annot"><span class="annottext">go :: Label -&gt; [CmmNode e x] -&gt; InstrBlock -&gt; NatM (InstrBlock, Label)
</span><a href="#local-6989586621682855122"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682855125"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855125"><span class="hs-identifier hs-var">bid</span></a></span></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span id="local-6989586621682855126"><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855126"><span class="hs-identifier hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(InstrBlock, Label) -&gt; NatM (InstrBlock, Label)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855126"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855125"><span class="hs-identifier hs-var">bid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>    </span><span class="annot"><a href="#local-6989586621682855122"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682855127"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855127"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682855128"><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682855128"><span class="hs-identifier hs-var">s</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682855129"><span class="annot"><span class="annottext">[CmmNode e x]
</span><a href="#local-6989586621682855129"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span>  </span><span id="local-6989586621682855130"><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855130"><span class="hs-identifier hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-315"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682855131"><span class="annot"><a href="#local-6989586621682855131"><span class="hs-identifier hs-var">instrs'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855132"><span class="annot"><a href="#local-6989586621682855132"><span class="hs-identifier hs-var">bid'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Label -&gt; CmmNode e x -&gt; NatM (InstrBlock, Maybe Label)
forall (e :: Extensibility) (x :: Extensibility).
Label -&gt; CmmNode e x -&gt; NatM (InstrBlock, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stmtToInstrs"><span class="hs-identifier hs-var">stmtToInstrs</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855127"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682855128"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-316"></span><span>      </span><span class="hs-comment">-- If the statement introduced a new block, we use that one</span><span>
</span><span id="line-317"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682855133"><span class="annot"><a href="#local-6989586621682855133"><span class="hs-identifier hs-var hs-var">newBid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Maybe Label -&gt; Label
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855127"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Label
</span><a href="#local-6989586621682855132"><span class="hs-identifier hs-var">bid'</span></a></span><span>
</span><span id="line-318"></span><span>      </span><span class="annot"><a href="#local-6989586621682855122"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855133"><span class="hs-identifier hs-type">newBid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855129"><span class="hs-identifier hs-type">stmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682855130"><span class="hs-identifier hs-type">instrs</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855131"><span class="hs-identifier hs-type">instrs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="hs-comment">-- | `bid` refers to the current block and is used to update the CFG</span><span>
</span><span id="line-321"></span><span class="hs-comment">--   if new blocks are inserted in the control flow.</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- See Note [Keeping track of the current block] for more details.</span><span>
</span><span id="line-323"></span><span id="local-6989586621682853690"><span id="local-6989586621682853691"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stmtToInstrs"><span class="hs-identifier hs-type">stmtToInstrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Basic block this statement will start to be placed in.</span></span><span>
</span><span id="line-324"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682853690"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682853691"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-325"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-326"></span><span>             </span><span class="hs-comment">-- ^ Instructions, and bid of new block if successive</span><span>
</span><span id="line-327"></span><span>             </span><span class="hs-comment">-- statements are placed in a different basic block.</span><span>
</span><span id="line-328"></span><span id="stmtToInstrs"><span class="annot"><span class="annottext">stmtToInstrs :: forall (e :: Extensibility) (x :: Extensibility).
Label -&gt; CmmNode e x -&gt; NatM (InstrBlock, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stmtToInstrs"><span class="hs-identifier hs-var hs-var">stmtToInstrs</span></a></span></span><span> </span><span id="local-6989586621682855140"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855140"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682855141"><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682855141"><span class="hs-identifier hs-var">stmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-329"></span><span>  </span><span id="local-6989586621682855142"><span class="annot"><a href="#local-6989586621682855142"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-330"></span><span>  </span><span id="local-6989586621682855143"><span class="annot"><a href="#local-6989586621682855143"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682855141"><span class="hs-identifier hs-type">stmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnsafeForeignCall"><span class="hs-identifier hs-type">CmmUnsafeForeignCall</span></a></span><span> </span><span id="local-6989586621682855147"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682855147"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621682855148"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682855148"><span class="hs-identifier hs-var">result_regs</span></a></span></span><span> </span><span id="local-6989586621682855149"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682855149"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-333"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ForeignTarget
-&gt; [LocalReg]
-&gt; [CmmExpr]
-&gt; Label
-&gt; NatM (InstrBlock, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genForeignCall"><span class="hs-identifier hs-var">genForeignCall</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682855147"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682855148"><span class="hs-identifier hs-var">result_regs</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682855149"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855140"><span class="hs-identifier hs-var">bid</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span>    </span><span class="annot"><span class="annottext">CmmNode e x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe Label
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(InstrBlock -&gt; (InstrBlock, Maybe Label))
-&gt; NatM InstrBlock -&gt; NatM (InstrBlock, Maybe Label)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682855141"><span class="hs-identifier hs-var">stmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-336"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmComment"><span class="hs-identifier hs-type">CmmComment</span></a></span><span> </span><span id="local-6989586621682855155"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682855155"><span class="hs-identifier hs-var">s</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; NatM InstrBlock
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#COMMENT"><span class="hs-identifier hs-var">COMMENT</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682855155"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTick"><span class="hs-identifier hs-type">CmmTick</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; NatM InstrBlock
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnwind"><span class="hs-identifier hs-type">CmmUnwind</span></a></span><span> </span><span id="local-6989586621682855176"><span class="annot"><span class="annottext">[(GlobalReg, Maybe CmmExpr)]
</span><a href="#local-6989586621682855176"><span class="hs-identifier hs-var">regs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-340"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621682855177"><span class="hs-identifier hs-type">to_unwind_entry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalReg"><span class="hs-identifier hs-type">GlobalReg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#UnwindTable"><span class="hs-identifier hs-type">UnwindTable</span></a></span><span>
</span><span id="line-341"></span><span>            </span><span id="local-6989586621682855177"><span class="annot"><span class="annottext">to_unwind_entry :: (GlobalReg, Maybe CmmExpr) -&gt; Map GlobalReg (Maybe UnwindExpr)
</span><a href="#local-6989586621682855177"><span class="hs-identifier hs-var hs-var">to_unwind_entry</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682855178"><span class="annot"><span class="annottext">GlobalReg
</span><a href="#local-6989586621682855178"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682855179"><span class="annot"><span class="annottext">Maybe CmmExpr
</span><a href="#local-6989586621682855179"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalReg -&gt; Maybe UnwindExpr -&gt; Map GlobalReg (Maybe UnwindExpr)
forall k a. k -&gt; a -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#singleton"><span class="hs-identifier hs-var">Map.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="#local-6989586621682855178"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; UnwindExpr) -&gt; Maybe CmmExpr -&gt; Maybe UnwindExpr
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; UnwindExpr
</span><a href="GHC.Cmm.DebugBlock.html#toUnwindExpr"><span class="hs-identifier hs-var">toUnwindExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682855143"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe CmmExpr
</span><a href="#local-6989586621682855179"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((GlobalReg, Maybe CmmExpr) -&gt; Map GlobalReg (Maybe UnwindExpr))
-&gt; [(GlobalReg, Maybe CmmExpr)] -&gt; Map GlobalReg (Maybe UnwindExpr)
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">(GlobalReg, Maybe CmmExpr) -&gt; Map GlobalReg (Maybe UnwindExpr)
</span><a href="#local-6989586621682855177"><span class="hs-identifier hs-var">to_unwind_entry</span></a></span><span> </span><span class="annot"><span class="annottext">[(GlobalReg, Maybe CmmExpr)]
</span><a href="#local-6989586621682855176"><span class="hs-identifier hs-var">regs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-343"></span><span>          </span><span id="local-6989586621682855181"><span class="annot"><span class="annottext">Map GlobalReg (Maybe UnwindExpr)
</span><a href="#local-6989586621682855181"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Map GlobalReg (Maybe UnwindExpr) -&gt; Bool
forall k a. Map k a -&gt; Bool
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#null"><span class="hs-identifier hs-var">Map.null</span></a></span><span> </span><span class="annot"><span class="annottext">Map GlobalReg (Maybe UnwindExpr)
</span><a href="#local-6989586621682855181"><span class="hs-identifier hs-var">tbl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; NatM InstrBlock
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-344"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-345"></span><span>                  </span><span id="local-6989586621682855183"><span class="annot"><a href="#local-6989586621682855183"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; CLabel
forall a. Uniquable a =&gt; a -&gt; CLabel
</span><a href="GHC.Cmm.CLabel.html#mkAsmTempLabel"><span class="hs-identifier hs-var">mkAsmTempLabel</span></a></span><span> </span><span class="annot"><span class="annottext">(Unique -&gt; CLabel) -&gt; NatM Unique -&gt; NatM CLabel
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NatM Unique
forall (m :: * -&gt; *). MonadGetUnique m =&gt; m Unique
</span><a href="GHC.Types.Unique.DSM.html#getUniqueM"><span class="hs-identifier hs-var">getUniqueM</span></a></span><span>
</span><span id="line-346"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#UNWIND"><span class="hs-identifier hs-type">UNWIND</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855183"><span class="hs-identifier hs-type">lbl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855181"><span class="hs-identifier hs-type">tbl</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmAssign"><span class="hs-identifier hs-type">CmmAssign</span></a></span><span> </span><span id="local-6989586621682855187"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682855187"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682855188"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855188"><span class="hs-identifier hs-var">src</span></a></span></span><span>
</span><span id="line-349"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-var">isFloatType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682855190"><span class="hs-identifier hs-var">ty</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_FltCode"><span class="hs-identifier hs-var">assignReg_FltCode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682855187"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855188"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-350"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682855142"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-var">isWord64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682855190"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_I64Code"><span class="hs-identifier hs-var">assignReg_I64Code</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682855187"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855188"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-351"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isVecType"><span class="hs-identifier hs-var">isVecType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682855190"><span class="hs-identifier hs-var">ty</span></a></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_VecCode"><span class="hs-identifier hs-var">assignReg_VecCode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682855187"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855188"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-352"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_IntCode"><span class="hs-identifier hs-var">assignReg_IntCode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682855187"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855188"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-353"></span><span>          </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682855190"><span class="annot"><span class="annottext">ty :: CmmType
</span><a href="#local-6989586621682855190"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682855187"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmStore"><span class="hs-identifier hs-type">CmmStore</span></a></span><span> </span><span id="local-6989586621682855202"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855202"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682855203"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855203"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682855204"><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="#local-6989586621682855204"><span class="hs-identifier hs-var">_alignment</span></a></span></span><span>
</span><span id="line-356"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-var">isFloatType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682855205"><span class="hs-identifier hs-var">ty</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_FltCode"><span class="hs-identifier hs-var">assignMem_FltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682855207"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855202"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855203"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-357"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682855142"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-var">isWord64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682855205"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_I64Code"><span class="hs-identifier hs-var">assignMem_I64Code</span></a></span><span>        </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855202"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855203"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-358"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isVecType"><span class="hs-identifier hs-var">isVecType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682855205"><span class="hs-identifier hs-var">ty</span></a></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_VecCode"><span class="hs-identifier hs-var">assignMem_VecCode</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682855207"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855202"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855203"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-359"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_IntCode"><span class="hs-identifier hs-var">assignMem_IntCode</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682855207"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855202"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855203"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-360"></span><span>          </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682855205"><span class="annot"><span class="annottext">ty :: CmmType
</span><a href="#local-6989586621682855205"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682855143"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855203"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-361"></span><span>                </span><span id="local-6989586621682855207"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682855207"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682855205"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmBranch"><span class="hs-identifier hs-type">CmmBranch</span></a></span><span> </span><span id="local-6989586621682855217"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855217"><span class="hs-identifier hs-var">id</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; NatM InstrBlock
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(InstrBlock -&gt; NatM InstrBlock) -&gt; InstrBlock -&gt; NatM InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genBranch"><span class="hs-identifier hs-var">genBranch</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855217"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span>      </span><span class="hs-comment">--We try to arrange blocks such that the likely branch is the fallthrough</span><span>
</span><span id="line-366"></span><span>      </span><span class="hs-comment">--in GHC.Cmm.ContFlowOpt. So we can assume the condition is likely false here.</span><span>
</span><span id="line-367"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-type">CmmCondBranch</span></a></span><span> </span><span id="local-6989586621682855222"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855222"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682855223"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855223"><span class="hs-identifier hs-var">true</span></a></span></span><span> </span><span id="local-6989586621682855224"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855224"><span class="hs-identifier hs-var">false</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Label -&gt; Label -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCondBranch"><span class="hs-identifier hs-var">genCondBranch</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855140"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855223"><span class="hs-identifier hs-var">true</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855224"><span class="hs-identifier hs-var">false</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855222"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-368"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-type">CmmSwitch</span></a></span><span> </span><span id="local-6989586621682855229"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855229"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682855230"><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682855230"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; SwitchTargets -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genSwitch"><span class="hs-identifier hs-var">genSwitch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855229"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682855230"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-369"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCall"><span class="hs-identifier hs-type">CmmCall</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cml_target :: CmmNode O C -&gt; CmmExpr
</span><a href="GHC.Cmm.Node.html#cml_target"><span class="hs-identifier hs-var">cml_target</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682855236"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855236"><span class="hs-identifier hs-var">arg</span></a></span></span><span>
</span><span id="line-370"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cml_args_regs :: CmmNode O C -&gt; [GlobalRegUse]
</span><a href="GHC.Cmm.Node.html#cml_args_regs"><span class="hs-identifier hs-var">cml_args_regs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682855238"><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682855238"><span class="hs-identifier hs-var">gregs</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; [RegWithFormat] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genJump"><span class="hs-identifier hs-var">genJump</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855236"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; [GlobalRegUse] -&gt; [RegWithFormat]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#jumpRegs"><span class="hs-identifier hs-var">jumpRegs</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682855143"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682855238"><span class="hs-identifier hs-var">gregs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>      </span><span class="annot"><span class="annottext">CmmNode e x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-372"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; NatM InstrBlock
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;stmtToInstrs: statement should have been cps'd away&quot;</span></span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#jumpRegs"><span class="hs-identifier hs-type">jumpRegs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-type">GlobalRegUse</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#RegWithFormat"><span class="hs-identifier hs-type">RegWithFormat</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-376"></span><span id="jumpRegs"><span class="annot"><span class="annottext">jumpRegs :: Platform -&gt; [GlobalRegUse] -&gt; [RegWithFormat]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#jumpRegs"><span class="hs-identifier hs-var hs-var">jumpRegs</span></a></span></span><span> </span><span id="local-6989586621682855242"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682855242"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682855243"><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682855243"><span class="hs-identifier hs-var">gregs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Format -&gt; RegWithFormat
</span><a href="GHC.CmmToAsm.Format.html#RegWithFormat"><span class="hs-identifier hs-var">RegWithFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealReg -&gt; Reg
</span><a href="GHC.Platform.Reg.html#RegReal"><span class="hs-identifier hs-var">RegReal</span></a></span><span> </span><span class="annot"><span class="annottext">RealReg
</span><a href="#local-6989586621682855246"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682855247"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-type">GlobalRegUse</span></a></span><span> </span><span id="local-6989586621682855248"><span class="annot"><span class="annottext">GlobalReg
</span><a href="#local-6989586621682855248"><span class="hs-identifier hs-var">gr</span></a></span></span><span> </span><span id="local-6989586621682855247"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682855247"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682855243"><span class="hs-identifier hs-var">gregs</span></a></span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682855246"><span class="annot"><span class="annottext">RealReg
</span><a href="#local-6989586621682855246"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Platform -&gt; GlobalReg -&gt; Maybe RealReg
</span><a href="GHC.Platform.Regs.html#globalRegMaybe"><span class="hs-identifier hs-var">globalRegMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682855242"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="#local-6989586621682855248"><span class="hs-identifier hs-var">gr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- | 'InstrBlock's are the insn sequences generated by the insn selectors.</span><span>
</span><span id="line-383"></span><span class="hs-comment">--      They are really trees of insns to facilitate fast appending, where a</span><span>
</span><span id="line-384"></span><span class="hs-comment">--      left-to-right traversal yields the insns in the correct order.</span><span>
</span><span id="line-385"></span><span class="hs-comment">--</span><span>
</span><span id="line-386"></span><span class="hs-keyword">type</span><span> </span><span id="InstrBlock"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-var">InstrBlock</span></a></span></span><span>
</span><span id="line-387"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="hs-comment">-- | Condition codes passed up the tree.</span><span>
</span><span id="line-391"></span><span class="hs-comment">--</span><span>
</span><span id="line-392"></span><span class="hs-keyword">data</span><span> </span><span id="CondCode"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-var">CondCode</span></a></span></span><span>
</span><span id="line-393"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span id="CondCode"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-var">CondCode</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="hs-comment">-- | Register's passed up the tree.  If the stix code forces the register</span><span>
</span><span id="line-397"></span><span class="hs-comment">--      to live in a pre-decided machine register, it comes out as @Fixed@;</span><span>
</span><span id="line-398"></span><span class="hs-comment">--      otherwise, it comes out as @Any@, and the parent can decide which</span><span>
</span><span id="line-399"></span><span class="hs-comment">--      register to put it in.</span><span>
</span><span id="line-400"></span><span class="hs-comment">--</span><span>
</span><span id="line-401"></span><span class="hs-keyword">data</span><span> </span><span id="Register"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-var">Register</span></a></span></span><span>
</span><span id="line-402"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span id="Fixed"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-var">Fixed</span></a></span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-403"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="Any"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#swizzleRegisterRep"><span class="hs-identifier hs-type">swizzleRegisterRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-407"></span><span id="swizzleRegisterRep"><span class="annot"><span class="annottext">swizzleRegisterRep :: Register -&gt; Format -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#swizzleRegisterRep"><span class="hs-identifier hs-var hs-var">swizzleRegisterRep</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682855254"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855254"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682855255"><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855255"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682855256"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682855256"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; InstrBlock -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-var">Fixed</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682855256"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855254"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855255"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-408"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#swizzleRegisterRep"><span class="hs-identifier hs-var">swizzleRegisterRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682855257"><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682855257"><span class="hs-identifier hs-var">codefn</span></a></span></span><span class="hs-special">)</span><span>     </span><span id="local-6989586621682855258"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682855258"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; InstrBlock) -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span>   </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682855258"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682855257"><span class="hs-identifier hs-var">codefn</span></a></span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-type">getLocalRegReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span>
</span><span id="line-411"></span><span id="getLocalRegReg"><span class="annot"><span class="annottext">getLocalRegReg :: LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var hs-var">getLocalRegReg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span id="local-6989586621682855261"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682855261"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621682855262"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682855262"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- by assuming SSE2, Int, Word, Float, Double and vectors all can be register allocated</span><span>
</span><span id="line-413"></span><span>    </span><span class="annot"><span class="annottext">VirtualReg -&gt; Reg
</span><a href="GHC.Platform.Reg.html#RegVirtual"><span class="hs-identifier hs-var">RegVirtual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unique -&gt; Format -&gt; VirtualReg
</span><a href="GHC.CmmToAsm.X86.RegInfo.html#mkVirtualReg"><span class="hs-identifier hs-var">mkVirtualReg</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682855261"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682855262"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="annot"><span class="hs-comment">-- | Grab the Reg for a CmmReg</span></span><span>
</span><span id="line-416"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-type">getRegisterReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span id="getRegisterReg"><span class="annot"><span class="annottext">getRegisterReg :: Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var hs-var">getRegisterReg</span></a></span></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-type">CmmLocal</span></a></span><span> </span><span id="local-6989586621682855267"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682855267"><span class="hs-identifier hs-var">lreg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682855267"><span class="hs-identifier hs-var">lreg</span></a></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span id="local-6989586621682855268"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682855268"><span class="hs-identifier hs-var">platform</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmGlobal"><span class="hs-identifier hs-type">CmmGlobal</span></a></span><span> </span><span id="local-6989586621682855270"><span class="annot"><span class="annottext">GlobalRegUse
</span><a href="#local-6989586621682855270"><span class="hs-identifier hs-var">mid</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; GlobalReg -&gt; Maybe RealReg
</span><a href="GHC.Platform.Regs.html#globalRegMaybe"><span class="hs-identifier hs-var">globalRegMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682855268"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">(GlobalReg -&gt; Maybe RealReg) -&gt; GlobalReg -&gt; Maybe RealReg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GlobalRegUse -&gt; GlobalReg
</span><a href="GHC.Cmm.Reg.html#globalRegUse_reg"><span class="hs-identifier hs-var">globalRegUse_reg</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRegUse
</span><a href="#local-6989586621682855270"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-422"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682855272"><span class="annot"><span class="annottext">RealReg
</span><a href="#local-6989586621682855272"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RealReg -&gt; Reg
</span><a href="GHC.Platform.Reg.html#RegReal"><span class="hs-identifier hs-var">RegReal</span></a></span><span> </span><span class="annot"><span class="annottext">(RealReg -&gt; Reg) -&gt; RealReg -&gt; Reg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RealReg
</span><a href="#local-6989586621682855272"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-423"></span><span>        </span><span class="annot"><span class="annottext">Maybe RealReg
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Reg
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getRegisterReg-memory&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmReg -&gt; SDoc) -&gt; CmmReg -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GlobalRegUse -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRegUse
</span><a href="#local-6989586621682855270"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>        </span><span class="hs-comment">-- By this stage, the only MagicIds remaining should be the</span><span>
</span><span id="line-425"></span><span>        </span><span class="hs-comment">-- ones which map to a real machine register on this</span><span>
</span><span id="line-426"></span><span>        </span><span class="hs-comment">-- platform.  Hence ...</span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="annot"><span class="hs-comment">-- | Memory addressing modes passed up the tree.</span></span><span>
</span><span id="line-429"></span><span class="hs-keyword">data</span><span> </span><span id="Amode"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-var">Amode</span></a></span></span><span>
</span><span id="line-430"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span id="Amode"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-var">Amode</span></a></span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrMode"><span class="hs-identifier hs-type">AddrMode</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="hs-comment">{-
Now, given a tree (the argument to a CmmLoad) that references memory,
produce a suitable addressing mode.

A Rule of the Game (tm) for Amodes: use of the addr bit must
immediately follow use of the code part, since the code part puts
values in registers which the addr then refers to.  So you can't put
anything in between, lest it overwrite some of those registers.  If
you need to do some other computation between the code part and use of
the addr bit, first store the effective address from the amode in a
temporary, then do the other computation, and then use the temporary:

    code
    LEA amode, tmp
    ... other computation ...
    ... (tmp) ...
-}</span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span class="hs-comment">{-
Note [%rip-relative addressing on x86-64]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
On x86-64 GHC produces code for use in the &quot;small&quot; or, when `-fPIC` is set,
&quot;small PIC&quot; code models defined by the x86-64 System V ABI (section 3.5.1 of
specification version 0.99).

In general the small code model would allow us to assume that code is located
between 0 and 2^31 - 1. However, this is not true on Windows which, due to
high-entropy ASLR, may place the executable image anywhere in 64-bit address
space. This is problematic since immediate operands in x86-64 are generally
32-bit sign-extended values (with the exception of the 64-bit MOVABS encoding).
Consequently, to avoid overflowing we use %rip-relative addressing universally.
Since %rip-relative addressing comes essentially for free and makes linking far
easier, we use it even on non-Windows platforms.

See also: the documentation for GCC's `-mcmodel=small` flag.
-}</span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="hs-comment">-- | Check whether an integer will fit in 32 bits.</span><span>
</span><span id="line-471"></span><span class="hs-comment">--      A CmmInt is intended to be truncated to the appropriate</span><span>
</span><span id="line-472"></span><span class="hs-comment">--      number of bits, so here we truncate it to Int64.  This is</span><span>
</span><span id="line-473"></span><span class="hs-comment">--      important because e.g. -1 as a CmmInt might be either</span><span>
</span><span id="line-474"></span><span class="hs-comment">--      -1 or 18446744073709551615.</span><span>
</span><span id="line-475"></span><span class="hs-comment">--</span><span>
</span><span id="line-476"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-type">is32BitInteger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-477"></span><span id="is32BitInteger"><span class="annot"><span class="annottext">is32BitInteger :: Integer -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-var hs-var">is32BitInteger</span></a></span></span><span> </span><span id="local-6989586621682855276"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682855276"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621682855277"><span class="hs-identifier hs-var">i64</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0x7fffffff</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621682855277"><span class="hs-identifier hs-var">i64</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0x80000000</span></span><span>
</span><span id="line-478"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682855277"><span class="annot"><span class="annottext">i64 :: Int64
</span><a href="#local-6989586621682855277"><span class="hs-identifier hs-var hs-var">i64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682855276"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span class="annot"><span class="hs-comment">-- | Convert a BlockId to some CmmStatic data</span></span><span>
</span><span id="line-482"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#jumpTableEntry"><span class="hs-identifier hs-type">jumpTableEntry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.html#CmmStatic"><span class="hs-identifier hs-type">CmmStatic</span></a></span><span>
</span><span id="line-483"></span><span id="jumpTableEntry"><span class="annot"><span class="annottext">jumpTableEntry :: NCGConfig -&gt; Maybe Label -&gt; CmmStatic
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#jumpTableEntry"><span class="hs-identifier hs-var hs-var">jumpTableEntry</span></a></span></span><span> </span><span id="local-6989586621682855280"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682855280"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Label
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmStatic
</span><a href="GHC.Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NCGConfig -&gt; Width
</span><a href="GHC.CmmToAsm.Config.html#ncgWordWidth"><span class="hs-identifier hs-var">ncgWordWidth</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682855280"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#jumpTableEntry"><span class="hs-identifier hs-var">jumpTableEntry</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682855284"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855284"><span class="hs-identifier hs-var">blockid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmStatic
</span><a href="GHC.Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682855286"><span class="hs-identifier hs-var">blockLabel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682855286"><span class="annot"><span class="annottext">blockLabel :: CLabel
</span><a href="#local-6989586621682855286"><span class="hs-identifier hs-var hs-var">blockLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; CLabel
</span><a href="GHC.Cmm.BlockId.html#blockLbl"><span class="hs-identifier hs-var">blockLbl</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855284"><span class="hs-identifier hs-var">blockid</span></a></span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- General things for putting together code sequences</span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="hs-comment">-- Expand CmmRegOff.  ToDo: should we do it this way around, or convert</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- CmmExprs into CmmRegOff?</span><span>
</span><span id="line-493"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#mangleIndexTree"><span class="hs-identifier hs-type">mangleIndexTree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-494"></span><span id="mangleIndexTree"><span class="annot"><span class="annottext">mangleIndexTree :: CmmReg -&gt; Int -&gt; CmmExpr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#mangleIndexTree"><span class="hs-identifier hs-var hs-var">mangleIndexTree</span></a></span></span><span> </span><span id="local-6989586621682855289"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682855289"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682855290"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682855290"><span class="hs-identifier hs-var">off</span></a></span></span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-var">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682855293"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmReg -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682855289"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682855290"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682855293"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-496"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682855293"><span class="annot"><span class="annottext">width :: Width
</span><a href="#local-6989586621682855293"><span class="hs-identifier hs-var hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682855289"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="hs-comment">-- | The dual to getAnyReg: compute an expression into a register, but</span><span>
</span><span id="line-499"></span><span class="hs-comment">--      we don't mind which one it is.</span><span>
</span><span id="line-500"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span id="getSomeReg"><span class="annot"><span class="annottext">getSomeReg :: CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var hs-var">getSomeReg</span></a></span></span><span> </span><span id="local-6989586621682855298"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855298"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-502"></span><span>  </span><span id="local-6989586621682855299"><span class="annot"><a href="#local-6989586621682855299"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM Register
CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister"><span class="hs-identifier hs-var">getRegister</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855298"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-503"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682855299"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-504"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span id="local-6989586621682855301"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682855301"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682855302"><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682855302"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-505"></span><span>        </span><span id="local-6989586621682855303"><span class="annot"><a href="#local-6989586621682855303"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682855301"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-506"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682855303"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682855302"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855303"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682855304"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855304"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682855305"><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855305"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-508"></span><span>        </span><span class="annot"><span class="annottext">(Reg, InstrBlock) -&gt; NatM (Reg, InstrBlock)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855304"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855305"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_I64Code"><span class="hs-identifier hs-type">assignMem_I64Code</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-511"></span><span id="assignMem_I64Code"><span class="annot"><span class="annottext">assignMem_I64Code :: CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_I64Code"><span class="hs-identifier hs-var hs-var">assignMem_I64Code</span></a></span></span><span> </span><span id="local-6989586621682855306"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855306"><span class="hs-identifier hs-var">addrTree</span></a></span></span><span> </span><span id="local-6989586621682855307"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855307"><span class="hs-identifier hs-var">valueTree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-512"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682855308"><span class="annot"><a href="#local-6989586621682855308"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682855309"><span class="annot"><a href="#local-6989586621682855309"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855306"><span class="hs-identifier hs-var">addrTree</span></a></span><span>
</span><span id="line-513"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682855312"><span class="annot"><a href="#local-6989586621682855312"><span class="hs-identifier hs-var">vcode</span></a></span></span><span> </span><span id="local-6989586621682855313"><span class="annot"><a href="#local-6989586621682855313"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682855314"><span class="annot"><a href="#local-6989586621682855314"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855307"><span class="hs-identifier hs-type">valueTree</span></a></span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-515"></span><span>        </span><span class="hs-comment">-- Little-endian store</span><span>
</span><span id="line-516"></span><span>        </span><span id="local-6989586621682855316"><span class="annot"><a href="#local-6989586621682855316"><span class="hs-identifier hs-var hs-var">mov_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855314"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682855308"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>        </span><span id="local-6989586621682855321"><span class="annot"><a href="#local-6989586621682855321"><span class="hs-identifier hs-var hs-var">mov_hi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855313"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AddrMode -&gt; AddrMode
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Int -&gt; Maybe AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#addrOffset"><span class="hs-identifier hs-var">addrOffset</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682855308"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682855312"><span class="hs-identifier hs-type">vcode</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855309"><span class="hs-identifier hs-type">addr_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855316"><span class="hs-identifier hs-type">mov_lo</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855321"><span class="hs-identifier hs-type">mov_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>
</span><span id="line-520"></span><span>
</span><span id="line-521"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_I64Code"><span class="hs-identifier hs-type">assignReg_I64Code</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-522"></span><span id="assignReg_I64Code"><span class="annot"><span class="annottext">assignReg_I64Code :: CmmReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_I64Code"><span class="hs-identifier hs-var hs-var">assignReg_I64Code</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-type">CmmLocal</span></a></span><span> </span><span id="local-6989586621682855325"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682855325"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682855326"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855326"><span class="hs-identifier hs-var">valueTree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-523"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682855327"><span class="annot"><a href="#local-6989586621682855327"><span class="hs-identifier hs-var">vcode</span></a></span></span><span> </span><span id="local-6989586621682855328"><span class="annot"><a href="#local-6989586621682855328"><span class="hs-identifier hs-var">r_src_hi</span></a></span></span><span> </span><span id="local-6989586621682855329"><span class="annot"><a href="#local-6989586621682855329"><span class="hs-identifier hs-var">r_src_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855326"><span class="hs-identifier hs-var">valueTree</span></a></span><span>
</span><span id="line-524"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-525"></span><span>         </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855331"><span class="annot"><a href="#local-6989586621682855331"><span class="hs-identifier hs-var">r_dst_hi</span></a></span></span><span> </span><span id="local-6989586621682855332"><span class="annot"><a href="#local-6989586621682855332"><span class="hs-identifier hs-var">r_dst_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier hs-type">localReg64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855325"><span class="hs-identifier hs-type">dst</span></a></span><span>
</span><span id="line-526"></span><span>         </span><span id="local-6989586621682855333"><span class="annot"><a href="#local-6989586621682855333"><span class="hs-identifier hs-var hs-var">mov_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855329"><span class="hs-identifier hs-var">r_src_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855332"><span class="hs-identifier hs-var">r_dst_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>         </span><span id="local-6989586621682855334"><span class="annot"><a href="#local-6989586621682855334"><span class="hs-identifier hs-var hs-var">mov_hi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855328"><span class="hs-identifier hs-var">r_src_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855331"><span class="hs-identifier hs-var">r_dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-529"></span><span>        </span><span class="annot"><a href="#local-6989586621682855327"><span class="hs-identifier hs-type">vcode</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855333"><span class="hs-identifier hs-type">mov_lo</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855334"><span class="hs-identifier hs-type">mov_hi</span></a></span><span>
</span><span id="line-530"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_I64Code"><span class="hs-identifier hs-var">assignReg_I64Code</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-533"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; NatM InstrBlock
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;assignReg_I64Code(i386): invalid lvalue&quot;</span></span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span id="iselExpr64"><span class="annot"><span class="annottext">iselExpr64 :: HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var hs-var">iselExpr64</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682855458"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682855458"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-537"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855459"><span class="annot"><a href="#local-6989586621682855459"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682855460"><span class="annot"><a href="#local-6989586621682855460"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Reg64
</span><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-var">getNewReg64</span></a></span><span>
</span><span id="line-538"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-539"></span><span>        </span><span id="local-6989586621682855461"><span class="annot"><a href="#local-6989586621682855461"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682855458"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-540"></span><span>        </span><span id="local-6989586621682855462"><span class="annot"><a href="#local-6989586621682855462"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682855458"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span>        </span><span id="local-6989586621682855464"><span class="annot"><a href="#local-6989586621682855464"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-542"></span><span>                </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682855461"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855460"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-543"></span><span>                </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682855462"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855459"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-545"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855464"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855459"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855460"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682855468"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855468"><span class="hs-identifier hs-var">addrTree</span></a></span></span><span> </span><span id="local-6989586621682855469"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682855469"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-var">isWord64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682855469"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-548"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682855470"><span class="annot"><a href="#local-6989586621682855470"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682855471"><span class="annot"><a href="#local-6989586621682855471"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855468"><span class="hs-identifier hs-var">addrTree</span></a></span><span>
</span><span id="line-549"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855472"><span class="annot"><a href="#local-6989586621682855472"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682855473"><span class="annot"><a href="#local-6989586621682855473"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-550"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-551"></span><span>        </span><span id="local-6989586621682855474"><span class="annot"><a href="#local-6989586621682855474"><span class="hs-identifier hs-var hs-var">mov_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682855470"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855473"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>        </span><span id="local-6989586621682855475"><span class="annot"><a href="#local-6989586621682855475"><span class="hs-identifier hs-var hs-var">mov_hi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AddrMode -&gt; AddrMode
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Int -&gt; Maybe AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#addrOffset"><span class="hs-identifier hs-var">addrOffset</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682855470"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855472"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-554"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682855471"><span class="hs-identifier hs-type">addr_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855474"><span class="hs-identifier hs-type">mov_lo</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855475"><span class="hs-identifier hs-type">mov_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682855472"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855473"><span class="hs-identifier hs-type">rlo</span></a></span><span>
</span><span id="line-555"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-type">CmmLocal</span></a></span><span> </span><span id="local-6989586621682855476"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682855476"><span class="hs-identifier hs-var">local_reg</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-558"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855477"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855477"><span class="hs-identifier hs-var">hi</span></a></span></span><span> </span><span id="local-6989586621682855478"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855478"><span class="hs-identifier hs-var">lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LocalReg -&gt; Reg64
LocalReg -&gt; Reg64
</span><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier hs-var">localReg64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682855476"><span class="hs-identifier hs-var">local_reg</span></a></span><span>
</span><span id="line-559"></span><span>  </span><span class="annot"><span class="annottext">RegCode64 InstrBlock -&gt; NatM (RegCode64 InstrBlock)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstrBlock -&gt; Reg -&gt; Reg -&gt; RegCode64 InstrBlock
forall code. code -&gt; Reg -&gt; Reg -&gt; RegCode64 code
</span><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-var">RegCode64</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855477"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855478"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855479"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855479"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682855480"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682855480"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-562"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682855481"><span class="annot"><a href="#local-6989586621682855481"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682855482"><span class="annot"><a href="#local-6989586621682855482"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682855483"><span class="annot"><a href="#local-6989586621682855483"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855479"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-563"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855484"><span class="annot"><a href="#local-6989586621682855484"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682855485"><span class="annot"><a href="#local-6989586621682855485"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-564"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-565"></span><span>        </span><span id="local-6989586621682855486"><span class="annot"><a href="#local-6989586621682855486"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682855480"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>        </span><span id="local-6989586621682855487"><span class="annot"><a href="#local-6989586621682855487"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682855480"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span>        </span><span id="local-6989586621682855488"><span class="annot"><a href="#local-6989586621682855488"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855481"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-568"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855483"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855485"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-569"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682855486"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855485"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-570"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855482"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855484"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-571"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADC"><span class="hs-identifier hs-var">ADC</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682855487"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855484"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-572"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855488"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855484"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855485"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855491"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855491"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855492"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855492"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-575"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682855493"><span class="annot"><a href="#local-6989586621682855493"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682855494"><span class="annot"><a href="#local-6989586621682855494"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682855495"><span class="annot"><a href="#local-6989586621682855495"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855491"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-576"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682855496"><span class="annot"><a href="#local-6989586621682855496"><span class="hs-identifier hs-var">code2</span></a></span></span><span> </span><span id="local-6989586621682855497"><span class="annot"><a href="#local-6989586621682855497"><span class="hs-identifier hs-var">r2hi</span></a></span></span><span> </span><span id="local-6989586621682855498"><span class="annot"><a href="#local-6989586621682855498"><span class="hs-identifier hs-var">r2lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855492"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-577"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855499"><span class="annot"><a href="#local-6989586621682855499"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682855500"><span class="annot"><a href="#local-6989586621682855500"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-578"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-579"></span><span>        </span><span id="local-6989586621682855501"><span class="annot"><a href="#local-6989586621682855501"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855493"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-580"></span><span>                </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855496"><span class="hs-identifier hs-var">code2</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-581"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855495"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855500"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-582"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855498"><span class="hs-identifier hs-var">r2lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855500"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-583"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855494"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855499"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-584"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADC"><span class="hs-identifier hs-var">ADC</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855497"><span class="hs-identifier hs-var">r2hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855499"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-585"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855501"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855499"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855500"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Sub"><span class="hs-identifier hs-type">MO_Sub</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855503"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855503"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855504"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855504"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-588"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682855505"><span class="annot"><a href="#local-6989586621682855505"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682855506"><span class="annot"><a href="#local-6989586621682855506"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682855507"><span class="annot"><a href="#local-6989586621682855507"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855503"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-589"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682855508"><span class="annot"><a href="#local-6989586621682855508"><span class="hs-identifier hs-var">code2</span></a></span></span><span> </span><span id="local-6989586621682855509"><span class="annot"><a href="#local-6989586621682855509"><span class="hs-identifier hs-var">r2hi</span></a></span></span><span> </span><span id="local-6989586621682855510"><span class="annot"><a href="#local-6989586621682855510"><span class="hs-identifier hs-var">r2lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855504"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-590"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855511"><span class="annot"><a href="#local-6989586621682855511"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682855512"><span class="annot"><a href="#local-6989586621682855512"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-591"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-592"></span><span>        </span><span id="local-6989586621682855513"><span class="annot"><a href="#local-6989586621682855513"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855505"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-593"></span><span>                </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855508"><span class="hs-identifier hs-var">code2</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-594"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855507"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855512"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-595"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855510"><span class="hs-identifier hs-var">r2lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855512"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-596"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855506"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855511"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-597"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SBB"><span class="hs-identifier hs-var">SBB</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855509"><span class="hs-identifier hs-var">r2hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855511"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-598"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855513"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855511"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855512"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855519"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855519"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-601"></span><span>     </span><span id="local-6989586621682855520"><span class="annot"><a href="#local-6989586621682855520"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855519"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-602"></span><span>     </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855522"><span class="annot"><a href="#local-6989586621682855522"><span class="hs-identifier hs-var">r_dst_hi</span></a></span></span><span> </span><span id="local-6989586621682855523"><span class="annot"><a href="#local-6989586621682855523"><span class="hs-identifier hs-var">r_dst_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-603"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682855520"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855523"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span>
</span><span id="line-604"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-type">XOR</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855522"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855522"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>                          </span><span class="annot"><a href="#local-6989586621682855522"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span>
</span><span id="line-606"></span><span>                          </span><span class="annot"><a href="#local-6989586621682855523"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855526"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855526"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-609"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621682855527"><span class="annot"><a href="#local-6989586621682855527"><span class="hs-identifier hs-var">rsrc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682855528"><span class="annot"><a href="#local-6989586621682855528"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getByteReg"><span class="hs-identifier hs-var">getByteReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855526"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-610"></span><span>     </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855530"><span class="annot"><a href="#local-6989586621682855530"><span class="hs-identifier hs-var">r_dst_hi</span></a></span></span><span> </span><span id="local-6989586621682855531"><span class="annot"><a href="#local-6989586621682855531"><span class="hs-identifier hs-var">r_dst_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-611"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682855528"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-612"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-type">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855527"><span class="hs-identifier hs-type">rsrc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855531"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-613"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-type">XOR</span></a></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855530"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855530"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>                          </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-615"></span><span>                          </span><span class="annot"><a href="#local-6989586621682855530"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span>
</span><span id="line-616"></span><span>                          </span><span class="annot"><a href="#local-6989586621682855531"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855535"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855535"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-619"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621682855536"><span class="annot"><a href="#local-6989586621682855536"><span class="hs-identifier hs-var">rsrc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682855537"><span class="annot"><a href="#local-6989586621682855537"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getByteReg"><span class="hs-identifier hs-var">getByteReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855535"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-620"></span><span>     </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855538"><span class="annot"><a href="#local-6989586621682855538"><span class="hs-identifier hs-var">r_dst_hi</span></a></span></span><span> </span><span id="local-6989586621682855539"><span class="annot"><a href="#local-6989586621682855539"><span class="hs-identifier hs-var">r_dst_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-621"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682855537"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-622"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855536"><span class="hs-identifier hs-type">rsrc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855539"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-623"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-type">XOR</span></a></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855538"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855538"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>                          </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>                          </span><span class="annot"><a href="#local-6989586621682855538"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span>
</span><span id="line-626"></span><span>                          </span><span class="annot"><a href="#local-6989586621682855539"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855542"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855542"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-629"></span><span>     </span><span id="local-6989586621682855543"><span class="annot"><a href="#local-6989586621682855543"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855542"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-630"></span><span>     </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855544"><span class="annot"><a href="#local-6989586621682855544"><span class="hs-identifier hs-var">r_dst_hi</span></a></span></span><span> </span><span id="local-6989586621682855545"><span class="annot"><a href="#local-6989586621682855545"><span class="hs-identifier hs-var">r_dst_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-631"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682855543"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855545"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span>
</span><span id="line-632"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855545"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span>
</span><span id="line-633"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CLTD"><span class="hs-identifier hs-type">CLTD</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span>
</span><span id="line-634"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855545"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span>
</span><span id="line-635"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-type">edx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855544"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span>                          </span><span class="annot"><a href="#local-6989586621682855544"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span>
</span><span id="line-637"></span><span>                          </span><span class="annot"><a href="#local-6989586621682855545"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span>
</span><span id="line-638"></span><span>
</span><span id="line-639"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855549"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855549"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-640"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621682855550"><span class="annot"><a href="#local-6989586621682855550"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682855551"><span class="annot"><a href="#local-6989586621682855551"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getByteReg"><span class="hs-identifier hs-var">getByteReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855549"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-641"></span><span>     </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855552"><span class="annot"><a href="#local-6989586621682855552"><span class="hs-identifier hs-var">r_dst_hi</span></a></span></span><span> </span><span id="local-6989586621682855553"><span class="annot"><a href="#local-6989586621682855553"><span class="hs-identifier hs-var">r_dst_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-642"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682855551"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-643"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-type">MOVSxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-type">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855550"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-644"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CLTD"><span class="hs-identifier hs-type">CLTD</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-645"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855553"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-646"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-type">edx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855552"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span>                          </span><span class="annot"><a href="#local-6989586621682855552"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span>
</span><span id="line-648"></span><span>                          </span><span class="annot"><a href="#local-6989586621682855553"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span>
</span><span id="line-649"></span><span>
</span><span id="line-650"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855555"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855555"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-651"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621682855556"><span class="annot"><a href="#local-6989586621682855556"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682855557"><span class="annot"><a href="#local-6989586621682855557"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getByteReg"><span class="hs-identifier hs-var">getByteReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855555"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-652"></span><span>     </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855558"><span class="annot"><a href="#local-6989586621682855558"><span class="hs-identifier hs-var">r_dst_hi</span></a></span></span><span> </span><span id="local-6989586621682855559"><span class="annot"><a href="#local-6989586621682855559"><span class="hs-identifier hs-var">r_dst_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-653"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682855557"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-654"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-type">MOVSxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855556"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-655"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CLTD"><span class="hs-identifier hs-type">CLTD</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-656"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855559"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-657"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-type">edx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855558"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span>                          </span><span class="annot"><a href="#local-6989586621682855558"><span class="hs-identifier hs-type">r_dst_hi</span></a></span><span>
</span><span id="line-659"></span><span>                          </span><span class="annot"><a href="#local-6989586621682855559"><span class="hs-identifier hs-type">r_dst_lo</span></a></span><span>
</span><span id="line-660"></span><span>
</span><span id="line-661"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Neg"><span class="hs-identifier hs-type">MO_S_Neg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855561"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855561"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-662"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682855562"><span class="annot"><a href="#local-6989586621682855562"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682855563"><span class="annot"><a href="#local-6989586621682855563"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682855564"><span class="annot"><a href="#local-6989586621682855564"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855561"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-663"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855565"><span class="annot"><a href="#local-6989586621682855565"><span class="hs-identifier hs-var">rohi</span></a></span></span><span> </span><span id="local-6989586621682855566"><span class="annot"><a href="#local-6989586621682855566"><span class="hs-identifier hs-var">rolo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-664"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-665"></span><span>        </span><span id="local-6989586621682855567"><span class="annot"><a href="#local-6989586621682855567"><span class="hs-identifier hs-var hs-var">ocode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855562"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-666"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855564"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855566"><span class="hs-identifier hs-var">rolo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-667"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855565"><span class="hs-identifier hs-var">rohi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855565"><span class="hs-identifier hs-var">rohi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-668"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEGI"><span class="hs-identifier hs-var">NEGI</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855566"><span class="hs-identifier hs-var">rolo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-669"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SBB"><span class="hs-identifier hs-var">SBB</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855563"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855565"><span class="hs-identifier hs-var">rohi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-670"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855567"><span class="hs-identifier hs-type">ocode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855565"><span class="hs-identifier hs-type">rohi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855566"><span class="hs-identifier hs-type">rolo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-671"></span><span>
</span><span id="line-672"></span><span class="hs-comment">-- To multiply two 64-bit numbers we use the following decomposition (in C notation):</span><span>
</span><span id="line-673"></span><span class="hs-comment">--</span><span>
</span><span id="line-674"></span><span class="hs-comment">--     ((r1hi &lt;&lt; 32) + r1lo) * ((r2hi &lt;&lt; 32) + r2lo)</span><span>
</span><span id="line-675"></span><span class="hs-comment">--      = ((r2lo * r1hi) &lt;&lt; 32)</span><span>
</span><span id="line-676"></span><span class="hs-comment">--      + ((r1lo * r2hi) &lt;&lt; 32)</span><span>
</span><span id="line-677"></span><span class="hs-comment">--      + r1lo * r2lo</span><span>
</span><span id="line-678"></span><span class="hs-comment">--</span><span>
</span><span id="line-679"></span><span class="hs-comment">-- Note that @(r1hi * r2hi) &lt;&lt; 64@ can be dropped because it overflows completely.</span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Mul"><span class="hs-identifier hs-type">MO_Mul</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855570"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855570"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855571"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855571"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-682"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682855572"><span class="annot"><a href="#local-6989586621682855572"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682855573"><span class="annot"><a href="#local-6989586621682855573"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682855574"><span class="annot"><a href="#local-6989586621682855574"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855570"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-683"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682855575"><span class="annot"><a href="#local-6989586621682855575"><span class="hs-identifier hs-var">code2</span></a></span></span><span> </span><span id="local-6989586621682855576"><span class="annot"><a href="#local-6989586621682855576"><span class="hs-identifier hs-var">r2hi</span></a></span></span><span> </span><span id="local-6989586621682855577"><span class="annot"><a href="#local-6989586621682855577"><span class="hs-identifier hs-var">r2lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855571"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-684"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855578"><span class="annot"><a href="#local-6989586621682855578"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682855579"><span class="annot"><a href="#local-6989586621682855579"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-685"></span><span>   </span><span id="local-6989586621682855580"><span class="annot"><a href="#local-6989586621682855580"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span>
</span><span id="line-686"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-687"></span><span>        </span><span id="local-6989586621682855581"><span class="annot"><a href="#local-6989586621682855581"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855572"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-688"></span><span>                </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855575"><span class="hs-identifier hs-var">code2</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-689"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855574"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-690"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855577"><span class="hs-identifier hs-var">r2lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855580"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-691"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855573"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855578"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-692"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IMUL"><span class="hs-identifier hs-var">IMUL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855580"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855578"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-693"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855576"><span class="hs-identifier hs-var">r2hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855579"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-694"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IMUL"><span class="hs-identifier hs-var">IMUL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855579"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-695"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855579"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855578"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-696"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MUL2"><span class="hs-identifier hs-var">MUL2</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855580"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-697"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855578"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-698"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855579"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-699"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-700"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855581"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855578"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855579"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-701"></span><span>
</span><span id="line-702"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_MulMayOflo"><span class="hs-identifier hs-type">MO_S_MulMayOflo</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-703"></span><span>   </span><span class="hs-comment">-- Performance sensitive users won't use 32 bit so let's keep it simple:</span><span>
</span><span id="line-704"></span><span>   </span><span class="hs-comment">-- We always return a (usually false) positive.</span><span>
</span><span id="line-705"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855585"><span class="annot"><a href="#local-6989586621682855585"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682855586"><span class="annot"><a href="#local-6989586621682855586"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Reg64
</span><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-var">getNewReg64</span></a></span><span>
</span><span id="line-706"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682855587"><span class="annot"><a href="#local-6989586621682855587"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>   </span><span class="hs-special">[</span><span>
</span><span id="line-707"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855585"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-708"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855586"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-709"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-710"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855587"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855585"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855586"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>
</span><span id="line-712"></span><span>
</span><span id="line-713"></span><span class="hs-comment">-- To shift a 64-bit number to the left we use the SHLD and SHL instructions.</span><span>
</span><span id="line-714"></span><span class="hs-comment">-- We use SHLD to shift the bits in @rhi@ to the left while copying</span><span>
</span><span id="line-715"></span><span class="hs-comment">-- high bits from @rlo@ to fill the new space in the low bits of @rhi@.</span><span>
</span><span id="line-716"></span><span class="hs-comment">-- That leaves @rlo@ unchanged, so we use SHL to shift the bits of @rlo@ left.</span><span>
</span><span id="line-717"></span><span class="hs-comment">-- However, both these instructions only use the lowest 5 bits from %cl to do</span><span>
</span><span id="line-718"></span><span class="hs-comment">-- their shifting. So if the sixth bit (0x32) is set then we additionally move</span><span>
</span><span id="line-719"></span><span class="hs-comment">-- the contents of @rlo@ to @rhi@ and clear @rlo@.</span><span>
</span><span id="line-720"></span><span>
</span><span id="line-721"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Shl"><span class="hs-identifier hs-type">MO_Shl</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855590"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855590"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855591"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855591"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-722"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682855592"><span class="annot"><a href="#local-6989586621682855592"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682855593"><span class="annot"><a href="#local-6989586621682855593"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682855594"><span class="annot"><a href="#local-6989586621682855594"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855590"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-723"></span><span>   </span><span id="local-6989586621682855595"><span class="annot"><a href="#local-6989586621682855595"><span class="hs-identifier hs-var">code2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855591"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-724"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855596"><span class="annot"><a href="#local-6989586621682855596"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682855597"><span class="annot"><a href="#local-6989586621682855597"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-725"></span><span>   </span><span id="local-6989586621682855598"><span class="annot"><a href="#local-6989586621682855598"><span class="hs-identifier hs-var">lbl1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#newBlockId"><span class="hs-identifier hs-type">newBlockId</span></a></span><span>
</span><span id="line-726"></span><span>   </span><span id="local-6989586621682855600"><span class="annot"><a href="#local-6989586621682855600"><span class="hs-identifier hs-var">lbl2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#newBlockId"><span class="hs-identifier hs-type">newBlockId</span></a></span><span>
</span><span id="line-727"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-728"></span><span>        </span><span id="local-6989586621682855601"><span class="annot"><a href="#local-6989586621682855601"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855592"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-729"></span><span>                </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682855595"><span class="hs-identifier hs-var">code2</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-730"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855594"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855597"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-731"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855593"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855596"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-732"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHLD"><span class="hs-identifier hs-var">SHLD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855597"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855596"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-733"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHL"><span class="hs-identifier hs-var">SHL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855597"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-734"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TEST"><span class="hs-identifier hs-var">TEST</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-735"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855600"><span class="hs-identifier hs-var">lbl2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-736"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855598"><span class="hs-identifier hs-var">lbl1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-737"></span><span>                       </span><span class="annot"><span class="annottext">Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855598"><span class="hs-identifier hs-var">lbl1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-738"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855597"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855596"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-739"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855597"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855597"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-740"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855600"><span class="hs-identifier hs-var">lbl2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-741"></span><span>                       </span><span class="annot"><span class="annottext">Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855600"><span class="hs-identifier hs-var">lbl2</span></a></span><span>
</span><span id="line-742"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-743"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855601"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855596"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855597"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-744"></span><span>
</span><span id="line-745"></span><span class="hs-comment">-- Similar to above, however now we're shifting to the right</span><span>
</span><span id="line-746"></span><span class="hs-comment">-- and we're doing a signed shift which means that @rhi@ needs</span><span>
</span><span id="line-747"></span><span class="hs-comment">-- to be set to either 0 if @rhi@ is positive or 0xffffffff otherwise,</span><span>
</span><span id="line-748"></span><span class="hs-comment">-- and if the sixth bit of %cl is set (so the shift amount is more than 32).</span><span>
</span><span id="line-749"></span><span class="hs-comment">-- To accomplish that we shift @rhi@ by 31.</span><span>
</span><span id="line-750"></span><span>
</span><span id="line-751"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Shr"><span class="hs-identifier hs-type">MO_S_Shr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855610"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855610"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855611"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855611"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-752"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682855612"><span class="annot"><a href="#local-6989586621682855612"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682855613"><span class="annot"><a href="#local-6989586621682855613"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682855614"><span class="annot"><a href="#local-6989586621682855614"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855610"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-753"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621682855615"><span class="annot"><a href="#local-6989586621682855615"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682855616"><span class="annot"><a href="#local-6989586621682855616"><span class="hs-identifier hs-var">code2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855611"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-754"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855617"><span class="annot"><a href="#local-6989586621682855617"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682855618"><span class="annot"><a href="#local-6989586621682855618"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-755"></span><span>   </span><span id="local-6989586621682855619"><span class="annot"><a href="#local-6989586621682855619"><span class="hs-identifier hs-var">lbl1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#newBlockId"><span class="hs-identifier hs-type">newBlockId</span></a></span><span>
</span><span id="line-756"></span><span>   </span><span id="local-6989586621682855620"><span class="annot"><a href="#local-6989586621682855620"><span class="hs-identifier hs-var">lbl2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#newBlockId"><span class="hs-identifier hs-type">newBlockId</span></a></span><span>
</span><span id="line-757"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-758"></span><span>        </span><span id="local-6989586621682855621"><span class="annot"><a href="#local-6989586621682855621"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855612"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-759"></span><span>                </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855616"><span class="hs-identifier hs-var">code2</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-760"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855614"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855618"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-761"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855613"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855617"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-762"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855615"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-763"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHRD"><span class="hs-identifier hs-var">SHRD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855617"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855618"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-764"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SAR"><span class="hs-identifier hs-var">SAR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855617"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-765"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TEST"><span class="hs-identifier hs-var">TEST</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-766"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855620"><span class="hs-identifier hs-var">lbl2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-767"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855619"><span class="hs-identifier hs-var">lbl1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-768"></span><span>                       </span><span class="annot"><span class="annottext">Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855619"><span class="hs-identifier hs-var">lbl1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-769"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855617"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855618"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-770"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SAR"><span class="hs-identifier hs-var">SAR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">31</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855617"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-771"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855620"><span class="hs-identifier hs-var">lbl2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-772"></span><span>                       </span><span class="annot"><span class="annottext">Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855620"><span class="hs-identifier hs-var">lbl2</span></a></span><span>
</span><span id="line-773"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-774"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855621"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855617"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855618"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-775"></span><span>
</span><span id="line-776"></span><span class="hs-comment">-- Similar to the above.</span><span>
</span><span id="line-777"></span><span>
</span><span id="line-778"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Shr"><span class="hs-identifier hs-type">MO_U_Shr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855625"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855625"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855626"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855626"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-779"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682855627"><span class="annot"><a href="#local-6989586621682855627"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682855628"><span class="annot"><a href="#local-6989586621682855628"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682855629"><span class="annot"><a href="#local-6989586621682855629"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855625"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-780"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621682855630"><span class="annot"><a href="#local-6989586621682855630"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682855631"><span class="annot"><a href="#local-6989586621682855631"><span class="hs-identifier hs-var">code2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855626"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-781"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855632"><span class="annot"><a href="#local-6989586621682855632"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682855633"><span class="annot"><a href="#local-6989586621682855633"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-782"></span><span>   </span><span id="local-6989586621682855634"><span class="annot"><a href="#local-6989586621682855634"><span class="hs-identifier hs-var">lbl1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#newBlockId"><span class="hs-identifier hs-type">newBlockId</span></a></span><span>
</span><span id="line-783"></span><span>   </span><span id="local-6989586621682855635"><span class="annot"><a href="#local-6989586621682855635"><span class="hs-identifier hs-var">lbl2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#newBlockId"><span class="hs-identifier hs-type">newBlockId</span></a></span><span>
</span><span id="line-784"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-785"></span><span>        </span><span id="local-6989586621682855636"><span class="annot"><a href="#local-6989586621682855636"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855627"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-786"></span><span>                </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855631"><span class="hs-identifier hs-var">code2</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-787"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855629"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855633"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-788"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855628"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855632"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-789"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855630"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-790"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHRD"><span class="hs-identifier hs-var">SHRD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855632"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855633"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-791"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHR"><span class="hs-identifier hs-var">SHR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855632"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-792"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TEST"><span class="hs-identifier hs-var">TEST</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-793"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855635"><span class="hs-identifier hs-var">lbl2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-794"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855634"><span class="hs-identifier hs-var">lbl1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-795"></span><span>                       </span><span class="annot"><span class="annottext">Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855634"><span class="hs-identifier hs-var">lbl1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-796"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855632"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855633"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-797"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855632"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855632"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-798"></span><span>                       </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855635"><span class="hs-identifier hs-var">lbl2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-799"></span><span>                       </span><span class="annot"><span class="annottext">Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682855635"><span class="hs-identifier hs-var">lbl2</span></a></span><span>
</span><span id="line-800"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-801"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855636"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855632"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855633"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-802"></span><span>
</span><span id="line-803"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_And"><span class="hs-identifier hs-type">MO_And</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855639"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855639"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855640"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855640"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64ParallelBin"><span class="hs-identifier hs-var">iselExpr64ParallelBin</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#AND"><span class="hs-identifier hs-var">AND</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855639"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855640"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-804"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Or"><span class="hs-identifier hs-type">MO_Or</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855644"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855644"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855645"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855645"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64ParallelBin"><span class="hs-identifier hs-var">iselExpr64ParallelBin</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855644"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855645"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-805"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Xor"><span class="hs-identifier hs-type">MO_Xor</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855648"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855648"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682855649"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855649"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64ParallelBin"><span class="hs-identifier hs-var">iselExpr64ParallelBin</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855648"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855649"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-806"></span><span>
</span><span id="line-807"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Not"><span class="hs-identifier hs-type">MO_Not</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682855651"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855651"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-808"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682855652"><span class="annot"><a href="#local-6989586621682855652"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682855653"><span class="annot"><a href="#local-6989586621682855653"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682855654"><span class="annot"><a href="#local-6989586621682855654"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855651"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-809"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855655"><span class="annot"><a href="#local-6989586621682855655"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682855656"><span class="annot"><a href="#local-6989586621682855656"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-810"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-811"></span><span>        </span><span id="local-6989586621682855657"><span class="annot"><a href="#local-6989586621682855657"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855652"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-812"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855654"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855656"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-813"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855653"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855655"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-814"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NOT"><span class="hs-identifier hs-var">NOT</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855656"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-815"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NOT"><span class="hs-identifier hs-var">NOT</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855655"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-816"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-817"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855657"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855655"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855656"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-818"></span><span>
</span><span id="line-819"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmRegOff"><span class="hs-identifier hs-type">CmmRegOff</span></a></span><span> </span><span id="local-6989586621682855660"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682855660"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682855661"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682855661"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; Int -&gt; CmmExpr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#mangleIndexTree"><span class="hs-identifier hs-var">mangleIndexTree</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682855660"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682855661"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-820"></span><span>
</span><span id="line-821"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span id="local-6989586621682855662"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855662"><span class="hs-identifier hs-var">expr</span></a></span></span><span>
</span><span id="line-822"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-823"></span><span>      </span><span id="local-6989586621682855663"><span class="annot"><a href="#local-6989586621682855663"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-824"></span><span>      </span><span class="annot"><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-type">pprPanic</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;iselExpr64(i386)&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-type">pdoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855663"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855662"><span class="hs-identifier hs-type">expr</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%2B%24"><span class="hs-operator hs-type">$+$</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682855662"><span class="hs-identifier hs-type">expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-825"></span><span>
</span><span id="line-826"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64ParallelBin"><span class="hs-identifier hs-type">iselExpr64ParallelBin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-827"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-828"></span><span id="iselExpr64ParallelBin"><span class="annot"><span class="annottext">iselExpr64ParallelBin :: (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64ParallelBin"><span class="hs-identifier hs-var hs-var">iselExpr64ParallelBin</span></a></span></span><span> </span><span id="local-6989586621682855667"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682855667"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682855668"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855668"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621682855669"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855669"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-829"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682855670"><span class="annot"><a href="#local-6989586621682855670"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682855671"><span class="annot"><a href="#local-6989586621682855671"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682855672"><span class="annot"><a href="#local-6989586621682855672"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855668"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-830"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682855673"><span class="annot"><a href="#local-6989586621682855673"><span class="hs-identifier hs-var">code2</span></a></span></span><span> </span><span id="local-6989586621682855674"><span class="annot"><a href="#local-6989586621682855674"><span class="hs-identifier hs-var">r2hi</span></a></span></span><span> </span><span id="local-6989586621682855675"><span class="annot"><a href="#local-6989586621682855675"><span class="hs-identifier hs-var">r2lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855669"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-831"></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682855676"><span class="annot"><a href="#local-6989586621682855676"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682855677"><span class="annot"><a href="#local-6989586621682855677"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span>
</span><span id="line-832"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-833"></span><span>        </span><span id="local-6989586621682855678"><span class="annot"><a href="#local-6989586621682855678"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855670"><span class="hs-identifier hs-var">code1</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-834"></span><span>                </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682855673"><span class="hs-identifier hs-var">code2</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-835"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855672"><span class="hs-identifier hs-var">r1lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855677"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-836"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855671"><span class="hs-identifier hs-var">r1hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855676"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-837"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682855667"><span class="hs-identifier hs-var">op</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855675"><span class="hs-identifier hs-var">r2lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855677"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-838"></span><span>                       </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682855667"><span class="hs-identifier hs-var">op</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855674"><span class="hs-identifier hs-var">r2hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682855676"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-839"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-840"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855678"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855676"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855677"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-841"></span><span>
</span><span id="line-842"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-843"></span><span>
</span><span id="line-844"></span><span class="hs-comment">-- This is a helper data type which helps reduce the code duplication for</span><span>
</span><span id="line-845"></span><span class="hs-comment">-- the code generation of arithmetic operations. This is not specifically</span><span>
</span><span id="line-846"></span><span class="hs-comment">-- targetted for any particular type like Int8, Int32 etc</span><span>
</span><span id="line-847"></span><span class="hs-keyword">data</span><span> </span><span id="VectorArithInstns"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#VectorArithInstns"><span class="hs-identifier hs-var">VectorArithInstns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="VA_Add"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Add"><span class="hs-identifier hs-var">VA_Add</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="VA_Sub"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Sub"><span class="hs-identifier hs-var">VA_Sub</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="VA_Mul"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Mul"><span class="hs-identifier hs-var">VA_Mul</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="VA_Div"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Div"><span class="hs-identifier hs-var">VA_Div</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="VA_Min"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Min"><span class="hs-identifier hs-var">VA_Min</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="VA_Max"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Max"><span class="hs-identifier hs-var">VA_Max</span></a></span></span><span>
</span><span id="line-848"></span><span>
</span><span id="line-849"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister"><span class="hs-identifier hs-type">getRegister</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-850"></span><span id="getRegister"><span class="annot"><span class="annottext">getRegister :: HasDebugCallStack =&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister"><span class="hs-identifier hs-var hs-var">getRegister</span></a></span></span><span> </span><span id="local-6989586621682855689"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682855689"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682855690"><span class="annot"><a href="#local-6989586621682855690"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-851"></span><span>                   </span><span id="local-6989586621682855691"><span class="annot"><a href="#local-6989586621682855691"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-type">is32BitPlatform</span></a></span><span>
</span><span id="line-852"></span><span>                   </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-type">getRegister'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855690"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855691"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682855689"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-853"></span><span>
</span><span id="line-854"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-type">getRegister'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-855"></span><span>
</span><span id="line-856"></span><span id="getRegister%27"><span class="annot"><span class="annottext">getRegister' :: HasDebugCallStack =&gt; Platform -&gt; Bool -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var hs-var">getRegister'</span></a></span></span><span> </span><span id="local-6989586621682856169"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856169"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682856170"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856170"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span id="local-6989586621682856171"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682856171"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-857"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682856171"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-858"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmGlobal"><span class="hs-identifier hs-type">CmmGlobal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-type">GlobalRegUse</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="GHC.Cmm.Reg.html#PicBaseReg"><span class="hs-identifier hs-var">PicBaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-859"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856170"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-860"></span><span>            </span><span class="hs-comment">-- on x86_64, we have %rip for PicBaseReg, but it's not</span><span>
</span><span id="line-861"></span><span>            </span><span class="hs-comment">-- a full-featured register, it can only be used for</span><span>
</span><span id="line-862"></span><span>            </span><span class="hs-comment">-- rip-relative addressing.</span><span>
</span><span id="line-863"></span><span>            </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682856173"><span class="annot"><a href="#local-6989586621682856173"><span class="hs-identifier hs-var">reg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getPicBaseNat"><span class="hs-identifier hs-var">getPicBaseNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Format
</span><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-var">archWordFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856170"><span class="hs-identifier hs-var">is32Bit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-864"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-type">archWordFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856170"><span class="hs-identifier hs-type">is32Bit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682856173"><span class="hs-identifier hs-type">reg'</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-865"></span><span>        </span><span class="annot"><span class="annottext">CmmReg
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-866"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856175"><span class="annot"><span class="annottext">ty :: CmmType
</span><a href="#local-6989586621682856175"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682856171"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-867"></span><span>              </span><span id="local-6989586621682856176"><span class="annot"><span class="annottext">reg_fmt :: Format
</span><a href="#local-6989586621682856176"><span class="hs-identifier hs-var hs-var">reg_fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682856175"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-868"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; InstrBlock -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-var">Fixed</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856176"><span class="hs-identifier hs-var">reg_fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856169"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682856171"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-869"></span><span>
</span><span id="line-870"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682856177"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856177"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682856178"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856178"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmRegOff"><span class="hs-identifier hs-type">CmmRegOff</span></a></span><span> </span><span id="local-6989586621682856179"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682856179"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682856180"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856180"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-871"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Platform -&gt; Bool -&gt; CmmExpr -&gt; NatM Register
Platform -&gt; Bool -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856177"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856178"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; NatM Register) -&gt; CmmExpr -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; Int -&gt; CmmExpr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#mangleIndexTree"><span class="hs-identifier hs-var">mangleIndexTree</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682856179"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856180"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-872"></span><span>
</span><span id="line-873"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682856181"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856181"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682856182"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856182"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_RelaxedRead"><span class="hs-identifier hs-type">MO_RelaxedRead</span></a></span><span> </span><span id="local-6989586621682856184"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856184"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682856185"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856185"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-874"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Platform -&gt; Bool -&gt; CmmExpr -&gt; NatM Register
Platform -&gt; Bool -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856181"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856182"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmType -&gt; AlignmentSpec -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-var">CmmLoad</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856185"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; CmmType
</span><a href="GHC.Cmm.Type.html#cmmBits"><span class="hs-identifier hs-var">cmmBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856184"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="GHC.Cmm.Expr.html#NaturallyAligned"><span class="hs-identifier hs-var">NaturallyAligned</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-875"></span><span>
</span><span id="line-876"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682856188"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856188"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682856189"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856189"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AlignmentCheck"><span class="hs-identifier hs-type">MO_AlignmentCheck</span></a></span><span> </span><span id="local-6989586621682856191"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856191"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682856192"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856192"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-877"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Register -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#addAlignmentCheck"><span class="hs-identifier hs-var">addAlignmentCheck</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856191"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; Register) -&gt; NatM Register -&gt; NatM Register
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Platform -&gt; Bool -&gt; CmmExpr -&gt; NatM Register
Platform -&gt; Bool -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856188"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856189"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856192"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-878"></span><span>
</span><span id="line-879"></span><span class="hs-comment">-- for 32-bit architectures, support some 64 -&gt; 32 bit conversions:</span><span>
</span><span id="line-880"></span><span class="hs-comment">-- TO_W_(x), TO_W_(x &gt;&gt; 32)</span><span>
</span><span id="line-881"></span><span>
</span><span id="line-882"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856194"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856194"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-883"></span><span>                     </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Shr"><span class="hs-identifier hs-type">MO_U_Shr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682856195"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856195"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-884"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856194"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-885"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682856196"><span class="annot"><a href="#local-6989586621682856196"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856197"><span class="annot"><a href="#local-6989586621682856197"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682856198"><span class="annot"><a href="#local-6989586621682856198"><span class="hs-identifier hs-var">_rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856195"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-886"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856197"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856196"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-887"></span><span>
</span><span id="line-888"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856199"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856199"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-889"></span><span>                     </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Shr"><span class="hs-identifier hs-type">MO_U_Shr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682856200"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856200"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-890"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856199"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-891"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682856201"><span class="annot"><a href="#local-6989586621682856201"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856202"><span class="annot"><a href="#local-6989586621682856202"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682856203"><span class="annot"><a href="#local-6989586621682856203"><span class="hs-identifier hs-var">_rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856200"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-892"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856202"><span class="hs-identifier hs-type">rhi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856201"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-893"></span><span>
</span><span id="line-894"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856204"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856204"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682856205"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856205"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-895"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856204"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-896"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682856206"><span class="annot"><a href="#local-6989586621682856206"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856207"><span class="annot"><a href="#local-6989586621682856207"><span class="hs-identifier hs-var">_rhi</span></a></span></span><span> </span><span id="local-6989586621682856208"><span class="annot"><a href="#local-6989586621682856208"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856205"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-897"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856208"><span class="hs-identifier hs-type">rlo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856206"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-898"></span><span>
</span><span id="line-899"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856209"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856209"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682856210"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856210"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-900"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856209"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-901"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682856211"><span class="annot"><a href="#local-6989586621682856211"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856212"><span class="annot"><a href="#local-6989586621682856212"><span class="hs-identifier hs-var">_rhi</span></a></span></span><span> </span><span id="local-6989586621682856213"><span class="annot"><a href="#local-6989586621682856213"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856210"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-902"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856213"><span class="hs-identifier hs-type">rlo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856211"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-903"></span><span>
</span><span id="line-904"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856214"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856214"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682856215"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856215"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-905"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856214"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-906"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682856216"><span class="annot"><a href="#local-6989586621682856216"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856217"><span class="annot"><a href="#local-6989586621682856217"><span class="hs-identifier hs-var">_rhi</span></a></span></span><span> </span><span id="local-6989586621682856218"><span class="annot"><a href="#local-6989586621682856218"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856215"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-907"></span><span>  </span><span id="local-6989586621682856219"><span class="annot"><a href="#local-6989586621682856219"><span class="hs-identifier hs-var">ro</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span>
</span><span id="line-908"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856219"><span class="hs-identifier hs-type">ro</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682856216"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856218"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856219"><span class="hs-identifier hs-type">ro</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-909"></span><span>
</span><span id="line-910"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856220"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856220"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682856221"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856221"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-911"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856220"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-912"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682856222"><span class="annot"><a href="#local-6989586621682856222"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856223"><span class="annot"><a href="#local-6989586621682856223"><span class="hs-identifier hs-var">_rhi</span></a></span></span><span> </span><span id="local-6989586621682856224"><span class="annot"><a href="#local-6989586621682856224"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856221"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-913"></span><span>  </span><span id="local-6989586621682856225"><span class="annot"><a href="#local-6989586621682856225"><span class="hs-identifier hs-var">ro</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-type">II16</span></a></span><span>
</span><span id="line-914"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-type">II16</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856225"><span class="hs-identifier hs-type">ro</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682856222"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-type">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856224"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856225"><span class="hs-identifier hs-type">ro</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-915"></span><span>
</span><span id="line-916"></span><span class="hs-comment">-- catch simple cases of zero- or sign-extended load</span><span>
</span><span id="line-917"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682856226"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856226"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-918"></span><span>  </span><span id="local-6989586621682856227"><span class="annot"><a href="#local-6989586621682856227"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856226"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-919"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856227"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-920"></span><span>
</span><span id="line-921"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682856229"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856229"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-922"></span><span>  </span><span id="local-6989586621682856230"><span class="annot"><a href="#local-6989586621682856230"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856229"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-923"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856230"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-924"></span><span>
</span><span id="line-925"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682856231"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856231"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-926"></span><span>  </span><span id="local-6989586621682856232"><span class="annot"><a href="#local-6989586621682856232"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856231"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-927"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856232"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-928"></span><span>
</span><span id="line-929"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682856233"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856233"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-930"></span><span>  </span><span id="local-6989586621682856234"><span class="annot"><a href="#local-6989586621682856234"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856233"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-931"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856234"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-932"></span><span>
</span><span id="line-933"></span><span class="hs-comment">-- catch simple cases of zero- or sign-extended load</span><span>
</span><span id="line-934"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856235"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856235"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682856236"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856236"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-935"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856235"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-936"></span><span>  </span><span id="local-6989586621682856237"><span class="annot"><a href="#local-6989586621682856237"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856236"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-937"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856237"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-938"></span><span>
</span><span id="line-939"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856239"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856239"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682856240"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856240"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-940"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856239"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-941"></span><span>  </span><span id="local-6989586621682856241"><span class="annot"><a href="#local-6989586621682856241"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856240"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-942"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856241"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-943"></span><span>
</span><span id="line-944"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856242"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856242"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682856243"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856243"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-945"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856242"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-946"></span><span>  </span><span id="local-6989586621682856244"><span class="annot"><a href="#local-6989586621682856244"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856243"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-947"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856244"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-948"></span><span>
</span><span id="line-949"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856245"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856245"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682856246"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856246"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-950"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856245"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-951"></span><span>  </span><span id="local-6989586621682856247"><span class="annot"><a href="#local-6989586621682856247"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856246"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-952"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856247"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-953"></span><span>
</span><span id="line-954"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856248"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856248"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682856249"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856249"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-955"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856248"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-956"></span><span>  </span><span id="local-6989586621682856250"><span class="annot"><a href="#local-6989586621682856250"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856249"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="hs-comment">-- 32-bit loads zero-extend</span><span>
</span><span id="line-957"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856250"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-958"></span><span>
</span><span id="line-959"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856251"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856251"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682856252"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856252"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-960"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856251"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-961"></span><span>  </span><span id="local-6989586621682856253"><span class="annot"><a href="#local-6989586621682856253"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856252"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-962"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856253"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-963"></span><span>
</span><span id="line-964"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856254"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856254"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmGlobal"><span class="hs-identifier hs-type">CmmGlobal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-type">GlobalRegUse</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="GHC.Cmm.Reg.html#PicBaseReg"><span class="hs-identifier hs-var">PicBaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-965"></span><span>                                     </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682856255"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856255"><span class="hs-identifier hs-var">displacement</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-966"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856254"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-967"></span><span>      </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; InstrBlock) -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682856256"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856256"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; InstrBlock) -&gt; Instr -&gt; InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-968"></span><span>        </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LEA"><span class="hs-identifier hs-var">LEA</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#ripRel"><span class="hs-identifier hs-var">ripRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856255"><span class="hs-identifier hs-var">displacement</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856256"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-969"></span><span>
</span><span id="line-970"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682856260"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856260"><span class="hs-identifier hs-var">mop</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-971"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getRegister(x86): nullary MachOp&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; SDoc) -&gt; String -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856260"><span class="hs-identifier hs-var">mop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-972"></span><span>
</span><span id="line-973"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682856261"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856261"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682856262"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682856263"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856263"><span class="hs-identifier hs-var">mop</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682856264"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- unary MachOps</span><span>
</span><span id="line-974"></span><span>    </span><span id="local-6989586621682856265"><span class="annot"><a href="#local-6989586621682856265"><span class="hs-identifier hs-var">avx</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#avxEnabled"><span class="hs-identifier hs-var">avxEnabled</span></a></span><span>
</span><span id="line-975"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682856263"><span class="hs-identifier hs-type">mop</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-976"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Neg"><span class="hs-identifier hs-type">MO_F_Neg</span></a></span><span> </span><span id="local-6989586621682856267"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856267"><span class="hs-identifier hs-var">w</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#sse2NegCode"><span class="hs-identifier hs-var">sse2NegCode</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856267"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-977"></span><span>
</span><span id="line-978"></span><span>
</span><span id="line-979"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Neg"><span class="hs-identifier hs-type">MO_S_Neg</span></a></span><span> </span><span id="local-6989586621682856269"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856269"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Instr) -&gt; Format -&gt; NatM Register
</span><a href="#local-6989586621682856270"><span class="hs-identifier hs-var">triv_ucode</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEGI"><span class="hs-identifier hs-var">NEGI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856269"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-980"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Not"><span class="hs-identifier hs-type">MO_Not</span></a></span><span> </span><span id="local-6989586621682856272"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856272"><span class="hs-identifier hs-var">w</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Instr) -&gt; Format -&gt; NatM Register
</span><a href="#local-6989586621682856270"><span class="hs-identifier hs-var">triv_ucode</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NOT"><span class="hs-identifier hs-var">NOT</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856272"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-981"></span><span>
</span><span id="line-982"></span><span>      </span><span class="hs-comment">-- Nop conversions</span><span>
</span><span id="line-983"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856273"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-984"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856273"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-985"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856273"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-986"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856273"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-987"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856273"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-988"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856273"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-989"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856275"><span class="hs-identifier hs-var">toI16Reg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-990"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856275"><span class="hs-identifier hs-var">toI16Reg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-991"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856275"><span class="hs-identifier hs-var">toI16Reg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-992"></span><span>
</span><span id="line-993"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856276"><span class="hs-identifier hs-var">conversionNop</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-994"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856276"><span class="hs-identifier hs-var">conversionNop</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-995"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856276"><span class="hs-identifier hs-var">conversionNop</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-996"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856275"><span class="hs-identifier hs-var">toI16Reg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-997"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856275"><span class="hs-identifier hs-var">toI16Reg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-998"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856275"><span class="hs-identifier hs-var">toI16Reg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-999"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856273"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1000"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856273"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1001"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856273"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1002"></span><span>
</span><span id="line-1003"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span id="local-6989586621682856277"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856277"><span class="hs-identifier hs-var">rep1</span></a></span></span><span> </span><span id="local-6989586621682856278"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856278"><span class="hs-identifier hs-var">rep2</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856277"><span class="hs-identifier hs-var">rep1</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856278"><span class="hs-identifier hs-var">rep2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856276"><span class="hs-identifier hs-var">conversionNop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856277"><span class="hs-identifier hs-var">rep1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1004"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span id="local-6989586621682856279"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856279"><span class="hs-identifier hs-var">rep1</span></a></span></span><span> </span><span id="local-6989586621682856280"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856280"><span class="hs-identifier hs-var">rep2</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856279"><span class="hs-identifier hs-var">rep1</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856280"><span class="hs-identifier hs-var">rep2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856276"><span class="hs-identifier hs-var">conversionNop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856279"><span class="hs-identifier hs-var">rep1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1005"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span id="local-6989586621682856281"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856281"><span class="hs-identifier hs-var">rep1</span></a></span></span><span> </span><span id="local-6989586621682856282"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856282"><span class="hs-identifier hs-var">rep2</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856281"><span class="hs-identifier hs-var">rep1</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856282"><span class="hs-identifier hs-var">rep2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856276"><span class="hs-identifier hs-var">conversionNop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856281"><span class="hs-identifier hs-var">rep1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1006"></span><span>
</span><span id="line-1007"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FW_Bitcast"><span class="hs-identifier hs-type">MO_FW_Bitcast</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856284"><span class="hs-identifier hs-var">bitcast</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#FF32"><span class="hs-identifier hs-var">FF32</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1008"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_WF_Bitcast"><span class="hs-identifier hs-type">MO_WF_Bitcast</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856284"><span class="hs-identifier hs-var">bitcast</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#FF32"><span class="hs-identifier hs-var">FF32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1009"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FW_Bitcast"><span class="hs-identifier hs-type">MO_FW_Bitcast</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856284"><span class="hs-identifier hs-var">bitcast</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#FF64"><span class="hs-identifier hs-var">FF64</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1010"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_WF_Bitcast"><span class="hs-identifier hs-type">MO_WF_Bitcast</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856284"><span class="hs-identifier hs-var">bitcast</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#FF64"><span class="hs-identifier hs-var">FF64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1011"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_WF_Bitcast"><span class="hs-identifier hs-type">MO_WF_Bitcast</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1012"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FW_Bitcast"><span class="hs-identifier hs-type">MO_FW_Bitcast</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1013"></span><span>
</span><span id="line-1014"></span><span>      </span><span class="hs-comment">-- widenings</span><span>
</span><span id="line-1015"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1016"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1017"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1018"></span><span>
</span><span id="line-1019"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1020"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1021"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1022"></span><span>
</span><span id="line-1023"></span><span>      </span><span class="hs-comment">-- We don't care about the upper bits for MO_XX_Conv, so MOV is enough. However, on 32-bit we</span><span>
</span><span id="line-1024"></span><span>      </span><span class="hs-comment">-- have 8-bit registers only for a few registers (as opposed to x86-64 where every register</span><span>
</span><span id="line-1025"></span><span>      </span><span class="hs-comment">-- has 8-bit version). So for 32-bit code, we'll just zero-extend.</span><span>
</span><span id="line-1026"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>
</span><span id="line-1027"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1028"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1029"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span>
</span><span id="line-1030"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1031"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1032"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1033"></span><span>
</span><span id="line-1034"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1035"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1036"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1037"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1038"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1039"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1040"></span><span>      </span><span class="hs-comment">-- For 32-to-64 bit zero extension, amd64 uses an ordinary movl.</span><span>
</span><span id="line-1041"></span><span>      </span><span class="hs-comment">-- However, we don't want the register allocator to throw it</span><span>
</span><span id="line-1042"></span><span>      </span><span class="hs-comment">-- away as an unnecessary reg-to-reg move, so we keep it in</span><span>
</span><span id="line-1043"></span><span>      </span><span class="hs-comment">-- the form of a movzl and print it as a movl later.</span><span>
</span><span id="line-1044"></span><span>      </span><span class="hs-comment">-- This doesn't apply to MO_XX_Conv since in this case we don't care about</span><span>
</span><span id="line-1045"></span><span>      </span><span class="hs-comment">-- the upper bits. So we can just use MOV.</span><span>
</span><span id="line-1046"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1047"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1048"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var">integerExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1049"></span><span>
</span><span id="line-1050"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FF_Conv"><span class="hs-identifier hs-type">MO_FF_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceFP2FP"><span class="hs-identifier hs-var">coerceFP2FP</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1051"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FF_Conv"><span class="hs-identifier hs-type">MO_FF_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceFP2FP"><span class="hs-identifier hs-var">coerceFP2FP</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1052"></span><span>
</span><span id="line-1053"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FF_Conv"><span class="hs-identifier hs-type">MO_FF_Conv</span></a></span><span> </span><span id="local-6989586621682856292"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856292"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682856293"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856293"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; NatM Register
forall a. Width -&gt; Width -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#invalidConversion"><span class="hs-identifier hs-var">invalidConversion</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856292"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856293"><span class="hs-identifier hs-var">to</span></a></span><span>
</span><span id="line-1054"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span id="local-6989586621682856295"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856295"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682856296"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856296"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; NatM Register
forall a. Width -&gt; Width -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#invalidConversion"><span class="hs-identifier hs-var">invalidConversion</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856295"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856296"><span class="hs-identifier hs-var">to</span></a></span><span>
</span><span id="line-1055"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span id="local-6989586621682856297"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856297"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682856298"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856298"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; NatM Register
forall a. Width -&gt; Width -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#invalidConversion"><span class="hs-identifier hs-var">invalidConversion</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856297"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856298"><span class="hs-identifier hs-var">to</span></a></span><span>
</span><span id="line-1056"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span id="local-6989586621682856299"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856299"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682856300"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856300"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; NatM Register
forall a. Width -&gt; Width -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#invalidConversion"><span class="hs-identifier hs-var">invalidConversion</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856299"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856300"><span class="hs-identifier hs-var">to</span></a></span><span>
</span><span id="line-1057"></span><span>
</span><span id="line-1058"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FS_Truncate"><span class="hs-identifier hs-type">MO_FS_Truncate</span></a></span><span> </span><span id="local-6989586621682856302"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856302"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682856303"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856303"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceFP2Int"><span class="hs-identifier hs-var">coerceFP2Int</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856302"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856303"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1059"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SF_Round"><span class="hs-identifier hs-type">MO_SF_Round</span></a></span><span>    </span><span id="local-6989586621682856306"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856306"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682856307"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856307"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceInt2FP"><span class="hs-identifier hs-var">coerceInt2FP</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856306"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856307"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1060"></span><span>
</span><span id="line-1061"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Neg"><span class="hs-identifier hs-type">MO_VF_Neg</span></a></span><span> </span><span id="local-6989586621682856310"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856310"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682856311"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856311"><span class="hs-identifier hs-var">w</span></a></span></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856265"><span class="hs-identifier hs-var">avx</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856312"><span class="hs-identifier hs-var">vector_float_negate_avx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856310"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856311"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1062"></span><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856313"><span class="hs-identifier hs-var">vector_float_negate_sse</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856310"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856311"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1063"></span><span>      </span><span class="hs-comment">-- SIMD NCG TODO: add integer negation</span><span>
</span><span id="line-1064"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Neg"><span class="hs-identifier hs-type">MO_VS_Neg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; NatM Register
forall a. MachOp -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856263"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1065"></span><span>
</span><span id="line-1066"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Broadcast"><span class="hs-identifier hs-type">MO_VF_Broadcast</span></a></span><span> </span><span id="local-6989586621682856317"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856317"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682856318"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856318"><span class="hs-identifier hs-var">w</span></a></span></span><span>
</span><span id="line-1067"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856265"><span class="hs-identifier hs-var">avx</span></a></span><span>
</span><span id="line-1068"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856319"><span class="hs-identifier hs-var">vector_float_broadcast_avx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856317"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856318"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1069"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1070"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856320"><span class="hs-identifier hs-var">vector_float_broadcast_sse</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856317"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856318"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1071"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Broadcast"><span class="hs-identifier hs-type">MO_V_Broadcast</span></a></span><span> </span><span id="local-6989586621682856322"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856322"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682856323"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856323"><span class="hs-identifier hs-var">w</span></a></span></span><span>
</span><span id="line-1072"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856324"><span class="hs-identifier hs-var">vector_int_broadcast</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856322"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856323"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1073"></span><span>
</span><span id="line-1074"></span><span>      </span><span class="hs-comment">-- Binary MachOps</span><span>
</span><span id="line-1075"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1076"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Sub"><span class="hs-identifier hs-type">MO_Sub</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1077"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Eq"><span class="hs-identifier hs-type">MO_Eq</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1078"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Ne"><span class="hs-identifier hs-type">MO_Ne</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1079"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Mul"><span class="hs-identifier hs-type">MO_Mul</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1080"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_MulMayOflo"><span class="hs-identifier hs-type">MO_S_MulMayOflo</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1081"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Quot"><span class="hs-identifier hs-type">MO_S_Quot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1082"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Rem"><span class="hs-identifier hs-type">MO_S_Rem</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1083"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Quot"><span class="hs-identifier hs-type">MO_U_Quot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1084"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Rem"><span class="hs-identifier hs-type">MO_U_Rem</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1085"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Ge"><span class="hs-identifier hs-type">MO_S_Ge</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1086"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Le"><span class="hs-identifier hs-type">MO_S_Le</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1087"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Gt"><span class="hs-identifier hs-type">MO_S_Gt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1088"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Lt"><span class="hs-identifier hs-type">MO_S_Lt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1089"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Ge"><span class="hs-identifier hs-type">MO_U_Ge</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1090"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Le"><span class="hs-identifier hs-type">MO_U_Le</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1091"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Gt"><span class="hs-identifier hs-type">MO_U_Gt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1092"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Lt"><span class="hs-identifier hs-type">MO_U_Lt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1093"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Add"><span class="hs-identifier hs-type">MO_F_Add</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1094"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Sub"><span class="hs-identifier hs-type">MO_F_Sub</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1095"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Mul"><span class="hs-identifier hs-type">MO_F_Mul</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1096"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Quot"><span class="hs-identifier hs-type">MO_F_Quot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1097"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Eq"><span class="hs-identifier hs-type">MO_F_Eq</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1098"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ne"><span class="hs-identifier hs-type">MO_F_Ne</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1099"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ge"><span class="hs-identifier hs-type">MO_F_Ge</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1100"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Le"><span class="hs-identifier hs-type">MO_F_Le</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1101"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Gt"><span class="hs-identifier hs-type">MO_F_Gt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1102"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Lt"><span class="hs-identifier hs-type">MO_F_Lt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1103"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Min"><span class="hs-identifier hs-type">MO_F_Min</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1104"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Max"><span class="hs-identifier hs-type">MO_F_Max</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1105"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_And"><span class="hs-identifier hs-type">MO_And</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1106"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Or"><span class="hs-identifier hs-type">MO_Or</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1107"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Xor"><span class="hs-identifier hs-type">MO_Xor</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1108"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Shl"><span class="hs-identifier hs-type">MO_Shl</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1109"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Shr"><span class="hs-identifier hs-type">MO_U_Shr</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1110"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Shr"><span class="hs-identifier hs-type">MO_S_Shr</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1111"></span><span>
</span><span id="line-1112"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Extract"><span class="hs-identifier hs-type">MO_V_Extract</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1113"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Add"><span class="hs-identifier hs-type">MO_V_Add</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1114"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Sub"><span class="hs-identifier hs-type">MO_V_Sub</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1115"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Mul"><span class="hs-identifier hs-type">MO_V_Mul</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1116"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Quot"><span class="hs-identifier hs-type">MO_VS_Quot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1117"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Rem"><span class="hs-identifier hs-type">MO_VS_Rem</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1118"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VU_Quot"><span class="hs-identifier hs-type">MO_VU_Quot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1119"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VU_Rem"><span class="hs-identifier hs-type">MO_VU_Rem</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1120"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Shuffle"><span class="hs-identifier hs-type">MO_V_Shuffle</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1121"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Shuffle"><span class="hs-identifier hs-type">MO_VF_Shuffle</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1122"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VU_Min"><span class="hs-identifier hs-type">MO_VU_Min</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1123"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VU_Max"><span class="hs-identifier hs-type">MO_VU_Max</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1124"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Min"><span class="hs-identifier hs-type">MO_VS_Min</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1125"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Max"><span class="hs-identifier hs-type">MO_VS_Max</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1126"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Min"><span class="hs-identifier hs-type">MO_VF_Min</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1127"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Max"><span class="hs-identifier hs-type">MO_VF_Max</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1128"></span><span>
</span><span id="line-1129"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Extract"><span class="hs-identifier hs-type">MO_VF_Extract</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1130"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Add"><span class="hs-identifier hs-type">MO_VF_Add</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1131"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Sub"><span class="hs-identifier hs-type">MO_VF_Sub</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1132"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Mul"><span class="hs-identifier hs-type">MO_VF_Mul</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1133"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Quot"><span class="hs-identifier hs-type">MO_VF_Quot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1134"></span><span>
</span><span id="line-1135"></span><span>      </span><span class="hs-comment">-- Ternary MachOps</span><span>
</span><span id="line-1136"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FMA"><span class="hs-identifier hs-type">MO_FMA</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1137"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Insert"><span class="hs-identifier hs-type">MO_VF_Insert</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1138"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Insert"><span class="hs-identifier hs-type">MO_V_Insert</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1139"></span><span>
</span><span id="line-1140"></span><span>      </span><span class="hs-comment">--_other -&gt; pprPanic &quot;getRegister&quot; (pprMachOp mop)</span><span>
</span><span id="line-1141"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-1142"></span><span>        </span><span class="annot"><a href="#local-6989586621682856270"><span class="hs-identifier hs-type">triv_ucode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1143"></span><span>        </span><span id="local-6989586621682856270"><span class="annot"><span class="annottext">triv_ucode :: (Format -&gt; Operand -&gt; Instr) -&gt; Format -&gt; NatM Register
</span><a href="#local-6989586621682856270"><span class="hs-identifier hs-var hs-var">triv_ucode</span></a></span></span><span> </span><span id="local-6989586621682856375"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856375"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682856376"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856376"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Operand -&gt; Instr) -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialUCode"><span class="hs-identifier hs-var">trivialUCode</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856376"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856375"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856376"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1144"></span><span>
</span><span id="line-1145"></span><span>        </span><span class="hs-comment">-- signed or unsigned extension.</span><span>
</span><span id="line-1146"></span><span>        </span><span class="annot"><a href="#local-6989586621682856289"><span class="hs-identifier hs-type">integerExtend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-1147"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1148"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1149"></span><span>        </span><span id="local-6989586621682856289"><span class="annot"><span class="annottext">integerExtend :: Width
-&gt; Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856289"><span class="hs-identifier hs-var hs-var">integerExtend</span></a></span></span><span> </span><span id="local-6989586621682856378"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856378"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682856379"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856379"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span id="local-6989586621682856380"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856380"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682856381"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856381"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1150"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682856382"><span class="annot"><a href="#local-6989586621682856382"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682856383"><span class="annot"><a href="#local-6989586621682856383"><span class="hs-identifier hs-var">e_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856378"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getByteReg"><span class="hs-identifier hs-var">getByteReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856381"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1151"></span><span>                                          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856381"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1152"></span><span>            </span><span class="hs-keyword">let</span><span>
</span><span id="line-1153"></span><span>                </span><span id="local-6989586621682856384"><span class="annot"><a href="#local-6989586621682856384"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856385"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856385"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1154"></span><span>                  </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856383"><span class="hs-identifier hs-var">e_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1155"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856380"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856378"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856382"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856385"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1156"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856379"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682856384"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1157"></span><span>
</span><span id="line-1158"></span><span>        </span><span class="annot"><a href="#local-6989586621682856284"><span class="hs-identifier hs-type">bitcast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1159"></span><span>        </span><span id="local-6989586621682856284"><span class="annot"><span class="annottext">bitcast :: Format -&gt; Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856284"><span class="hs-identifier hs-var hs-var">bitcast</span></a></span></span><span> </span><span id="local-6989586621682856386"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856386"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span id="local-6989586621682856387"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856387"><span class="hs-identifier hs-var">rfmt</span></a></span></span><span> </span><span id="local-6989586621682856388"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856388"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1160"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682856389"><span class="annot"><a href="#local-6989586621682856389"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856390"><span class="annot"><a href="#local-6989586621682856390"><span class="hs-identifier hs-var">e_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856388"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1161"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856391"><span class="annot"><a href="#local-6989586621682856391"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682856392"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856392"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856390"><span class="hs-identifier hs-var">e_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVD"><span class="hs-identifier hs-var">MOVD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856386"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856389"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856392"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1162"></span><span>             </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856387"><span class="hs-identifier hs-type">rfmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856391"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1163"></span><span>
</span><span id="line-1164"></span><span>        </span><span class="annot"><a href="#local-6989586621682856273"><span class="hs-identifier hs-type">toI8Reg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1165"></span><span>        </span><span id="local-6989586621682856273"><span class="annot"><span class="annottext">toI8Reg :: Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856273"><span class="hs-identifier hs-var hs-var">toI8Reg</span></a></span></span><span> </span><span id="local-6989586621682856394"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856394"><span class="hs-identifier hs-var">new_rep</span></a></span></span><span> </span><span id="local-6989586621682856395"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856395"><span class="hs-identifier hs-var">expr</span></a></span></span><span>
</span><span id="line-1166"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682856396"><span class="annot"><a href="#local-6989586621682856396"><span class="hs-identifier hs-var">codefn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856395"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1167"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856394"><span class="hs-identifier hs-type">new_rep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682856396"><span class="hs-identifier hs-type">codefn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1168"></span><span>                </span><span class="hs-comment">-- HACK: use getAnyReg to get a byte-addressable register.</span><span>
</span><span id="line-1169"></span><span>                </span><span class="hs-comment">-- If the source was a Fixed register, this will add the</span><span>
</span><span id="line-1170"></span><span>                </span><span class="hs-comment">-- mov instruction to put it into the desired destination.</span><span>
</span><span id="line-1171"></span><span>                </span><span class="hs-comment">-- We're assuming that the destination won't be a fixed</span><span>
</span><span id="line-1172"></span><span>                </span><span class="hs-comment">-- non-byte-addressable register; it won't be, because all</span><span>
</span><span id="line-1173"></span><span>                </span><span class="hs-comment">-- fixed registers are word-sized.</span><span>
</span><span id="line-1174"></span><span>
</span><span id="line-1175"></span><span>        </span><span id="local-6989586621682856275"><span class="annot"><span class="annottext">toI16Reg :: Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856275"><span class="hs-identifier hs-var hs-var">toI16Reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856273"><span class="hs-identifier hs-var">toI8Reg</span></a></span><span> </span><span class="hs-comment">-- for now</span><span>
</span><span id="line-1176"></span><span>
</span><span id="line-1177"></span><span>        </span><span class="annot"><a href="#local-6989586621682856276"><span class="hs-identifier hs-type">conversionNop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1178"></span><span>        </span><span id="local-6989586621682856276"><span class="annot"><span class="annottext">conversionNop :: Format -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856276"><span class="hs-identifier hs-var hs-var">conversionNop</span></a></span></span><span> </span><span id="local-6989586621682856397"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856397"><span class="hs-identifier hs-var">new_format</span></a></span></span><span> </span><span id="local-6989586621682856398"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856398"><span class="hs-identifier hs-var">expr</span></a></span></span><span>
</span><span id="line-1179"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682856399"><span class="annot"><a href="#local-6989586621682856399"><span class="hs-identifier hs-var">e_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Platform -&gt; Bool -&gt; CmmExpr -&gt; NatM Register
Platform -&gt; Bool -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856261"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856262"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856398"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1180"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#swizzleRegisterRep"><span class="hs-identifier hs-type">swizzleRegisterRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856399"><span class="hs-identifier hs-type">e_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856397"><span class="hs-identifier hs-type">new_format</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1181"></span><span>
</span><span id="line-1182"></span><span>        </span><span class="annot"><a href="#local-6989586621682856312"><span class="hs-identifier hs-type">vector_float_negate_avx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1183"></span><span>        </span><span id="local-6989586621682856312"><span class="annot"><span class="annottext">vector_float_negate_avx :: Int -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856312"><span class="hs-identifier hs-var hs-var">vector_float_negate_avx</span></a></span></span><span> </span><span id="local-6989586621682856401"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856401"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682856402"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856402"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682856403"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856403"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1184"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621682856404"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span>
</span><span id="line-1185"></span><span>              </span><span class="annot"><a href="#local-6989586621682856405"><span class="hs-identifier hs-type">mask</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span>
</span><span id="line-1186"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621682856404"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856404"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856405"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856405"><span class="hs-identifier hs-var hs-var">mask</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856402"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1187"></span><span>                       </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856401"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtFloat"><span class="hs-identifier hs-var">FmtFloat</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. (Num a, Bits a) =&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#bit"><span class="hs-identifier hs-var">bit</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">31</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856402"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- TODO: these should be negative 0 floating point literals,</span><span>
</span><span id="line-1188"></span><span>                       </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856401"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtDouble"><span class="hs-identifier hs-var">FmtDouble</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. (Num a, Bits a) =&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#bit"><span class="hs-identifier hs-var">bit</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">63</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856402"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- but we don't currently have those in Cmm.</span><span>
</span><span id="line-1189"></span><span>                       </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Format, CmmLit)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AVX floating-point negation: elements must be FF32 or FF64&quot;</span></span><span>
</span><span id="line-1190"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682856410"><span class="annot"><a href="#local-6989586621682856410"><span class="hs-identifier hs-var">maskReg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856411"><span class="annot"><a href="#local-6989586621682856411"><span class="hs-identifier hs-var">maskCode</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmLit -&gt; CmmExpr) -&gt; CmmLit -&gt; CmmExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[CmmLit] -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmVec"><span class="hs-identifier hs-var">CmmVec</span></a></span><span> </span><span class="annot"><span class="annottext">([CmmLit] -&gt; CmmLit) -&gt; [CmmLit] -&gt; CmmLit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; CmmLit -&gt; [CmmLit]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856401"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856405"><span class="hs-identifier hs-var">mask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1191"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682856414"><span class="annot"><a href="#local-6989586621682856414"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856415"><span class="annot"><a href="#local-6989586621682856415"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856403"><span class="hs-identifier hs-type">expr</span></a></span><span>
</span><span id="line-1192"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856416"><span class="annot"><a href="#local-6989586621682856416"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856417"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856417"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856411"><span class="hs-identifier hs-var">maskCode</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1193"></span><span>                         </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856415"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1194"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VMOVU"><span class="hs-identifier hs-var">VMOVU</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856404"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856414"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856417"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1195"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VXOR"><span class="hs-identifier hs-var">VXOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856404"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856410"><span class="hs-identifier hs-var">maskReg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856417"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856417"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1196"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856404"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856416"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1197"></span><span>
</span><span id="line-1198"></span><span>        </span><span class="annot"><a href="#local-6989586621682856313"><span class="hs-identifier hs-type">vector_float_negate_sse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1199"></span><span>        </span><span id="local-6989586621682856313"><span class="annot"><span class="annottext">vector_float_negate_sse :: Int -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856313"><span class="hs-identifier hs-var hs-var">vector_float_negate_sse</span></a></span></span><span> </span><span id="local-6989586621682856420"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856420"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682856421"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856421"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682856422"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856422"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1200"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621682856423"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span>
</span><span id="line-1201"></span><span>              </span><span class="annot"><a href="#local-6989586621682856424"><span class="hs-identifier hs-type">mask</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span>
</span><span id="line-1202"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621682856423"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856423"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856424"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856424"><span class="hs-identifier hs-var hs-var">mask</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856421"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1203"></span><span>                       </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856420"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtFloat"><span class="hs-identifier hs-var">FmtFloat</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. (Num a, Bits a) =&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#bit"><span class="hs-identifier hs-var">bit</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">31</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856421"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Same comment as for vector_float_negate_avx,</span><span>
</span><span id="line-1204"></span><span>                       </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856420"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtDouble"><span class="hs-identifier hs-var">FmtDouble</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. (Num a, Bits a) =&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#bit"><span class="hs-identifier hs-var">bit</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">63</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856421"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- these should be -0.0 CmmFloat values.</span><span>
</span><span id="line-1205"></span><span>                       </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Format, CmmLit)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SSE floating-point negation: elements must be FF32 or FF64&quot;</span></span><span>
</span><span id="line-1206"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682856425"><span class="annot"><a href="#local-6989586621682856425"><span class="hs-identifier hs-var">maskReg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856426"><span class="annot"><a href="#local-6989586621682856426"><span class="hs-identifier hs-var">maskCode</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmLit -&gt; CmmExpr) -&gt; CmmLit -&gt; CmmExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[CmmLit] -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmVec"><span class="hs-identifier hs-var">CmmVec</span></a></span><span> </span><span class="annot"><span class="annottext">([CmmLit] -&gt; CmmLit) -&gt; [CmmLit] -&gt; CmmLit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; CmmLit -&gt; [CmmLit]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856420"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856424"><span class="hs-identifier hs-var">mask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1207"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682856427"><span class="annot"><a href="#local-6989586621682856427"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856428"><span class="annot"><a href="#local-6989586621682856428"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856422"><span class="hs-identifier hs-type">expr</span></a></span><span>
</span><span id="line-1208"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856429"><span class="annot"><a href="#local-6989586621682856429"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856430"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856430"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856426"><span class="hs-identifier hs-var">maskCode</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1209"></span><span>                         </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856428"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1210"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVU"><span class="hs-identifier hs-var">MOVU</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856423"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856427"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856430"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1211"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856423"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856425"><span class="hs-identifier hs-var">maskReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856430"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1212"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856423"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856429"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1213"></span><span>
</span><span id="line-1214"></span><span>        </span><span class="hs-comment">-----------------------</span><span>
</span><span id="line-1215"></span><span>
</span><span id="line-1216"></span><span>        </span><span class="hs-comment">-- TODO: we could use VBROADCASTSS/SD when AVX2 is available.</span><span>
</span><span id="line-1217"></span><span>        </span><span class="annot"><a href="#local-6989586621682856319"><span class="hs-identifier hs-type">vector_float_broadcast_avx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span>
</span><span id="line-1218"></span><span>                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-1219"></span><span>                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1220"></span><span>                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1221"></span><span>        </span><span id="local-6989586621682856319"><span class="annot"><span class="annottext">vector_float_broadcast_avx :: Int -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856319"><span class="hs-identifier hs-var hs-var">vector_float_broadcast_avx</span></a></span></span><span> </span><span id="local-6989586621682856432"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856432"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621682856433"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856433"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682856434"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856434"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1222"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682856435"><span class="annot"><a href="#local-6989586621682856435"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856436"><span class="annot"><a href="#local-6989586621682856436"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856434"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1223"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856437"><span class="annot"><a href="#local-6989586621682856437"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856432"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#floatScalarFormat"><span class="hs-identifier hs-var">floatScalarFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856433"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1224"></span><span>              </span><span id="local-6989586621682856439"><span class="annot"><a href="#local-6989586621682856439"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856437"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856435"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856435"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856435"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-1225"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856437"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856435"><span class="hs-identifier hs-type">dst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682856436"><span class="hs-identifier hs-type">exp</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856439"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1226"></span><span>
</span><span id="line-1227"></span><span>        </span><span class="annot"><a href="#local-6989586621682856320"><span class="hs-identifier hs-type">vector_float_broadcast_sse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span>
</span><span id="line-1228"></span><span>                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-1229"></span><span>                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1230"></span><span>                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1231"></span><span>        </span><span id="local-6989586621682856320"><span class="annot"><span class="annottext">vector_float_broadcast_sse :: Int -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856320"><span class="hs-identifier hs-var hs-var">vector_float_broadcast_sse</span></a></span></span><span> </span><span id="local-6989586621682856441"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856441"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621682856442"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856442"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682856443"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856443"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1232"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682856444"><span class="annot"><a href="#local-6989586621682856444"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856445"><span class="annot"><a href="#local-6989586621682856445"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856443"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1233"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856446"><span class="annot"><a href="#local-6989586621682856446"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856441"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#floatScalarFormat"><span class="hs-identifier hs-var">floatScalarFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856442"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1234"></span><span>              </span><span id="local-6989586621682856447"><span class="annot"><a href="#local-6989586621682856447"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHUF"><span class="hs-identifier hs-var">SHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856446"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856444"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856444"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-1235"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856446"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856444"><span class="hs-identifier hs-type">dst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682856445"><span class="hs-identifier hs-type">exp</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856447"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1236"></span><span>
</span><span id="line-1237"></span><span>        </span><span class="annot"><a href="#local-6989586621682856324"><span class="hs-identifier hs-type">vector_int_broadcast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span>
</span><span id="line-1238"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-1239"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1240"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1241"></span><span>        </span><span id="local-6989586621682856324"><span class="annot"><span class="annottext">vector_int_broadcast :: Int -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856324"><span class="hs-identifier hs-var hs-var">vector_int_broadcast</span></a></span></span><span> </span><span id="local-6989586621682856449"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856449"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span id="local-6989586621682856450"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856450"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1242"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682856451"><span class="annot"><a href="#local-6989586621682856451"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856452"><span class="annot"><a href="#local-6989586621682856452"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856450"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1243"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856454"><span class="annot"><a href="#local-6989586621682856454"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856449"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtInt64"><span class="hs-identifier hs-var">FmtInt64</span></a></span><span>
</span><span id="line-1244"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856454"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682856456"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856456"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856452"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1245"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVD"><span class="hs-identifier hs-var">MOVD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856451"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856456"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1246"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#PUNPCKLQDQ"><span class="hs-identifier hs-var">PUNPCKLQDQ</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856454"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856456"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856456"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1247"></span><span>                                    </span><span class="hs-special">)</span><span>
</span><span id="line-1248"></span><span>        </span><span class="annot"><a href="#local-6989586621682856324"><span class="hs-identifier hs-var">vector_int_broadcast</span></a></span><span> </span><span id="local-6989586621682856458"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856458"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span id="local-6989586621682856459"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856459"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1249"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682856460"><span class="annot"><a href="#local-6989586621682856460"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856461"><span class="annot"><a href="#local-6989586621682856461"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856459"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1250"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856462"><span class="annot"><a href="#local-6989586621682856462"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856458"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtInt32"><span class="hs-identifier hs-var">FmtInt32</span></a></span><span>
</span><span id="line-1251"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856462"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682856464"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856464"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856461"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1252"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVD"><span class="hs-identifier hs-var">MOVD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856460"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856464"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1253"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#PSHUFD"><span class="hs-identifier hs-var">PSHUFD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856462"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x00</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856464"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856464"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1254"></span><span>                                    </span><span class="hs-special">)</span><span>
</span><span id="line-1255"></span><span>        </span><span class="annot"><a href="#local-6989586621682856324"><span class="hs-identifier hs-var">vector_int_broadcast</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1256"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#sorry"><span class="hs-identifier hs-var">sorry</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unsupported Integer vector broadcast operation; please use -fllvm.&quot;</span></span><span>
</span><span id="line-1257"></span><span>
</span><span id="line-1258"></span><span>
</span><span id="line-1259"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682856467"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856467"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682856468"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856468"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682856469"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856469"><span class="hs-identifier hs-var">mop</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682856470"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856471"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- dyadic MachOps</span><span>
</span><span id="line-1260"></span><span>  </span><span id="local-6989586621682856472"><span class="annot"><a href="#local-6989586621682856472"><span class="hs-identifier hs-var">avx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#avxEnabled"><span class="hs-identifier hs-var">avxEnabled</span></a></span><span>
</span><span id="line-1261"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682856469"><span class="hs-identifier hs-type">mop</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1262"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Eq"><span class="hs-identifier hs-type">MO_F_Eq</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltReg"><span class="hs-identifier hs-var">condFltReg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856468"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1263"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ne"><span class="hs-identifier hs-type">MO_F_Ne</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltReg"><span class="hs-identifier hs-var">condFltReg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856468"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1264"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Gt"><span class="hs-identifier hs-type">MO_F_Gt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltReg"><span class="hs-identifier hs-var">condFltReg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856468"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1265"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ge"><span class="hs-identifier hs-type">MO_F_Ge</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltReg"><span class="hs-identifier hs-var">condFltReg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856468"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1266"></span><span>      </span><span class="hs-comment">-- Invert comparison condition and swap operands</span><span>
</span><span id="line-1267"></span><span>      </span><span class="hs-comment">-- See Note [SSE Parity Checks]</span><span>
</span><span id="line-1268"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Lt"><span class="hs-identifier hs-type">MO_F_Lt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltReg"><span class="hs-identifier hs-var">condFltReg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856468"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1269"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Le"><span class="hs-identifier hs-type">MO_F_Le</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltReg"><span class="hs-identifier hs-var">condFltReg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856468"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>   </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1270"></span><span>
</span><span id="line-1271"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Eq"><span class="hs-identifier hs-type">MO_Eq</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1272"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Ne"><span class="hs-identifier hs-type">MO_Ne</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1273"></span><span>
</span><span id="line-1274"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Gt"><span class="hs-identifier hs-type">MO_S_Gt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1275"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Ge"><span class="hs-identifier hs-type">MO_S_Ge</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1276"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Lt"><span class="hs-identifier hs-type">MO_S_Lt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LTT"><span class="hs-identifier hs-var">LTT</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1277"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Le"><span class="hs-identifier hs-type">MO_S_Le</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LE"><span class="hs-identifier hs-var">LE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1278"></span><span>
</span><span id="line-1279"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Gt"><span class="hs-identifier hs-type">MO_U_Gt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GU"><span class="hs-identifier hs-var">GU</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1280"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Ge"><span class="hs-identifier hs-type">MO_U_Ge</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GEU"><span class="hs-identifier hs-var">GEU</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1281"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Lt"><span class="hs-identifier hs-type">MO_U_Lt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LU"><span class="hs-identifier hs-var">LU</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1282"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Le"><span class="hs-identifier hs-type">MO_U_Le</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var">condIntReg</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LEU"><span class="hs-identifier hs-var">LEU</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1283"></span><span>
</span><span id="line-1284"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Add"><span class="hs-identifier hs-type">MO_F_Add</span></a></span><span>  </span><span id="local-6989586621682856484"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856484"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialFCode_sse2"><span class="hs-identifier hs-var">trivialFCode_sse2</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856484"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1285"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Sub"><span class="hs-identifier hs-type">MO_F_Sub</span></a></span><span>  </span><span id="local-6989586621682856486"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856486"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialFCode_sse2"><span class="hs-identifier hs-var">trivialFCode_sse2</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856486"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1286"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Quot"><span class="hs-identifier hs-type">MO_F_Quot</span></a></span><span> </span><span id="local-6989586621682856487"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856487"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialFCode_sse2"><span class="hs-identifier hs-var">trivialFCode_sse2</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856487"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#FDIV"><span class="hs-identifier hs-var">FDIV</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1287"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Mul"><span class="hs-identifier hs-type">MO_F_Mul</span></a></span><span>  </span><span id="local-6989586621682856489"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856489"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialFCode_sse2"><span class="hs-identifier hs-var">trivialFCode_sse2</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856489"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MUL"><span class="hs-identifier hs-var">MUL</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1288"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Min"><span class="hs-identifier hs-type">MO_F_Min</span></a></span><span>  </span><span id="local-6989586621682856491"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856491"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialFCode_sse2"><span class="hs-identifier hs-var">trivialFCode_sse2</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856491"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MinOrMax -&gt; MinMaxType -&gt; Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MINMAX"><span class="hs-identifier hs-var">MINMAX</span></a></span><span> </span><span class="annot"><span class="annottext">MinOrMax
</span><a href="GHC.CmmToAsm.X86.Instr.html#Min"><span class="hs-identifier hs-var">Min</span></a></span><span> </span><span class="annot"><span class="annottext">MinMaxType
</span><a href="GHC.CmmToAsm.X86.Instr.html#FloatMinMax"><span class="hs-identifier hs-var">FloatMinMax</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1289"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Max"><span class="hs-identifier hs-type">MO_F_Max</span></a></span><span>  </span><span id="local-6989586621682856495"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856495"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialFCode_sse2"><span class="hs-identifier hs-var">trivialFCode_sse2</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856495"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MinOrMax -&gt; MinMaxType -&gt; Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MINMAX"><span class="hs-identifier hs-var">MINMAX</span></a></span><span> </span><span class="annot"><span class="annottext">MinOrMax
</span><a href="GHC.CmmToAsm.X86.Instr.html#Max"><span class="hs-identifier hs-var">Max</span></a></span><span> </span><span class="annot"><span class="annottext">MinMaxType
</span><a href="GHC.CmmToAsm.X86.Instr.html#FloatMinMax"><span class="hs-identifier hs-var">FloatMinMax</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1290"></span><span>
</span><span id="line-1291"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span id="local-6989586621682856497"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856497"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856498"><span class="hs-identifier hs-var">add_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856497"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1292"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Sub"><span class="hs-identifier hs-type">MO_Sub</span></a></span><span> </span><span id="local-6989586621682856499"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856499"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856500"><span class="hs-identifier hs-var">sub_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856499"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1293"></span><span>
</span><span id="line-1294"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Quot"><span class="hs-identifier hs-type">MO_S_Quot</span></a></span><span> </span><span id="local-6989586621682856501"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856501"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Bool -&gt; Bool -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856502"><span class="hs-identifier hs-var">div_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856501"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1295"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Rem"><span class="hs-identifier hs-type">MO_S_Rem</span></a></span><span>  </span><span id="local-6989586621682856503"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856503"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Bool -&gt; Bool -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856502"><span class="hs-identifier hs-var">div_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856503"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1296"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Quot"><span class="hs-identifier hs-type">MO_U_Quot</span></a></span><span> </span><span id="local-6989586621682856504"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856504"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Bool -&gt; Bool -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856502"><span class="hs-identifier hs-var">div_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856504"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1297"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Rem"><span class="hs-identifier hs-type">MO_U_Rem</span></a></span><span>  </span><span id="local-6989586621682856505"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856505"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Bool -&gt; Bool -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856502"><span class="hs-identifier hs-var">div_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856505"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1298"></span><span>
</span><span id="line-1299"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_MulMayOflo"><span class="hs-identifier hs-type">MO_S_MulMayOflo</span></a></span><span> </span><span id="local-6989586621682856506"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856506"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856507"><span class="hs-identifier hs-var">imulMayOflo</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856506"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1300"></span><span>
</span><span id="line-1301"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Mul"><span class="hs-identifier hs-type">MO_Mul</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856508"><span class="hs-identifier hs-var">imulW8</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1302"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Mul"><span class="hs-identifier hs-type">MO_Mul</span></a></span><span> </span><span id="local-6989586621682856509"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856509"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr) -&gt; NatM Register
</span><a href="#local-6989586621682856510"><span class="hs-identifier hs-var">triv_op</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856509"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IMUL"><span class="hs-identifier hs-var">IMUL</span></a></span><span>
</span><span id="line-1303"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_And"><span class="hs-identifier hs-type">MO_And</span></a></span><span> </span><span id="local-6989586621682856511"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856511"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr) -&gt; NatM Register
</span><a href="#local-6989586621682856510"><span class="hs-identifier hs-var">triv_op</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856511"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#AND"><span class="hs-identifier hs-var">AND</span></a></span><span>
</span><span id="line-1304"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Or"><span class="hs-identifier hs-type">MO_Or</span></a></span><span>  </span><span id="local-6989586621682856512"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856512"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr) -&gt; NatM Register
</span><a href="#local-6989586621682856510"><span class="hs-identifier hs-var">triv_op</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856512"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a></span><span>
</span><span id="line-1305"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Xor"><span class="hs-identifier hs-type">MO_Xor</span></a></span><span> </span><span id="local-6989586621682856513"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856513"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr) -&gt; NatM Register
</span><a href="#local-6989586621682856510"><span class="hs-identifier hs-var">triv_op</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856513"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span>
</span><span id="line-1306"></span><span>
</span><span id="line-1307"></span><span>        </span><span class="hs-comment">{- Shift ops on x86s have constraints on their source, it
           either has to be Imm, CL or 1
            =&gt; trivialCode is not restrictive enough (sigh.)
        -}</span><span>
</span><span id="line-1311"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Shl"><span class="hs-identifier hs-type">MO_Shl</span></a></span><span> </span><span id="local-6989586621682856514"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856514"><span class="hs-identifier hs-var">rep</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856515"><span class="hs-identifier hs-var">shift_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856514"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHL"><span class="hs-identifier hs-var">SHL</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-comment">{-False-}</span><span>
</span><span id="line-1312"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Shr"><span class="hs-identifier hs-type">MO_U_Shr</span></a></span><span> </span><span id="local-6989586621682856516"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856516"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856515"><span class="hs-identifier hs-var">shift_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856516"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHR"><span class="hs-identifier hs-var">SHR</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-comment">{-False-}</span><span>
</span><span id="line-1313"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Shr"><span class="hs-identifier hs-type">MO_S_Shr</span></a></span><span> </span><span id="local-6989586621682856517"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856517"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856515"><span class="hs-identifier hs-var">shift_code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856517"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SAR"><span class="hs-identifier hs-var">SAR</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-comment">{-False-}</span><span>
</span><span id="line-1314"></span><span>
</span><span id="line-1315"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Shuffle"><span class="hs-identifier hs-type">MO_VF_Shuffle</span></a></span><span> </span><span id="local-6989586621682856518"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856518"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682856519"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856519"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682856520"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682856520"><span class="hs-identifier hs-var">is</span></a></span></span><span>
</span><span id="line-1316"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856518"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBits"><span class="hs-identifier hs-var">widthInBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856519"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">128</span></span><span>
</span><span id="line-1317"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span>
</span><span id="line-1318"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856472"><span class="hs-identifier hs-var">avx</span></a></span><span>
</span><span id="line-1319"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; [Int] -&gt; NatM Register
</span><a href="#local-6989586621682856523"><span class="hs-identifier hs-var">vector_shuffle_float</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856518"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856519"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682856520"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-1320"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1321"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#sorry"><span class="hs-identifier hs-var">sorry</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Please enable the -mavx flag&quot;</span></span><span>
</span><span id="line-1322"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1323"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#sorry"><span class="hs-identifier hs-var">sorry</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Please use -fllvm for wide shuffle instructions&quot;</span></span><span>
</span><span id="line-1324"></span><span>
</span><span id="line-1325"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Extract"><span class="hs-identifier hs-type">MO_VF_Extract</span></a></span><span> </span><span id="local-6989586621682856524"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856524"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856472"><span class="hs-identifier hs-var">avx</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856525"><span class="hs-identifier hs-var">vector_float_extract</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856524"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1326"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856526"><span class="hs-identifier hs-var">vector_float_extract_sse</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856524"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1327"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Extract"><span class="hs-identifier hs-type">MO_VF_Extract</span></a></span><span> </span><span id="local-6989586621682856527"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856527"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856525"><span class="hs-identifier hs-var">vector_float_extract</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856527"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1328"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Extract"><span class="hs-identifier hs-type">MO_VF_Extract</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1329"></span><span>
</span><span id="line-1330"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Extract"><span class="hs-identifier hs-type">MO_V_Extract</span></a></span><span> </span><span id="local-6989586621682856528"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856528"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856529"><span class="hs-identifier hs-var">vector_int_extract_sse</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856528"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1331"></span><span>      </span><span class="hs-comment">-- SIMD NCG TODO: W32, W16, W8</span><span>
</span><span id="line-1332"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Extract"><span class="hs-identifier hs-type">MO_V_Extract</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; NatM Register
forall a. MachOp -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856469"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1333"></span><span>
</span><span id="line-1334"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Add"><span class="hs-identifier hs-type">MO_VF_Add</span></a></span><span> </span><span id="local-6989586621682856530"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856530"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682856531"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856531"><span class="hs-identifier hs-var">w</span></a></span></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856472"><span class="hs-identifier hs-var">avx</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
-&gt; Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856532"><span class="hs-identifier hs-var">vector_float_op_avx</span></a></span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Add"><span class="hs-identifier hs-var">VA_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856530"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856531"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1335"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
-&gt; Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856533"><span class="hs-identifier hs-var">vector_float_op_sse</span></a></span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Add"><span class="hs-identifier hs-var">VA_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856530"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856531"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1336"></span><span>
</span><span id="line-1337"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Sub"><span class="hs-identifier hs-type">MO_VF_Sub</span></a></span><span> </span><span id="local-6989586621682856534"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856534"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682856535"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856535"><span class="hs-identifier hs-var">w</span></a></span></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856472"><span class="hs-identifier hs-var">avx</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
-&gt; Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856532"><span class="hs-identifier hs-var">vector_float_op_avx</span></a></span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Sub"><span class="hs-identifier hs-var">VA_Sub</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856534"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856535"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1338"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
-&gt; Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856533"><span class="hs-identifier hs-var">vector_float_op_sse</span></a></span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Sub"><span class="hs-identifier hs-var">VA_Sub</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856534"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856535"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1339"></span><span>
</span><span id="line-1340"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Mul"><span class="hs-identifier hs-type">MO_VF_Mul</span></a></span><span> </span><span id="local-6989586621682856536"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856536"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682856537"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856537"><span class="hs-identifier hs-var">w</span></a></span></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856472"><span class="hs-identifier hs-var">avx</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
-&gt; Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856532"><span class="hs-identifier hs-var">vector_float_op_avx</span></a></span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Mul"><span class="hs-identifier hs-var">VA_Mul</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856536"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856537"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1341"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
-&gt; Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856533"><span class="hs-identifier hs-var">vector_float_op_sse</span></a></span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Mul"><span class="hs-identifier hs-var">VA_Mul</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856536"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856537"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1342"></span><span>
</span><span id="line-1343"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Quot"><span class="hs-identifier hs-type">MO_VF_Quot</span></a></span><span> </span><span id="local-6989586621682856538"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856538"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682856539"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856539"><span class="hs-identifier hs-var">w</span></a></span></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856472"><span class="hs-identifier hs-var">avx</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
-&gt; Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856532"><span class="hs-identifier hs-var">vector_float_op_avx</span></a></span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Div"><span class="hs-identifier hs-var">VA_Div</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856538"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856539"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1344"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
-&gt; Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856533"><span class="hs-identifier hs-var">vector_float_op_sse</span></a></span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Div"><span class="hs-identifier hs-var">VA_Div</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856538"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856539"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1345"></span><span>
</span><span id="line-1346"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Min"><span class="hs-identifier hs-type">MO_VF_Min</span></a></span><span> </span><span id="local-6989586621682856540"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856540"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682856541"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856541"><span class="hs-identifier hs-var">w</span></a></span></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856472"><span class="hs-identifier hs-var">avx</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
-&gt; Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856532"><span class="hs-identifier hs-var">vector_float_op_avx</span></a></span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Min"><span class="hs-identifier hs-var">VA_Min</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856540"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856541"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1347"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
-&gt; Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856533"><span class="hs-identifier hs-var">vector_float_op_sse</span></a></span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Min"><span class="hs-identifier hs-var">VA_Min</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856540"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856541"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1348"></span><span>
</span><span id="line-1349"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Max"><span class="hs-identifier hs-type">MO_VF_Max</span></a></span><span> </span><span id="local-6989586621682856542"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856542"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682856543"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856543"><span class="hs-identifier hs-var">w</span></a></span></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856472"><span class="hs-identifier hs-var">avx</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
-&gt; Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856532"><span class="hs-identifier hs-var">vector_float_op_avx</span></a></span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Max"><span class="hs-identifier hs-var">VA_Max</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856542"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856543"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1350"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
-&gt; Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856533"><span class="hs-identifier hs-var">vector_float_op_sse</span></a></span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Max"><span class="hs-identifier hs-var">VA_Max</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856542"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856543"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1351"></span><span>
</span><span id="line-1352"></span><span>      </span><span class="hs-comment">-- SIMD NCG TODO: integer vector operations</span><span>
</span><span id="line-1353"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Shuffle"><span class="hs-identifier hs-type">MO_V_Shuffle</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; NatM Register
forall a. MachOp -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856469"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1354"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Add"><span class="hs-identifier hs-type">MO_V_Add</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; NatM Register
forall a. MachOp -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856469"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1355"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Sub"><span class="hs-identifier hs-type">MO_V_Sub</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; NatM Register
forall a. MachOp -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856469"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1356"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Mul"><span class="hs-identifier hs-type">MO_V_Mul</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; NatM Register
forall a. MachOp -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856469"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1357"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Quot"><span class="hs-identifier hs-type">MO_VS_Quot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; NatM Register
forall a. MachOp -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856469"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1358"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Rem"><span class="hs-identifier hs-type">MO_VS_Rem</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; NatM Register
forall a. MachOp -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856469"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1359"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VU_Quot"><span class="hs-identifier hs-type">MO_VU_Quot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; NatM Register
forall a. MachOp -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856469"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1360"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VU_Rem"><span class="hs-identifier hs-type">MO_VU_Rem</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; NatM Register
forall a. MachOp -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856469"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1361"></span><span>
</span><span id="line-1362"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VU_Min"><span class="hs-identifier hs-type">MO_VU_Min</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; NatM Register
forall a. MachOp -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856469"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1363"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VU_Max"><span class="hs-identifier hs-type">MO_VU_Max</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; NatM Register
forall a. MachOp -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856469"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1364"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Min"><span class="hs-identifier hs-type">MO_VS_Min</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; NatM Register
forall a. MachOp -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856469"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1365"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Max"><span class="hs-identifier hs-type">MO_VS_Max</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; NatM Register
forall a. MachOp -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var">needLlvm</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856469"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1366"></span><span>
</span><span id="line-1367"></span><span>      </span><span class="hs-comment">-- Unary MachOps</span><span>
</span><span id="line-1368"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Neg"><span class="hs-identifier hs-type">MO_S_Neg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1369"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Neg"><span class="hs-identifier hs-type">MO_F_Neg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1370"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Not"><span class="hs-identifier hs-type">MO_Not</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1371"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SF_Round"><span class="hs-identifier hs-type">MO_SF_Round</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1372"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FS_Truncate"><span class="hs-identifier hs-type">MO_FS_Truncate</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1373"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1374"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1375"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FF_Conv"><span class="hs-identifier hs-type">MO_FF_Conv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1376"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1377"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_WF_Bitcast"><span class="hs-identifier hs-type">MO_WF_Bitcast</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1378"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FW_Bitcast"><span class="hs-identifier hs-type">MO_FW_Bitcast</span></a></span><span>  </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1379"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_RelaxedRead"><span class="hs-identifier hs-type">MO_RelaxedRead</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1380"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AlignmentCheck"><span class="hs-identifier hs-type">MO_AlignmentCheck</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1381"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VS_Neg"><span class="hs-identifier hs-type">MO_VS_Neg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1382"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Neg"><span class="hs-identifier hs-type">MO_VF_Neg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1383"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Broadcast"><span class="hs-identifier hs-type">MO_V_Broadcast</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1384"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Broadcast"><span class="hs-identifier hs-type">MO_VF_Broadcast</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1385"></span><span>
</span><span id="line-1386"></span><span>      </span><span class="hs-comment">-- Ternary MachOps</span><span>
</span><span id="line-1387"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FMA"><span class="hs-identifier hs-type">MO_FMA</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1388"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Insert"><span class="hs-identifier hs-type">MO_V_Insert</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1389"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Insert"><span class="hs-identifier hs-type">MO_VF_Insert</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM Register
forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var">incorrectOperands</span></a></span><span>
</span><span id="line-1390"></span><span>
</span><span id="line-1391"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1392"></span><span>    </span><span class="hs-comment">--------------------</span><span>
</span><span id="line-1393"></span><span>    </span><span id="local-6989586621682856510"><span class="annot"><span class="annottext">triv_op :: Width -&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr) -&gt; NatM Register
</span><a href="#local-6989586621682856510"><span class="hs-identifier hs-var hs-var">triv_op</span></a></span></span><span> </span><span id="local-6989586621682856544"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856544"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682856545"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856545"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode"><span class="hs-identifier hs-var">trivialCode</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856544"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856547"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856547"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856471"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1394"></span><span>                        </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682856547"><span class="annot"><span class="annottext">op :: Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856547"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856545"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856544"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1395"></span><span>
</span><span id="line-1396"></span><span>    </span><span class="hs-comment">-- Special case for IMUL for bytes, since the result of IMULB will be in</span><span>
</span><span id="line-1397"></span><span>    </span><span class="hs-comment">-- %ax, the split to %dx/%edx/%rdx and %ax/%eax/%rax happens only for wider</span><span>
</span><span id="line-1398"></span><span>    </span><span class="hs-comment">-- values.</span><span>
</span><span id="line-1399"></span><span>    </span><span class="annot"><a href="#local-6989586621682856508"><span class="hs-identifier hs-type">imulW8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1400"></span><span>    </span><span id="local-6989586621682856508"><span class="annot"><span class="annottext">imulW8 :: CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856508"><span class="hs-identifier hs-var hs-var">imulW8</span></a></span></span><span> </span><span id="local-6989586621682856548"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856548"><span class="hs-identifier hs-var">arg_a</span></a></span></span><span> </span><span id="local-6989586621682856549"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856549"><span class="hs-identifier hs-var">arg_b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1401"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682856550"><span class="annot"><a href="#local-6989586621682856550"><span class="hs-identifier hs-var">a_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856551"><span class="annot"><a href="#local-6989586621682856551"><span class="hs-identifier hs-var">a_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856548"><span class="hs-identifier hs-var">arg_a</span></a></span><span>
</span><span id="line-1402"></span><span>        </span><span id="local-6989586621682856552"><span class="annot"><a href="#local-6989586621682856552"><span class="hs-identifier hs-var">b_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856549"><span class="hs-identifier hs-type">arg_b</span></a></span><span>
</span><span id="line-1403"></span><span>
</span><span id="line-1404"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856553"><span class="annot"><a href="#local-6989586621682856553"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856551"><span class="hs-identifier hs-var">a_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682856552"><span class="hs-identifier hs-var">b_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1405"></span><span>                   </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IMUL2"><span class="hs-identifier hs-var">IMUL2</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856555"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856550"><span class="hs-identifier hs-var">a_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1406"></span><span>            </span><span id="local-6989586621682856555"><span class="annot"><a href="#local-6989586621682856555"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>
</span><span id="line-1407"></span><span>
</span><span id="line-1408"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856555"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856553"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1409"></span><span>
</span><span id="line-1410"></span><span>    </span><span class="annot"><a href="#local-6989586621682856507"><span class="hs-identifier hs-type">imulMayOflo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1411"></span><span>    </span><span id="local-6989586621682856507"><span class="annot"><span class="annottext">imulMayOflo :: Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856507"><span class="hs-identifier hs-var hs-var">imulMayOflo</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span id="local-6989586621682856556"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856556"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682856557"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856557"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1412"></span><span>         </span><span class="hs-comment">-- The general case (W16, W32, W64) doesn't work for W8 as its</span><span>
</span><span id="line-1413"></span><span>         </span><span class="hs-comment">-- multiplication doesn't use two registers.</span><span>
</span><span id="line-1414"></span><span>         </span><span class="hs-comment">--</span><span>
</span><span id="line-1415"></span><span>         </span><span class="hs-comment">-- The plan is:</span><span>
</span><span id="line-1416"></span><span>         </span><span class="hs-comment">-- 1. truncate and sign-extend a and b to 8bit width</span><span>
</span><span id="line-1417"></span><span>         </span><span class="hs-comment">-- 2. multiply a' = a * b in 32bit width</span><span>
</span><span id="line-1418"></span><span>         </span><span class="hs-comment">-- 3. copy and sign-extend 8bit from a' to c</span><span>
</span><span id="line-1419"></span><span>         </span><span class="hs-comment">-- 4. compare a' and c: they are equal if there was no overflow</span><span>
</span><span id="line-1420"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621682856558"><span class="annot"><a href="#local-6989586621682856558"><span class="hs-identifier hs-var">a_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856559"><span class="annot"><a href="#local-6989586621682856559"><span class="hs-identifier hs-var">a_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856556"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1421"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621682856560"><span class="annot"><a href="#local-6989586621682856560"><span class="hs-identifier hs-var">b_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856561"><span class="annot"><a href="#local-6989586621682856561"><span class="hs-identifier hs-var">b_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-type">getNonClobberedReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856557"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1422"></span><span>         </span><span class="hs-keyword">let</span><span>
</span><span id="line-1423"></span><span>             </span><span id="local-6989586621682856562"><span class="annot"><a href="#local-6989586621682856562"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856559"><span class="hs-identifier hs-var">a_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856561"><span class="hs-identifier hs-var">b_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1424"></span><span>                        </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-1425"></span><span>                           </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856558"><span class="hs-identifier hs-var">a_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856558"><span class="hs-identifier hs-var">a_reg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1426"></span><span>                           </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856560"><span class="hs-identifier hs-var">b_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856560"><span class="hs-identifier hs-var">b_reg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1427"></span><span>                           </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IMUL"><span class="hs-identifier hs-var">IMUL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856560"><span class="hs-identifier hs-var">b_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856558"><span class="hs-identifier hs-var">a_reg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1428"></span><span>                           </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856558"><span class="hs-identifier hs-var">a_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1429"></span><span>                           </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856558"><span class="hs-identifier hs-var">a_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1430"></span><span>                           </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1431"></span><span>                        </span><span class="hs-special">]</span><span>
</span><span id="line-1432"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856562"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1433"></span><span>    </span><span class="annot"><a href="#local-6989586621682856507"><span class="hs-identifier hs-var">imulMayOflo</span></a></span><span> </span><span id="local-6989586621682856565"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856565"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682856566"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856566"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682856567"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856567"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1434"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621682856568"><span class="annot"><a href="#local-6989586621682856568"><span class="hs-identifier hs-var">a_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856569"><span class="annot"><a href="#local-6989586621682856569"><span class="hs-identifier hs-var">a_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856566"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1435"></span><span>         </span><span id="local-6989586621682856570"><span class="annot"><a href="#local-6989586621682856570"><span class="hs-identifier hs-var">b_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856567"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1436"></span><span>         </span><span class="hs-keyword">let</span><span>
</span><span id="line-1437"></span><span>             </span><span id="local-6989586621682856571"><span class="annot"><a href="#local-6989586621682856571"><span class="hs-identifier hs-var hs-var">shift_amt</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856565"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1438"></span><span>                           </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">15</span></span><span>
</span><span id="line-1439"></span><span>                           </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">31</span></span><span>
</span><span id="line-1440"></span><span>                           </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">63</span></span><span>
</span><span id="line-1441"></span><span>                           </span><span id="local-6989586621682856572"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856572"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;shift_amt: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856572"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1442"></span><span>
</span><span id="line-1443"></span><span>             </span><span id="local-6989586621682856573"><span class="annot"><a href="#local-6989586621682856573"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856565"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-1444"></span><span>             </span><span id="local-6989586621682856574"><span class="annot"><a href="#local-6989586621682856574"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856569"><span class="hs-identifier hs-var">a_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682856570"><span class="hs-identifier hs-var">b_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1445"></span><span>                        </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-1446"></span><span>                           </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IMUL2"><span class="hs-identifier hs-var">IMUL2</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856573"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856568"><span class="hs-identifier hs-var">a_reg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- result in %edx:%eax</span><span>
</span><span id="line-1447"></span><span>                           </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SAR"><span class="hs-identifier hs-var">SAR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856573"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856571"><span class="hs-identifier hs-var">shift_amt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1448"></span><span>                                </span><span class="hs-comment">-- sign extend lower part</span><span>
</span><span id="line-1449"></span><span>                           </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856573"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1450"></span><span>                                </span><span class="hs-comment">-- compare against upper</span><span>
</span><span id="line-1451"></span><span>                           </span><span class="hs-comment">-- eax==0 if high part == sign extended low part</span><span>
</span><span id="line-1452"></span><span>                        </span><span class="hs-special">]</span><span>
</span><span id="line-1453"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856573"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856574"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1454"></span><span>
</span><span id="line-1455"></span><span>    </span><span class="hs-comment">--------------------</span><span>
</span><span id="line-1456"></span><span>    </span><span class="annot"><a href="#local-6989586621682856515"><span class="hs-identifier hs-type">shift_code</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-1457"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1458"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1459"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1460"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1461"></span><span>
</span><span id="line-1462"></span><span>    </span><span class="hs-comment">{- Case1: shift length as immediate -}</span><span>
</span><span id="line-1463"></span><span>    </span><span id="local-6989586621682856515"><span class="annot"><span class="annottext">shift_code :: Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="#local-6989586621682856515"><span class="hs-identifier hs-var hs-var">shift_code</span></a></span></span><span> </span><span id="local-6989586621682856575"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856575"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682856576"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856576"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682856577"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856577"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682856578"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856578"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1464"></span><span>      </span><span class="hs-comment">-- Handle the case of a shift larger than the width of the shifted value.</span><span>
</span><span id="line-1465"></span><span>      </span><span class="hs-comment">-- This is necessary since x86 applies a mask of 0x1f to the shift</span><span>
</span><span id="line-1466"></span><span>      </span><span class="hs-comment">-- amount, meaning that, e.g., `shr 47, $eax` will actually shift by</span><span>
</span><span id="line-1467"></span><span>      </span><span class="hs-comment">-- `47 &amp; 0x1f == 15`. See #20626.</span><span>
</span><span id="line-1468"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682856579"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856579"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856578"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1469"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856579"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBits"><span class="hs-identifier hs-var">widthInBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856575"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1470"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM Register
CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister"><span class="hs-identifier hs-var">getRegister</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; NatM Register) -&gt; CmmExpr -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmLit -&gt; CmmExpr) -&gt; CmmLit -&gt; CmmExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856575"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-1471"></span><span>
</span><span id="line-1472"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1473"></span><span>          </span><span id="local-6989586621682856580"><span class="annot"><a href="#local-6989586621682856580"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856577"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1474"></span><span>          </span><span class="hs-keyword">let</span><span>
</span><span id="line-1475"></span><span>               </span><span id="local-6989586621682856581"><span class="annot"><a href="#local-6989586621682856581"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856575"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-1476"></span><span>               </span><span id="local-6989586621682856582"><span class="annot"><a href="#local-6989586621682856582"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856583"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856583"><span class="hs-identifier hs-var">dst</span></a></span></span><span>
</span><span id="line-1477"></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682856580"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856583"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1478"></span><span>                    </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856576"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856581"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856578"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856583"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1479"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856581"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856582"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1480"></span><span>
</span><span id="line-1481"></span><span>    </span><span class="hs-comment">{- Case2: shift length is complex (non-immediate)
      * y must go in %ecx.
      * we cannot do y first *and* put its result in %ecx, because
        %ecx might be clobbered by x.
      * if we do y second, then x cannot be
        in a clobbered reg.  Also, we cannot clobber x's reg
        with the instruction itself.
      * so we can either:
        - do y first, put its result in a fresh tmp, then copy it to %ecx later
        - do y second and put its result into %ecx.  x gets placed in a fresh
          tmp.  This is likely to be better, because the reg alloc can
          eliminate this reg-&gt;reg move here (it won't eliminate the other one,
          because the move is into the fixed %ecx).
      * in the case of C calls the use of ecx here can interfere with arguments.
        We avoid this with the hack described in Note [Evaluate C-call
        arguments before placing in destination registers]
    -}</span><span>
</span><span id="line-1498"></span><span>    </span><span class="annot"><a href="#local-6989586621682856515"><span class="hs-identifier hs-var">shift_code</span></a></span><span> </span><span id="local-6989586621682856584"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856584"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682856585"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856585"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682856586"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856586"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682856587"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856587"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-comment">{-amount-}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1499"></span><span>        </span><span id="local-6989586621682856588"><span class="annot"><a href="#local-6989586621682856588"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856586"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1500"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856589"><span class="annot"><a href="#local-6989586621682856589"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856584"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-1501"></span><span>        </span><span id="local-6989586621682856590"><span class="annot"><a href="#local-6989586621682856590"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856589"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-1502"></span><span>        </span><span id="local-6989586621682856591"><span class="annot"><a href="#local-6989586621682856591"><span class="hs-identifier hs-var">y_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856587"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-1503"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-1504"></span><span>           </span><span id="local-6989586621682856592"><span class="annot"><a href="#local-6989586621682856592"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682856588"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856590"><span class="hs-identifier hs-var">tmp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1505"></span><span>                  </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682856591"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1506"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856585"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856589"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#ecx"><span class="hs-identifier hs-var">ecx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856590"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1507"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856589"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856590"><span class="hs-identifier hs-type">tmp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856592"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1508"></span><span>
</span><span id="line-1509"></span><span>    </span><span class="hs-comment">--------------------</span><span>
</span><span id="line-1510"></span><span>    </span><span class="annot"><a href="#local-6989586621682856498"><span class="hs-identifier hs-type">add_code</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1511"></span><span>    </span><span id="local-6989586621682856498"><span class="annot"><span class="annottext">add_code :: Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856498"><span class="hs-identifier hs-var hs-var">add_code</span></a></span></span><span> </span><span id="local-6989586621682856593"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856593"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682856594"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856594"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682856595"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856595"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1512"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-var">is32BitInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856595"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1513"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856593"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-comment">-- LEA doesn't support byte size (#18614)</span><span>
</span><span id="line-1514"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; Integer -&gt; NatM Register
</span><a href="#local-6989586621682856597"><span class="hs-identifier hs-var">add_int</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856593"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856594"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856595"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1515"></span><span>    </span><span class="annot"><a href="#local-6989586621682856498"><span class="hs-identifier hs-var">add_code</span></a></span><span> </span><span id="local-6989586621682856598"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856598"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682856599"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856599"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682856600"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856600"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode"><span class="hs-identifier hs-var">trivialCode</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856598"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856601"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856601"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856599"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856600"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1516"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682856601"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682856601"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856598"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-1517"></span><span>    </span><span class="hs-comment">-- TODO: There are other interesting patterns we want to replace</span><span>
</span><span id="line-1518"></span><span>    </span><span class="hs-comment">--     with a LEA, e.g. `(x + offset) + (y &lt;&lt; shift)`.</span><span>
</span><span id="line-1519"></span><span>
</span><span id="line-1520"></span><span>    </span><span class="hs-comment">--------------------</span><span>
</span><span id="line-1521"></span><span>    </span><span class="annot"><a href="#local-6989586621682856500"><span class="hs-identifier hs-type">sub_code</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1522"></span><span>    </span><span id="local-6989586621682856500"><span class="annot"><span class="annottext">sub_code :: Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856500"><span class="hs-identifier hs-var hs-var">sub_code</span></a></span></span><span> </span><span id="local-6989586621682856602"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856602"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682856603"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856603"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682856604"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856604"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1523"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-var">is32BitInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856604"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1524"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856602"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-comment">-- LEA doesn't support byte size (#18614)</span><span>
</span><span id="line-1525"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; Integer -&gt; NatM Register
</span><a href="#local-6989586621682856597"><span class="hs-identifier hs-var">add_int</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856602"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856603"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856604"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1526"></span><span>    </span><span class="annot"><a href="#local-6989586621682856500"><span class="hs-identifier hs-var">sub_code</span></a></span><span> </span><span id="local-6989586621682856605"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856605"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682856606"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856606"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682856607"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856607"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode"><span class="hs-identifier hs-var">trivialCode</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856605"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856605"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856606"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856607"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1527"></span><span>
</span><span id="line-1528"></span><span>    </span><span class="hs-comment">-- our three-operand add instruction:</span><span>
</span><span id="line-1529"></span><span>    </span><span id="local-6989586621682856597"><span class="annot"><span class="annottext">add_int :: Width -&gt; CmmExpr -&gt; Integer -&gt; NatM Register
</span><a href="#local-6989586621682856597"><span class="hs-identifier hs-var hs-var">add_int</span></a></span></span><span> </span><span id="local-6989586621682856611"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856611"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682856612"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856612"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682856613"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856613"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1530"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682856614"><span class="annot"><a href="#local-6989586621682856614"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856615"><span class="annot"><a href="#local-6989586621682856615"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856612"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1531"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-1532"></span><span>            </span><span id="local-6989586621682856616"><span class="annot"><a href="#local-6989586621682856616"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856611"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-1533"></span><span>            </span><span id="local-6989586621682856617"><span class="annot"><a href="#local-6989586621682856617"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856613"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1534"></span><span>            </span><span id="local-6989586621682856618"><span class="annot"><a href="#local-6989586621682856618"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856619"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856619"><span class="hs-identifier hs-var">dst</span></a></span></span><span>
</span><span id="line-1535"></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856615"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1536"></span><span>                 </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LEA"><span class="hs-identifier hs-var">LEA</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856616"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-1537"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856614"><span class="hs-identifier hs-var">x_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span> </span><span class="annot"><span class="annottext">Imm
</span><a href="#local-6989586621682856617"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1538"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856619"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1539"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-1540"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856616"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856618"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1541"></span><span>
</span><span id="line-1542"></span><span>    </span><span class="hs-comment">----------------------</span><span>
</span><span id="line-1543"></span><span>
</span><span id="line-1544"></span><span>    </span><span class="hs-comment">-- See Note [DIV/IDIV for bytes]</span><span>
</span><span id="line-1545"></span><span>    </span><span id="local-6989586621682856502"><span class="annot"><span class="annottext">div_code :: Width -&gt; Bool -&gt; Bool -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856502"><span class="hs-identifier hs-var hs-var">div_code</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span id="local-6989586621682856627"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856627"><span class="hs-identifier hs-var">signed</span></a></span></span><span> </span><span id="local-6989586621682856628"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856628"><span class="hs-identifier hs-var">quotient</span></a></span></span><span> </span><span id="local-6989586621682856629"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856629"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682856630"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856630"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1546"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856631"><span class="annot"><span class="annottext">widen :: MachOp
</span><a href="#local-6989586621682856631"><span class="hs-identifier hs-var hs-var">widen</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856627"><span class="hs-identifier hs-var">signed</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-var">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span>
</span><span id="line-1547"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-var">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span>
</span><span id="line-1548"></span><span>        </span><span class="annot"><span class="annottext">Width -&gt; Bool -&gt; Bool -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856502"><span class="hs-identifier hs-var">div_code</span></a></span><span>
</span><span id="line-1549"></span><span>            </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span>
</span><span id="line-1550"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856627"><span class="hs-identifier hs-var">signed</span></a></span><span>
</span><span id="line-1551"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856628"><span class="hs-identifier hs-var">quotient</span></a></span><span>
</span><span id="line-1552"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856631"><span class="hs-identifier hs-var">widen</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856629"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1553"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856631"><span class="hs-identifier hs-var">widen</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856630"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1554"></span><span>
</span><span id="line-1555"></span><span>    </span><span class="annot"><a href="#local-6989586621682856502"><span class="hs-identifier hs-var">div_code</span></a></span><span> </span><span id="local-6989586621682856632"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856632"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682856633"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856633"><span class="hs-identifier hs-var">signed</span></a></span></span><span> </span><span id="local-6989586621682856634"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856634"><span class="hs-identifier hs-var">quotient</span></a></span></span><span> </span><span id="local-6989586621682856635"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856635"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682856636"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856636"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1556"></span><span>           </span><span class="hs-special">(</span><span id="local-6989586621682856637"><span class="annot"><a href="#local-6989586621682856637"><span class="hs-identifier hs-var">y_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856638"><span class="annot"><a href="#local-6989586621682856638"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegOrMem"><span class="hs-identifier hs-var">getRegOrMem</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856636"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-comment">-- cannot be clobbered</span><span>
</span><span id="line-1557"></span><span>           </span><span id="local-6989586621682856640"><span class="annot"><a href="#local-6989586621682856640"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856635"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-1558"></span><span>           </span><span class="hs-keyword">let</span><span>
</span><span id="line-1559"></span><span>             </span><span id="local-6989586621682856641"><span class="annot"><a href="#local-6989586621682856641"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856632"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-1560"></span><span>             </span><span id="local-6989586621682856642"><span class="annot"><a href="#local-6989586621682856642"><span class="hs-identifier hs-var hs-var">widen</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856633"><span class="hs-identifier hs-var">signed</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CLTD"><span class="hs-identifier hs-var">CLTD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856641"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-1561"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856641"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1562"></span><span>
</span><span id="line-1563"></span><span>             </span><span id="local-6989586621682856643"><span class="annot"><a href="#local-6989586621682856643"><span class="hs-identifier hs-var hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856633"><span class="hs-identifier hs-var">signed</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IDIV"><span class="hs-identifier hs-var">IDIV</span></a></span><span>
</span><span id="line-1564"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#DIV"><span class="hs-identifier hs-var">DIV</span></a></span><span>
</span><span id="line-1565"></span><span>
</span><span id="line-1566"></span><span>             </span><span id="local-6989586621682856646"><span class="annot"><a href="#local-6989586621682856646"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856638"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1567"></span><span>                    </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682856640"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1568"></span><span>                    </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682856642"><span class="hs-identifier hs-var">widen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856643"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856641"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682856637"><span class="hs-identifier hs-var">y_op</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1569"></span><span>
</span><span id="line-1570"></span><span>             </span><span id="local-6989586621682856647"><span class="annot"><a href="#local-6989586621682856647"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856634"><span class="hs-identifier hs-var">quotient</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span>
</span><span id="line-1571"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a></span><span>
</span><span id="line-1572"></span><span>
</span><span id="line-1573"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856641"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856647"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856646"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1574"></span><span>
</span><span id="line-1575"></span><span>    </span><span class="hs-comment">-----------------------</span><span>
</span><span id="line-1576"></span><span>    </span><span class="hs-comment">-- Vector operations---</span><span>
</span><span id="line-1577"></span><span>    </span><span class="annot"><a href="#local-6989586621682856532"><span class="hs-identifier hs-type">vector_float_op_avx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#VectorArithInstns"><span class="hs-identifier hs-type">VectorArithInstns</span></a></span><span>
</span><span id="line-1578"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span>
</span><span id="line-1579"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-1580"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1581"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1582"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1583"></span><span>    </span><span id="local-6989586621682856532"><span class="annot"><span class="annottext">vector_float_op_avx :: VectorArithInstns
-&gt; Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856532"><span class="hs-identifier hs-var hs-var">vector_float_op_avx</span></a></span></span><span> </span><span id="local-6989586621682856648"><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="#local-6989586621682856648"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682856649"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856649"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682856650"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856650"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682856651"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856651"><span class="hs-identifier hs-var">expr1</span></a></span></span><span> </span><span id="local-6989586621682856652"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856652"><span class="hs-identifier hs-var">expr2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1584"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682856653"><span class="annot"><a href="#local-6989586621682856653"><span class="hs-identifier hs-var">reg1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856654"><span class="annot"><a href="#local-6989586621682856654"><span class="hs-identifier hs-var">exp1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856651"><span class="hs-identifier hs-var">expr1</span></a></span><span>
</span><span id="line-1585"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682856655"><span class="annot"><a href="#local-6989586621682856655"><span class="hs-identifier hs-var">reg2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856656"><span class="annot"><a href="#local-6989586621682856656"><span class="hs-identifier hs-var">exp2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856652"><span class="hs-identifier hs-type">expr2</span></a></span><span>
</span><span id="line-1586"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856657"><span class="annot"><a href="#local-6989586621682856657"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856650"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1587"></span><span>                       </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856649"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtFloat"><span class="hs-identifier hs-var">FmtFloat</span></a></span><span>
</span><span id="line-1588"></span><span>                       </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856649"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtDouble"><span class="hs-identifier hs-var">FmtDouble</span></a></span><span>
</span><span id="line-1589"></span><span>                       </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Format
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Floating-point AVX vector operation not supported at this width&quot;</span></span><span>
</span><span id="line-1590"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;width:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856650"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1591"></span><span>          </span><span id="local-6989586621682856658"><span class="annot"><a href="#local-6989586621682856658"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856659"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856659"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="#local-6989586621682856648"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1592"></span><span>            </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Add"><span class="hs-identifier hs-var">VA_Add</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr) -&gt; InstrBlock
</span><a href="#local-6989586621682856660"><span class="hs-identifier hs-var">arithInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VADD"><span class="hs-identifier hs-var">VADD</span></a></span><span>
</span><span id="line-1593"></span><span>            </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Sub"><span class="hs-identifier hs-var">VA_Sub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr) -&gt; InstrBlock
</span><a href="#local-6989586621682856660"><span class="hs-identifier hs-var">arithInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSUB"><span class="hs-identifier hs-var">VSUB</span></a></span><span>
</span><span id="line-1594"></span><span>            </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Mul"><span class="hs-identifier hs-var">VA_Mul</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr) -&gt; InstrBlock
</span><a href="#local-6989586621682856660"><span class="hs-identifier hs-var">arithInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VMUL"><span class="hs-identifier hs-var">VMUL</span></a></span><span>
</span><span id="line-1595"></span><span>            </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Div"><span class="hs-identifier hs-var">VA_Div</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr) -&gt; InstrBlock
</span><a href="#local-6989586621682856660"><span class="hs-identifier hs-var">arithInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VDIV"><span class="hs-identifier hs-var">VDIV</span></a></span><span>
</span><span id="line-1596"></span><span>            </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Min"><span class="hs-identifier hs-var">VA_Min</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr) -&gt; InstrBlock
</span><a href="#local-6989586621682856660"><span class="hs-identifier hs-var">arithInstr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MinOrMax -&gt; MinMaxType -&gt; Format -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VMINMAX"><span class="hs-identifier hs-var">VMINMAX</span></a></span><span> </span><span class="annot"><span class="annottext">MinOrMax
</span><a href="GHC.CmmToAsm.X86.Instr.html#Min"><span class="hs-identifier hs-var">Min</span></a></span><span> </span><span class="annot"><span class="annottext">MinMaxType
</span><a href="GHC.CmmToAsm.X86.Instr.html#FloatMinMax"><span class="hs-identifier hs-var">FloatMinMax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1597"></span><span>            </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Max"><span class="hs-identifier hs-var">VA_Max</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr) -&gt; InstrBlock
</span><a href="#local-6989586621682856660"><span class="hs-identifier hs-var">arithInstr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MinOrMax -&gt; MinMaxType -&gt; Format -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VMINMAX"><span class="hs-identifier hs-var">VMINMAX</span></a></span><span> </span><span class="annot"><span class="annottext">MinOrMax
</span><a href="GHC.CmmToAsm.X86.Instr.html#Max"><span class="hs-identifier hs-var">Max</span></a></span><span> </span><span class="annot"><span class="annottext">MinMaxType
</span><a href="GHC.CmmToAsm.X86.Instr.html#FloatMinMax"><span class="hs-identifier hs-var">FloatMinMax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1598"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-1599"></span><span>              </span><span class="hs-comment">-- opcode src2 src1 dst &lt;==&gt; dst = src1 `opcode` src2</span><span>
</span><span id="line-1600"></span><span>              </span><span id="local-6989586621682856660"><span class="annot"><span class="annottext">arithInstr :: (Format -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr) -&gt; InstrBlock
</span><a href="#local-6989586621682856660"><span class="hs-identifier hs-var hs-var">arithInstr</span></a></span></span><span> </span><span id="local-6989586621682856666"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="#local-6989586621682856666"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856654"><span class="hs-identifier hs-var">exp1</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856656"><span class="hs-identifier hs-var">exp2</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1601"></span><span>                                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="#local-6989586621682856666"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856657"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856655"><span class="hs-identifier hs-var">reg2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856653"><span class="hs-identifier hs-var">reg1</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856659"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1602"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856657"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856658"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1603"></span><span>
</span><span id="line-1604"></span><span>    </span><span class="annot"><a href="#local-6989586621682856533"><span class="hs-identifier hs-type">vector_float_op_sse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#VectorArithInstns"><span class="hs-identifier hs-type">VectorArithInstns</span></a></span><span>
</span><span id="line-1605"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span>
</span><span id="line-1606"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-1607"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1608"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1609"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1610"></span><span>    </span><span id="local-6989586621682856533"><span class="annot"><span class="annottext">vector_float_op_sse :: VectorArithInstns
-&gt; Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856533"><span class="hs-identifier hs-var hs-var">vector_float_op_sse</span></a></span></span><span> </span><span id="local-6989586621682856667"><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="#local-6989586621682856667"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682856668"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856668"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682856669"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856669"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682856670"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856670"><span class="hs-identifier hs-var">expr1</span></a></span></span><span> </span><span id="local-6989586621682856671"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856671"><span class="hs-identifier hs-var">expr2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1611"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682856672"><span class="annot"><a href="#local-6989586621682856672"><span class="hs-identifier hs-var">reg1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856673"><span class="annot"><a href="#local-6989586621682856673"><span class="hs-identifier hs-var">exp1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856670"><span class="hs-identifier hs-var">expr1</span></a></span><span>
</span><span id="line-1612"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682856674"><span class="annot"><a href="#local-6989586621682856674"><span class="hs-identifier hs-var">reg2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856675"><span class="annot"><a href="#local-6989586621682856675"><span class="hs-identifier hs-var">exp2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856671"><span class="hs-identifier hs-type">expr2</span></a></span><span>
</span><span id="line-1613"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856676"><span class="annot"><a href="#local-6989586621682856676"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856669"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1614"></span><span>                       </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856668"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtFloat"><span class="hs-identifier hs-var">FmtFloat</span></a></span><span>
</span><span id="line-1615"></span><span>                       </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856668"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtDouble"><span class="hs-identifier hs-var">FmtDouble</span></a></span><span>
</span><span id="line-1616"></span><span>                       </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Format
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Floating-point SSE vector operation not supported at this width&quot;</span></span><span>
</span><span id="line-1617"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;width:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856669"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1618"></span><span>          </span><span id="local-6989586621682856677"><span class="annot"><a href="#local-6989586621682856677"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856678"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856678"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="#local-6989586621682856667"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1619"></span><span>            </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Add"><span class="hs-identifier hs-var">VA_Add</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Operand -&gt; Instr) -&gt; InstrBlock
</span><a href="#local-6989586621682856679"><span class="hs-identifier hs-var">arithInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span>
</span><span id="line-1620"></span><span>            </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Sub"><span class="hs-identifier hs-var">VA_Sub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Operand -&gt; Instr) -&gt; InstrBlock
</span><a href="#local-6989586621682856679"><span class="hs-identifier hs-var">arithInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span>
</span><span id="line-1621"></span><span>            </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Mul"><span class="hs-identifier hs-var">VA_Mul</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Operand -&gt; Instr) -&gt; InstrBlock
</span><a href="#local-6989586621682856679"><span class="hs-identifier hs-var">arithInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MUL"><span class="hs-identifier hs-var">MUL</span></a></span><span>
</span><span id="line-1622"></span><span>            </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Div"><span class="hs-identifier hs-var">VA_Div</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Operand -&gt; Instr) -&gt; InstrBlock
</span><a href="#local-6989586621682856679"><span class="hs-identifier hs-var">arithInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#FDIV"><span class="hs-identifier hs-var">FDIV</span></a></span><span>
</span><span id="line-1623"></span><span>            </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Min"><span class="hs-identifier hs-var">VA_Min</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Operand -&gt; Instr) -&gt; InstrBlock
</span><a href="#local-6989586621682856679"><span class="hs-identifier hs-var">arithInstr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MinOrMax -&gt; MinMaxType -&gt; Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MINMAX"><span class="hs-identifier hs-var">MINMAX</span></a></span><span> </span><span class="annot"><span class="annottext">MinOrMax
</span><a href="GHC.CmmToAsm.X86.Instr.html#Min"><span class="hs-identifier hs-var">Min</span></a></span><span> </span><span class="annot"><span class="annottext">MinMaxType
</span><a href="GHC.CmmToAsm.X86.Instr.html#FloatMinMax"><span class="hs-identifier hs-var">FloatMinMax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1624"></span><span>            </span><span class="annot"><span class="annottext">VectorArithInstns
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#VA_Max"><span class="hs-identifier hs-var">VA_Max</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Operand -&gt; Instr) -&gt; InstrBlock
</span><a href="#local-6989586621682856679"><span class="hs-identifier hs-var">arithInstr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MinOrMax -&gt; MinMaxType -&gt; Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MINMAX"><span class="hs-identifier hs-var">MINMAX</span></a></span><span> </span><span class="annot"><span class="annottext">MinOrMax
</span><a href="GHC.CmmToAsm.X86.Instr.html#Max"><span class="hs-identifier hs-var">Max</span></a></span><span> </span><span class="annot"><span class="annottext">MinMaxType
</span><a href="GHC.CmmToAsm.X86.Instr.html#FloatMinMax"><span class="hs-identifier hs-var">FloatMinMax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1625"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-1626"></span><span>              </span><span class="hs-comment">-- opcode src2 src1 &lt;==&gt; src1 = src1 `opcode` src2</span><span>
</span><span id="line-1627"></span><span>              </span><span id="local-6989586621682856679"><span class="annot"><span class="annottext">arithInstr :: (Format -&gt; Operand -&gt; Operand -&gt; Instr) -&gt; InstrBlock
</span><a href="#local-6989586621682856679"><span class="hs-identifier hs-var hs-var">arithInstr</span></a></span></span><span> </span><span id="local-6989586621682856680"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856680"><span class="hs-identifier hs-var">instr</span></a></span></span><span>
</span><span id="line-1628"></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856673"><span class="hs-identifier hs-var">exp1</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856675"><span class="hs-identifier hs-var">exp2</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1629"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVU"><span class="hs-identifier hs-var">MOVU</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856676"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856672"><span class="hs-identifier hs-var">reg1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856678"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1630"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856680"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856676"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856674"><span class="hs-identifier hs-var">reg2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856678"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1631"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856676"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856677"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1632"></span><span>    </span><span class="hs-comment">--------------------</span><span>
</span><span id="line-1633"></span><span>    </span><span class="annot"><a href="#local-6989586621682856525"><span class="hs-identifier hs-type">vector_float_extract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span>
</span><span id="line-1634"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-1635"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1636"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1637"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1638"></span><span>    </span><span id="local-6989586621682856525"><span class="annot"><span class="annottext">vector_float_extract :: Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856525"><span class="hs-identifier hs-var hs-var">vector_float_extract</span></a></span></span><span> </span><span id="local-6989586621682856681"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856681"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span id="local-6989586621682856682"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856682"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682856683"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856683"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1639"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682856684"><span class="annot"><a href="#local-6989586621682856684"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856685"><span class="annot"><a href="#local-6989586621682856685"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856682"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1640"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856686"><span class="annot"><a href="#local-6989586621682856686"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856681"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtFloat"><span class="hs-identifier hs-var">FmtFloat</span></a></span><span>
</span><span id="line-1641"></span><span>          </span><span id="local-6989586621682856687"><span class="annot"><a href="#local-6989586621682856687"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856683"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1642"></span><span>          </span><span id="local-6989586621682856688"><span class="annot"><a href="#local-6989586621682856688"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856689"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856689"><span class="hs-identifier hs-var">dst</span></a></span></span><span>
</span><span id="line-1643"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856683"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1644"></span><span>                </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856685"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#FF32"><span class="hs-identifier hs-var">FF32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856684"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856689"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1645"></span><span>                </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856685"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VPSHUFD"><span class="hs-identifier hs-var">VPSHUFD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856686"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Imm
</span><a href="#local-6989586621682856687"><span class="hs-identifier hs-var">imm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856684"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856689"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1646"></span><span>                </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; InstrBlock
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unsupported AVX floating-point vector extract offset&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856683"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1647"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#FF32"><span class="hs-identifier hs-type">FF32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856688"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1648"></span><span>    </span><span class="annot"><a href="#local-6989586621682856525"><span class="hs-identifier hs-var">vector_float_extract</span></a></span><span> </span><span id="local-6989586621682856691"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856691"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span id="local-6989586621682856692"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856692"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682856693"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856693"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1649"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682856694"><span class="annot"><a href="#local-6989586621682856694"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856695"><span class="annot"><a href="#local-6989586621682856695"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856692"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1650"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856696"><span class="annot"><a href="#local-6989586621682856696"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856691"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtDouble"><span class="hs-identifier hs-var">FmtDouble</span></a></span><span>
</span><span id="line-1651"></span><span>          </span><span id="local-6989586621682856697"><span class="annot"><a href="#local-6989586621682856697"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856698"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856698"><span class="hs-identifier hs-var">dst</span></a></span></span><span>
</span><span id="line-1652"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856693"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1653"></span><span>                </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856695"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1654"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#FF64"><span class="hs-identifier hs-var">FF64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856694"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856698"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1655"></span><span>                </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856695"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1656"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVHLPS"><span class="hs-identifier hs-var">MOVHLPS</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856696"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856694"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856698"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1657"></span><span>                </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; InstrBlock
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unsupported AVX floating-point vector extract offset&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856693"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1658"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#FF64"><span class="hs-identifier hs-type">FF64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856697"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1659"></span><span>    </span><span class="annot"><a href="#local-6989586621682856525"><span class="hs-identifier hs-var">vector_float_extract</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856700"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856700"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682856701"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856701"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682856702"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856702"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1660"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unsupported AVX floating-point vector extract&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856467"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856701"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856467"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856702"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856700"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1661"></span><span>    </span><span class="hs-comment">-----------------------</span><span>
</span><span id="line-1662"></span><span>
</span><span id="line-1663"></span><span>    </span><span class="annot"><a href="#local-6989586621682856526"><span class="hs-identifier hs-type">vector_float_extract_sse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span>
</span><span id="line-1664"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-1665"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1666"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1667"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1668"></span><span>    </span><span id="local-6989586621682856526"><span class="annot"><span class="annottext">vector_float_extract_sse :: Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856526"><span class="hs-identifier hs-var hs-var">vector_float_extract_sse</span></a></span></span><span> </span><span id="local-6989586621682856703"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856703"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span id="local-6989586621682856704"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856704"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682856705"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856705"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1669"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1670"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682856706"><span class="annot"><a href="#local-6989586621682856706"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682856707"><span class="annot"><a href="#local-6989586621682856707"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856704"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1671"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856708"><span class="annot"><a href="#local-6989586621682856708"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856703"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtFloat"><span class="hs-identifier hs-var">FmtFloat</span></a></span><span>
</span><span id="line-1672"></span><span>          </span><span id="local-6989586621682856709"><span class="annot"><a href="#local-6989586621682856709"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856705"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1673"></span><span>          </span><span id="local-6989586621682856710"><span class="annot"><a href="#local-6989586621682856710"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856711"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856711"><span class="hs-identifier hs-var">dst</span></a></span></span><span>
</span><span id="line-1674"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856705"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1675"></span><span>                </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856707"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVU"><span class="hs-identifier hs-var">MOVU</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856708"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856706"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856711"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1676"></span><span>                </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856707"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#PSHUFD"><span class="hs-identifier hs-var">PSHUFD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856708"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Imm
</span><a href="#local-6989586621682856709"><span class="hs-identifier hs-var">imm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856706"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856711"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1677"></span><span>                </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; InstrBlock
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unsupported SSE floating-point vector extract offset&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856705"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1678"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#FF32"><span class="hs-identifier hs-type">FF32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856710"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1679"></span><span>    </span><span class="annot"><a href="#local-6989586621682856526"><span class="hs-identifier hs-var">vector_float_extract_sse</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856712"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856712"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682856713"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856713"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682856714"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856714"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-1680"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unsupported SSE floating-point vector extract&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856467"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856713"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856467"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856714"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856712"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1681"></span><span>    </span><span class="hs-comment">-----------------------</span><span>
</span><span id="line-1682"></span><span>
</span><span id="line-1683"></span><span>    </span><span class="annot"><a href="#local-6989586621682856529"><span class="hs-identifier hs-type">vector_int_extract_sse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span>
</span><span id="line-1684"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-1685"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1686"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1687"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1688"></span><span>    </span><span id="local-6989586621682856529"><span class="annot"><span class="annottext">vector_int_extract_sse :: Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856529"><span class="hs-identifier hs-var hs-var">vector_int_extract_sse</span></a></span></span><span> </span><span id="local-6989586621682856715"><span class="annot"><span class="annottext">l :: Int
</span><a href="#local-6989586621682856715"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span id="local-6989586621682856716"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856716"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682856717"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856717"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1689"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1690"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682856718"><span class="annot"><a href="#local-6989586621682856718"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856719"><span class="annot"><a href="#local-6989586621682856719"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856716"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1691"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856720"><span class="annot"><a href="#local-6989586621682856720"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856715"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtInt64"><span class="hs-identifier hs-var">FmtInt64</span></a></span><span>
</span><span id="line-1692"></span><span>      </span><span id="local-6989586621682856721"><span class="annot"><a href="#local-6989586621682856721"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856720"><span class="hs-identifier hs-type">fmt</span></a></span><span>
</span><span id="line-1693"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856722"><span class="annot"><a href="#local-6989586621682856722"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856723"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856723"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1694"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856717"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1695"></span><span>              </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856719"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1696"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVD"><span class="hs-identifier hs-var">MOVD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856718"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856723"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1697"></span><span>              </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856719"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1698"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVHLPS"><span class="hs-identifier hs-var">MOVHLPS</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856720"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856718"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856721"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1699"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVD"><span class="hs-identifier hs-var">MOVD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856721"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856723"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1700"></span><span>              </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; InstrBlock
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error in offset while unpacking&quot;</span></span><span>
</span><span id="line-1701"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856722"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1702"></span><span>    </span><span class="annot"><a href="#local-6989586621682856529"><span class="hs-identifier hs-var">vector_int_extract_sse</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856724"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856724"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682856725"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856725"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682856726"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856726"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-1703"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unsupported SSE floating-point vector extract&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856467"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856725"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856467"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856726"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856724"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1704"></span><span>
</span><span id="line-1705"></span><span>    </span><span class="annot"><a href="#local-6989586621682856523"><span class="hs-identifier hs-type">vector_shuffle_float</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1706"></span><span>    </span><span id="local-6989586621682856523"><span class="annot"><span class="annottext">vector_shuffle_float :: Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; [Int] -&gt; NatM Register
</span><a href="#local-6989586621682856523"><span class="hs-identifier hs-var hs-var">vector_shuffle_float</span></a></span></span><span> </span><span id="local-6989586621682856727"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856727"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682856728"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856728"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682856729"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856729"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621682856730"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856730"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span id="local-6989586621682856731"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682856731"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1707"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682856732"><span class="annot"><a href="#local-6989586621682856732"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856733"><span class="annot"><a href="#local-6989586621682856733"><span class="hs-identifier hs-var">exp1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856729"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-1708"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682856734"><span class="annot"><a href="#local-6989586621682856734"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856735"><span class="annot"><a href="#local-6989586621682856735"><span class="hs-identifier hs-var">exp2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856730"><span class="hs-identifier hs-type">v2</span></a></span><span>
</span><span id="line-1709"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856736"><span class="annot"><a href="#local-6989586621682856736"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856727"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856728"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtFloat"><span class="hs-identifier hs-var">FmtFloat</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtDouble"><span class="hs-identifier hs-var">FmtDouble</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1710"></span><span>          </span><span id="local-6989586621682856737"><span class="annot"><a href="#local-6989586621682856737"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856738"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856738"><span class="hs-identifier hs-var">dst</span></a></span></span><span>
</span><span id="line-1711"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856733"><span class="hs-identifier hs-var">exp1</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856735"><span class="hs-identifier hs-var">exp2</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; Reg -&gt; [Int] -&gt; Reg -&gt; InstrBlock
</span><a href="#local-6989586621682856739"><span class="hs-identifier hs-var">shuffleInstructions</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856736"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856732"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856734"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682856731"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856738"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1712"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856736"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856737"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1713"></span><span>
</span><span id="line-1714"></span><span>    </span><span class="annot"><a href="#local-6989586621682856739"><span class="hs-identifier hs-type">shuffleInstructions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span>
</span><span id="line-1715"></span><span>    </span><span id="local-6989586621682856739"><span class="annot"><span class="annottext">shuffleInstructions :: Format -&gt; Reg -&gt; Reg -&gt; [Int] -&gt; Reg -&gt; InstrBlock
</span><a href="#local-6989586621682856739"><span class="hs-identifier hs-var hs-var">shuffleInstructions</span></a></span></span><span> </span><span id="local-6989586621682856740"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span id="local-6989586621682856741"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621682856742"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span id="local-6989586621682856743"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682856743"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621682856744"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1716"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1717"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-type">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtDouble"><span class="hs-identifier hs-var">FmtDouble</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1718"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682856743"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1719"></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621682856745"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856745"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856746"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856746"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856745"><span class="hs-identifier hs-var">i1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856746"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1720"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0b00</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1721"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0b11</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1722"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0b00</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1723"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0b11</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1724"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VMOVU"><span class="hs-identifier hs-var">VMOVU</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1725"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VMOVU"><span class="hs-identifier hs-var">VMOVU</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1726"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0b01</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1727"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0b01</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1728"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0b00</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1729"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0b00</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1730"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0b10</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1731"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0b01</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1732"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0b01</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1733"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0b10</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1734"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0b11</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1735"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0b11</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1736"></span><span>              </span><span class="annot"><span class="annottext">(Int, Int)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; InstrBlock
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;vector shuffle: indices out of bounds 0 &lt;= i &lt;= 3&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682856743"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1737"></span><span>            </span><span class="annot"><span class="annottext">[Int]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; InstrBlock
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;vector shuffle: wrong number of indices (expected 2)&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682856743"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1738"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-type">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtFloat"><span class="hs-identifier hs-var">FmtFloat</span></a></span><span>
</span><span id="line-1739"></span><span>          </span><span class="hs-comment">-- indices 0 &lt;= i &lt;= 7</span><span>
</span><span id="line-1740"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; (Int -&gt; Bool) -&gt; Int -&gt; Bool
forall (f :: * -&gt; *). Applicative f =&gt; f Bool -&gt; f Bool -&gt; f Bool
</span><a href="GHC.Utils.Misc.html#%3C%26%26%3E"><span class="hs-operator hs-var">&lt;&amp;&amp;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682856743"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1741"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682856743"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1742"></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621682856749"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856749"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856750"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856750"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856751"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856751"><span class="hs-identifier hs-var">i3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856752"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856752"><span class="hs-identifier hs-var">i4</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1743"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682856743"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-1744"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856753"><span class="annot"><span class="annottext">imm :: Int
</span><a href="#local-6989586621682856753"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856749"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856750"><span class="hs-identifier hs-var">i2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856751"><span class="hs-identifier hs-var">i3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856752"><span class="hs-identifier hs-var">i4</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-1745"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856753"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1746"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682856743"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-1747"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682856756"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856756"><span class="hs-identifier hs-var">j1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856757"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856757"><span class="hs-identifier hs-var">j2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856758"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856758"><span class="hs-identifier hs-var">j3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856759"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856759"><span class="hs-identifier hs-var">j4</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; [Int] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">subtract</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682856743"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-1748"></span><span>                    </span><span id="local-6989586621682856761"><span class="annot"><span class="annottext">imm :: Int
</span><a href="#local-6989586621682856761"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856756"><span class="hs-identifier hs-var">j1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856757"><span class="hs-identifier hs-var">j2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856758"><span class="hs-identifier hs-var">j3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856759"><span class="hs-identifier hs-var">j4</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-1749"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856761"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1750"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856749"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856750"><span class="hs-identifier hs-var">i2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-1751"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856751"><span class="hs-identifier hs-var">i3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856752"><span class="hs-identifier hs-var">i4</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-1752"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856762"><span class="annot"><span class="annottext">imm :: Int
</span><a href="#local-6989586621682856762"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856749"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856750"><span class="hs-identifier hs-var">i2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856751"><span class="hs-identifier hs-var">i3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856752"><span class="hs-identifier hs-var">i4</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-1753"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856762"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1754"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856749"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856750"><span class="hs-identifier hs-var">i2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-1755"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856751"><span class="hs-identifier hs-var">i3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856752"><span class="hs-identifier hs-var">i4</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-1756"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856763"><span class="annot"><span class="annottext">imm :: Int
</span><a href="#local-6989586621682856763"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856749"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856750"><span class="hs-identifier hs-var">i2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856751"><span class="hs-identifier hs-var">i3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856752"><span class="hs-identifier hs-var">i4</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-1757"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VSHUF"><span class="hs-identifier hs-var">VSHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856763"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1758"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1759"></span><span>              </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1760"></span><span>              </span><span class="hs-comment">-- Fall-back code with 4 INSERTPS operations.</span><span>
</span><span id="line-1761"></span><span>              </span><span class="hs-comment">-- SIMD NCG TODO: handle more cases with better lowering.</span><span>
</span><span id="line-1762"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- bits: ss_dd_zzzz</span><span>
</span><span id="line-1763"></span><span>                  </span><span class="hs-comment">-- ss: pick source location</span><span>
</span><span id="line-1764"></span><span>                  </span><span class="hs-comment">-- dd: pick destination location</span><span>
</span><span id="line-1765"></span><span>                  </span><span class="hs-comment">-- zzzz: pick locations to be zeroed</span><span>
</span><span id="line-1766"></span><span>                  </span><span id="local-6989586621682856787"><span class="annot"><span class="annottext">insertImm :: a -&gt; a -&gt; a
</span><a href="#local-6989586621682856787"><span class="hs-identifier hs-var hs-var">insertImm</span></a></span></span><span> </span><span id="local-6989586621682856788"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682856788"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682856789"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682856789"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-identifier hs-var">shiftL</span></a></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682856788"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-1767"></span><span>                                    </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-identifier hs-var">shiftL</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682856789"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-1768"></span><span>                  </span><span id="local-6989586621682856792"><span class="annot"><span class="annottext">vec :: Int -&gt; Reg
</span><a href="#local-6989586621682856792"><span class="hs-identifier hs-var hs-var">vec</span></a></span></span><span> </span><span id="local-6989586621682856793"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856793"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856793"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856742"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856741"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-1769"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span>
</span><span id="line-1770"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#INSERTPS"><span class="hs-identifier hs-var">INSERTPS</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Imm) -&gt; Int -&gt; Imm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall {a}. (Bits a, Integral a) =&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621682856787"><span class="hs-identifier hs-var">insertImm</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856749"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0b1110</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">(Reg -&gt; Operand) -&gt; Reg -&gt; Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Reg
</span><a href="#local-6989586621682856792"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856749"><span class="hs-identifier hs-var">i1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1771"></span><span>                </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1772"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#INSERTPS"><span class="hs-identifier hs-var">INSERTPS</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Imm) -&gt; Int -&gt; Imm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall {a}. (Bits a, Integral a) =&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621682856787"><span class="hs-identifier hs-var">insertImm</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856750"><span class="hs-identifier hs-var">i2</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">(Reg -&gt; Operand) -&gt; Reg -&gt; Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Reg
</span><a href="#local-6989586621682856792"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856750"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1773"></span><span>                </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1774"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#INSERTPS"><span class="hs-identifier hs-var">INSERTPS</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Imm) -&gt; Int -&gt; Imm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall {a}. (Bits a, Integral a) =&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621682856787"><span class="hs-identifier hs-var">insertImm</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856751"><span class="hs-identifier hs-var">i3</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">(Reg -&gt; Operand) -&gt; Reg -&gt; Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Reg
</span><a href="#local-6989586621682856792"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856751"><span class="hs-identifier hs-var">i3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1775"></span><span>                </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1776"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#INSERTPS"><span class="hs-identifier hs-var">INSERTPS</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Imm) -&gt; Int -&gt; Imm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall {a}. (Bits a, Integral a) =&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621682856787"><span class="hs-identifier hs-var">insertImm</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856752"><span class="hs-identifier hs-var">i4</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">(Reg -&gt; Operand) -&gt; Reg -&gt; Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Reg
</span><a href="#local-6989586621682856792"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856752"><span class="hs-identifier hs-var">i4</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856744"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1777"></span><span>            </span><span class="annot"><span class="annottext">[Int]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; InstrBlock
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;vector shuffle: wrong number of indices (expected 4)&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682856743"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1778"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1779"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; InstrBlock
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;vector shuffle: indices out of bounds 0 &lt;= i &lt;= 7&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682856743"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1780"></span><span>        </span><span class="annot"><span class="annottext">Format
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1781"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; InstrBlock
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;vector shuffle: unsupported format&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856740"><span class="hs-identifier hs-var">fmt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1782"></span><span>
</span><span id="line-1783"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682856795"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856795"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682856796"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856796"><span class="hs-identifier hs-var">_is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682856797"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856797"><span class="hs-identifier hs-var">mop</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682856798"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856798"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856799"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856799"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856800"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856800"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- ternary MachOps</span><span>
</span><span id="line-1784"></span><span>  </span><span id="local-6989586621682856801"><span class="annot"><a href="#local-6989586621682856801"><span class="hs-identifier hs-var">avx</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#avxEnabled"><span class="hs-identifier hs-var">avxEnabled</span></a></span><span>
</span><span id="line-1785"></span><span>  </span><span id="local-6989586621682856802"><span class="annot"><a href="#local-6989586621682856802"><span class="hs-identifier hs-var">sse4_1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#sse4_1Enabled"><span class="hs-identifier hs-type">sse4_1Enabled</span></a></span><span>
</span><span id="line-1786"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682856797"><span class="hs-identifier hs-type">mop</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1787"></span><span>      </span><span class="hs-comment">-- Floating point fused multiply-add operations @ &#177; x*y &#177; z@</span><span>
</span><span id="line-1788"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FMA"><span class="hs-identifier hs-type">MO_FMA</span></a></span><span> </span><span id="local-6989586621682856803"><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682856803"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682856804"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856804"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682856805"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856805"><span class="hs-identifier hs-var">w</span></a></span></span><span>
</span><span id="line-1789"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856804"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBits"><span class="hs-identifier hs-var">widthInBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856805"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">256</span></span><span>
</span><span id="line-1790"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#sorry"><span class="hs-identifier hs-var">sorry</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Please use -fllvm for wide vector FMA support&quot;</span></span><span>
</span><span id="line-1791"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1792"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Width
-&gt; FMASign
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genFMA3Code"><span class="hs-identifier hs-var">genFMA3Code</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856804"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856805"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682856803"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856798"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856799"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856800"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1793"></span><span>
</span><span id="line-1794"></span><span>      </span><span class="hs-comment">-- Ternary vector operations</span><span>
</span><span id="line-1795"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Insert"><span class="hs-identifier hs-type">MO_VF_Insert</span></a></span><span> </span><span id="local-6989586621682856808"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856808"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856808"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856809"><span class="hs-identifier hs-var">vector_floatx4_insert_sse</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856802"><span class="hs-identifier hs-var">sse4_1</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856798"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856799"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856800"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1796"></span><span>                          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1797"></span><span>         </span><span class="annot"><span class="annottext">String -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#sorry"><span class="hs-identifier hs-var">sorry</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; NatM Register) -&gt; String -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FloatX&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856808"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;# insert operations require -fllvm&quot;</span></span><span>
</span><span id="line-1798"></span><span>           </span><span class="hs-comment">-- SIMD NCG TODO:</span><span>
</span><span id="line-1799"></span><span>           </span><span class="hs-comment">--</span><span>
</span><span id="line-1800"></span><span>           </span><span class="hs-comment">--   - add support for FloatX8, FloatX16.</span><span>
</span><span id="line-1801"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_VF_Insert"><span class="hs-identifier hs-type">MO_VF_Insert</span></a></span><span> </span><span id="local-6989586621682856810"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856810"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856811"><span class="hs-identifier hs-var">vector_double_insert</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856801"><span class="hs-identifier hs-var">avx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856810"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856798"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856799"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856800"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1802"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_V_Insert"><span class="hs-identifier hs-type">MO_V_Insert</span></a></span><span> </span><span id="local-6989586621682856812"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856812"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt;
Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856813"><span class="hs-identifier hs-var">vector_int_insert_sse</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856812"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856798"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856799"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856800"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1803"></span><span>
</span><span id="line-1804"></span><span>      </span><span id="local-6989586621682856814"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856814"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getRegister(x86) - ternary CmmMachOp (1)&quot;</span></span><span>
</span><span id="line-1805"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; SDoc
</span><a href="GHC.Cmm.MachOp.html#pprMachOp"><span class="hs-identifier hs-var">pprMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856797"><span class="hs-identifier hs-var">mop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1806"></span><span>
</span><span id="line-1807"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1808"></span><span>    </span><span class="hs-comment">-- SIMD NCG TODO:</span><span>
</span><span id="line-1809"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-1810"></span><span>    </span><span class="hs-comment">--   - add support for FloatX8, FloatX16.</span><span>
</span><span id="line-1811"></span><span>    </span><span class="annot"><a href="#local-6989586621682856809"><span class="hs-identifier hs-type">vector_floatx4_insert_sse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1812"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1813"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1814"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1815"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1816"></span><span>    </span><span id="local-6989586621682856809"><span class="annot"><span class="annottext">vector_floatx4_insert_sse :: Bool -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856809"><span class="hs-identifier hs-var hs-var">vector_floatx4_insert_sse</span></a></span></span><span> </span><span id="local-6989586621682856816"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856816"><span class="hs-identifier hs-var">sse4_1</span></a></span></span><span> </span><span id="local-6989586621682856817"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856817"><span class="hs-identifier hs-var">vecExpr</span></a></span></span><span> </span><span id="local-6989586621682856818"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856818"><span class="hs-identifier hs-var">valExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682856819"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856819"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1817"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856816"><span class="hs-identifier hs-var">sse4_1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1818"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682856820"><span class="annot"><a href="#local-6989586621682856820"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856821"><span class="annot"><a href="#local-6989586621682856821"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856818"><span class="hs-identifier hs-var">valExpr</span></a></span><span>
</span><span id="line-1819"></span><span>        </span><span id="local-6989586621682856822"><span class="annot"><a href="#local-6989586621682856822"><span class="hs-identifier hs-var">fn</span></a></span></span><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856817"><span class="hs-identifier hs-type">vecExpr</span></a></span><span>
</span><span id="line-1820"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856823"><span class="annot"><a href="#local-6989586621682856823"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtFloat"><span class="hs-identifier hs-var">FmtFloat</span></a></span><span>
</span><span id="line-1821"></span><span>            </span><span id="local-6989586621682856824"><span class="annot"><a href="#local-6989586621682856824"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856819"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1822"></span><span>            </span><span id="local-6989586621682856825"><span class="annot"><a href="#local-6989586621682856825"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856826"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856826"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856821"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1823"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682856822"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856826"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1824"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#INSERTPS"><span class="hs-identifier hs-var">INSERTPS</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856823"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Imm
</span><a href="#local-6989586621682856824"><span class="hs-identifier hs-var">imm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856820"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856826"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1825"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856823"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856825"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-1826"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- SSE &lt;= 3</span><span>
</span><span id="line-1827"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682856827"><span class="annot"><a href="#local-6989586621682856827"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856828"><span class="annot"><a href="#local-6989586621682856828"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856818"><span class="hs-identifier hs-var">valExpr</span></a></span><span>
</span><span id="line-1828"></span><span>        </span><span id="local-6989586621682856829"><span class="annot"><a href="#local-6989586621682856829"><span class="hs-identifier hs-var">fn</span></a></span></span><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856817"><span class="hs-identifier hs-type">vecExpr</span></a></span><span>
</span><span id="line-1829"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856830"><span class="annot"><a href="#local-6989586621682856830"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtFloat"><span class="hs-identifier hs-var">FmtFloat</span></a></span><span>
</span><span id="line-1830"></span><span>        </span><span id="local-6989586621682856831"><span class="annot"><a href="#local-6989586621682856831"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856830"><span class="hs-identifier hs-type">fmt</span></a></span><span>
</span><span id="line-1831"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856832"><span class="annot"><a href="#local-6989586621682856832"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856833"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856833"><span class="hs-identifier hs-var">dst</span></a></span></span><span>
</span><span id="line-1832"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856819"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1833"></span><span>                  </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856828"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1834"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682856829"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856833"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1835"></span><span>                      </span><span class="hs-comment">-- The following MOV compiles to MOVSS instruction and merges two vectors</span><span>
</span><span id="line-1836"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856830"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856827"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856833"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- dst &lt;- (r[0],dst[1],dst[2],dst[3])</span><span>
</span><span id="line-1837"></span><span>                  </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856828"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1838"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682856829"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856833"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1839"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVU"><span class="hs-identifier hs-var">MOVU</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856830"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856833"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856831"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>  </span><span class="hs-comment">-- tmp &lt;- dst</span><span>
</span><span id="line-1840"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#UNPCKL"><span class="hs-identifier hs-var">UNPCKL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856830"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856827"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856833"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>          </span><span class="hs-comment">-- dst &lt;- (dst[0],r[0],dst[1],r[1])</span><span>
</span><span id="line-1841"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHUF"><span class="hs-identifier hs-var">SHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856830"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0xe4</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856831"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856833"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- dst &lt;- (dst[0],dst[1],tmp[2],tmp[3])</span><span>
</span><span id="line-1842"></span><span>                  </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856828"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1843"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682856829"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856833"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1844"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVU"><span class="hs-identifier hs-var">MOVU</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856830"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856833"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856831"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>  </span><span class="hs-comment">-- tmp &lt;- dst</span><span>
</span><span id="line-1845"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856830"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856827"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856831"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>     </span><span class="hs-comment">-- tmp &lt;- (r[0],tmp[1],tmp[2],tmp[3]) with MOVSS</span><span>
</span><span id="line-1846"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHUF"><span class="hs-identifier hs-var">SHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856830"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0xc4</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856831"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856833"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- dst &lt;- (dst[0],dst[1],tmp[0],tmp[3])</span><span>
</span><span id="line-1847"></span><span>                  </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856828"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1848"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682856829"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856833"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1849"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVU"><span class="hs-identifier hs-var">MOVU</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856830"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856833"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856831"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>  </span><span class="hs-comment">-- tmp &lt;- dst</span><span>
</span><span id="line-1850"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856830"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856827"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856831"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>     </span><span class="hs-comment">-- tmp &lt;- (r[0],tmp[1],tmp[2],tmp[3]) with MOVSS</span><span>
</span><span id="line-1851"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHUF"><span class="hs-identifier hs-var">SHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856830"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x24</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856831"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856833"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- dst &lt;- (dst[0],dst[1],tmp[2],tmp[0])</span><span>
</span><span id="line-1852"></span><span>                  </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; InstrBlock
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MO_VF_Insert FloatX4: unsupported offset&quot;</span></span><span>
</span><span id="line-1853"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856830"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856832"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-1854"></span><span>    </span><span class="annot"><a href="#local-6989586621682856809"><span class="hs-identifier hs-var">vector_floatx4_insert_sse</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856835"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856835"><span class="hs-identifier hs-var">offset</span></a></span></span><span>
</span><span id="line-1855"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unsupported vector insert operation&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; NatM Register) -&gt; SDoc -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1856"></span><span>          </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-1857"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FloatX4#&quot;</span></span><span>
</span><span id="line-1858"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;offset:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856795"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856835"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1859"></span><span>
</span><span id="line-1860"></span><span>
</span><span id="line-1861"></span><span>    </span><span class="hs-comment">-- SIMD NCG TODO:</span><span>
</span><span id="line-1862"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-1863"></span><span>    </span><span class="hs-comment">--   - add support for DoubleX4#, DoubleX8#.</span><span>
</span><span id="line-1864"></span><span>    </span><span class="annot"><a href="#local-6989586621682856811"><span class="hs-identifier hs-type">vector_double_insert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1865"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span>
</span><span id="line-1866"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1867"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1868"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1869"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1870"></span><span>    </span><span class="hs-comment">-- DoubleX2</span><span>
</span><span id="line-1871"></span><span>    </span><span id="local-6989586621682856811"><span class="annot"><span class="annottext">vector_double_insert :: Bool -&gt; Int -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856811"><span class="hs-identifier hs-var hs-var">vector_double_insert</span></a></span></span><span> </span><span id="local-6989586621682856836"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856836"><span class="hs-identifier hs-var">avx</span></a></span></span><span> </span><span id="local-6989586621682856837"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621682856837"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span id="local-6989586621682856838"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856838"><span class="hs-identifier hs-var">vecExpr</span></a></span></span><span> </span><span id="local-6989586621682856839"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856839"><span class="hs-identifier hs-var">valExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682856840"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856840"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1872"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1873"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682856841"><span class="annot"><a href="#local-6989586621682856841"><span class="hs-identifier hs-var">valReg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856842"><span class="annot"><a href="#local-6989586621682856842"><span class="hs-identifier hs-var">valExp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856839"><span class="hs-identifier hs-var">valExpr</span></a></span><span>
</span><span id="line-1874"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682856843"><span class="annot"><a href="#local-6989586621682856843"><span class="hs-identifier hs-var">vecReg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856844"><span class="annot"><a href="#local-6989586621682856844"><span class="hs-identifier hs-var">vecExp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856838"><span class="hs-identifier hs-type">vecExpr</span></a></span><span> </span><span class="hs-comment">-- NB: vector regs never clobbered by instruction</span><span>
</span><span id="line-1875"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856845"><span class="annot"><a href="#local-6989586621682856845"><span class="hs-identifier hs-var hs-var">movu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856836"><span class="hs-identifier hs-var">avx</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VMOVU"><span class="hs-identifier hs-var">VMOVU</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVU"><span class="hs-identifier hs-var">MOVU</span></a></span><span>
</span><span id="line-1876"></span><span>            </span><span id="local-6989586621682856846"><span class="annot"><a href="#local-6989586621682856846"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856837"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtDouble"><span class="hs-identifier hs-var">FmtDouble</span></a></span><span>
</span><span id="line-1877"></span><span>            </span><span id="local-6989586621682856847"><span class="annot"><a href="#local-6989586621682856847"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856848"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856848"><span class="hs-identifier hs-var">dst</span></a></span></span><span>
</span><span id="line-1878"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856840"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1879"></span><span>                  </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856842"><span class="hs-identifier hs-var">valExp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1880"></span><span>                                </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856844"><span class="hs-identifier hs-var">vecExp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1881"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856845"><span class="hs-identifier hs-var">movu</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtDouble"><span class="hs-identifier hs-var">FmtDouble</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856843"><span class="hs-identifier hs-var">vecReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856848"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1882"></span><span>                                </span><span class="hs-comment">-- The following MOV compiles to MOVSD instruction and merges two vectors</span><span>
</span><span id="line-1883"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtDouble"><span class="hs-identifier hs-var">FmtDouble</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856841"><span class="hs-identifier hs-var">valReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856848"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1884"></span><span>                  </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856842"><span class="hs-identifier hs-var">valExp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1885"></span><span>                                </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856844"><span class="hs-identifier hs-var">vecExp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1886"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856845"><span class="hs-identifier hs-var">movu</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtDouble"><span class="hs-identifier hs-var">FmtDouble</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856843"><span class="hs-identifier hs-var">vecReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856848"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1887"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Imm -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SHUF"><span class="hs-identifier hs-var">SHUF</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856846"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0b00</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856841"><span class="hs-identifier hs-var">valReg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856848"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1888"></span><span>                  </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; InstrBlock
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MO_VF_Insert DoubleX2: unsupported offset&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856840"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1889"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856846"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856847"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-1890"></span><span>    </span><span class="annot"><a href="#local-6989586621682856811"><span class="hs-identifier hs-var">vector_double_insert</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1891"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#sorry"><span class="hs-identifier hs-var">sorry</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unsupported floating-point vector insert operation; please use -fllvm&quot;</span></span><span>
</span><span id="line-1892"></span><span>    </span><span class="hs-comment">-- For DoubleX4: use VSHUFPD.</span><span>
</span><span id="line-1893"></span><span>    </span><span class="hs-comment">-- For DoubleX8: use something like vinsertf64x2 followed by vpblendd?</span><span>
</span><span id="line-1894"></span><span>
</span><span id="line-1895"></span><span>    </span><span class="hs-comment">-- SIMD NCG TODO:</span><span>
</span><span id="line-1896"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-1897"></span><span>    </span><span class="hs-comment">--   - only supports Int64X2, add support for everything else:</span><span>
</span><span id="line-1898"></span><span>    </span><span class="hs-comment">--     (Int32X{4,2}, Int16X{8,4,2}, Int8X{16,8,4,2})</span><span>
</span><span id="line-1899"></span><span>    </span><span class="annot"><a href="#local-6989586621682856813"><span class="hs-identifier hs-type">vector_int_insert_sse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span>
</span><span id="line-1900"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-1901"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1902"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1903"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-1904"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1905"></span><span>    </span><span class="hs-comment">-- Int64X2</span><span>
</span><span id="line-1906"></span><span>    </span><span id="local-6989586621682856813"><span class="annot"><span class="annottext">vector_int_insert_sse :: HasCallStack =&gt;
Int -&gt; Width -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682856813"><span class="hs-identifier hs-var hs-var">vector_int_insert_sse</span></a></span></span><span> </span><span id="local-6989586621682856866"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621682856866"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span id="local-6989586621682856867"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856867"><span class="hs-identifier hs-var">vecExpr</span></a></span></span><span> </span><span id="local-6989586621682856868"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856868"><span class="hs-identifier hs-var">valExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682856869"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856869"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1907"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1908"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682856870"><span class="annot"><a href="#local-6989586621682856870"><span class="hs-identifier hs-var">valReg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856871"><span class="annot"><a href="#local-6989586621682856871"><span class="hs-identifier hs-var">valExp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856868"><span class="hs-identifier hs-var">valExpr</span></a></span><span>
</span><span id="line-1909"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682856872"><span class="annot"><a href="#local-6989586621682856872"><span class="hs-identifier hs-var">vecReg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682856873"><span class="annot"><a href="#local-6989586621682856873"><span class="hs-identifier hs-var">vecExp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856867"><span class="hs-identifier hs-type">vecExpr</span></a></span><span> </span><span class="hs-comment">-- NB: vector regs never clobbered by instruction</span><span>
</span><span id="line-1910"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856874"><span class="annot"><a href="#local-6989586621682856874"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ScalarFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-var">VecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856866"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="GHC.CmmToAsm.Format.html#FmtInt64"><span class="hs-identifier hs-var">FmtInt64</span></a></span><span>
</span><span id="line-1911"></span><span>        </span><span id="local-6989586621682856875"><span class="annot"><a href="#local-6989586621682856875"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856874"><span class="hs-identifier hs-type">fmt</span></a></span><span>
</span><span id="line-1912"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856876"><span class="annot"><a href="#local-6989586621682856876"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856877"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856877"><span class="hs-identifier hs-var">dst</span></a></span></span><span>
</span><span id="line-1913"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856869"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1914"></span><span>                  </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856871"><span class="hs-identifier hs-var">valExp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1915"></span><span>                                </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856873"><span class="hs-identifier hs-var">vecExp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1916"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVHLPS"><span class="hs-identifier hs-var">MOVHLPS</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856874"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856872"><span class="hs-identifier hs-var">vecReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856875"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1917"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVD"><span class="hs-identifier hs-var">MOVD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856870"><span class="hs-identifier hs-var">valReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856877"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1918"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#PUNPCKLQDQ"><span class="hs-identifier hs-var">PUNPCKLQDQ</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856874"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856875"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856877"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1919"></span><span>                  </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856871"><span class="hs-identifier hs-var">valExp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1920"></span><span>                                </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856873"><span class="hs-identifier hs-var">vecExp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1921"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856872"><span class="hs-identifier hs-var">vecReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856877"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1922"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVD"><span class="hs-identifier hs-var">MOVD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856870"><span class="hs-identifier hs-var">valReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856875"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1923"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#PUNPCKLQDQ"><span class="hs-identifier hs-var">PUNPCKLQDQ</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856874"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856875"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856877"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1924"></span><span>                  </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; InstrBlock
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MO_V_Insert Int64X2: unsupported offset&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856869"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1925"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856874"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856876"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-1926"></span><span>    </span><span class="annot"><a href="#local-6989586621682856813"><span class="hs-identifier hs-var">vector_int_insert_sse</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1927"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#sorry"><span class="hs-identifier hs-var">sorry</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unsupported integer vector insert operation; please use -fllvm&quot;</span></span><span>
</span><span id="line-1928"></span><span>
</span><span id="line-1929"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682856878"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856878"><span class="hs-identifier hs-var">mop</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1930"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getRegister(x86): MachOp with &gt;= 4 arguments&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; SDoc) -&gt; String -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682856878"><span class="hs-identifier hs-var">mop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1931"></span><span>
</span><span id="line-1932"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682856879"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856879"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682856880"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856880"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span id="local-6989586621682856881"><span class="annot"><span class="annottext">load :: CmmExpr
</span><a href="#local-6989586621682856881"><span class="hs-identifier hs-var">load</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682856882"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856882"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621682856883"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682856883"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1933"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isVecType"><span class="hs-identifier hs-var">isVecType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682856883"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1934"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1935"></span><span>    </span><span id="local-6989586621682856884"><span class="annot"><a href="#local-6989586621682856884"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-1936"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682856885"><span class="annot"><a href="#local-6989586621682856885"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682856886"><span class="annot"><a href="#local-6989586621682856886"><span class="hs-identifier hs-var">mem_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856882"><span class="hs-identifier hs-type">mem</span></a></span><span>
</span><span id="line-1937"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856887"><span class="annot"><a href="#local-6989586621682856887"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856888"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856888"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1938"></span><span>          </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856886"><span class="hs-identifier hs-var">mem_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-1939"></span><span>            </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt;
NCGConfig -&gt; Format -&gt; Operand -&gt; Operand -&gt; Instr
NCGConfig -&gt; Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#movInstr"><span class="hs-identifier hs-var">movInstr</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682856884"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856890"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682856885"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856888"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1940"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856890"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856887"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1941"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-var">isFloatType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682856883"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1942"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1943"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682856891"><span class="annot"><a href="#local-6989586621682856891"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682856892"><span class="annot"><a href="#local-6989586621682856892"><span class="hs-identifier hs-var">mem_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856882"><span class="hs-identifier hs-var">mem</span></a></span><span>
</span><span id="line-1944"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadAmode"><span class="hs-identifier hs-type">loadAmode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-type">floatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856895"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682856891"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856892"><span class="hs-identifier hs-type">mem_code</span></a></span><span>
</span><span id="line-1945"></span><span>
</span><span id="line-1946"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856880"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-var">isWord64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682856883"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1947"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1948"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-1949"></span><span>      </span><span id="local-6989586621682856896"><span class="annot"><span class="annottext">instr :: Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856896"><span class="hs-identifier hs-var hs-var hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856895"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1950"></span><span>                </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span>
</span><span id="line-1951"></span><span>                  </span><span class="hs-comment">-- We always zero-extend 8-bit loads, if we</span><span>
</span><span id="line-1952"></span><span>                  </span><span class="hs-comment">-- can't think of anything better.  This is because</span><span>
</span><span id="line-1953"></span><span>                  </span><span class="hs-comment">-- we can't guarantee access to an 8-bit variant of every register</span><span>
</span><span id="line-1954"></span><span>                  </span><span class="hs-comment">-- (esi and edi don't have 8-bit variants), so to make things</span><span>
</span><span id="line-1955"></span><span>                  </span><span class="hs-comment">-- simpler we do our 8-bit arithmetic with full 32-bit registers.</span><span>
</span><span id="line-1956"></span><span>                </span><span id="local-6989586621682856897"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856897"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856890"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-1957"></span><span>    </span><span id="local-6989586621682856898"><span class="annot"><a href="#local-6989586621682856898"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856896"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856882"><span class="hs-identifier hs-var">mem</span></a></span><span>
</span><span id="line-1958"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856890"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856898"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1959"></span><span>
</span><span id="line-1960"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856880"><span class="hs-identifier hs-var">is32Bit</span></a></span><span>
</span><span id="line-1961"></span><span>  </span><span class="hs-comment">-- Simpler memory load code on x86_64</span><span>
</span><span id="line-1962"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1963"></span><span>    </span><span id="local-6989586621682856899"><span class="annot"><a href="#local-6989586621682856899"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856890"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856882"><span class="hs-identifier hs-var">mem</span></a></span><span>
</span><span id="line-1964"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856890"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856899"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1965"></span><span>
</span><span id="line-1966"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1967"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getRegister(x86) CmmLoad&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856879"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856881"><span class="hs-identifier hs-var">load</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1968"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1969"></span><span>    </span><span id="local-6989586621682856890"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682856890"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682856883"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1970"></span><span>    </span><span id="local-6989586621682856895"><span class="annot"><span class="annottext">width :: Width
</span><a href="#local-6989586621682856895"><span class="hs-identifier hs-var hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682856883"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1971"></span><span>
</span><span id="line-1972"></span><span class="hs-comment">-- Handle symbol references with LEA and %rip-relative addressing.</span><span>
</span><span id="line-1973"></span><span class="hs-comment">-- See Note [%rip-relative addressing on x86-64].</span><span>
</span><span id="line-1974"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682856900"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856900"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682856901"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856901"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682856902"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856902"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1975"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Bool
</span><a href="#local-6989586621682856903"><span class="hs-identifier hs-var">is_label</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856902"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1976"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856901"><span class="hs-identifier hs-var">is32Bit</span></a></span><span>
</span><span id="line-1977"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856904"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682856904"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmLitType"><span class="hs-identifier hs-var">cmmLitType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856900"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856902"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1978"></span><span>           </span><span id="local-6989586621682856906"><span class="annot"><span class="annottext">imm :: Imm
</span><a href="#local-6989586621682856906"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856902"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1979"></span><span>           </span><span id="local-6989586621682856907"><span class="annot"><span class="annottext">op :: Operand
</span><a href="#local-6989586621682856907"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="annot"><span class="annottext">EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseRip"><span class="hs-identifier hs-var">EABaseRip</span></a></span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span> </span><span class="annot"><span class="annottext">Imm
</span><a href="#local-6989586621682856906"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1980"></span><span>           </span><span id="local-6989586621682856909"><span class="annot"><span class="annottext">code :: Reg -&gt; InstrBlock
</span><a href="#local-6989586621682856909"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856910"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856910"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LEA"><span class="hs-identifier hs-var">LEA</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856904"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682856907"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856910"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1981"></span><span>       </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; InstrBlock) -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856904"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682856909"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1982"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1983"></span><span>    </span><span id="local-6989586621682856903"><span class="annot"><span class="annottext">is_label :: CmmLit -&gt; Bool
</span><a href="#local-6989586621682856903"><span class="hs-identifier hs-var hs-var">is_label</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-type">CmmLabel</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1984"></span><span>    </span><span class="annot"><a href="#local-6989586621682856903"><span class="hs-identifier hs-var">is_label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelOff"><span class="hs-identifier hs-type">CmmLabelOff</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1985"></span><span>    </span><span class="annot"><a href="#local-6989586621682856903"><span class="hs-identifier hs-var">is_label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelDiffOff"><span class="hs-identifier hs-type">CmmLabelDiffOff</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1986"></span><span>    </span><span class="annot"><a href="#local-6989586621682856903"><span class="hs-identifier hs-var">is_label</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1987"></span><span>
</span><span id="line-1988"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682856913"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856913"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682856914"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856914"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682856915"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856915"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1989"></span><span>  </span><span id="local-6989586621682856916"><span class="annot"><a href="#local-6989586621682856916"><span class="hs-identifier hs-var">avx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#avxEnabled"><span class="hs-identifier hs-var">avxEnabled</span></a></span><span>
</span><span id="line-1990"></span><span>
</span><span id="line-1991"></span><span>  </span><span class="hs-comment">-- NB: it is important that the code produced here (to load a literal into</span><span>
</span><span id="line-1992"></span><span>  </span><span class="hs-comment">-- a register) doesn't clobber any registers other than the destination</span><span>
</span><span id="line-1993"></span><span>  </span><span class="hs-comment">-- register; the code for generating C calls relies on this property.</span><span>
</span><span id="line-1994"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-1995"></span><span>  </span><span class="hs-comment">-- In particular, we have:</span><span>
</span><span id="line-1996"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-1997"></span><span>  </span><span class="hs-comment">-- &gt; loadIntoRegMightClobberOtherReg (CmmLit _) = False</span><span>
</span><span id="line-1998"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-1999"></span><span>  </span><span class="hs-comment">-- which means that we assume that loading a literal into a register</span><span>
</span><span id="line-2000"></span><span>  </span><span class="hs-comment">-- will not clobber any other registers.</span><span>
</span><span id="line-2001"></span><span>
</span><span id="line-2002"></span><span>  </span><span class="hs-comment">-- TODO: this function mishandles floating-point negative zero,</span><span>
</span><span id="line-2003"></span><span>  </span><span class="hs-comment">-- because -0.0 == 0.0 returns True and because we represent CmmFloat as</span><span>
</span><span id="line-2004"></span><span>  </span><span class="hs-comment">-- Rational, which can't properly represent negative zero.</span><span>
</span><span id="line-2005"></span><span>
</span><span id="line-2006"></span><span>  </span><span class="hs-keyword">if</span><span>
</span><span id="line-2007"></span><span>    </span><span class="hs-comment">-- Zero: use XOR.</span><span>
</span><span id="line-2008"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621682856917"><span class="hs-identifier hs-type">isZeroLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856915"><span class="hs-identifier hs-type">lit</span></a></span><span>
</span><span id="line-2009"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856918"><span class="annot"><a href="#local-6989586621682856918"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856919"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856919"><span class="hs-identifier hs-var">dst</span></a></span></span><span>
</span><span id="line-2010"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Bool
</span><a href="GHC.CmmToAsm.Format.html#isIntFormat"><span class="hs-identifier hs-var">isIntFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856921"><span class="hs-identifier hs-var">fmt</span></a></span><span>
</span><span id="line-2011"></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856922"><span class="annot"><span class="annottext">fmt' :: Format
</span><a href="#local-6989586621682856922"><span class="hs-identifier hs-var hs-var">fmt'</span></a></span></span><span>
</span><span id="line-2012"></span><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856914"><span class="hs-identifier hs-var">is32Bit</span></a></span><span>
</span><span id="line-2013"></span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856921"><span class="hs-identifier hs-var">fmt</span></a></span><span>
</span><span id="line-2014"></span><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2015"></span><span>                     </span><span class="hs-comment">-- x86_64: 32-bit xor is one byte shorter,</span><span>
</span><span id="line-2016"></span><span>                     </span><span class="hs-comment">-- and zero-extends to 64 bits</span><span>
</span><span id="line-2017"></span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856921"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2018"></span><span>                         </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span>
</span><span id="line-2019"></span><span>                         </span><span class="annot"><span class="annottext">Format
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856921"><span class="hs-identifier hs-var">fmt</span></a></span><span>
</span><span id="line-2020"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856922"><span class="hs-identifier hs-var">fmt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856919"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856919"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2021"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856916"><span class="hs-identifier hs-var">avx</span></a></span><span>
</span><span id="line-2022"></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856923"><span class="hs-identifier hs-var">float_or_floatvec</span></a></span><span>
</span><span id="line-2023"></span><span>               </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VXOR"><span class="hs-identifier hs-var">VXOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856921"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856919"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856919"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856919"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2024"></span><span>               </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#VPXOR"><span class="hs-identifier hs-var">VPXOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856921"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856919"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856919"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856919"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2025"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2026"></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682856923"><span class="hs-identifier hs-var">float_or_floatvec</span></a></span><span>
</span><span id="line-2027"></span><span>               </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856921"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856919"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856919"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2028"></span><span>               </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#PXOR"><span class="hs-identifier hs-var">PXOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856921"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856919"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856919"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2029"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856921"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856918"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-2030"></span><span>
</span><span id="line-2031"></span><span>    </span><span class="hs-comment">-- Constant vector: use broadcast.</span><span>
</span><span id="line-2032"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-type">VecFormat</span></a></span><span> </span><span id="local-6989586621682856926"><span class="annot"><a href="#local-6989586621682856926"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682856927"><span class="annot"><a href="#local-6989586621682856927"><span class="hs-identifier hs-var">sFmt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682856921"><span class="hs-identifier hs-type">fmt</span></a></span><span>
</span><span id="line-2033"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmVec"><span class="hs-identifier hs-type">CmmVec</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682856928"><span class="annot"><a href="#local-6989586621682856928"><span class="hs-identifier hs-var">f</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682856929"><span class="annot"><a href="#local-6989586621682856929"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682856915"><span class="hs-identifier hs-type">lit</span></a></span><span>
</span><span id="line-2034"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">==</span></span><span> </span><span class="annot"><span class="hs-identifier">f</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682856929"><span class="hs-identifier hs-type">fs</span></a></span><span>
</span><span id="line-2035"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856930"><span class="annot"><a href="#local-6989586621682856930"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScalarFormat -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#scalarWidth"><span class="hs-identifier hs-var">scalarWidth</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="#local-6989586621682856927"><span class="hs-identifier hs-var">sFmt</span></a></span><span>
</span><span id="line-2036"></span><span>              </span><span id="local-6989586621682856932"><span class="annot"><a href="#local-6989586621682856932"><span class="hs-identifier hs-var hs-var">broadcast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ScalarFormat -&gt; Bool
</span><a href="GHC.CmmToAsm.Format.html#isFloatScalarFormat"><span class="hs-identifier hs-var">isFloatScalarFormat</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarFormat
</span><a href="#local-6989586621682856927"><span class="hs-identifier hs-var">sFmt</span></a></span><span>
</span><span id="line-2037"></span><span>                          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_VF_Broadcast"><span class="hs-identifier hs-var">MO_VF_Broadcast</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856926"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856930"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-2038"></span><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_V_Broadcast"><span class="hs-identifier hs-var">MO_V_Broadcast</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682856926"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682856930"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-2039"></span><span>          </span><span id="local-6989586621682856934"><span class="annot"><a href="#local-6989586621682856934"><span class="hs-identifier hs-var">valCode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856932"><span class="hs-identifier hs-type">broadcast</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856928"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2040"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856921"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856934"><span class="hs-identifier hs-type">valCode</span></a></span><span>
</span><span id="line-2041"></span><span>
</span><span id="line-2042"></span><span>    </span><span class="hs-comment">-- Optimisation for loading small literals on x86_64: take advantage</span><span>
</span><span id="line-2043"></span><span>    </span><span class="hs-comment">-- of the automatic zero-extension from 32 to 64 bits, because the 32-bit</span><span>
</span><span id="line-2044"></span><span>    </span><span class="hs-comment">-- instruction forms are shorter.</span><span>
</span><span id="line-2045"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><a href="#local-6989586621682856914"><span class="hs-identifier hs-type">is32Bit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-type">isWord64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856935"><span class="hs-identifier hs-type">cmmTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682856936"><span class="hs-identifier hs-type">isBigLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856915"><span class="hs-identifier hs-type">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2046"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-2047"></span><span>          </span><span id="local-6989586621682856937"><span class="annot"><a href="#local-6989586621682856937"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856915"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2048"></span><span>          </span><span id="local-6989586621682856938"><span class="annot"><a href="#local-6989586621682856938"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856939"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856939"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="annot"><span class="annottext">Imm
</span><a href="#local-6989586621682856937"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856939"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2049"></span><span>      </span><span class="hs-keyword">in</span><span>
</span><span id="line-2050"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856938"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2051"></span><span>
</span><span id="line-2052"></span><span>    </span><span class="hs-comment">-- Scalar integer: use an immediate.</span><span>
</span><span id="line-2053"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isIntFormat"><span class="hs-identifier hs-type">isIntFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856921"><span class="hs-identifier hs-type">fmt</span></a></span><span>
</span><span id="line-2054"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856940"><span class="annot"><a href="#local-6989586621682856940"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856915"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2055"></span><span>           </span><span id="local-6989586621682856941"><span class="annot"><a href="#local-6989586621682856941"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682856942"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856942"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856921"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="annot"><span class="annottext">Imm
</span><a href="#local-6989586621682856940"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856942"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2056"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856921"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856941"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2057"></span><span>
</span><span id="line-2058"></span><span>    </span><span class="hs-comment">-- General case: load literal from data address.</span><span>
</span><span id="line-2059"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">otherwise</span></span><span>
</span><span id="line-2060"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682856943"><span class="annot"><a href="#local-6989586621682856943"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856921"><span class="hs-identifier hs-var">fmt</span></a></span><span>
</span><span id="line-2061"></span><span>          </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682856945"><span class="annot"><a href="#local-6989586621682856945"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682856946"><span class="annot"><a href="#local-6989586621682856946"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#memConstant"><span class="hs-identifier hs-type">memConstant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#mkAlignment"><span class="hs-identifier hs-type">mkAlignment</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#widthInBytes"><span class="hs-identifier hs-type">widthInBytes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856943"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682856915"><span class="hs-identifier hs-type">lit</span></a></span><span>
</span><span id="line-2062"></span><span>          </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadAmode"><span class="hs-identifier hs-type">loadAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856921"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856945"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856946"><span class="hs-identifier hs-type">addr_code</span></a></span><span>
</span><span id="line-2063"></span><span>
</span><span id="line-2064"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-2065"></span><span>      </span><span id="local-6989586621682856935"><span class="annot"><span class="annottext">cmmTy :: CmmType
</span><a href="#local-6989586621682856935"><span class="hs-identifier hs-var hs-var">cmmTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmLitType"><span class="hs-identifier hs-var">cmmLitType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856913"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682856915"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2066"></span><span>      </span><span id="local-6989586621682856921"><span class="annot"><span class="annottext">fmt :: Format
</span><a href="#local-6989586621682856921"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682856935"><span class="hs-identifier hs-var">cmmTy</span></a></span><span>
</span><span id="line-2067"></span><span>      </span><span id="local-6989586621682856923"><span class="annot"><span class="annottext">float_or_floatvec :: Bool
</span><a href="#local-6989586621682856923"><span class="hs-identifier hs-var hs-var">float_or_floatvec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Bool
</span><a href="GHC.CmmToAsm.Format.html#isFloatOrFloatVecFormat"><span class="hs-identifier hs-var">isFloatOrFloatVecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856921"><span class="hs-identifier hs-var">fmt</span></a></span><span>
</span><span id="line-2068"></span><span>      </span><span id="local-6989586621682856917"><span class="annot"><span class="annottext">isZeroLit :: CmmLit -&gt; Bool
</span><a href="#local-6989586621682856917"><span class="hs-identifier hs-var hs-var">isZeroLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682856957"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856957"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856957"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2069"></span><span>      </span><span class="annot"><a href="#local-6989586621682856917"><span class="hs-identifier hs-var">isZeroLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmFloat"><span class="hs-identifier hs-type">CmmFloat</span></a></span><span> </span><span id="local-6989586621682856959"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682856959"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682856959"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="hs-comment">-- TODO: mishandles negative zero</span><span>
</span><span id="line-2070"></span><span>      </span><span class="annot"><a href="#local-6989586621682856917"><span class="hs-identifier hs-var">isZeroLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmVec"><span class="hs-identifier hs-type">CmmVec</span></a></span><span> </span><span id="local-6989586621682856960"><span class="annot"><span class="annottext">[CmmLit]
</span><a href="#local-6989586621682856960"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CmmLit -&gt; Bool) -&gt; [CmmLit] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Bool
</span><a href="#local-6989586621682856917"><span class="hs-identifier hs-var">isZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmLit]
</span><a href="#local-6989586621682856960"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-2071"></span><span>      </span><span class="annot"><a href="#local-6989586621682856917"><span class="hs-identifier hs-var">isZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2072"></span><span>
</span><span id="line-2073"></span><span>      </span><span id="local-6989586621682856936"><span class="annot"><span class="annottext">isBigLit :: CmmLit -&gt; Bool
</span><a href="#local-6989586621682856936"><span class="hs-identifier hs-var hs-var">isBigLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682856965"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856965"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856965"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682856965"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0xffffffff</span></span><span>
</span><span id="line-2074"></span><span>      </span><span class="annot"><a href="#local-6989586621682856936"><span class="hs-identifier hs-var">isBigLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2075"></span><span>        </span><span class="hs-comment">-- note1: not the same as (not.is32BitLit), because that checks for</span><span>
</span><span id="line-2076"></span><span>        </span><span class="hs-comment">-- signed literals that fit in 32 bits, but we want unsigned</span><span>
</span><span id="line-2077"></span><span>        </span><span class="hs-comment">-- literals here.</span><span>
</span><span id="line-2078"></span><span>        </span><span class="hs-comment">-- note2: all labels are small, because we're assuming the</span><span>
</span><span id="line-2079"></span><span>        </span><span class="hs-comment">-- small memory model. See Note [%rip-relative addressing on x86-64].</span><span>
</span><span id="line-2080"></span><span>
</span><span id="line-2081"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682856968"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856968"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856969"><span class="annot"><span class="annottext">slot :: CmmExpr
</span><a href="#local-6989586621682856969"><span class="hs-identifier hs-var">slot</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmStackSlot"><span class="hs-identifier hs-type">CmmStackSlot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2082"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getRegister(x86) CmmStackSlot&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682856968"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856969"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2083"></span><span>
</span><span id="line-2084"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-type">intLoadCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-2085"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2086"></span><span id="intLoadCode"><span class="annot"><span class="annottext">intLoadCode :: (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var hs-var">intLoadCode</span></a></span></span><span> </span><span id="local-6989586621682856971"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856971"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682856972"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856972"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2087"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682856973"><span class="annot"><a href="#local-6989586621682856973"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682856974"><span class="annot"><a href="#local-6989586621682856974"><span class="hs-identifier hs-var">mem_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856972"><span class="hs-identifier hs-var">mem</span></a></span><span>
</span><span id="line-2088"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682856975"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856975"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856974"><span class="hs-identifier hs-var">mem_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682856971"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682856973"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856975"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2089"></span><span>
</span><span id="line-2090"></span><span class="hs-comment">-- Compute an expression into *any* register, adding the appropriate</span><span>
</span><span id="line-2091"></span><span class="hs-comment">-- move instruction if necessary.</span><span>
</span><span id="line-2092"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2093"></span><span id="getAnyReg"><span class="annot"><span class="annottext">getAnyReg :: HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var hs-var">getAnyReg</span></a></span></span><span> </span><span id="local-6989586621682856980"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856980"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2094"></span><span>  </span><span id="local-6989586621682856981"><span class="annot"><a href="#local-6989586621682856981"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM Register
CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister"><span class="hs-identifier hs-var">getRegister</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682856980"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-2095"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#anyReg"><span class="hs-identifier hs-type">anyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682856981"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-2096"></span><span>
</span><span id="line-2097"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#anyReg"><span class="hs-identifier hs-type">anyReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2098"></span><span id="anyReg"><span class="annot"><span class="annottext">anyReg :: HasDebugCallStack =&gt; Register -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#anyReg"><span class="hs-identifier hs-var hs-var">anyReg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682856988"><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682856988"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Reg -&gt; InstrBlock) -&gt; NatM (Reg -&gt; InstrBlock)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682856988"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-2099"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#anyReg"><span class="hs-identifier hs-var">anyReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span id="local-6989586621682856989"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856989"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682856990"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856990"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682856991"><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856991"><span class="hs-identifier hs-var">fcode</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2100"></span><span>  </span><span id="local-6989586621682856992"><span class="annot"><a href="#local-6989586621682856992"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-2101"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682856993"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856993"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682856991"><span class="hs-identifier hs-var">fcode</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; NCGConfig -&gt; Format -&gt; Reg -&gt; Reg -&gt; Instr
NCGConfig -&gt; Format -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#mkRegRegMoveInstr"><span class="hs-identifier hs-var">mkRegRegMoveInstr</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682856992"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682856989"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856990"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682856993"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2102"></span><span>
</span><span id="line-2103"></span><span class="hs-comment">-- A bit like getSomeReg, but we want a reg that can be byte-addressed.</span><span>
</span><span id="line-2104"></span><span class="hs-comment">-- Fixed registers might not be byte-addressable, so we make sure we've</span><span>
</span><span id="line-2105"></span><span class="hs-comment">-- got a temporary, inserting an extra reg copy if necessary.</span><span>
</span><span id="line-2106"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getByteReg"><span class="hs-identifier hs-type">getByteReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2107"></span><span id="getByteReg"><span class="annot"><span class="annottext">getByteReg :: HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getByteReg"><span class="hs-identifier hs-var hs-var">getByteReg</span></a></span></span><span> </span><span id="local-6989586621682857006"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857006"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2108"></span><span>  </span><span id="local-6989586621682857007"><span class="annot"><a href="#local-6989586621682857007"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-2109"></span><span>  </span><span id="local-6989586621682857008"><span class="annot"><a href="#local-6989586621682857008"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-type">is32BitPlatform</span></a></span><span>
</span><span id="line-2110"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682857008"><span class="hs-identifier hs-type">is32Bit</span></a></span><span>
</span><span id="line-2111"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682857009"><span class="annot"><a href="#local-6989586621682857009"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister"><span class="hs-identifier hs-type">getRegister</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857006"><span class="hs-identifier hs-type">expr</span></a></span><span>
</span><span id="line-2112"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682857009"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2113"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span id="local-6989586621682857010"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857010"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682857011"><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682857011"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2114"></span><span>                    </span><span id="local-6989586621682857012"><span class="annot"><a href="#local-6989586621682857012"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857010"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-2115"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857012"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682857011"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857012"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2116"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span id="local-6989586621682857013"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857013"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682857014"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857014"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682857015"><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857015"><span class="hs-identifier hs-var">code</span></a></span></span><span>
</span><span id="line-2117"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Bool
</span><a href="GHC.Platform.Reg.html#isVirtualReg"><span class="hs-identifier hs-var">isVirtualReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857014"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Reg, InstrBlock) -&gt; NatM (Reg, InstrBlock)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857014"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857015"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2118"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2119"></span><span>                        </span><span id="local-6989586621682857017"><span class="annot"><a href="#local-6989586621682857017"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857013"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-2120"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857017"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682857015"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#mkRegRegMoveInstr"><span class="hs-identifier hs-type">mkRegRegMoveInstr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857007"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857013"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857014"><span class="hs-identifier hs-type">reg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857017"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2121"></span><span>                    </span><span class="hs-comment">-- ToDo: could optimise slightly by checking for</span><span>
</span><span id="line-2122"></span><span>                    </span><span class="hs-comment">-- byte-addressable real registers, but that will</span><span>
</span><span id="line-2123"></span><span>                    </span><span class="hs-comment">-- happen very rarely if at all.</span><span>
</span><span id="line-2124"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857006"><span class="hs-identifier hs-type">expr</span></a></span><span> </span><span class="hs-comment">-- all regs are byte-addressable on x86_64</span><span>
</span><span id="line-2125"></span><span>
</span><span id="line-2126"></span><span class="hs-comment">-- Another variant: this time we want the result in a register that cannot</span><span>
</span><span id="line-2127"></span><span class="hs-comment">-- be modified by code to evaluate an arbitrary expression.</span><span>
</span><span id="line-2128"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-type">getNonClobberedReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2129"></span><span id="getNonClobberedReg"><span class="annot"><span class="annottext">getNonClobberedReg :: HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var hs-var">getNonClobberedReg</span></a></span></span><span> </span><span id="local-6989586621682857030"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857030"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2130"></span><span>  </span><span id="local-6989586621682857031"><span class="annot"><a href="#local-6989586621682857031"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM Register
CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegister"><span class="hs-identifier hs-var">getRegister</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857030"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-2131"></span><span>  </span><span id="local-6989586621682857032"><span class="annot"><a href="#local-6989586621682857032"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-2132"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857033"><span class="annot"><a href="#local-6989586621682857033"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682857032"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-2133"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682857031"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2134"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span id="local-6989586621682857034"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857034"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682857035"><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682857035"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2135"></span><span>        </span><span id="local-6989586621682857036"><span class="annot"><a href="#local-6989586621682857036"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857034"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-2136"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857036"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682857035"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857036"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2137"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span id="local-6989586621682857037"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857037"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682857038"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857038"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682857039"><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857039"><span class="hs-identifier hs-var">code</span></a></span></span><span>
</span><span id="line-2138"></span><span>        </span><span class="hs-comment">-- only certain regs can be clobbered</span><span>
</span><span id="line-2139"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857038"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; [Reg] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; [Reg]
</span><a href="GHC.CmmToAsm.X86.Regs.html#instrClobberedRegs"><span class="hs-identifier hs-var">instrClobberedRegs</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857033"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-2140"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2141"></span><span>                </span><span id="local-6989586621682857042"><span class="annot"><a href="#local-6989586621682857042"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857037"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-2142"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857042"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682857039"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#mkRegRegMoveInstr"><span class="hs-identifier hs-type">mkRegRegMoveInstr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857032"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857037"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857038"><span class="hs-identifier hs-type">reg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857042"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2143"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2144"></span><span>                </span><span class="annot"><span class="annottext">(Reg, InstrBlock) -&gt; NatM (Reg, InstrBlock)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857038"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857039"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2145"></span><span>
</span><span id="line-2146"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2147"></span><span>
</span><span id="line-2148"></span><span class="hs-comment">-- | Convert a 'CmmExpr' representing a memory address into an 'Amode'.</span><span>
</span><span id="line-2149"></span><span class="hs-comment">--</span><span>
</span><span id="line-2150"></span><span class="hs-comment">-- An 'Amode' is a datatype representing a valid address form for the target</span><span>
</span><span id="line-2151"></span><span class="hs-comment">-- (e.g. &quot;Base + Index + disp&quot; or immediate) and the code to compute it.</span><span>
</span><span id="line-2152"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span>
</span><span id="line-2153"></span><span id="getAmode"><span class="annot"><span class="annottext">getAmode :: CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var hs-var">getAmode</span></a></span></span><span> </span><span id="local-6989586621682857043"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857043"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2154"></span><span>   </span><span id="local-6989586621682857044"><span class="annot"><a href="#local-6989586621682857044"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-2155"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857045"><span class="annot"><a href="#local-6989586621682857045"><span class="hs-identifier hs-var hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Bool
</span><a href="GHC.Platform.html#target32Bit"><span class="hs-identifier hs-var">target32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857044"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-2156"></span><span>
</span><span id="line-2157"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682857043"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2158"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmRegOff"><span class="hs-identifier hs-type">CmmRegOff</span></a></span><span> </span><span id="local-6989586621682857046"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682857046"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682857047"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857047"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-2159"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; NatM Amode) -&gt; CmmExpr -&gt; NatM Amode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; Int -&gt; CmmExpr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#mangleIndexTree"><span class="hs-identifier hs-var">mangleIndexTree</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682857046"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857047"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-2160"></span><span>
</span><span id="line-2161"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmGlobal"><span class="hs-identifier hs-type">CmmGlobal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-type">GlobalRegUse</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="GHC.Cmm.Reg.html#PicBaseReg"><span class="hs-identifier hs-var">PicBaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682857048"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857048"><span class="hs-identifier hs-var">displacement</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-2162"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682857045"><span class="hs-identifier hs-var">is32Bit</span></a></span><span>
</span><span id="line-2163"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Amode -&gt; NatM Amode
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Amode -&gt; NatM Amode) -&gt; Amode -&gt; NatM Amode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AddrMode -&gt; InstrBlock -&gt; Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-var">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#ripRel"><span class="hs-identifier hs-var">ripRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857048"><span class="hs-identifier hs-var">displacement</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-2164"></span><span>
</span><span id="line-2165"></span><span>      </span><span class="hs-comment">-- This is all just ridiculous, since it carefully undoes</span><span>
</span><span id="line-2166"></span><span>      </span><span class="hs-comment">-- what mangleIndexTree has just done.</span><span>
</span><span id="line-2167"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Sub"><span class="hs-identifier hs-type">MO_Sub</span></a></span><span> </span><span id="local-6989586621682857049"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857049"><span class="hs-identifier hs-var">_rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682857050"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857050"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682857051"><span class="annot"><span class="annottext">lit :: CmmLit
</span><a href="#local-6989586621682857051"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682857052"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857052"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2168"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857044"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857051"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2169"></span><span>         </span><span class="hs-comment">-- assert (rep == II32)???</span><span>
</span><span id="line-2170"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2171"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682857054"><span class="annot"><a href="#local-6989586621682857054"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857055"><span class="annot"><a href="#local-6989586621682857055"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857050"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2172"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857056"><span class="annot"><a href="#local-6989586621682857056"><span class="hs-identifier hs-var hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2173"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-type">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-type">EABaseReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857054"><span class="hs-identifier hs-type">x_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-type">EAIndexNone</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857056"><span class="hs-identifier hs-type">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682857055"><span class="hs-identifier hs-type">x_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2174"></span><span>
</span><span id="line-2175"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span id="local-6989586621682857057"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857057"><span class="hs-identifier hs-var">_rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682857058"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857058"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682857059"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857059"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-2176"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857044"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857059"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2177"></span><span>         </span><span class="hs-comment">-- assert (rep == II32)???</span><span>
</span><span id="line-2178"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2179"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682857060"><span class="annot"><a href="#local-6989586621682857060"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857061"><span class="annot"><a href="#local-6989586621682857061"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857058"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2180"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857062"><span class="annot"><a href="#local-6989586621682857062"><span class="hs-identifier hs-var hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857059"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2181"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-type">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-type">EABaseReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857060"><span class="hs-identifier hs-type">x_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-type">EAIndexNone</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857062"><span class="hs-identifier hs-type">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682857061"><span class="hs-identifier hs-type">x_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2182"></span><span>
</span><span id="line-2183"></span><span>      </span><span class="hs-comment">-- Turn (lit1 &lt;&lt; n  + lit2) into  (lit2 + lit1 &lt;&lt; n) so it will be</span><span>
</span><span id="line-2184"></span><span>      </span><span class="hs-comment">-- recognised by the next rule.</span><span>
</span><span id="line-2185"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span id="local-6989586621682857063"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857063"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682857064"><span class="annot"><span class="annottext">a :: CmmExpr
</span><a href="#local-6989586621682857064"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Shl"><span class="hs-identifier hs-type">MO_Shl</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857065"><span class="annot"><span class="annottext">b :: CmmExpr
</span><a href="#local-6989586621682857065"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2186"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-var">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857063"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857065"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857064"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2187"></span><span>
</span><span id="line-2188"></span><span>      </span><span class="hs-comment">-- Matches: (x + offset) + (y &lt;&lt; shift)</span><span>
</span><span id="line-2189"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmRegOff"><span class="hs-identifier hs-type">CmmRegOff</span></a></span><span> </span><span id="local-6989586621682857066"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682857066"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682857067"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857067"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Shl"><span class="hs-identifier hs-type">MO_Shl</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682857068"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857068"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682857069"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857069"><span class="hs-identifier hs-var">shift</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-2190"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857069"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857069"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857069"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857069"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span>
</span><span id="line-2191"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr -&gt; Integer -&gt; Integer -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#x86_complex_amode"><span class="hs-identifier hs-var">x86_complex_amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682857066"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857068"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857069"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857067"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2192"></span><span>
</span><span id="line-2193"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682857071"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857071"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Shl"><span class="hs-identifier hs-type">MO_Shl</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682857072"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857072"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682857073"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857073"><span class="hs-identifier hs-var">shift</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-2194"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857073"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857073"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857073"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857073"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span>
</span><span id="line-2195"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr -&gt; Integer -&gt; Integer -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#x86_complex_amode"><span class="hs-identifier hs-var">x86_complex_amode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857071"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857072"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857073"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2196"></span><span>
</span><span id="line-2197"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682857074"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857074"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Shl"><span class="hs-identifier hs-type">MO_Shl</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-2198"></span><span>                                                    </span><span class="hs-special">[</span><span id="local-6989586621682857075"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857075"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682857076"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857076"><span class="hs-identifier hs-var">shift</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682857077"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857077"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-2199"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857076"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857076"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857076"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857076"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span>
</span><span id="line-2200"></span><span>         </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-var">is32BitInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857077"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-2201"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr -&gt; Integer -&gt; Integer -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#x86_complex_amode"><span class="hs-identifier hs-var">x86_complex_amode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857074"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857075"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857076"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857077"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-2202"></span><span>
</span><span id="line-2203"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682857078"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857078"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857079"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857079"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-2204"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; Bool
</span><a href="GHC.Cmm.Expr.html#isLit"><span class="hs-identifier hs-var">isLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857079"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- we already handle valid literals above.</span><span>
</span><span id="line-2205"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr -&gt; Integer -&gt; Integer -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#x86_complex_amode"><span class="hs-identifier hs-var">x86_complex_amode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857078"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857079"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2206"></span><span>
</span><span id="line-2207"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682857081"><span class="annot"><span class="annottext">lit :: CmmLit
</span><a href="#local-6989586621682857081"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmFloat"><span class="hs-identifier hs-type">CmmFloat</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2208"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; NatM Amode
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;X86 CodeGen: attempt to use floating-point value as a memory address&quot;</span></span><span>
</span><span id="line-2209"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857081"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2210"></span><span>
</span><span id="line-2211"></span><span>      </span><span class="hs-comment">-- Handle labels with %rip-relative addressing since in general the image</span><span>
</span><span id="line-2212"></span><span>      </span><span class="hs-comment">-- may be loaded anywhere in the 64-bit address space (e.g. on Windows</span><span>
</span><span id="line-2213"></span><span>      </span><span class="hs-comment">-- with high-entropy ASLR). See Note [%rip-relative addressing on x86-64].</span><span>
</span><span id="line-2214"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682857082"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857082"><span class="hs-identifier hs-var">lit</span></a></span></span><span>
</span><span id="line-2215"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682857045"><span class="hs-identifier hs-var">is32Bit</span></a></span><span>
</span><span id="line-2216"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Bool
</span><a href="#local-6989586621682857083"><span class="hs-identifier hs-var">is_label</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857082"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2217"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Amode -&gt; NatM Amode
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; InstrBlock -&gt; Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-var">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="annot"><span class="annottext">EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseRip"><span class="hs-identifier hs-var">EABaseRip</span></a></span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857082"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2218"></span><span>
</span><span id="line-2219"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682857084"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857084"><span class="hs-identifier hs-var">lit</span></a></span></span><span>
</span><span id="line-2220"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857044"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857084"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2221"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Amode -&gt; NatM Amode
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; InstrBlock -&gt; Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-var">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Int -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmAddr"><span class="hs-identifier hs-var">ImmAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857084"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2222"></span><span>
</span><span id="line-2223"></span><span>      </span><span class="hs-comment">-- Literal with offsets too big (&gt; 32 bits) fails during the linking phase</span><span>
</span><span id="line-2224"></span><span>      </span><span class="hs-comment">-- (#15570). We already handled valid literals above so we don't have to</span><span>
</span><span id="line-2225"></span><span>      </span><span class="hs-comment">-- test anything here.</span><span>
</span><span id="line-2226"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelOff"><span class="hs-identifier hs-type">CmmLabelOff</span></a></span><span> </span><span id="local-6989586621682857086"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682857086"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682857087"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857087"><span class="hs-identifier hs-var">off</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2227"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-var">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682857086"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2228"></span><span>                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857087"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2229"></span><span>                                             </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2230"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelDiffOff"><span class="hs-identifier hs-type">CmmLabelDiffOff</span></a></span><span> </span><span id="local-6989586621682857088"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682857088"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621682857089"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682857089"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span id="local-6989586621682857090"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857090"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span id="local-6989586621682857091"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857091"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2231"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-var">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; CLabel -&gt; Int -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmLabelDiffOff"><span class="hs-identifier hs-var">CmmLabelDiffOff</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682857088"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682857089"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857091"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2232"></span><span>                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857090"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2233"></span><span>                                             </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2234"></span><span>
</span><span id="line-2235"></span><span>      </span><span class="hs-comment">-- in case we can't do something better, we just compute the expression</span><span>
</span><span id="line-2236"></span><span>      </span><span class="hs-comment">-- and put the result in a register</span><span>
</span><span id="line-2237"></span><span>      </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2238"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682857092"><span class="annot"><a href="#local-6989586621682857092"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857093"><span class="annot"><a href="#local-6989586621682857093"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857043"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2239"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-type">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-type">EABaseReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857092"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-type">EAIndexNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682857093"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2240"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2241"></span><span>    </span><span id="local-6989586621682857083"><span class="annot"><span class="annottext">is_label :: CmmLit -&gt; Bool
</span><a href="#local-6989586621682857083"><span class="hs-identifier hs-var hs-var">is_label</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-type">CmmLabel</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2242"></span><span>    </span><span class="annot"><a href="#local-6989586621682857083"><span class="hs-identifier hs-var">is_label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelOff"><span class="hs-identifier hs-type">CmmLabelOff</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2243"></span><span>    </span><span class="annot"><a href="#local-6989586621682857083"><span class="hs-identifier hs-var">is_label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelDiffOff"><span class="hs-identifier hs-type">CmmLabelDiffOff</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2244"></span><span>    </span><span class="annot"><a href="#local-6989586621682857083"><span class="hs-identifier hs-var">is_label</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2245"></span><span>
</span><span id="line-2246"></span><span>
</span><span id="line-2247"></span><span class="hs-comment">-- | Like 'getAmode', but on 32-bit use simple register addressing</span><span>
</span><span id="line-2248"></span><span class="hs-comment">-- (i.e. no index register). This stops us from running out of</span><span>
</span><span id="line-2249"></span><span class="hs-comment">-- registers on x86 when using instructions such as cmpxchg, which can</span><span>
</span><span id="line-2250"></span><span class="hs-comment">-- use up to three virtual registers and one fixed register.</span><span>
</span><span id="line-2251"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSimpleAmode"><span class="hs-identifier hs-type">getSimpleAmode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span>
</span><span id="line-2252"></span><span id="getSimpleAmode"><span class="annot"><span class="annottext">getSimpleAmode :: CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSimpleAmode"><span class="hs-identifier hs-var hs-var">getSimpleAmode</span></a></span></span><span> </span><span id="local-6989586621682857095"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857095"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NatM Bool -&gt; (Bool -&gt; NatM Amode) -&gt; NatM Amode
forall a b. NatM a -&gt; (a -&gt; NatM b) -&gt; NatM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-2253"></span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857095"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-2254"></span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2255"></span><span>    </span><span id="local-6989586621682857096"><span class="annot"><a href="#local-6989586621682857096"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857095"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-2256"></span><span>    </span><span id="local-6989586621682857097"><span class="annot"><a href="#local-6989586621682857097"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-2257"></span><span>    </span><span id="local-6989586621682857098"><span class="annot"><a href="#local-6989586621682857098"><span class="hs-identifier hs-var">addr_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgWordWidth"><span class="hs-identifier hs-type">ncgWordWidth</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857097"><span class="hs-identifier hs-type">config</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2258"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857099"><span class="annot"><a href="#local-6989586621682857099"><span class="hs-identifier hs-var hs-var">amode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857098"><span class="hs-identifier hs-var">addr_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-2259"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857099"><span class="hs-identifier hs-type">amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857096"><span class="hs-identifier hs-type">addr_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857098"><span class="hs-identifier hs-type">addr_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2260"></span><span>
</span><span id="line-2261"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#x86_complex_amode"><span class="hs-identifier hs-type">x86_complex_amode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span>
</span><span id="line-2262"></span><span id="x86_complex_amode"><span class="annot"><span class="annottext">x86_complex_amode :: CmmExpr -&gt; CmmExpr -&gt; Integer -&gt; Integer -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#x86_complex_amode"><span class="hs-identifier hs-var hs-var">x86_complex_amode</span></a></span></span><span> </span><span id="local-6989586621682857100"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857100"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span id="local-6989586621682857101"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857101"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621682857102"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857102"><span class="hs-identifier hs-var">shift</span></a></span></span><span> </span><span id="local-6989586621682857103"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857103"><span class="hs-identifier hs-var">offset</span></a></span></span><span>
</span><span id="line-2263"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682857104"><span class="annot"><a href="#local-6989586621682857104"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857105"><span class="annot"><a href="#local-6989586621682857105"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857100"><span class="hs-identifier hs-var">base</span></a></span><span>
</span><span id="line-2264"></span><span>        </span><span class="hs-comment">-- x must be in a temp, because it has to stay live over y_code</span><span>
</span><span id="line-2265"></span><span>        </span><span class="hs-comment">-- we could compare x_reg and y_reg and do something better here...</span><span>
</span><span id="line-2266"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621682857106"><span class="annot"><a href="#local-6989586621682857106"><span class="hs-identifier hs-var">y_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857107"><span class="annot"><a href="#local-6989586621682857107"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857101"><span class="hs-identifier hs-type">index</span></a></span><span>
</span><span id="line-2267"></span><span>       </span><span class="hs-keyword">let</span><span>
</span><span id="line-2268"></span><span>           </span><span id="local-6989586621682857108"><span class="annot"><a href="#local-6989586621682857108"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857105"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857107"><span class="hs-identifier hs-var">y_code</span></a></span><span>
</span><span id="line-2269"></span><span>           </span><span id="local-6989586621682857109"><span class="annot"><a href="#local-6989586621682857109"><span class="hs-identifier hs-var hs-var">base</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857102"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">;</span><span>
</span><span id="line-2270"></span><span>                                </span><span id="local-6989586621682857110"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857110"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int) -&gt; String -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;x86_complex_amode: unhandled shift! (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857110"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-2271"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-type">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-type">EABaseReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857104"><span class="hs-identifier hs-type">x_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EAIndex"><span class="hs-identifier hs-type">EAIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857106"><span class="hs-identifier hs-type">y_reg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857109"><span class="hs-identifier hs-type">base</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621682857103"><span class="hs-identifier hs-type">offset</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2272"></span><span>               </span><span class="annot"><a href="#local-6989586621682857108"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2273"></span><span>
</span><span id="line-2274"></span><span>
</span><span id="line-2275"></span><span>
</span><span id="line-2276"></span><span>
</span><span id="line-2277"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2278"></span><span class="hs-comment">-- getOperand: sometimes any operand will do.</span><span>
</span><span id="line-2279"></span><span>
</span><span id="line-2280"></span><span class="hs-comment">-- getNonClobberedOperand: the value of the operand will remain valid across</span><span>
</span><span id="line-2281"></span><span class="hs-comment">-- the computation of an arbitrary expression, unless the expression</span><span>
</span><span id="line-2282"></span><span class="hs-comment">-- is computed directly into a register which the operand refers to</span><span>
</span><span id="line-2283"></span><span class="hs-comment">-- (see trivialCode where this function is used for an example).</span><span>
</span><span id="line-2284"></span><span>
</span><span id="line-2285"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand"><span class="hs-identifier hs-type">getNonClobberedOperand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2286"></span><span id="getNonClobberedOperand"><span class="annot"><span class="annottext">getNonClobberedOperand :: CmmExpr -&gt; NatM (Operand, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand"><span class="hs-identifier hs-var hs-var">getNonClobberedOperand</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682857113"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857113"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2287"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isSuitableFloatingPointLit"><span class="hs-identifier hs-var">isSuitableFloatingPointLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857113"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2288"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2289"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmFloat"><span class="hs-identifier hs-type">CmmFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682857115"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857115"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857113"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2290"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682857116"><span class="annot"><a href="#local-6989586621682857116"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682857117"><span class="annot"><a href="#local-6989586621682857117"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Alignment -&gt; CmmLit -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#memConstant"><span class="hs-identifier hs-var">memConstant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Alignment
</span><a href="GHC.Types.Basic.html#mkAlignment"><span class="hs-identifier hs-var">mkAlignment</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Alignment) -&gt; Int -&gt; Alignment
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBytes"><span class="hs-identifier hs-var">widthInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857115"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857113"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2291"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857116"><span class="hs-identifier hs-type">addr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682857117"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2292"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2293"></span><span>    </span><span id="local-6989586621682857118"><span class="annot"><a href="#local-6989586621682857118"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-2294"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-type">is32BitLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857118"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857113"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isIntFormat"><span class="hs-identifier hs-type">isIntFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-type">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#cmmLitType"><span class="hs-identifier hs-type">cmmLitType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857118"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857113"><span class="hs-identifier hs-type">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2295"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-type">litToImm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857113"><span class="hs-identifier hs-type">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2296"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand_generic"><span class="hs-identifier hs-type">getNonClobberedOperand_generic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857113"><span class="hs-identifier hs-type">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2297"></span><span>
</span><span id="line-2298"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand"><span class="hs-identifier hs-var">getNonClobberedOperand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682857120"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857120"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621682857121"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857121"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2299"></span><span>  </span><span id="local-6989586621682857122"><span class="annot"><a href="#local-6989586621682857122"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-2300"></span><span>  </span><span class="hs-comment">-- this logic could be simplified</span><span>
</span><span id="line-2301"></span><span>  </span><span class="hs-comment">-- TODO FIXME</span><span>
</span><span id="line-2302"></span><span>  </span><span class="hs-keyword">if</span><span>   </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682857122"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-type">isWord64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857121"><span class="hs-identifier hs-type">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-2303"></span><span>      </span><span class="hs-comment">-- if 32bit and ty is at float/double/simd value</span><span>
</span><span id="line-2304"></span><span>      </span><span class="hs-comment">-- or if 64bit</span><span>
</span><span id="line-2305"></span><span>      </span><span class="hs-comment">--  this could use some eyeballs or i'll need to stare at it more later</span><span>
</span><span id="line-2306"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2307"></span><span>      </span><span id="local-6989586621682857123"><span class="annot"><a href="#local-6989586621682857123"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-2308"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682857124"><span class="annot"><a href="#local-6989586621682857124"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682857125"><span class="annot"><a href="#local-6989586621682857125"><span class="hs-identifier hs-var">mem_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857120"><span class="hs-identifier hs-type">mem</span></a></span><span>
</span><span id="line-2309"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682857126"><span class="annot"><a href="#local-6989586621682857126"><span class="hs-identifier hs-var">src'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857127"><span class="annot"><a href="#local-6989586621682857127"><span class="hs-identifier hs-var">save_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-2310"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#amodeCouldBeClobbered"><span class="hs-identifier hs-type">amodeCouldBeClobbered</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857123"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857124"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2311"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2312"></span><span>                   </span><span id="local-6989586621682857129"><span class="annot"><a href="#local-6989586621682857129"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-type">archWordFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857122"><span class="hs-identifier hs-type">is32Bit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2313"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-type">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-type">EABaseReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857129"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-type">EAIndexNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2314"></span><span>                           </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#LEA"><span class="hs-identifier hs-type">LEA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-type">archWordFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857122"><span class="hs-identifier hs-type">is32Bit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2315"></span><span>                                       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857124"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2316"></span><span>                                       </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857129"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2317"></span><span>                </span><span class="hs-keyword">else</span><span>
</span><span id="line-2318"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857124"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2319"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857126"><span class="hs-identifier hs-type">src'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682857125"><span class="hs-identifier hs-type">mem_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857127"><span class="hs-identifier hs-type">save_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2320"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-2321"></span><span>      </span><span class="hs-comment">-- if its a word or gcptr on 32bit?</span><span>
</span><span id="line-2322"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand_generic"><span class="hs-identifier hs-type">getNonClobberedOperand_generic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857120"><span class="hs-identifier hs-type">mem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857121"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#NaturallyAligned"><span class="hs-identifier hs-type">NaturallyAligned</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2323"></span><span>
</span><span id="line-2324"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand"><span class="hs-identifier hs-var">getNonClobberedOperand</span></a></span><span> </span><span id="local-6989586621682857130"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857130"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand_generic"><span class="hs-identifier hs-var">getNonClobberedOperand_generic</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857130"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2325"></span><span>
</span><span id="line-2326"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand_generic"><span class="hs-identifier hs-type">getNonClobberedOperand_generic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2327"></span><span id="getNonClobberedOperand_generic"><span class="annot"><span class="annottext">getNonClobberedOperand_generic :: CmmExpr -&gt; NatM (Operand, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand_generic"><span class="hs-identifier hs-var hs-var">getNonClobberedOperand_generic</span></a></span></span><span> </span><span id="local-6989586621682857131"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857131"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2328"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682857132"><span class="annot"><a href="#local-6989586621682857132"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857133"><span class="annot"><a href="#local-6989586621682857133"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857131"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2329"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857132"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682857133"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2330"></span><span>
</span><span id="line-2331"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#amodeCouldBeClobbered"><span class="hs-identifier hs-type">amodeCouldBeClobbered</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrMode"><span class="hs-identifier hs-type">AddrMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2332"></span><span id="amodeCouldBeClobbered"><span class="annot"><span class="annottext">amodeCouldBeClobbered :: Platform -&gt; AddrMode -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#amodeCouldBeClobbered"><span class="hs-identifier hs-var hs-var">amodeCouldBeClobbered</span></a></span></span><span> </span><span id="local-6989586621682857134"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857134"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682857135"><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682857135"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Reg -&gt; Bool) -&gt; [Reg] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Reg -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#regClobbered"><span class="hs-identifier hs-var">regClobbered</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857134"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; [Reg]
</span><a href="GHC.CmmToAsm.X86.Regs.html#addrModeRegs"><span class="hs-identifier hs-var">addrModeRegs</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682857135"><span class="hs-identifier hs-var">amode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2333"></span><span>
</span><span id="line-2334"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#regClobbered"><span class="hs-identifier hs-type">regClobbered</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2335"></span><span id="regClobbered"><span class="annot"><span class="annottext">regClobbered :: Platform -&gt; Reg -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#regClobbered"><span class="hs-identifier hs-var hs-var">regClobbered</span></a></span></span><span> </span><span id="local-6989586621682857139"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857139"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#RegReal"><span class="hs-identifier hs-type">RegReal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#RealRegSingle"><span class="hs-identifier hs-type">RealRegSingle</span></a></span><span> </span><span id="local-6989586621682857141"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857141"><span class="hs-identifier hs-var">rr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Int -&gt; Bool
</span><a href="GHC.Platform.Regs.html#freeReg"><span class="hs-identifier hs-var">freeReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857139"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857141"><span class="hs-identifier hs-var">rr</span></a></span><span>
</span><span id="line-2336"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#regClobbered"><span class="hs-identifier hs-var">regClobbered</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Reg
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2337"></span><span>
</span><span id="line-2338"></span><span class="hs-comment">-- getOperand: the operand is not required to remain valid across the</span><span>
</span><span id="line-2339"></span><span class="hs-comment">-- computation of an arbitrary expression.</span><span>
</span><span id="line-2340"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-type">getOperand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2341"></span><span>
</span><span id="line-2342"></span><span id="getOperand"><span class="annot"><span class="annottext">getOperand :: CmmExpr -&gt; NatM (Operand, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-var hs-var">getOperand</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682857144"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857144"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2343"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isSuitableFloatingPointLit"><span class="hs-identifier hs-var">isSuitableFloatingPointLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857144"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2344"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2345"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmFloat"><span class="hs-identifier hs-type">CmmFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682857145"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857145"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857144"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2346"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682857146"><span class="annot"><a href="#local-6989586621682857146"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682857147"><span class="annot"><a href="#local-6989586621682857147"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Alignment -&gt; CmmLit -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#memConstant"><span class="hs-identifier hs-var">memConstant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Alignment
</span><a href="GHC.Types.Basic.html#mkAlignment"><span class="hs-identifier hs-var">mkAlignment</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Alignment) -&gt; Int -&gt; Alignment
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBytes"><span class="hs-identifier hs-var">widthInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857145"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857144"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2347"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857146"><span class="hs-identifier hs-type">addr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682857147"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2348"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2349"></span><span>
</span><span id="line-2350"></span><span>  </span><span id="local-6989586621682857148"><span class="annot"><a href="#local-6989586621682857148"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-2351"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-type">is32BitLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857148"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857144"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isIntFormat"><span class="hs-identifier hs-type">isIntFormat</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-type">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#cmmLitType"><span class="hs-identifier hs-type">cmmLitType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857148"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857144"><span class="hs-identifier hs-type">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2352"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-type">litToImm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857144"><span class="hs-identifier hs-type">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2353"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand_generic"><span class="hs-identifier hs-type">getOperand_generic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857144"><span class="hs-identifier hs-type">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2354"></span><span>
</span><span id="line-2355"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-var">getOperand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682857150"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857150"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621682857151"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857151"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2356"></span><span>  </span><span id="local-6989586621682857152"><span class="annot"><a href="#local-6989586621682857152"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-2357"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isIntFormat"><span class="hs-identifier hs-type">isIntFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-type">cmmTypeFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857151"><span class="hs-identifier hs-type">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682857152"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-type">isWord64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857151"><span class="hs-identifier hs-type">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-2358"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2359"></span><span>       </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682857153"><span class="annot"><a href="#local-6989586621682857153"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682857154"><span class="annot"><a href="#local-6989586621682857154"><span class="hs-identifier hs-var">mem_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857150"><span class="hs-identifier hs-type">mem</span></a></span><span>
</span><span id="line-2360"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857153"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682857154"><span class="hs-identifier hs-type">mem_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2361"></span><span>     </span><span class="hs-keyword">else</span><span>
</span><span id="line-2362"></span><span>       </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand_generic"><span class="hs-identifier hs-type">getOperand_generic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857150"><span class="hs-identifier hs-type">mem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857151"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#NaturallyAligned"><span class="hs-identifier hs-type">NaturallyAligned</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2363"></span><span>
</span><span id="line-2364"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-var">getOperand</span></a></span><span> </span><span id="local-6989586621682857155"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857155"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand_generic"><span class="hs-identifier hs-var">getOperand_generic</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857155"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2365"></span><span>
</span><span id="line-2366"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand_generic"><span class="hs-identifier hs-type">getOperand_generic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2367"></span><span id="getOperand_generic"><span class="annot"><span class="annottext">getOperand_generic :: CmmExpr -&gt; NatM (Operand, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand_generic"><span class="hs-identifier hs-var hs-var">getOperand_generic</span></a></span></span><span> </span><span id="local-6989586621682857156"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857156"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2368"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682857157"><span class="annot"><a href="#local-6989586621682857157"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857158"><span class="annot"><a href="#local-6989586621682857158"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857156"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2369"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857157"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682857158"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2370"></span><span>
</span><span id="line-2371"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isOperand"><span class="hs-identifier hs-type">isOperand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2372"></span><span id="isOperand"><span class="annot"><span class="annottext">isOperand :: Platform -&gt; CmmExpr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isOperand"><span class="hs-identifier hs-var hs-var">isOperand</span></a></span></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2373"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isOperand"><span class="hs-identifier hs-var">isOperand</span></a></span><span> </span><span id="local-6989586621682857160"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857160"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682857161"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857161"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2374"></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857160"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857161"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2375"></span><span>                          </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isSuitableFloatingPointLit"><span class="hs-identifier hs-var">isSuitableFloatingPointLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857161"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2376"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isOperand"><span class="hs-identifier hs-var">isOperand</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2377"></span><span>
</span><span id="line-2378"></span><span class="hs-comment">-- | Given a 'Register', produce a new 'Register' with an instruction block</span><span>
</span><span id="line-2379"></span><span class="hs-comment">-- which will check the value for alignment. Used for @-falignment-sanitisation@.</span><span>
</span><span id="line-2380"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#addAlignmentCheck"><span class="hs-identifier hs-type">addAlignmentCheck</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-2381"></span><span id="addAlignmentCheck"><span class="annot"><span class="annottext">addAlignmentCheck :: Int -&gt; Register -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#addAlignmentCheck"><span class="hs-identifier hs-var hs-var">addAlignmentCheck</span></a></span></span><span> </span><span id="local-6989586621682857162"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857162"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span id="local-6989586621682857163"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621682857163"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2382"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621682857163"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2383"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span id="local-6989586621682857164"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857164"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span id="local-6989586621682857165"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857165"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682857166"><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857166"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; InstrBlock -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Fixed"><span class="hs-identifier hs-var">Fixed</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857164"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857165"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857166"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; InstrBlock
</span><a href="#local-6989586621682857167"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857164"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857165"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2384"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span id="local-6989586621682857168"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857168"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span id="local-6989586621682857169"><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682857169"><span class="hs-identifier hs-var">f</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; InstrBlock) -&gt; Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857168"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682857170"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857170"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682857169"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857170"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; InstrBlock
</span><a href="#local-6989586621682857167"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857168"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857170"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2385"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2386"></span><span>    </span><span class="annot"><a href="#local-6989586621682857167"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2387"></span><span>    </span><span id="local-6989586621682857167"><span class="annot"><span class="annottext">check :: Format -&gt; Reg -&gt; InstrBlock
</span><a href="#local-6989586621682857167"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span id="local-6989586621682857171"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857171"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span id="local-6989586621682857172"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857172"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2388"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; InstrBlock -&gt; InstrBlock
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Bool
</span><a href="GHC.CmmToAsm.Format.html#isIntFormat"><span class="hs-identifier hs-var">isIntFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857171"><span class="hs-identifier hs-var">fmt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(InstrBlock -&gt; InstrBlock) -&gt; InstrBlock -&gt; InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2389"></span><span>        </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TEST"><span class="hs-identifier hs-var">TEST</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857171"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="annot"><span class="annottext">(Imm -&gt; Operand) -&gt; Imm -&gt; Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Imm) -&gt; Int -&gt; Imm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857162"><span class="hs-identifier hs-var">align</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857172"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2390"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Imm -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX_GBL"><span class="hs-identifier hs-var">JXX_GBL</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span> </span><span class="annot"><span class="annottext">(Imm -&gt; Instr) -&gt; Imm -&gt; Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CLabel -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmCLbl"><span class="hs-identifier hs-var">ImmCLbl</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="GHC.Cmm.CLabel.html#mkBadAlignmentLabel"><span class="hs-identifier hs-var">mkBadAlignmentLabel</span></a></span><span>
</span><span id="line-2391"></span><span>             </span><span class="hs-special">]</span><span>
</span><span id="line-2392"></span><span>
</span><span id="line-2393"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#memConstant"><span class="hs-identifier hs-type">memConstant</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span>
</span><span id="line-2394"></span><span id="memConstant"><span class="annot"><span class="annottext">memConstant :: Alignment -&gt; CmmLit -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#memConstant"><span class="hs-identifier hs-var hs-var">memConstant</span></a></span></span><span> </span><span id="local-6989586621682857177"><span class="annot"><span class="annottext">Alignment
</span><a href="#local-6989586621682857177"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span id="local-6989586621682857178"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857178"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2395"></span><span>  </span><span id="local-6989586621682857179"><span class="annot"><a href="#local-6989586621682857179"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM CLabel
</span><a href="GHC.CmmToAsm.Monad.html#getNewLabelNat"><span class="hs-identifier hs-var">getNewLabelNat</span></a></span><span>
</span><span id="line-2396"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857180"><span class="annot"><a href="#local-6989586621682857180"><span class="hs-identifier hs-var hs-var">rosection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SectionType -&gt; CLabel -&gt; Section
</span><a href="GHC.Cmm.html#Section"><span class="hs-identifier hs-var">Section</span></a></span><span> </span><span class="annot"><span class="annottext">SectionType
</span><a href="GHC.Cmm.html#ReadOnlyData"><span class="hs-identifier hs-var">ReadOnlyData</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682857179"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-2397"></span><span>  </span><span id="local-6989586621682857183"><span class="annot"><a href="#local-6989586621682857183"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-2398"></span><span>  </span><span id="local-6989586621682857184"><span class="annot"><a href="#local-6989586621682857184"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2399"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682857185"><span class="annot"><a href="#local-6989586621682857185"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857186"><span class="annot"><a href="#local-6989586621682857186"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.Platform.html#target32Bit"><span class="hs-identifier hs-type">target32Bit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857184"><span class="hs-identifier hs-type">platform</span></a></span><span>
</span><span id="line-2400"></span><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682857187"><span class="annot"><a href="#local-6989586621682857187"><span class="hs-identifier hs-var">dynRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#cmmMakeDynamicReference"><span class="hs-identifier hs-type">cmmMakeDynamicReference</span></a></span><span>
</span><span id="line-2401"></span><span>                                             </span><span class="annot"><a href="#local-6989586621682857183"><span class="hs-identifier hs-type">config</span></a></span><span>
</span><span id="line-2402"></span><span>                                             </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#DataReference"><span class="hs-identifier hs-type">DataReference</span></a></span><span>
</span><span id="line-2403"></span><span>                                             </span><span class="annot"><a href="#local-6989586621682857179"><span class="hs-identifier hs-type">lbl</span></a></span><span>
</span><span id="line-2404"></span><span>                               </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682857190"><span class="annot"><a href="#local-6989586621682857190"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682857191"><span class="annot"><a href="#local-6989586621682857191"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857187"><span class="hs-identifier hs-type">dynRef</span></a></span><span>
</span><span id="line-2405"></span><span>                               </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857190"><span class="hs-identifier hs-type">addr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682857191"><span class="hs-identifier hs-type">addr_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2406"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ripRel"><span class="hs-identifier hs-type">ripRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmCLbl"><span class="hs-identifier hs-type">ImmCLbl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857179"><span class="hs-identifier hs-type">lbl</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2407"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857192"><span class="annot"><a href="#local-6989586621682857192"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2408"></span><span>        </span><span class="annot"><span class="annottext">Section -&gt; (Alignment, RawCmmStatics) -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LDATA"><span class="hs-identifier hs-var">LDATA</span></a></span><span> </span><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682857180"><span class="hs-identifier hs-var">rosection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Alignment
</span><a href="#local-6989586621682857177"><span class="hs-identifier hs-var">align</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CLabel -&gt; [CmmStatic] -&gt; RawCmmStatics
forall (rawOnly :: Bool).
CLabel -&gt; [CmmStatic] -&gt; GenCmmStatics rawOnly
</span><a href="GHC.Cmm.html#CmmStaticsRaw"><span class="hs-identifier hs-var">CmmStaticsRaw</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682857179"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmLit -&gt; CmmStatic
</span><a href="GHC.Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857178"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2409"></span><span>        </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock -&gt; InstrBlock
forall a. a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#consOL"><span class="hs-operator hs-var">`consOL`</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857186"><span class="hs-identifier hs-var">addr_code</span></a></span><span>
</span><span id="line-2410"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857185"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857192"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2411"></span><span>
</span><span id="line-2412"></span><span class="annot"><span class="hs-comment">-- | Load the value at the given address into any register.</span></span><span>
</span><span id="line-2413"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadAmode"><span class="hs-identifier hs-type">loadAmode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrMode"><span class="hs-identifier hs-type">AddrMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-2414"></span><span id="loadAmode"><span class="annot"><span class="annottext">loadAmode :: Format -&gt; AddrMode -&gt; InstrBlock -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#loadAmode"><span class="hs-identifier hs-var hs-var">loadAmode</span></a></span></span><span> </span><span id="local-6989586621682857195"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857195"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span id="local-6989586621682857196"><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682857196"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682857197"><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857197"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2415"></span><span>  </span><span id="local-6989586621682857198"><span class="annot"><a href="#local-6989586621682857198"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-2416"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857199"><span class="annot"><a href="#local-6989586621682857199"><span class="hs-identifier hs-var hs-var">load</span></a></span></span><span> </span><span id="local-6989586621682857200"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857200"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt;
NCGConfig -&gt; Format -&gt; Operand -&gt; Operand -&gt; Instr
NCGConfig -&gt; Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#movInstr"><span class="hs-identifier hs-var">movInstr</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682857198"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857195"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682857196"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857200"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2417"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857195"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682857201"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857201"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857197"><span class="hs-identifier hs-var">addr_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Instr
</span><a href="#local-6989586621682857199"><span class="hs-identifier hs-var">load</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857201"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2418"></span><span>
</span><span id="line-2419"></span><span class="hs-comment">-- if we want a floating-point literal as an operand, we can</span><span>
</span><span id="line-2420"></span><span class="hs-comment">-- use it directly from memory.  However, if the literal is</span><span>
</span><span id="line-2421"></span><span class="hs-comment">-- zero, we're better off generating it into a register using</span><span>
</span><span id="line-2422"></span><span class="hs-comment">-- xor.</span><span>
</span><span id="line-2423"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isSuitableFloatingPointLit"><span class="hs-identifier hs-type">isSuitableFloatingPointLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2424"></span><span id="isSuitableFloatingPointLit"><span class="annot"><span class="annottext">isSuitableFloatingPointLit :: CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isSuitableFloatingPointLit"><span class="hs-identifier hs-var hs-var">isSuitableFloatingPointLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmFloat"><span class="hs-identifier hs-type">CmmFloat</span></a></span><span> </span><span id="local-6989586621682857202"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682857202"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682857202"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.0</span></span><span>
</span><span id="line-2425"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#isSuitableFloatingPointLit"><span class="hs-identifier hs-var">isSuitableFloatingPointLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2426"></span><span>
</span><span id="line-2427"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegOrMem"><span class="hs-identifier hs-type">getRegOrMem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2428"></span><span id="getRegOrMem"><span class="annot"><span class="annottext">getRegOrMem :: CmmExpr -&gt; NatM (Operand, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegOrMem"><span class="hs-identifier hs-var hs-var">getRegOrMem</span></a></span></span><span> </span><span id="local-6989586621682857203"><span class="annot"><span class="annottext">e :: CmmExpr
</span><a href="#local-6989586621682857203"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682857204"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857204"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621682857205"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857205"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2429"></span><span>  </span><span id="local-6989586621682857206"><span class="annot"><a href="#local-6989586621682857206"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-2430"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isIntFormat"><span class="hs-identifier hs-type">isIntFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-type">cmmTypeFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857205"><span class="hs-identifier hs-type">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682857206"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-type">isWord64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857205"><span class="hs-identifier hs-type">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-2431"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2432"></span><span>       </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682857207"><span class="annot"><a href="#local-6989586621682857207"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682857208"><span class="annot"><a href="#local-6989586621682857208"><span class="hs-identifier hs-var">mem_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857204"><span class="hs-identifier hs-type">mem</span></a></span><span>
</span><span id="line-2433"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857207"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682857208"><span class="hs-identifier hs-type">mem_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2434"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2435"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621682857209"><span class="annot"><a href="#local-6989586621682857209"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857210"><span class="annot"><a href="#local-6989586621682857210"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-type">getNonClobberedReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857203"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-2436"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857209"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682857210"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2437"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegOrMem"><span class="hs-identifier hs-var">getRegOrMem</span></a></span><span> </span><span id="local-6989586621682857211"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857211"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2438"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682857212"><span class="annot"><a href="#local-6989586621682857212"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857213"><span class="annot"><a href="#local-6989586621682857213"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857211"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2439"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857212"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682857213"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2440"></span><span>
</span><span id="line-2441"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-type">is32BitLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2442"></span><span id="is32BitLit"><span class="annot"><span class="annottext">is32BitLit :: Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var hs-var">is32BitLit</span></a></span></span><span> </span><span id="local-6989586621682857214"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857214"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682857215"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857215"><span class="hs-identifier hs-var">_lit</span></a></span></span><span>
</span><span id="line-2443"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Bool
</span><a href="GHC.Platform.html#target32Bit"><span class="hs-identifier hs-var">target32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857214"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2444"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span id="local-6989586621682857216"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857216"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682857217"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857217"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2445"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857217"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2446"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682857218"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857218"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-var">is32BitInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857218"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-2447"></span><span>      </span><span class="hs-comment">-- Except on Windows, assume that labels are in the range 0-2^31-1: this</span><span>
</span><span id="line-2448"></span><span>      </span><span class="hs-comment">-- assumes the small memory model. Note [%rip-relative addressing on</span><span>
</span><span id="line-2449"></span><span>      </span><span class="hs-comment">-- x86-64].</span><span>
</span><span id="line-2450"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-type">CmmLabel</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682857219"><span class="hs-identifier hs-var">low_image</span></a></span><span>
</span><span id="line-2451"></span><span>      </span><span class="hs-comment">-- however we can't assume that label offsets are in this range</span><span>
</span><span id="line-2452"></span><span>      </span><span class="hs-comment">-- (see #15570)</span><span>
</span><span id="line-2453"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelOff"><span class="hs-identifier hs-type">CmmLabelOff</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682857220"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857220"><span class="hs-identifier hs-var">off</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682857219"><span class="hs-identifier hs-var">low_image</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-var">is32BitInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857220"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2454"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelDiffOff"><span class="hs-identifier hs-type">CmmLabelDiffOff</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682857221"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857221"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682857219"><span class="hs-identifier hs-var">low_image</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-var">is32BitInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857221"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2455"></span><span>      </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2456"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2457"></span><span>    </span><span class="hs-comment">-- Is the executable image certain to be located below 4GB? As noted in</span><span>
</span><span id="line-2458"></span><span>    </span><span class="hs-comment">-- Note [%rip-relative addressing on x86-64], this is not true on Windows.</span><span>
</span><span id="line-2459"></span><span>    </span><span id="local-6989586621682857219"><span class="annot"><span class="annottext">low_image :: Bool
</span><a href="#local-6989586621682857219"><span class="hs-identifier hs-var hs-var">low_image</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2460"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857216"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2461"></span><span>        </span><span class="annot"><span class="annottext">OS
</span><span class="hs-identifier hs-var">OSMinGW32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>   </span><span class="hs-comment">-- See Note [%rip-relative addressing on x86-64]</span><span>
</span><span id="line-2462"></span><span>        </span><span class="annot"><span class="annottext">OS
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2463"></span><span>
</span><span id="line-2464"></span><span>
</span><span id="line-2465"></span><span class="hs-comment">-- Set up a condition code for a conditional branch.</span><span>
</span><span id="line-2466"></span><span>
</span><span id="line-2467"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getCondCode"><span class="hs-identifier hs-type">getCondCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span>
</span><span id="line-2468"></span><span>
</span><span id="line-2469"></span><span class="hs-comment">-- yes, they really do seem to want exactly the same!</span><span>
</span><span id="line-2470"></span><span>
</span><span id="line-2471"></span><span id="getCondCode"><span class="annot"><span class="annottext">getCondCode :: CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getCondCode"><span class="hs-identifier hs-var hs-var">getCondCode</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682857224"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682857224"><span class="hs-identifier hs-var">mop</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682857225"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857225"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857226"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857226"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2472"></span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-2473"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682857224"><span class="hs-identifier hs-var">mop</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2474"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Eq"><span class="hs-identifier hs-type">MO_F_Eq</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857226"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2475"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ne"><span class="hs-identifier hs-type">MO_F_Ne</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857226"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2476"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Gt"><span class="hs-identifier hs-type">MO_F_Gt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857226"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2477"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ge"><span class="hs-identifier hs-type">MO_F_Ge</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857226"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2478"></span><span>      </span><span class="hs-comment">-- Invert comparison condition and swap operands</span><span>
</span><span id="line-2479"></span><span>      </span><span class="hs-comment">-- See Note [SSE Parity Checks]</span><span>
</span><span id="line-2480"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Lt"><span class="hs-identifier hs-type">MO_F_Lt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857226"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857225"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2481"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Le"><span class="hs-identifier hs-type">MO_F_Le</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>   </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857226"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857225"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2482"></span><span>
</span><span id="line-2483"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Eq"><span class="hs-identifier hs-type">MO_F_Eq</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857226"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2484"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ne"><span class="hs-identifier hs-type">MO_F_Ne</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857226"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2485"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Gt"><span class="hs-identifier hs-type">MO_F_Gt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857226"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2486"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ge"><span class="hs-identifier hs-type">MO_F_Ge</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857226"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2487"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Lt"><span class="hs-identifier hs-type">MO_F_Lt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857226"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857225"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2488"></span><span>      </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Le"><span class="hs-identifier hs-type">MO_F_Le</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857226"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857225"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2489"></span><span>
</span><span id="line-2490"></span><span>      </span><span class="annot"><span class="annottext">MachOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode"><span class="hs-identifier hs-var">condIntCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; Cond
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#machOpToCond"><span class="hs-identifier hs-var">machOpToCond</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682857224"><span class="hs-identifier hs-var">mop</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857226"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2491"></span><span>
</span><span id="line-2492"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getCondCode"><span class="hs-identifier hs-var">getCondCode</span></a></span><span> </span><span id="local-6989586621682857230"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857230"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2493"></span><span>   </span><span id="local-6989586621682857231"><span class="annot"><a href="#local-6989586621682857231"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-2494"></span><span>   </span><span class="annot"><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-type">pprPanic</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;getCondCode(2)(x86,x86_64)&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-type">pdoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857231"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857230"><span class="hs-identifier hs-type">other</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2495"></span><span>
</span><span id="line-2496"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#machOpToCond"><span class="hs-identifier hs-type">machOpToCond</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span>
</span><span id="line-2497"></span><span id="machOpToCond"><span class="annot"><span class="annottext">machOpToCond :: MachOp -&gt; Cond
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#machOpToCond"><span class="hs-identifier hs-var hs-var">machOpToCond</span></a></span></span><span> </span><span id="local-6989586621682857232"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682857232"><span class="hs-identifier hs-var">mo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682857232"><span class="hs-identifier hs-var">mo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2498"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Eq"><span class="hs-identifier hs-type">MO_Eq</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span>
</span><span id="line-2499"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Ne"><span class="hs-identifier hs-type">MO_Ne</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>
</span><span id="line-2500"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Gt"><span class="hs-identifier hs-type">MO_S_Gt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span>
</span><span id="line-2501"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Ge"><span class="hs-identifier hs-type">MO_S_Ge</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>
</span><span id="line-2502"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Lt"><span class="hs-identifier hs-type">MO_S_Lt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LTT"><span class="hs-identifier hs-var">LTT</span></a></span><span>
</span><span id="line-2503"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Le"><span class="hs-identifier hs-type">MO_S_Le</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LE"><span class="hs-identifier hs-var">LE</span></a></span><span>
</span><span id="line-2504"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Gt"><span class="hs-identifier hs-type">MO_U_Gt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GU"><span class="hs-identifier hs-var">GU</span></a></span><span>
</span><span id="line-2505"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Ge"><span class="hs-identifier hs-type">MO_U_Ge</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GEU"><span class="hs-identifier hs-var">GEU</span></a></span><span>
</span><span id="line-2506"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Lt"><span class="hs-identifier hs-type">MO_U_Lt</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LU"><span class="hs-identifier hs-var">LU</span></a></span><span>
</span><span id="line-2507"></span><span>  </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Le"><span class="hs-identifier hs-type">MO_U_Le</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LEU"><span class="hs-identifier hs-var">LEU</span></a></span><span>
</span><span id="line-2508"></span><span>  </span><span id="local-6989586621682857233"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682857233"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Cond
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;machOpToCond&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; SDoc
</span><a href="GHC.Cmm.MachOp.html#pprMachOp"><span class="hs-identifier hs-var">pprMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682857232"><span class="hs-identifier hs-var">mo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2509"></span><span>
</span><span id="line-2510"></span><span class="hs-comment">{-  Note [64-bit integer comparisons on 32-bit]
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    When doing these comparisons there are 2 kinds of
    comparisons.

    * Comparison for equality (or lack thereof)

    We use xor to check if high/low bits are
    equal. Then combine the results using or.

    * Other comparisons:

    We first compare the low registers
    and use a subtraction with borrow to compare the high registers.

    For signed numbers the condition is determined by
    the sign and overflow flags agreeing or not
    and for unsigned numbers the condition is the carry flag.

-}</span><span>
</span><span id="line-2531"></span><span>
</span><span id="line-2532"></span><span class="hs-comment">-- @cond(Int|Flt)Code@: Turn a boolean expression into a condition, to be</span><span>
</span><span id="line-2533"></span><span class="hs-comment">-- passed back up the tree.</span><span>
</span><span id="line-2534"></span><span>
</span><span id="line-2535"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode"><span class="hs-identifier hs-type">condIntCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span>
</span><span id="line-2536"></span><span id="condIntCode"><span class="annot"><span class="annottext">condIntCode :: Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode"><span class="hs-identifier hs-var hs-var">condIntCode</span></a></span></span><span> </span><span id="local-6989586621682857234"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682857234"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682857235"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857235"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682857236"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857236"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682857237"><span class="annot"><a href="#local-6989586621682857237"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-2537"></span><span>                          </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode%27"><span class="hs-identifier hs-type">condIntCode'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857237"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857234"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857235"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857236"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-2538"></span><span>
</span><span id="line-2539"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode%27"><span class="hs-identifier hs-type">condIntCode'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span>
</span><span id="line-2540"></span><span>
</span><span id="line-2541"></span><span class="hs-comment">-- 64-bit integer comparisons on 32-bit</span><span>
</span><span id="line-2542"></span><span class="hs-comment">-- See Note [64-bit integer comparisons on 32-bit]</span><span>
</span><span id="line-2543"></span><span id="condIntCode%27"><span class="annot"><span class="annottext">condIntCode' :: Platform -&gt; Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode%27"><span class="hs-identifier hs-var hs-var">condIntCode'</span></a></span></span><span> </span><span id="local-6989586621682857239"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857239"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682857240"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682857240"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682857241"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857241"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682857242"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857242"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-2544"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Bool
</span><a href="GHC.Platform.html#target32Bit"><span class="hs-identifier hs-var">target32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857239"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-var">isWord64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857239"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857241"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2545"></span><span>
</span><span id="line-2546"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682857243"><span class="annot"><a href="#local-6989586621682857243"><span class="hs-identifier hs-var">code1</span></a></span></span><span> </span><span id="local-6989586621682857244"><span class="annot"><a href="#local-6989586621682857244"><span class="hs-identifier hs-var">r1hi</span></a></span></span><span> </span><span id="local-6989586621682857245"><span class="annot"><a href="#local-6989586621682857245"><span class="hs-identifier hs-var">r1lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857241"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2547"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682857246"><span class="annot"><a href="#local-6989586621682857246"><span class="hs-identifier hs-var">code2</span></a></span></span><span> </span><span id="local-6989586621682857247"><span class="annot"><a href="#local-6989586621682857247"><span class="hs-identifier hs-var">r2hi</span></a></span></span><span> </span><span id="local-6989586621682857248"><span class="annot"><a href="#local-6989586621682857248"><span class="hs-identifier hs-var">r2lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-type">iselExpr64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857242"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-2548"></span><span>
</span><span id="line-2549"></span><span>  </span><span class="hs-comment">-- we mustn't clobber r1/r2 so we use temporaries</span><span>
</span><span id="line-2550"></span><span>  </span><span id="local-6989586621682857249"><span class="annot"><a href="#local-6989586621682857249"><span class="hs-identifier hs-var">tmp1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span>
</span><span id="line-2551"></span><span>  </span><span id="local-6989586621682857250"><span class="annot"><a href="#local-6989586621682857250"><span class="hs-identifier hs-var">tmp2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span>
</span><span id="line-2552"></span><span>
</span><span id="line-2553"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682857251"><span class="annot"><a href="#local-6989586621682857251"><span class="hs-identifier hs-var">cond'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857252"><span class="annot"><a href="#local-6989586621682857252"><span class="hs-identifier hs-var">cmpCode</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682857253"><span class="hs-identifier hs-type">intComparison</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857240"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857244"><span class="hs-identifier hs-type">r1hi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857245"><span class="hs-identifier hs-type">r1lo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857247"><span class="hs-identifier hs-type">r2hi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857248"><span class="hs-identifier hs-type">r2lo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857249"><span class="hs-identifier hs-type">tmp1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857250"><span class="hs-identifier hs-type">tmp2</span></a></span><span>
</span><span id="line-2554"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621682857251"><span class="hs-identifier hs-type">cond'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857243"><span class="hs-identifier hs-type">code1</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857246"><span class="hs-identifier hs-type">code2</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857252"><span class="hs-identifier hs-type">cmpCode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2555"></span><span>
</span><span id="line-2556"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2557"></span><span>    </span><span id="local-6989586621682857253"><span class="annot"><span class="annottext">intComparison :: Cond
-&gt; Reg -&gt; Reg -&gt; Reg -&gt; Reg -&gt; Reg -&gt; Reg -&gt; (Cond, InstrBlock)
</span><a href="#local-6989586621682857253"><span class="hs-identifier hs-var hs-var">intComparison</span></a></span></span><span> </span><span id="local-6989586621682857268"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682857268"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682857269"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857269"><span class="hs-identifier hs-var">r1_hi</span></a></span></span><span> </span><span id="local-6989586621682857270"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857270"><span class="hs-identifier hs-var">r1_lo</span></a></span></span><span> </span><span id="local-6989586621682857271"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857271"><span class="hs-identifier hs-var">r2_hi</span></a></span></span><span> </span><span id="local-6989586621682857272"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857272"><span class="hs-identifier hs-var">r2_lo</span></a></span></span><span> </span><span id="local-6989586621682857273"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857273"><span class="hs-identifier hs-var">tmp1</span></a></span></span><span> </span><span id="local-6989586621682857274"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857274"><span class="hs-identifier hs-var">tmp2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2558"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682857268"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2559"></span><span>        </span><span class="hs-comment">-- These don't occur as argument of condIntCode'</span><span>
</span><span id="line-2560"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Cond, InstrBlock)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>
</span><span id="line-2561"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NEG"><span class="hs-identifier hs-var">NEG</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Cond, InstrBlock)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>
</span><span id="line-2562"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#POS"><span class="hs-identifier hs-var">POS</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Cond, InstrBlock)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>
</span><span id="line-2563"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#CARRY"><span class="hs-identifier hs-var">CARRY</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Cond, InstrBlock)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>
</span><span id="line-2564"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#OFLO"><span class="hs-identifier hs-var">OFLO</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Cond, InstrBlock)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>
</span><span id="line-2565"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#PARITY"><span class="hs-identifier hs-var">PARITY</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Cond, InstrBlock)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>
</span><span id="line-2566"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NOTPARITY"><span class="hs-identifier hs-var">NOTPARITY</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Cond, InstrBlock)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>
</span><span id="line-2567"></span><span>        </span><span class="hs-comment">-- Special case #1 x == y and x != y</span><span>
</span><span id="line-2568"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857281"><span class="hs-identifier hs-var">cmpExact</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2569"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857281"><span class="hs-identifier hs-var">cmpExact</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2570"></span><span>        </span><span class="hs-comment">-- [x &gt;= y]</span><span>
</span><span id="line-2571"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857282"><span class="hs-identifier hs-var">cmpGE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2572"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GEU"><span class="hs-identifier hs-var">GEU</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GEU"><span class="hs-identifier hs-var">GEU</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857282"><span class="hs-identifier hs-var">cmpGE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2573"></span><span>        </span><span class="hs-comment">-- [x &gt;  y]</span><span>
</span><span id="line-2574"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GTT"><span class="hs-identifier hs-var">GTT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LTT"><span class="hs-identifier hs-var">LTT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857283"><span class="hs-identifier hs-var">cmpLE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2575"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GU"><span class="hs-identifier hs-var">GU</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LU"><span class="hs-identifier hs-var">LU</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857283"><span class="hs-identifier hs-var">cmpLE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2576"></span><span>        </span><span class="hs-comment">-- [x &lt;= y]</span><span>
</span><span id="line-2577"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LE"><span class="hs-identifier hs-var">LE</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GE"><span class="hs-identifier hs-var">GE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857283"><span class="hs-identifier hs-var">cmpLE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2578"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LEU"><span class="hs-identifier hs-var">LEU</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GEU"><span class="hs-identifier hs-var">GEU</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857283"><span class="hs-identifier hs-var">cmpLE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2579"></span><span>        </span><span class="hs-comment">-- [x &lt;  y]</span><span>
</span><span id="line-2580"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LTT"><span class="hs-identifier hs-var">LTT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LTT"><span class="hs-identifier hs-var">LTT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857282"><span class="hs-identifier hs-var">cmpGE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2581"></span><span>        </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LU"><span class="hs-identifier hs-var">LU</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LU"><span class="hs-identifier hs-var">LU</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857282"><span class="hs-identifier hs-var">cmpGE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2582"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-2583"></span><span>        </span><span class="annot"><a href="#local-6989586621682857281"><span class="hs-identifier hs-type">cmpExact</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span>
</span><span id="line-2584"></span><span>        </span><span id="local-6989586621682857281"><span class="annot"><span class="annottext">cmpExact :: InstrBlock
</span><a href="#local-6989586621682857281"><span class="hs-identifier hs-var hs-var">cmpExact</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2585"></span><span>          </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-2586"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857269"><span class="hs-identifier hs-var">r1_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857273"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2587"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857270"><span class="hs-identifier hs-var">r1_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857274"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2588"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857271"><span class="hs-identifier hs-var">r2_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857273"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2589"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857272"><span class="hs-identifier hs-var">r2_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857274"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2590"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857273"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857274"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2591"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-2592"></span><span>        </span><span id="local-6989586621682857282"><span class="annot"><span class="annottext">cmpGE :: InstrBlock
</span><a href="#local-6989586621682857282"><span class="hs-identifier hs-var hs-var">cmpGE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-2593"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857269"><span class="hs-identifier hs-var">r1_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857273"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2594"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857272"><span class="hs-identifier hs-var">r2_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857270"><span class="hs-identifier hs-var">r1_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2595"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SBB"><span class="hs-identifier hs-var">SBB</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857271"><span class="hs-identifier hs-var">r2_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857273"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2596"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-2597"></span><span>        </span><span id="local-6989586621682857283"><span class="annot"><span class="annottext">cmpLE :: InstrBlock
</span><a href="#local-6989586621682857283"><span class="hs-identifier hs-var hs-var">cmpLE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-2598"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857271"><span class="hs-identifier hs-var">r2_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857273"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2599"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857270"><span class="hs-identifier hs-var">r1_lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857272"><span class="hs-identifier hs-var">r2_lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2600"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SBB"><span class="hs-identifier hs-var">SBB</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857269"><span class="hs-identifier hs-var">r1_hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857273"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2601"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-2602"></span><span>
</span><span id="line-2603"></span><span class="hs-comment">-- memory vs immediate</span><span>
</span><span id="line-2604"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode%27"><span class="hs-identifier hs-var">condIntCode'</span></a></span><span> </span><span id="local-6989586621682857284"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857284"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682857285"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682857285"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682857286"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857286"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682857287"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857287"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682857288"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857288"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2605"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857284"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857288"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2606"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682857289"><span class="annot"><a href="#local-6989586621682857289"><span class="hs-identifier hs-var">x_addr</span></a></span></span><span> </span><span id="local-6989586621682857290"><span class="annot"><a href="#local-6989586621682857290"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857286"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2607"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-2608"></span><span>        </span><span id="local-6989586621682857291"><span class="annot"><a href="#local-6989586621682857291"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857288"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2609"></span><span>        </span><span id="local-6989586621682857292"><span class="annot"><a href="#local-6989586621682857292"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857290"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2610"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857287"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="annot"><span class="annottext">Imm
</span><a href="#local-6989586621682857291"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682857289"><span class="hs-identifier hs-var">x_addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2611"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-2612"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621682857285"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857292"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2613"></span><span>
</span><span id="line-2614"></span><span class="hs-comment">-- anything vs zero, using a mask</span><span>
</span><span id="line-2615"></span><span class="hs-comment">-- TODO: Add some sanity checking!!!!</span><span>
</span><span id="line-2616"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode%27"><span class="hs-identifier hs-var">condIntCode'</span></a></span><span> </span><span id="local-6989586621682857293"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857293"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682857294"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682857294"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_And"><span class="hs-identifier hs-type">MO_And</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682857295"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857295"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857296"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857296"><span class="hs-identifier hs-var">o2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621682857297"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857297"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2617"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682857298"><span class="annot"><span class="annottext">lit :: CmmLit
</span><a href="#local-6989586621682857298"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682857299"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857299"><span class="hs-identifier hs-var">mask</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857296"><span class="hs-identifier hs-var">o2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857293"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857298"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2618"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2619"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682857300"><span class="annot"><a href="#local-6989586621682857300"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857301"><span class="annot"><a href="#local-6989586621682857301"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857295"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2620"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-2621"></span><span>         </span><span id="local-6989586621682857302"><span class="annot"><a href="#local-6989586621682857302"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857301"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2622"></span><span>                </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TEST"><span class="hs-identifier hs-var">TEST</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857297"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857299"><span class="hs-identifier hs-var">mask</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857300"><span class="hs-identifier hs-var">x_reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2623"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-2624"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621682857294"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857302"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2625"></span><span>
</span><span id="line-2626"></span><span class="hs-comment">-- anything vs zero</span><span>
</span><span id="line-2627"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode%27"><span class="hs-identifier hs-var">condIntCode'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682857303"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682857303"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682857304"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857304"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621682857305"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857305"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2628"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682857306"><span class="annot"><a href="#local-6989586621682857306"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857307"><span class="annot"><a href="#local-6989586621682857307"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857304"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2629"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-2630"></span><span>        </span><span id="local-6989586621682857308"><span class="annot"><a href="#local-6989586621682857308"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857307"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2631"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TEST"><span class="hs-identifier hs-var">TEST</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857305"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857306"><span class="hs-identifier hs-var">x_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857306"><span class="hs-identifier hs-var">x_reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2632"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-2633"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621682857303"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857308"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2634"></span><span>
</span><span id="line-2635"></span><span class="hs-comment">-- anything vs operand</span><span>
</span><span id="line-2636"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode%27"><span class="hs-identifier hs-var">condIntCode'</span></a></span><span> </span><span id="local-6989586621682857309"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857309"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682857310"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682857310"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682857311"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857311"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682857312"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857312"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-2637"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isOperand"><span class="hs-identifier hs-var">isOperand</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857309"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857312"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2638"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682857313"><span class="annot"><a href="#local-6989586621682857313"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857314"><span class="annot"><a href="#local-6989586621682857314"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857311"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2639"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682857315"><span class="annot"><a href="#local-6989586621682857315"><span class="hs-identifier hs-var">y_op</span></a></span></span><span class="hs-special">,</span><span>  </span><span id="local-6989586621682857316"><span class="annot"><a href="#local-6989586621682857316"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-type">getOperand</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857312"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-2640"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-2641"></span><span>        </span><span id="local-6989586621682857317"><span class="annot"><a href="#local-6989586621682857317"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857314"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857316"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2642"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857309"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857311"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682857315"><span class="hs-identifier hs-var">y_op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857313"><span class="hs-identifier hs-var">x_reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2643"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621682857310"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857317"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2644"></span><span class="hs-comment">-- operand vs. anything: invert the comparison so that we can use a</span><span>
</span><span id="line-2645"></span><span class="hs-comment">-- single comparison instruction.</span><span>
</span><span id="line-2646"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#isOperand"><span class="hs-identifier hs-var">isOperand</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857309"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857311"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2647"></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682857318"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682857318"><span class="hs-identifier hs-var">revcond</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Maybe Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#maybeFlipCond"><span class="hs-identifier hs-var">maybeFlipCond</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682857310"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2648"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682857320"><span class="annot"><a href="#local-6989586621682857320"><span class="hs-identifier hs-var">y_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857321"><span class="annot"><a href="#local-6989586621682857321"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857312"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2649"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682857322"><span class="annot"><a href="#local-6989586621682857322"><span class="hs-identifier hs-var">x_op</span></a></span></span><span class="hs-special">,</span><span>  </span><span id="local-6989586621682857323"><span class="annot"><a href="#local-6989586621682857323"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-type">getOperand</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857311"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-2650"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-2651"></span><span>        </span><span id="local-6989586621682857324"><span class="annot"><a href="#local-6989586621682857324"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857321"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857323"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2652"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857309"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857311"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682857322"><span class="hs-identifier hs-var">x_op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857320"><span class="hs-identifier hs-var">y_reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2653"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621682857318"><span class="hs-identifier hs-type">revcond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857324"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2654"></span><span>
</span><span id="line-2655"></span><span class="hs-comment">-- anything vs anything</span><span>
</span><span id="line-2656"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode%27"><span class="hs-identifier hs-var">condIntCode'</span></a></span><span> </span><span id="local-6989586621682857325"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857325"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682857326"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682857326"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682857327"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857327"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682857328"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857328"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2657"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682857329"><span class="annot"><a href="#local-6989586621682857329"><span class="hs-identifier hs-var">y_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857330"><span class="annot"><a href="#local-6989586621682857330"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857328"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2658"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682857331"><span class="annot"><a href="#local-6989586621682857331"><span class="hs-identifier hs-var">x_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857332"><span class="annot"><a href="#local-6989586621682857332"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegOrMem"><span class="hs-identifier hs-type">getRegOrMem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857327"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-2659"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-2660"></span><span>        </span><span id="local-6989586621682857333"><span class="annot"><a href="#local-6989586621682857333"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857330"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-2661"></span><span>               </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857332"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2662"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857325"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857327"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857329"><span class="hs-identifier hs-var">y_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682857331"><span class="hs-identifier hs-var">x_op</span></a></span><span>
</span><span id="line-2663"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621682857326"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857333"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2664"></span><span>
</span><span id="line-2665"></span><span>
</span><span id="line-2666"></span><span>
</span><span id="line-2667"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2668"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-type">condFltCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span>
</span><span id="line-2669"></span><span>
</span><span id="line-2670"></span><span id="condFltCode"><span class="annot"><span class="annottext">condFltCode :: Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var hs-var">condFltCode</span></a></span></span><span> </span><span id="local-6989586621682857334"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682857334"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682857335"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857335"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682857336"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857336"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-2671"></span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">NatM CondCode
</span><a href="#local-6989586621682857337"><span class="hs-identifier hs-var">condFltCode_sse2</span></a></span><span>
</span><span id="line-2672"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2673"></span><span>
</span><span id="line-2674"></span><span>
</span><span id="line-2675"></span><span>  </span><span class="hs-comment">-- in the SSE2 comparison ops (ucomiss, ucomisd) the left arg may be</span><span>
</span><span id="line-2676"></span><span>  </span><span class="hs-comment">-- an operand, but the right must be a reg.  We can probably do better</span><span>
</span><span id="line-2677"></span><span>  </span><span class="hs-comment">-- than this general case...</span><span>
</span><span id="line-2678"></span><span>  </span><span id="local-6989586621682857337"><span class="annot"><span class="annottext">condFltCode_sse2 :: NatM CondCode
</span><a href="#local-6989586621682857337"><span class="hs-identifier hs-var hs-var">condFltCode_sse2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2679"></span><span>    </span><span id="local-6989586621682857338"><span class="annot"><a href="#local-6989586621682857338"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-2680"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682857339"><span class="annot"><a href="#local-6989586621682857339"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857340"><span class="annot"><a href="#local-6989586621682857340"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-type">getNonClobberedReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857335"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-2681"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682857341"><span class="annot"><a href="#local-6989586621682857341"><span class="hs-identifier hs-var">y_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857342"><span class="annot"><a href="#local-6989586621682857342"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-type">getOperand</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857336"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-2682"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-2683"></span><span>        </span><span id="local-6989586621682857343"><span class="annot"><a href="#local-6989586621682857343"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857340"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-2684"></span><span>               </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857342"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2685"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(Width -&gt; Format) -&gt; Width -&gt; Format
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Width
</span><a href="GHC.Cmm.Expr.html#cmmExprWidth"><span class="hs-identifier hs-var">cmmExprWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857338"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857335"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682857341"><span class="hs-identifier hs-var">y_op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857339"><span class="hs-identifier hs-var">x_reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2686"></span><span>        </span><span class="hs-comment">-- NB(1): we need to use the unsigned comparison operators on the</span><span>
</span><span id="line-2687"></span><span>        </span><span class="hs-comment">-- result of this comparison.</span><span>
</span><span id="line-2688"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#condToUnsigned"><span class="hs-identifier hs-type">condToUnsigned</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857334"><span class="hs-identifier hs-type">cond</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682857343"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2689"></span><span>
</span><span id="line-2690"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2691"></span><span class="hs-comment">-- Generating assignments</span><span>
</span><span id="line-2692"></span><span>
</span><span id="line-2693"></span><span class="hs-comment">-- Assignments are really at the heart of the whole code generation</span><span>
</span><span id="line-2694"></span><span class="hs-comment">-- business.  Almost all top-level nodes of any real importance are</span><span>
</span><span id="line-2695"></span><span class="hs-comment">-- assignments, which correspond to loads, stores, or register</span><span>
</span><span id="line-2696"></span><span class="hs-comment">-- transfers.  If we're really lucky, some of the register transfers</span><span>
</span><span id="line-2697"></span><span class="hs-comment">-- will go away, because we can use the destination register to</span><span>
</span><span id="line-2698"></span><span class="hs-comment">-- complete the code generation for the right hand side.  This only</span><span>
</span><span id="line-2699"></span><span class="hs-comment">-- fails when the right hand side is forced into a fixed register</span><span>
</span><span id="line-2700"></span><span class="hs-comment">-- (e.g. the result of a call).</span><span>
</span><span id="line-2701"></span><span>
</span><span id="line-2702"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_IntCode"><span class="hs-identifier hs-type">assignMem_IntCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2703"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_IntCode"><span class="hs-identifier hs-type">assignReg_IntCode</span></a></span><span> </span><span class="hs-glyph">::</span><span>           </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2704"></span><span>
</span><span id="line-2705"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_FltCode"><span class="hs-identifier hs-type">assignMem_FltCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2706"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_FltCode"><span class="hs-identifier hs-type">assignReg_FltCode</span></a></span><span> </span><span class="hs-glyph">::</span><span>           </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2707"></span><span>
</span><span id="line-2708"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_VecCode"><span class="hs-identifier hs-type">assignMem_VecCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2709"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_VecCode"><span class="hs-identifier hs-type">assignReg_VecCode</span></a></span><span> </span><span class="hs-glyph">::</span><span>           </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2710"></span><span>
</span><span id="line-2711"></span><span class="hs-comment">-- integer assignment to memory</span><span>
</span><span id="line-2712"></span><span>
</span><span id="line-2713"></span><span class="hs-comment">-- specific case of adding/subtracting an integer to a particular address.</span><span>
</span><span id="line-2714"></span><span class="hs-comment">-- ToDo: catch other cases where we can use an operation directly on a memory</span><span>
</span><span id="line-2715"></span><span class="hs-comment">-- address.</span><span>
</span><span id="line-2716"></span><span id="assignMem_IntCode"><span class="annot"><span class="annottext">assignMem_IntCode :: Format -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_IntCode"><span class="hs-identifier hs-var hs-var">assignMem_IntCode</span></a></span></span><span> </span><span id="local-6989586621682857346"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857346"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682857347"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857347"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682857348"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682857348"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682857349"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857349"><span class="hs-identifier hs-var">addr2</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>
</span><span id="line-2717"></span><span>                                                 </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682857350"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857350"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2718"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857347"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmExpr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857349"><span class="hs-identifier hs-var">addr2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857346"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Format -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitInteger"><span class="hs-identifier hs-var">is32BitInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857350"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2719"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682857351"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682857351"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; Maybe (Format -&gt; Operand -&gt; Operand -&gt; Instr)
</span><a href="#local-6989586621682857352"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682857348"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-2720"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682857353"><span class="annot"><a href="#local-6989586621682857353"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span id="local-6989586621682857354"><span class="annot"><a href="#local-6989586621682857354"><span class="hs-identifier hs-var">code_addr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857347"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-2721"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857355"><span class="annot"><a href="#local-6989586621682857355"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857354"><span class="hs-identifier hs-var">code_addr</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2722"></span><span>                   </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682857351"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857346"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682857350"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682857353"><span class="hs-identifier hs-var">amode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2723"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682857355"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-2724"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-2725"></span><span>        </span><span id="local-6989586621682857352"><span class="annot"><span class="annottext">check :: MachOp -&gt; Maybe (Format -&gt; Operand -&gt; Operand -&gt; Instr)
</span><a href="#local-6989586621682857352"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Format -&gt; Operand -&gt; Operand -&gt; Instr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span>
</span><span id="line-2726"></span><span>        </span><span class="annot"><a href="#local-6989586621682857352"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Sub"><span class="hs-identifier hs-type">MO_Sub</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Format -&gt; Operand -&gt; Operand -&gt; Instr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span>
</span><span id="line-2727"></span><span>        </span><span class="annot"><a href="#local-6989586621682857352"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Format -&gt; Operand -&gt; Operand -&gt; Instr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2728"></span><span>        </span><span class="hs-comment">-- ToDo: more?</span><span>
</span><span id="line-2729"></span><span>
</span><span id="line-2730"></span><span class="hs-comment">-- general case</span><span>
</span><span id="line-2731"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_IntCode"><span class="hs-identifier hs-var">assignMem_IntCode</span></a></span><span> </span><span id="local-6989586621682857356"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857356"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682857357"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857357"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682857358"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857358"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2732"></span><span>    </span><span id="local-6989586621682857359"><span class="annot"><a href="#local-6989586621682857359"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-2733"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682857360"><span class="annot"><a href="#local-6989586621682857360"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682857361"><span class="annot"><a href="#local-6989586621682857361"><span class="hs-identifier hs-var">code_addr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857357"><span class="hs-identifier hs-type">addr</span></a></span><span>
</span><span id="line-2734"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682857362"><span class="annot"><a href="#local-6989586621682857362"><span class="hs-identifier hs-var">code_src</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857363"><span class="annot"><a href="#local-6989586621682857363"><span class="hs-identifier hs-var">op_src</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682857364"><span class="hs-identifier hs-type">get_op_RI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857359"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857358"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-2735"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-2736"></span><span>        </span><span id="local-6989586621682857365"><span class="annot"><a href="#local-6989586621682857365"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857362"><span class="hs-identifier hs-var">code_src</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-2737"></span><span>               </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857361"><span class="hs-identifier hs-var">code_addr</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2738"></span><span>                  </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857356"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682857363"><span class="hs-identifier hs-var">op_src</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682857360"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2739"></span><span>        </span><span class="hs-comment">-- NOTE: op_src is stable, so it will still be valid</span><span>
</span><span id="line-2740"></span><span>        </span><span class="hs-comment">-- after code_addr.  This may involve the introduction</span><span>
</span><span id="line-2741"></span><span>        </span><span class="hs-comment">-- of an extra MOV to a temporary register, but we hope</span><span>
</span><span id="line-2742"></span><span>        </span><span class="hs-comment">-- the register allocator will get rid of it.</span><span>
</span><span id="line-2743"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-2744"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682857365"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-2745"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2746"></span><span>    </span><span class="annot"><a href="#local-6989586621682857364"><span class="hs-identifier hs-type">get_op_RI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- code, operator</span><span>
</span><span id="line-2747"></span><span>    </span><span id="local-6989586621682857364"><span class="annot"><span class="annottext">get_op_RI :: Platform -&gt; CmmExpr -&gt; NatM (InstrBlock, Operand)
</span><a href="#local-6989586621682857364"><span class="hs-identifier hs-var hs-var">get_op_RI</span></a></span></span><span> </span><span id="local-6989586621682857366"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857366"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682857367"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857367"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857366"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857367"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-2748"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(InstrBlock, Operand) -&gt; NatM (InstrBlock, Operand)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857367"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2749"></span><span>    </span><span class="annot"><a href="#local-6989586621682857364"><span class="hs-identifier hs-var">get_op_RI</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682857368"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857368"><span class="hs-identifier hs-var">op</span></a></span></span><span>
</span><span id="line-2750"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682857369"><span class="annot"><a href="#local-6989586621682857369"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857370"><span class="annot"><a href="#local-6989586621682857370"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857368"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-2751"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857370"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857369"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2752"></span><span>
</span><span id="line-2753"></span><span>
</span><span id="line-2754"></span><span class="hs-comment">-- Assign; dst is a reg, rhs is mem</span><span>
</span><span id="line-2755"></span><span id="assignReg_IntCode"><span class="annot"><span class="annottext">assignReg_IntCode :: CmmReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_IntCode"><span class="hs-identifier hs-var hs-var">assignReg_IntCode</span></a></span></span><span> </span><span id="local-6989586621682857371"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682857371"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682857372"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857372"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2756"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857373"><span class="annot"><span class="annottext">ty :: Format
</span><a href="#local-6989586621682857373"><span class="hs-identifier hs-var hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmType -&gt; Format) -&gt; CmmType -&gt; Format
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682857371"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-2757"></span><span>  </span><span id="local-6989586621682857374"><span class="annot"><a href="#local-6989586621682857374"><span class="hs-identifier hs-var">load_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857373"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857372"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2758"></span><span>  </span><span id="local-6989586621682857375"><span class="annot"><a href="#local-6989586621682857375"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-2759"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857374"><span class="hs-identifier hs-type">load_code</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-type">getRegisterReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857375"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857371"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2760"></span><span>
</span><span id="line-2761"></span><span class="hs-comment">-- dst is a reg, but src could be anything</span><span>
</span><span id="line-2762"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_IntCode"><span class="hs-identifier hs-var">assignReg_IntCode</span></a></span><span> </span><span id="local-6989586621682857376"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682857376"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682857377"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857377"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2763"></span><span>  </span><span id="local-6989586621682857378"><span class="annot"><a href="#local-6989586621682857378"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">(NCGConfig -&gt; Platform) -&gt; NatM NCGConfig -&gt; NatM Platform
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-2764"></span><span>  </span><span id="local-6989586621682857379"><span class="annot"><a href="#local-6989586621682857379"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857377"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-2765"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857379"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-type">getRegisterReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857378"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857376"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2766"></span><span>
</span><span id="line-2767"></span><span>
</span><span id="line-2768"></span><span class="hs-comment">-- Floating point assignment to memory</span><span>
</span><span id="line-2769"></span><span id="assignMem_FltCode"><span class="annot"><span class="annottext">assignMem_FltCode :: Format -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_FltCode"><span class="hs-identifier hs-var hs-var">assignMem_FltCode</span></a></span></span><span> </span><span id="local-6989586621682857380"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857380"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682857381"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857381"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682857382"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857382"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2770"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682857383"><span class="annot"><a href="#local-6989586621682857383"><span class="hs-identifier hs-var">src_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857384"><span class="annot"><a href="#local-6989586621682857384"><span class="hs-identifier hs-var">src_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857382"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2771"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682857385"><span class="annot"><a href="#local-6989586621682857385"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682857386"><span class="annot"><a href="#local-6989586621682857386"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857381"><span class="hs-identifier hs-type">addr</span></a></span><span>
</span><span id="line-2772"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-2773"></span><span>        </span><span id="local-6989586621682857387"><span class="annot"><a href="#local-6989586621682857387"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857384"><span class="hs-identifier hs-var">src_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-2774"></span><span>               </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857386"><span class="hs-identifier hs-var">addr_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2775"></span><span>               </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857380"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857383"><span class="hs-identifier hs-var">src_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682857385"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2776"></span><span>
</span><span id="line-2777"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682857387"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-2778"></span><span>
</span><span id="line-2779"></span><span class="hs-comment">-- Floating point assignment to a register/temporary</span><span>
</span><span id="line-2780"></span><span id="assignReg_FltCode"><span class="annot"><span class="annottext">assignReg_FltCode :: CmmReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_FltCode"><span class="hs-identifier hs-var hs-var">assignReg_FltCode</span></a></span></span><span> </span><span id="local-6989586621682857388"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682857388"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682857389"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857389"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2781"></span><span>  </span><span id="local-6989586621682857390"><span class="annot"><a href="#local-6989586621682857390"><span class="hs-identifier hs-var">src_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857389"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2782"></span><span>  </span><span id="local-6989586621682857391"><span class="annot"><a href="#local-6989586621682857391"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-2783"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857390"><span class="hs-identifier hs-type">src_code</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-type">getRegisterReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857391"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857388"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2784"></span><span>
</span><span id="line-2785"></span><span class="hs-comment">-- Vector assignment to a register/temporary</span><span>
</span><span id="line-2786"></span><span id="assignMem_VecCode"><span class="annot"><span class="annottext">assignMem_VecCode :: Format -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_VecCode"><span class="hs-identifier hs-var hs-var">assignMem_VecCode</span></a></span></span><span> </span><span id="local-6989586621682857392"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857392"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682857393"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857393"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682857394"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857394"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2787"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682857395"><span class="annot"><a href="#local-6989586621682857395"><span class="hs-identifier hs-var">src_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857396"><span class="annot"><a href="#local-6989586621682857396"><span class="hs-identifier hs-var">src_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg, InstrBlock)
CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-var">getNonClobberedReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857394"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-2788"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682857397"><span class="annot"><a href="#local-6989586621682857397"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682857398"><span class="annot"><a href="#local-6989586621682857398"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857393"><span class="hs-identifier hs-type">addr</span></a></span><span>
</span><span id="line-2789"></span><span>  </span><span id="local-6989586621682857399"><span class="annot"><a href="#local-6989586621682857399"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-2790"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-2791"></span><span>    </span><span id="local-6989586621682857400"><span class="annot"><a href="#local-6989586621682857400"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857396"><span class="hs-identifier hs-var">src_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-2792"></span><span>           </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857398"><span class="hs-identifier hs-var">addr_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-2793"></span><span>           </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt;
NCGConfig -&gt; Format -&gt; Operand -&gt; Operand -&gt; Instr
NCGConfig -&gt; Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#movInstr"><span class="hs-identifier hs-var">movInstr</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682857399"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857392"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857395"><span class="hs-identifier hs-var">src_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682857397"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2794"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682857400"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-2795"></span><span>
</span><span id="line-2796"></span><span id="assignReg_VecCode"><span class="annot"><span class="annottext">assignReg_VecCode :: CmmReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignReg_VecCode"><span class="hs-identifier hs-var hs-var">assignReg_VecCode</span></a></span></span><span> </span><span id="local-6989586621682857401"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682857401"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682857402"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857402"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2797"></span><span>  </span><span id="local-6989586621682857403"><span class="annot"><a href="#local-6989586621682857403"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">(NCGConfig -&gt; Platform) -&gt; NatM NCGConfig -&gt; NatM Platform
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-2798"></span><span>  </span><span id="local-6989586621682857404"><span class="annot"><a href="#local-6989586621682857404"><span class="hs-identifier hs-var">src_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857402"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-2799"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857404"><span class="hs-identifier hs-type">src_code</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-type">getRegisterReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857403"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857401"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2800"></span><span>
</span><span id="line-2801"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genJump"><span class="hs-identifier hs-type">genJump</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-comment">{-the branch target-}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#RegWithFormat"><span class="hs-identifier hs-type">RegWithFormat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2802"></span><span>
</span><span id="line-2803"></span><span id="genJump"><span class="annot"><span class="annottext">genJump :: CmmExpr -&gt; [RegWithFormat] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genJump"><span class="hs-identifier hs-var hs-var">genJump</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682857405"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857405"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682857406"><span class="annot"><span class="annottext">[RegWithFormat]
</span><a href="#local-6989586621682857406"><span class="hs-identifier hs-var">regs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2804"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682857407"><span class="annot"><a href="#local-6989586621682857407"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621682857408"><span class="annot"><a href="#local-6989586621682857408"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857405"><span class="hs-identifier hs-var">mem</span></a></span><span>
</span><span id="line-2805"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857408"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JMP"><span class="hs-identifier hs-type">JMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857407"><span class="hs-identifier hs-type">target</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682857406"><span class="hs-identifier hs-type">regs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2806"></span><span>
</span><span id="line-2807"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genJump"><span class="hs-identifier hs-var">genJump</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682857410"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857410"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682857411"><span class="annot"><span class="annottext">[RegWithFormat]
</span><a href="#local-6989586621682857411"><span class="hs-identifier hs-var">regs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2808"></span><span>  </span><span class="annot"><span class="annottext">InstrBlock -&gt; NatM InstrBlock
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; [RegWithFormat] -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JMP"><span class="hs-identifier hs-var">JMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682857410"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RegWithFormat]
</span><a href="#local-6989586621682857411"><span class="hs-identifier hs-var">regs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2809"></span><span>
</span><span id="line-2810"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genJump"><span class="hs-identifier hs-var">genJump</span></a></span><span> </span><span id="local-6989586621682857412"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857412"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621682857413"><span class="annot"><span class="annottext">[RegWithFormat]
</span><a href="#local-6989586621682857413"><span class="hs-identifier hs-var">regs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2811"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682857414"><span class="annot"><a href="#local-6989586621682857414"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857415"><span class="annot"><a href="#local-6989586621682857415"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857412"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-2812"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857415"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JMP"><span class="hs-identifier hs-type">JMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857414"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682857413"><span class="hs-identifier hs-type">regs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2813"></span><span>
</span><span id="line-2814"></span><span>
</span><span id="line-2815"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2816"></span><span class="hs-comment">--  Unconditional branches</span><span>
</span><span id="line-2817"></span><span>
</span><span id="line-2818"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genBranch"><span class="hs-identifier hs-type">genBranch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2819"></span><span id="genBranch"><span class="annot"><span class="annottext">genBranch :: Label -&gt; InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genBranch"><span class="hs-identifier hs-var hs-var">genBranch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="annot"><span class="annottext">([Instr] -&gt; InstrBlock)
-&gt; (Label -&gt; [Instr]) -&gt; Label -&gt; InstrBlock
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; [Instr]
</span><a href="GHC.CmmToAsm.X86.Instr.html#mkJumpInstr"><span class="hs-identifier hs-var">mkJumpInstr</span></a></span><span>
</span><span id="line-2820"></span><span>
</span><span id="line-2821"></span><span>
</span><span id="line-2822"></span><span>
</span><span id="line-2823"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2824"></span><span class="hs-comment">--  Conditional jumps/branches</span><span>
</span><span id="line-2825"></span><span>
</span><span id="line-2826"></span><span class="hs-comment">{-
Conditional jumps are always to local labels, so we can use branch
instructions.  We peek at the arguments to decide what kind of
comparison to do.

I386: First, we have to ensure that the condition
codes are set according to the supplied comparison operation.
-}</span><span>
</span><span id="line-2834"></span><span>
</span><span id="line-2835"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCondBranch"><span class="hs-identifier hs-type">genCondBranch</span></a></span><span>
</span><span id="line-2836"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>      </span><span class="hs-comment">-- the source of the jump</span><span>
</span><span id="line-2837"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>      </span><span class="hs-comment">-- the true branch target</span><span>
</span><span id="line-2838"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>      </span><span class="hs-comment">-- the false branch target</span><span>
</span><span id="line-2839"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>      </span><span class="hs-comment">-- the condition on which to branch</span><span>
</span><span id="line-2840"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span> </span><span class="hs-comment">-- Instructions</span><span>
</span><span id="line-2841"></span><span>
</span><span id="line-2842"></span><span id="genCondBranch"><span class="annot"><span class="annottext">genCondBranch :: Label -&gt; Label -&gt; Label -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCondBranch"><span class="hs-identifier hs-var hs-var">genCondBranch</span></a></span></span><span> </span><span id="local-6989586621682857418"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857418"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682857419"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857419"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span id="local-6989586621682857420"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857420"><span class="hs-identifier hs-var">false</span></a></span></span><span> </span><span id="local-6989586621682857421"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857421"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2843"></span><span>  </span><span id="local-6989586621682857422"><span class="annot"><a href="#local-6989586621682857422"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-2844"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCondBranch%27"><span class="hs-identifier hs-type">genCondBranch'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857422"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857418"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857419"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857420"><span class="hs-identifier hs-type">false</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857421"><span class="hs-identifier hs-type">expr</span></a></span><span>
</span><span id="line-2845"></span><span>
</span><span id="line-2846"></span><span class="annot"><span class="hs-comment">-- | We return the instructions generated.</span></span><span>
</span><span id="line-2847"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCondBranch%27"><span class="hs-identifier hs-type">genCondBranch'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-2848"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-2849"></span><span>
</span><span id="line-2850"></span><span id="genCondBranch%27"><span class="annot"><span class="annottext">genCondBranch' :: Bool -&gt; Label -&gt; Label -&gt; Label -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCondBranch%27"><span class="hs-identifier hs-var hs-var">genCondBranch'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682857424"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857424"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682857425"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857425"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span id="local-6989586621682857426"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857426"><span class="hs-identifier hs-var">false</span></a></span></span><span> </span><span id="local-6989586621682857427"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857427"><span class="hs-identifier hs-var">bool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2851"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span id="local-6989586621682857428"><span class="annot"><a href="#local-6989586621682857428"><span class="hs-identifier hs-var">is_float</span></a></span></span><span> </span><span id="local-6989586621682857429"><span class="annot"><a href="#local-6989586621682857429"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682857430"><span class="annot"><a href="#local-6989586621682857430"><span class="hs-identifier hs-var">cond_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getCondCode"><span class="hs-identifier hs-var">getCondCode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857427"><span class="hs-identifier hs-var">bool</span></a></span><span>
</span><span id="line-2852"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><a href="#local-6989586621682857428"><span class="hs-identifier hs-type">is_float</span></a></span><span>
</span><span id="line-2853"></span><span>    </span><span class="hs-keyword">then</span><span>
</span><span id="line-2854"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857430"><span class="hs-identifier hs-type">cond_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-type">JXX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857429"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857425"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genBranch"><span class="hs-identifier hs-type">genBranch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857426"><span class="hs-identifier hs-type">false</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2855"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2856"></span><span>        </span><span class="hs-comment">-- See Note [SSE Parity Checks]</span><span>
</span><span id="line-2857"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857431"><span class="annot"><a href="#local-6989586621682857431"><span class="hs-identifier hs-var hs-var">jmpFalse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genBranch"><span class="hs-identifier hs-var">genBranch</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857426"><span class="hs-identifier hs-var">false</span></a></span><span>
</span><span id="line-2858"></span><span>            </span><span id="local-6989586621682857432"><span class="annot"><a href="#local-6989586621682857432"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span>
</span><span id="line-2859"></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682857429"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2860"></span><span>                  </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857433"><span class="hs-identifier hs-var">or_unordered</span></a></span><span>
</span><span id="line-2861"></span><span>                  </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GU"><span class="hs-identifier hs-var">GU</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857434"><span class="hs-identifier hs-var">plain_test</span></a></span><span>
</span><span id="line-2862"></span><span>                  </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GEU"><span class="hs-identifier hs-var">GEU</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857434"><span class="hs-identifier hs-var">plain_test</span></a></span><span>
</span><span id="line-2863"></span><span>                  </span><span class="hs-comment">-- Use ASSERT so we don't break releases if</span><span>
</span><span id="line-2864"></span><span>                  </span><span class="hs-comment">-- LTT/LE creep in somehow.</span><span>
</span><span id="line-2865"></span><span>                  </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LTT"><span class="hs-identifier hs-var">LTT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2866"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; InstrBlock -&gt; InstrBlock
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Should have been turned into &gt;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2867"></span><span>                    </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857436"><span class="hs-identifier hs-var">and_ordered</span></a></span><span>
</span><span id="line-2868"></span><span>                  </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LE"><span class="hs-identifier hs-var">LE</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2869"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; InstrBlock -&gt; InstrBlock
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Should have been turned into &gt;=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2870"></span><span>                    </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857436"><span class="hs-identifier hs-var">and_ordered</span></a></span><span>
</span><span id="line-2871"></span><span>                  </span><span class="annot"><span class="annottext">Cond
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857436"><span class="hs-identifier hs-var">and_ordered</span></a></span><span>
</span><span id="line-2872"></span><span>
</span><span id="line-2873"></span><span>            </span><span id="local-6989586621682857434"><span class="annot"><a href="#local-6989586621682857434"><span class="hs-identifier hs-var hs-var">plain_test</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-2874"></span><span>                  </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682857429"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857425"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-2875"></span><span>                </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857431"><span class="hs-identifier hs-var">jmpFalse</span></a></span><span>
</span><span id="line-2876"></span><span>            </span><span id="local-6989586621682857433"><span class="annot"><a href="#local-6989586621682857433"><span class="hs-identifier hs-var hs-var">or_unordered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-2877"></span><span>                  </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682857429"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857425"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2878"></span><span>                  </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#PARITY"><span class="hs-identifier hs-var">PARITY</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857425"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-2879"></span><span>                </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857431"><span class="hs-identifier hs-var">jmpFalse</span></a></span><span>
</span><span id="line-2880"></span><span>            </span><span id="local-6989586621682857436"><span class="annot"><a href="#local-6989586621682857436"><span class="hs-identifier hs-var hs-var">and_ordered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-2881"></span><span>                  </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#PARITY"><span class="hs-identifier hs-var">PARITY</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857426"><span class="hs-identifier hs-var">false</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2882"></span><span>                  </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682857429"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857425"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2883"></span><span>                  </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857426"><span class="hs-identifier hs-var">false</span></a></span><span>
</span><span id="line-2884"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-2885"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#updateCfgNat"><span class="hs-identifier hs-type">updateCfgNat</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682857437"><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621682857437"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CFG -&gt; (EdgeWeight -&gt; EdgeWeight) -&gt; Label -&gt; Label -&gt; CFG
</span><a href="GHC.CmmToAsm.CFG.html#adjustEdgeWeight"><span class="hs-identifier hs-var">adjustEdgeWeight</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621682857437"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EdgeWeight -&gt; EdgeWeight -&gt; EdgeWeight
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">EdgeWeight
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857424"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857426"><span class="hs-identifier hs-var">false</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2886"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857430"><span class="hs-identifier hs-type">cond_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857432"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2887"></span><span>
</span><span id="line-2888"></span><span class="hs-comment">{-  Note [Introducing cfg edges inside basic blocks]
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    During instruction selection a statement `s`
    in a block B with control of the sort: B -&gt; C
    will sometimes result in control
    flow of the sort:

            &#9484; &lt; &#9488;
            v   ^
      B -&gt;  B1  &#9524; -&gt; C

    as is the case for some atomic operations.

    Now to keep the CFG in sync when introducing B1 we clearly
    want to insert it between B and C. However there is
    a catch when we have to deal with self loops.

    We might start with code and a CFG of these forms:

    loop:
        stmt1               &#9484; &lt; &#9488;
        ....                v   ^
        stmtX              loop &#9496;
        stmtY
        ....
        goto loop:

    Now we introduce B1:
                            &#9484; &#9472; &#9472; &#9472; &#9472; &#9472;&#9488;
        loop:               &#9474;   &#9484; &lt;  &#9488; &#9474;
        instrs              v   &#9474;    &#9474; ^
        ....               loop &#9524; B1 &#9524; &#9496;
        instrsFromX
        stmtY
        goto loop:

    This is simple, all outgoing edges from loop now simply
    start from B1 instead and the code generator knows which
    new edges it introduced for the self loop of B1.

    Disaster strikes if the statement Y follows the same pattern.
    If we apply the same rule that all outgoing edges change then
    we end up with:

        loop &#9472;&gt; B1 &#9472;&gt; B2 &#9516;&#9472;&#9488;
          &#9474;      &#9474;    &#9492;&#9472;&lt;&#9508; &#9474;
          &#9474;      &#9492;&#9472;&#9472;&#9472;&lt;&#9472;&#9472;&#9472;&#9496; &#9474;
          &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&lt;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;

    This is problematic. The edge B1-&gt;B1 is modified as expected.
    However the modification is wrong!

    The assembly in this case looked like this:

    _loop:
        &lt;instrs&gt;
    _B1:
        ...
        cmpxchgq ...
        jne _B1
        &lt;instrs&gt;
        &lt;end _B1&gt;
    _B2:
        ...
        cmpxchgq ...
        jne _B2
        &lt;instrs&gt;
        jmp loop

    There is no edge _B2 -&gt; _B1 here. It's still a self loop onto _B1.

    The problem here is that really B1 should be two basic blocks.
    Otherwise we have control flow in the *middle* of a basic block.
    A contradiction!

    So to account for this we add yet another basic block marker:

    _B:
        &lt;instrs&gt;
    _B1:
        ...
        cmpxchgq ...
        jne _B1
        jmp _B1'
    _B1':
        &lt;instrs&gt;
        &lt;end _B1&gt;
    _B2:
        ...

    Now when inserting B2 we will only look at the outgoing edges of B1' and
    everything will work out nicely.

    You might also wonder why we don't insert jumps at the end of _B1'. There is
    no way another block ends up jumping to the labels _B1 or _B2 since they are
    essentially invisible to other blocks. View them as control flow labels local
    to the basic block if you'd like.

    Not doing this ultimately caused (part 2 of) #17334.
-}</span><span>
</span><span id="line-2989"></span><span>
</span><span id="line-2990"></span><span>
</span><span id="line-2991"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2992"></span><span class="hs-comment">--  Generating C calls</span><span>
</span><span id="line-2993"></span><span>
</span><span id="line-2994"></span><span class="hs-comment">-- Now the biggest nightmare---calls.  Most of the nastiness is buried in</span><span>
</span><span id="line-2995"></span><span class="hs-comment">-- @get_arg@, which moves the arguments to the correct registers/stack</span><span>
</span><span id="line-2996"></span><span class="hs-comment">-- locations.  Apart from that, the code is easy.</span><span>
</span><span id="line-2997"></span><span class="hs-comment">--</span><span>
</span><span id="line-2998"></span><span class="hs-comment">-- (If applicable) Do not fill the delay slots here; you will confuse the</span><span>
</span><span id="line-2999"></span><span class="hs-comment">-- register allocator.</span><span>
</span><span id="line-3000"></span><span class="hs-comment">--</span><span>
</span><span id="line-3001"></span><span class="hs-comment">-- See Note [Keeping track of the current block] for information why we need</span><span>
</span><span id="line-3002"></span><span class="hs-comment">-- to take/return a block id.</span><span>
</span><span id="line-3003"></span><span>
</span><span id="line-3004"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genForeignCall"><span class="hs-identifier hs-type">genForeignCall</span></a></span><span>
</span><span id="line-3005"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ function to call</span></span><span>
</span><span id="line-3006"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ where to put the result</span></span><span>
</span><span id="line-3007"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ arguments (of mixed type)</span></span><span>
</span><span id="line-3008"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ The block we are in</span></span><span>
</span><span id="line-3009"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3010"></span><span>
</span><span id="line-3011"></span><span id="genForeignCall"><span class="annot"><span class="annottext">genForeignCall :: ForeignTarget
-&gt; [LocalReg]
-&gt; [CmmExpr]
-&gt; Label
-&gt; NatM (InstrBlock, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genForeignCall"><span class="hs-identifier hs-var hs-var">genForeignCall</span></a></span></span><span> </span><span id="local-6989586621682857441"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682857441"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621682857442"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682857442"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682857443"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857443"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682857444"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857444"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3012"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682857441"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3013"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#PrimTarget"><span class="hs-identifier hs-type">PrimTarget</span></a></span><span> </span><span id="local-6989586621682857446"><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682857446"><span class="hs-keyword hs-var">prim</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; CallishMachOp
-&gt; [LocalReg]
-&gt; [CmmExpr]
-&gt; NatM (InstrBlock, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrim"><span class="hs-identifier hs-var">genPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857444"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682857446"><span class="hs-keyword hs-var">prim</span></a></span><span> </span><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682857442"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857443"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-3014"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span id="local-6989586621682857449"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857449"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682857450"><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682857450"><span class="hs-identifier hs-var">conv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe Label
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(InstrBlock -&gt; (InstrBlock, Maybe Label))
-&gt; NatM InstrBlock -&gt; NatM (InstrBlock, Maybe Label)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Label
-&gt; CmmExpr
-&gt; ForeignConvention
-&gt; [LocalReg]
-&gt; [CmmExpr]
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall"><span class="hs-identifier hs-var">genCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857444"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857449"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682857450"><span class="hs-identifier hs-var">conv</span></a></span><span> </span><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682857442"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857443"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-3015"></span><span>
</span><span id="line-3016"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrim"><span class="hs-identifier hs-type">genPrim</span></a></span><span>
</span><span id="line-3017"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ The block we are in</span></span><span>
</span><span id="line-3018"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#CallishMachOp"><span class="hs-identifier hs-type">CallishMachOp</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ MachOp</span></span><span>
</span><span id="line-3019"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ where to put the result</span></span><span>
</span><span id="line-3020"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ arguments (of mixed type)</span></span><span>
</span><span id="line-3021"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3022"></span><span>
</span><span id="line-3023"></span><span class="hs-comment">-- First we deal with cases which might introduce new blocks in the stream.</span><span>
</span><span id="line-3024"></span><span id="genPrim"><span class="annot"><span class="annottext">genPrim :: Label
-&gt; CallishMachOp
-&gt; [LocalReg]
-&gt; [CmmExpr]
-&gt; NatM (InstrBlock, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrim"><span class="hs-identifier hs-var hs-var">genPrim</span></a></span></span><span> </span><span id="local-6989586621682857452"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857452"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AtomicRMW"><span class="hs-identifier hs-type">MO_AtomicRMW</span></a></span><span> </span><span id="local-6989586621682857454"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857454"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682857455"><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="#local-6989586621682857455"><span class="hs-identifier hs-var">amop</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682857456"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857456"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682857457"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857457"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857458"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857458"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-3025"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; Width
-&gt; AtomicMachOp
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (InstrBlock, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicRMW"><span class="hs-identifier hs-var">genAtomicRMW</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857452"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857454"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="#local-6989586621682857455"><span class="hs-identifier hs-var">amop</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857456"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857457"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857458"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-3026"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrim"><span class="hs-identifier hs-var">genPrim</span></a></span><span> </span><span id="local-6989586621682857460"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857460"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Ctz"><span class="hs-identifier hs-type">MO_Ctz</span></a></span><span> </span><span id="local-6989586621682857462"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857462"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682857463"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857463"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682857464"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857464"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-3027"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (InstrBlock, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtz"><span class="hs-identifier hs-var">genCtz</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857460"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857462"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857463"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857464"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-3028"></span><span>
</span><span id="line-3029"></span><span class="hs-comment">-- Then we deal with cases which not introducing new blocks in the stream.</span><span>
</span><span id="line-3030"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrim"><span class="hs-identifier hs-var">genPrim</span></a></span><span> </span><span id="local-6989586621682857466"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857466"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682857467"><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682857467"><span class="hs-keyword hs-var">prim</span></a></span></span><span> </span><span id="local-6989586621682857468"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682857468"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682857469"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857469"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-3031"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe Label
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(InstrBlock -&gt; (InstrBlock, Maybe Label))
-&gt; NatM InstrBlock -&gt; NatM (InstrBlock, Maybe Label)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Label
-&gt; CallishMachOp -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857466"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682857467"><span class="hs-keyword hs-var">prim</span></a></span><span> </span><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682857468"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857469"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-3032"></span><span>
</span><span id="line-3033"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-type">genSimplePrim</span></a></span><span>
</span><span id="line-3034"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ the block we are in</span></span><span>
</span><span id="line-3035"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#CallishMachOp"><span class="hs-identifier hs-type">CallishMachOp</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ MachOp</span></span><span>
</span><span id="line-3036"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ where to put the result</span></span><span>
</span><span id="line-3037"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ arguments (of mixed type)</span></span><span>
</span><span id="line-3038"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-3039"></span><span id="genSimplePrim"><span class="annot"><span class="annottext">genSimplePrim :: Label
-&gt; CallishMachOp -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var hs-var">genSimplePrim</span></a></span></span><span> </span><span id="local-6989586621682857471"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857471"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Memcpy"><span class="hs-identifier hs-type">MO_Memcpy</span></a></span><span> </span><span id="local-6989586621682857473"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857473"><span class="hs-identifier hs-var">align</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682857474"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857474"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857475"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857475"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857476"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857476"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Int -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCpy"><span class="hs-identifier hs-var">genMemCpy</span></a></span><span>  </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857471"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857473"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857474"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857475"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857476"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-3040"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857478"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857478"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Memmove"><span class="hs-identifier hs-type">MO_Memmove</span></a></span><span> </span><span id="local-6989586621682857480"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857480"><span class="hs-identifier hs-var">align</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682857481"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857481"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857482"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857482"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857483"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857483"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Int -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
forall p.
Label -&gt; p -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemMove"><span class="hs-identifier hs-var">genMemMove</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857478"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857480"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857481"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857482"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857483"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-3041"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857485"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857485"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Memcmp"><span class="hs-identifier hs-type">MO_Memcmp</span></a></span><span> </span><span id="local-6989586621682857487"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857487"><span class="hs-identifier hs-var">align</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682857488"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857488"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857489"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857489"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857490"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857490"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857491"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857491"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; Int
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM InstrBlock
forall p.
Label
-&gt; p
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCmp"><span class="hs-identifier hs-var">genMemCmp</span></a></span><span>  </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857485"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857487"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857488"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857489"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857490"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857491"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-3042"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857493"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857493"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Memset"><span class="hs-identifier hs-type">MO_Memset</span></a></span><span> </span><span id="local-6989586621682857495"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857495"><span class="hs-identifier hs-var">align</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682857496"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857496"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857497"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857497"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857498"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857498"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Int -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemSet"><span class="hs-identifier hs-var">genMemSet</span></a></span><span>  </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857493"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857495"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857496"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857497"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857498"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-3043"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_AcquireFence"><span class="hs-identifier hs-var">MO_AcquireFence</span></a></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; NatM InstrBlock
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span> </span><span class="hs-comment">-- barriers compile to no code on x86/x86-64;</span><span>
</span><span id="line-3044"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_ReleaseFence"><span class="hs-identifier hs-var">MO_ReleaseFence</span></a></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; NatM InstrBlock
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span> </span><span class="hs-comment">-- we keep it this long in order to prevent earlier optimisations.</span><span>
</span><span id="line-3045"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_SeqCstFence"><span class="hs-identifier hs-var">MO_SeqCstFence</span></a></span><span>       </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; NatM InstrBlock
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(InstrBlock -&gt; NatM InstrBlock) -&gt; InstrBlock -&gt; NatM InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MFENCE"><span class="hs-identifier hs-var">MFENCE</span></a></span><span>
</span><span id="line-3046"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_Touch"><span class="hs-identifier hs-var">MO_Touch</span></a></span><span>             </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; NatM InstrBlock
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-3047"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Prefetch_Data"><span class="hs-identifier hs-type">MO_Prefetch_Data</span></a></span><span> </span><span id="local-6989586621682857506"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857506"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682857507"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857507"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrefetchData"><span class="hs-identifier hs-var">genPrefetchData</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857506"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857507"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-3048"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_BSwap"><span class="hs-identifier hs-type">MO_BSwap</span></a></span><span> </span><span id="local-6989586621682857510"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857510"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-special">[</span><span id="local-6989586621682857511"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857511"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857512"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857512"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genByteSwap"><span class="hs-identifier hs-var">genByteSwap</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857510"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857511"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857512"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-3049"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857514"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857514"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_BRev"><span class="hs-identifier hs-type">MO_BRev</span></a></span><span> </span><span id="local-6989586621682857516"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857516"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682857517"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857517"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857518"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857518"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genBitRev"><span class="hs-identifier hs-var">genBitRev</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857514"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857516"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857517"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857518"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-3050"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857520"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857520"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_PopCnt"><span class="hs-identifier hs-type">MO_PopCnt</span></a></span><span> </span><span id="local-6989586621682857522"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857522"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682857523"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857523"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857524"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857524"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPopCnt"><span class="hs-identifier hs-var">genPopCnt</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857520"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857522"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857523"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857524"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-3051"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857526"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857526"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Pdep"><span class="hs-identifier hs-type">MO_Pdep</span></a></span><span> </span><span id="local-6989586621682857528"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857528"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682857529"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857529"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857530"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857530"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857531"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857531"><span class="hs-identifier hs-var">mask</span></a></span></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPdep"><span class="hs-identifier hs-var">genPdep</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857526"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857528"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857529"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857530"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857531"><span class="hs-identifier hs-var">mask</span></a></span><span>
</span><span id="line-3052"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857533"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857533"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Pext"><span class="hs-identifier hs-type">MO_Pext</span></a></span><span> </span><span id="local-6989586621682857535"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857535"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682857536"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857536"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857537"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857537"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857538"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857538"><span class="hs-identifier hs-var">mask</span></a></span></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPext"><span class="hs-identifier hs-var">genPext</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857533"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857535"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857536"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857537"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857538"><span class="hs-identifier hs-var">mask</span></a></span><span>
</span><span id="line-3053"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857540"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857540"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Clz"><span class="hs-identifier hs-type">MO_Clz</span></a></span><span> </span><span id="local-6989586621682857542"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857542"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-special">[</span><span id="local-6989586621682857543"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857543"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857544"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857544"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genClz"><span class="hs-identifier hs-var">genClz</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857540"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857542"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857543"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857544"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-3054"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857546"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857546"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UF_Conv"><span class="hs-identifier hs-type">MO_UF_Conv</span></a></span><span> </span><span id="local-6989586621682857548"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857548"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857549"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857549"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857550"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857550"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genWordToFloat"><span class="hs-identifier hs-var">genWordToFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857546"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857548"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857549"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857550"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-3055"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AtomicRead"><span class="hs-identifier hs-type">MO_AtomicRead</span></a></span><span> </span><span id="local-6989586621682857553"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857553"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682857554"><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682857554"><span class="hs-identifier hs-var">mo</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">[</span><span id="local-6989586621682857555"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857555"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>  </span><span class="hs-special">[</span><span id="local-6989586621682857556"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857556"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; MemoryOrdering -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicRead"><span class="hs-identifier hs-var">genAtomicRead</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857553"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682857554"><span class="hs-identifier hs-var">mo</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857555"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857556"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-3056"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AtomicWrite"><span class="hs-identifier hs-type">MO_AtomicWrite</span></a></span><span> </span><span id="local-6989586621682857559"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857559"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682857560"><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682857560"><span class="hs-identifier hs-var">mo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span id="local-6989586621682857561"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857561"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857562"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857562"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; MemoryOrdering -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicWrite"><span class="hs-identifier hs-var">genAtomicWrite</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857559"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682857560"><span class="hs-identifier hs-var">mo</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857561"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857562"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-3057"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857564"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857564"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Cmpxchg"><span class="hs-identifier hs-type">MO_Cmpxchg</span></a></span><span> </span><span id="local-6989586621682857566"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857566"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857567"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857567"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857568"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857568"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857569"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857569"><span class="hs-identifier hs-var">old</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857570"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857570"><span class="hs-identifier hs-var">new</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
-&gt; Width
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCmpXchg"><span class="hs-identifier hs-var">genCmpXchg</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857564"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857566"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857567"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857568"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857569"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857570"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-3058"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Xchg"><span class="hs-identifier hs-type">MO_Xchg</span></a></span><span> </span><span id="local-6989586621682857573"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857573"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682857574"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857574"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857575"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857575"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857576"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857576"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genXchg"><span class="hs-identifier hs-var">genXchg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857573"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857574"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857575"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857576"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-3059"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AddWordC"><span class="hs-identifier hs-type">MO_AddWordC</span></a></span><span> </span><span id="local-6989586621682857579"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857579"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682857580"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857580"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857581"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857581"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857582"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857582"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857583"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857583"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; (Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr))
-&gt; Cond
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddSubRetCarry"><span class="hs-identifier hs-var">genAddSubRetCarry</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857579"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD_CC"><span class="hs-identifier hs-var">ADD_CC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
-&gt; Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#CARRY"><span class="hs-identifier hs-var">CARRY</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857580"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857581"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857582"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857583"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3060"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SubWordC"><span class="hs-identifier hs-type">MO_SubWordC</span></a></span><span> </span><span id="local-6989586621682857588"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857588"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682857589"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857589"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857590"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857590"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857591"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857591"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857592"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857592"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; (Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr))
-&gt; Cond
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddSubRetCarry"><span class="hs-identifier hs-var">genAddSubRetCarry</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857588"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB_CC"><span class="hs-identifier hs-var">SUB_CC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
-&gt; Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#CARRY"><span class="hs-identifier hs-var">CARRY</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857589"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857590"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857591"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857592"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3061"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AddIntC"><span class="hs-identifier hs-type">MO_AddIntC</span></a></span><span> </span><span id="local-6989586621682857595"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857595"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-special">[</span><span id="local-6989586621682857596"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857596"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857597"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857597"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857598"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857598"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857599"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857599"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; (Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr))
-&gt; Cond
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddSubRetCarry"><span class="hs-identifier hs-var">genAddSubRetCarry</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857595"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD_CC"><span class="hs-identifier hs-var">ADD_CC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((Operand -&gt; Operand -&gt; Instr)
 -&gt; Maybe (Operand -&gt; Operand -&gt; Instr))
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; Format
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD_CC"><span class="hs-identifier hs-var">ADD_CC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#OFLO"><span class="hs-identifier hs-var">OFLO</span></a></span><span>  </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857596"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857597"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857598"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857599"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3062"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SubIntC"><span class="hs-identifier hs-type">MO_SubIntC</span></a></span><span> </span><span id="local-6989586621682857601"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857601"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-special">[</span><span id="local-6989586621682857602"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857602"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857603"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857603"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857604"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857604"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857605"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857605"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; (Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr))
-&gt; Cond
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddSubRetCarry"><span class="hs-identifier hs-var">genAddSubRetCarry</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857601"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB_CC"><span class="hs-identifier hs-var">SUB_CC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
-&gt; Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#OFLO"><span class="hs-identifier hs-var">OFLO</span></a></span><span>  </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857602"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857603"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857604"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857605"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3063"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add2"><span class="hs-identifier hs-type">MO_Add2</span></a></span><span> </span><span id="local-6989586621682857607"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857607"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857608"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857608"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857609"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857609"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857610"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857610"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857611"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857611"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; LocalReg -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddWithCarry"><span class="hs-identifier hs-var">genAddWithCarry</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857607"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857608"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857609"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857610"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857611"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3064"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Mul2"><span class="hs-identifier hs-type">MO_U_Mul2</span></a></span><span> </span><span id="local-6989586621682857614"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857614"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-special">[</span><span id="local-6989586621682857615"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857615"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857616"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857616"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857617"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857617"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857618"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857618"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; LocalReg -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genUnsignedLargeMul"><span class="hs-identifier hs-var">genUnsignedLargeMul</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857614"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857615"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857616"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857617"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857618"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3065"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Mul2"><span class="hs-identifier hs-type">MO_S_Mul2</span></a></span><span> </span><span id="local-6989586621682857621"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857621"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-special">[</span><span id="local-6989586621682857622"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857622"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857623"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857623"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857624"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857624"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682857625"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857625"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857626"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857626"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; LocalReg
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genSignedLargeMul"><span class="hs-identifier hs-var">genSignedLargeMul</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857621"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857622"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857623"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857624"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857625"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857626"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3066"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_QuotRem"><span class="hs-identifier hs-type">MO_S_QuotRem</span></a></span><span> </span><span id="local-6989586621682857629"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857629"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-special">[</span><span id="local-6989586621682857630"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857630"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857631"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857631"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857632"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857632"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857633"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857633"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Bool
-&gt; LocalReg
-&gt; LocalReg
-&gt; Maybe CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genQuotRem"><span class="hs-identifier hs-var">genQuotRem</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857629"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857630"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857631"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CmmExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857632"><span class="hs-identifier hs-var">x</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857633"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3067"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_QuotRem"><span class="hs-identifier hs-type">MO_U_QuotRem</span></a></span><span> </span><span id="local-6989586621682857636"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857636"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-special">[</span><span id="local-6989586621682857637"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857637"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857638"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857638"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857639"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857639"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857640"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857640"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Bool
-&gt; LocalReg
-&gt; LocalReg
-&gt; Maybe CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genQuotRem"><span class="hs-identifier hs-var">genQuotRem</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857636"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857637"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857638"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CmmExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857639"><span class="hs-identifier hs-var">x</span></a></span><span>  </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857640"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3068"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_QuotRem2"><span class="hs-identifier hs-type">MO_U_QuotRem2</span></a></span><span> </span><span id="local-6989586621682857642"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857642"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682857643"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857643"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857644"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857644"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857645"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857645"><span class="hs-identifier hs-var">hx</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857646"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857646"><span class="hs-identifier hs-var">lx</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857647"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857647"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; Bool
-&gt; LocalReg
-&gt; LocalReg
-&gt; Maybe CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genQuotRem"><span class="hs-identifier hs-var">genQuotRem</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857642"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857643"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857644"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; Maybe CmmExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857645"><span class="hs-identifier hs-var">hx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857646"><span class="hs-identifier hs-var">lx</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857647"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3069"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Fabs"><span class="hs-identifier hs-var">MO_F32_Fabs</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857649"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857649"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857650"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857650"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genFloatAbs"><span class="hs-identifier hs-var">genFloatAbs</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857649"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857650"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-3070"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Fabs"><span class="hs-identifier hs-var">MO_F64_Fabs</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857653"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857653"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857654"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857654"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genFloatAbs"><span class="hs-identifier hs-var">genFloatAbs</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857653"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857654"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-3071"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Sqrt"><span class="hs-identifier hs-var">MO_F32_Sqrt</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857656"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857656"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857657"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857657"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genFloatSqrt"><span class="hs-identifier hs-var">genFloatSqrt</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#FF32"><span class="hs-identifier hs-var">FF32</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857656"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857657"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-3072"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Sqrt"><span class="hs-identifier hs-var">MO_F64_Sqrt</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857660"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857660"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857661"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857661"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genFloatSqrt"><span class="hs-identifier hs-var">genFloatSqrt</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#FF64"><span class="hs-identifier hs-var">FF64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857660"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857661"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-3073"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857662"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857662"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Sin"><span class="hs-identifier hs-var">MO_F32_Sin</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682857664"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857664"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857665"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857665"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857662"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sinf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857664"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857665"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3074"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857668"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857668"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Cos"><span class="hs-identifier hs-var">MO_F32_Cos</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682857670"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857670"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857671"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857671"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857668"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cosf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857670"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857671"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3075"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857672"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857672"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Tan"><span class="hs-identifier hs-var">MO_F32_Tan</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682857674"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857674"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857675"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857675"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857672"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tanf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857674"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857675"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3076"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857676"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857676"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Exp"><span class="hs-identifier hs-var">MO_F32_Exp</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682857678"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857678"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857679"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857679"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857676"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857678"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857679"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3077"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857680"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857680"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_ExpM1"><span class="hs-identifier hs-var">MO_F32_ExpM1</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682857682"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857682"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857683"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857683"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857680"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expm1f&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857682"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857683"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3078"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857684"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857684"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Log"><span class="hs-identifier hs-var">MO_F32_Log</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682857686"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857686"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857687"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857687"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857684"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;logf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857686"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857687"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3079"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857688"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857688"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Log1P"><span class="hs-identifier hs-var">MO_F32_Log1P</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682857690"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857690"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857691"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857691"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857688"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;log1pf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857690"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857691"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3080"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857692"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857692"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Asin"><span class="hs-identifier hs-var">MO_F32_Asin</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857694"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857694"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857695"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857695"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857692"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;asinf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857694"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857695"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3081"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857696"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857696"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Acos"><span class="hs-identifier hs-var">MO_F32_Acos</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857698"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857698"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857699"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857699"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857696"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;acosf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857698"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857699"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3082"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857700"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857700"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Atan"><span class="hs-identifier hs-var">MO_F32_Atan</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857702"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857702"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857703"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857703"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857700"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;atanf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857702"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857703"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3083"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857704"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857704"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Sinh"><span class="hs-identifier hs-var">MO_F32_Sinh</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857706"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857706"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857707"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857707"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857704"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sinhf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857706"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857707"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3084"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857708"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857708"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Cosh"><span class="hs-identifier hs-var">MO_F32_Cosh</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857710"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857710"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857711"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857711"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857708"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;coshf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857710"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857711"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3085"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857712"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857712"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Tanh"><span class="hs-identifier hs-var">MO_F32_Tanh</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857714"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857714"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857715"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857715"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857712"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tanhf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857714"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857715"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3086"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857716"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857716"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Pwr"><span class="hs-identifier hs-var">MO_F32_Pwr</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682857718"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857718"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857719"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857719"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857720"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857720"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857716"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;powf&quot;</span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857718"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857719"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857720"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3087"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857721"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857721"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Asinh"><span class="hs-identifier hs-var">MO_F32_Asinh</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682857723"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857723"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857724"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857724"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857721"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;asinhf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857723"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857724"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3088"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857725"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857725"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Acosh"><span class="hs-identifier hs-var">MO_F32_Acosh</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682857727"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857727"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857728"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857728"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857725"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;acoshf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857727"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857728"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3089"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857729"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857729"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Atanh"><span class="hs-identifier hs-var">MO_F32_Atanh</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682857731"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857731"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857732"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857732"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857729"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;atanhf&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857731"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857732"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3090"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857733"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857733"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Sin"><span class="hs-identifier hs-var">MO_F64_Sin</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682857735"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857735"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857736"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857736"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857733"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sin&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857735"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857736"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3091"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857737"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857737"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Cos"><span class="hs-identifier hs-var">MO_F64_Cos</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682857739"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857739"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857740"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857740"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857737"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cos&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857739"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857740"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3092"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857741"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857741"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Tan"><span class="hs-identifier hs-var">MO_F64_Tan</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682857743"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857743"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857744"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857744"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857741"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tan&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857743"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857744"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3093"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857745"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857745"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Exp"><span class="hs-identifier hs-var">MO_F64_Exp</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682857747"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857747"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857748"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857748"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857745"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;exp&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857747"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857748"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3094"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857749"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857749"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_ExpM1"><span class="hs-identifier hs-var">MO_F64_ExpM1</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682857751"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857751"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857752"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857752"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857749"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expm1&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857751"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857752"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3095"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857753"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857753"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Log"><span class="hs-identifier hs-var">MO_F64_Log</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682857755"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857755"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857756"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857756"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857753"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;log&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857755"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857756"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3096"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857757"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857757"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Log1P"><span class="hs-identifier hs-var">MO_F64_Log1P</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682857759"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857759"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857760"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857760"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857757"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;log1p&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857759"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857760"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3097"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857761"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857761"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Asin"><span class="hs-identifier hs-var">MO_F64_Asin</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857763"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857763"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857764"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857764"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857761"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;asin&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857763"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857764"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3098"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857765"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857765"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Acos"><span class="hs-identifier hs-var">MO_F64_Acos</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857767"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857767"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857768"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857768"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857765"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;acos&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857767"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857768"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3099"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857769"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857769"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Atan"><span class="hs-identifier hs-var">MO_F64_Atan</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857771"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857771"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857772"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857772"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857769"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;atan&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857771"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857772"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3100"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857773"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857773"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Sinh"><span class="hs-identifier hs-var">MO_F64_Sinh</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857775"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857775"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857776"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857776"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857773"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sinh&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857775"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857776"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3101"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857777"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857777"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Cosh"><span class="hs-identifier hs-var">MO_F64_Cosh</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857779"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857779"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857780"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857780"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857777"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cosh&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857779"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857780"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3102"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857781"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857781"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Tanh"><span class="hs-identifier hs-var">MO_F64_Tanh</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857783"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857783"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857784"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857784"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857781"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tanh&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857783"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857784"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3103"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857785"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857785"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Pwr"><span class="hs-identifier hs-var">MO_F64_Pwr</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682857787"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857787"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857788"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857788"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857789"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857789"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857785"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pow&quot;</span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857787"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857788"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857789"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3104"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857790"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857790"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Asinh"><span class="hs-identifier hs-var">MO_F64_Asinh</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682857792"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857792"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857793"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857793"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857790"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;asinh&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857792"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857793"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3105"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857794"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857794"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Acosh"><span class="hs-identifier hs-var">MO_F64_Acosh</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682857796"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857796"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857797"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857797"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857794"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;acosh&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857796"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857797"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3106"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857798"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857798"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Atanh"><span class="hs-identifier hs-var">MO_F64_Atanh</span></a></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621682857800"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857800"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857801"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857801"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857798"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;atanh&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857800"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857801"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3107"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857802"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857802"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_SuspendThread"><span class="hs-identifier hs-var">MO_SuspendThread</span></a></span><span>     </span><span class="hs-special">[</span><span id="local-6989586621682857804"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857804"><span class="hs-identifier hs-var">tok</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857805"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857805"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857806"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857806"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genRTSCCall"><span class="hs-identifier hs-var">genRTSCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857802"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;suspendThread&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857804"><span class="hs-identifier hs-var">tok</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857805"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857806"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3108"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857808"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857808"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_ResumeThread"><span class="hs-identifier hs-var">MO_ResumeThread</span></a></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682857810"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857810"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">]</span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682857811"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857811"><span class="hs-identifier hs-var">tok</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genRTSCCall"><span class="hs-identifier hs-var">genRTSCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857808"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;resumeThread&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857810"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857811"><span class="hs-identifier hs-var">tok</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3109"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857812"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857812"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_Quot"><span class="hs-identifier hs-var">MO_I64_Quot</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857814"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857814"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857815"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857815"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857816"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857816"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857812"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hs_quotInt64&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857814"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857815"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857816"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3110"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857818"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857818"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_Rem"><span class="hs-identifier hs-var">MO_I64_Rem</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682857820"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857820"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857821"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857821"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857822"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857822"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857818"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hs_remInt64&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857820"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857821"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857822"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3111"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857823"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857823"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_Quot"><span class="hs-identifier hs-var">MO_W64_Quot</span></a></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682857825"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857825"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857826"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857826"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857827"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857827"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857823"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hs_quotWord64&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857825"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857826"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857827"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3112"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span id="local-6989586621682857828"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857828"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_Rem"><span class="hs-identifier hs-var">MO_W64_Rem</span></a></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621682857830"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857830"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682857831"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857831"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682857832"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857832"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857828"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hs_remWord64&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857830"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857831"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857832"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3113"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSimplePrim"><span class="hs-identifier hs-var">genSimplePrim</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621682857833"><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682857833"><span class="hs-identifier hs-var">op</span></a></span></span><span>                   </span><span id="local-6989586621682857834"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682857834"><span class="hs-identifier hs-var">dst</span></a></span></span><span>     </span><span id="local-6989586621682857835"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857835"><span class="hs-identifier hs-var">args</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3114"></span><span>  </span><span id="local-6989586621682857836"><span class="annot"><a href="#local-6989586621682857836"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">(NCGConfig -&gt; Platform) -&gt; NatM NCGConfig -&gt; NatM Platform
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-3115"></span><span>  </span><span class="annot"><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-type">pprPanic</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;genSimplePrim: unhandled primop&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#pprCallishMachOp"><span class="hs-identifier hs-type">pprCallishMachOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857833"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682857834"><span class="hs-identifier hs-type">dst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-type">pdoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857836"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682857835"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3116"></span><span>
</span><span id="line-3117"></span><span class="hs-comment">{- Note [Evaluate C-call arguments before placing in destination registers]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When producing code for C calls we must take care when placing arguments
in their final registers. Specifically, we must ensure that temporary register
usage due to evaluation of one argument does not clobber a register in which we
already placed a previous argument (e.g. as the code generation logic for
MO_Shl can clobber %rcx due to x86 instruction limitations).

This is precisely what happened in #18527. Consider this C--:

    (result::I64) = call &quot;ccall&quot; doSomething(_s2hp::I64, 2244, _s2hq::I64, _s2hw::I64 | (1 &lt;&lt; _s2hz::I64));

Here we are calling the C function `doSomething` with three arguments, the last
involving a non-trivial expression involving MO_Shl. In this case the NCG could
naively generate the following assembly (where $tmp denotes some temporary
register and $argN denotes the register for argument N, as dictated by the
platform's calling convention):

    mov _s2hp, $arg1   # place first argument
    mov _s2hq, $arg2   # place second argument

    # Compute 1 &lt;&lt; _s2hz
    mov _s2hz, %rcx
    shl %cl, $tmp

    # Compute (_s2hw | (1 &lt;&lt; _s2hz))
    mov _s2hw, $arg3
    or $tmp, $arg3

    # Perform the call
    call func

This code is outright broken on Windows which assigns $arg1 to %rcx. This means
that the evaluation of the last argument clobbers the first argument.

To avoid this we use a rather awful hack: when producing code for a C call with
at least one non-trivial argument, we first evaluate all of the arguments into
local registers before moving them into their final calling-convention-defined
homes.  This is performed by 'evalArgs'. Here we define &quot;non-trivial&quot; to be an
expression which might contain a MachOp since these are the only cases which
might clobber registers. Furthermore, we use a conservative approximation of
this condition (only looking at the top-level of CmmExprs) to avoid spending
too much effort trying to decide whether we want to take the fast path.

Note that this hack *also* applies to calls to out-of-line PrimTargets (which
are lowered via a C call), which will ultimately end up in
genForeignCall{32,64}.
-}</span><span>
</span><span id="line-3165"></span><span>
</span><span id="line-3166"></span><span class="annot"><span class="hs-comment">-- | See Note [Evaluate C-call arguments before placing in destination registers]</span></span><span>
</span><span id="line-3167"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#evalArgs"><span class="hs-identifier hs-type">evalArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3168"></span><span id="evalArgs"><span class="annot"><span class="annottext">evalArgs :: Label -&gt; [CmmExpr] -&gt; NatM (InstrBlock, [CmmExpr])
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#evalArgs"><span class="hs-identifier hs-var hs-var">evalArgs</span></a></span></span><span> </span><span id="local-6989586621682857839"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857839"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682857840"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857840"><span class="hs-identifier hs-var">actuals</span></a></span></span><span>
</span><span id="line-3169"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; Bool) -&gt; [CmmExpr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#loadIntoRegMightClobberOtherReg"><span class="hs-identifier hs-var">loadIntoRegMightClobberOtherReg</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857840"><span class="hs-identifier hs-var">actuals</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3170"></span><span>      </span><span id="local-6989586621682857842"><span class="annot"><a href="#local-6989586621682857842"><span class="hs-identifier hs-var">regs_blks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; NatM (InstrBlock, CmmExpr))
-&gt; [CmmExpr] -&gt; NatM [(InstrBlock, CmmExpr)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (InstrBlock, CmmExpr)
</span><a href="#local-6989586621682857844"><span class="hs-identifier hs-var">evalArg</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857840"><span class="hs-identifier hs-var">actuals</span></a></span><span>
</span><span id="line-3171"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#concatOL"><span class="hs-identifier hs-type">concatOL</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fst</span></span><span> </span><span class="annot"><a href="#local-6989586621682857842"><span class="hs-identifier hs-type">regs_blks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">snd</span></span><span> </span><span class="annot"><a href="#local-6989586621682857842"><span class="hs-identifier hs-type">regs_blks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3172"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(InstrBlock, [CmmExpr]) -&gt; NatM (InstrBlock, [CmmExpr])
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857840"><span class="hs-identifier hs-var">actuals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3173"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3174"></span><span>
</span><span id="line-3175"></span><span>    </span><span class="annot"><a href="#local-6989586621682857844"><span class="hs-identifier hs-type">evalArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3176"></span><span>    </span><span id="local-6989586621682857844"><span class="annot"><span class="annottext">evalArg :: CmmExpr -&gt; NatM (InstrBlock, CmmExpr)
</span><a href="#local-6989586621682857844"><span class="hs-identifier hs-var hs-var">evalArg</span></a></span></span><span> </span><span id="local-6989586621682857848"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857848"><span class="hs-identifier hs-var">actual</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3177"></span><span>        </span><span id="local-6989586621682857849"><span class="annot"><a href="#local-6989586621682857849"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-3178"></span><span>        </span><span id="local-6989586621682857850"><span class="annot"><a href="#local-6989586621682857850"><span class="hs-identifier hs-var">lreg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682857851"><span class="hs-identifier hs-type">newLocalReg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-type">cmmExprType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857849"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857848"><span class="hs-identifier hs-type">actual</span></a></span><span>
</span><span id="line-3179"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682857852"><span class="annot"><a href="#local-6989586621682857852"><span class="hs-identifier hs-var">instrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857853"><span class="annot"><a href="#local-6989586621682857853"><span class="hs-identifier hs-var">bid1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stmtToInstrs"><span class="hs-identifier hs-type">stmtToInstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857839"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmAssign"><span class="hs-identifier hs-type">CmmAssign</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-type">CmmLocal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857850"><span class="hs-identifier hs-type">lreg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682857848"><span class="hs-identifier hs-type">actual</span></a></span><span>
</span><span id="line-3180"></span><span>        </span><span class="hs-comment">-- The above assignment shouldn't change the current block</span><span>
</span><span id="line-3181"></span><span>        </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-type">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">isNothing</span></span><span> </span><span class="annot"><a href="#local-6989586621682857853"><span class="hs-identifier hs-type">bid1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3182"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857852"><span class="hs-identifier hs-type">instrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-type">CmmLocal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857850"><span class="hs-identifier hs-type">lreg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3183"></span><span>
</span><span id="line-3184"></span><span>    </span><span class="annot"><a href="#local-6989586621682857851"><span class="hs-identifier hs-type">newLocalReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#CmmType"><span class="hs-identifier hs-type">CmmType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-3185"></span><span>    </span><span id="local-6989586621682857851"><span class="annot"><span class="annottext">newLocalReg :: CmmType -&gt; NatM LocalReg
</span><a href="#local-6989586621682857851"><span class="hs-identifier hs-var hs-var">newLocalReg</span></a></span></span><span> </span><span id="local-6989586621682857856"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857856"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; CmmType -&gt; LocalReg
</span><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-var">LocalReg</span></a></span><span> </span><span class="annot"><span class="annottext">(Unique -&gt; CmmType -&gt; LocalReg)
-&gt; NatM Unique -&gt; NatM (CmmType -&gt; LocalReg)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NatM Unique
forall (m :: * -&gt; *). MonadGetUnique m =&gt; m Unique
</span><a href="GHC.Types.Unique.DSM.html#getUniqueM"><span class="hs-identifier hs-var">getUniqueM</span></a></span><span> </span><span class="annot"><span class="annottext">NatM (CmmType -&gt; LocalReg) -&gt; NatM CmmType -&gt; NatM LocalReg
forall a b. NatM (a -&gt; b) -&gt; NatM a -&gt; NatM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; NatM CmmType
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857856"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-3186"></span><span>
</span><span id="line-3187"></span><span class="hs-comment">-- | Might the code to put this expression into a register</span><span>
</span><span id="line-3188"></span><span class="hs-comment">-- clobber any other registers?</span><span>
</span><span id="line-3189"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadIntoRegMightClobberOtherReg"><span class="hs-identifier hs-type">loadIntoRegMightClobberOtherReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-3190"></span><span id="loadIntoRegMightClobberOtherReg"><span class="annot"><span class="annottext">loadIntoRegMightClobberOtherReg :: CmmExpr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#loadIntoRegMightClobberOtherReg"><span class="hs-identifier hs-var hs-var">loadIntoRegMightClobberOtherReg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-3191"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadIntoRegMightClobberOtherReg"><span class="hs-identifier hs-var">loadIntoRegMightClobberOtherReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmRegOff"><span class="hs-identifier hs-type">CmmRegOff</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-3192"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadIntoRegMightClobberOtherReg"><span class="hs-identifier hs-var">loadIntoRegMightClobberOtherReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-3193"></span><span>  </span><span class="hs-comment">-- NB: this last 'False' is slightly risky, because the code for loading</span><span>
</span><span id="line-3194"></span><span>  </span><span class="hs-comment">-- a literal into a register is not entirely trivial.</span><span>
</span><span id="line-3195"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadIntoRegMightClobberOtherReg"><span class="hs-identifier hs-var">loadIntoRegMightClobberOtherReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3196"></span><span>
</span><span id="line-3197"></span><span class="hs-comment">-- Note [DIV/IDIV for bytes]</span><span>
</span><span id="line-3198"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-3199"></span><span class="hs-comment">-- IDIV reminder:</span><span>
</span><span id="line-3200"></span><span class="hs-comment">--   Size    Dividend   Divisor   Quotient    Remainder</span><span>
</span><span id="line-3201"></span><span class="hs-comment">--   byte    %ax         r/m8      %al          %ah</span><span>
</span><span id="line-3202"></span><span class="hs-comment">--   word    %dx:%ax     r/m16     %ax          %dx</span><span>
</span><span id="line-3203"></span><span class="hs-comment">--   dword   %edx:%eax   r/m32     %eax         %edx</span><span>
</span><span id="line-3204"></span><span class="hs-comment">--   qword   %rdx:%rax   r/m64     %rax         %rdx</span><span>
</span><span id="line-3205"></span><span class="hs-comment">--</span><span>
</span><span id="line-3206"></span><span class="hs-comment">-- We do a special case for the byte division because the current</span><span>
</span><span id="line-3207"></span><span class="hs-comment">-- codegen doesn't deal well with accessing %ah register (also,</span><span>
</span><span id="line-3208"></span><span class="hs-comment">-- accessing %ah in 64-bit mode is complicated because it cannot be an</span><span>
</span><span id="line-3209"></span><span class="hs-comment">-- operand of many instructions). So we just widen operands to 16 bits</span><span>
</span><span id="line-3210"></span><span class="hs-comment">-- and get the results from %al, %dl. This is not optimal, but a few</span><span>
</span><span id="line-3211"></span><span class="hs-comment">-- register moves are probably not a huge deal when doing division.</span><span>
</span><span id="line-3212"></span><span>
</span><span id="line-3213"></span><span>
</span><span id="line-3214"></span><span class="annot"><span class="hs-comment">-- | Generate C call to the given function in ghc-prim</span></span><span>
</span><span id="line-3215"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-type">genPrimCCall</span></a></span><span>
</span><span id="line-3216"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-3217"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>
</span><span id="line-3218"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3219"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3220"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-3221"></span><span id="genPrimCCall"><span class="annot"><span class="annottext">genPrimCCall :: Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var hs-var">genPrimCCall</span></a></span></span><span> </span><span id="local-6989586621682857857"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857857"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682857858"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682857858"><span class="hs-identifier hs-var">lbl_txt</span></a></span></span><span> </span><span id="local-6989586621682857859"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682857859"><span class="hs-identifier hs-var">dsts</span></a></span></span><span> </span><span id="local-6989586621682857860"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857860"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3222"></span><span>  </span><span id="local-6989586621682857861"><span class="annot"><a href="#local-6989586621682857861"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-3223"></span><span>  </span><span class="hs-comment">-- FIXME: we should use mkForeignLabel instead of mkCmmCodeLabel</span><span>
</span><span id="line-3224"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857862"><span class="annot"><a href="#local-6989586621682857862"><span class="hs-identifier hs-var hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnitId -&gt; FastString -&gt; CLabel
</span><a href="GHC.Cmm.CLabel.html#mkCmmCodeLabel"><span class="hs-identifier hs-var">mkCmmCodeLabel</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="GHC.Unit.Types.html#primUnitId"><span class="hs-identifier hs-var">primUnitId</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682857858"><span class="hs-identifier hs-var">lbl_txt</span></a></span><span>
</span><span id="line-3225"></span><span>  </span><span id="local-6989586621682857864"><span class="annot"><a href="#local-6989586621682857864"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#cmmMakeDynamicReference"><span class="hs-identifier hs-type">cmmMakeDynamicReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857861"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#CallReference"><span class="hs-identifier hs-type">CallReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857862"><span class="hs-identifier hs-type">lbl</span></a></span><span>
</span><span id="line-3226"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857866"><span class="annot"><a href="#local-6989586621682857866"><span class="hs-identifier hs-var hs-var">conv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CCallConv
-&gt; [ForeignHint]
-&gt; [ForeignHint]
-&gt; CmmReturnInfo
-&gt; ForeignConvention
</span><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-var">ForeignConvention</span></a></span><span> </span><span class="annot"><span class="annottext">CCallConv
</span><a href="GHC.Types.ForeignCall.html#CCallConv"><span class="hs-identifier hs-var">CCallConv</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CmmReturnInfo
</span><a href="GHC.Cmm.Node.html#CmmMayReturn"><span class="hs-identifier hs-var">CmmMayReturn</span></a></span><span>
</span><span id="line-3227"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall"><span class="hs-identifier hs-type">genCCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857857"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857864"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857866"><span class="hs-identifier hs-type">conv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857859"><span class="hs-identifier hs-type">dsts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857860"><span class="hs-identifier hs-type">args</span></a></span><span>
</span><span id="line-3228"></span><span>
</span><span id="line-3229"></span><span class="annot"><span class="hs-comment">-- | Generate C call to the given function in libc</span></span><span>
</span><span id="line-3230"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-type">genLibCCall</span></a></span><span>
</span><span id="line-3231"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-3232"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>
</span><span id="line-3233"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3234"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3235"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-3236"></span><span id="genLibCCall"><span class="annot"><span class="annottext">genLibCCall :: Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var hs-var">genLibCCall</span></a></span></span><span> </span><span id="local-6989586621682857870"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857870"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682857871"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682857871"><span class="hs-identifier hs-var">lbl_txt</span></a></span></span><span> </span><span id="local-6989586621682857872"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682857872"><span class="hs-identifier hs-var">dsts</span></a></span></span><span> </span><span id="local-6989586621682857873"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857873"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3237"></span><span>  </span><span id="local-6989586621682857874"><span class="annot"><a href="#local-6989586621682857874"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-3238"></span><span>  </span><span class="hs-comment">-- Assume we can call these functions directly, and that they're not in a dynamic library.</span><span>
</span><span id="line-3239"></span><span>  </span><span class="hs-comment">-- TODO: Why is this ok? Under linux this code will be in libm.so</span><span>
</span><span id="line-3240"></span><span>  </span><span class="hs-comment">--       Is it because they're really implemented as a primitive instruction by the assembler??  -- BL 2009/12/31</span><span>
</span><span id="line-3241"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857875"><span class="annot"><a href="#local-6989586621682857875"><span class="hs-identifier hs-var hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; ForeignLabelSource -&gt; FunctionOrData -&gt; CLabel
</span><a href="GHC.Cmm.CLabel.html#mkForeignLabel"><span class="hs-identifier hs-var">mkForeignLabel</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682857871"><span class="hs-identifier hs-var">lbl_txt</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLabelSource
</span><a href="GHC.Cmm.CLabel.html#ForeignLabelInThisPackage"><span class="hs-identifier hs-var">ForeignLabelInThisPackage</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionOrData
</span><a href="GHC.Types.Basic.html#IsFunction"><span class="hs-identifier hs-var">IsFunction</span></a></span><span>
</span><span id="line-3242"></span><span>  </span><span id="local-6989586621682857879"><span class="annot"><a href="#local-6989586621682857879"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#cmmMakeDynamicReference"><span class="hs-identifier hs-type">cmmMakeDynamicReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857874"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#CallReference"><span class="hs-identifier hs-type">CallReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857875"><span class="hs-identifier hs-type">lbl</span></a></span><span>
</span><span id="line-3243"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857880"><span class="annot"><a href="#local-6989586621682857880"><span class="hs-identifier hs-var hs-var">conv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CCallConv
-&gt; [ForeignHint]
-&gt; [ForeignHint]
-&gt; CmmReturnInfo
-&gt; ForeignConvention
</span><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-var">ForeignConvention</span></a></span><span> </span><span class="annot"><span class="annottext">CCallConv
</span><a href="GHC.Types.ForeignCall.html#CCallConv"><span class="hs-identifier hs-var">CCallConv</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CmmReturnInfo
</span><a href="GHC.Cmm.Node.html#CmmMayReturn"><span class="hs-identifier hs-var">CmmMayReturn</span></a></span><span>
</span><span id="line-3244"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall"><span class="hs-identifier hs-type">genCCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857870"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857879"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857880"><span class="hs-identifier hs-type">conv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857872"><span class="hs-identifier hs-type">dsts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857873"><span class="hs-identifier hs-type">args</span></a></span><span>
</span><span id="line-3245"></span><span>
</span><span id="line-3246"></span><span class="annot"><span class="hs-comment">-- | Generate C call to the given function in the RTS</span></span><span>
</span><span id="line-3247"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genRTSCCall"><span class="hs-identifier hs-type">genRTSCCall</span></a></span><span>
</span><span id="line-3248"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-3249"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>
</span><span id="line-3250"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3251"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3252"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-3253"></span><span id="genRTSCCall"><span class="annot"><span class="annottext">genRTSCCall :: Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genRTSCCall"><span class="hs-identifier hs-var hs-var">genRTSCCall</span></a></span></span><span> </span><span id="local-6989586621682857881"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857881"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682857882"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682857882"><span class="hs-identifier hs-var">lbl_txt</span></a></span></span><span> </span><span id="local-6989586621682857883"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682857883"><span class="hs-identifier hs-var">dsts</span></a></span></span><span> </span><span id="local-6989586621682857884"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857884"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3254"></span><span>  </span><span id="local-6989586621682857885"><span class="annot"><a href="#local-6989586621682857885"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-3255"></span><span>  </span><span class="hs-comment">-- Assume we can call these functions directly, and that they're not in a dynamic library.</span><span>
</span><span id="line-3256"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857886"><span class="annot"><a href="#local-6989586621682857886"><span class="hs-identifier hs-var hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; ForeignLabelSource -&gt; FunctionOrData -&gt; CLabel
</span><a href="GHC.Cmm.CLabel.html#mkForeignLabel"><span class="hs-identifier hs-var">mkForeignLabel</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682857882"><span class="hs-identifier hs-var">lbl_txt</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLabelSource
</span><a href="GHC.Cmm.CLabel.html#ForeignLabelInThisPackage"><span class="hs-identifier hs-var">ForeignLabelInThisPackage</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionOrData
</span><a href="GHC.Types.Basic.html#IsFunction"><span class="hs-identifier hs-var">IsFunction</span></a></span><span>
</span><span id="line-3257"></span><span>  </span><span id="local-6989586621682857887"><span class="annot"><a href="#local-6989586621682857887"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#cmmMakeDynamicReference"><span class="hs-identifier hs-type">cmmMakeDynamicReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857885"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#CallReference"><span class="hs-identifier hs-type">CallReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857886"><span class="hs-identifier hs-type">lbl</span></a></span><span>
</span><span id="line-3258"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857888"><span class="annot"><a href="#local-6989586621682857888"><span class="hs-identifier hs-var hs-var">conv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CCallConv
-&gt; [ForeignHint]
-&gt; [ForeignHint]
-&gt; CmmReturnInfo
-&gt; ForeignConvention
</span><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-var">ForeignConvention</span></a></span><span> </span><span class="annot"><span class="annottext">CCallConv
</span><a href="GHC.Types.ForeignCall.html#CCallConv"><span class="hs-identifier hs-var">CCallConv</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CmmReturnInfo
</span><a href="GHC.Cmm.Node.html#CmmMayReturn"><span class="hs-identifier hs-var">CmmMayReturn</span></a></span><span>
</span><span id="line-3259"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall"><span class="hs-identifier hs-type">genCCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857881"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857887"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857888"><span class="hs-identifier hs-type">conv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857883"><span class="hs-identifier hs-type">dsts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857884"><span class="hs-identifier hs-type">args</span></a></span><span>
</span><span id="line-3260"></span><span>
</span><span id="line-3261"></span><span class="annot"><span class="hs-comment">-- | Generate a real C call to the given address with the given convention</span></span><span>
</span><span id="line-3262"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall"><span class="hs-identifier hs-type">genCCall</span></a></span><span>
</span><span id="line-3263"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-3264"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-3265"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-type">ForeignConvention</span></a></span><span>
</span><span id="line-3266"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3267"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3268"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-3269"></span><span id="genCCall"><span class="annot"><span class="annottext">genCCall :: Label
-&gt; CmmExpr
-&gt; ForeignConvention
-&gt; [LocalReg]
-&gt; [CmmExpr]
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall"><span class="hs-identifier hs-var hs-var">genCCall</span></a></span></span><span> </span><span id="local-6989586621682857889"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682857889"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682857890"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857890"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682857891"><span class="annot"><span class="annottext">conv :: ForeignConvention
</span><a href="#local-6989586621682857891"><span class="hs-identifier hs-var">conv</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-type">ForeignConvention</span></a></span><span> </span><span class="annot"><span class="annottext">CCallConv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682857892"><span class="annot"><span class="annottext">[ForeignHint]
</span><a href="#local-6989586621682857892"><span class="hs-identifier hs-var">argHints</span></a></span></span><span> </span><span class="annot"><span class="annottext">[ForeignHint]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CmmReturnInfo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682857893"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682857893"><span class="hs-identifier hs-var">dest_regs</span></a></span></span><span> </span><span id="local-6989586621682857894"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857894"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3270"></span><span>  </span><span id="local-6989586621682857895"><span class="annot"><a href="#local-6989586621682857895"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-3271"></span><span>  </span><span id="local-6989586621682857896"><span class="annot"><a href="#local-6989586621682857896"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-type">is32BitPlatform</span></a></span><span>
</span><span id="line-3272"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857897"><span class="annot"><a href="#local-6989586621682857897"><span class="hs-identifier hs-var hs-var">args_hints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CmmExpr] -&gt; [ForeignHint] -&gt; [(CmmExpr, ForeignHint)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857894"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ForeignHint]
</span><a href="#local-6989586621682857892"><span class="hs-identifier hs-var">argHints</span></a></span><span> </span><span class="annot"><span class="annottext">[ForeignHint] -&gt; [ForeignHint] -&gt; [ForeignHint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ForeignHint -&gt; [ForeignHint]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">ForeignHint
</span><a href="GHC.Cmm.Type.html#NoHint"><span class="hs-identifier hs-var">NoHint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3273"></span><span>      </span><span id="local-6989586621682857900"><span class="annot"><a href="#local-6989586621682857900"><span class="hs-identifier hs-var hs-var">prom_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((CmmExpr, ForeignHint) -&gt; CmmExpr)
-&gt; [(CmmExpr, ForeignHint)] -&gt; [CmmExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; (CmmExpr, ForeignHint) -&gt; CmmExpr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#maybePromoteCArgToW32"><span class="hs-identifier hs-var">maybePromoteCArgToW32</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857895"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CmmExpr, ForeignHint)]
</span><a href="#local-6989586621682857897"><span class="hs-identifier hs-var">args_hints</span></a></span><span>
</span><span id="line-3274"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682857902"><span class="annot"><a href="#local-6989586621682857902"><span class="hs-identifier hs-var">instrs0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857903"><span class="annot"><a href="#local-6989586621682857903"><span class="hs-identifier hs-var">args'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#evalArgs"><span class="hs-identifier hs-type">evalArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857889"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857900"><span class="hs-identifier hs-type">prom_args</span></a></span><span>
</span><span id="line-3275"></span><span>  </span><span id="local-6989586621682857904"><span class="annot"><a href="#local-6989586621682857904"><span class="hs-identifier hs-var">instrs1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682857896"><span class="hs-identifier hs-type">is32Bit</span></a></span><span>
</span><span id="line-3276"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall32"><span class="hs-identifier hs-type">genCCall32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857890"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857891"><span class="hs-identifier hs-type">conv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857893"><span class="hs-identifier hs-type">dest_regs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857903"><span class="hs-identifier hs-type">args'</span></a></span><span>
</span><span id="line-3277"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall64"><span class="hs-identifier hs-type">genCCall64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857890"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857891"><span class="hs-identifier hs-type">conv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857893"><span class="hs-identifier hs-type">dest_regs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857903"><span class="hs-identifier hs-type">args'</span></a></span><span>
</span><span id="line-3278"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857902"><span class="hs-identifier hs-type">instrs0</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857904"><span class="hs-identifier hs-type">instrs1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3279"></span><span>
</span><span id="line-3280"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#maybePromoteCArgToW32"><span class="hs-identifier hs-type">maybePromoteCArgToW32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#ForeignHint"><span class="hs-identifier hs-type">ForeignHint</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-3281"></span><span id="maybePromoteCArgToW32"><span class="annot"><span class="annottext">maybePromoteCArgToW32 :: Platform -&gt; (CmmExpr, ForeignHint) -&gt; CmmExpr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#maybePromoteCArgToW32"><span class="hs-identifier hs-var hs-var">maybePromoteCArgToW32</span></a></span></span><span> </span><span id="local-6989586621682857907"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857907"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682857908"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857908"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857909"><span class="annot"><span class="annottext">ForeignHint
</span><a href="#local-6989586621682857909"><span class="hs-identifier hs-var">hint</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3282"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857910"><span class="hs-identifier hs-var">wfrom</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857911"><span class="hs-identifier hs-var">wto</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3283"></span><span>    </span><span class="hs-comment">-- As wto=W32, we only need to handle integer conversions,</span><span>
</span><span id="line-3284"></span><span>    </span><span class="hs-comment">-- never Float -&gt; Double.</span><span>
</span><span id="line-3285"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ForeignHint
</span><a href="#local-6989586621682857909"><span class="hs-identifier hs-var">hint</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3286"></span><span>      </span><span class="annot"><span class="annottext">ForeignHint
</span><a href="GHC.Cmm.Type.html#SignedHint"><span class="hs-identifier hs-var">SignedHint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-var">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857910"><span class="hs-identifier hs-var">wfrom</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857911"><span class="hs-identifier hs-var">wto</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857908"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3287"></span><span>      </span><span class="annot"><span class="annottext">ForeignHint
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-var">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857910"><span class="hs-identifier hs-var">wfrom</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857911"><span class="hs-identifier hs-var">wto</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857908"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3288"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857908"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-3289"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3290"></span><span>   </span><span id="local-6989586621682857913"><span class="annot"><span class="annottext">ty :: CmmType
</span><a href="#local-6989586621682857913"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857907"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857908"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-3291"></span><span>   </span><span id="local-6989586621682857910"><span class="annot"><span class="annottext">wfrom :: Width
</span><a href="#local-6989586621682857910"><span class="hs-identifier hs-var hs-var">wfrom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857913"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-3292"></span><span>   </span><span id="local-6989586621682857911"><span class="annot"><span class="annottext">wto :: Width
</span><a href="#local-6989586621682857911"><span class="hs-identifier hs-var hs-var">wto</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>
</span><span id="line-3293"></span><span>
</span><span id="line-3294"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall32"><span class="hs-identifier hs-type">genCCall32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ address of the function to call</span></span><span>
</span><span id="line-3295"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-type">ForeignConvention</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ calling convention</span></span><span>
</span><span id="line-3296"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>       </span><span class="annot"><span class="hs-comment">-- ^ where to put the result</span></span><span>
</span><span id="line-3297"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>       </span><span class="annot"><span class="hs-comment">-- ^ arguments (of mixed type)</span></span><span>
</span><span id="line-3298"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-3299"></span><span id="genCCall32"><span class="annot"><span class="annottext">genCCall32 :: CmmExpr
-&gt; ForeignConvention -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall32"><span class="hs-identifier hs-var hs-var">genCCall32</span></a></span></span><span> </span><span id="local-6989586621682857914"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857914"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682857915"><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682857915"><span class="hs-identifier hs-var">_conv</span></a></span></span><span> </span><span id="local-6989586621682857916"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682857916"><span class="hs-identifier hs-var">dest_regs</span></a></span></span><span> </span><span id="local-6989586621682857917"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857917"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3300"></span><span>        </span><span id="local-6989586621682857918"><span class="annot"><a href="#local-6989586621682857918"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-3301"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857919"><span class="annot"><a href="#local-6989586621682857919"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682857918"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-3302"></span><span>
</span><span id="line-3303"></span><span>            </span><span class="hs-comment">-- If the size is smaller than the word, we widen things (see maybePromoteCArg)</span><span>
</span><span id="line-3304"></span><span>            </span><span class="annot"><a href="#local-6989586621682857920"><span class="hs-identifier hs-type">arg_size_bytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#CmmType"><span class="hs-identifier hs-type">CmmType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-3305"></span><span>            </span><span id="local-6989586621682857920"><span class="annot"><a href="#local-6989586621682857920"><span class="hs-identifier hs-var hs-var">arg_size_bytes</span></a></span></span><span> </span><span id="local-6989586621682857921"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857921"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBytes"><span class="hs-identifier hs-var">widthInBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857921"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBytes"><span class="hs-identifier hs-var">widthInBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Width
</span><a href="GHC.Cmm.Type.html#wordWidth"><span class="hs-identifier hs-var">wordWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857919"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3306"></span><span>
</span><span id="line-3307"></span><span>            </span><span id="local-6989586621682857942"><span class="annot"><a href="#local-6989586621682857942"><span class="hs-identifier hs-var hs-var">roundTo</span></a></span></span><span> </span><span id="local-6989586621682857943"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682857943"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682857944"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682857944"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682857944"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682857943"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682857944"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-3308"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682857944"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682857943"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682857944"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682857943"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3309"></span><span>
</span><span id="line-3310"></span><span>            </span><span class="annot"><a href="#local-6989586621682857945"><span class="hs-identifier hs-type">push_arg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-comment">{-current argument-}</span><span>
</span><span id="line-3311"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>  </span><span class="hs-comment">-- code</span><span>
</span><span id="line-3312"></span><span>
</span><span id="line-3313"></span><span>            </span><span id="local-6989586621682857945"><span class="annot"><a href="#local-6989586621682857945"><span class="hs-identifier hs-var hs-var">push_arg</span></a></span></span><span>  </span><span id="local-6989586621682857946"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857946"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-comment">-- we don't need the hints on x86</span><span>
</span><span id="line-3314"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-var">isWord64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857947"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3315"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682857948"><span class="annot"><a href="#local-6989586621682857948"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682857949"><span class="annot"><a href="#local-6989586621682857949"><span class="hs-identifier hs-var">r_hi</span></a></span></span><span> </span><span id="local-6989586621682857950"><span class="annot"><a href="#local-6989586621682857950"><span class="hs-identifier hs-var">r_lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857946"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-3316"></span><span>                </span><span id="local-6989586621682857951"><span class="annot"><a href="#local-6989586621682857951"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-3317"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857951"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-3318"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span>       </span><span class="annot"><a href="#local-6989586621682857948"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3319"></span><span>                               </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#PUSH"><span class="hs-identifier hs-type">PUSH</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857949"><span class="hs-identifier hs-type">r_hi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857951"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3320"></span><span>                                     </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#PUSH"><span class="hs-identifier hs-type">PUSH</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857950"><span class="hs-identifier hs-type">r_lo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857951"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3321"></span><span>                                     </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857951"><span class="hs-identifier hs-type">delta</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-3322"></span><span>                    </span><span class="hs-special">)</span><span>
</span><span id="line-3323"></span><span>
</span><span id="line-3324"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-var">isFloatType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857947"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isVecType"><span class="hs-identifier hs-var">isVecType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857947"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3325"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621682857953"><span class="annot"><a href="#local-6989586621682857953"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857954"><span class="annot"><a href="#local-6989586621682857954"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857946"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-3326"></span><span>                </span><span id="local-6989586621682857955"><span class="annot"><a href="#local-6989586621682857955"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-3327"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857955"><span class="hs-identifier hs-type">delta</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><a href="#local-6989586621682857956"><span class="hs-identifier hs-type">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3328"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857954"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3329"></span><span>                                </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-type">SUB</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857956"><span class="hs-identifier hs-type">size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#esp"><span class="hs-identifier hs-type">esp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3330"></span><span>                                      </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857955"><span class="hs-identifier hs-type">delta</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><a href="#local-6989586621682857956"><span class="hs-identifier hs-type">size</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3331"></span><span>                                      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857958"><span class="annot"><a href="#local-6989586621682857958"><span class="hs-identifier hs-var hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3332"></span><span>                                                                </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span>
</span><span id="line-3333"></span><span>                                                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-3334"></span><span>                                          </span><span id="local-6989586621682857959"><span class="annot"><a href="#local-6989586621682857959"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857947"><span class="hs-identifier hs-var">arg_ty</span></a></span><span>
</span><span id="line-3335"></span><span>                                      </span><span class="hs-keyword">in</span><span>
</span><span id="line-3336"></span><span>
</span><span id="line-3337"></span><span>                                       </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#movInstr"><span class="hs-identifier hs-type">movInstr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857918"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857959"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857953"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857958"><span class="hs-identifier hs-type">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3338"></span><span>
</span><span id="line-3339"></span><span>                                     </span><span class="hs-special">]</span><span>
</span><span id="line-3340"></span><span>                               </span><span class="hs-special">)</span><span>
</span><span id="line-3341"></span><span>
</span><span id="line-3342"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3343"></span><span>                </span><span class="hs-comment">-- Arguments can be smaller than 32-bit, but we still use @PUSH</span><span>
</span><span id="line-3344"></span><span>                </span><span class="hs-comment">-- II32@ - the usual calling conventions expect integers to be</span><span>
</span><span id="line-3345"></span><span>                </span><span class="hs-comment">-- 4-byte aligned.</span><span>
</span><span id="line-3346"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; NatM ()
forall (m :: * -&gt; *). (HasCallStack, Applicative m) =&gt; Bool -&gt; m ()
</span><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-var">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857947"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3347"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621682857960"><span class="annot"><a href="#local-6989586621682857960"><span class="hs-identifier hs-var">operand</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857961"><span class="annot"><a href="#local-6989586621682857961"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-var">getOperand</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857946"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-3348"></span><span>                </span><span id="local-6989586621682857962"><span class="annot"><a href="#local-6989586621682857962"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-3349"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857962"><span class="hs-identifier hs-type">delta</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><a href="#local-6989586621682857956"><span class="hs-identifier hs-type">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3350"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857961"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span>
</span><span id="line-3351"></span><span>                        </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#PUSH"><span class="hs-identifier hs-type">PUSH</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857960"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span>
</span><span id="line-3352"></span><span>                        </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857962"><span class="hs-identifier hs-type">delta</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><a href="#local-6989586621682857956"><span class="hs-identifier hs-type">size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3353"></span><span>
</span><span id="line-3354"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-3355"></span><span>                 </span><span id="local-6989586621682857947"><span class="annot"><span class="annottext">arg_ty :: CmmType
</span><a href="#local-6989586621682857947"><span class="hs-identifier hs-var hs-var">arg_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857919"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857946"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-3356"></span><span>                 </span><span id="local-6989586621682857956"><span class="annot"><span class="annottext">size :: Int
</span><a href="#local-6989586621682857956"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Int
</span><a href="#local-6989586621682857920"><span class="hs-identifier hs-var">arg_size_bytes</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857947"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="hs-comment">-- Byte size</span><span>
</span><span id="line-3357"></span><span>
</span><span id="line-3358"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-3359"></span><span>            </span><span class="hs-comment">-- Align stack to 16n for calls, assuming a starting stack</span><span>
</span><span id="line-3360"></span><span>            </span><span class="hs-comment">-- alignment of 16n - word_size on procedure entry. Which we</span><span>
</span><span id="line-3361"></span><span>            </span><span class="hs-comment">-- maintain. See Note [Stack Alignment on X86] in rts/StgCRun.c.</span><span>
</span><span id="line-3362"></span><span>            </span><span id="local-6989586621682857963"><span class="annot"><a href="#local-6989586621682857963"><span class="hs-identifier hs-var hs-var">sizes</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; Int) -&gt; [CmmExpr] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Int
</span><a href="#local-6989586621682857920"><span class="hs-identifier hs-var">arg_size_bytes</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmType -&gt; Int) -&gt; (CmmExpr -&gt; CmmType) -&gt; CmmExpr -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857919"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CmmExpr] -&gt; [CmmExpr]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857917"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3363"></span><span>            </span><span id="local-6989586621682857965"><span class="annot"><a href="#local-6989586621682857965"><span class="hs-identifier hs-var hs-var">raw_arg_size</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682857963"><span class="hs-identifier hs-var">sizes</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Int
</span><a href="GHC.Platform.html#platformWordSizeInBytes"><span class="hs-identifier hs-var">platformWordSizeInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857919"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-3364"></span><span>            </span><span id="local-6989586621682857968"><span class="annot"><a href="#local-6989586621682857968"><span class="hs-identifier hs-var hs-var">arg_pad_size</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621682857942"><span class="hs-identifier hs-var">roundTo</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857965"><span class="hs-identifier hs-var">raw_arg_size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857965"><span class="hs-identifier hs-var">raw_arg_size</span></a></span><span>
</span><span id="line-3365"></span><span>            </span><span id="local-6989586621682857969"><span class="annot"><a href="#local-6989586621682857969"><span class="hs-identifier hs-var hs-var">tot_arg_size</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857965"><span class="hs-identifier hs-var">raw_arg_size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857968"><span class="hs-identifier hs-var">arg_pad_size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Int
</span><a href="GHC.Platform.html#platformWordSizeInBytes"><span class="hs-identifier hs-var">platformWordSizeInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682857919"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-3366"></span><span>
</span><span id="line-3367"></span><span>
</span><span id="line-3368"></span><span>        </span><span id="local-6989586621682857970"><span class="annot"><a href="#local-6989586621682857970"><span class="hs-identifier hs-var">delta0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-3369"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857970"><span class="hs-identifier hs-type">delta0</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621682857968"><span class="hs-identifier hs-type">arg_pad_size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3370"></span><span>
</span><span id="line-3371"></span><span>        </span><span id="local-6989586621682857971"><span class="annot"><a href="#local-6989586621682857971"><span class="hs-identifier hs-var">push_codes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="#local-6989586621682857945"><span class="hs-identifier hs-type">push_arg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">reverse</span></span><span> </span><span class="annot"><a href="#local-6989586621682857917"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3372"></span><span>        </span><span id="local-6989586621682857972"><span class="annot"><a href="#local-6989586621682857972"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-3373"></span><span>        </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-type">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857972"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621682857970"><span class="hs-identifier hs-type">delta0</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621682857969"><span class="hs-identifier hs-type">tot_arg_size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3374"></span><span>
</span><span id="line-3375"></span><span>        </span><span class="hs-comment">-- deal with static vs dynamic call targets</span><span>
</span><span id="line-3376"></span><span>        </span><span id="local-6989586621682857973"><span class="annot"><a href="#local-6989586621682857973"><span class="hs-identifier hs-var">callinsns</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-3377"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682857914"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3378"></span><span>            </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-type">CmmLabel</span></a></span><span> </span><span id="local-6989586621682857974"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682857974"><span class="hs-identifier hs-var">lbl</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3379"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; NatM InstrBlock
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(InstrBlock -&gt; NatM InstrBlock) -&gt; InstrBlock -&gt; NatM InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either Imm Reg -&gt; [RegWithFormat] -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CALL"><span class="hs-identifier hs-var">CALL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Either Imm Reg
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Imm
</span><a href="#local-6989586621682857975"><span class="hs-identifier hs-var">fn_imm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3380"></span><span>               </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682857975"><span class="annot"><span class="annottext">fn_imm :: Imm
</span><a href="#local-6989586621682857975"><span class="hs-identifier hs-var hs-var">fn_imm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CLabel -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmCLbl"><span class="hs-identifier hs-var">ImmCLbl</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682857974"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-3381"></span><span>            </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-3382"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682857976"><span class="annot"><a href="#local-6989586621682857976"><span class="hs-identifier hs-var">dyn_r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682857977"><span class="annot"><a href="#local-6989586621682857977"><span class="hs-identifier hs-var">dyn_c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857914"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-3383"></span><span>                     </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-type">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Type.html#isWord32"><span class="hs-identifier hs-type">isWord32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-type">cmmExprType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857919"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857914"><span class="hs-identifier hs-type">addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3384"></span><span>                     </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682857977"><span class="hs-identifier hs-type">dyn_c</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CALL"><span class="hs-identifier hs-type">CALL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><a href="#local-6989586621682857976"><span class="hs-identifier hs-type">dyn_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-3385"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857979"><span class="annot"><a href="#local-6989586621682857979"><span class="hs-identifier hs-var hs-var">push_code</span></a></span></span><span>
</span><span id="line-3386"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857968"><span class="hs-identifier hs-var">arg_pad_size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-3387"></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857968"><span class="hs-identifier hs-var">arg_pad_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3388"></span><span>                        </span><span class="annot"><span class="annottext">Int -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857970"><span class="hs-identifier hs-var">delta0</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857968"><span class="hs-identifier hs-var">arg_pad_size</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-3389"></span><span>                  </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[InstrBlock] -&gt; InstrBlock
forall a. [OrdList a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#concatOL"><span class="hs-identifier hs-var">concatOL</span></a></span><span> </span><span class="annot"><span class="annottext">[InstrBlock]
</span><a href="#local-6989586621682857971"><span class="hs-identifier hs-var">push_codes</span></a></span><span>
</span><span id="line-3390"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-3391"></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[InstrBlock] -&gt; InstrBlock
forall a. [OrdList a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#concatOL"><span class="hs-identifier hs-var">concatOL</span></a></span><span> </span><span class="annot"><span class="annottext">[InstrBlock]
</span><a href="#local-6989586621682857971"><span class="hs-identifier hs-var">push_codes</span></a></span><span>
</span><span id="line-3392"></span><span>
</span><span id="line-3393"></span><span>            </span><span id="local-6989586621682857980"><span class="annot"><a href="#local-6989586621682857980"><span class="hs-identifier hs-var hs-var">call</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682857973"><span class="hs-identifier hs-var">callinsns</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-3394"></span><span>                   </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-3395"></span><span>                      </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857969"><span class="hs-identifier hs-var">tot_arg_size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-3396"></span><span>                       </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857969"><span class="hs-identifier hs-var">tot_arg_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3397"></span><span>                      </span><span class="annot"><span class="annottext">[Instr] -&gt; [Instr] -&gt; [Instr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-3398"></span><span>                      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857970"><span class="hs-identifier hs-var">delta0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3399"></span><span>                   </span><span class="hs-special">)</span><span>
</span><span id="line-3400"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857970"><span class="hs-identifier hs-type">delta0</span></a></span><span>
</span><span id="line-3401"></span><span>
</span><span id="line-3402"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-3403"></span><span>            </span><span class="hs-comment">-- assign the results, if necessary</span><span>
</span><span id="line-3404"></span><span>            </span><span id="local-6989586621682857981"><span class="annot"><a href="#local-6989586621682857981"><span class="hs-identifier hs-var hs-var">assign_code</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-3405"></span><span>            </span><span class="annot"><a href="#local-6989586621682857981"><span class="hs-identifier hs-var">assign_code</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682857982"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857982"><span class="hs-identifier hs-var">dest</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-3406"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isVecType"><span class="hs-identifier hs-var">isVecType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857983"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-3407"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; NCGConfig -&gt; Format -&gt; Reg -&gt; Reg -&gt; Instr
NCGConfig -&gt; Format -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#mkRegRegMoveInstr"><span class="hs-identifier hs-var">mkRegRegMoveInstr</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682857918"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857983"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#xmm0"><span class="hs-identifier hs-var">xmm0</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857985"><span class="hs-identifier hs-var">r_dest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3408"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-var">isFloatType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857983"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3409"></span><span>                  </span><span class="hs-comment">-- we assume SSE2</span><span>
</span><span id="line-3410"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682857986"><span class="annot"><span class="annottext">tmp_amode :: AddrMode
</span><a href="#local-6989586621682857986"><span class="hs-identifier hs-var hs-var">tmp_amode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3411"></span><span>                                                       </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span>
</span><span id="line-3412"></span><span>                                                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-3413"></span><span>                      </span><span id="local-6989586621682857987"><span class="annot"><span class="annottext">fmt :: Format
</span><a href="#local-6989586621682857987"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857988"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-3414"></span><span>                         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857989"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3415"></span><span>                                   </span><span class="annot"><span class="annottext">Int -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857970"><span class="hs-identifier hs-var">delta0</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857989"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3416"></span><span>                                   </span><span class="annot"><span class="annottext">Format -&gt; AddrMode -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#X87Store"><span class="hs-identifier hs-var">X87Store</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857987"><span class="hs-identifier hs-var">fmt</span></a></span><span>  </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682857986"><span class="hs-identifier hs-var">tmp_amode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3417"></span><span>                                   </span><span class="hs-comment">-- X87Store only supported for the CDECL ABI</span><span>
</span><span id="line-3418"></span><span>                                   </span><span class="hs-comment">-- NB: This code will need to be</span><span>
</span><span id="line-3419"></span><span>                                   </span><span class="hs-comment">-- revisited once GHC does more work around</span><span>
</span><span id="line-3420"></span><span>                                   </span><span class="hs-comment">-- SIGFPE f</span><span>
</span><span id="line-3421"></span><span>                                   </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682857987"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682857986"><span class="hs-identifier hs-var">tmp_amode</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857985"><span class="hs-identifier hs-var">r_dest</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3422"></span><span>                                   </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857989"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3423"></span><span>                                   </span><span class="annot"><span class="annottext">Int -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682857970"><span class="hs-identifier hs-var">delta0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3424"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-var">isWord64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857983"><span class="hs-identifier hs-var">ty</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857985"><span class="hs-identifier hs-var">r_dest</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3425"></span><span>                                        </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857991"><span class="hs-identifier hs-var">r_dest_hi</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-3426"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857988"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3427"></span><span>                                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3428"></span><span>                                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857985"><span class="hs-identifier hs-var">r_dest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3429"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-3430"></span><span>                    </span><span id="local-6989586621682857983"><span class="annot"><span class="annottext">ty :: CmmType
</span><a href="#local-6989586621682857983"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#localRegType"><span class="hs-identifier hs-var">localRegType</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857982"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-3431"></span><span>                    </span><span id="local-6989586621682857988"><span class="annot"><span class="annottext">w :: Width
</span><a href="#local-6989586621682857988"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682857983"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-3432"></span><span>                    </span><span id="local-6989586621682857989"><span class="annot"><span class="annottext">b :: Int
</span><a href="#local-6989586621682857989"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBytes"><span class="hs-identifier hs-var">widthInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682857988"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-3433"></span><span>                    </span><span id="local-6989586621682857991"><span class="annot"><span class="annottext">r_dest_hi :: Reg
</span><a href="#local-6989586621682857991"><span class="hs-identifier hs-var hs-var">r_dest_hi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg
</span><a href="GHC.Platform.Reg.html#getHiVRegFromLo"><span class="hs-identifier hs-var">getHiVRegFromLo</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682857985"><span class="hs-identifier hs-var">r_dest</span></a></span><span>
</span><span id="line-3434"></span><span>                    </span><span id="local-6989586621682857985"><span class="annot"><span class="annottext">r_dest :: Reg
</span><a href="#local-6989586621682857985"><span class="hs-identifier hs-var hs-var">r_dest</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682857982"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-3435"></span><span>            </span><span class="annot"><a href="#local-6989586621682857981"><span class="hs-identifier hs-var">assign_code</span></a></span><span> </span><span id="local-6989586621682857994"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682857994"><span class="hs-identifier hs-var">many</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; InstrBlock
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genForeignCall.assign_code - too many return values:&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LocalReg] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682857994"><span class="hs-identifier hs-var">many</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3436"></span><span>
</span><span id="line-3437"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682857979"><span class="hs-identifier hs-type">push_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3438"></span><span>                </span><span class="annot"><a href="#local-6989586621682857980"><span class="hs-identifier hs-type">call</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3439"></span><span>                </span><span class="annot"><a href="#local-6989586621682857981"><span class="hs-identifier hs-type">assign_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857916"><span class="hs-identifier hs-type">dest_regs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3440"></span><span>
</span><span id="line-3441"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall64"><span class="hs-identifier hs-type">genCCall64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ address of function to call</span></span><span>
</span><span id="line-3442"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-type">ForeignConvention</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ calling convention</span></span><span>
</span><span id="line-3443"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span>       </span><span class="annot"><span class="hs-comment">-- ^ where to put the result</span></span><span>
</span><span id="line-3444"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span>       </span><span class="annot"><span class="hs-comment">-- ^ arguments (of mixed type)</span></span><span>
</span><span id="line-3445"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-3446"></span><span id="genCCall64"><span class="annot"><span class="annottext">genCCall64 :: CmmExpr
-&gt; ForeignConvention -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCCall64"><span class="hs-identifier hs-var hs-var">genCCall64</span></a></span></span><span> </span><span id="local-6989586621682857995"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857995"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682857996"><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682857996"><span class="hs-identifier hs-var">conv</span></a></span></span><span> </span><span id="local-6989586621682857997"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682857997"><span class="hs-identifier hs-var">dest_regs</span></a></span></span><span> </span><span id="local-6989586621682857998"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682857998"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3447"></span><span>    </span><span id="local-6989586621682857999"><span class="annot"><a href="#local-6989586621682857999"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-3448"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858000"><span class="annot"><a href="#local-6989586621682858000"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682857999"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-3449"></span><span>        </span><span id="local-6989586621682858001"><span class="annot"><a href="#local-6989586621682858001"><span class="hs-identifier hs-var hs-var">word_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Int
</span><a href="GHC.Platform.html#platformWordSizeInBytes"><span class="hs-identifier hs-var">platformWordSizeInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858000"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-3450"></span><span>        </span><span id="local-6989586621682858002"><span class="annot"><a href="#local-6989586621682858002"><span class="hs-identifier hs-var hs-var">wordFmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Format
</span><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-var">archWordFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Bool
</span><a href="GHC.Platform.html#target32Bit"><span class="hs-identifier hs-var">target32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858000"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3451"></span><span>
</span><span id="line-3452"></span><span>    </span><span class="hs-comment">-- Compute the code for loading arguments into registers,</span><span>
</span><span id="line-3453"></span><span>    </span><span class="hs-comment">-- returning the leftover arguments that will need to be passed on the stack.</span><span>
</span><span id="line-3454"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-3455"></span><span>    </span><span class="hs-comment">-- NB: the code for loading references to data into registers is computed</span><span>
</span><span id="line-3456"></span><span>    </span><span class="hs-comment">-- later (in 'pushArgs'), because we don't yet know where the data will be</span><span>
</span><span id="line-3457"></span><span>    </span><span class="hs-comment">-- placed (due to alignment requirements).</span><span>
</span><span id="line-3458"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-type">LoadArgs</span></a></span><span>
</span><span id="line-3459"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stackArgs"><span class="hs-identifier hs-var">stackArgs</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682858005"><span class="annot"><a href="#local-6989586621682858005"><span class="hs-identifier hs-var">proper_stack_args</span></a></span></span><span>
</span><span id="line-3460"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stackDataArgs"><span class="hs-identifier hs-var">stackDataArgs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682858007"><span class="annot"><a href="#local-6989586621682858007"><span class="hs-identifier hs-var">stack_data_args</span></a></span></span><span>
</span><span id="line-3461"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#usedRegs"><span class="hs-identifier hs-var">usedRegs</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682858009"><span class="annot"><a href="#local-6989586621682858009"><span class="hs-identifier hs-var">arg_regs_used</span></a></span></span><span>
</span><span id="line-3462"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignArgsCode"><span class="hs-identifier hs-var">assignArgsCode</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682858011"><span class="annot"><a href="#local-6989586621682858011"><span class="hs-identifier hs-var">assign_args_code</span></a></span></span><span>
</span><span id="line-3463"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-3464"></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadArgs"><span class="hs-identifier hs-type">loadArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857999"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857998"><span class="hs-identifier hs-type">args</span></a></span><span>
</span><span id="line-3465"></span><span>
</span><span id="line-3466"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-3467"></span><span>
</span><span id="line-3468"></span><span>    </span><span class="hs-comment">-- Pad all arguments and data passed on stack to align them properly.</span><span>
</span><span id="line-3469"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682858013"><span class="annot"><a href="#local-6989586621682858013"><span class="hs-identifier hs-var">stk_args_with_padding</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858014"><span class="annot"><a href="#local-6989586621682858014"><span class="hs-identifier hs-var">args_aligned_16</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3470"></span><span>          </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#padStackArgs"><span class="hs-identifier hs-type">padStackArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858000"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858005"><span class="hs-identifier hs-type">proper_stack_args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682858007"><span class="hs-identifier hs-type">stack_data_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3471"></span><span>
</span><span id="line-3472"></span><span>    </span><span class="hs-comment">-- Align stack to 16n for calls, assuming a starting stack</span><span>
</span><span id="line-3473"></span><span>    </span><span class="hs-comment">-- alignment of 16n - word_size on procedure entry. Which we</span><span>
</span><span id="line-3474"></span><span>    </span><span class="hs-comment">-- maintain. See Note [Stack Alignment on X86] in rts/StgCRun.c</span><span>
</span><span id="line-3475"></span><span>        </span><span id="local-6989586621682858016"><span class="annot"><a href="#local-6989586621682858016"><span class="hs-identifier hs-var hs-var">need_realign_call</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858014"><span class="hs-identifier hs-var">args_aligned_16</span></a></span><span>
</span><span id="line-3476"></span><span>    </span><span id="local-6989586621682858017"><span class="annot"><a href="#local-6989586621682858017"><span class="hs-identifier hs-var">align_call_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-3477"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682858016"><span class="hs-identifier hs-type">need_realign_call</span></a></span><span>
</span><span id="line-3478"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#addStackPadding"><span class="hs-identifier hs-type">addStackPadding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858001"><span class="hs-identifier hs-type">word_size</span></a></span><span>
</span><span id="line-3479"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span>
</span><span id="line-3480"></span><span>
</span><span id="line-3481"></span><span>    </span><span class="hs-comment">-- Compute the code that pushes data to the stack, and also</span><span>
</span><span id="line-3482"></span><span>    </span><span class="hs-comment">-- the code that loads references to that data into registers,</span><span>
</span><span id="line-3483"></span><span>    </span><span class="hs-comment">-- when the data is passed by reference in a register.</span><span>
</span><span id="line-3484"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682858019"><span class="annot"><a href="#local-6989586621682858019"><span class="hs-identifier hs-var">load_data_refs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858020"><span class="annot"><a href="#local-6989586621682858020"><span class="hs-identifier hs-var">push_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-3485"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#pushArgs"><span class="hs-identifier hs-type">pushArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857999"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858005"><span class="hs-identifier hs-type">proper_stack_args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858013"><span class="hs-identifier hs-type">stk_args_with_padding</span></a></span><span>
</span><span id="line-3486"></span><span>
</span><span id="line-3487"></span><span>    </span><span class="hs-comment">-- On Windows, leave stack space for the arguments that we are passing</span><span>
</span><span id="line-3488"></span><span>    </span><span class="hs-comment">-- in registers (the so-called shadow space).</span><span>
</span><span id="line-3489"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858022"><span class="annot"><a href="#local-6989586621682858022"><span class="hs-identifier hs-var hs-var">shadow_space</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3490"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858000"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">OS -&gt; OS -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OS
</span><span class="hs-identifier hs-var">OSMinGW32</span></span><span>
</span><span id="line-3491"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">[(Reg, Reg)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; [(Reg, Reg)]
</span><a href="GHC.CmmToAsm.X86.Regs.html#allArgRegs"><span class="hs-identifier hs-var">allArgRegs</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858000"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3492"></span><span>            </span><span class="hs-comment">-- NB: the shadow store is always 8 * 4 = 32 bytes large,</span><span>
</span><span id="line-3493"></span><span>            </span><span class="hs-comment">-- i.e. the cumulative size of rcx, rdx, r8, r9 (see 'allArgRegs').</span><span>
</span><span id="line-3494"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-3495"></span><span>    </span><span id="local-6989586621682858025"><span class="annot"><a href="#local-6989586621682858025"><span class="hs-identifier hs-var">shadow_space_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#addStackPadding"><span class="hs-identifier hs-type">addStackPadding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858022"><span class="hs-identifier hs-type">shadow_space</span></a></span><span>
</span><span id="line-3496"></span><span>
</span><span id="line-3497"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858026"><span class="annot"><a href="#local-6989586621682858026"><span class="hs-identifier hs-var hs-var">total_args_size</span></a></span></span><span>
</span><span id="line-3498"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858022"><span class="hs-identifier hs-var">shadow_space</span></a></span><span>
</span><span id="line-3499"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StackArg -&gt; Int) -&gt; [StackArg] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; StackArg -&gt; Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackArgSpace"><span class="hs-identifier hs-var">stackArgSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858000"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StackArg]
</span><a href="#local-6989586621682858013"><span class="hs-identifier hs-var">stk_args_with_padding</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3500"></span><span>        </span><span id="local-6989586621682858028"><span class="annot"><a href="#local-6989586621682858028"><span class="hs-identifier hs-var hs-var">real_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3501"></span><span>          </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858026"><span class="hs-identifier hs-var">total_args_size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858016"><span class="hs-identifier hs-var">need_realign_call</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858001"><span class="hs-identifier hs-var">word_size</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-3502"></span><span>
</span><span id="line-3503"></span><span>    </span><span class="hs-comment">-- End of argument passing.</span><span>
</span><span id="line-3504"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-3505"></span><span>    </span><span class="hs-comment">-- Next step: emit the appropriate call instruction.</span><span>
</span><span id="line-3506"></span><span>    </span><span id="local-6989586621682858029"><span class="annot"><a href="#local-6989586621682858029"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-3507"></span><span>
</span><span id="line-3508"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- The System V AMD64 ABI requires us to set %al to the number of SSE2</span><span>
</span><span id="line-3509"></span><span>        </span><span class="hs-comment">-- registers that contain arguments, if the called routine</span><span>
</span><span id="line-3510"></span><span>        </span><span class="hs-comment">-- is a varargs function.  We don't know whether it's a</span><span>
</span><span id="line-3511"></span><span>        </span><span class="hs-comment">-- varargs function or not, so we have to assume it is.</span><span>
</span><span id="line-3512"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-3513"></span><span>        </span><span class="hs-comment">-- It's not safe to omit this assignment, even if the number</span><span>
</span><span id="line-3514"></span><span>        </span><span class="hs-comment">-- of SSE2 regs in use is zero.  If %al is larger than 8</span><span>
</span><span id="line-3515"></span><span>        </span><span class="hs-comment">-- on entry to a varargs function, seg faults ensue.</span><span>
</span><span id="line-3516"></span><span>        </span><span id="local-6989586621682858030"><span class="annot"><a href="#local-6989586621682858030"><span class="hs-identifier hs-var hs-var">nb_sse_regs_used</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RegWithFormat -&gt; Bool) -&gt; [RegWithFormat] -&gt; Int
forall a. (a -&gt; Bool) -&gt; [a] -&gt; Int
</span><a href="GHC.Utils.Misc.html#count"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Bool
</span><a href="GHC.CmmToAsm.Format.html#isFloatFormat"><span class="hs-identifier hs-var">isFloatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(Format -&gt; Bool)
-&gt; (RegWithFormat -&gt; Format) -&gt; RegWithFormat -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RegWithFormat -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#regWithFormat_format"><span class="hs-identifier hs-var">regWithFormat_format</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RegWithFormat]
</span><a href="#local-6989586621682858009"><span class="hs-identifier hs-var">arg_regs_used</span></a></span><span>
</span><span id="line-3517"></span><span>        </span><span id="local-6989586621682858034"><span class="annot"><a href="#local-6989586621682858034"><span class="hs-identifier hs-var hs-var">assign_eax_sse_regs</span></a></span></span><span>
</span><span id="line-3518"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858030"><span class="hs-identifier hs-var">nb_sse_regs_used</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3519"></span><span>          </span><span class="hs-comment">-- Note: we do this on Windows as well. It's not entirely clear why</span><span>
</span><span id="line-3520"></span><span>          </span><span class="hs-comment">-- it's needed (the Windows X86_64 calling convention does not</span><span>
</span><span id="line-3521"></span><span>          </span><span class="hs-comment">-- dictate it), but we get segfaults without it.</span><span>
</span><span id="line-3522"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-3523"></span><span>          </span><span class="hs-comment">-- One test case exhibiting the issue is T20030_test1j;</span><span>
</span><span id="line-3524"></span><span>          </span><span class="hs-comment">-- if you change this, make sure to run it in a loop for a while</span><span>
</span><span id="line-3525"></span><span>          </span><span class="hs-comment">-- with at least -j8 to check.</span><span>
</span><span id="line-3526"></span><span>
</span><span id="line-3527"></span><span>        </span><span class="hs-comment">-- Live registers we are annotating the call instruction with</span><span>
</span><span id="line-3528"></span><span>        </span><span id="local-6989586621682858035"><span class="annot"><a href="#local-6989586621682858035"><span class="hs-identifier hs-var hs-var">arg_regs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Reg -&gt; Format -&gt; RegWithFormat
</span><a href="GHC.CmmToAsm.Format.html#RegWithFormat"><span class="hs-identifier hs-var">RegWithFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858002"><span class="hs-identifier hs-var">wordFmt</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[RegWithFormat] -&gt; [RegWithFormat] -&gt; [RegWithFormat]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[RegWithFormat]
</span><a href="#local-6989586621682858009"><span class="hs-identifier hs-var">arg_regs_used</span></a></span><span>
</span><span id="line-3529"></span><span>
</span><span id="line-3530"></span><span>    </span><span class="hs-comment">-- deal with static vs dynamic call targets</span><span>
</span><span id="line-3531"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682858036"><span class="annot"><a href="#local-6989586621682858036"><span class="hs-identifier hs-var">callinsns</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682858037"><span class="annot"><a href="#local-6989586621682858037"><span class="hs-identifier hs-var">_cconv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682857995"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3532"></span><span>      </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-type">CmmLabel</span></a></span><span> </span><span id="local-6989586621682858038"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858038"><span class="hs-identifier hs-var">lbl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3533"></span><span>        </span><span class="annot"><span class="annottext">(InstrBlock, ForeignConvention)
-&gt; NatM (InstrBlock, ForeignConvention)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either Imm Reg -&gt; [RegWithFormat] -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CALL"><span class="hs-identifier hs-var">CALL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Either Imm Reg
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmCLbl"><span class="hs-identifier hs-var">ImmCLbl</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858038"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RegWithFormat]
</span><a href="#local-6989586621682858035"><span class="hs-identifier hs-var">arg_regs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682857996"><span class="hs-identifier hs-var">conv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3534"></span><span>      </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3535"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682858039"><span class="annot"><a href="#local-6989586621682858039"><span class="hs-identifier hs-var">dyn_r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858040"><span class="annot"><a href="#local-6989586621682858040"><span class="hs-identifier hs-var">dyn_c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682857995"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-3536"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858040"><span class="hs-identifier hs-type">dyn_c</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CALL"><span class="hs-identifier hs-type">CALL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><a href="#local-6989586621682858039"><span class="hs-identifier hs-type">dyn_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682858035"><span class="hs-identifier hs-type">arg_regs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682857996"><span class="hs-identifier hs-type">conv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3537"></span><span>
</span><span id="line-3538"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858041"><span class="annot"><a href="#local-6989586621682858041"><span class="hs-identifier hs-var hs-var">call</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858036"><span class="hs-identifier hs-var">callinsns</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-3539"></span><span>               </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-3540"></span><span>                    </span><span class="hs-comment">-- Deallocate parameters after call for ccall</span><span>
</span><span id="line-3541"></span><span>                  </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858028"><span class="hs-identifier hs-var">real_size</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-3542"></span><span>                   </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Width
</span><a href="GHC.CmmToAsm.Config.html#platformWordWidth"><span class="hs-identifier hs-var">platformWordWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858000"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858028"><span class="hs-identifier hs-var">real_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3543"></span><span>                  </span><span class="annot"><span class="annottext">[Instr] -&gt; [Instr] -&gt; [Instr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-3544"></span><span>                  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858029"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858028"><span class="hs-identifier hs-var">real_size</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-3545"></span><span>               </span><span class="hs-special">)</span><span>
</span><span id="line-3546"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858029"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682858028"><span class="hs-identifier hs-type">real_size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3547"></span><span>
</span><span id="line-3548"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-3549"></span><span>        </span><span class="hs-comment">-- assign the results, if necessary</span><span>
</span><span id="line-3550"></span><span>        </span><span id="local-6989586621682858043"><span class="annot"><a href="#local-6989586621682858043"><span class="hs-identifier hs-var hs-var">assign_code</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-3551"></span><span>        </span><span class="annot"><a href="#local-6989586621682858043"><span class="hs-identifier hs-var">assign_code</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682858044"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858044"><span class="hs-identifier hs-var">dest</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3552"></span><span>          </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; InstrBlock) -&gt; Instr -&gt; InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-3553"></span><span>            </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; NCGConfig -&gt; Format -&gt; Reg -&gt; Reg -&gt; Instr
NCGConfig -&gt; Format -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#mkRegRegMoveInstr"><span class="hs-identifier hs-var">mkRegRegMoveInstr</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682857999"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858045"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858046"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858047"><span class="hs-identifier hs-var">r_dest</span></a></span><span>
</span><span id="line-3554"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-3555"></span><span>            </span><span id="local-6989586621682858046"><span class="annot"><span class="annottext">reg :: Reg
</span><a href="#local-6989586621682858046"><span class="hs-identifier hs-var hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Bool
</span><a href="GHC.CmmToAsm.Format.html#isIntFormat"><span class="hs-identifier hs-var">isIntFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858045"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rax"><span class="hs-identifier hs-var">rax</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#xmm0"><span class="hs-identifier hs-var">xmm0</span></a></span><span>
</span><span id="line-3556"></span><span>            </span><span id="local-6989586621682858045"><span class="annot"><span class="annottext">fmt :: Format
</span><a href="#local-6989586621682858045"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682858049"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-3557"></span><span>            </span><span id="local-6989586621682858049"><span class="annot"><span class="annottext">rep :: CmmType
</span><a href="#local-6989586621682858049"><span class="hs-identifier hs-var hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#localRegType"><span class="hs-identifier hs-var">localRegType</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858044"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-3558"></span><span>            </span><span id="local-6989586621682858047"><span class="annot"><span class="annottext">r_dest :: Reg
</span><a href="#local-6989586621682858047"><span class="hs-identifier hs-var hs-var">r_dest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858000"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalReg -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858044"><span class="hs-identifier hs-var">dest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3559"></span><span>        </span><span class="annot"><a href="#local-6989586621682858043"><span class="hs-identifier hs-var">assign_code</span></a></span><span> </span><span id="local-6989586621682858050"><span class="annot"><span class="annottext">[LocalReg]
</span><a href="#local-6989586621682858050"><span class="hs-identifier hs-var">_many</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; InstrBlock
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genForeignCall.assign_code many&quot;</span></span><span>
</span><span id="line-3560"></span><span>
</span><span id="line-3561"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858017"><span class="hs-identifier hs-type">align_call_code</span></a></span><span>     </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3562"></span><span>            </span><span class="annot"><a href="#local-6989586621682858020"><span class="hs-identifier hs-type">push_code</span></a></span><span>           </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3563"></span><span>            </span><span class="annot"><a href="#local-6989586621682858011"><span class="hs-identifier hs-type">assign_args_code</span></a></span><span>    </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3564"></span><span>            </span><span class="annot"><a href="#local-6989586621682858019"><span class="hs-identifier hs-type">load_data_refs</span></a></span><span>      </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3565"></span><span>            </span><span class="annot"><a href="#local-6989586621682858025"><span class="hs-identifier hs-type">shadow_space_code</span></a></span><span>   </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3566"></span><span>            </span><span class="annot"><a href="#local-6989586621682858034"><span class="hs-identifier hs-type">assign_eax_sse_regs</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3567"></span><span>            </span><span class="annot"><a href="#local-6989586621682858041"><span class="hs-identifier hs-type">call</span></a></span><span>                </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-3568"></span><span>            </span><span class="annot"><a href="#local-6989586621682858043"><span class="hs-identifier hs-type">assign_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682857997"><span class="hs-identifier hs-type">dest_regs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3569"></span><span>
</span><span id="line-3570"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-3571"></span><span class="hs-comment">-- Loading arguments into registers for 64-bit C calls.</span><span>
</span><span id="line-3572"></span><span>
</span><span id="line-3573"></span><span class="hs-comment">-- | Information needed to know how to pass arguments in a C call,</span><span>
</span><span id="line-3574"></span><span class="hs-comment">-- and in particular how to load them into registers.</span><span>
</span><span id="line-3575"></span><span class="hs-keyword">data</span><span> </span><span id="LoadArgs"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-var">LoadArgs</span></a></span></span><span>
</span><span id="line-3576"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="LoadArgs"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-var">LoadArgs</span></a></span></span><span>
</span><span id="line-3577"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Arguments that should be passed on the stack</span></span><span>
</span><span id="line-3578"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="stackArgs"><span class="annot"><span class="annottext">LoadArgs -&gt; [RawStackArg]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackArgs"><span class="hs-identifier hs-var hs-var">stackArgs</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-type">RawStackArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3579"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Additional values to store onto the stack.</span></span><span>
</span><span id="line-3580"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="stackDataArgs"><span class="annot"><span class="annottext">LoadArgs -&gt; [CmmExpr]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackDataArgs"><span class="hs-identifier hs-var hs-var">stackDataArgs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3581"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Which registers are we using for argument passing?</span></span><span>
</span><span id="line-3582"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="usedRegs"><span class="annot"><span class="annottext">LoadArgs -&gt; [RegWithFormat]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#usedRegs"><span class="hs-identifier hs-var hs-var">usedRegs</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#RegWithFormat"><span class="hs-identifier hs-type">RegWithFormat</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3583"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The code to assign arguments to registers used for argument passing.</span></span><span>
</span><span id="line-3584"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="assignArgsCode"><span class="annot"><span class="annottext">LoadArgs -&gt; InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignArgsCode"><span class="hs-identifier hs-var hs-var">assignArgsCode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-3585"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-3586"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682858053"><span id="local-6989586621682858056"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-type">LoadArgs</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3587"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-type">LoadArgs</span></a></span><span> </span><span id="local-6989586621682858063"><span class="annot"><span class="annottext">[RawStackArg]
</span><a href="#local-6989586621682858063"><span class="hs-identifier hs-var">a1</span></a></span></span><span> </span><span id="local-6989586621682858064"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858064"><span class="hs-identifier hs-var">d1</span></a></span></span><span> </span><span id="local-6989586621682858065"><span class="annot"><span class="annottext">[RegWithFormat]
</span><a href="#local-6989586621682858065"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span id="local-6989586621682858066"><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858066"><span class="hs-identifier hs-var">j1</span></a></span></span><span> </span><span id="local-6989586621682858067"><span class="annot"><span class="annottext">&lt;&gt; :: LoadArgs -&gt; LoadArgs -&gt; LoadArgs
</span><span class="hs-operator hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-type">LoadArgs</span></a></span><span> </span><span id="local-6989586621682858068"><span class="annot"><span class="annottext">[RawStackArg]
</span><a href="#local-6989586621682858068"><span class="hs-identifier hs-var">a2</span></a></span></span><span> </span><span id="local-6989586621682858069"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858069"><span class="hs-identifier hs-var">d2</span></a></span></span><span> </span><span id="local-6989586621682858070"><span class="annot"><span class="annottext">[RegWithFormat]
</span><a href="#local-6989586621682858070"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span id="local-6989586621682858071"><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858071"><span class="hs-identifier hs-var">j2</span></a></span></span><span>
</span><span id="line-3588"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RawStackArg]
-&gt; [CmmExpr] -&gt; [RegWithFormat] -&gt; InstrBlock -&gt; LoadArgs
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-var">LoadArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RawStackArg]
</span><a href="#local-6989586621682858063"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">[RawStackArg] -&gt; [RawStackArg] -&gt; [RawStackArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[RawStackArg]
</span><a href="#local-6989586621682858068"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858064"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr] -&gt; [CmmExpr] -&gt; [CmmExpr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858069"><span class="hs-identifier hs-var">d2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RegWithFormat]
</span><a href="#local-6989586621682858065"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">[RegWithFormat] -&gt; [RegWithFormat] -&gt; [RegWithFormat]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[RegWithFormat]
</span><a href="#local-6989586621682858070"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858066"><span class="hs-identifier hs-var">j1</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">S.&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858071"><span class="hs-identifier hs-var">j2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3589"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682858076"><span id="local-6989586621682858079"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-type">LoadArgs</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3590"></span><span>  </span><span id="local-6989586621682858082"><span class="annot"><span class="annottext">mempty :: LoadArgs
</span><span class="hs-identifier hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RawStackArg]
-&gt; [CmmExpr] -&gt; [RegWithFormat] -&gt; InstrBlock -&gt; LoadArgs
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-var">LoadArgs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-3591"></span><span>
</span><span id="line-3592"></span><span class="hs-comment">-- | An argument passed on the stack, either directly or by reference.</span><span>
</span><span id="line-3593"></span><span class="hs-comment">--</span><span>
</span><span id="line-3594"></span><span class="hs-comment">-- The padding information hasn't yet been computed (see 'StackArg').</span><span>
</span><span id="line-3595"></span><span class="hs-keyword">data</span><span> </span><span id="RawStackArg"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-var">RawStackArg</span></a></span></span><span>
</span><span id="line-3596"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Pass the argument on the stack directly.</span></span><span>
</span><span id="line-3597"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="RawStackArg"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-var">RawStackArg</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="stackArgExpr"><span class="annot"><span class="annottext">RawStackArg -&gt; CmmExpr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackArgExpr"><span class="hs-identifier hs-var hs-var">stackArgExpr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-3598"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Pass the argument by reference.</span></span><span>
</span><span id="line-3599"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RawStackArgRef"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArgRef"><span class="hs-identifier hs-var">RawStackArgRef</span></a></span></span><span>
</span><span id="line-3600"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="stackRef"><span class="annot"><span class="annottext">RawStackArg -&gt; StackRef
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackRef"><span class="hs-identifier hs-var hs-var">stackRef</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackRef"><span class="hs-identifier hs-type">StackRef</span></a></span><span>
</span><span id="line-3601"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ is the reference passed in a register, or on the stack?</span></span><span>
</span><span id="line-3602"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stackRefArgSize"><span class="annot"><span class="annottext">RawStackArg -&gt; Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackRefArgSize"><span class="hs-identifier hs-var hs-var">stackRefArgSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-3603"></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ the size of the data pointed to</span></span><span>
</span><span id="line-3604"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-3605"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span> </span><span id="local-6989586621682858090"><span id="local-6989586621682858098"><span id="local-6989586621682858102"><span class="annot"><span class="annottext">Int -&gt; RawStackArg -&gt; String -&gt; String
[RawStackArg] -&gt; String -&gt; String
RawStackArg -&gt; String
(Int -&gt; RawStackArg -&gt; String -&gt; String)
-&gt; (RawStackArg -&gt; String)
-&gt; ([RawStackArg] -&gt; String -&gt; String)
-&gt; Show RawStackArg
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
$cshowsPrec :: Int -&gt; RawStackArg -&gt; String -&gt; String
showsPrec :: Int -&gt; RawStackArg -&gt; String -&gt; String
$cshow :: RawStackArg -&gt; String
show :: RawStackArg -&gt; String
$cshowList :: [RawStackArg] -&gt; String -&gt; String
showList :: [RawStackArg] -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-3606"></span><span>
</span><span id="line-3607"></span><span class="hs-comment">-- | An argument passed on the stack, either directly or by reference,</span><span>
</span><span id="line-3608"></span><span class="hs-comment">-- with additional padding information.</span><span>
</span><span id="line-3609"></span><span class="hs-keyword">data</span><span> </span><span id="StackArg"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArg"><span class="hs-identifier hs-var">StackArg</span></a></span></span><span>
</span><span id="line-3610"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Pass the argument on the stack directly.</span></span><span>
</span><span id="line-3611"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="StackArg"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArg"><span class="hs-identifier hs-var">StackArg</span></a></span></span><span>
</span><span id="line-3612"></span><span>      </span><span class="hs-special">{</span><span> </span><span id="stackArgExpr"><span class="annot"><span class="annottext">StackArg -&gt; CmmExpr
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackArgExpr"><span class="hs-identifier hs-var hs-var">stackArgExpr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-3613"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="stackArgPadding"><span class="annot"><span class="annottext">StackArg -&gt; Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackArgPadding"><span class="hs-identifier hs-var hs-var">stackArgPadding</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-3614"></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ padding required (in bytes)</span></span><span>
</span><span id="line-3615"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-3616"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Pass the argument by reference.</span></span><span>
</span><span id="line-3617"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="StackArgRef"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArgRef"><span class="hs-identifier hs-var">StackArgRef</span></a></span></span><span>
</span><span id="line-3618"></span><span>     </span><span class="hs-special">{</span><span> </span><span id="stackRef"><span class="annot"><span class="annottext">StackArg -&gt; StackRef
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackRef"><span class="hs-identifier hs-var hs-var">stackRef</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackRef"><span class="hs-identifier hs-type">StackRef</span></a></span><span>
</span><span id="line-3619"></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ where the reference is passed</span></span><span>
</span><span id="line-3620"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="stackRefArgSize"><span class="annot"><span class="annottext">StackArg -&gt; Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackRefArgSize"><span class="hs-identifier hs-var hs-var">stackRefArgSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-3621"></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ the size of the data pointed to</span></span><span>
</span><span id="line-3622"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="stackRefArgPadding"><span class="annot"><span class="annottext">StackArg -&gt; Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackRefArgPadding"><span class="hs-identifier hs-var hs-var">stackRefArgPadding</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-3623"></span><span>       </span><span class="hs-comment">-- ^ padding of the data pointed to</span><span>
</span><span id="line-3624"></span><span>       </span><span class="hs-comment">-- (the reference itself never requires padding)</span><span>
</span><span id="line-3625"></span><span>     </span><span class="hs-special">}</span><span>
</span><span id="line-3626"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span> </span><span id="local-6989586621682858113"><span id="local-6989586621682858122"><span id="local-6989586621682858126"><span class="annot"><span class="annottext">Int -&gt; StackArg -&gt; String -&gt; String
[StackArg] -&gt; String -&gt; String
StackArg -&gt; String
(Int -&gt; StackArg -&gt; String -&gt; String)
-&gt; (StackArg -&gt; String)
-&gt; ([StackArg] -&gt; String -&gt; String)
-&gt; Show StackArg
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
$cshowsPrec :: Int -&gt; StackArg -&gt; String -&gt; String
showsPrec :: Int -&gt; StackArg -&gt; String -&gt; String
$cshow :: StackArg -&gt; String
show :: StackArg -&gt; String
$cshowList :: [StackArg] -&gt; String -&gt; String
showList :: [StackArg] -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-3627"></span><span>
</span><span id="line-3628"></span><span class="annot"><span class="hs-comment">-- | Where is a reference to data on the stack passed?</span></span><span>
</span><span id="line-3629"></span><span class="hs-keyword">data</span><span> </span><span id="StackRef"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackRef"><span class="hs-identifier hs-var">StackRef</span></a></span></span><span>
</span><span id="line-3630"></span><span>  </span><span class="annot"><span class="hs-comment">-- | In a register.</span></span><span>
</span><span id="line-3631"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="InReg"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InReg"><span class="hs-identifier hs-var">InReg</span></a></span></span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span>
</span><span id="line-3632"></span><span>  </span><span class="annot"><span class="hs-comment">-- | On the stack.</span></span><span>
</span><span id="line-3633"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="OnStack"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#OnStack"><span class="hs-identifier hs-var">OnStack</span></a></span></span><span>
</span><span id="line-3634"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span> </span><span id="local-6989586621682858131"><span id="local-6989586621682858137"><span class="annot"><span class="annottext">StackRef -&gt; StackRef -&gt; Bool
(StackRef -&gt; StackRef -&gt; Bool)
-&gt; (StackRef -&gt; StackRef -&gt; Bool) -&gt; Eq StackRef
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: StackRef -&gt; StackRef -&gt; Bool
== :: StackRef -&gt; StackRef -&gt; Bool
$c/= :: StackRef -&gt; StackRef -&gt; Bool
/= :: StackRef -&gt; StackRef -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858144"><span id="local-6989586621682858148"><span id="local-6989586621682858151"><span id="local-6989586621682858155"><span id="local-6989586621682858158"><span id="local-6989586621682858161"><span id="local-6989586621682858164"><span class="annot"><span class="annottext">Eq StackRef
Eq StackRef =&gt;
(StackRef -&gt; StackRef -&gt; Ordering)
-&gt; (StackRef -&gt; StackRef -&gt; Bool)
-&gt; (StackRef -&gt; StackRef -&gt; Bool)
-&gt; (StackRef -&gt; StackRef -&gt; Bool)
-&gt; (StackRef -&gt; StackRef -&gt; Bool)
-&gt; (StackRef -&gt; StackRef -&gt; StackRef)
-&gt; (StackRef -&gt; StackRef -&gt; StackRef)
-&gt; Ord StackRef
StackRef -&gt; StackRef -&gt; Bool
StackRef -&gt; StackRef -&gt; Ordering
StackRef -&gt; StackRef -&gt; StackRef
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: StackRef -&gt; StackRef -&gt; Ordering
compare :: StackRef -&gt; StackRef -&gt; Ordering
$c&lt; :: StackRef -&gt; StackRef -&gt; Bool
&lt; :: StackRef -&gt; StackRef -&gt; Bool
$c&lt;= :: StackRef -&gt; StackRef -&gt; Bool
&lt;= :: StackRef -&gt; StackRef -&gt; Bool
$c&gt; :: StackRef -&gt; StackRef -&gt; Bool
&gt; :: StackRef -&gt; StackRef -&gt; Bool
$c&gt;= :: StackRef -&gt; StackRef -&gt; Bool
&gt;= :: StackRef -&gt; StackRef -&gt; Bool
$cmax :: StackRef -&gt; StackRef -&gt; StackRef
max :: StackRef -&gt; StackRef -&gt; StackRef
$cmin :: StackRef -&gt; StackRef -&gt; StackRef
min :: StackRef -&gt; StackRef -&gt; StackRef
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858169"><span id="local-6989586621682858174"><span id="local-6989586621682858177"><span class="annot"><span class="annottext">Int -&gt; StackRef -&gt; String -&gt; String
[StackRef] -&gt; String -&gt; String
StackRef -&gt; String
(Int -&gt; StackRef -&gt; String -&gt; String)
-&gt; (StackRef -&gt; String)
-&gt; ([StackRef] -&gt; String -&gt; String)
-&gt; Show StackRef
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
$cshowsPrec :: Int -&gt; StackRef -&gt; String -&gt; String
showsPrec :: Int -&gt; StackRef -&gt; String -&gt; String
$cshow :: StackRef -&gt; String
show :: StackRef -&gt; String
$cshowList :: [StackRef] -&gt; String -&gt; String
showList :: [StackRef] -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-3635"></span><span>
</span><span id="line-3636"></span><span class="hs-keyword">newtype</span><span> </span><span id="Padding"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Padding"><span class="hs-identifier hs-var">Padding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Padding"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Padding"><span class="hs-identifier hs-var">Padding</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="paddingBytes"><span class="annot"><span class="annottext">Padding -&gt; Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#paddingBytes"><span class="hs-identifier hs-var hs-var">paddingBytes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-3637"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span> </span><span id="local-6989586621682858182"><span id="local-6989586621682858186"><span id="local-6989586621682858190"><span class="annot"><span class="annottext">Int -&gt; Padding -&gt; String -&gt; String
[Padding] -&gt; String -&gt; String
Padding -&gt; String
(Int -&gt; Padding -&gt; String -&gt; String)
-&gt; (Padding -&gt; String)
-&gt; ([Padding] -&gt; String -&gt; String)
-&gt; Show Padding
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
$cshowsPrec :: Int -&gt; Padding -&gt; String -&gt; String
showsPrec :: Int -&gt; Padding -&gt; String -&gt; String
$cshow :: Padding -&gt; String
show :: Padding -&gt; String
$cshowList :: [Padding] -&gt; String -&gt; String
showList :: [Padding] -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858193"><span id="local-6989586621682858197"><span class="annot"><span class="annottext">Padding -&gt; Padding -&gt; Bool
(Padding -&gt; Padding -&gt; Bool)
-&gt; (Padding -&gt; Padding -&gt; Bool) -&gt; Eq Padding
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Padding -&gt; Padding -&gt; Bool
== :: Padding -&gt; Padding -&gt; Bool
$c/= :: Padding -&gt; Padding -&gt; Bool
/= :: Padding -&gt; Padding -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858204"><span id="local-6989586621682858208"><span id="local-6989586621682858212"><span id="local-6989586621682858216"><span id="local-6989586621682858220"><span id="local-6989586621682858224"><span id="local-6989586621682858228"><span class="annot"><span class="annottext">Eq Padding
Eq Padding =&gt;
(Padding -&gt; Padding -&gt; Ordering)
-&gt; (Padding -&gt; Padding -&gt; Bool)
-&gt; (Padding -&gt; Padding -&gt; Bool)
-&gt; (Padding -&gt; Padding -&gt; Bool)
-&gt; (Padding -&gt; Padding -&gt; Bool)
-&gt; (Padding -&gt; Padding -&gt; Padding)
-&gt; (Padding -&gt; Padding -&gt; Padding)
-&gt; Ord Padding
Padding -&gt; Padding -&gt; Bool
Padding -&gt; Padding -&gt; Ordering
Padding -&gt; Padding -&gt; Padding
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Padding -&gt; Padding -&gt; Ordering
compare :: Padding -&gt; Padding -&gt; Ordering
$c&lt; :: Padding -&gt; Padding -&gt; Bool
&lt; :: Padding -&gt; Padding -&gt; Bool
$c&lt;= :: Padding -&gt; Padding -&gt; Bool
&lt;= :: Padding -&gt; Padding -&gt; Bool
$c&gt; :: Padding -&gt; Padding -&gt; Bool
&gt; :: Padding -&gt; Padding -&gt; Bool
$c&gt;= :: Padding -&gt; Padding -&gt; Bool
&gt;= :: Padding -&gt; Padding -&gt; Bool
$cmax :: Padding -&gt; Padding -&gt; Padding
max :: Padding -&gt; Padding -&gt; Padding
$cmin :: Padding -&gt; Padding -&gt; Padding
min :: Padding -&gt; Padding -&gt; Padding
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-3638"></span><span>
</span><span id="line-3639"></span><span class="hs-comment">-- | How much space does this 'StackArg' take up on the stack?</span><span>
</span><span id="line-3640"></span><span class="hs-comment">--</span><span>
</span><span id="line-3641"></span><span class="hs-comment">-- Only counts the &quot;reference&quot; part for references, not the data it points to.</span><span>
</span><span id="line-3642"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stackArgSpace"><span class="hs-identifier hs-type">stackArgSpace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArg"><span class="hs-identifier hs-type">StackArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-3643"></span><span id="stackArgSpace"><span class="annot"><span class="annottext">stackArgSpace :: Platform -&gt; StackArg -&gt; Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackArgSpace"><span class="hs-identifier hs-var hs-var">stackArgSpace</span></a></span></span><span> </span><span id="local-6989586621682858233"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858233"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-3644"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArg"><span class="hs-identifier hs-type">StackArg</span></a></span><span> </span><span id="local-6989586621682858234"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858234"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682858235"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858235"><span class="hs-identifier hs-var">padding</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3645"></span><span>    </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#argSize"><span class="hs-identifier hs-var">argSize</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858233"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858234"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858235"><span class="hs-identifier hs-var">padding</span></a></span><span>
</span><span id="line-3646"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArgRef"><span class="hs-identifier hs-type">StackArgRef</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">stackRef :: StackArg -&gt; StackRef
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackRef"><span class="hs-identifier hs-var">stackRef</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682858237"><span class="annot"><span class="annottext">StackRef
</span><a href="#local-6989586621682858237"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3647"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StackRef
</span><a href="#local-6989586621682858237"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3648"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InReg"><span class="hs-identifier hs-type">InReg</span></a></span><span>   </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-3649"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#OnStack"><span class="hs-identifier hs-type">OnStack</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-3650"></span><span>
</span><span id="line-3651"></span><span class="hs-comment">-- | Pad arguments, assuming we start aligned to a 16-byte boundary.</span><span>
</span><span id="line-3652"></span><span class="hs-comment">--</span><span>
</span><span id="line-3653"></span><span class="hs-comment">-- Returns padded arguments, together with whether we end up aligned</span><span>
</span><span id="line-3654"></span><span class="hs-comment">-- to a 16-byte boundary.</span><span>
</span><span id="line-3655"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#padStackArgs"><span class="hs-identifier hs-type">padStackArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span>
</span><span id="line-3656"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-type">RawStackArg</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3657"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArg"><span class="hs-identifier hs-type">StackArg</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-3658"></span><span id="padStackArgs"><span class="annot"><span class="annottext">padStackArgs :: Platform -&gt; ([RawStackArg], [CmmExpr]) -&gt; ([StackArg], Bool)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#padStackArgs"><span class="hs-identifier hs-var hs-var">padStackArgs</span></a></span></span><span> </span><span id="local-6989586621682858238"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858238"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682858239"><span class="annot"><span class="annottext">[RawStackArg]
</span><a href="#local-6989586621682858239"><span class="hs-identifier hs-var">args0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858240"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858240"><span class="hs-identifier hs-var">data_args0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3659"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-3660"></span><span>    </span><span class="hs-comment">-- Pad the direct args</span><span>
</span><span id="line-3661"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682858241"><span class="annot"><span class="annottext">[(RawStackArg, Padding)]
</span><a href="#local-6989586621682858241"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858242"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858242"><span class="hs-identifier hs-var">align_16_mid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [RawStackArg] -&gt; ([(RawStackArg, Padding)], Bool)
</span><a href="#local-6989586621682858243"><span class="hs-identifier hs-var">pad_args</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">[RawStackArg]
</span><a href="#local-6989586621682858239"><span class="hs-identifier hs-var">args0</span></a></span><span>
</span><span id="line-3662"></span><span>
</span><span id="line-3663"></span><span>    </span><span class="hs-comment">-- Pad the data section</span><span>
</span><span id="line-3664"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682858244"><span class="annot"><span class="annottext">[(RawStackArg, Padding)]
</span><a href="#local-6989586621682858244"><span class="hs-identifier hs-var">data_args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858245"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858245"><span class="hs-identifier hs-var">align_16_end</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [RawStackArg] -&gt; ([(RawStackArg, Padding)], Bool)
</span><a href="#local-6989586621682858243"><span class="hs-identifier hs-var">pad_args</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858242"><span class="hs-identifier hs-var">align_16_mid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CmmExpr -&gt; RawStackArg) -&gt; [CmmExpr] -&gt; [RawStackArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; RawStackArg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-var">RawStackArg</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858240"><span class="hs-identifier hs-var">data_args0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3665"></span><span>
</span><span id="line-3666"></span><span>    </span><span class="hs-comment">-- Now figure out where the data is placed relative to the direct arguments,</span><span>
</span><span id="line-3667"></span><span>    </span><span class="hs-comment">-- in order to resolve references.</span><span>
</span><span id="line-3668"></span><span>    </span><span class="annot"><a href="#local-6989586621682858246"><span class="hs-identifier hs-type">resolve_args</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-type">RawStackArg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Padding"><span class="hs-identifier hs-type">Padding</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Padding"><span class="hs-identifier hs-type">Padding</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArg"><span class="hs-identifier hs-type">StackArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3669"></span><span>    </span><span id="local-6989586621682858246"><span class="annot"><span class="annottext">resolve_args :: [(RawStackArg, Padding)] -&gt; [Padding] -&gt; [StackArg]
</span><a href="#local-6989586621682858246"><span class="hs-identifier hs-var hs-var">resolve_args</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Padding]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-3670"></span><span>    </span><span class="annot"><a href="#local-6989586621682858246"><span class="hs-identifier hs-var">resolve_args</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682858247"><span class="annot"><span class="annottext">RawStackArg
</span><a href="#local-6989586621682858247"><span class="hs-identifier hs-var">stk_arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Padding"><span class="hs-identifier hs-type">Padding</span></a></span><span> </span><span id="local-6989586621682858248"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858248"><span class="hs-identifier hs-var">pad</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682858249"><span class="annot"><span class="annottext">[(RawStackArg, Padding)]
</span><a href="#local-6989586621682858249"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682858250"><span class="annot"><span class="annottext">[Padding]
</span><a href="#local-6989586621682858250"><span class="hs-identifier hs-var">pads</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3671"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682858251"><span class="annot"><span class="annottext">StackArg
</span><a href="#local-6989586621682858251"><span class="hs-identifier hs-var">this_arg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858252"><span class="annot"><span class="annottext">[Padding]
</span><a href="#local-6989586621682858252"><span class="hs-identifier hs-var">pads'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3672"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RawStackArg
</span><a href="#local-6989586621682858247"><span class="hs-identifier hs-var">stk_arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3673"></span><span>              </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-type">RawStackArg</span></a></span><span> </span><span id="local-6989586621682858253"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858253"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; Int -&gt; StackArg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArg"><span class="hs-identifier hs-var">StackArg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858253"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858248"><span class="hs-identifier hs-var">pad</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Padding]
</span><a href="#local-6989586621682858250"><span class="hs-identifier hs-var">pads</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3674"></span><span>              </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArgRef"><span class="hs-identifier hs-type">RawStackArgRef</span></a></span><span> </span><span id="local-6989586621682858254"><span class="annot"><span class="annottext">StackRef
</span><a href="#local-6989586621682858254"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span id="local-6989586621682858255"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858255"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3675"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Padding"><span class="hs-identifier hs-type">Padding</span></a></span><span> </span><span id="local-6989586621682858256"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858256"><span class="hs-identifier hs-var">arg_pad</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682858257"><span class="annot"><span class="annottext">[Padding]
</span><a href="#local-6989586621682858257"><span class="hs-identifier hs-var">rest_pads</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Padding]
</span><a href="#local-6989586621682858250"><span class="hs-identifier hs-var">pads</span></a></span><span>
</span><span id="line-3676"></span><span>                    </span><span id="local-6989586621682858258"><span class="annot"><span class="annottext">arg :: StackArg
</span><a href="#local-6989586621682858258"><span class="hs-identifier hs-var hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3677"></span><span>                      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArgRef"><span class="hs-identifier hs-type">StackArgRef</span></a></span><span>
</span><span id="line-3678"></span><span>                        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">stackRef :: StackRef
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackRef"><span class="hs-identifier hs-var">stackRef</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StackRef
</span><a href="#local-6989586621682858254"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-3679"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stackRefArgSize :: Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackRefArgSize"><span class="hs-identifier hs-var">stackRefArgSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858255"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-3680"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stackRefArgPadding :: Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackRefArgPadding"><span class="hs-identifier hs-var">stackRefArgPadding</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858256"><span class="hs-identifier hs-var">arg_pad</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-3681"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StackArg
</span><a href="#local-6989586621682858258"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Padding]
</span><a href="#local-6989586621682858257"><span class="hs-identifier hs-var">rest_pads</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3682"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">StackArg
</span><a href="#local-6989586621682858251"><span class="hs-identifier hs-var">this_arg</span></a></span><span> </span><span class="annot"><span class="annottext">StackArg -&gt; [StackArg] -&gt; [StackArg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(RawStackArg, Padding)] -&gt; [Padding] -&gt; [StackArg]
</span><a href="#local-6989586621682858246"><span class="hs-identifier hs-var">resolve_args</span></a></span><span> </span><span class="annot"><span class="annottext">[(RawStackArg, Padding)]
</span><a href="#local-6989586621682858249"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">[Padding]
</span><a href="#local-6989586621682858252"><span class="hs-identifier hs-var">pads'</span></a></span><span>
</span><span id="line-3683"></span><span>
</span><span id="line-3684"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-3685"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[(RawStackArg, Padding)] -&gt; [Padding] -&gt; [StackArg]
</span><a href="#local-6989586621682858246"><span class="hs-identifier hs-var">resolve_args</span></a></span><span> </span><span class="annot"><span class="annottext">[(RawStackArg, Padding)]
</span><a href="#local-6989586621682858241"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((RawStackArg, Padding) -&gt; Padding)
-&gt; [(RawStackArg, Padding)] -&gt; [Padding]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(RawStackArg, Padding) -&gt; Padding
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(RawStackArg, Padding)]
</span><a href="#local-6989586621682858244"><span class="hs-identifier hs-var">data_args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StackArg] -&gt; [StackArg] -&gt; [StackArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-3686"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RawStackArg
</span><a href="#local-6989586621682858259"><span class="hs-identifier hs-var">data_arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3687"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-type">RawStackArg</span></a></span><span> </span><span id="local-6989586621682858260"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858260"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Int -&gt; StackArg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArg"><span class="hs-identifier hs-var">StackArg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858260"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858261"><span class="hs-identifier hs-var">pad</span></a></span><span>
</span><span id="line-3688"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArgRef"><span class="hs-identifier hs-type">RawStackArgRef</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; StackArg
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;padStackArgs: reference in data section&quot;</span></span><span>
</span><span id="line-3689"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682858259"><span class="annot"><span class="annottext">RawStackArg
</span><a href="#local-6989586621682858259"><span class="hs-identifier hs-var">data_arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Padding"><span class="hs-identifier hs-type">Padding</span></a></span><span> </span><span id="local-6989586621682858261"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858261"><span class="hs-identifier hs-var">pad</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(RawStackArg, Padding)]
</span><a href="#local-6989586621682858244"><span class="hs-identifier hs-var">data_args</span></a></span><span>
</span><span id="line-3690"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-3691"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858245"><span class="hs-identifier hs-var">align_16_end</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-3692"></span><span>
</span><span id="line-3693"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3694"></span><span>    </span><span class="annot"><a href="#local-6989586621682858243"><span class="hs-identifier hs-type">pad_args</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-type">RawStackArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-type">RawStackArg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Padding"><span class="hs-identifier hs-type">Padding</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-3695"></span><span>    </span><span id="local-6989586621682858243"><span class="annot"><span class="annottext">pad_args :: Bool -&gt; [RawStackArg] -&gt; ([(RawStackArg, Padding)], Bool)
</span><a href="#local-6989586621682858243"><span class="hs-identifier hs-var hs-var">pad_args</span></a></span></span><span> </span><span id="local-6989586621682858262"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858262"><span class="hs-identifier hs-var">aligned_16</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858262"><span class="hs-identifier hs-var">aligned_16</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3696"></span><span>    </span><span class="annot"><a href="#local-6989586621682858243"><span class="hs-identifier hs-var">pad_args</span></a></span><span> </span><span id="local-6989586621682858263"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858263"><span class="hs-identifier hs-var">aligned_16</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682858264"><span class="annot"><span class="annottext">RawStackArg
</span><a href="#local-6989586621682858264"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682858265"><span class="annot"><span class="annottext">[RawStackArg]
</span><a href="#local-6989586621682858265"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3697"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858266"><span class="hs-identifier hs-var">needed_alignment</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span>
</span><span id="line-3698"></span><span>      </span><span class="hs-comment">-- We don't know if the stack is aligned to 8 (mod 32) or 24 (mod 32).</span><span>
</span><span id="line-3699"></span><span>      </span><span class="hs-comment">-- This makes aligning the stack to a 32 or 64 byte boundary more</span><span>
</span><span id="line-3700"></span><span>      </span><span class="hs-comment">-- complicated, in particular with DELTA.</span><span>
</span><span id="line-3701"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ([(RawStackArg, Padding)], Bool)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#sorry"><span class="hs-identifier hs-var">sorry</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ([(RawStackArg, Padding)], Bool))
-&gt; String -&gt; ([(RawStackArg, Padding)], Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span>
</span><span id="line-3702"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;X86_86 C call: unsupported argument.&quot;</span></span><span>
</span><span id="line-3703"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  Alignment requirement: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858266"><span class="hs-identifier hs-var">needed_alignment</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; bytes.&quot;</span></span><span>
</span><span id="line-3704"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858238"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">OS -&gt; OS -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OS
</span><span class="hs-identifier hs-var">OSMinGW32</span></span><span>
</span><span id="line-3705"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  The X86_64 NCG does not (yet) support Windows C calls with 256/512 bit vectors.&quot;</span></span><span>
</span><span id="line-3706"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  The X86_64 NCG cannot (yet) pass 256/512 bit vectors on the stack for C calls.&quot;</span></span><span>
</span><span id="line-3707"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  Please use the LLVM backend (-fllvm).&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-3708"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-3709"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span> </span><span id="local-6989586621682858268"><span class="annot"><span class="annottext">[(RawStackArg, Padding)]
</span><a href="#local-6989586621682858268"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858269"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858269"><span class="hs-identifier hs-var">final_align_16</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [RawStackArg] -&gt; ([(RawStackArg, Padding)], Bool)
</span><a href="#local-6989586621682858243"><span class="hs-identifier hs-var">pad_args</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858270"><span class="hs-identifier hs-var">next_aligned_16</span></a></span><span> </span><span class="annot"><span class="annottext">[RawStackArg]
</span><a href="#local-6989586621682858265"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-3710"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawStackArg
</span><a href="#local-6989586621682858264"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Padding
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#Padding"><span class="hs-identifier hs-var">Padding</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858271"><span class="hs-identifier hs-var">padding</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RawStackArg, Padding)
-&gt; [(RawStackArg, Padding)] -&gt; [(RawStackArg, Padding)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(RawStackArg, Padding)]
</span><a href="#local-6989586621682858268"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858269"><span class="hs-identifier hs-var">final_align_16</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-3711"></span><span>
</span><span id="line-3712"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-3713"></span><span>        </span><span id="local-6989586621682858266"><span class="annot"><span class="annottext">needed_alignment :: Int
</span><a href="#local-6989586621682858266"><span class="hs-identifier hs-var hs-var">needed_alignment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RawStackArg
</span><a href="#local-6989586621682858264"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3714"></span><span>          </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-type">RawStackArg</span></a></span><span> </span><span id="local-6989586621682858272"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858272"><span class="hs-identifier hs-var">arg</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#argSize"><span class="hs-identifier hs-var">argSize</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858238"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858272"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-3715"></span><span>          </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArgRef"><span class="hs-identifier hs-type">RawStackArgRef</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Int
</span><a href="GHC.Platform.html#platformWordSizeInBytes"><span class="hs-identifier hs-var">platformWordSizeInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858238"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-3716"></span><span>        </span><span id="local-6989586621682858271"><span class="annot"><span class="annottext">padding :: Int
</span><a href="#local-6989586621682858271"><span class="hs-identifier hs-var hs-var">padding</span></a></span></span><span>
</span><span id="line-3717"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858266"><span class="hs-identifier hs-var">needed_alignment</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858263"><span class="hs-identifier hs-var">aligned_16</span></a></span><span>
</span><span id="line-3718"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-3719"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-3720"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-3721"></span><span>        </span><span id="local-6989586621682858270"><span class="annot"><span class="annottext">next_aligned_16 :: Bool
</span><a href="#local-6989586621682858270"><span class="hs-identifier hs-var hs-var">next_aligned_16</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858263"><span class="hs-identifier hs-var">aligned_16</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858266"><span class="hs-identifier hs-var">needed_alignment</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-3722"></span><span>
</span><span id="line-3723"></span><span class="annot"><span class="hs-comment">-- | Load arguments into available registers.</span></span><span>
</span><span id="line-3724"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadArgs"><span class="hs-identifier hs-type">loadArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-type">LoadArgs</span></a></span><span>
</span><span id="line-3725"></span><span id="loadArgs"><span class="annot"><span class="annottext">loadArgs :: NCGConfig -&gt; [CmmExpr] -&gt; NatM LoadArgs
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#loadArgs"><span class="hs-identifier hs-var hs-var">loadArgs</span></a></span></span><span> </span><span id="local-6989586621682858273"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858273"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621682858274"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858274"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-3726"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858275"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">OS -&gt; OS -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OS
</span><span class="hs-identifier hs-var">OSMinGW32</span></span><span>
</span><span id="line-3727"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT [(Reg, Reg)] NatM LoadArgs -&gt; [(Reg, Reg)] -&gt; NatM LoadArgs
forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m a
</span><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#evalStateT"><span class="hs-identifier hs-var">evalStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NCGConfig -&gt; [CmmExpr] -&gt; StateT [(Reg, Reg)] NatM LoadArgs
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#loadArgsWin"><span class="hs-identifier hs-var">loadArgsWin</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858273"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858274"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; [(Reg, Reg)]
</span><a href="GHC.CmmToAsm.X86.Regs.html#allArgRegs"><span class="hs-identifier hs-var">allArgRegs</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858275"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3728"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-3729"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT ([Reg], [Reg]) NatM LoadArgs
-&gt; ([Reg], [Reg]) -&gt; NatM LoadArgs
forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m a
</span><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#evalStateT"><span class="hs-identifier hs-var">evalStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NCGConfig -&gt; [CmmExpr] -&gt; StateT ([Reg], [Reg]) NatM LoadArgs
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#loadArgsSysV"><span class="hs-identifier hs-var">loadArgsSysV</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858273"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858274"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; [Reg]
</span><a href="GHC.CmmToAsm.X86.Regs.html#allIntArgRegs"><span class="hs-identifier hs-var">allIntArgRegs</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858275"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-3730"></span><span>                                          </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Platform -&gt; [Reg]
</span><a href="GHC.CmmToAsm.X86.Regs.html#allFPArgRegs"><span class="hs-identifier hs-var">allFPArgRegs</span></a></span><span>  </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858275"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3731"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3732"></span><span>    </span><span id="local-6989586621682858275"><span class="annot"><span class="annottext">platform :: Platform
</span><a href="#local-6989586621682858275"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858273"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-3733"></span><span>
</span><span id="line-3734"></span><span class="annot"><span class="hs-comment">-- | Load arguments into available registers (System V AMD64 ABI).</span></span><span>
</span><span id="line-3735"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadArgsSysV"><span class="hs-identifier hs-type">loadArgsSysV</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span>
</span><span id="line-3736"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3737"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#StateT"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-type">LoadArgs</span></a></span><span>
</span><span id="line-3738"></span><span id="loadArgsSysV"><span class="annot"><span class="annottext">loadArgsSysV :: NCGConfig -&gt; [CmmExpr] -&gt; StateT ([Reg], [Reg]) NatM LoadArgs
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#loadArgsSysV"><span class="hs-identifier hs-var hs-var">loadArgsSysV</span></a></span></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LoadArgs -&gt; StateT ([Reg], [Reg]) NatM LoadArgs
forall a. a -&gt; StateT ([Reg], [Reg]) NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">LoadArgs
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-3739"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadArgsSysV"><span class="hs-identifier hs-var">loadArgsSysV</span></a></span><span> </span><span id="local-6989586621682858280"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858280"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682858281"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858281"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682858282"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858282"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3740"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682858283"><span class="annot"><a href="#local-6989586621682858283"><span class="hs-identifier hs-var">iregs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858284"><span class="annot"><a href="#local-6989586621682858284"><span class="hs-identifier hs-var">fregs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT ([Reg], [Reg]) NatM ([Reg], [Reg])
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-3741"></span><span>  </span><span class="hs-comment">-- No available registers: pass everything on the stack (shortcut).</span><span>
</span><span id="line-3742"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621682858283"><span class="hs-identifier hs-type">iregs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621682858284"><span class="hs-identifier hs-type">fregs</span></a></span><span>
</span><span id="line-3743"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-3744"></span><span>          </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-type">LoadArgs</span></a></span><span>
</span><span id="line-3745"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stackArgs"><span class="hs-identifier hs-var">stackArgs</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-type">RawStackArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858281"><span class="hs-identifier hs-type">arg</span></a></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><a href="#local-6989586621682858282"><span class="hs-identifier hs-type">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3746"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stackDataArgs"><span class="hs-identifier hs-var">stackDataArgs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-3747"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignArgsCode"><span class="hs-identifier hs-var">assignArgsCode</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span>
</span><span id="line-3748"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#usedRegs"><span class="hs-identifier hs-var">usedRegs</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-3749"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-3750"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3751"></span><span>    </span><span id="local-6989586621682858286"><span class="annot"><a href="#local-6989586621682858286"><span class="hs-identifier hs-var">mbReg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-3752"></span><span>      </span><span class="hs-keyword">if</span><span>
</span><span id="line-3753"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isIntFormat"><span class="hs-identifier hs-type">isIntFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858287"><span class="hs-identifier hs-type">arg_fmt</span></a></span><span>
</span><span id="line-3754"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858288"><span class="annot"><a href="#local-6989586621682858288"><span class="hs-identifier hs-var">ireg</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682858289"><span class="annot"><a href="#local-6989586621682858289"><span class="hs-identifier hs-var">iregs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682858283"><span class="hs-identifier hs-type">iregs</span></a></span><span>
</span><span id="line-3755"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#put"><span class="hs-identifier hs-type">put</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858289"><span class="hs-identifier hs-type">iregs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682858284"><span class="hs-identifier hs-type">fregs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3756"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621682858288"><span class="hs-identifier hs-type">ireg</span></a></span><span>
</span><span id="line-3757"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isFloatFormat"><span class="hs-identifier hs-type">isFloatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858287"><span class="hs-identifier hs-type">arg_fmt</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isVecFormat"><span class="hs-identifier hs-type">isVecFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858287"><span class="hs-identifier hs-type">arg_fmt</span></a></span><span>
</span><span id="line-3758"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858291"><span class="annot"><a href="#local-6989586621682858291"><span class="hs-identifier hs-var">freg</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682858292"><span class="annot"><a href="#local-6989586621682858292"><span class="hs-identifier hs-var">fregs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682858284"><span class="hs-identifier hs-type">fregs</span></a></span><span>
</span><span id="line-3759"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#put"><span class="hs-identifier hs-type">put</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858283"><span class="hs-identifier hs-type">iregs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682858292"><span class="hs-identifier hs-type">fregs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3760"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621682858291"><span class="hs-identifier hs-type">freg</span></a></span><span>
</span><span id="line-3761"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">otherwise</span></span><span>
</span><span id="line-3762"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-3763"></span><span>    </span><span id="local-6989586621682858293"><span class="annot"><a href="#local-6989586621682858293"><span class="hs-identifier hs-var">this_arg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-3764"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682858286"><span class="hs-identifier hs-type">mbReg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3765"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682858294"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858294"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3766"></span><span>          </span><span id="local-6989586621682858295"><span class="annot"><a href="#local-6989586621682858295"><span class="hs-identifier hs-var">assign_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM InstrBlock -&gt; StateT ([Reg], [Reg]) NatM InstrBlock
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT ([Reg], [Reg]) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(NatM InstrBlock -&gt; StateT ([Reg], [Reg]) NatM InstrBlock)
-&gt; NatM InstrBlock -&gt; StateT ([Reg], [Reg]) NatM InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Reg -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#loadArgIntoReg"><span class="hs-identifier hs-var">loadArgIntoReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858281"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858294"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-3767"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-3768"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-type">LoadArgs</span></a></span><span>
</span><span id="line-3769"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stackArgs"><span class="hs-identifier hs-var">stackArgs</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- passed in register</span><span>
</span><span id="line-3770"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stackDataArgs"><span class="hs-identifier hs-var">stackDataArgs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-3771"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignArgsCode"><span class="hs-identifier hs-var">assignArgsCode</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682858295"><span class="hs-identifier hs-type">assign_code</span></a></span><span>
</span><span id="line-3772"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#usedRegs"><span class="hs-identifier hs-var">usedRegs</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#RegWithFormat"><span class="hs-identifier hs-type">RegWithFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858294"><span class="hs-identifier hs-type">reg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858287"><span class="hs-identifier hs-type">arg_fmt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3773"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-3774"></span><span>        </span><span class="annot"><span class="annottext">Maybe Reg
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3775"></span><span>          </span><span class="annot"><span class="annottext">LoadArgs -&gt; StateT ([Reg], [Reg]) NatM LoadArgs
forall a. a -&gt; StateT ([Reg], [Reg]) NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(LoadArgs -&gt; StateT ([Reg], [Reg]) NatM LoadArgs)
-&gt; LoadArgs -&gt; StateT ([Reg], [Reg]) NatM LoadArgs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-3776"></span><span>            </span><span class="hs-comment">-- No available register for this argument: pass it on the stack.</span><span>
</span><span id="line-3777"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-type">LoadArgs</span></a></span><span>
</span><span id="line-3778"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">stackArgs :: [RawStackArg]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackArgs"><span class="hs-identifier hs-var">stackArgs</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr -&gt; RawStackArg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-var">RawStackArg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858281"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3779"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stackDataArgs :: [CmmExpr]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackDataArgs"><span class="hs-identifier hs-var">stackDataArgs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-3780"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">assignArgsCode :: InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignArgsCode"><span class="hs-identifier hs-var">assignArgsCode</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-3781"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">usedRegs :: [RegWithFormat]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#usedRegs"><span class="hs-identifier hs-var">usedRegs</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-3782"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-3783"></span><span>    </span><span id="local-6989586621682858297"><span class="annot"><a href="#local-6989586621682858297"><span class="hs-identifier hs-var">others</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadArgsSysV"><span class="hs-identifier hs-type">loadArgsSysV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858280"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858282"><span class="hs-identifier hs-type">rest</span></a></span><span>
</span><span id="line-3784"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858293"><span class="hs-identifier hs-type">this_arg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">S.&lt;&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682858297"><span class="hs-identifier hs-type">others</span></a></span><span>
</span><span id="line-3785"></span><span>
</span><span id="line-3786"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3787"></span><span>    </span><span id="local-6989586621682858298"><span class="annot"><span class="annottext">platform :: Platform
</span><a href="#local-6989586621682858298"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858280"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-3788"></span><span>    </span><span id="local-6989586621682858287"><span class="annot"><span class="annottext">arg_fmt :: Format
</span><a href="#local-6989586621682858287"><span class="hs-identifier hs-var hs-var">arg_fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858298"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858281"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3789"></span><span>
</span><span id="line-3790"></span><span class="hs-comment">-- | Compute all things that will need to be pushed to the stack.</span><span>
</span><span id="line-3791"></span><span class="hs-comment">--</span><span>
</span><span id="line-3792"></span><span class="hs-comment">-- On Windows, an argument passed by reference will require two pieces of data:</span><span>
</span><span id="line-3793"></span><span class="hs-comment">--</span><span>
</span><span id="line-3794"></span><span class="hs-comment">--  - the reference (returned in the first position)</span><span>
</span><span id="line-3795"></span><span class="hs-comment">--  - the actual data (returned in the second position)</span><span>
</span><span id="line-3796"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#computeWinPushArgs"><span class="hs-identifier hs-type">computeWinPushArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-type">RawStackArg</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3797"></span><span id="computeWinPushArgs"><span class="annot"><span class="annottext">computeWinPushArgs :: Platform -&gt; [CmmExpr] -&gt; ([RawStackArg], [CmmExpr])
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#computeWinPushArgs"><span class="hs-identifier hs-var hs-var">computeWinPushArgs</span></a></span></span><span> </span><span id="local-6989586621682858300"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858300"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CmmExpr] -&gt; ([RawStackArg], [CmmExpr])
</span><a href="#local-6989586621682858301"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-3798"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3799"></span><span>    </span><span class="annot"><a href="#local-6989586621682858301"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-type">RawStackArg</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3800"></span><span>    </span><span id="local-6989586621682858301"><span class="annot"><span class="annottext">go :: [CmmExpr] -&gt; ([RawStackArg], [CmmExpr])
</span><a href="#local-6989586621682858301"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3801"></span><span>    </span><span class="annot"><a href="#local-6989586621682858301"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682858302"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858302"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682858303"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858303"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3802"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-3803"></span><span>        </span><span id="local-6989586621682858304"><span class="annot"><span class="annottext">arg_size :: Int
</span><a href="#local-6989586621682858304"><span class="hs-identifier hs-var hs-var">arg_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#argSize"><span class="hs-identifier hs-var">argSize</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858300"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858302"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-3804"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682858305"><span class="annot"><span class="annottext">RawStackArg
</span><a href="#local-6989586621682858305"><span class="hs-identifier hs-var">this_arg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858306"><span class="annot"><span class="annottext">[CmmExpr] -&gt; [CmmExpr]
</span><a href="#local-6989586621682858306"><span class="hs-identifier hs-var">add_this_arg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3805"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858304"><span class="hs-identifier hs-var">arg_size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-3806"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">StackRef -&gt; Int -&gt; RawStackArg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArgRef"><span class="hs-identifier hs-var">RawStackArgRef</span></a></span><span> </span><span class="annot"><span class="annottext">StackRef
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#OnStack"><span class="hs-identifier hs-var">OnStack</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858304"><span class="hs-identifier hs-var">arg_size</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858302"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; [CmmExpr] -&gt; [CmmExpr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-3807"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-3808"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; RawStackArg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-var">RawStackArg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858302"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[CmmExpr] -&gt; [CmmExpr]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-3809"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682858308"><span class="annot"><span class="annottext">[RawStackArg]
</span><a href="#local-6989586621682858308"><span class="hs-identifier hs-var">stk_args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858309"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858309"><span class="hs-identifier hs-var">stk_data</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CmmExpr] -&gt; ([RawStackArg], [CmmExpr])
</span><a href="#local-6989586621682858301"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858303"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-3810"></span><span>      </span><span class="hs-keyword">in</span><span>
</span><span id="line-3811"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawStackArg
</span><a href="#local-6989586621682858305"><span class="hs-identifier hs-var">this_arg</span></a></span><span class="annot"><span class="annottext">RawStackArg -&gt; [RawStackArg] -&gt; [RawStackArg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[RawStackArg]
</span><a href="#local-6989586621682858308"><span class="hs-identifier hs-var">stk_args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[CmmExpr] -&gt; [CmmExpr]
</span><a href="#local-6989586621682858306"><span class="hs-identifier hs-var">add_this_arg</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858309"><span class="hs-identifier hs-var">stk_data</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3812"></span><span>
</span><span id="line-3813"></span><span class="annot"><span class="hs-comment">-- | Load arguments into available registers (Windows C X64 calling convention).</span></span><span>
</span><span id="line-3814"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadArgsWin"><span class="hs-identifier hs-type">loadArgsWin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#StateT"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-type">LoadArgs</span></a></span><span>
</span><span id="line-3815"></span><span id="loadArgsWin"><span class="annot"><span class="annottext">loadArgsWin :: NCGConfig -&gt; [CmmExpr] -&gt; StateT [(Reg, Reg)] NatM LoadArgs
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#loadArgsWin"><span class="hs-identifier hs-var hs-var">loadArgsWin</span></a></span></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LoadArgs -&gt; StateT [(Reg, Reg)] NatM LoadArgs
forall a. a -&gt; StateT [(Reg, Reg)] NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">LoadArgs
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-3816"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadArgsWin"><span class="hs-identifier hs-var">loadArgsWin</span></a></span><span> </span><span id="local-6989586621682858310"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858310"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682858311"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858311"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682858312"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858312"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3817"></span><span>  </span><span id="local-6989586621682858313"><span class="annot"><a href="#local-6989586621682858313"><span class="hs-identifier hs-var">regs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT [(Reg, Reg)] NatM [(Reg, Reg)]
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-3818"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682858313"><span class="hs-identifier hs-type">regs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3819"></span><span>    </span><span id="local-6989586621682858314"><span class="annot"><span class="annottext">(Reg, Reg)
</span><a href="#local-6989586621682858314"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682858315"><span class="annot"><span class="annottext">[(Reg, Reg)]
</span><a href="#local-6989586621682858315"><span class="hs-identifier hs-var">regs'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3820"></span><span>      </span><span class="annot"><span class="annottext">[(Reg, Reg)] -&gt; StateT [(Reg, Reg)] NatM ()
forall (m :: * -&gt; *) s. Monad m =&gt; s -&gt; StateT s m ()
</span><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">[(Reg, Reg)]
</span><a href="#local-6989586621682858315"><span class="hs-identifier hs-var">regs'</span></a></span><span>
</span><span id="line-3821"></span><span>      </span><span id="local-6989586621682858316"><span class="annot"><a href="#local-6989586621682858316"><span class="hs-identifier hs-var">this_arg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM LoadArgs -&gt; StateT [(Reg, Reg)] NatM LoadArgs
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT [(Reg, Reg)] m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(NatM LoadArgs -&gt; StateT [(Reg, Reg)] NatM LoadArgs)
-&gt; NatM LoadArgs -&gt; StateT [(Reg, Reg)] NatM LoadArgs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Reg, Reg) -&gt; NatM LoadArgs
</span><a href="#local-6989586621682858317"><span class="hs-identifier hs-var">load_arg_win</span></a></span><span> </span><span class="annot"><span class="annottext">(Reg, Reg)
</span><a href="#local-6989586621682858314"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-3822"></span><span>      </span><span id="local-6989586621682858318"><span class="annot"><a href="#local-6989586621682858318"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadArgsWin"><span class="hs-identifier hs-type">loadArgsWin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858310"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858312"><span class="hs-identifier hs-type">rest</span></a></span><span>
</span><span id="line-3823"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858316"><span class="hs-identifier hs-type">this_arg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">S.&lt;&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682858318"><span class="hs-identifier hs-type">rest</span></a></span><span>
</span><span id="line-3824"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3825"></span><span>      </span><span class="hs-comment">-- No more registers available: pass all (remaining) arguments on the stack.</span><span>
</span><span id="line-3826"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682858319"><span class="annot"><span class="annottext">[RawStackArg]
</span><a href="#local-6989586621682858319"><span class="hs-identifier hs-var">stk_args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858320"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858320"><span class="hs-identifier hs-var">data_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; [CmmExpr] -&gt; ([RawStackArg], [CmmExpr])
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#computeWinPushArgs"><span class="hs-identifier hs-var">computeWinPushArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858321"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858311"><span class="hs-identifier hs-var">arg</span></a></span><span class="annot"><span class="annottext">CmmExpr -&gt; [CmmExpr] -&gt; [CmmExpr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858312"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3827"></span><span>      </span><span class="annot"><span class="annottext">LoadArgs -&gt; StateT [(Reg, Reg)] NatM LoadArgs
forall a. a -&gt; StateT [(Reg, Reg)] NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(LoadArgs -&gt; StateT [(Reg, Reg)] NatM LoadArgs)
-&gt; LoadArgs -&gt; StateT [(Reg, Reg)] NatM LoadArgs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-3828"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-type">LoadArgs</span></a></span><span>
</span><span id="line-3829"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">stackArgs :: [RawStackArg]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackArgs"><span class="hs-identifier hs-var">stackArgs</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RawStackArg]
</span><a href="#local-6989586621682858319"><span class="hs-identifier hs-var">stk_args</span></a></span><span>
</span><span id="line-3830"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stackDataArgs :: [CmmExpr]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackDataArgs"><span class="hs-identifier hs-var">stackDataArgs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858320"><span class="hs-identifier hs-var">data_args</span></a></span><span>
</span><span id="line-3831"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">assignArgsCode :: InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignArgsCode"><span class="hs-identifier hs-var">assignArgsCode</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-3832"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">usedRegs :: [RegWithFormat]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#usedRegs"><span class="hs-identifier hs-var">usedRegs</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-3833"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-3834"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3835"></span><span>    </span><span id="local-6989586621682858321"><span class="annot"><span class="annottext">platform :: Platform
</span><a href="#local-6989586621682858321"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858310"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-3836"></span><span>    </span><span id="local-6989586621682858322"><span class="annot"><span class="annottext">arg_fmt :: Format
</span><a href="#local-6989586621682858322"><span class="hs-identifier hs-var hs-var">arg_fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmType -&gt; Format) -&gt; CmmType -&gt; Format
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858321"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858311"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-3837"></span><span>    </span><span id="local-6989586621682858317"><span class="annot"><span class="annottext">load_arg_win :: (Reg, Reg) -&gt; NatM LoadArgs
</span><a href="#local-6989586621682858317"><span class="hs-identifier hs-var hs-var">load_arg_win</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682858323"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858323"><span class="hs-identifier hs-var">ireg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858324"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858324"><span class="hs-identifier hs-var">freg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3838"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Bool
</span><a href="GHC.CmmToAsm.Format.html#isVecFormat"><span class="hs-identifier hs-var">isVecFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858322"><span class="hs-identifier hs-var">arg_fmt</span></a></span><span>
</span><span id="line-3839"></span><span>       </span><span class="hs-comment">-- Vectors are passed by reference.</span><span>
</span><span id="line-3840"></span><span>       </span><span class="hs-comment">-- See Note [The Windows X64 C calling convention].</span><span>
</span><span id="line-3841"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">LoadArgs -&gt; NatM LoadArgs
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(LoadArgs -&gt; NatM LoadArgs) -&gt; LoadArgs -&gt; NatM LoadArgs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-3842"></span><span>             </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-type">LoadArgs</span></a></span><span>
</span><span id="line-3843"></span><span>                </span><span class="hs-comment">-- Pass the reference in a register,</span><span>
</span><span id="line-3844"></span><span>                </span><span class="hs-comment">-- and the argument data on the stack.</span><span>
</span><span id="line-3845"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">stackArgs :: [RawStackArg]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackArgs"><span class="hs-identifier hs-var">stackArgs</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StackRef -&gt; Int -&gt; RawStackArg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArgRef"><span class="hs-identifier hs-var">RawStackArgRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; StackRef
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#InReg"><span class="hs-identifier hs-var">InReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858323"><span class="hs-identifier hs-var">ireg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#argSize"><span class="hs-identifier hs-var">argSize</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858321"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858311"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-3846"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stackDataArgs :: [CmmExpr]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackDataArgs"><span class="hs-identifier hs-var">stackDataArgs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858311"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- we don't yet know where the data will reside,</span><span>
</span><span id="line-3847"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">assignArgsCode :: InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignArgsCode"><span class="hs-identifier hs-var">assignArgsCode</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span> </span><span class="hs-comment">-- so we defer computing the reference and storing it</span><span>
</span><span id="line-3848"></span><span>                                          </span><span class="hs-comment">-- in the register until later</span><span>
</span><span id="line-3849"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">usedRegs :: [RegWithFormat]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#usedRegs"><span class="hs-identifier hs-var">usedRegs</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Reg -&gt; Format -&gt; RegWithFormat
</span><a href="GHC.CmmToAsm.Format.html#RegWithFormat"><span class="hs-identifier hs-var">RegWithFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858323"><span class="hs-identifier hs-var">ireg</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3850"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-3851"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-3852"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858325"><span class="annot"><span class="annottext">arg_reg :: Reg
</span><a href="#local-6989586621682858325"><span class="hs-identifier hs-var hs-var hs-var">arg_reg</span></a></span></span><span>
</span><span id="line-3853"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Bool
</span><a href="GHC.CmmToAsm.Format.html#isFloatFormat"><span class="hs-identifier hs-var">isFloatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858322"><span class="hs-identifier hs-var">arg_fmt</span></a></span><span>
</span><span id="line-3854"></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858324"><span class="hs-identifier hs-var">freg</span></a></span><span>
</span><span id="line-3855"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-3856"></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858323"><span class="hs-identifier hs-var">ireg</span></a></span><span>
</span><span id="line-3857"></span><span>           </span><span id="local-6989586621682858326"><span class="annot"><a href="#local-6989586621682858326"><span class="hs-identifier hs-var">assign_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Reg -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#loadArgIntoReg"><span class="hs-identifier hs-var">loadArgIntoReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858311"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858325"><span class="hs-identifier hs-var">arg_reg</span></a></span><span>
</span><span id="line-3858"></span><span>           </span><span class="hs-comment">-- Recall that, for varargs, we must pass floating-point</span><span>
</span><span id="line-3859"></span><span>           </span><span class="hs-comment">-- arguments in both fp and integer registers.</span><span>
</span><span id="line-3860"></span><span>           </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682858327"><span class="annot"><a href="#local-6989586621682858327"><span class="hs-identifier hs-var">assign_code'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858328"><span class="annot"><a href="#local-6989586621682858328"><span class="hs-identifier hs-var">regs'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3861"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isFloatFormat"><span class="hs-identifier hs-type">isFloatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858322"><span class="hs-identifier hs-type">arg_fmt</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3862"></span><span>                    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621682858326"><span class="hs-identifier hs-type">assign_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVD"><span class="hs-identifier hs-type">MOVD</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#FF64"><span class="hs-identifier hs-type">FF64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858324"><span class="hs-identifier hs-type">freg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858323"><span class="hs-identifier hs-type">ireg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3863"></span><span>                      </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#RegWithFormat"><span class="hs-identifier hs-type">RegWithFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858324"><span class="hs-identifier hs-type">freg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#FF64"><span class="hs-identifier hs-type">FF64</span></a></span><span>
</span><span id="line-3864"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#RegWithFormat"><span class="hs-identifier hs-type">RegWithFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858323"><span class="hs-identifier hs-type">ireg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3865"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858326"><span class="hs-identifier hs-type">assign_code</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#RegWithFormat"><span class="hs-identifier hs-type">RegWithFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858323"><span class="hs-identifier hs-type">ireg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3866"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-3867"></span><span>             </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#LoadArgs"><span class="hs-identifier hs-type">LoadArgs</span></a></span><span>
</span><span id="line-3868"></span><span>               </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stackArgs"><span class="hs-identifier hs-var">stackArgs</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- passed in register</span><span>
</span><span id="line-3869"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#stackDataArgs"><span class="hs-identifier hs-var">stackDataArgs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-3870"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#assignArgsCode"><span class="hs-identifier hs-var">assignArgsCode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682858327"><span class="hs-identifier hs-type">assign_code'</span></a></span><span>
</span><span id="line-3871"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#usedRegs"><span class="hs-identifier hs-var">usedRegs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682858328"><span class="hs-identifier hs-type">regs'</span></a></span><span>
</span><span id="line-3872"></span><span>               </span><span class="hs-special">}</span><span>
</span><span id="line-3873"></span><span>
</span><span id="line-3874"></span><span class="hs-comment">-- | Load an argument into a register.</span><span>
</span><span id="line-3875"></span><span class="hs-comment">--</span><span>
</span><span id="line-3876"></span><span class="hs-comment">-- Assumes that the expression does not contain any MachOps,</span><span>
</span><span id="line-3877"></span><span class="hs-comment">-- as per Note [Evaluate C-call arguments before placing in destination registers].</span><span>
</span><span id="line-3878"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadArgIntoReg"><span class="hs-identifier hs-type">loadArgIntoReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-3879"></span><span id="loadArgIntoReg"><span class="annot"><span class="annottext">loadArgIntoReg :: CmmExpr -&gt; Reg -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#loadArgIntoReg"><span class="hs-identifier hs-var hs-var">loadArgIntoReg</span></a></span></span><span> </span><span id="local-6989586621682858329"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858329"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682858330"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858330"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3880"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; NatM () -&gt; NatM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="GHC.Utils.Constants.html#debugIsOn"><span class="hs-identifier hs-var">debugIsOn</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#loadIntoRegMightClobberOtherReg"><span class="hs-identifier hs-var">loadIntoRegMightClobberOtherReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858329"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NatM () -&gt; NatM ()) -&gt; NatM () -&gt; NatM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3881"></span><span>    </span><span id="local-6989586621682858332"><span class="annot"><a href="#local-6989586621682858332"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-3882"></span><span>    </span><span class="annot"><a href="GHC.Utils.Panic.html#massertPpr"><span class="hs-identifier hs-type">massertPpr</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-3883"></span><span>      </span><span class="annot"><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;loadArgIntoReg: arg might contain MachOp&quot;</span></span><span>
</span><span id="line-3884"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;arg:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-type">pdoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858332"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858329"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-3885"></span><span>  </span><span id="local-6989586621682858334"><span class="annot"><a href="#local-6989586621682858334"><span class="hs-identifier hs-var">arg_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858329"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-3886"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858334"><span class="hs-identifier hs-type">arg_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858330"><span class="hs-identifier hs-type">reg</span></a></span><span>
</span><span id="line-3887"></span><span>
</span><span id="line-3888"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-3889"></span><span class="hs-comment">-- Pushing arguments onto the stack for 64-bit C calls.</span><span>
</span><span id="line-3890"></span><span>
</span><span id="line-3891"></span><span class="hs-comment">-- | The size of an argument (in bytes).</span><span>
</span><span id="line-3892"></span><span class="hs-comment">--</span><span>
</span><span id="line-3893"></span><span class="hs-comment">-- Never smaller than the platform word width.</span><span>
</span><span id="line-3894"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#argSize"><span class="hs-identifier hs-type">argSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-3895"></span><span id="argSize"><span class="annot"><span class="annottext">argSize :: Platform -&gt; CmmExpr -&gt; Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#argSize"><span class="hs-identifier hs-var hs-var">argSize</span></a></span></span><span> </span><span id="local-6989586621682858335"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858335"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682858336"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858336"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3896"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Int
</span><a href="GHC.Platform.html#platformWordSizeInBytes"><span class="hs-identifier hs-var">platformWordSizeInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858335"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-3897"></span><span>    </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBytes"><span class="hs-identifier hs-var">widthInBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmType -&gt; Width) -&gt; CmmType -&gt; Width
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858335"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858336"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3898"></span><span>
</span><span id="line-3899"></span><span class="annot"><span class="hs-comment">-- | Add the given amount of padding on the stack.</span></span><span>
</span><span id="line-3900"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#addStackPadding"><span class="hs-identifier hs-type">addStackPadding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ padding (in bytes)</span></span><span>
</span><span id="line-3901"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-3902"></span><span id="addStackPadding"><span class="annot"><span class="annottext">addStackPadding :: Int -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#addStackPadding"><span class="hs-identifier hs-var hs-var">addStackPadding</span></a></span></span><span> </span><span id="local-6989586621682858337"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858337"><span class="hs-identifier hs-var">pad_bytes</span></a></span></span><span>
</span><span id="line-3903"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858337"><span class="hs-identifier hs-var">pad_bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-3904"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; NatM InstrBlock
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-3905"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-3906"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682858338"><span class="annot"><a href="#local-6989586621682858338"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Int
</span><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-var">getDeltaNat</span></a></span><span>
</span><span id="line-3907"></span><span>       </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858338"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621682858337"><span class="hs-identifier hs-type">pad_bytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3908"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-3909"></span><span>         </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-type">SUB</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858337"><span class="hs-identifier hs-type">pad_bytes</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#rsp"><span class="hs-identifier hs-type">rsp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3910"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858338"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621682858337"><span class="hs-identifier hs-type">pad_bytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3911"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-3912"></span><span>
</span><span id="line-3913"></span><span class="hs-comment">-- | Push one argument directly to the stack (by value).</span><span>
</span><span id="line-3914"></span><span class="hs-comment">--</span><span>
</span><span id="line-3915"></span><span class="hs-comment">-- Assumes the current stack pointer fulfills any necessary alignment requirements.</span><span>
</span><span id="line-3916"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#pushArgByValue"><span class="hs-identifier hs-type">pushArgByValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-3917"></span><span id="pushArgByValue"><span class="annot"><span class="annottext">pushArgByValue :: NCGConfig -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#pushArgByValue"><span class="hs-identifier hs-var hs-var">pushArgByValue</span></a></span></span><span> </span><span id="local-6989586621682858341"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858341"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621682858342"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858342"><span class="hs-identifier hs-var">arg</span></a></span></span><span>
</span><span id="line-3918"></span><span>   </span><span class="hs-comment">-- For 64-bit integer arguments, use PUSH II64.</span><span>
</span><span id="line-3919"></span><span>   </span><span class="hs-comment">--</span><span>
</span><span id="line-3920"></span><span>   </span><span class="hs-comment">-- Note: we *must not* do this for smaller arguments.</span><span>
</span><span id="line-3921"></span><span>   </span><span class="hs-comment">-- For example, if we tried to push an argument such as @CmmLoad addr W32 aln@,</span><span>
</span><span id="line-3922"></span><span>   </span><span class="hs-comment">-- we could end up reading unmapped memory and segfaulting.</span><span>
</span><span id="line-3923"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Bool
</span><a href="GHC.CmmToAsm.Format.html#isIntFormat"><span class="hs-identifier hs-var">isIntFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858343"><span class="hs-identifier hs-var">fmt</span></a></span><span>
</span><span id="line-3924"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Int
</span><a href="GHC.CmmToAsm.Format.html#formatInBytes"><span class="hs-identifier hs-var">formatInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858343"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-3925"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3926"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621682858345"><span class="annot"><a href="#local-6989586621682858345"><span class="hs-identifier hs-var">arg_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858346"><span class="annot"><a href="#local-6989586621682858346"><span class="hs-identifier hs-var">arg_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-var">getOperand</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858342"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-3927"></span><span>     </span><span id="local-6989586621682858347"><span class="annot"><a href="#local-6989586621682858347"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-3928"></span><span>     </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858347"><span class="hs-identifier hs-type">delta</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><a href="#local-6989586621682858348"><span class="hs-identifier hs-type">arg_size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3929"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-3930"></span><span>       </span><span class="annot"><a href="#local-6989586621682858346"><span class="hs-identifier hs-type">arg_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-3931"></span><span>       </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#PUSH"><span class="hs-identifier hs-type">PUSH</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858345"><span class="hs-identifier hs-type">arg_op</span></a></span><span>
</span><span id="line-3932"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858347"><span class="hs-identifier hs-type">delta</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><a href="#local-6989586621682858348"><span class="hs-identifier hs-type">arg_size</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-3933"></span><span>
</span><span id="line-3934"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-3935"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3936"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621682858349"><span class="annot"><a href="#local-6989586621682858349"><span class="hs-identifier hs-var">arg_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858350"><span class="annot"><a href="#local-6989586621682858350"><span class="hs-identifier hs-var">arg_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858342"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-3937"></span><span>     </span><span id="local-6989586621682858351"><span class="annot"><a href="#local-6989586621682858351"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-3938"></span><span>     </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858351"><span class="hs-identifier hs-type">delta</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><a href="#local-6989586621682858348"><span class="hs-identifier hs-type">arg_size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3939"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858350"><span class="hs-identifier hs-type">arg_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-3940"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-type">SUB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Type.html#wordWidth"><span class="hs-identifier hs-type">wordWidth</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858352"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858348"><span class="hs-identifier hs-type">arg_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#rsp"><span class="hs-identifier hs-type">rsp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3941"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858351"><span class="hs-identifier hs-type">delta</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><a href="#local-6989586621682858348"><span class="hs-identifier hs-type">arg_size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3942"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#movInstr"><span class="hs-identifier hs-type">movInstr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858341"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858343"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858349"><span class="hs-identifier hs-type">arg_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#spRel"><span class="hs-identifier hs-type">spRel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858352"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-3943"></span><span>
</span><span id="line-3944"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-3945"></span><span>      </span><span id="local-6989586621682858352"><span class="annot"><span class="annottext">platform :: Platform
</span><a href="#local-6989586621682858352"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858341"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-3946"></span><span>      </span><span id="local-6989586621682858348"><span class="annot"><span class="annottext">arg_size :: Int
</span><a href="#local-6989586621682858348"><span class="hs-identifier hs-var hs-var">arg_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#argSize"><span class="hs-identifier hs-var">argSize</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858352"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858342"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-3947"></span><span>      </span><span id="local-6989586621682858354"><span class="annot"><span class="annottext">arg_rep :: CmmType
</span><a href="#local-6989586621682858354"><span class="hs-identifier hs-var hs-var">arg_rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858352"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858342"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-3948"></span><span>      </span><span id="local-6989586621682858343"><span class="annot"><span class="annottext">fmt :: Format
</span><a href="#local-6989586621682858343"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682858354"><span class="hs-identifier hs-var">arg_rep</span></a></span><span>
</span><span id="line-3949"></span><span>
</span><span id="line-3950"></span><span class="annot"><span class="hs-comment">-- | Load an argument into a register or push it to the stack.</span></span><span>
</span><span id="line-3951"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#loadOrPushArg"><span class="hs-identifier hs-type">loadOrPushArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArg"><span class="hs-identifier hs-type">StackArg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3952"></span><span id="loadOrPushArg"><span class="annot"><span class="annottext">loadOrPushArg :: NCGConfig -&gt; (StackArg, Maybe Int) -&gt; NatM (InstrBlock, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#loadOrPushArg"><span class="hs-identifier hs-var hs-var">loadOrPushArg</span></a></span></span><span> </span><span id="local-6989586621682858356"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858356"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682858357"><span class="annot"><span class="annottext">StackArg
</span><a href="#local-6989586621682858357"><span class="hs-identifier hs-var">stk_arg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858358"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621682858358"><span class="hs-identifier hs-var">mb_off</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3953"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StackArg
</span><a href="#local-6989586621682858357"><span class="hs-identifier hs-var">stk_arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3954"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArg"><span class="hs-identifier hs-type">StackArg</span></a></span><span> </span><span id="local-6989586621682858359"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858359"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682858360"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858360"><span class="hs-identifier hs-var">pad</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3955"></span><span>      </span><span id="local-6989586621682858361"><span class="annot"><a href="#local-6989586621682858361"><span class="hs-identifier hs-var">push_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#pushArgByValue"><span class="hs-identifier hs-var">pushArgByValue</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858356"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858359"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-3956"></span><span>      </span><span id="local-6989586621682858362"><span class="annot"><a href="#local-6989586621682858362"><span class="hs-identifier hs-var">pad_code</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#addStackPadding"><span class="hs-identifier hs-type">addStackPadding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858360"><span class="hs-identifier hs-type">pad</span></a></span><span>
</span><span id="line-3957"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682858361"><span class="hs-identifier hs-type">push_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858362"><span class="hs-identifier hs-type">pad_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3958"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArgRef"><span class="hs-identifier hs-type">StackArgRef</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">stackRef :: StackArg -&gt; StackRef
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackRef"><span class="hs-identifier hs-var">stackRef</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682858363"><span class="annot"><span class="annottext">StackRef
</span><a href="#local-6989586621682858363"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3959"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StackRef
</span><a href="#local-6989586621682858363"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3960"></span><span>        </span><span class="hs-comment">-- Pass the reference in a register</span><span>
</span><span id="line-3961"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InReg"><span class="hs-identifier hs-type">InReg</span></a></span><span> </span><span id="local-6989586621682858364"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858364"><span class="hs-identifier hs-var">ireg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3962"></span><span>          </span><span class="annot"><span class="annottext">(InstrBlock, InstrBlock) -&gt; NatM (InstrBlock, InstrBlock)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; InstrBlock) -&gt; Instr -&gt; InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LEA"><span class="hs-identifier hs-var">LEA</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Int -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#spRel"><span class="hs-identifier hs-var">spRel</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858365"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858366"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858364"><span class="hs-identifier hs-var">ireg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3963"></span><span>        </span><span class="hs-comment">-- Pass the reference on the stack</span><span>
</span><span id="line-3964"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#OnStack"><span class="hs-identifier hs-type">OnStack</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3965"></span><span>          </span><span id="local-6989586621682858367"><span class="annot"><a href="#local-6989586621682858367"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span>
</span><span id="line-3966"></span><span>          </span><span id="local-6989586621682858368"><span class="annot"><a href="#local-6989586621682858368"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span>
</span><span id="line-3967"></span><span>          </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858368"><span class="hs-identifier hs-type">delta</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><a href="#local-6989586621682858369"><span class="hs-identifier hs-type">arg_ref_size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3968"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858370"><span class="annot"><a href="#local-6989586621682858370"><span class="hs-identifier hs-var hs-var">push_code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-3969"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Width
</span><a href="GHC.Cmm.Type.html#wordWidth"><span class="hs-identifier hs-var">wordWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858365"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858369"><span class="hs-identifier hs-var">arg_ref_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rsp"><span class="hs-identifier hs-var">rsp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3970"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858368"><span class="hs-identifier hs-var">delta</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858369"><span class="hs-identifier hs-var">arg_ref_size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3971"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LEA"><span class="hs-identifier hs-var">LEA</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Int -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#spRel"><span class="hs-identifier hs-var">spRel</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858365"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858366"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858367"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3972"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858367"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Int -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#spRel"><span class="hs-identifier hs-var">spRel</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858365"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-3973"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682858370"><span class="hs-identifier hs-type">push_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3974"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682858366"><span class="annot"><span class="annottext">off :: Int
</span><a href="#local-6989586621682858366"><span class="hs-identifier hs-var hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Int -&gt; Int
forall a. HasDebugCallStack =&gt; String -&gt; Maybe a -&gt; a
</span><a href="GHC.Data.Maybe.html#expectJust"><span class="hs-identifier hs-var">expectJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;push_arg_win offset&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621682858358"><span class="hs-identifier hs-var">mb_off</span></a></span><span>
</span><span id="line-3975"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-3976"></span><span>      </span><span id="local-6989586621682858369"><span class="annot"><span class="annottext">arg_ref_size :: Int
</span><a href="#local-6989586621682858369"><span class="hs-identifier hs-var hs-var">arg_ref_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="hs-comment">-- passing a reference to the argument</span><span>
</span><span id="line-3977"></span><span>      </span><span id="local-6989586621682858365"><span class="annot"><span class="annottext">platform :: Platform
</span><a href="#local-6989586621682858365"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858356"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-3978"></span><span>
</span><span id="line-3979"></span><span class="hs-comment">-- | Push arguments to the stack, right to left.</span><span>
</span><span id="line-3980"></span><span class="hs-comment">--</span><span>
</span><span id="line-3981"></span><span class="hs-comment">-- On Windows, some arguments may need to be passed by reference,</span><span>
</span><span id="line-3982"></span><span class="hs-comment">-- which requires separately passing the data and the reference.</span><span>
</span><span id="line-3983"></span><span class="hs-comment">-- See Note [The Windows X64 C calling convention].</span><span>
</span><span id="line-3984"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#pushArgs"><span class="hs-identifier hs-type">pushArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span>
</span><span id="line-3985"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-type">RawStackArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3986"></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ arguments proper (i.e. don't include the data for arguments passed by reference)</span></span><span>
</span><span id="line-3987"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArg"><span class="hs-identifier hs-type">StackArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3988"></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ arguments we are passing on the stack</span></span><span>
</span><span id="line-3989"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3990"></span><span id="pushArgs"><span class="annot"><span class="annottext">pushArgs :: NCGConfig
-&gt; [RawStackArg] -&gt; [StackArg] -&gt; NatM (InstrBlock, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#pushArgs"><span class="hs-identifier hs-var hs-var">pushArgs</span></a></span></span><span> </span><span id="local-6989586621682858372"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858372"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621682858373"><span class="annot"><span class="annottext">[RawStackArg]
</span><a href="#local-6989586621682858373"><span class="hs-identifier hs-var">proper_args</span></a></span></span><span> </span><span id="local-6989586621682858374"><span class="annot"><span class="annottext">[StackArg]
</span><a href="#local-6989586621682858374"><span class="hs-identifier hs-var">all_stk_args</span></a></span></span><span>
</span><span id="line-3991"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-3992"></span><span>            </span><span class="annot"><a href="#local-6989586621682858375"><span class="hs-identifier hs-type">vec_offs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-3993"></span><span>            </span><span id="local-6989586621682858375"><span class="annot"><span class="annottext">vec_offs :: [Maybe Int]
</span><a href="#local-6989586621682858375"><span class="hs-identifier hs-var hs-var hs-var">vec_offs</span></a></span></span><span>
</span><span id="line-3994"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858376"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">OS -&gt; OS -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OS
</span><span class="hs-identifier hs-var">OSMinGW32</span></span><span>
</span><span id="line-3995"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [StackArg] -&gt; [Maybe Int]
</span><a href="#local-6989586621682858377"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858378"><span class="hs-identifier hs-var">stack_arg_size</span></a></span><span> </span><span class="annot"><span class="annottext">[StackArg]
</span><a href="#local-6989586621682858374"><span class="hs-identifier hs-var">all_stk_args</span></a></span><span>
</span><span id="line-3996"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-3997"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; [Maybe Int]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3998"></span><span>
</span><span id="line-3999"></span><span>    </span><span class="hs-comment">---------------------</span><span>
</span><span id="line-4000"></span><span>    </span><span class="hs-comment">-- Windows-only code</span><span>
</span><span id="line-4001"></span><span>
</span><span id="line-4002"></span><span>            </span><span class="hs-comment">-- Size of the arguments we are passing on the stack, counting only</span><span>
</span><span id="line-4003"></span><span>            </span><span class="hs-comment">-- the reference part for arguments passed by reference.</span><span>
</span><span id="line-4004"></span><span>            </span><span id="local-6989586621682858378"><span class="annot"><span class="annottext">stack_arg_size :: Int
</span><a href="#local-6989586621682858378"><span class="hs-identifier hs-var hs-var hs-var">stack_arg_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">(RawStackArg -&gt; Bool) -&gt; [RawStackArg] -&gt; Int
forall a. (a -&gt; Bool) -&gt; [a] -&gt; Int
</span><a href="GHC.Utils.Misc.html#count"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">RawStackArg -&gt; Bool
</span><a href="#local-6989586621682858379"><span class="hs-identifier hs-var">not_in_reg</span></a></span><span> </span><span class="annot"><span class="annottext">[RawStackArg]
</span><a href="#local-6989586621682858373"><span class="hs-identifier hs-var">proper_args</span></a></span><span>
</span><span id="line-4005"></span><span>            </span><span id="local-6989586621682858379"><span class="annot"><span class="annottext">not_in_reg :: RawStackArg -&gt; Bool
</span><a href="#local-6989586621682858379"><span class="hs-identifier hs-var hs-var hs-var">not_in_reg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArg"><span class="hs-identifier hs-type">RawStackArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-4006"></span><span>            </span><span class="annot"><a href="#local-6989586621682858379"><span class="hs-identifier hs-var">not_in_reg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#RawStackArgRef"><span class="hs-identifier hs-type">RawStackArgRef</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">stackRef :: RawStackArg -&gt; StackRef
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackRef"><span class="hs-identifier hs-var">stackRef</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682858380"><span class="annot"><span class="annottext">StackRef
</span><a href="#local-6989586621682858380"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4007"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StackRef
</span><a href="#local-6989586621682858380"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4008"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InReg"><span class="hs-identifier hs-type">InReg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-4009"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#OnStack"><span class="hs-identifier hs-type">OnStack</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-4010"></span><span>
</span><span id="line-4011"></span><span>            </span><span class="hs-comment">-- Check an offset is valid (8-byte aligned), for assertions.</span><span>
</span><span id="line-4012"></span><span>            </span><span id="local-6989586621682858396"><span class="annot"><span class="annottext">ok :: a -&gt; Bool
</span><a href="#local-6989586621682858396"><span class="hs-identifier hs-var hs-var hs-var">ok</span></a></span></span><span> </span><span id="local-6989586621682858397"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682858397"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682858397"><span class="hs-identifier hs-var">off</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`rem`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-4013"></span><span>
</span><span id="line-4014"></span><span>            </span><span class="hs-comment">-- Tricky code: compute the stack offset to the vector data</span><span>
</span><span id="line-4015"></span><span>            </span><span class="hs-comment">-- for this argument.</span><span>
</span><span id="line-4016"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-4017"></span><span>            </span><span class="hs-comment">-- If you're confused, Note [The Windows X64 C calling convention]</span><span>
</span><span id="line-4018"></span><span>            </span><span class="hs-comment">-- contains a helpful diagram.</span><span>
</span><span id="line-4019"></span><span>            </span><span class="annot"><a href="#local-6989586621682858377"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArg"><span class="hs-identifier hs-type">StackArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-4020"></span><span>            </span><span id="local-6989586621682858377"><span class="annot"><span class="annottext">go :: Int -&gt; [StackArg] -&gt; [Maybe Int]
</span><a href="#local-6989586621682858377"><span class="hs-identifier hs-var hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-4021"></span><span>            </span><span class="annot"><a href="#local-6989586621682858377"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682858399"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858399"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682858400"><span class="annot"><span class="annottext">StackArg
</span><a href="#local-6989586621682858400"><span class="hs-identifier hs-var">stk_arg</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682858401"><span class="annot"><span class="annottext">[StackArg]
</span><a href="#local-6989586621682858401"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4022"></span><span>              </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; [Maybe Int] -&gt; [Maybe Int]
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Bool
forall {a}. Integral a =&gt; a -&gt; Bool
</span><a href="#local-6989586621682858396"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858399"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unaligned offset:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858399"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Maybe Int] -&gt; [Maybe Int]) -&gt; [Maybe Int] -&gt; [Maybe Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-4023"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StackArg
</span><a href="#local-6989586621682858400"><span class="hs-identifier hs-var">stk_arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4024"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArg"><span class="hs-identifier hs-type">StackArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-4025"></span><span>                  </span><span class="hs-comment">-- Only account for the stack pointer movement.</span><span>
</span><span id="line-4026"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858402"><span class="annot"><span class="annottext">off' :: Int
</span><a href="#local-6989586621682858402"><span class="hs-identifier hs-var hs-var">off'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858399"><span class="hs-identifier hs-var">off</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; StackArg -&gt; Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackArgSpace"><span class="hs-identifier hs-var">stackArgSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858376"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">StackArg
</span><a href="#local-6989586621682858400"><span class="hs-identifier hs-var">stk_arg</span></a></span><span>
</span><span id="line-4027"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; [Maybe Int] -&gt; [Maybe Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [StackArg] -&gt; [Maybe Int]
</span><a href="#local-6989586621682858377"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858402"><span class="hs-identifier hs-var">off'</span></a></span><span> </span><span class="annot"><span class="annottext">[StackArg]
</span><a href="#local-6989586621682858401"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-4028"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#StackArgRef"><span class="hs-identifier hs-type">StackArgRef</span></a></span><span>
</span><span id="line-4029"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">stackRefArgSize :: StackArg -&gt; Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackRefArgSize"><span class="hs-identifier hs-var">stackRefArgSize</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682858403"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858403"><span class="hs-identifier hs-var">data_size</span></a></span></span><span>
</span><span id="line-4030"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stackRefArgPadding :: StackArg -&gt; Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackRefArgPadding"><span class="hs-identifier hs-var">stackRefArgPadding</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682858404"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858404"><span class="hs-identifier hs-var">data_pad</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-4031"></span><span>                  </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; [Maybe Int] -&gt; [Maybe Int]
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Bool
forall {a}. Integral a =&gt; a -&gt; Bool
</span><a href="#local-6989586621682858396"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858403"><span class="hs-identifier hs-var">data_size</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unaligned data size:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858403"><span class="hs-identifier hs-var">data_size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Maybe Int] -&gt; [Maybe Int]) -&gt; [Maybe Int] -&gt; [Maybe Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-4032"></span><span>                  </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; [Maybe Int] -&gt; [Maybe Int]
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Bool
forall {a}. Integral a =&gt; a -&gt; Bool
</span><a href="#local-6989586621682858396"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858404"><span class="hs-identifier hs-var">data_pad</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unaligned data padding:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858404"><span class="hs-identifier hs-var">data_pad</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Maybe Int] -&gt; [Maybe Int]) -&gt; [Maybe Int] -&gt; [Maybe Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-4033"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858405"><span class="annot"><span class="annottext">off' :: Int
</span><a href="#local-6989586621682858405"><span class="hs-identifier hs-var hs-var">off'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858399"><span class="hs-identifier hs-var">off</span></a></span><span>
</span><span id="line-4034"></span><span>                        </span><span class="hs-comment">-- Next piece of data is after the data for this reference</span><span>
</span><span id="line-4035"></span><span>                           </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858403"><span class="hs-identifier hs-var">data_size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858404"><span class="hs-identifier hs-var">data_pad</span></a></span><span>
</span><span id="line-4036"></span><span>                        </span><span class="hs-comment">-- ... and account for the stack pointer movement.</span><span>
</span><span id="line-4037"></span><span>                           </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; StackArg -&gt; Int
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#stackArgSpace"><span class="hs-identifier hs-var">stackArgSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858376"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">StackArg
</span><a href="#local-6989586621682858400"><span class="hs-identifier hs-var">stk_arg</span></a></span><span>
</span><span id="line-4038"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858404"><span class="hs-identifier hs-var">data_pad</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858399"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; [Maybe Int] -&gt; [Maybe Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [StackArg] -&gt; [Maybe Int]
</span><a href="#local-6989586621682858377"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858405"><span class="hs-identifier hs-var">off'</span></a></span><span> </span><span class="annot"><span class="annottext">[StackArg]
</span><a href="#local-6989586621682858401"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-4039"></span><span>
</span><span id="line-4040"></span><span>    </span><span class="hs-comment">-- end of Windows-only code</span><span>
</span><span id="line-4041"></span><span>    </span><span class="hs-comment">----------------------------</span><span>
</span><span id="line-4042"></span><span>
</span><span id="line-4043"></span><span>         </span><span class="hs-comment">-- Push the stack arguments (right to left),</span><span>
</span><span id="line-4044"></span><span>         </span><span class="hs-comment">-- including both the reference and the data for arguments passed by reference.</span><span>
</span><span id="line-4045"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682858406"><span class="annot"><a href="#local-6989586621682858406"><span class="hs-identifier hs-var">load_regs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858407"><span class="annot"><a href="#local-6989586621682858407"><span class="hs-identifier hs-var">push_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((StackArg, Maybe Int) -&gt; NatM (InstrBlock, InstrBlock))
-&gt; [(StackArg, Maybe Int)] -&gt; NatM (InstrBlock, InstrBlock)
forall (m :: * -&gt; *) (t :: * -&gt; *) b a.
(Applicative m, Foldable t, Monoid b) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m b
</span><a href="GHC.Utils.Monad.html#foldMapM"><span class="hs-identifier hs-var">foldMapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NCGConfig -&gt; (StackArg, Maybe Int) -&gt; NatM (InstrBlock, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#loadOrPushArg"><span class="hs-identifier hs-var">loadOrPushArg</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858372"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(StackArg, Maybe Int)] -&gt; [(StackArg, Maybe Int)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([(StackArg, Maybe Int)] -&gt; [(StackArg, Maybe Int)])
-&gt; [(StackArg, Maybe Int)] -&gt; [(StackArg, Maybe Int)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[StackArg] -&gt; [Maybe Int] -&gt; [(StackArg, Maybe Int)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[StackArg]
</span><a href="#local-6989586621682858374"><span class="hs-identifier hs-var">all_stk_args</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe Int]
</span><a href="#local-6989586621682858375"><span class="hs-identifier hs-var">vec_offs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4046"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858406"><span class="hs-identifier hs-type">load_regs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682858407"><span class="hs-identifier hs-type">push_args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-4047"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-4048"></span><span>    </span><span id="local-6989586621682858376"><span class="annot"><span class="annottext">platform :: Platform
</span><a href="#local-6989586621682858376"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858372"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-4049"></span><span>
</span><span id="line-4050"></span><span class="hs-comment">{- Note [The Windows X64 C calling convention]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Here are a few facts about the Windows X64 C calling convention that
are important:

  - any argument larger than 8 bytes must be passed by reference,
    and arguments smaller than 8 bytes are padded to 8 bytes.

  - the first four arguments are passed in registers:
      - floating-point scalar arguments are passed in %xmm0, %xmm1, %xmm2, %xmm3
      - other arguments are passed in %rcx, %rdx, %r8, %r9
        (this includes vector arguments, passed by reference)

    For variadic functions, it is additionally expected that floating point
    scalar arguments are copied to the corresponding integer register, e.g.
    the data in xmm2 should also be copied to r8.

    There is no requirement about setting %al like there is for the
    System V AMD64 ABI.

  - subsequent arguments are passed on the stack.

There are also alignment requirements:

  - the data for vectors must be aligned to the size of the vector,
    e.g. a 32 byte vector must be aligned on a 32 byte boundary,

  - the call instruction must be aligned to 16 bytes.
  (This differs from the System V AMD64 ABI, which mandates that the call
  instruction must be aligned to 32 bytes if there are any 32 byte vectors
  passed on the stack.)

This motivates our handling of vector values. Suppose we have a function call
with many arguments, several of them being vectors. We proceed as follows:

 - Add some padding, if necessary, to ensure the stack, when executing the call
    instruction, is 16-byte aligned. Whether this padding is necessary depends
    on what happens next. (Recall also that we start off at 8 (mod 16) alignment,
    as per Note [Stack Alignment on X86] in rts/StgCRun.c)
  - Push all the vectors to the stack first, adding padding after each one
    if necessary.
  - Then push the arguments:
      - for non-vectors, proceed as usual,
      - for vectors, push the address of the vector data we pushed above.
  - Then assign the registers:
      - for non-vectors, proceed as usual,
      - for vectors, store the address in a general-purpose register, as opposed
        to storing the data in an xmm register.

For a concrete example, suppose we have a call of the form:

  f x1 x2 x3 x4 x5 x6 x7

in which:

  - x2, x3, x5 and x7 are 16 byte vectors
  - the other arguments are all 8 byte wide

Now, x1, x2, x3, x4 will get passed in registers, except that we pass
x2 and x3 by reference, because they are vectors. We proceed as follows:

  - push the vectors to the stack: x7, x5, x3, x2 (in that order)
  - push the stack arguments in order: addr(x7), x6, addr(x5)
  - load the remaining arguments into registers: x4, addr(x3), addr(x2), x1

The tricky part is to get the right offsets for the addresses of the vector
data. The following visualisation will hopefully clear things up:

                                  &#9484;&#9472;&#9472;&#9488;
                                  &#9474;&#9619;&#9619;&#9474; &#9472;&#9472;&#9472; padding to align the call instruction
                      &#9581;&#9472;&#9588;         &#9566;&#9552;&#9552;&#9569;     (ensures Sp, below, is 16-byte aligned)
                      &#9474;           &#9474;  &#9474;
                      &#9474;  x7  &#9472;&#9472;&#9472;&#9588; &#9474;  &#9474;
                      &#9474;           &#9500;&#9472;&#9472;&#9508;
                      &#9474;           &#9474;  &#9474;
                      &#9474;  x5  &#9472;&#9472;&#9472;&#9588; &#9474;  &#9474;
                      &#9474;           &#9500;&#9472;&#9472;&#9508;
     vector data  &#9472;&#9472;&#9472;&#9472;&#9508;           &#9474;  &#9474;
(individually padded) &#9474;  x3  &#9472;&#9472;&#9472;&#9588; &#9474;  &#9474;
                      &#9474;           &#9500;&#9472;&#9472;&#9508;
                      &#9474;           &#9474;  &#9474;
                      &#9474;  x2  &#9472;&#9472;&#9472;&#9588; &#9474;  &#9474;
                      &#9474;           &#9500;&#9476;&#9476;&#9508;
                      &#9474;           &#9474;&#9619;&#9619;&#9474; &#9472;&#9472;&#9472; padding to align x2 to 16 bytes
               &#9581;&#9472;&#9588;    &#9584;&#9472;&#9588;         &#9566;&#9552;&#9552;&#9569;
               &#9474;    addr(x7) &#9472;&#9472;&#9472;&#9588; &#9474;  &#9474;    &#9581;&#9472; from here: x7 is +64
               &#9474;                  &#9500;&#9472;&#9472;&#9508; &#9598;&#9472;&#9472;&#9583;    = 64 (position of x5)
     stack  &#9472;&#9472;&#9472;&#9508;         x6  &#9472;&#9472;&#9472;&#9588; &#9474;  &#9474;         + 16 (size of x5) + 0 (padding of x7)
   arguments   &#9474;                  &#9500;&#9472;&#9472;&#9508;         - 2 * 8 (x7 is 2 arguments higher than x5)
               &#9474;    addr(x5) &#9472;&#9472;&#9472;&#9588; &#9474;  &#9474;
               &#9584;&#9472;&#9588;            &#9581;&#9472;&#9588; &#9566;&#9552;&#9552;&#9569; &#9598;&#9472;&#9472;&#9472; from here:
                              &#9474;   &#9474;  &#9474;       - x2 is +32 = 24 (stack_arg_size) + 8 (padding of x2)
                   shadow  &#9472;&#9472;&#9472;&#9508;   &#9474;  &#9474;       - x3 is +48 = 32 (position of x2) + 16 (size of x2) + 0 (padding of x3)
                    space     &#9474;   &#9474;  &#9474;       - x5 is +64 = 48 (position of x3) + 16 (size of x3) + 0 (padding of x5)
                              &#9474;   &#9474;  &#9474;
                              &#9584;&#9472;&#9588; &#9492;&#9472;&#9472;&#9496; &#9598;&#9472;&#9472;&#9472; Sp

This is all tested in the simd013 test.
-}</span><span>
</span><span id="line-4149"></span><span>
</span><span id="line-4150"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-4151"></span><span class="hs-comment">-- Generating a table-branch</span><span>
</span><span id="line-4152"></span><span>
</span><span id="line-4153"></span><span class="hs-comment">{-
Note [Sub-word subtlety during jump-table indexing]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Offset the index by the start index of the jump table.
It's important that we do this *before* the widening below. To see
why, consider a switch with a sub-word, signed discriminant such as:

    switch [-5...+2] x::I16 {
        case -5: ...
        ...
        case +2: ...
    }

Consider what happens if we offset *after* widening in the case that
x=-4:

                                         // x == -4 == 0xfffc::I16
    indexWidened = UU_Conv(x);           // == 0xfffc::I64
    indexExpr    = indexWidened - (-5);  // == 0x10000::I64

This index is clearly nonsense given that the jump table only has
eight entries.

By contrast, if we widen *after* we offset then we get the correct
index (1),

                                         // x == -4 == 0xfffc::I16
    indexOffset  = x - (-5);             // == 1::I16
    indexExpr    = UU_Conv(indexOffset); // == 1::I64

See #21186.
-}</span><span>
</span><span id="line-4185"></span><span>
</span><span id="line-4186"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSwitch"><span class="hs-identifier hs-type">genSwitch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Switch.html#SwitchTargets"><span class="hs-identifier hs-type">SwitchTargets</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4187"></span><span>
</span><span id="line-4188"></span><span id="genSwitch"><span class="annot"><span class="annottext">genSwitch :: CmmExpr -&gt; SwitchTargets -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genSwitch"><span class="hs-identifier hs-var hs-var">genSwitch</span></a></span></span><span> </span><span id="local-6989586621682858408"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858408"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621682858409"><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682858409"><span class="hs-identifier hs-var">targets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4189"></span><span>  </span><span id="local-6989586621682858410"><span class="annot"><a href="#local-6989586621682858410"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-4190"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858411"><span class="annot"><a href="#local-6989586621682858411"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858410"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-4191"></span><span>      </span><span id="local-6989586621682858412"><span class="annot"><a href="#local-6989586621682858412"><span class="hs-identifier hs-var hs-var">expr_w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Width
</span><a href="GHC.Cmm.Expr.html#cmmExprWidth"><span class="hs-identifier hs-var">cmmExprWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858411"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858408"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-4192"></span><span>      </span><span id="local-6989586621682858413"><span class="annot"><a href="#local-6989586621682858413"><span class="hs-identifier hs-var hs-var">indexExpr0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Int -&gt; CmmExpr
</span><a href="GHC.Cmm.Utils.html#cmmOffset"><span class="hs-identifier hs-var">cmmOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858411"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858408"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858415"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-4193"></span><span>      </span><span class="hs-comment">-- We widen to a native-width register because we cannot use arbitrary sizes</span><span>
</span><span id="line-4194"></span><span>      </span><span class="hs-comment">-- in x86 addressing modes.</span><span>
</span><span id="line-4195"></span><span>      </span><span class="hs-comment">-- See Note [Sub-word subtlety during jump-table indexing].</span><span>
</span><span id="line-4196"></span><span>      </span><span id="local-6989586621682858416"><span class="annot"><a href="#local-6989586621682858416"><span class="hs-identifier hs-var hs-var">indexExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span>
</span><span id="line-4197"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-var">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858412"><span class="hs-identifier hs-var">expr_w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Width
</span><a href="GHC.CmmToAsm.Config.html#platformWordWidth"><span class="hs-identifier hs-var">platformWordWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858411"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4198"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858413"><span class="hs-identifier hs-var">indexExpr0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4199"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgPIC"><span class="hs-identifier hs-var">ncgPIC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858410"><span class="hs-identifier hs-type">config</span></a></span><span>
</span><span id="line-4200"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4201"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682858418"><span class="annot"><a href="#local-6989586621682858418"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682858419"><span class="annot"><a href="#local-6989586621682858419"><span class="hs-identifier hs-var">e_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-type">getNonClobberedReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858416"><span class="hs-identifier hs-type">indexExpr</span></a></span><span>
</span><span id="line-4202"></span><span>           </span><span class="hs-comment">-- getNonClobberedReg because it needs to survive across t_code</span><span>
</span><span id="line-4203"></span><span>        </span><span id="local-6989586621682858420"><span class="annot"><a href="#local-6989586621682858420"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewLabelNat"><span class="hs-identifier hs-type">getNewLabelNat</span></a></span><span>
</span><span id="line-4204"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858421"><span class="annot"><a href="#local-6989586621682858421"><span class="hs-identifier hs-var hs-var">is32bit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Bool
</span><a href="GHC.Platform.html#target32Bit"><span class="hs-identifier hs-var">target32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858411"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-4205"></span><span>            </span><span id="local-6989586621682858422"><span class="annot"><a href="#local-6989586621682858422"><span class="hs-identifier hs-var hs-var">os</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858411"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-4206"></span><span>            </span><span class="hs-comment">-- Might want to use .rodata.&lt;function we're in&gt; instead, but as</span><span>
</span><span id="line-4207"></span><span>            </span><span class="hs-comment">-- long as it's something unique it'll work out since the</span><span>
</span><span id="line-4208"></span><span>            </span><span class="hs-comment">-- references to the jump table are in the appropriate section.</span><span>
</span><span id="line-4209"></span><span>            </span><span id="local-6989586621682858423"><span class="annot"><a href="#local-6989586621682858423"><span class="hs-identifier hs-var hs-var">rosection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="#local-6989586621682858422"><span class="hs-identifier hs-var">os</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4210"></span><span>              </span><span class="hs-comment">-- on Mac OS X/x86_64, put the jump table in the text section to</span><span>
</span><span id="line-4211"></span><span>              </span><span class="hs-comment">-- work around a limitation of the linker.</span><span>
</span><span id="line-4212"></span><span>              </span><span class="hs-comment">-- ld64 is unable to handle the relocations for</span><span>
</span><span id="line-4213"></span><span>              </span><span class="hs-comment">--     .quad L1 - L0</span><span>
</span><span id="line-4214"></span><span>              </span><span class="hs-comment">-- if L0 is not preceded by a non-anonymous label in its section.</span><span>
</span><span id="line-4215"></span><span>              </span><span class="annot"><span class="annottext">OS
</span><span class="hs-identifier hs-var">OSDarwin</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858421"><span class="hs-identifier hs-var">is32bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SectionType -&gt; CLabel -&gt; Section
</span><a href="GHC.Cmm.html#Section"><span class="hs-identifier hs-var">Section</span></a></span><span> </span><span class="annot"><span class="annottext">SectionType
</span><a href="GHC.Cmm.html#Text"><span class="hs-identifier hs-var">Text</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858420"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-4216"></span><span>              </span><span class="annot"><span class="annottext">OS
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SectionType -&gt; CLabel -&gt; Section
</span><a href="GHC.Cmm.html#Section"><span class="hs-identifier hs-var">Section</span></a></span><span> </span><span class="annot"><span class="annottext">SectionType
</span><a href="GHC.Cmm.html#ReadOnlyData"><span class="hs-identifier hs-var">ReadOnlyData</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858420"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-4217"></span><span>        </span><span id="local-6989586621682858426"><span class="annot"><a href="#local-6989586621682858426"><span class="hs-identifier hs-var">dynRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#cmmMakeDynamicReference"><span class="hs-identifier hs-type">cmmMakeDynamicReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858410"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#DataReference"><span class="hs-identifier hs-type">DataReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858420"><span class="hs-identifier hs-type">lbl</span></a></span><span>
</span><span id="line-4218"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682858427"><span class="annot"><a href="#local-6989586621682858427"><span class="hs-identifier hs-var">tableReg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682858428"><span class="annot"><a href="#local-6989586621682858428"><span class="hs-identifier hs-var">t_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858426"><span class="hs-identifier hs-type">dynRef</span></a></span><span>
</span><span id="line-4219"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858429"><span class="annot"><a href="#local-6989586621682858429"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858427"><span class="hs-identifier hs-var">tableReg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4220"></span><span>                                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Int -&gt; EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndex"><span class="hs-identifier hs-var">EAIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858418"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Int
</span><a href="GHC.Platform.html#platformWordSizeInBytes"><span class="hs-identifier hs-var">platformWordSizeInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858411"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4221"></span><span>
</span><span id="line-4222"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858419"><span class="hs-identifier hs-type">e_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858428"><span class="hs-identifier hs-type">t_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-4223"></span><span>                                </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-type">ADD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#platformWordWidth"><span class="hs-identifier hs-type">platformWordWidth</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858411"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682858429"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858427"><span class="hs-identifier hs-type">tableReg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-4224"></span><span>                                </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JMP_TBL"><span class="hs-identifier hs-type">JMP_TBL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858427"><span class="hs-identifier hs-type">tableReg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682858431"><span class="hs-identifier hs-type">ids</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858423"><span class="hs-identifier hs-type">rosection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858420"><span class="hs-identifier hs-type">lbl</span></a></span><span>
</span><span id="line-4225"></span><span>                       </span><span class="hs-special">]</span><span>
</span><span id="line-4226"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4227"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682858432"><span class="annot"><a href="#local-6989586621682858432"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682858433"><span class="annot"><a href="#local-6989586621682858433"><span class="hs-identifier hs-var">e_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858416"><span class="hs-identifier hs-type">indexExpr</span></a></span><span>
</span><span id="line-4228"></span><span>        </span><span id="local-6989586621682858434"><span class="annot"><a href="#local-6989586621682858434"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewLabelNat"><span class="hs-identifier hs-type">getNewLabelNat</span></a></span><span>
</span><span id="line-4229"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858435"><span class="annot"><a href="#local-6989586621682858435"><span class="hs-identifier hs-var hs-var">is32bit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Bool
</span><a href="GHC.Platform.html#target32Bit"><span class="hs-identifier hs-var">target32Bit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858411"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-4230"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682858435"><span class="hs-identifier hs-type">is32bit</span></a></span><span>
</span><span id="line-4231"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858436"><span class="annot"><a href="#local-6989586621682858436"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="annot"><span class="annottext">EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseNone"><span class="hs-identifier hs-var">EABaseNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Int -&gt; EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndex"><span class="hs-identifier hs-var">EAIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858432"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Int
</span><a href="GHC.Platform.html#platformWordSizeInBytes"><span class="hs-identifier hs-var">platformWordSizeInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858411"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmCLbl"><span class="hs-identifier hs-var">ImmCLbl</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858434"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4232"></span><span>                   </span><span id="local-6989586621682858438"><span class="annot"><a href="#local-6989586621682858438"><span class="hs-identifier hs-var hs-var">jmp_code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Operand -&gt; [Maybe JumpDest] -&gt; Section -&gt; CLabel -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JMP_TBL"><span class="hs-identifier hs-var">JMP_TBL</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858436"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe JumpDest]
</span><a href="#local-6989586621682858431"><span class="hs-identifier hs-var">ids</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SectionType -&gt; CLabel -&gt; Section
</span><a href="GHC.Cmm.html#Section"><span class="hs-identifier hs-var">Section</span></a></span><span> </span><span class="annot"><span class="annottext">SectionType
</span><a href="GHC.Cmm.html#ReadOnlyData"><span class="hs-identifier hs-var">ReadOnlyData</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858434"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858434"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-4233"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858433"><span class="hs-identifier hs-type">e_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858438"><span class="hs-identifier hs-type">jmp_code</span></a></span><span>
</span><span id="line-4234"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4235"></span><span>            </span><span class="hs-comment">-- See Note [%rip-relative addressing on x86-64].</span><span>
</span><span id="line-4236"></span><span>            </span><span id="local-6989586621682858439"><span class="annot"><a href="#local-6989586621682858439"><span class="hs-identifier hs-var">tableReg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#platformWordWidth"><span class="hs-identifier hs-type">platformWordWidth</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858411"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4237"></span><span>            </span><span id="local-6989586621682858440"><span class="annot"><a href="#local-6989586621682858440"><span class="hs-identifier hs-var">targetReg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#platformWordWidth"><span class="hs-identifier hs-type">platformWordWidth</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858411"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4238"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858441"><span class="annot"><a href="#local-6989586621682858441"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858439"><span class="hs-identifier hs-var">tableReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Int -&gt; EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndex"><span class="hs-identifier hs-var">EAIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858432"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Int
</span><a href="GHC.Platform.html#platformWordSizeInBytes"><span class="hs-identifier hs-var">platformWordSizeInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858411"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4239"></span><span>                </span><span id="local-6989586621682858442"><span class="annot"><a href="#local-6989586621682858442"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Format
</span><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-var">archWordFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858435"><span class="hs-identifier hs-var">is32bit</span></a></span><span>
</span><span id="line-4240"></span><span>                </span><span id="local-6989586621682858443"><span class="annot"><a href="#local-6989586621682858443"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858433"><span class="hs-identifier hs-var">e_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-4241"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LEA"><span class="hs-identifier hs-var">LEA</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858442"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="annot"><span class="annottext">EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseRip"><span class="hs-identifier hs-var">EABaseRip</span></a></span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmCLbl"><span class="hs-identifier hs-var">ImmCLbl</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858434"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858439"><span class="hs-identifier hs-var">tableReg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4242"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858442"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858441"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858440"><span class="hs-identifier hs-var">targetReg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4243"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Operand -&gt; [Maybe JumpDest] -&gt; Section -&gt; CLabel -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JMP_TBL"><span class="hs-identifier hs-var">JMP_TBL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858440"><span class="hs-identifier hs-var">targetReg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe JumpDest]
</span><a href="#local-6989586621682858431"><span class="hs-identifier hs-var">ids</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SectionType -&gt; CLabel -&gt; Section
</span><a href="GHC.Cmm.html#Section"><span class="hs-identifier hs-var">Section</span></a></span><span> </span><span class="annot"><span class="annottext">SectionType
</span><a href="GHC.Cmm.html#ReadOnlyData"><span class="hs-identifier hs-var">ReadOnlyData</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858434"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858434"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-4244"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-4245"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682858443"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-4246"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-4247"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682858415"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858415"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858444"><span class="annot"><span class="annottext">[Maybe Label]
</span><a href="#local-6989586621682858444"><span class="hs-identifier hs-var">blockIds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SwitchTargets -&gt; (Int, [Maybe Label])
</span><a href="GHC.Cmm.Switch.html#switchTargetsToTable"><span class="hs-identifier hs-var">switchTargetsToTable</span></a></span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682858409"><span class="hs-identifier hs-var">targets</span></a></span><span>
</span><span id="line-4248"></span><span>    </span><span id="local-6989586621682858431"><span class="annot"><span class="annottext">ids :: [Maybe JumpDest]
</span><a href="#local-6989586621682858431"><span class="hs-identifier hs-var hs-var">ids</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe Label -&gt; Maybe JumpDest)
-&gt; [Maybe Label] -&gt; [Maybe JumpDest]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Label -&gt; JumpDest) -&gt; Maybe Label -&gt; Maybe JumpDest
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; JumpDest
</span><a href="GHC.CmmToAsm.X86.Instr.html#DestBlockId"><span class="hs-identifier hs-var">DestBlockId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe Label]
</span><a href="#local-6989586621682858444"><span class="hs-identifier hs-var">blockIds</span></a></span><span>
</span><span id="line-4249"></span><span>
</span><span id="line-4250"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#generateJumpTableForInstr"><span class="hs-identifier hs-type">generateJumpTableForInstr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatCmmDecl"><span class="hs-identifier hs-type">NatCmmDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmStatics"><span class="hs-identifier hs-type">RawCmmStatics</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4251"></span><span id="generateJumpTableForInstr"><span class="annot"><span class="annottext">generateJumpTableForInstr :: NCGConfig
-&gt; Instr -&gt; Maybe (NatCmmDecl (Alignment, RawCmmStatics) Instr)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#generateJumpTableForInstr"><span class="hs-identifier hs-var hs-var">generateJumpTableForInstr</span></a></span></span><span> </span><span id="local-6989586621682858447"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858447"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JMP_TBL"><span class="hs-identifier hs-type">JMP_TBL</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682858448"><span class="annot"><span class="annottext">[Maybe JumpDest]
</span><a href="#local-6989586621682858448"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span id="local-6989586621682858449"><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682858449"><span class="hs-identifier hs-var">section</span></a></span></span><span> </span><span id="local-6989586621682858450"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858450"><span class="hs-identifier hs-var">lbl</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-4252"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858453"><span class="annot"><span class="annottext">getBlockId :: JumpDest -&gt; Label
</span><a href="#local-6989586621682858453"><span class="hs-identifier hs-var hs-var">getBlockId</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#DestBlockId"><span class="hs-identifier hs-type">DestBlockId</span></a></span><span> </span><span id="local-6989586621682858454"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858454"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858454"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-4253"></span><span>          </span><span class="annot"><a href="#local-6989586621682858453"><span class="hs-identifier hs-var">getBlockId</span></a></span><span> </span><span class="annot"><span class="annottext">JumpDest
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-Label target in Jump Table&quot;</span></span><span>
</span><span id="line-4254"></span><span>          </span><span id="local-6989586621682858455"><span class="annot"><span class="annottext">blockIds :: [Maybe Label]
</span><a href="#local-6989586621682858455"><span class="hs-identifier hs-var hs-var">blockIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe JumpDest -&gt; Maybe Label)
-&gt; [Maybe JumpDest] -&gt; [Maybe Label]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(JumpDest -&gt; Label) -&gt; Maybe JumpDest -&gt; Maybe Label
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">JumpDest -&gt; Label
</span><a href="#local-6989586621682858453"><span class="hs-identifier hs-var">getBlockId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe JumpDest]
</span><a href="#local-6989586621682858448"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-4255"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">NatCmmDecl (Alignment, RawCmmStatics) Instr
-&gt; Maybe (NatCmmDecl (Alignment, RawCmmStatics) Instr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NCGConfig
-&gt; [Maybe Label]
-&gt; Section
-&gt; CLabel
-&gt; NatCmmDecl (Alignment, RawCmmStatics) Instr
forall h g.
NCGConfig
-&gt; [Maybe Label]
-&gt; Section
-&gt; CLabel
-&gt; GenCmmDecl (Alignment, RawCmmStatics) h g
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#createJumpTable"><span class="hs-identifier hs-var">createJumpTable</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858447"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe Label]
</span><a href="#local-6989586621682858455"><span class="hs-identifier hs-var">blockIds</span></a></span><span> </span><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682858449"><span class="hs-identifier hs-var">section</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858450"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4256"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#generateJumpTableForInstr"><span class="hs-identifier hs-var">generateJumpTableForInstr</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Instr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (NatCmmDecl (Alignment, RawCmmStatics) Instr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-4257"></span><span>
</span><span id="line-4258"></span><span id="local-6989586621682853874"><span id="local-6989586621682853875"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#createJumpTable"><span class="hs-identifier hs-type">createJumpTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.html#Section"><span class="hs-identifier hs-type">Section</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a></span><span>
</span><span id="line-4259"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.html#GenCmmDecl"><span class="hs-identifier hs-type">GenCmmDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmStatics"><span class="hs-identifier hs-type">RawCmmStatics</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682853874"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682853875"><span class="hs-identifier hs-type">g</span></a></span></span></span><span>
</span><span id="line-4260"></span><span id="createJumpTable"><span class="annot"><span class="annottext">createJumpTable :: forall h g.
NCGConfig
-&gt; [Maybe Label]
-&gt; Section
-&gt; CLabel
-&gt; GenCmmDecl (Alignment, RawCmmStatics) h g
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#createJumpTable"><span class="hs-identifier hs-var hs-var">createJumpTable</span></a></span></span><span> </span><span id="local-6989586621682858457"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858457"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621682858458"><span class="annot"><span class="annottext">[Maybe Label]
</span><a href="#local-6989586621682858458"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span id="local-6989586621682858459"><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682858459"><span class="hs-identifier hs-var">section</span></a></span></span><span> </span><span id="local-6989586621682858460"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858460"><span class="hs-identifier hs-var">lbl</span></a></span></span><span>
</span><span id="line-4261"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858461"><span class="annot"><span class="annottext">jumpTable :: [CmmStatic]
</span><a href="#local-6989586621682858461"><span class="hs-identifier hs-var hs-var">jumpTable</span></a></span></span><span>
</span><span id="line-4262"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Bool
</span><a href="GHC.CmmToAsm.Config.html#ncgPIC"><span class="hs-identifier hs-var">ncgPIC</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858457"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4263"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858462"><span class="annot"><span class="annottext">ww :: Width
</span><a href="#local-6989586621682858462"><span class="hs-identifier hs-var hs-var">ww</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Width
</span><a href="GHC.CmmToAsm.Config.html#ncgWordWidth"><span class="hs-identifier hs-var">ncgWordWidth</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858457"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-4264"></span><span>                      </span><span id="local-6989586621682858463"><span class="annot"><span class="annottext">jumpTableEntryRel :: Maybe Label -&gt; CmmStatic
</span><a href="#local-6989586621682858463"><span class="hs-identifier hs-var hs-var">jumpTableEntryRel</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Label
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-4265"></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmStatic
</span><a href="GHC.Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858462"><span class="hs-identifier hs-var">ww</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4266"></span><span>                      </span><span class="annot"><a href="#local-6989586621682858463"><span class="hs-identifier hs-var">jumpTableEntryRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682858464"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858464"><span class="hs-identifier hs-var">blockid</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-4267"></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmStatic
</span><a href="GHC.Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; CLabel -&gt; Int -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmLabelDiffOff"><span class="hs-identifier hs-var">CmmLabelDiffOff</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858465"><span class="hs-identifier hs-var">blockLabel</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858460"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858462"><span class="hs-identifier hs-var">ww</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4268"></span><span>                          </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682858465"><span class="annot"><span class="annottext">blockLabel :: CLabel
</span><a href="#local-6989586621682858465"><span class="hs-identifier hs-var hs-var">blockLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; CLabel
</span><a href="GHC.Cmm.BlockId.html#blockLbl"><span class="hs-identifier hs-var">blockLbl</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858464"><span class="hs-identifier hs-var">blockid</span></a></span><span>
</span><span id="line-4269"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Maybe Label -&gt; CmmStatic) -&gt; [Maybe Label] -&gt; [CmmStatic]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Maybe Label -&gt; CmmStatic
</span><a href="#local-6989586621682858463"><span class="hs-identifier hs-var">jumpTableEntryRel</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe Label]
</span><a href="#local-6989586621682858458"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-4270"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe Label -&gt; CmmStatic) -&gt; [Maybe Label] -&gt; [CmmStatic]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NCGConfig -&gt; Maybe Label -&gt; CmmStatic
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#jumpTableEntry"><span class="hs-identifier hs-var">jumpTableEntry</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858457"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe Label]
</span><a href="#local-6989586621682858458"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-4271"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Section
-&gt; (Alignment, RawCmmStatics)
-&gt; GenCmmDecl (Alignment, RawCmmStatics) h g
forall d h g. Section -&gt; d -&gt; GenCmmDecl d h g
</span><a href="GHC.Cmm.html#CmmData"><span class="hs-identifier hs-var">CmmData</span></a></span><span> </span><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682858459"><span class="hs-identifier hs-var">section</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Alignment
</span><a href="GHC.Types.Basic.html#mkAlignment"><span class="hs-identifier hs-var">mkAlignment</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CLabel -&gt; [CmmStatic] -&gt; RawCmmStatics
forall (rawOnly :: Bool).
CLabel -&gt; [CmmStatic] -&gt; GenCmmStatics rawOnly
</span><a href="GHC.Cmm.html#CmmStaticsRaw"><span class="hs-identifier hs-var">CmmStaticsRaw</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858460"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmStatic]
</span><a href="#local-6989586621682858461"><span class="hs-identifier hs-var">jumpTable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4272"></span><span>
</span><span id="line-4273"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#extractUnwindPoints"><span class="hs-identifier hs-type">extractUnwindPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#UnwindPoint"><span class="hs-identifier hs-type">UnwindPoint</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4274"></span><span id="extractUnwindPoints"><span class="annot"><span class="annottext">extractUnwindPoints :: [Instr] -&gt; [UnwindPoint]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#extractUnwindPoints"><span class="hs-identifier hs-var hs-var">extractUnwindPoints</span></a></span></span><span> </span><span id="local-6989586621682858466"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682858466"><span class="hs-identifier hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4275"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">CLabel -&gt; Map GlobalReg (Maybe UnwindExpr) -&gt; UnwindPoint
</span><a href="GHC.Cmm.DebugBlock.html#UnwindPoint"><span class="hs-identifier hs-var">UnwindPoint</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858468"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">Map GlobalReg (Maybe UnwindExpr)
</span><a href="#local-6989586621682858469"><span class="hs-identifier hs-var">unwinds</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#UNWIND"><span class="hs-identifier hs-type">UNWIND</span></a></span><span> </span><span id="local-6989586621682858468"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682858468"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621682858469"><span class="annot"><span class="annottext">Map GlobalReg (Maybe UnwindExpr)
</span><a href="#local-6989586621682858469"><span class="hs-identifier hs-var">unwinds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682858466"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4276"></span><span>
</span><span id="line-4277"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-4278"></span><span class="hs-comment">-- 'condIntReg' and 'condFltReg': condition codes into registers</span><span>
</span><span id="line-4279"></span><span>
</span><span id="line-4280"></span><span class="hs-comment">-- Turn those condition codes into integers now (when they appear on</span><span>
</span><span id="line-4281"></span><span class="hs-comment">-- the right hand side of an assignment).</span><span>
</span><span id="line-4282"></span><span class="hs-comment">--</span><span>
</span><span id="line-4283"></span><span class="hs-comment">-- (If applicable) Do not fill the delay slots here; you will confuse the</span><span>
</span><span id="line-4284"></span><span class="hs-comment">-- register allocator.</span><span>
</span><span id="line-4285"></span><span>
</span><span id="line-4286"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-type">condIntReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-4287"></span><span>
</span><span id="line-4288"></span><span id="condIntReg"><span class="annot"><span class="annottext">condIntReg :: Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntReg"><span class="hs-identifier hs-var hs-var">condIntReg</span></a></span></span><span> </span><span id="local-6989586621682858470"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682858470"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682858471"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858471"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682858472"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858472"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4289"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682858473"><span class="annot"><a href="#local-6989586621682858473"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682858474"><span class="annot"><a href="#local-6989586621682858474"><span class="hs-identifier hs-var">cond_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condIntCode"><span class="hs-identifier hs-var">condIntCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682858470"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858471"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858472"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-4290"></span><span>  </span><span id="local-6989586621682858475"><span class="annot"><a href="#local-6989586621682858475"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span>
</span><span id="line-4291"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-4292"></span><span>        </span><span id="local-6989586621682858476"><span class="annot"><a href="#local-6989586621682858476"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682858477"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858477"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858474"><span class="hs-identifier hs-var">cond_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-4293"></span><span>                    </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682858473"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858475"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-4294"></span><span>                    </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858475"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858477"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4295"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-4296"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858476"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4297"></span><span>
</span><span id="line-4298"></span><span>
</span><span id="line-4299"></span><span class="hs-comment">-- Note [SSE Parity Checks]</span><span>
</span><span id="line-4300"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-4301"></span><span class="hs-comment">-- We have to worry about unordered operands (eg. comparisons</span><span>
</span><span id="line-4302"></span><span class="hs-comment">-- against NaN).  If the operands are unordered, the comparison</span><span>
</span><span id="line-4303"></span><span class="hs-comment">-- sets the parity flag, carry flag and zero flag.</span><span>
</span><span id="line-4304"></span><span class="hs-comment">-- All comparisons are supposed to return false for unordered</span><span>
</span><span id="line-4305"></span><span class="hs-comment">-- operands except for !=, which returns true.</span><span>
</span><span id="line-4306"></span><span class="hs-comment">--</span><span>
</span><span id="line-4307"></span><span class="hs-comment">-- Optimisation: we don't have to test the parity flag if we</span><span>
</span><span id="line-4308"></span><span class="hs-comment">-- know the test has already excluded the unordered case: eg &gt;</span><span>
</span><span id="line-4309"></span><span class="hs-comment">-- and &gt;= test for a zero carry flag, which can only occur for</span><span>
</span><span id="line-4310"></span><span class="hs-comment">-- ordered operands.</span><span>
</span><span id="line-4311"></span><span class="hs-comment">--</span><span>
</span><span id="line-4312"></span><span class="hs-comment">-- By reversing comparisons we can avoid testing the parity</span><span>
</span><span id="line-4313"></span><span class="hs-comment">-- for &lt; and &lt;= as well. If any of the arguments is an NaN we</span><span>
</span><span id="line-4314"></span><span class="hs-comment">-- return false either way. If both arguments are valid then</span><span>
</span><span id="line-4315"></span><span class="hs-comment">-- x &lt;= y  &lt;-&gt;  y &gt;= x  holds. So it's safe to swap these.</span><span>
</span><span id="line-4316"></span><span class="hs-comment">--</span><span>
</span><span id="line-4317"></span><span class="hs-comment">-- We invert the condition inside getRegister'and  getCondCode</span><span>
</span><span id="line-4318"></span><span class="hs-comment">-- which should cover all invertable cases.</span><span>
</span><span id="line-4319"></span><span class="hs-comment">-- All other functions translating FP comparisons to assembly</span><span>
</span><span id="line-4320"></span><span class="hs-comment">-- use these to two generate the comparison code.</span><span>
</span><span id="line-4321"></span><span class="hs-comment">--</span><span>
</span><span id="line-4322"></span><span class="hs-comment">-- As an example consider a simple check:</span><span>
</span><span id="line-4323"></span><span class="hs-comment">--</span><span>
</span><span id="line-4324"></span><span class="hs-comment">-- func :: Float -&gt; Float -&gt; Int</span><span>
</span><span id="line-4325"></span><span class="hs-comment">-- func x y = if x &lt; y then 1 else 0</span><span>
</span><span id="line-4326"></span><span class="hs-comment">--</span><span>
</span><span id="line-4327"></span><span class="hs-comment">-- Which in Cmm gives the floating point comparison.</span><span>
</span><span id="line-4328"></span><span class="hs-comment">--</span><span>
</span><span id="line-4329"></span><span class="hs-comment">--  if (%MO_F_Lt_W32(F1, F2)) goto c2gg; else goto c2gf;</span><span>
</span><span id="line-4330"></span><span class="hs-comment">--</span><span>
</span><span id="line-4331"></span><span class="hs-comment">-- We used to compile this to an assembly code block like this:</span><span>
</span><span id="line-4332"></span><span class="hs-comment">-- _c2gh:</span><span>
</span><span id="line-4333"></span><span class="hs-comment">--  ucomiss %xmm2,%xmm1</span><span>
</span><span id="line-4334"></span><span class="hs-comment">--  jp _c2gf</span><span>
</span><span id="line-4335"></span><span class="hs-comment">--  jb _c2gg</span><span>
</span><span id="line-4336"></span><span class="hs-comment">--  jmp _c2gf</span><span>
</span><span id="line-4337"></span><span class="hs-comment">--</span><span>
</span><span id="line-4338"></span><span class="hs-comment">-- Where we have to introduce an explicit</span><span>
</span><span id="line-4339"></span><span class="hs-comment">-- check for unordered results (using jmp parity):</span><span>
</span><span id="line-4340"></span><span class="hs-comment">--</span><span>
</span><span id="line-4341"></span><span class="hs-comment">-- We can avoid this by exchanging the arguments and inverting the direction</span><span>
</span><span id="line-4342"></span><span class="hs-comment">-- of the comparison. This results in the sequence of:</span><span>
</span><span id="line-4343"></span><span class="hs-comment">--</span><span>
</span><span id="line-4344"></span><span class="hs-comment">--  ucomiss %xmm1,%xmm2</span><span>
</span><span id="line-4345"></span><span class="hs-comment">--  ja _c2g2</span><span>
</span><span id="line-4346"></span><span class="hs-comment">--  jmp _c2g1</span><span>
</span><span id="line-4347"></span><span class="hs-comment">--</span><span>
</span><span id="line-4348"></span><span class="hs-comment">-- Removing the jump reduces the pressure on the branch prediction system</span><span>
</span><span id="line-4349"></span><span class="hs-comment">-- and plays better with the uOP cache.</span><span>
</span><span id="line-4350"></span><span>
</span><span id="line-4351"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltReg"><span class="hs-identifier hs-type">condFltReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-4352"></span><span id="condFltReg"><span class="annot"><span class="annottext">condFltReg :: Bool -&gt; Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltReg"><span class="hs-identifier hs-var hs-var">condFltReg</span></a></span></span><span> </span><span id="local-6989586621682858478"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858478"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span id="local-6989586621682858479"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682858479"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682858480"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858480"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682858481"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858481"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NatM Register
</span><a href="#local-6989586621682858482"><span class="hs-identifier hs-var">condFltReg_sse2</span></a></span><span>
</span><span id="line-4353"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4354"></span><span>
</span><span id="line-4355"></span><span>
</span><span id="line-4356"></span><span>  </span><span id="local-6989586621682858482"><span class="annot"><span class="annottext">condFltReg_sse2 :: NatM Register
</span><a href="#local-6989586621682858482"><span class="hs-identifier hs-var hs-var">condFltReg_sse2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4357"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#CondCode"><span class="hs-identifier hs-type">CondCode</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682858483"><span class="annot"><a href="#local-6989586621682858483"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682858484"><span class="annot"><a href="#local-6989586621682858484"><span class="hs-identifier hs-var">cond_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM CondCode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#condFltCode"><span class="hs-identifier hs-var">condFltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682858479"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858480"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858481"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-4358"></span><span>    </span><span id="local-6989586621682858485"><span class="annot"><a href="#local-6989586621682858485"><span class="hs-identifier hs-var">tmp1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-type">archWordFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858478"><span class="hs-identifier hs-type">is32Bit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4359"></span><span>    </span><span id="local-6989586621682858486"><span class="annot"><a href="#local-6989586621682858486"><span class="hs-identifier hs-var">tmp2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-type">archWordFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858478"><span class="hs-identifier hs-type">is32Bit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4360"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- See Note [SSE Parity Checks]</span><span>
</span><span id="line-4361"></span><span>        </span><span id="local-6989586621682858487"><span class="annot"><a href="#local-6989586621682858487"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682858488"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858488"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4362"></span><span>           </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858484"><span class="hs-identifier hs-var">cond_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4363"></span><span>             </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682858483"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4364"></span><span>                </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858489"><span class="hs-identifier hs-var">or_unordered</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858488"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4365"></span><span>                </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GU"><span class="hs-identifier hs-var">GU</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858490"><span class="hs-identifier hs-var">plain_test</span></a></span><span>   </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858488"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4366"></span><span>                </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#GEU"><span class="hs-identifier hs-var">GEU</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858490"><span class="hs-identifier hs-var">plain_test</span></a></span><span>   </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858488"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4367"></span><span>                </span><span class="hs-comment">-- Use ASSERT so we don't break releases if these creep in.</span><span>
</span><span id="line-4368"></span><span>                </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LTT"><span class="hs-identifier hs-var">LTT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; InstrBlock -&gt; InstrBlock
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Should have been turned into &gt;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(InstrBlock -&gt; InstrBlock) -&gt; InstrBlock -&gt; InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-4369"></span><span>                       </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858491"><span class="hs-identifier hs-var">and_ordered</span></a></span><span>  </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858488"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4370"></span><span>                </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#LE"><span class="hs-identifier hs-var">LE</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; InstrBlock -&gt; InstrBlock
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Should have been turned into &gt;=&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(InstrBlock -&gt; InstrBlock) -&gt; InstrBlock -&gt; InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-4371"></span><span>                       </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858491"><span class="hs-identifier hs-var">and_ordered</span></a></span><span>  </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858488"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4372"></span><span>                </span><span class="annot"><span class="annottext">Cond
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858491"><span class="hs-identifier hs-var">and_ordered</span></a></span><span>  </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858488"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4373"></span><span>
</span><span id="line-4374"></span><span>        </span><span id="local-6989586621682858490"><span class="annot"><a href="#local-6989586621682858490"><span class="hs-identifier hs-var hs-var">plain_test</span></a></span></span><span> </span><span id="local-6989586621682858492"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858492"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-4375"></span><span>                    </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682858483"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858485"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-4376"></span><span>                    </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858485"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858492"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4377"></span><span>                 </span><span class="hs-special">]</span><span>
</span><span id="line-4378"></span><span>        </span><span id="local-6989586621682858489"><span class="annot"><a href="#local-6989586621682858489"><span class="hs-identifier hs-var hs-var">or_unordered</span></a></span></span><span> </span><span id="local-6989586621682858493"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858493"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-4379"></span><span>                    </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682858483"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858485"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-4380"></span><span>                    </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#PARITY"><span class="hs-identifier hs-var">PARITY</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858486"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-4381"></span><span>                    </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858485"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858486"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-4382"></span><span>                    </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858486"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858493"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4383"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-4384"></span><span>        </span><span id="local-6989586621682858491"><span class="annot"><a href="#local-6989586621682858491"><span class="hs-identifier hs-var hs-var">and_ordered</span></a></span></span><span> </span><span id="local-6989586621682858494"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858494"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-4385"></span><span>                    </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682858483"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858485"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-4386"></span><span>                    </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NOTPARITY"><span class="hs-identifier hs-var">NOTPARITY</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858486"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-4387"></span><span>                    </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#AND"><span class="hs-identifier hs-var">AND</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858485"><span class="hs-identifier hs-var">tmp1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858486"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-4388"></span><span>                    </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858486"><span class="hs-identifier hs-var">tmp2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858494"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4389"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-4390"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858487"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4391"></span><span>
</span><span id="line-4392"></span><span>
</span><span id="line-4393"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-4394"></span><span class="hs-comment">-- 'trivial*Code': deal with trivial instructions</span><span>
</span><span id="line-4395"></span><span>
</span><span id="line-4396"></span><span class="hs-comment">-- Trivial (dyadic: 'trivialCode', floating-point: 'trivialFCode',</span><span>
</span><span id="line-4397"></span><span class="hs-comment">-- unary: 'trivialUCode', unary fl-pt:'trivialUFCode') instructions.</span><span>
</span><span id="line-4398"></span><span class="hs-comment">-- Only look for constants on the right hand side, because that's</span><span>
</span><span id="line-4399"></span><span class="hs-comment">-- where the generic optimizer will have put them.</span><span>
</span><span id="line-4400"></span><span>
</span><span id="line-4401"></span><span class="hs-comment">-- Similarly, for unary instructions, we don't have to worry about</span><span>
</span><span id="line-4402"></span><span class="hs-comment">-- matching an StInt as the argument, because genericOpt will already</span><span>
</span><span id="line-4403"></span><span class="hs-comment">-- have handled the constant-folding.</span><span>
</span><span id="line-4404"></span><span>
</span><span id="line-4405"></span><span>
</span><span id="line-4406"></span><span class="hs-comment">{-
The Rules of the Game are:

* You cannot assume anything about the destination register dst;
  it may be anything, including a fixed reg.

* You may compute an operand into a fixed reg, but you may not
  subsequently change the contents of that fixed reg.  If you
  want to do so, first copy the value either to a temporary
  or into dst.  You are free to modify dst even if it happens
  to be a fixed reg -- that's not your problem.

* You cannot assume that a fixed reg will stay live over an
  arbitrary computation.  The same applies to the dst reg.

* Temporary regs obtained from getNewRegNat are distinct from
  each other and from all other regs, and stay live over
  arbitrary computations.

--------------------

SDM's version of The Rules:

* If getRegister returns Any, that means it can generate correct
  code which places the result in any register, period.  Even if that
  register happens to be read during the computation.

  Corollary #1: this means that if you are generating code for an
  operation with two arbitrary operands, you cannot assign the result
  of the first operand into the destination register before computing
  the second operand.  The second operand might require the old value
  of the destination register.

  Corollary #2: A function might be able to generate more efficient
  code if it knows the destination register is a new temporary (and
  therefore not read by any of the sub-computations).

* If getRegister returns Any, then the code it generates may modify only:
        (a) fresh temporaries
        (b) the destination register
        (c) known registers (eg. %ecx is used by shifts)
  In particular, it may *not* modify global registers, unless the global
  register happens to be the destination register.
-}</span><span>
</span><span id="line-4450"></span><span>
</span><span id="line-4451"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode"><span class="hs-identifier hs-type">trivialCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4452"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4453"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-4454"></span><span id="trivialCode"><span class="annot"><span class="annottext">trivialCode :: Width
-&gt; (Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode"><span class="hs-identifier hs-var hs-var">trivialCode</span></a></span></span><span> </span><span id="local-6989586621682858495"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858495"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682858496"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682858496"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682858497"><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
</span><a href="#local-6989586621682858497"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682858498"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858498"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682858499"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858499"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-4455"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682858500"><span class="annot"><a href="#local-6989586621682858500"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-4456"></span><span>         </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode%27"><span class="hs-identifier hs-type">trivialCode'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858500"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858495"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858496"><span class="hs-identifier hs-type">instr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858497"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858498"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858499"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-4457"></span><span>
</span><span id="line-4458"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode%27"><span class="hs-identifier hs-type">trivialCode'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4459"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4460"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-4461"></span><span id="trivialCode%27"><span class="annot"><span class="annottext">trivialCode' :: Platform
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Instr)
-&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode%27"><span class="hs-identifier hs-var hs-var">trivialCode'</span></a></span></span><span> </span><span id="local-6989586621682858502"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858502"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682858503"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858503"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682858504"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682858504"><span class="hs-identifier hs-var">revinstr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682858505"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682858505"><span class="hs-identifier hs-var">lit_a</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682858506"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858506"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-4462"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitLit"><span class="hs-identifier hs-var">is32BitLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858502"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682858505"><span class="hs-identifier hs-var">lit_a</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4463"></span><span>  </span><span id="local-6989586621682858507"><span class="annot"><a href="#local-6989586621682858507"><span class="hs-identifier hs-var">b_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858506"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-4464"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-4465"></span><span>       </span><span id="local-6989586621682858508"><span class="annot"><a href="#local-6989586621682858508"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682858509"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858509"><span class="hs-identifier hs-var">dst</span></a></span></span><span>
</span><span id="line-4466"></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858507"><span class="hs-identifier hs-var">b_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858509"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-4467"></span><span>           </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682858504"><span class="hs-identifier hs-var">revinstr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682858505"><span class="hs-identifier hs-var">lit_a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858509"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4468"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858503"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682858508"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4469"></span><span>
</span><span id="line-4470"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode%27"><span class="hs-identifier hs-var">trivialCode'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682858510"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858510"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682858511"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682858511"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Operand -&gt; Operand -&gt; Instr)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682858512"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858512"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682858513"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858513"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-4471"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format
-&gt; (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genTrivialCode"><span class="hs-identifier hs-var">genTrivialCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858510"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682858511"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858512"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858513"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-4472"></span><span>
</span><span id="line-4473"></span><span class="hs-comment">-- This is re-used for floating pt instructions too.</span><span>
</span><span id="line-4474"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genTrivialCode"><span class="hs-identifier hs-type">genTrivialCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4475"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-4476"></span><span id="genTrivialCode"><span class="annot"><span class="annottext">genTrivialCode :: Format
-&gt; (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genTrivialCode"><span class="hs-identifier hs-var hs-var">genTrivialCode</span></a></span></span><span> </span><span id="local-6989586621682858515"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858515"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682858516"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682858516"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682858517"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858517"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682858518"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858518"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4477"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682858519"><span class="annot"><a href="#local-6989586621682858519"><span class="hs-identifier hs-var">b_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858520"><span class="annot"><a href="#local-6989586621682858520"><span class="hs-identifier hs-var">b_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand"><span class="hs-identifier hs-var">getNonClobberedOperand</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858518"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-4478"></span><span>  </span><span id="local-6989586621682858521"><span class="annot"><a href="#local-6989586621682858521"><span class="hs-identifier hs-var">a_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858517"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-4479"></span><span>  </span><span id="local-6989586621682858522"><span class="annot"><a href="#local-6989586621682858522"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858515"><span class="hs-identifier hs-type">rep</span></a></span><span>
</span><span id="line-4480"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-4481"></span><span>     </span><span class="hs-comment">-- We want the value of 'b' to stay alive across the computation of 'a'.</span><span>
</span><span id="line-4482"></span><span>     </span><span class="hs-comment">-- But, we want to calculate 'a' straight into the destination register,</span><span>
</span><span id="line-4483"></span><span>     </span><span class="hs-comment">-- because the instruction only has two operands (dst := dst `op` src).</span><span>
</span><span id="line-4484"></span><span>     </span><span class="hs-comment">-- The troublesome case is when the result of 'b' is in the same register</span><span>
</span><span id="line-4485"></span><span>     </span><span class="hs-comment">-- as the destination 'reg'.  In this case, we have to save 'b' in a</span><span>
</span><span id="line-4486"></span><span>     </span><span class="hs-comment">-- new temporary across the computation of 'a'.</span><span>
</span><span id="line-4487"></span><span>     </span><span id="local-6989586621682858523"><span class="annot"><a href="#local-6989586621682858523"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682858524"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858524"><span class="hs-identifier hs-var">dst</span></a></span></span><span>
</span><span id="line-4488"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858524"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Operand -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#regClashesWithOp"><span class="hs-operator hs-var">`regClashesWithOp`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858519"><span class="hs-identifier hs-var">b_op</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4489"></span><span>                </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858520"><span class="hs-identifier hs-var">b_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4490"></span><span>                </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858515"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858519"><span class="hs-identifier hs-var">b_op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858522"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4491"></span><span>                </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858521"><span class="hs-identifier hs-var">a_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858524"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-4492"></span><span>                </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682858516"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858522"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858524"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4493"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4494"></span><span>                </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858520"><span class="hs-identifier hs-var">b_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4495"></span><span>                </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858521"><span class="hs-identifier hs-var">a_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858524"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-4496"></span><span>                </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682858516"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858519"><span class="hs-identifier hs-var">b_op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858524"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4497"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858515"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858523"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4498"></span><span>
</span><span id="line-4499"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#regClashesWithOp"><span class="hs-identifier hs-type">regClashesWithOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-4500"></span><span id="local-6989586621682858526"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858526"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="regClashesWithOp"><span class="annot"><span class="annottext">regClashesWithOp :: Reg -&gt; Operand -&gt; Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#regClashesWithOp"><span class="hs-operator hs-var hs-var">`regClashesWithOp`</span></a></span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span id="local-6989586621682858527"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858527"><span class="hs-identifier hs-var">reg2</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858526"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858527"><span class="hs-identifier hs-var">reg2</span></a></span><span>
</span><span id="line-4501"></span><span id="local-6989586621682858528"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858528"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#regClashesWithOp"><span class="hs-operator hs-var">`regClashesWithOp`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span id="local-6989586621682858529"><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858529"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Reg -&gt; Bool) -&gt; [Reg] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858528"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; [Reg]
</span><a href="GHC.CmmToAsm.X86.Regs.html#addrModeRegs"><span class="hs-identifier hs-var">addrModeRegs</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858529"><span class="hs-identifier hs-var">amode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4502"></span><span class="annot"><span class="annottext">Reg
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#regClashesWithOp"><span class="hs-operator hs-var">`regClashesWithOp`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-4503"></span><span>
</span><span id="line-4504"></span><span class="hs-comment">-- | Generate code for a fused multiply-add operation, of the form @&#177; x * y &#177; z@,</span><span>
</span><span id="line-4505"></span><span class="hs-comment">-- with 3 operands (FMA3 instruction set).</span><span>
</span><span id="line-4506"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genFMA3Code"><span class="hs-identifier hs-type">genFMA3Code</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span>
</span><span id="line-4507"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-4508"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#FMASign"><span class="hs-identifier hs-type">FMASign</span></a></span><span>
</span><span id="line-4509"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-4510"></span><span id="genFMA3Code"><span class="annot"><span class="annottext">genFMA3Code :: Int
-&gt; Width
-&gt; FMASign
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genFMA3Code"><span class="hs-identifier hs-var hs-var">genFMA3Code</span></a></span></span><span> </span><span id="local-6989586621682858530"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858530"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682858531"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858531"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682858532"><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682858532"><span class="hs-identifier hs-var">signs</span></a></span></span><span> </span><span id="local-6989586621682858533"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858533"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682858534"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858534"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621682858535"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858535"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4511"></span><span>  </span><span id="local-6989586621682858536"><span class="annot"><a href="#local-6989586621682858536"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-4512"></span><span>  </span><span class="hs-comment">-- For the FMA instruction, we want to compute x * y + z</span><span>
</span><span id="line-4513"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-4514"></span><span>  </span><span class="hs-comment">-- There are three possible instructions we could emit:</span><span>
</span><span id="line-4515"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-4516"></span><span>  </span><span class="hs-comment">--   - fmadd213 z y x, result in x, z can be a memory address</span><span>
</span><span id="line-4517"></span><span>  </span><span class="hs-comment">--   - fmadd132 x z y, result in y, x can be a memory address</span><span>
</span><span id="line-4518"></span><span>  </span><span class="hs-comment">--   - fmadd231 y x z, result in z, y can be a memory address</span><span>
</span><span id="line-4519"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-4520"></span><span>  </span><span class="hs-comment">-- This suggests two possible optimisations:</span><span>
</span><span id="line-4521"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-4522"></span><span>  </span><span class="hs-comment">--   - OPTIMISATION 1</span><span>
</span><span id="line-4523"></span><span>  </span><span class="hs-comment">--     If one argument is an address, use the instruction that allows</span><span>
</span><span id="line-4524"></span><span>  </span><span class="hs-comment">--     a memory address in that position.</span><span>
</span><span id="line-4525"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-4526"></span><span>  </span><span class="hs-comment">--   - OPTIMISATION 2</span><span>
</span><span id="line-4527"></span><span>  </span><span class="hs-comment">--     If one argument is in a fixed register, use the instruction that puts</span><span>
</span><span id="line-4528"></span><span>  </span><span class="hs-comment">--     the result in that same register.</span><span>
</span><span id="line-4529"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-4530"></span><span>  </span><span class="hs-comment">-- Currently we follow neither of these optimisations,</span><span>
</span><span id="line-4531"></span><span>  </span><span class="hs-comment">-- opting to always use fmadd213 for simplicity.</span><span>
</span><span id="line-4532"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-4533"></span><span>  </span><span class="hs-comment">-- We would like to compute the result directly into the requested register.</span><span>
</span><span id="line-4534"></span><span>  </span><span class="hs-comment">-- To do so we must first compute `x` into the destination register. This is</span><span>
</span><span id="line-4535"></span><span>  </span><span class="hs-comment">-- only possible if the other arguments don't use the destination register.</span><span>
</span><span id="line-4536"></span><span>  </span><span class="hs-comment">-- We check for this and if there is a conflict we move the result only after</span><span>
</span><span id="line-4537"></span><span>  </span><span class="hs-comment">-- the computation. See #24496 how this went wrong in the past.</span><span>
</span><span id="line-4538"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858537"><span class="annot"><a href="#local-6989586621682858537"><span class="hs-identifier hs-var hs-var">rep</span></a></span></span><span>
</span><span id="line-4539"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858530"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-4540"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858531"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-4541"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-4542"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#vecFormat"><span class="hs-identifier hs-var">vecFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CmmType -&gt; CmmType
</span><a href="GHC.Cmm.Type.html#cmmVec"><span class="hs-identifier hs-var">cmmVec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858530"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmType -&gt; CmmType) -&gt; CmmType -&gt; CmmType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmType
</span><a href="GHC.Cmm.Type.html#cmmFloat"><span class="hs-identifier hs-var">cmmFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858531"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4543"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682858541"><span class="annot"><a href="#local-6989586621682858541"><span class="hs-identifier hs-var">y_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858542"><span class="annot"><a href="#local-6989586621682858542"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedReg"><span class="hs-identifier hs-type">getNonClobberedReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858534"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-4544"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682858543"><span class="annot"><a href="#local-6989586621682858543"><span class="hs-identifier hs-var">z_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858544"><span class="annot"><a href="#local-6989586621682858544"><span class="hs-identifier hs-var">z_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getNonClobberedOperand"><span class="hs-identifier hs-type">getNonClobberedOperand</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858535"><span class="hs-identifier hs-type">z</span></a></span><span>
</span><span id="line-4545"></span><span>  </span><span id="local-6989586621682858545"><span class="annot"><a href="#local-6989586621682858545"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858533"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-4546"></span><span>  </span><span id="local-6989586621682858546"><span class="annot"><a href="#local-6989586621682858546"><span class="hs-identifier hs-var">x_tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858537"><span class="hs-identifier hs-type">rep</span></a></span><span>
</span><span id="line-4547"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-4548"></span><span>     </span><span id="local-6989586621682858547"><span class="annot"><a href="#local-6989586621682858547"><span class="hs-identifier hs-var hs-var">fma213</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format
-&gt; FMASign -&gt; FMAPermutation -&gt; Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#FMA3"><span class="hs-identifier hs-var">FMA3</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858537"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682858532"><span class="hs-identifier hs-var">signs</span></a></span><span> </span><span class="annot"><span class="annottext">FMAPermutation
</span><a href="GHC.CmmToAsm.X86.Instr.html#FMA213"><span class="hs-identifier hs-var">FMA213</span></a></span><span>
</span><span id="line-4549"></span><span>
</span><span id="line-4550"></span><span>     </span><span class="annot"><a href="#local-6989586621682858550"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682858551"><span class="hs-identifier hs-type">code_direct</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682858552"><span class="hs-identifier hs-type">code_mov</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4551"></span><span>     </span><span class="hs-comment">-- Ideal: Compute the result directly into dst</span><span>
</span><span id="line-4552"></span><span>     </span><span id="local-6989586621682858551"><span class="annot"><a href="#local-6989586621682858551"><span class="hs-identifier hs-var hs-var">code_direct</span></a></span></span><span> </span><span id="local-6989586621682858553"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858553"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858545"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858553"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-4553"></span><span>                       </span><span class="annot"><span class="annottext">Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="#local-6989586621682858547"><span class="hs-identifier hs-var">fma213</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858543"><span class="hs-identifier hs-var">z_op</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858541"><span class="hs-identifier hs-var">y_reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858553"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4554"></span><span>     </span><span class="hs-comment">-- Fallback: Compute the result into a tmp reg and then move it.</span><span>
</span><span id="line-4555"></span><span>     </span><span id="local-6989586621682858552"><span class="annot"><a href="#local-6989586621682858552"><span class="hs-identifier hs-var hs-var">code_mov</span></a></span></span><span> </span><span id="local-6989586621682858554"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858554"><span class="hs-identifier hs-var">dst</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858545"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858546"><span class="hs-identifier hs-var">x_tmp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-4556"></span><span>                       </span><span class="annot"><span class="annottext">Operand -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="#local-6989586621682858547"><span class="hs-identifier hs-var">fma213</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858543"><span class="hs-identifier hs-var">z_op</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858541"><span class="hs-identifier hs-var">y_reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858546"><span class="hs-identifier hs-var">x_tmp</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-4557"></span><span>                       </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; NCGConfig -&gt; Format -&gt; Reg -&gt; Reg -&gt; Instr
NCGConfig -&gt; Format -&gt; Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#mkRegRegMoveInstr"><span class="hs-identifier hs-var">mkRegRegMoveInstr</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858536"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858537"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858546"><span class="hs-identifier hs-var">x_tmp</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858554"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4558"></span><span>
</span><span id="line-4559"></span><span>     </span><span id="local-6989586621682858550"><span class="annot"><a href="#local-6989586621682858550"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682858555"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858555"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4560"></span><span>        </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858542"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4561"></span><span>        </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858544"><span class="hs-identifier hs-var">z_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4562"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858556"><span class="hs-identifier hs-var">arg_regs_conflict</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858552"><span class="hs-identifier hs-var">code_mov</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858555"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858551"><span class="hs-identifier hs-var">code_direct</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858555"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-4563"></span><span>
</span><span id="line-4564"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-4565"></span><span>
</span><span id="line-4566"></span><span>        </span><span id="local-6989586621682858556"><span class="annot"><span class="annottext">arg_regs_conflict :: Bool
</span><a href="#local-6989586621682858556"><span class="hs-identifier hs-var hs-var">arg_regs_conflict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4567"></span><span>          </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858541"><span class="hs-identifier hs-var">y_reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858555"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span>
</span><span id="line-4568"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858543"><span class="hs-identifier hs-var">z_op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4569"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span id="local-6989586621682858557"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858557"><span class="hs-identifier hs-var">z_reg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858557"><span class="hs-identifier hs-var">z_reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858555"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4570"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span id="local-6989586621682858558"><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858558"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858555"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; [Reg] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">AddrMode -&gt; [Reg]
</span><a href="GHC.CmmToAsm.X86.Regs.html#addrModeRegs"><span class="hs-identifier hs-var">addrModeRegs</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858558"><span class="hs-identifier hs-var">amode</span></a></span><span>
</span><span id="line-4571"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-4572"></span><span>
</span><span id="line-4573"></span><span>  </span><span class="hs-comment">-- NB: Computing the result into a desired register using Any can be tricky.</span><span>
</span><span id="line-4574"></span><span>  </span><span class="hs-comment">-- So for now, we keep it simple. (See #24496).</span><span>
</span><span id="line-4575"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858537"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858550"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4576"></span><span>
</span><span id="line-4577"></span><span class="hs-comment">-----------</span><span>
</span><span id="line-4578"></span><span>
</span><span id="line-4579"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialUCode"><span class="hs-identifier hs-type">trivialUCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4580"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-4581"></span><span id="trivialUCode"><span class="annot"><span class="annottext">trivialUCode :: Format -&gt; (Operand -&gt; Instr) -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialUCode"><span class="hs-identifier hs-var hs-var">trivialUCode</span></a></span></span><span> </span><span id="local-6989586621682858559"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858559"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682858560"><span class="annot"><span class="annottext">Operand -&gt; Instr
</span><a href="#local-6989586621682858560"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682858561"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858561"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4582"></span><span>  </span><span id="local-6989586621682858562"><span class="annot"><a href="#local-6989586621682858562"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858561"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4583"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-4584"></span><span>     </span><span id="local-6989586621682858563"><span class="annot"><a href="#local-6989586621682858563"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682858564"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858564"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4585"></span><span>        </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858562"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858564"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-4586"></span><span>        </span><span class="annot"><span class="annottext">Operand -&gt; Instr
</span><a href="#local-6989586621682858560"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858564"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4587"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858559"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858563"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4588"></span><span>
</span><span id="line-4589"></span><span class="hs-comment">-----------</span><span>
</span><span id="line-4590"></span><span>
</span><span id="line-4591"></span><span>
</span><span id="line-4592"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialFCode_sse2"><span class="hs-identifier hs-type">trivialFCode_sse2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4593"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-4594"></span><span id="trivialFCode_sse2"><span class="annot"><span class="annottext">trivialFCode_sse2 :: Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialFCode_sse2"><span class="hs-identifier hs-var hs-var">trivialFCode_sse2</span></a></span></span><span> </span><span id="local-6989586621682858565"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858565"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682858566"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682858566"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682858567"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858567"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682858568"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858568"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-4595"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format
-&gt; (Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genTrivialCode"><span class="hs-identifier hs-var">genTrivialCode</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858569"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682858566"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858569"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858567"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858568"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-4596"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682858569"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682858569"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858565"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-4597"></span><span>
</span><span id="line-4598"></span><span>
</span><span id="line-4599"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-4600"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceInt2FP"><span class="hs-identifier hs-type">coerceInt2FP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-4601"></span><span id="coerceInt2FP"><span class="annot"><span class="annottext">coerceInt2FP :: Width -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceInt2FP"><span class="hs-identifier hs-var hs-var">coerceInt2FP</span></a></span></span><span> </span><span id="local-6989586621682858570"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858570"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682858571"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858571"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span id="local-6989586621682858572"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858572"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">NatM Register
</span><a href="#local-6989586621682858573"><span class="hs-identifier hs-var">coerce_sse2</span></a></span><span>
</span><span id="line-4602"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4603"></span><span>
</span><span id="line-4604"></span><span>   </span><span id="local-6989586621682858573"><span class="annot"><span class="annottext">coerce_sse2 :: NatM Register
</span><a href="#local-6989586621682858573"><span class="hs-identifier hs-var hs-var">coerce_sse2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4605"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621682858574"><span class="annot"><a href="#local-6989586621682858574"><span class="hs-identifier hs-var">x_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858575"><span class="annot"><a href="#local-6989586621682858575"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-var">getOperand</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858572"><span class="hs-identifier hs-var">x</span></a></span><span>  </span><span class="hs-comment">-- ToDo: could be a safe operand</span><span>
</span><span id="line-4606"></span><span>     </span><span class="hs-keyword">let</span><span>
</span><span id="line-4607"></span><span>           </span><span id="local-6989586621682858576"><span class="annot"><a href="#local-6989586621682858576"><span class="hs-identifier hs-var hs-var">opc</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858571"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CVTSI2SS"><span class="hs-identifier hs-var">CVTSI2SS</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CVTSI2SD"><span class="hs-identifier hs-var">CVTSI2SD</span></a></span><span>
</span><span id="line-4608"></span><span>                             </span><span id="local-6989586621682858579"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858579"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Format -&gt; Operand -&gt; Reg -&gt; Instr
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Format -&gt; Operand -&gt; Reg -&gt; Instr)
-&gt; String -&gt; Format -&gt; Operand -&gt; Reg -&gt; Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;coerceInt2FP.sse: unhandled width (&quot;</span></span><span>
</span><span id="line-4609"></span><span>                                         </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858579"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-4610"></span><span>           </span><span id="local-6989586621682858580"><span class="annot"><a href="#local-6989586621682858580"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682858581"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858581"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858575"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="#local-6989586621682858576"><span class="hs-identifier hs-var">opc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858570"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858574"><span class="hs-identifier hs-var">x_op</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858581"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4611"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-type">floatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858571"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682858580"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4612"></span><span>        </span><span class="hs-comment">-- works even if the destination rep is &lt;II32</span><span>
</span><span id="line-4613"></span><span>
</span><span id="line-4614"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-4615"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceFP2Int"><span class="hs-identifier hs-type">coerceFP2Int</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-4616"></span><span id="coerceFP2Int"><span class="annot"><span class="annottext">coerceFP2Int :: Width -&gt; Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceFP2Int"><span class="hs-identifier hs-var hs-var">coerceFP2Int</span></a></span></span><span> </span><span id="local-6989586621682858582"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858582"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682858583"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858583"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span id="local-6989586621682858584"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858584"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">NatM Register
</span><a href="#local-6989586621682858585"><span class="hs-identifier hs-var">coerceFP2Int_sse2</span></a></span><span>
</span><span id="line-4617"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4618"></span><span>   </span><span id="local-6989586621682858585"><span class="annot"><span class="annottext">coerceFP2Int_sse2 :: NatM Register
</span><a href="#local-6989586621682858585"><span class="hs-identifier hs-var hs-var">coerceFP2Int_sse2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4619"></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621682858586"><span class="annot"><a href="#local-6989586621682858586"><span class="hs-identifier hs-var">x_op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858587"><span class="annot"><a href="#local-6989586621682858587"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getOperand"><span class="hs-identifier hs-var">getOperand</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858584"><span class="hs-identifier hs-var">x</span></a></span><span>  </span><span class="hs-comment">-- ToDo: could be a safe operand</span><span>
</span><span id="line-4620"></span><span>     </span><span class="hs-keyword">let</span><span>
</span><span id="line-4621"></span><span>           </span><span id="local-6989586621682858588"><span class="annot"><a href="#local-6989586621682858588"><span class="hs-identifier hs-var hs-var">opc</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858582"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CVTTSS2SIQ"><span class="hs-identifier hs-var">CVTTSS2SIQ</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CVTTSD2SIQ"><span class="hs-identifier hs-var">CVTTSD2SIQ</span></a></span><span class="hs-special">;</span><span>
</span><span id="line-4622"></span><span>                               </span><span id="local-6989586621682858591"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858591"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Format -&gt; Operand -&gt; Reg -&gt; Instr
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Format -&gt; Operand -&gt; Reg -&gt; Instr)
-&gt; String -&gt; Format -&gt; Operand -&gt; Reg -&gt; Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;coerceFP2Init.sse: unhandled width (&quot;</span></span><span>
</span><span id="line-4623"></span><span>                                           </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858591"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-4624"></span><span>           </span><span id="local-6989586621682858592"><span class="annot"><a href="#local-6989586621682858592"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682858593"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858593"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858587"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="#local-6989586621682858588"><span class="hs-identifier hs-var">opc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858583"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858586"><span class="hs-identifier hs-var">x_op</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858593"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4625"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858583"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682858592"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4626"></span><span>         </span><span class="hs-comment">-- works even if the destination rep is &lt;II32</span><span>
</span><span id="line-4627"></span><span>
</span><span id="line-4628"></span><span>
</span><span id="line-4629"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-4630"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceFP2FP"><span class="hs-identifier hs-type">coerceFP2FP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-4631"></span><span id="coerceFP2FP"><span class="annot"><span class="annottext">coerceFP2FP :: Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#coerceFP2FP"><span class="hs-identifier hs-var hs-var">coerceFP2FP</span></a></span></span><span> </span><span id="local-6989586621682858594"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858594"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span id="local-6989586621682858595"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858595"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4632"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682858596"><span class="annot"><a href="#local-6989586621682858596"><span class="hs-identifier hs-var">x_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858597"><span class="annot"><a href="#local-6989586621682858597"><span class="hs-identifier hs-var">x_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858595"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4633"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-4634"></span><span>        </span><span id="local-6989586621682858598"><span class="annot"><a href="#local-6989586621682858598"><span class="hs-identifier hs-var hs-var">opc</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858594"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CVTSD2SS"><span class="hs-identifier hs-var">CVTSD2SS</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CVTSS2SD"><span class="hs-identifier hs-var">CVTSS2SD</span></a></span><span class="hs-special">;</span><span>
</span><span id="line-4635"></span><span>                                     </span><span id="local-6989586621682858601"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858601"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Reg -&gt; Reg -&gt; Instr
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Reg -&gt; Reg -&gt; Instr) -&gt; String -&gt; Reg -&gt; Reg -&gt; Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;coerceFP2FP: unhandled width (&quot;</span></span><span>
</span><span id="line-4636"></span><span>                                                 </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858601"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-4637"></span><span>        </span><span id="local-6989586621682858602"><span class="annot"><a href="#local-6989586621682858602"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682858603"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858603"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858597"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Instr
</span><a href="#local-6989586621682858598"><span class="hs-identifier hs-var">opc</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858596"><span class="hs-identifier hs-var">x_reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858603"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4638"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-type">floatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858594"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682858602"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4639"></span><span>
</span><span id="line-4640"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-4641"></span><span>
</span><span id="line-4642"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#sse2NegCode"><span class="hs-identifier hs-type">sse2NegCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-4643"></span><span id="sse2NegCode"><span class="annot"><span class="annottext">sse2NegCode :: Width -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#sse2NegCode"><span class="hs-identifier hs-var hs-var">sse2NegCode</span></a></span></span><span> </span><span id="local-6989586621682858604"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858604"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682858605"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858605"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4644"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858606"><span class="annot"><span class="annottext">fmt :: Format
</span><a href="#local-6989586621682858606"><span class="hs-identifier hs-var hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858604"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-4645"></span><span>  </span><span id="local-6989586621682858607"><span class="annot"><a href="#local-6989586621682858607"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858605"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4646"></span><span>  </span><span class="hs-comment">-- This is how gcc does it, so it can't be that bad:</span><span>
</span><span id="line-4647"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-4648"></span><span>    </span><span id="local-6989586621682858608"><span class="annot"><a href="#local-6989586621682858608"><span class="hs-identifier hs-var hs-var">const</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858606"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4649"></span><span>      </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#FF32"><span class="hs-identifier hs-var">FF32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0x80000000</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>
</span><span id="line-4650"></span><span>      </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#FF64"><span class="hs-identifier hs-var">FF64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0x8000000000000000</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span>
</span><span id="line-4651"></span><span>      </span><span id="local-6989586621682858609"><span class="annot"><span class="annottext">x :: Format
</span><a href="#local-6989586621682858609"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmLit
forall {a} {b}. Show a =&gt; a -&gt; b
</span><a href="#local-6989586621682858610"><span class="hs-identifier hs-var">wrongFmt</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858609"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4652"></span><span>      </span><span id="local-6989586621682858611"><span class="annot"><span class="annottext">x :: Format
</span><a href="#local-6989586621682858611"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmLit
forall {a} {b}. Show a =&gt; a -&gt; b
</span><a href="#local-6989586621682858610"><span class="hs-identifier hs-var">wrongFmt</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858611"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4653"></span><span>      </span><span id="local-6989586621682858612"><span class="annot"><span class="annottext">x :: Format
</span><a href="#local-6989586621682858612"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmLit
forall {a} {b}. Show a =&gt; a -&gt; b
</span><a href="#local-6989586621682858610"><span class="hs-identifier hs-var">wrongFmt</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858612"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4654"></span><span>      </span><span id="local-6989586621682858613"><span class="annot"><span class="annottext">x :: Format
</span><a href="#local-6989586621682858613"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmLit
forall {a} {b}. Show a =&gt; a -&gt; b
</span><a href="#local-6989586621682858610"><span class="hs-identifier hs-var">wrongFmt</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858613"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4655"></span><span>      </span><span id="local-6989586621682858614"><span class="annot"><span class="annottext">x :: Format
</span><a href="#local-6989586621682858614"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#VecFormat"><span class="hs-identifier hs-type">VecFormat</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmLit
forall {a} {b}. Show a =&gt; a -&gt; b
</span><a href="#local-6989586621682858610"><span class="hs-identifier hs-var">wrongFmt</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858614"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4656"></span><span>
</span><span id="line-4657"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-4658"></span><span>        </span><span id="local-6989586621682858610"><span class="annot"><span class="annottext">wrongFmt :: a -&gt; b
</span><a href="#local-6989586621682858610"><span class="hs-identifier hs-var hs-var">wrongFmt</span></a></span></span><span> </span><span id="local-6989586621682858619"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682858619"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; b
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; b) -&gt; String -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sse2NegCode: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682858619"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-4659"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682858620"><span class="annot"><a href="#local-6989586621682858620"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span id="local-6989586621682858621"><span class="annot"><a href="#local-6989586621682858621"><span class="hs-identifier hs-var">amode_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#memConstant"><span class="hs-identifier hs-type">memConstant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#mkAlignment"><span class="hs-identifier hs-type">mkAlignment</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#widthInBytes"><span class="hs-identifier hs-type">widthInBytes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858604"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682858608"><span class="hs-identifier hs-type">const</span></a></span><span>
</span><span id="line-4660"></span><span>  </span><span id="local-6989586621682858622"><span class="annot"><a href="#local-6989586621682858622"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858606"><span class="hs-identifier hs-type">fmt</span></a></span><span>
</span><span id="line-4661"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-4662"></span><span>    </span><span id="local-6989586621682858623"><span class="annot"><a href="#local-6989586621682858623"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682858624"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858624"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858607"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858624"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858621"><span class="hs-identifier hs-var">amode_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-4663"></span><span>        </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858606"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858620"><span class="hs-identifier hs-var">amode</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858622"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-4664"></span><span>        </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858606"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858622"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858624"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4665"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-4666"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-4667"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858606"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858623"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4668"></span><span>
</span><span id="line-4669"></span><span id="local-6989586621682853767"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-type">needLlvm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682853767"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-4670"></span><span id="needLlvm"><span class="annot"><span class="annottext">needLlvm :: forall a. MachOp -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#needLlvm"><span class="hs-identifier hs-var hs-var">needLlvm</span></a></span></span><span> </span><span id="local-6989586621682858628"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682858628"><span class="hs-identifier hs-var">mop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4671"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; NatM a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#sorry"><span class="hs-identifier hs-var">sorry</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; NatM a) -&gt; String -&gt; NatM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unsupported vector instruction for the native code generator:&quot;</span></span><span>
</span><span id="line-4672"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682858628"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-4673"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Please use -fllvm.&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-4674"></span><span>
</span><span id="line-4675"></span><span id="local-6989586621682853765"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-type">incorrectOperands</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682853765"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-4676"></span><span id="incorrectOperands"><span class="annot"><span class="annottext">incorrectOperands :: forall a. NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#incorrectOperands"><span class="hs-identifier hs-var hs-var">incorrectOperands</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; NatM a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#sorry"><span class="hs-identifier hs-var">sorry</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Incorrect number of operands&quot;</span></span><span>
</span><span id="line-4677"></span><span>
</span><span id="line-4678"></span><span id="local-6989586621682853766"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#invalidConversion"><span class="hs-identifier hs-type">invalidConversion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682853766"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-4679"></span><span id="invalidConversion"><span class="annot"><span class="annottext">invalidConversion :: forall a. Width -&gt; Width -&gt; NatM a
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#invalidConversion"><span class="hs-identifier hs-var hs-var">invalidConversion</span></a></span></span><span> </span><span id="local-6989586621682858635"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858635"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682858636"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858636"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4680"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; NatM a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#sorry"><span class="hs-identifier hs-var">sorry</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; NatM a) -&gt; String -&gt; NatM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid conversion operation from &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858635"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; to &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858636"><span class="hs-identifier hs-var">to</span></a></span><span>
</span><span id="line-4681"></span><span>
</span><span id="line-4682"></span><span class="hs-comment">-- | This works on the invariant that all jumps in the given blocks are required.</span><span>
</span><span id="line-4683"></span><span class="hs-comment">--   Starting from there we try to make a few more jumps redundant by reordering</span><span>
</span><span id="line-4684"></span><span class="hs-comment">--   them.</span><span>
</span><span id="line-4685"></span><span class="hs-comment">--   We depend on the information in the CFG to do so so without a given CFG</span><span>
</span><span id="line-4686"></span><span class="hs-comment">--   we do nothing.</span><span>
</span><span id="line-4687"></span><span id="local-6989586621682853885"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#invertCondBranches"><span class="hs-identifier hs-type">invertCondBranches</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.CFG.html#CFG"><span class="hs-identifier hs-type">CFG</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ CFG if present</span></span><span>
</span><span id="line-4688"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682853885"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Blocks with info tables</span></span><span>
</span><span id="line-4689"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatBasicBlock"><span class="hs-identifier hs-type">NatBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ List of basic blocks</span></span><span>
</span><span id="line-4690"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatBasicBlock"><span class="hs-identifier hs-type">NatBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-4691"></span><span id="invertCondBranches"><span class="annot"><span class="annottext">invertCondBranches :: forall a.
Maybe CFG
-&gt; LabelMap a -&gt; [NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#invertCondBranches"><span class="hs-identifier hs-var hs-var">invertCondBranches</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe CFG
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">LabelMap a
</span><span class="hs-identifier">_</span></span><span>       </span><span id="local-6989586621682858641"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682858641"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682858641"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-4692"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#invertCondBranches"><span class="hs-identifier hs-var">invertCondBranches</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682858642"><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621682858642"><span class="hs-identifier hs-var">cfg</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682858643"><span class="annot"><span class="annottext">LabelMap a
</span><a href="#local-6989586621682858643"><span class="hs-identifier hs-var">keep</span></a></span></span><span> </span><span id="local-6989586621682858644"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682858644"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4693"></span><span>    </span><span class="annot"><span class="annottext">[NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
</span><a href="#local-6989586621682858645"><span class="hs-identifier hs-var">invert</span></a></span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682858644"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-4694"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-4695"></span><span>    </span><span class="annot"><a href="#local-6989586621682858645"><span class="hs-identifier hs-type">invert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatBasicBlock"><span class="hs-identifier hs-type">NatBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatBasicBlock"><span class="hs-identifier hs-type">NatBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4696"></span><span>    </span><span id="local-6989586621682858645"><span class="annot"><span class="annottext">invert :: [NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
</span><a href="#local-6989586621682858645"><span class="hs-identifier hs-var hs-var">invert</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#BasicBlock"><span class="hs-identifier hs-type">BasicBlock</span></a></span><span> </span><span id="local-6989586621682858646"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858646"><span class="hs-identifier hs-var">lbl1</span></a></span></span><span> </span><span id="local-6989586621682858647"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682858647"><span class="hs-identifier hs-var">ins</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682858648"><span class="annot"><span class="annottext">b2 :: NatBasicBlock Instr
</span><a href="#local-6989586621682858648"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#BasicBlock"><span class="hs-identifier hs-type">BasicBlock</span></a></span><span> </span><span id="local-6989586621682858649"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858649"><span class="hs-identifier hs-var">lbl2</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682858650"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682858650"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-4697"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">--pprTrace &quot;Block&quot; (ppr lbl1) True,</span><span>
</span><span id="line-4698"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682858651"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682858651"><span class="hs-identifier hs-var">jmp1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682858652"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682858652"><span class="hs-identifier hs-var">jmp2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; Maybe (Instr, Instr)
forall a. [a] -&gt; Maybe (a, a)
</span><a href="GHC.Utils.Misc.html#last2"><span class="hs-identifier hs-var">last2</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682858647"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-4699"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-type">JXX</span></a></span><span> </span><span id="local-6989586621682858654"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682858654"><span class="hs-identifier hs-var">cond1</span></a></span></span><span> </span><span id="local-6989586621682858655"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858655"><span class="hs-identifier hs-var">target1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682858651"><span class="hs-identifier hs-var">jmp1</span></a></span><span>
</span><span id="line-4700"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858655"><span class="hs-identifier hs-var">target1</span></a></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Label -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858649"><span class="hs-identifier hs-var">lbl2</span></a></span><span>
</span><span id="line-4701"></span><span>      </span><span class="hs-comment">--, pprTrace &quot;CutChance&quot; (ppr b1) True</span><span>
</span><span id="line-4702"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-type">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span id="local-6989586621682858656"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858656"><span class="hs-identifier hs-var">target2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682858652"><span class="hs-identifier hs-var">jmp2</span></a></span><span>
</span><span id="line-4703"></span><span>      </span><span class="hs-comment">-- We have enough information to check if we can perform the inversion</span><span>
</span><span id="line-4704"></span><span>      </span><span class="hs-comment">-- TODO: We could also check for the last asm instruction which sets</span><span>
</span><span id="line-4705"></span><span>      </span><span class="hs-comment">-- status flags instead. Which I suspect is worse in terms of compiler</span><span>
</span><span id="line-4706"></span><span>      </span><span class="hs-comment">-- performance, but might be applicable to more cases</span><span>
</span><span id="line-4707"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682858657"><span class="annot"><span class="annottext">EdgeInfo
</span><a href="#local-6989586621682858657"><span class="hs-identifier hs-var">edgeInfo1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Label -&gt; CFG -&gt; Maybe EdgeInfo
</span><a href="GHC.CmmToAsm.CFG.html#getEdgeInfo"><span class="hs-identifier hs-var">getEdgeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858646"><span class="hs-identifier hs-var">lbl1</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858655"><span class="hs-identifier hs-var">target1</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621682858642"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-4708"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682858659"><span class="annot"><span class="annottext">EdgeInfo
</span><a href="#local-6989586621682858659"><span class="hs-identifier hs-var">edgeInfo2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Label -&gt; CFG -&gt; Maybe EdgeInfo
</span><a href="GHC.CmmToAsm.CFG.html#getEdgeInfo"><span class="hs-identifier hs-var">getEdgeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858646"><span class="hs-identifier hs-var">lbl1</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858656"><span class="hs-identifier hs-var">target2</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621682858642"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-4709"></span><span>      </span><span class="hs-comment">-- Both jumps come from the same cmm statement</span><span>
</span><span id="line-4710"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EdgeInfo -&gt; TransitionSource
</span><a href="GHC.CmmToAsm.CFG.html#transitionSource"><span class="hs-identifier hs-var">transitionSource</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeInfo
</span><a href="#local-6989586621682858657"><span class="hs-identifier hs-var">edgeInfo1</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionSource -&gt; TransitionSource -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">EdgeInfo -&gt; TransitionSource
</span><a href="GHC.CmmToAsm.CFG.html#transitionSource"><span class="hs-identifier hs-var">transitionSource</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeInfo
</span><a href="#local-6989586621682858659"><span class="hs-identifier hs-var">edgeInfo2</span></a></span><span>
</span><span id="line-4711"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.CFG.html#CmmSource"><span class="hs-identifier hs-type">CmmSource</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">trans_cmmNode :: TransitionSource -&gt; CmmNode O C
</span><a href="GHC.CmmToAsm.CFG.html#trans_cmmNode"><span class="hs-identifier hs-var">trans_cmmNode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682858663"><span class="annot"><span class="annottext">CmmNode O C
</span><a href="#local-6989586621682858663"><span class="hs-identifier hs-var">cmmCondBranch</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EdgeInfo -&gt; TransitionSource
</span><a href="GHC.CmmToAsm.CFG.html#transitionSource"><span class="hs-identifier hs-var">transitionSource</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeInfo
</span><a href="#local-6989586621682858657"><span class="hs-identifier hs-var">edgeInfo1</span></a></span><span>
</span><span id="line-4712"></span><span>
</span><span id="line-4713"></span><span>      </span><span class="hs-comment">--Int comparisons are invertable</span><span>
</span><span id="line-4714"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-type">CmmCondBranch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682858668"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682858668"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682858669"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682858669"><span class="hs-identifier hs-var">_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Label
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmNode O C
</span><a href="#local-6989586621682858663"><span class="hs-identifier hs-var">cmmCondBranch</span></a></span><span>
</span><span id="line-4715"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; Maybe Width
</span><a href="GHC.Cmm.MachOp.html#maybeIntComparison"><span class="hs-identifier hs-var">maybeIntComparison</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682858668"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-4716"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682858671"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682858671"><span class="hs-identifier hs-var">invCond</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Maybe Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#maybeInvertCond"><span class="hs-identifier hs-var">maybeInvertCond</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682858654"><span class="hs-identifier hs-var">cond1</span></a></span><span>
</span><span id="line-4717"></span><span>
</span><span id="line-4718"></span><span>      </span><span class="hs-comment">--Swap the last two jumps, invert the conditional jumps condition.</span><span>
</span><span id="line-4719"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858673"><span class="annot"><span class="annottext">jumps :: [Instr]
</span><a href="#local-6989586621682858673"><span class="hs-identifier hs-var hs-var">jumps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4720"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4721"></span><span>                </span><span class="hs-comment">-- We are free the eliminate the jmp. So we do so.</span><span>
</span><span id="line-4722"></span><span>                </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Label -&gt; LabelMap a -&gt; Bool
forall a. Label -&gt; LabelMap a -&gt; Bool
</span><a href="GHC.Cmm.Dataflow.Label.html#mapMember"><span class="hs-identifier hs-var">mapMember</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858655"><span class="hs-identifier hs-var">target1</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMap a
</span><a href="#local-6989586621682858643"><span class="hs-identifier hs-var">keep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4723"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682858671"><span class="hs-identifier hs-var">invCond</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858656"><span class="hs-identifier hs-var">target2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4724"></span><span>                </span><span class="hs-comment">-- If the conditional target is unlikely we put the other</span><span>
</span><span id="line-4725"></span><span>                </span><span class="hs-comment">-- target at the front.</span><span>
</span><span id="line-4726"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">EdgeInfo -&gt; EdgeWeight
</span><a href="GHC.CmmToAsm.CFG.html#edgeWeight"><span class="hs-identifier hs-var">edgeWeight</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeInfo
</span><a href="#local-6989586621682858659"><span class="hs-identifier hs-var">edgeInfo2</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeWeight -&gt; EdgeWeight -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">EdgeInfo -&gt; EdgeWeight
</span><a href="GHC.CmmToAsm.CFG.html#edgeWeight"><span class="hs-identifier hs-var">edgeWeight</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeInfo
</span><a href="#local-6989586621682858657"><span class="hs-identifier hs-var">edgeInfo1</span></a></span><span>
</span><span id="line-4727"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682858671"><span class="hs-identifier hs-var">invCond</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858656"><span class="hs-identifier hs-var">target2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858655"><span class="hs-identifier hs-var">target1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4728"></span><span>                </span><span class="hs-comment">-- Keep things as-is otherwise</span><span>
</span><span id="line-4729"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-4730"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682858651"><span class="hs-identifier hs-var">jmp1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682858652"><span class="hs-identifier hs-var">jmp2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4731"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">--pprTrace &quot;Cutable&quot; (ppr [jmp1,jmp2] &lt;+&gt; text &quot;=&gt;&quot; &lt;+&gt; ppr jumps) $</span><span>
</span><span id="line-4732"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Label -&gt; [Instr] -&gt; NatBasicBlock Instr
forall i. Label -&gt; [i] -&gt; GenBasicBlock i
</span><a href="GHC.Cmm.html#BasicBlock"><span class="hs-identifier hs-var">BasicBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858646"><span class="hs-identifier hs-var">lbl1</span></a></span><span>
</span><span id="line-4733"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Instr] -&gt; [Instr]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="GHC.Utils.Misc.html#dropTail"><span class="hs-identifier hs-var">dropTail</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682858647"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; [Instr] -&gt; [Instr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682858673"><span class="hs-identifier hs-var">jumps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4734"></span><span>            </span><span class="annot"><span class="annottext">NatBasicBlock Instr
-&gt; [NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
</span><a href="#local-6989586621682858645"><span class="hs-identifier hs-var">invert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NatBasicBlock Instr
</span><a href="#local-6989586621682858648"><span class="hs-identifier hs-var">b2</span></a></span><span class="annot"><span class="annottext">NatBasicBlock Instr
-&gt; [NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682858650"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4735"></span><span>    </span><span class="annot"><a href="#local-6989586621682858645"><span class="hs-identifier hs-var">invert</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682858677"><span class="annot"><span class="annottext">NatBasicBlock Instr
</span><a href="#local-6989586621682858677"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682858678"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682858678"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NatBasicBlock Instr
</span><a href="#local-6989586621682858677"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">NatBasicBlock Instr
-&gt; [NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
</span><a href="#local-6989586621682858645"><span class="hs-identifier hs-var">invert</span></a></span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682858678"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-4736"></span><span>    </span><span class="annot"><a href="#local-6989586621682858645"><span class="hs-identifier hs-var">invert</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-4737"></span><span>
</span><span id="line-4738"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicRMW"><span class="hs-identifier hs-type">genAtomicRMW</span></a></span><span>
</span><span id="line-4739"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-4740"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-4741"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#AtomicMachOp"><span class="hs-identifier hs-type">AtomicMachOp</span></a></span><span>
</span><span id="line-4742"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-4743"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4744"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4745"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4746"></span><span id="genAtomicRMW"><span class="annot"><span class="annottext">genAtomicRMW :: Label
-&gt; Width
-&gt; AtomicMachOp
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM (InstrBlock, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicRMW"><span class="hs-identifier hs-var hs-var">genAtomicRMW</span></a></span></span><span> </span><span id="local-6989586621682858679"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858679"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682858680"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858680"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682858681"><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="#local-6989586621682858681"><span class="hs-identifier hs-var">amop</span></a></span></span><span> </span><span id="local-6989586621682858682"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858682"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858683"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858683"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682858684"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858684"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4747"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682858685"><span class="annot"><a href="#local-6989586621682858685"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span id="local-6989586621682858686"><span class="annot"><a href="#local-6989586621682858686"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-4748"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="#local-6989586621682858681"><span class="hs-identifier hs-var">amop</span></a></span><span> </span><span class="annot"><span class="annottext">AtomicMachOp -&gt; [AtomicMachOp] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="GHC.Cmm.MachOp.html#AMO_Add"><span class="hs-identifier hs-var">AMO_Add</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="GHC.Cmm.MachOp.html#AMO_Sub"><span class="hs-identifier hs-var">AMO_Sub</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4749"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858683"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-4750"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getSimpleAmode"><span class="hs-identifier hs-var">getSimpleAmode</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858683"><span class="hs-identifier hs-var">addr</span></a></span><span>  </span><span class="hs-comment">-- See genForeignCall for MO_Cmpxchg</span><span>
</span><span id="line-4751"></span><span>    </span><span id="local-6989586621682858689"><span class="annot"><a href="#local-6989586621682858689"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858690"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-4752"></span><span>    </span><span id="local-6989586621682858691"><span class="annot"><a href="#local-6989586621682858691"><span class="hs-identifier hs-var">arg_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858684"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-4753"></span><span>    </span><span id="local-6989586621682858692"><span class="annot"><a href="#local-6989586621682858692"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-4754"></span><span>
</span><span id="line-4755"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858693"><span class="annot"><a href="#local-6989586621682858693"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858692"><span class="hs-identifier hs-var">platform</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalReg -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858682"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4756"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682858694"><span class="annot"><a href="#local-6989586621682858694"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858695"><span class="annot"><a href="#local-6989586621682858695"><span class="hs-identifier hs-var">lbl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682858696"><span class="hs-identifier hs-type">op_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858693"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858689"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858685"><span class="hs-identifier hs-type">amode</span></a></span><span>
</span><span id="line-4757"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858686"><span class="hs-identifier hs-type">addr_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858691"><span class="hs-identifier hs-type">arg_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858689"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858694"><span class="hs-identifier hs-type">code</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621682858695"><span class="hs-identifier hs-type">lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4758"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-4759"></span><span>    </span><span class="hs-comment">-- Code for the operation</span><span>
</span><span id="line-4760"></span><span>    </span><span class="annot"><a href="#local-6989586621682858696"><span class="hs-identifier hs-type">op_code</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span>       </span><span class="hs-comment">-- Destination reg</span><span>
</span><span id="line-4761"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span>       </span><span class="hs-comment">-- Register containing argument</span><span>
</span><span id="line-4762"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrMode"><span class="hs-identifier hs-type">AddrMode</span></a></span><span>  </span><span class="hs-comment">-- Address of location to mutate</span><span>
</span><span id="line-4763"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- TODO: Return Maybe BlockId</span><span>
</span><span id="line-4764"></span><span>    </span><span id="local-6989586621682858696"><span class="annot"><span class="annottext">op_code :: Reg -&gt; Reg -&gt; AddrMode -&gt; NatM (InstrBlock, Label)
</span><a href="#local-6989586621682858696"><span class="hs-identifier hs-var hs-var">op_code</span></a></span></span><span> </span><span id="local-6989586621682858697"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858697"><span class="hs-identifier hs-var">dst_r</span></a></span></span><span> </span><span id="local-6989586621682858698"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858698"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682858699"><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858699"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4765"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="#local-6989586621682858681"><span class="hs-identifier hs-var">amop</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4766"></span><span>          </span><span class="hs-comment">-- In the common case where dst_r is a virtual register the</span><span>
</span><span id="line-4767"></span><span>          </span><span class="hs-comment">-- final move should go away, because it's the last use of arg</span><span>
</span><span id="line-4768"></span><span>          </span><span class="hs-comment">-- and the first use of dst_r.</span><span>
</span><span id="line-4769"></span><span>          </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="GHC.Cmm.MachOp.html#AMO_Add"><span class="hs-identifier hs-var">AMO_Add</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(InstrBlock, Label) -&gt; NatM (InstrBlock, Label)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((InstrBlock, Label) -&gt; NatM (InstrBlock, Label))
-&gt; (InstrBlock, Label) -&gt; NatM (InstrBlock, Label)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LOCK"><span class="hs-identifier hs-var">LOCK</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XADD"><span class="hs-identifier hs-var">XADD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858690"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858698"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858699"><span class="hs-identifier hs-var">amode</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4770"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858690"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858698"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858697"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4771"></span><span>                                     </span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858679"><span class="hs-identifier hs-var">bid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4772"></span><span>          </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="GHC.Cmm.MachOp.html#AMO_Sub"><span class="hs-identifier hs-var">AMO_Sub</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(InstrBlock, Label) -&gt; NatM (InstrBlock, Label)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((InstrBlock, Label) -&gt; NatM (InstrBlock, Label))
-&gt; (InstrBlock, Label) -&gt; NatM (InstrBlock, Label)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEGI"><span class="hs-identifier hs-var">NEGI</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858690"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858698"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4773"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LOCK"><span class="hs-identifier hs-var">LOCK</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XADD"><span class="hs-identifier hs-var">XADD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858690"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858698"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858699"><span class="hs-identifier hs-var">amode</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4774"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858690"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858698"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858697"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4775"></span><span>                                     </span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858679"><span class="hs-identifier hs-var">bid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4776"></span><span>          </span><span class="hs-comment">-- In these cases we need a new block id, and have to return it so</span><span>
</span><span id="line-4777"></span><span>          </span><span class="hs-comment">-- that later instruction selection can reference it.</span><span>
</span><span id="line-4778"></span><span>          </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="GHC.Cmm.MachOp.html#AMO_And"><span class="hs-identifier hs-var">AMO_And</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; InstrBlock) -&gt; NatM (InstrBlock, Label)
</span><a href="#local-6989586621682858703"><span class="hs-identifier hs-var">cmpxchg_code</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682858704"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858704"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682858705"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858705"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; InstrBlock) -&gt; Instr -&gt; InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#AND"><span class="hs-identifier hs-var">AND</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858690"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858704"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858705"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4779"></span><span>          </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="GHC.Cmm.MachOp.html#AMO_Nand"><span class="hs-identifier hs-var">AMO_Nand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; InstrBlock) -&gt; NatM (InstrBlock, Label)
</span><a href="#local-6989586621682858703"><span class="hs-identifier hs-var">cmpxchg_code</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682858707"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858707"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682858708"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858708"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#AND"><span class="hs-identifier hs-var">AND</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858690"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858707"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858708"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4780"></span><span>                                                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NOT"><span class="hs-identifier hs-var">NOT</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858690"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858708"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4781"></span><span>                                                      </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-4782"></span><span>          </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="GHC.Cmm.MachOp.html#AMO_Or"><span class="hs-identifier hs-var">AMO_Or</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; InstrBlock) -&gt; NatM (InstrBlock, Label)
</span><a href="#local-6989586621682858703"><span class="hs-identifier hs-var">cmpxchg_code</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682858710"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858710"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682858711"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858711"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; InstrBlock) -&gt; Instr -&gt; InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858690"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858710"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858711"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4783"></span><span>          </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="GHC.Cmm.MachOp.html#AMO_Xor"><span class="hs-identifier hs-var">AMO_Xor</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; InstrBlock) -&gt; NatM (InstrBlock, Label)
</span><a href="#local-6989586621682858703"><span class="hs-identifier hs-var">cmpxchg_code</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682858713"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858713"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682858714"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858714"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; InstrBlock) -&gt; Instr -&gt; InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858690"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858713"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682858714"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4784"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-4785"></span><span>        </span><span class="hs-comment">-- Simulate operation that lacks a dedicated instruction using</span><span>
</span><span id="line-4786"></span><span>        </span><span class="hs-comment">-- cmpxchg.</span><span>
</span><span id="line-4787"></span><span>        </span><span class="annot"><a href="#local-6989586621682858703"><span class="hs-identifier hs-type">cmpxchg_code</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4788"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4789"></span><span>        </span><span id="local-6989586621682858703"><span class="annot"><span class="annottext">cmpxchg_code :: (Operand -&gt; Operand -&gt; InstrBlock) -&gt; NatM (InstrBlock, Label)
</span><a href="#local-6989586621682858703"><span class="hs-identifier hs-var hs-var">cmpxchg_code</span></a></span></span><span> </span><span id="local-6989586621682858715"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; InstrBlock
</span><a href="#local-6989586621682858715"><span class="hs-identifier hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4790"></span><span>            </span><span id="local-6989586621682858716"><span class="annot"><a href="#local-6989586621682858716"><span class="hs-identifier hs-var">lbl1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Label
</span><a href="GHC.CmmToAsm.Monad.html#getBlockIdNat"><span class="hs-identifier hs-var">getBlockIdNat</span></a></span><span>
</span><span id="line-4791"></span><span>            </span><span id="local-6989586621682858717"><span class="annot"><a href="#local-6989586621682858717"><span class="hs-identifier hs-var">lbl2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getBlockIdNat"><span class="hs-identifier hs-type">getBlockIdNat</span></a></span><span>
</span><span id="line-4792"></span><span>            </span><span id="local-6989586621682858718"><span class="annot"><a href="#local-6989586621682858718"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858690"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-4793"></span><span>
</span><span id="line-4794"></span><span>            </span><span class="hs-comment">--Record inserted blocks</span><span>
</span><span id="line-4795"></span><span>            </span><span class="hs-comment">--  We turn A -&gt; B into A -&gt; A' -&gt; A'' -&gt; B</span><span>
</span><span id="line-4796"></span><span>            </span><span class="hs-comment">--  with a self loop on A'.</span><span>
</span><span id="line-4797"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#addImmediateSuccessorNat"><span class="hs-identifier hs-type">addImmediateSuccessorNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858679"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858716"><span class="hs-identifier hs-type">lbl1</span></a></span><span>
</span><span id="line-4798"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#addImmediateSuccessorNat"><span class="hs-identifier hs-type">addImmediateSuccessorNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858716"><span class="hs-identifier hs-type">lbl1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858717"><span class="hs-identifier hs-type">lbl2</span></a></span><span>
</span><span id="line-4799"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#updateCfgNat"><span class="hs-identifier hs-type">updateCfgNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.CFG.html#addWeightEdge"><span class="hs-identifier hs-type">addWeightEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858716"><span class="hs-identifier hs-type">lbl1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858716"><span class="hs-identifier hs-type">lbl1</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-4800"></span><span>
</span><span id="line-4801"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-4802"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858690"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858699"><span class="hs-identifier hs-type">amode</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4803"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-type">JXX</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-type">ALWAYS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858716"><span class="hs-identifier hs-type">lbl1</span></a></span><span>
</span><span id="line-4804"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-type">NEWBLOCK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858716"><span class="hs-identifier hs-type">lbl1</span></a></span><span>
</span><span id="line-4805"></span><span>                  </span><span class="hs-comment">-- Keep old value so we can return it:</span><span>
</span><span id="line-4806"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858690"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858697"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4807"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858690"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-type">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858718"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4808"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-4809"></span><span>                </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858715"><span class="hs-identifier hs-type">instrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858698"><span class="hs-identifier hs-type">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858718"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-4810"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#LOCK"><span class="hs-identifier hs-type">LOCK</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CMPXCHG"><span class="hs-identifier hs-type">CMPXCHG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858690"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858718"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858699"><span class="hs-identifier hs-type">amode</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4811"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-type">JXX</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-type">NE</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858716"><span class="hs-identifier hs-type">lbl1</span></a></span><span>
</span><span id="line-4812"></span><span>                </span><span class="hs-comment">-- See Note [Introducing cfg edges inside basic blocks]</span><span>
</span><span id="line-4813"></span><span>                </span><span class="hs-comment">-- why this basic block is required.</span><span>
</span><span id="line-4814"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-type">JXX</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-type">ALWAYS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858717"><span class="hs-identifier hs-type">lbl2</span></a></span><span>
</span><span id="line-4815"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-type">NEWBLOCK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858717"><span class="hs-identifier hs-type">lbl2</span></a></span><span>
</span><span id="line-4816"></span><span>                </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-4817"></span><span>                </span><span class="annot"><a href="#local-6989586621682858717"><span class="hs-identifier hs-type">lbl2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4818"></span><span>    </span><span id="local-6989586621682858690"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682858690"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858680"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-4819"></span><span>
</span><span id="line-4820"></span><span class="annot"><span class="hs-comment">-- | Count trailing zeroes</span></span><span>
</span><span id="line-4821"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtz"><span class="hs-identifier hs-type">genCtz</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4822"></span><span id="genCtz"><span class="annot"><span class="annottext">genCtz :: Label
-&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (InstrBlock, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtz"><span class="hs-identifier hs-var hs-var">genCtz</span></a></span></span><span> </span><span id="local-6989586621682858721"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858721"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682858722"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858722"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682858723"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858723"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858724"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858724"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4823"></span><span>  </span><span id="local-6989586621682858725"><span class="annot"><a href="#local-6989586621682858725"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-4824"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682858725"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621682858722"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-type">W64</span></a></span><span>
</span><span id="line-4825"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtz64_32"><span class="hs-identifier hs-type">genCtz64_32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858721"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858723"><span class="hs-identifier hs-type">dst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858724"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-4826"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtzGeneric"><span class="hs-identifier hs-type">genCtzGeneric</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858722"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858723"><span class="hs-identifier hs-type">dst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858724"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-4827"></span><span>
</span><span id="line-4828"></span><span class="hs-comment">-- | Count trailing zeroes</span><span>
</span><span id="line-4829"></span><span class="hs-comment">--</span><span>
</span><span id="line-4830"></span><span class="hs-comment">-- 64-bit width on 32-bit architecture</span><span>
</span><span id="line-4831"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtz64_32"><span class="hs-identifier hs-type">genCtz64_32</span></a></span><span>
</span><span id="line-4832"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-4833"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-4834"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4835"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4836"></span><span id="genCtz64_32"><span class="annot"><span class="annottext">genCtz64_32 :: Label -&gt; LocalReg -&gt; CmmExpr -&gt; NatM (InstrBlock, Maybe Label)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtz64_32"><span class="hs-identifier hs-var hs-var">genCtz64_32</span></a></span></span><span> </span><span id="local-6989586621682858728"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858728"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682858729"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858729"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858730"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858730"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4837"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682858731"><span class="annot"><a href="#local-6989586621682858731"><span class="hs-identifier hs-var">vcode</span></a></span></span><span> </span><span id="local-6989586621682858732"><span class="annot"><a href="#local-6989586621682858732"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682858733"><span class="annot"><a href="#local-6989586621682858733"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858730"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-4838"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858734"><span class="annot"><a href="#local-6989586621682858734"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858729"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4839"></span><span>  </span><span id="local-6989586621682858735"><span class="annot"><a href="#local-6989586621682858735"><span class="hs-identifier hs-var">lbl1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getBlockIdNat"><span class="hs-identifier hs-type">getBlockIdNat</span></a></span><span>
</span><span id="line-4840"></span><span>  </span><span id="local-6989586621682858736"><span class="annot"><a href="#local-6989586621682858736"><span class="hs-identifier hs-var">lbl2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getBlockIdNat"><span class="hs-identifier hs-type">getBlockIdNat</span></a></span><span>
</span><span id="line-4841"></span><span>  </span><span id="local-6989586621682858737"><span class="annot"><a href="#local-6989586621682858737"><span class="hs-identifier hs-var">tmp_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span>
</span><span id="line-4842"></span><span>
</span><span id="line-4843"></span><span>  </span><span class="hs-comment">-- New CFG Edges:</span><span>
</span><span id="line-4844"></span><span>  </span><span class="hs-comment">--  bid -&gt; lbl2</span><span>
</span><span id="line-4845"></span><span>  </span><span class="hs-comment">--  bid -&gt; lbl1 -&gt; lbl2</span><span>
</span><span id="line-4846"></span><span>  </span><span class="hs-comment">--  We also changes edges originating at bid to start at lbl2 instead.</span><span>
</span><span id="line-4847"></span><span>  </span><span id="local-6989586621682858738"><span class="annot"><a href="#local-6989586621682858738"><span class="hs-identifier hs-var">weights</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getCfgWeights"><span class="hs-identifier hs-type">getCfgWeights</span></a></span><span>
</span><span id="line-4848"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#updateCfgNat"><span class="hs-identifier hs-type">updateCfgNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.CFG.html#addWeightEdge"><span class="hs-identifier hs-type">addWeightEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858728"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858735"><span class="hs-identifier hs-type">lbl1</span></a></span><span> </span><span class="annot"><span class="hs-number">110</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span>
</span><span id="line-4849"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.CFG.html#addWeightEdge"><span class="hs-identifier hs-type">addWeightEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858735"><span class="hs-identifier hs-type">lbl1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858736"><span class="hs-identifier hs-type">lbl2</span></a></span><span> </span><span class="annot"><span class="hs-number">110</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span>
</span><span id="line-4850"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.CFG.html#addImmediateSuccessor"><span class="hs-identifier hs-type">addImmediateSuccessor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858738"><span class="hs-identifier hs-type">weights</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858728"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858736"><span class="hs-identifier hs-type">lbl2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4851"></span><span>
</span><span id="line-4852"></span><span>  </span><span class="hs-comment">-- The following instruction sequence corresponds to the pseudo-code</span><span>
</span><span id="line-4853"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-4854"></span><span>  </span><span class="hs-comment">--  if (src) {</span><span>
</span><span id="line-4855"></span><span>  </span><span class="hs-comment">--    dst = src.lo32 ? BSF(src.lo32) : (BSF(src.hi32) + 32);</span><span>
</span><span id="line-4856"></span><span>  </span><span class="hs-comment">--  } else {</span><span>
</span><span id="line-4857"></span><span>  </span><span class="hs-comment">--    dst = 64;</span><span>
</span><span id="line-4858"></span><span>  </span><span class="hs-comment">--  }</span><span>
</span><span id="line-4859"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858740"><span class="annot"><a href="#local-6989586621682858740"><span class="hs-identifier hs-var hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858731"><span class="hs-identifier hs-var">vcode</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-4860"></span><span>           </span><span class="hs-special">(</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>      </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858732"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858737"><span class="hs-identifier hs-var">tmp_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4861"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a></span><span>       </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858733"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858737"><span class="hs-identifier hs-var">tmp_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4862"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>      </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858734"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4863"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#EQQ"><span class="hs-identifier hs-var">EQQ</span></a></span><span>    </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858736"><span class="hs-identifier hs-var">lbl2</span></a></span><span>
</span><span id="line-4864"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858735"><span class="hs-identifier hs-var">lbl1</span></a></span><span>
</span><span id="line-4865"></span><span>
</span><span id="line-4866"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a></span><span>   </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858735"><span class="hs-identifier hs-var">lbl1</span></a></span><span>
</span><span id="line-4867"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#BSF"><span class="hs-identifier hs-var">BSF</span></a></span><span>     </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858732"><span class="hs-identifier hs-var">rhi</span></a></span><span class="hs-special">)</span><span>         </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858734"><span class="hs-identifier hs-var">dst_r</span></a></span><span>
</span><span id="line-4868"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span>     </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858734"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4869"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#BSF"><span class="hs-identifier hs-var">BSF</span></a></span><span>     </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858733"><span class="hs-identifier hs-var">rlo</span></a></span><span class="hs-special">)</span><span>         </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858737"><span class="hs-identifier hs-var">tmp_r</span></a></span><span>
</span><span id="line-4870"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMOV"><span class="hs-identifier hs-var">CMOV</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858737"><span class="hs-identifier hs-var">tmp_r</span></a></span><span class="hs-special">)</span><span>       </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858734"><span class="hs-identifier hs-var">dst_r</span></a></span><span>
</span><span id="line-4871"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858736"><span class="hs-identifier hs-var">lbl2</span></a></span><span>
</span><span id="line-4872"></span><span>
</span><span id="line-4873"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Label -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a></span><span>   </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858736"><span class="hs-identifier hs-var">lbl2</span></a></span><span>
</span><span id="line-4874"></span><span>            </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-4875"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858740"><span class="hs-identifier hs-type">instrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621682858736"><span class="hs-identifier hs-type">lbl2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4876"></span><span>
</span><span id="line-4877"></span><span class="hs-comment">-- | Count trailing zeroes</span><span>
</span><span id="line-4878"></span><span class="hs-comment">--</span><span>
</span><span id="line-4879"></span><span class="hs-comment">-- Generic case (width &lt;= word size)</span><span>
</span><span id="line-4880"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtzGeneric"><span class="hs-identifier hs-type">genCtzGeneric</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4881"></span><span id="genCtzGeneric"><span class="annot"><span class="annottext">genCtzGeneric :: Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCtzGeneric"><span class="hs-identifier hs-var hs-var">genCtzGeneric</span></a></span></span><span> </span><span id="local-6989586621682858743"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858743"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682858744"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858744"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858745"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858745"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4882"></span><span>  </span><span id="local-6989586621682858746"><span class="annot"><a href="#local-6989586621682858746"><span class="hs-identifier hs-var">code_src</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858745"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-4883"></span><span>  </span><span id="local-6989586621682858747"><span class="annot"><a href="#local-6989586621682858747"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-4884"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858748"><span class="annot"><a href="#local-6989586621682858748"><span class="hs-identifier hs-var hs-var">bw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBits"><span class="hs-identifier hs-var">widthInBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858743"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-4885"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858749"><span class="annot"><a href="#local-6989586621682858749"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858744"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-4886"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgBmiVersion"><span class="hs-identifier hs-var">ncgBmiVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858747"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="GHC.Platform.html#BMI2"><span class="hs-identifier hs-type">BMI2</span></a></span><span>
</span><span id="line-4887"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4888"></span><span>      </span><span id="local-6989586621682858752"><span class="annot"><a href="#local-6989586621682858752"><span class="hs-identifier hs-var">src_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858743"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4889"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858753"><span class="annot"><a href="#local-6989586621682858753"><span class="hs-identifier hs-var hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-identifier hs-var">appOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858746"><span class="hs-identifier hs-var">code_src</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858752"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(InstrBlock -&gt; InstrBlock) -&gt; InstrBlock -&gt; InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858743"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4890"></span><span>              </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-4891"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a></span><span>    </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0xFFFFFF00</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858752"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4892"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TZCNT"><span class="hs-identifier hs-var">TZCNT</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858752"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858749"><span class="hs-identifier hs-var">dst_r</span></a></span><span>
</span><span id="line-4893"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-4894"></span><span>              </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-4895"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TZCNT"><span class="hs-identifier hs-var">TZCNT</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858752"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858749"><span class="hs-identifier hs-var">dst_r</span></a></span><span>
</span><span id="line-4896"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858749"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858749"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4897"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-4898"></span><span>              </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; InstrBlock) -&gt; Instr -&gt; InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#TZCNT"><span class="hs-identifier hs-var">TZCNT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858743"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858752"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858749"><span class="hs-identifier hs-var">dst_r</span></a></span><span>
</span><span id="line-4899"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682858753"><span class="hs-identifier hs-type">instrs</span></a></span><span>
</span><span id="line-4900"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4901"></span><span>      </span><span class="hs-comment">-- The following insn sequence makes sure 'ctz 0' has a defined value.</span><span>
</span><span id="line-4902"></span><span>      </span><span class="hs-comment">-- starting with Haswell, one could use the TZCNT insn instead.</span><span>
</span><span id="line-4903"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858755"><span class="annot"><a href="#local-6989586621682858755"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858743"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858743"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-4904"></span><span>      </span><span id="local-6989586621682858756"><span class="annot"><a href="#local-6989586621682858756"><span class="hs-identifier hs-var">src_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858755"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-4905"></span><span>      </span><span id="local-6989586621682858757"><span class="annot"><a href="#local-6989586621682858757"><span class="hs-identifier hs-var">tmp_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858755"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-4906"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858758"><span class="annot"><a href="#local-6989586621682858758"><span class="hs-identifier hs-var hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858746"><span class="hs-identifier hs-var">code_src</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858756"><span class="hs-identifier hs-var">src_r</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-4907"></span><span>               </span><span class="hs-special">(</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858756"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858756"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858743"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; [Instr] -&gt; [Instr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-4908"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#BSF"><span class="hs-identifier hs-var">BSF</span></a></span><span>     </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858755"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858756"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span>       </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858757"><span class="hs-identifier hs-var">tmp_r</span></a></span><span>
</span><span id="line-4909"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>     </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858748"><span class="hs-identifier hs-var">bw</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858749"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4910"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMOV"><span class="hs-identifier hs-var">CMOV</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858755"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858757"><span class="hs-identifier hs-var">tmp_r</span></a></span><span class="hs-special">)</span><span>       </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858749"><span class="hs-identifier hs-var">dst_r</span></a></span><span>
</span><span id="line-4911"></span><span>                </span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- NB: We don't need to zero-extend the result for the</span><span>
</span><span id="line-4912"></span><span>                   </span><span class="hs-comment">-- W8/W16 cases because the 'MOV' insn already</span><span>
</span><span id="line-4913"></span><span>                   </span><span class="hs-comment">-- took care of implicitly clearing the upper bits</span><span>
</span><span id="line-4914"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682858758"><span class="hs-identifier hs-type">instrs</span></a></span><span>
</span><span id="line-4915"></span><span>
</span><span id="line-4916"></span><span>
</span><span id="line-4917"></span><span>
</span><span id="line-4918"></span><span class="hs-comment">-- | Copy memory</span><span>
</span><span id="line-4919"></span><span class="hs-comment">--</span><span>
</span><span id="line-4920"></span><span class="hs-comment">-- Unroll memcpy calls if the number of bytes to copy isn't too large (cf</span><span>
</span><span id="line-4921"></span><span class="hs-comment">-- ncgInlineThresholdMemcpy).  Otherwise, call C's memcpy.</span><span>
</span><span id="line-4922"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCpy"><span class="hs-identifier hs-type">genMemCpy</span></a></span><span>
</span><span id="line-4923"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-4924"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-4925"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4926"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4927"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4928"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-4929"></span><span id="genMemCpy"><span class="annot"><span class="annottext">genMemCpy :: Label -&gt; Int -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCpy"><span class="hs-identifier hs-var hs-var">genMemCpy</span></a></span></span><span> </span><span id="local-6989586621682858759"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858759"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682858760"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858760"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span id="local-6989586621682858761"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858761"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858762"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858762"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682858763"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858763"><span class="hs-identifier hs-var">arg_n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4930"></span><span>
</span><span id="line-4931"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858764"><span class="annot"><span class="annottext">libc_memcpy :: NatM InstrBlock
</span><a href="#local-6989586621682858764"><span class="hs-identifier hs-var hs-var">libc_memcpy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858759"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;memcpy&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858761"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858762"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858763"><span class="hs-identifier hs-var">arg_n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-4932"></span><span>
</span><span id="line-4933"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858763"><span class="hs-identifier hs-var">arg_n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4934"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682858765"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858765"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4935"></span><span>      </span><span class="hs-comment">-- try to inline it</span><span>
</span><span id="line-4936"></span><span>      </span><span id="local-6989586621682858766"><span class="annot"><a href="#local-6989586621682858766"><span class="hs-identifier hs-var">mcode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; CmmExpr -&gt; CmmExpr -&gt; Integer -&gt; NatM (Maybe InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCpyInlineMaybe"><span class="hs-identifier hs-var">genMemCpyInlineMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858760"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858761"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858762"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858765"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-4937"></span><span>      </span><span class="hs-comment">-- if it didn't inline, call the C function</span><span>
</span><span id="line-4938"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682858766"><span class="hs-identifier hs-type">mcode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4939"></span><span>        </span><span class="annot"><span class="annottext">Maybe InstrBlock
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM InstrBlock
</span><a href="#local-6989586621682858764"><span class="hs-identifier hs-var">libc_memcpy</span></a></span><span>
</span><span id="line-4940"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682858768"><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858768"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; NatM InstrBlock
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858768"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-4941"></span><span>
</span><span id="line-4942"></span><span>    </span><span class="hs-comment">-- not a literal size argument: call the C function</span><span>
</span><span id="line-4943"></span><span>    </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM InstrBlock
</span><a href="#local-6989586621682858764"><span class="hs-identifier hs-var">libc_memcpy</span></a></span><span>
</span><span id="line-4944"></span><span>
</span><span id="line-4945"></span><span>
</span><span id="line-4946"></span><span>
</span><span id="line-4947"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCpyInlineMaybe"><span class="hs-identifier hs-type">genMemCpyInlineMaybe</span></a></span><span>
</span><span id="line-4948"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-4949"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4950"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-4951"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-4952"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4953"></span><span id="genMemCpyInlineMaybe"><span class="annot"><span class="annottext">genMemCpyInlineMaybe :: Int -&gt; CmmExpr -&gt; CmmExpr -&gt; Integer -&gt; NatM (Maybe InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCpyInlineMaybe"><span class="hs-identifier hs-var hs-var">genMemCpyInlineMaybe</span></a></span></span><span> </span><span id="local-6989586621682858769"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858769"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span id="local-6989586621682858770"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858770"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858771"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858771"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682858772"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858772"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-4954"></span><span>  </span><span id="local-6989586621682858773"><span class="annot"><a href="#local-6989586621682858773"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-4955"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-4956"></span><span>    </span><span id="local-6989586621682858774"><span class="annot"><a href="#local-6989586621682858774"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858773"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-4957"></span><span>    </span><span id="local-6989586621682858775"><span class="annot"><a href="#local-6989586621682858775"><span class="hs-identifier hs-var hs-var">maxAlignment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Alignment
</span><a href="GHC.Platform.html#wordAlignment"><span class="hs-identifier hs-var">wordAlignment</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858774"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-4958"></span><span>                   </span><span class="hs-comment">-- only machine word wide MOVs are supported</span><span>
</span><span id="line-4959"></span><span>    </span><span id="local-6989586621682858777"><span class="annot"><a href="#local-6989586621682858777"><span class="hs-identifier hs-var hs-var">effectiveAlignment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Alignment -&gt; Alignment -&gt; Alignment
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Alignment
</span><a href="GHC.Types.Basic.html#alignmentOf"><span class="hs-identifier hs-var">alignmentOf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858769"><span class="hs-identifier hs-var">align</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Alignment
</span><a href="#local-6989586621682858775"><span class="hs-identifier hs-var">maxAlignment</span></a></span><span>
</span><span id="line-4960"></span><span>    </span><span id="local-6989586621682858779"><span class="annot"><a href="#local-6989586621682858779"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(Width -&gt; Format) -&gt; (Int -&gt; Width) -&gt; Int -&gt; Format
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Width
</span><a href="GHC.Cmm.Type.html#widthFromBytes"><span class="hs-identifier hs-var">widthFromBytes</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Format) -&gt; Int -&gt; Format
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Alignment -&gt; Int
</span><a href="GHC.Types.Basic.html#alignmentBytes"><span class="hs-identifier hs-var">alignmentBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Alignment
</span><a href="#local-6989586621682858777"><span class="hs-identifier hs-var">effectiveAlignment</span></a></span><span>
</span><span id="line-4961"></span><span>
</span><span id="line-4962"></span><span>
</span><span id="line-4963"></span><span>  </span><span class="hs-comment">-- The size of each move, in bytes.</span><span>
</span><span id="line-4964"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621682858782"><span class="hs-identifier hs-type">sizeBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-4965"></span><span>      </span><span id="local-6989586621682858782"><span class="annot"><a href="#local-6989586621682858782"><span class="hs-identifier hs-var hs-var">sizeBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Int
</span><a href="GHC.CmmToAsm.Format.html#formatInBytes"><span class="hs-identifier hs-var">formatInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858779"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4966"></span><span>
</span><span id="line-4967"></span><span>  </span><span class="hs-comment">-- The number of instructions we will generate (approx). We need 2</span><span>
</span><span id="line-4968"></span><span>  </span><span class="hs-comment">-- instructions per move.</span><span>
</span><span id="line-4969"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858783"><span class="annot"><a href="#local-6989586621682858783"><span class="hs-identifier hs-var hs-var">insns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858772"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858782"><span class="hs-identifier hs-var">sizeBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858782"><span class="hs-identifier hs-var">sizeBytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4970"></span><span>
</span><span id="line-4971"></span><span>      </span><span class="annot"><a href="#local-6989586621682858785"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span>
</span><span id="line-4972"></span><span>      </span><span id="local-6989586621682858785"><span class="annot"><a href="#local-6989586621682858785"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682858786"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858786"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858787"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858787"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682858788"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858788"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span id="local-6989586621682858789"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858789"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-4973"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858789"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858782"><span class="hs-identifier hs-var">sizeBytes</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4974"></span><span>              </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858779"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858790"><span class="hs-identifier hs-var">src_addr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858788"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4975"></span><span>              </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858779"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858788"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858791"><span class="hs-identifier hs-var">dst_addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4976"></span><span>              </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Reg -&gt; Integer -&gt; InstrBlock
</span><a href="#local-6989586621682858785"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858786"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858787"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858788"><span class="hs-identifier hs-var">tmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858789"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858782"><span class="hs-identifier hs-var">sizeBytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4977"></span><span>          </span><span class="hs-comment">-- Deal with remaining bytes.</span><span>
</span><span id="line-4978"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858789"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-comment">-- Will never happen on 32-bit</span><span>
</span><span id="line-4979"></span><span>              </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858790"><span class="hs-identifier hs-var">src_addr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858788"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4980"></span><span>              </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858788"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858791"><span class="hs-identifier hs-var">dst_addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4981"></span><span>              </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Reg -&gt; Integer -&gt; InstrBlock
</span><a href="#local-6989586621682858785"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858786"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858787"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858788"><span class="hs-identifier hs-var">tmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858789"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-4982"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858789"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4983"></span><span>              </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858790"><span class="hs-identifier hs-var">src_addr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858788"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4984"></span><span>              </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>    </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858788"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858791"><span class="hs-identifier hs-var">dst_addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4985"></span><span>              </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Reg -&gt; Integer -&gt; InstrBlock
</span><a href="#local-6989586621682858785"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858786"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858787"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858788"><span class="hs-identifier hs-var">tmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858789"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-4986"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858789"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4987"></span><span>              </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858790"><span class="hs-identifier hs-var">src_addr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858788"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4988"></span><span>              </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>    </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858788"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858791"><span class="hs-identifier hs-var">dst_addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-4989"></span><span>              </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Reg -&gt; Integer -&gt; InstrBlock
</span><a href="#local-6989586621682858785"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858786"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858787"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858788"><span class="hs-identifier hs-var">tmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858789"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-4990"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-4991"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-4992"></span><span>          </span><span id="local-6989586621682858790"><span class="annot"><span class="annottext">src_addr :: AddrMode
</span><a href="#local-6989586621682858790"><span class="hs-identifier hs-var hs-var">src_addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858787"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span>
</span><span id="line-4993"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858772"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858789"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4994"></span><span>
</span><span id="line-4995"></span><span>          </span><span id="local-6989586621682858791"><span class="annot"><span class="annottext">dst_addr :: AddrMode
</span><a href="#local-6989586621682858791"><span class="hs-identifier hs-var hs-var">dst_addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858786"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span>
</span><span id="line-4996"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858772"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858789"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4997"></span><span>
</span><span id="line-4998"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682858783"><span class="hs-identifier hs-type">insns</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgInlineThresholdMemcpy"><span class="hs-identifier hs-var">ncgInlineThresholdMemcpy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858773"><span class="hs-identifier hs-type">config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4999"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-5000"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5001"></span><span>      </span><span id="local-6989586621682858793"><span class="annot"><a href="#local-6989586621682858793"><span class="hs-identifier hs-var">code_dst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858770"><span class="hs-identifier hs-type">dst</span></a></span><span>
</span><span id="line-5002"></span><span>      </span><span id="local-6989586621682858794"><span class="annot"><a href="#local-6989586621682858794"><span class="hs-identifier hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858779"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-5003"></span><span>      </span><span id="local-6989586621682858795"><span class="annot"><a href="#local-6989586621682858795"><span class="hs-identifier hs-var">code_src</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858771"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-5004"></span><span>      </span><span id="local-6989586621682858796"><span class="annot"><a href="#local-6989586621682858796"><span class="hs-identifier hs-var">src_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858779"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-5005"></span><span>      </span><span id="local-6989586621682858797"><span class="annot"><a href="#local-6989586621682858797"><span class="hs-identifier hs-var">tmp_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858779"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-5006"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858793"><span class="hs-identifier hs-type">code_dst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858794"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858795"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858796"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-5007"></span><span>                      </span><span class="annot"><a href="#local-6989586621682858785"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858794"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858796"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858797"><span class="hs-identifier hs-type">tmp_r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromInteger</span></span><span> </span><span class="annot"><a href="#local-6989586621682858772"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5008"></span><span>
</span><span id="line-5009"></span><span class="hs-comment">-- | Set memory to the given byte</span><span>
</span><span id="line-5010"></span><span class="hs-comment">--</span><span>
</span><span id="line-5011"></span><span class="hs-comment">-- Unroll memset calls if the number of bytes to copy isn't too large (cf</span><span>
</span><span id="line-5012"></span><span class="hs-comment">-- ncgInlineThresholdMemset).  Otherwise, call C's memset.</span><span>
</span><span id="line-5013"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemSet"><span class="hs-identifier hs-type">genMemSet</span></a></span><span>
</span><span id="line-5014"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-5015"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-5016"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5017"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5018"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5019"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5020"></span><span id="genMemSet"><span class="annot"><span class="annottext">genMemSet :: Label -&gt; Int -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemSet"><span class="hs-identifier hs-var hs-var">genMemSet</span></a></span></span><span> </span><span id="local-6989586621682858798"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858798"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682858799"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858799"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span id="local-6989586621682858800"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858800"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858801"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858801"><span class="hs-identifier hs-var">arg_c</span></a></span></span><span> </span><span id="local-6989586621682858802"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858802"><span class="hs-identifier hs-var">arg_n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5021"></span><span>
</span><span id="line-5022"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858803"><span class="annot"><span class="annottext">libc_memset :: NatM InstrBlock
</span><a href="#local-6989586621682858803"><span class="hs-identifier hs-var hs-var">libc_memset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858798"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;memset&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858800"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858801"><span class="hs-identifier hs-var">arg_c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858802"><span class="hs-identifier hs-var">arg_n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-5023"></span><span>
</span><span id="line-5024"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858801"><span class="hs-identifier hs-var">arg_c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858802"><span class="hs-identifier hs-var">arg_n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-5025"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682858804"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858804"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682858805"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858805"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5026"></span><span>      </span><span class="hs-comment">-- try to inline it</span><span>
</span><span id="line-5027"></span><span>      </span><span id="local-6989586621682858806"><span class="annot"><a href="#local-6989586621682858806"><span class="hs-identifier hs-var">mcode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; CmmExpr -&gt; Integer -&gt; Integer -&gt; NatM (Maybe InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemSetInlineMaybe"><span class="hs-identifier hs-var">genMemSetInlineMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858799"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858800"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858804"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858805"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-5028"></span><span>      </span><span class="hs-comment">-- if it didn't inline, call the C function</span><span>
</span><span id="line-5029"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682858806"><span class="hs-identifier hs-type">mcode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-5030"></span><span>        </span><span class="annot"><span class="annottext">Maybe InstrBlock
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM InstrBlock
</span><a href="#local-6989586621682858803"><span class="hs-identifier hs-var">libc_memset</span></a></span><span>
</span><span id="line-5031"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682858808"><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858808"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; NatM InstrBlock
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858808"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-5032"></span><span>
</span><span id="line-5033"></span><span>    </span><span class="hs-comment">-- not literal size arguments: call the C function</span><span>
</span><span id="line-5034"></span><span>    </span><span class="annot"><span class="annottext">(CmmExpr, CmmExpr)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NatM InstrBlock
</span><a href="#local-6989586621682858803"><span class="hs-identifier hs-var">libc_memset</span></a></span><span>
</span><span id="line-5035"></span><span>
</span><span id="line-5036"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemSetInlineMaybe"><span class="hs-identifier hs-type">genMemSetInlineMaybe</span></a></span><span>
</span><span id="line-5037"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-5038"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5039"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-5040"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-5041"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5042"></span><span id="genMemSetInlineMaybe"><span class="annot"><span class="annottext">genMemSetInlineMaybe :: Int -&gt; CmmExpr -&gt; Integer -&gt; Integer -&gt; NatM (Maybe InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemSetInlineMaybe"><span class="hs-identifier hs-var hs-var">genMemSetInlineMaybe</span></a></span></span><span> </span><span id="local-6989586621682858809"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858809"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span id="local-6989586621682858810"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858810"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858811"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858811"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682858812"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858812"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5043"></span><span>  </span><span id="local-6989586621682858813"><span class="annot"><a href="#local-6989586621682858813"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-5044"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-5045"></span><span>    </span><span id="local-6989586621682858814"><span class="annot"><a href="#local-6989586621682858814"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858813"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-5046"></span><span>    </span><span id="local-6989586621682858815"><span class="annot"><a href="#local-6989586621682858815"><span class="hs-identifier hs-var hs-var">maxAlignment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Alignment
</span><a href="GHC.Platform.html#wordAlignment"><span class="hs-identifier hs-var">wordAlignment</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858814"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-comment">-- only machine word wide MOVs are supported</span><span>
</span><span id="line-5047"></span><span>    </span><span id="local-6989586621682858816"><span class="annot"><a href="#local-6989586621682858816"><span class="hs-identifier hs-var hs-var">effectiveAlignment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Alignment -&gt; Alignment -&gt; Alignment
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Alignment
</span><a href="GHC.Types.Basic.html#alignmentOf"><span class="hs-identifier hs-var">alignmentOf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858809"><span class="hs-identifier hs-var">align</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Alignment
</span><a href="#local-6989586621682858815"><span class="hs-identifier hs-var">maxAlignment</span></a></span><span>
</span><span id="line-5048"></span><span>    </span><span id="local-6989586621682858817"><span class="annot"><a href="#local-6989586621682858817"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(Width -&gt; Format) -&gt; (Int -&gt; Width) -&gt; Int -&gt; Format
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Width
</span><a href="GHC.Cmm.Type.html#widthFromBytes"><span class="hs-identifier hs-var">widthFromBytes</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Format) -&gt; Int -&gt; Format
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Alignment -&gt; Int
</span><a href="GHC.Types.Basic.html#alignmentBytes"><span class="hs-identifier hs-var">alignmentBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Alignment
</span><a href="#local-6989586621682858816"><span class="hs-identifier hs-var">effectiveAlignment</span></a></span><span>
</span><span id="line-5049"></span><span>    </span><span id="local-6989586621682858818"><span class="annot"><a href="#local-6989586621682858818"><span class="hs-identifier hs-var hs-var">c2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858811"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858811"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-5050"></span><span>    </span><span id="local-6989586621682858819"><span class="annot"><a href="#local-6989586621682858819"><span class="hs-identifier hs-var hs-var">c4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858818"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858818"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-5051"></span><span>    </span><span id="local-6989586621682858820"><span class="annot"><a href="#local-6989586621682858820"><span class="hs-identifier hs-var hs-var">c8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858819"><span class="hs-identifier hs-var">c4</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858819"><span class="hs-identifier hs-var">c4</span></a></span><span>
</span><span id="line-5052"></span><span>
</span><span id="line-5053"></span><span>    </span><span class="hs-comment">-- The number of instructions we will generate (approx). We need 1</span><span>
</span><span id="line-5054"></span><span>    </span><span class="hs-comment">-- instructions per move.</span><span>
</span><span id="line-5055"></span><span>    </span><span id="local-6989586621682858821"><span class="annot"><a href="#local-6989586621682858821"><span class="hs-identifier hs-var hs-var">insns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858812"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858822"><span class="hs-identifier hs-var">sizeBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858822"><span class="hs-identifier hs-var">sizeBytes</span></a></span><span>
</span><span id="line-5056"></span><span>
</span><span id="line-5057"></span><span>    </span><span class="hs-comment">-- The size of each move, in bytes.</span><span>
</span><span id="line-5058"></span><span>    </span><span class="annot"><a href="#local-6989586621682858822"><span class="hs-identifier hs-type">sizeBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-5059"></span><span>    </span><span id="local-6989586621682858822"><span class="annot"><a href="#local-6989586621682858822"><span class="hs-identifier hs-var hs-var">sizeBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Int
</span><a href="GHC.CmmToAsm.Format.html#formatInBytes"><span class="hs-identifier hs-var">formatInBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858817"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5060"></span><span>
</span><span id="line-5061"></span><span>    </span><span class="hs-comment">-- Depending on size returns the widest MOV instruction and its</span><span>
</span><span id="line-5062"></span><span>    </span><span class="hs-comment">-- width.</span><span>
</span><span id="line-5063"></span><span>    </span><span class="annot"><a href="#local-6989586621682858823"><span class="hs-identifier hs-type">gen4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrMode"><span class="hs-identifier hs-type">AddrMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-5064"></span><span>    </span><span id="local-6989586621682858823"><span class="annot"><a href="#local-6989586621682858823"><span class="hs-identifier hs-var hs-var">gen4</span></a></span></span><span> </span><span id="local-6989586621682858824"><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858824"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682858825"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858825"><span class="hs-identifier hs-var">size</span></a></span></span><span>
</span><span id="line-5065"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858825"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-5066"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858819"><span class="hs-identifier hs-var">c4</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858824"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-5067"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858825"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-5068"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858818"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858824"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-5069"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858825"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-5070"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858811"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858824"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-5071"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-5072"></span><span>
</span><span id="line-5073"></span><span>    </span><span class="hs-comment">-- Generates a 64-bit wide MOV instruction from REG to MEM.</span><span>
</span><span id="line-5074"></span><span>    </span><span class="annot"><a href="#local-6989586621682858826"><span class="hs-identifier hs-type">gen8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrMode"><span class="hs-identifier hs-type">AddrMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5075"></span><span>    </span><span id="local-6989586621682858826"><span class="annot"><a href="#local-6989586621682858826"><span class="hs-identifier hs-var hs-var">gen8</span></a></span></span><span> </span><span id="local-6989586621682858827"><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858827"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682858828"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858828"><span class="hs-identifier hs-var">reg8byte</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-5076"></span><span>      </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858817"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858828"><span class="hs-identifier hs-var">reg8byte</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858827"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-5077"></span><span>
</span><span id="line-5078"></span><span>    </span><span class="hs-comment">-- Unrolls memset when the widest MOV is &lt;= 4 bytes.</span><span>
</span><span id="line-5079"></span><span>    </span><span class="annot"><a href="#local-6989586621682858829"><span class="hs-identifier hs-type">go4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5080"></span><span>    </span><span id="local-6989586621682858829"><span class="annot"><a href="#local-6989586621682858829"><span class="hs-identifier hs-var hs-var">go4</span></a></span></span><span> </span><span id="local-6989586621682858830"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858830"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858831"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858831"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-5081"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858831"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">InstrBlock
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-5082"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858832"><span class="hs-identifier hs-var">curMov</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Integer -&gt; InstrBlock
</span><a href="#local-6989586621682858829"><span class="hs-identifier hs-var">go4</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858830"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858831"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858833"><span class="hs-identifier hs-var">curWidth</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5083"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-5084"></span><span>        </span><span id="local-6989586621682858834"><span class="annot"><span class="annottext">possibleWidth :: Integer
</span><a href="#local-6989586621682858834"><span class="hs-identifier hs-var hs-var">possibleWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall a. Ord a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858831"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858822"><span class="hs-identifier hs-var">sizeBytes</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-5085"></span><span>        </span><span id="local-6989586621682858836"><span class="annot"><span class="annottext">dst_addr :: AddrMode
</span><a href="#local-6989586621682858836"><span class="hs-identifier hs-var hs-var">dst_addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858830"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858812"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858831"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-5086"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682858832"><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858832"><span class="hs-identifier hs-var">curMov</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682858833"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858833"><span class="hs-identifier hs-var">curWidth</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrMode -&gt; Integer -&gt; (InstrBlock, Integer)
</span><a href="#local-6989586621682858823"><span class="hs-identifier hs-var">gen4</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858836"><span class="hs-identifier hs-var">dst_addr</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858834"><span class="hs-identifier hs-var">possibleWidth</span></a></span><span>
</span><span id="line-5087"></span><span>
</span><span id="line-5088"></span><span>    </span><span class="hs-comment">-- Unrolls memset when the widest MOV is 8 bytes (thus another Reg</span><span>
</span><span id="line-5089"></span><span>    </span><span class="hs-comment">-- argument). Falls back to go4 when all 8 byte moves are</span><span>
</span><span id="line-5090"></span><span>    </span><span class="hs-comment">-- exhausted.</span><span>
</span><span id="line-5091"></span><span>    </span><span class="annot"><a href="#local-6989586621682858837"><span class="hs-identifier hs-type">go8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5092"></span><span>    </span><span id="local-6989586621682858837"><span class="annot"><a href="#local-6989586621682858837"><span class="hs-identifier hs-var hs-var">go8</span></a></span></span><span> </span><span id="local-6989586621682858838"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858838"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858839"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858839"><span class="hs-identifier hs-var">reg8byte</span></a></span></span><span> </span><span id="local-6989586621682858840"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858840"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-5093"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858841"><span class="hs-identifier hs-var">possibleWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-5094"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858842"><span class="annot"><span class="annottext">curMov :: InstrBlock
</span><a href="#local-6989586621682858842"><span class="hs-identifier hs-var hs-var">curMov</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrMode -&gt; Reg -&gt; InstrBlock
</span><a href="#local-6989586621682858826"><span class="hs-identifier hs-var">gen8</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858843"><span class="hs-identifier hs-var">dst_addr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858839"><span class="hs-identifier hs-var">reg8byte</span></a></span><span>
</span><span id="line-5095"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682858842"><span class="hs-identifier hs-var">curMov</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Integer -&gt; InstrBlock
</span><a href="#local-6989586621682858837"><span class="hs-identifier hs-var">go8</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858838"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858839"><span class="hs-identifier hs-var">reg8byte</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858840"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-5096"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Integer -&gt; InstrBlock
</span><a href="#local-6989586621682858829"><span class="hs-identifier hs-var">go4</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858838"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858840"><span class="hs-identifier hs-var">left</span></a></span><span>
</span><span id="line-5097"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-5098"></span><span>        </span><span id="local-6989586621682858841"><span class="annot"><span class="annottext">possibleWidth :: Integer
</span><a href="#local-6989586621682858841"><span class="hs-identifier hs-var hs-var">possibleWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall a. Ord a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858840"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858822"><span class="hs-identifier hs-var">sizeBytes</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-5099"></span><span>        </span><span id="local-6989586621682858843"><span class="annot"><span class="annottext">dst_addr :: AddrMode
</span><a href="#local-6989586621682858843"><span class="hs-identifier hs-var hs-var">dst_addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EABase -&gt; EAIndex -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; EABase
</span><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858838"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EAIndex
</span><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858812"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682858840"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-5100"></span><span>
</span><span id="line-5101"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromInteger</span></span><span> </span><span class="annot"><a href="#local-6989586621682858821"><span class="hs-identifier hs-type">insns</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgInlineThresholdMemset"><span class="hs-identifier hs-var">ncgInlineThresholdMemset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858813"><span class="hs-identifier hs-type">config</span></a></span><span>
</span><span id="line-5102"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-5103"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5104"></span><span>        </span><span id="local-6989586621682858845"><span class="annot"><a href="#local-6989586621682858845"><span class="hs-identifier hs-var">code_dst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858810"><span class="hs-identifier hs-type">dst</span></a></span><span>
</span><span id="line-5105"></span><span>        </span><span id="local-6989586621682858846"><span class="annot"><a href="#local-6989586621682858846"><span class="hs-identifier hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858817"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-5106"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682858817"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621682858812"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span>
</span><span id="line-5107"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5108"></span><span>            </span><span id="local-6989586621682858847"><span class="annot"><a href="#local-6989586621682858847"><span class="hs-identifier hs-var">code_imm8byte</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858820"><span class="hs-identifier hs-type">c8</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-type">W64</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-5109"></span><span>            </span><span id="local-6989586621682858848"><span class="annot"><a href="#local-6989586621682858848"><span class="hs-identifier hs-var">imm8byte_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span>
</span><span id="line-5110"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858845"><span class="hs-identifier hs-type">code_dst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858846"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-5111"></span><span>                              </span><span class="annot"><a href="#local-6989586621682858847"><span class="hs-identifier hs-type">code_imm8byte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858848"><span class="hs-identifier hs-type">imm8byte_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-5112"></span><span>                              </span><span class="annot"><a href="#local-6989586621682858837"><span class="hs-identifier hs-type">go8</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858846"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858848"><span class="hs-identifier hs-type">imm8byte_r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromInteger</span></span><span> </span><span class="annot"><a href="#local-6989586621682858812"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5113"></span><span>          </span><span class="hs-keyword">else</span><span>
</span><span id="line-5114"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858845"><span class="hs-identifier hs-type">code_dst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858846"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-5115"></span><span>                              </span><span class="annot"><a href="#local-6989586621682858829"><span class="hs-identifier hs-type">go4</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858846"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromInteger</span></span><span> </span><span class="annot"><a href="#local-6989586621682858812"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5116"></span><span>
</span><span id="line-5117"></span><span>
</span><span id="line-5118"></span><span id="local-6989586621682853805"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemMove"><span class="hs-identifier hs-type">genMemMove</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682853805"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span></span><span>
</span><span id="line-5119"></span><span id="genMemMove"><span class="annot"><span class="annottext">genMemMove :: forall p.
Label -&gt; p -&gt; CmmExpr -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemMove"><span class="hs-identifier hs-var hs-var">genMemMove</span></a></span></span><span> </span><span id="local-6989586621682858849"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858849"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682858850"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621682858850"><span class="hs-identifier hs-var">_align</span></a></span></span><span> </span><span id="local-6989586621682858851"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858851"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858852"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858852"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682858853"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858853"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5120"></span><span>  </span><span class="hs-comment">-- TODO: generate inline assembly when under a given threshold (similarly to</span><span>
</span><span id="line-5121"></span><span>  </span><span class="hs-comment">-- memcpy and memset)</span><span>
</span><span id="line-5122"></span><span>  </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858849"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;memmove&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858851"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858852"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858853"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-5123"></span><span>
</span><span id="line-5124"></span><span id="local-6989586621682853806"><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCmp"><span class="hs-identifier hs-type">genMemCmp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682853806"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span></span><span>
</span><span id="line-5125"></span><span id="genMemCmp"><span class="annot"><span class="annottext">genMemCmp :: forall p.
Label
-&gt; p
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genMemCmp"><span class="hs-identifier hs-var hs-var">genMemCmp</span></a></span></span><span> </span><span id="local-6989586621682858854"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858854"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682858855"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621682858855"><span class="hs-identifier hs-var">_align</span></a></span></span><span> </span><span id="local-6989586621682858856"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858856"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span id="local-6989586621682858857"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858857"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858858"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858858"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682858859"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858859"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5126"></span><span>  </span><span class="hs-comment">-- TODO: generate inline assembly when under a given threshold (similarly to</span><span>
</span><span id="line-5127"></span><span>  </span><span class="hs-comment">-- memcpy and memset)</span><span>
</span><span id="line-5128"></span><span>  </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genLibCCall"><span class="hs-identifier hs-var">genLibCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858854"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;memcmp&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858856"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858857"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858858"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858859"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-5129"></span><span>
</span><span id="line-5130"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrefetchData"><span class="hs-identifier hs-type">genPrefetchData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5131"></span><span id="genPrefetchData"><span class="annot"><span class="annottext">genPrefetchData :: Int -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrefetchData"><span class="hs-identifier hs-var hs-var">genPrefetchData</span></a></span></span><span> </span><span id="local-6989586621682858860"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858860"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682858861"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858861"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5132"></span><span>  </span><span id="local-6989586621682858862"><span class="annot"><a href="#local-6989586621682858862"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-5133"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-5134"></span><span>    </span><span id="local-6989586621682858863"><span class="annot"><a href="#local-6989586621682858863"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Format
</span><a href="GHC.CmmToAsm.X86.Instr.html#archWordFormat"><span class="hs-identifier hs-var">archWordFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858862"><span class="hs-identifier hs-var">is32Bit</span></a></span><span>
</span><span id="line-5135"></span><span>    </span><span class="hs-comment">-- need to know what register width for pointers!</span><span>
</span><span id="line-5136"></span><span>    </span><span id="local-6989586621682858864"><span class="annot"><a href="#local-6989586621682858864"><span class="hs-identifier hs-var hs-var">genPrefetch</span></a></span></span><span> </span><span id="local-6989586621682858865"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858865"><span class="hs-identifier hs-var">inRegSrc</span></a></span></span><span> </span><span id="local-6989586621682858866"><span class="annot"><span class="annottext">Operand -&gt; Instr
</span><a href="#local-6989586621682858866"><span class="hs-identifier hs-var">prefetchCTor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5137"></span><span>      </span><span id="local-6989586621682858867"><span class="annot"><a href="#local-6989586621682858867"><span class="hs-identifier hs-var">code_src</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858865"><span class="hs-identifier hs-var">inRegSrc</span></a></span><span>
</span><span id="line-5138"></span><span>      </span><span id="local-6989586621682858868"><span class="annot"><a href="#local-6989586621682858868"><span class="hs-identifier hs-var">src_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858863"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-5139"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858867"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858868"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-5140"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858866"><span class="hs-identifier hs-type">prefetchCTor</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span>
</span><span id="line-5141"></span><span>                    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-type">AddrBaseIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EABaseReg"><span class="hs-identifier hs-type">EABaseReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858868"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="hs-special">)</span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-type">EAIndexNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-5142"></span><span>        </span><span class="hs-comment">-- prefetch always takes an address</span><span>
</span><span id="line-5143"></span><span>
</span><span id="line-5144"></span><span>  </span><span class="hs-comment">-- the c / llvm prefetch convention is 0, 1, 2, and 3</span><span>
</span><span id="line-5145"></span><span>  </span><span class="hs-comment">-- the x86 corresponding names are : NTA, 2 , 1, and 0</span><span>
</span><span id="line-5146"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682858860"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-5147"></span><span>      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; (Operand -&gt; Instr) -&gt; NatM InstrBlock
</span><a href="#local-6989586621682858864"><span class="hs-identifier hs-var">genPrefetch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858861"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">((Operand -&gt; Instr) -&gt; NatM InstrBlock)
-&gt; (Operand -&gt; Instr) -&gt; NatM InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrefetchVariant -&gt; Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#PREFETCH"><span class="hs-identifier hs-var">PREFETCH</span></a></span><span> </span><span class="annot"><span class="annottext">PrefetchVariant
</span><a href="GHC.CmmToAsm.X86.Instr.html#NTA"><span class="hs-identifier hs-var">NTA</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858863"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-5148"></span><span>      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; (Operand -&gt; Instr) -&gt; NatM InstrBlock
</span><a href="#local-6989586621682858864"><span class="hs-identifier hs-var">genPrefetch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858861"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">((Operand -&gt; Instr) -&gt; NatM InstrBlock)
-&gt; (Operand -&gt; Instr) -&gt; NatM InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrefetchVariant -&gt; Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#PREFETCH"><span class="hs-identifier hs-var">PREFETCH</span></a></span><span> </span><span class="annot"><span class="annottext">PrefetchVariant
</span><a href="GHC.CmmToAsm.X86.Instr.html#Lvl2"><span class="hs-identifier hs-var">Lvl2</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858863"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-5149"></span><span>      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; (Operand -&gt; Instr) -&gt; NatM InstrBlock
</span><a href="#local-6989586621682858864"><span class="hs-identifier hs-var">genPrefetch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858861"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">((Operand -&gt; Instr) -&gt; NatM InstrBlock)
-&gt; (Operand -&gt; Instr) -&gt; NatM InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrefetchVariant -&gt; Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#PREFETCH"><span class="hs-identifier hs-var">PREFETCH</span></a></span><span> </span><span class="annot"><span class="annottext">PrefetchVariant
</span><a href="GHC.CmmToAsm.X86.Instr.html#Lvl1"><span class="hs-identifier hs-var">Lvl1</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858863"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-5150"></span><span>      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; (Operand -&gt; Instr) -&gt; NatM InstrBlock
</span><a href="#local-6989586621682858864"><span class="hs-identifier hs-var">genPrefetch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858861"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">((Operand -&gt; Instr) -&gt; NatM InstrBlock)
-&gt; (Operand -&gt; Instr) -&gt; NatM InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrefetchVariant -&gt; Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#PREFETCH"><span class="hs-identifier hs-var">PREFETCH</span></a></span><span> </span><span class="annot"><span class="annottext">PrefetchVariant
</span><a href="GHC.CmmToAsm.X86.Instr.html#Lvl0"><span class="hs-identifier hs-var">Lvl0</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858863"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-5151"></span><span>      </span><span id="local-6989586621682858874"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858874"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; NatM InstrBlock
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genPrefetchData: unexpected prefetch level&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682858874"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5152"></span><span>
</span><span id="line-5153"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genByteSwap"><span class="hs-identifier hs-type">genByteSwap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5154"></span><span id="genByteSwap"><span class="annot"><span class="annottext">genByteSwap :: Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genByteSwap"><span class="hs-identifier hs-var hs-var">genByteSwap</span></a></span></span><span> </span><span id="local-6989586621682858875"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858875"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682858876"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858876"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858877"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858877"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5155"></span><span>  </span><span id="local-6989586621682858878"><span class="annot"><a href="#local-6989586621682858878"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-5156"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858879"><span class="annot"><a href="#local-6989586621682858879"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858875"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-5157"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682858875"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-5158"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682858878"><span class="hs-identifier hs-var">is32Bit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5159"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span> </span><span id="local-6989586621682858880"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858880"><span class="hs-identifier hs-var hs-var">dst_hi</span></a></span></span><span> </span><span id="local-6989586621682858881"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858881"><span class="hs-identifier hs-var hs-var">dst_lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LocalReg -&gt; Reg64
LocalReg -&gt; Reg64
</span><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier hs-var">localReg64</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858876"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-5160"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-type">RegCode64</span></a></span><span> </span><span id="local-6989586621682858882"><span class="annot"><a href="#local-6989586621682858882"><span class="hs-identifier hs-var">vcode</span></a></span></span><span> </span><span id="local-6989586621682858883"><span class="annot"><a href="#local-6989586621682858883"><span class="hs-identifier hs-var">rhi</span></a></span></span><span> </span><span id="local-6989586621682858884"><span class="annot"><a href="#local-6989586621682858884"><span class="hs-identifier hs-var">rlo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (RegCode64 InstrBlock)
CmmExpr -&gt; NatM (RegCode64 InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#iselExpr64"><span class="hs-identifier hs-var">iselExpr64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858877"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-5161"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858882"><span class="hs-identifier hs-type">vcode</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-5162"></span><span>                 </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858884"><span class="hs-identifier hs-type">rlo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858880"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-5163"></span><span>                        </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858883"><span class="hs-identifier hs-type">rhi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858881"><span class="hs-identifier hs-type">dst_lo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-5164"></span><span>                        </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#BSWAP"><span class="hs-identifier hs-type">BSWAP</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858880"><span class="hs-identifier hs-type">dst_hi</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5165"></span><span>                        </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#BSWAP"><span class="hs-identifier hs-type">BSWAP</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858881"><span class="hs-identifier hs-type">dst_lo</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-5166"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5167"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858886"><span class="annot"><span class="annottext">dst_r :: Reg
</span><a href="#local-6989586621682858886"><span class="hs-identifier hs-var hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858876"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-5168"></span><span>        </span><span id="local-6989586621682858887"><span class="annot"><a href="#local-6989586621682858887"><span class="hs-identifier hs-var">code_src</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858877"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-5169"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858887"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858886"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-5170"></span><span>                 </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#BSWAP"><span class="hs-identifier hs-type">BSWAP</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858886"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-5171"></span><span>                 </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#SHR"><span class="hs-identifier hs-type">SHR</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858886"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-5172"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5173"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858888"><span class="annot"><span class="annottext">dst_r :: Reg
</span><a href="#local-6989586621682858888"><span class="hs-identifier hs-var hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858876"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-5174"></span><span>        </span><span id="local-6989586621682858889"><span class="annot"><a href="#local-6989586621682858889"><span class="hs-identifier hs-var">code_src</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858877"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-5175"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858889"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858888"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#BSWAP"><span class="hs-identifier hs-type">BSWAP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858879"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858888"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5176"></span><span>
</span><span id="line-5177"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genBitRev"><span class="hs-identifier hs-type">genBitRev</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5178"></span><span id="genBitRev"><span class="annot"><span class="annottext">genBitRev :: Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genBitRev"><span class="hs-identifier hs-var hs-var">genBitRev</span></a></span></span><span> </span><span id="local-6989586621682858890"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858890"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682858891"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858891"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682858892"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858892"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858893"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858893"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5179"></span><span>  </span><span class="hs-comment">-- Here the C implementation (hs_bitrevN) is used as there is no x86</span><span>
</span><span id="line-5180"></span><span>  </span><span class="hs-comment">-- instruction to reverse a word's bit order.</span><span>
</span><span id="line-5181"></span><span>  </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858890"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; FastString
</span><a href="GHC.CmmToAsm.CPrim.html#bRevLabel"><span class="hs-identifier hs-var">bRevLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858891"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858892"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858893"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-5182"></span><span>
</span><span id="line-5183"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPopCnt"><span class="hs-identifier hs-type">genPopCnt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5184"></span><span id="genPopCnt"><span class="annot"><span class="annottext">genPopCnt :: Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPopCnt"><span class="hs-identifier hs-var hs-var">genPopCnt</span></a></span></span><span> </span><span id="local-6989586621682858895"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858895"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682858896"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858896"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682858897"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858897"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858898"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858898"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5185"></span><span>  </span><span id="local-6989586621682858899"><span class="annot"><a href="#local-6989586621682858899"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-5186"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-5187"></span><span>    </span><span id="local-6989586621682858900"><span class="annot"><a href="#local-6989586621682858900"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858899"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-5188"></span><span>    </span><span id="local-6989586621682858901"><span class="annot"><a href="#local-6989586621682858901"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858896"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-5189"></span><span>
</span><span id="line-5190"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#sse4_2Enabled"><span class="hs-identifier hs-type">sse4_2Enabled</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-5191"></span><span>
</span><span id="line-5192"></span><span>    </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5193"></span><span>      </span><span id="local-6989586621682858902"><span class="annot"><a href="#local-6989586621682858902"><span class="hs-identifier hs-var">code_src</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858898"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-5194"></span><span>      </span><span id="local-6989586621682858903"><span class="annot"><a href="#local-6989586621682858903"><span class="hs-identifier hs-var">src_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858901"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-5195"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858904"><span class="annot"><a href="#local-6989586621682858904"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858900"><span class="hs-identifier hs-var">platform</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalReg -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858897"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5196"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858902"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858903"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-5197"></span><span>          </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682858896"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-type">W8</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-5198"></span><span>               </span><span class="hs-comment">-- The POPCNT instruction doesn't take a r/m8</span><span>
</span><span id="line-5199"></span><span>               </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858903"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858903"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-5200"></span><span>               </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#POPCNT"><span class="hs-identifier hs-type">POPCNT</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-type">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858903"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682858904"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5201"></span><span>           </span><span class="hs-keyword">else</span><span>
</span><span id="line-5202"></span><span>               </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#POPCNT"><span class="hs-identifier hs-type">POPCNT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858901"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858903"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682858904"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-5203"></span><span>          </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682858896"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-type">W8</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="#local-6989586621682858896"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-type">W16</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-5204"></span><span>               </span><span class="hs-comment">-- We used a 16-bit destination register above,</span><span>
</span><span id="line-5205"></span><span>               </span><span class="hs-comment">-- so zero-extend</span><span>
</span><span id="line-5206"></span><span>               </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-type">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858904"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858904"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-5207"></span><span>           </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5208"></span><span>
</span><span id="line-5209"></span><span>    </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-5210"></span><span>      </span><span class="hs-comment">-- generate C call to hs_popcntN in ghc-prim</span><span>
</span><span id="line-5211"></span><span>      </span><span class="hs-comment">-- TODO: we could directly generate the assembly to index popcount_tab</span><span>
</span><span id="line-5212"></span><span>      </span><span class="hs-comment">-- here instead of doing it by calling a C function</span><span>
</span><span id="line-5213"></span><span>      </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858895"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; FastString
</span><a href="GHC.CmmToAsm.CPrim.html#popCntLabel"><span class="hs-identifier hs-var">popCntLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858896"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858897"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858898"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-5214"></span><span>
</span><span id="line-5215"></span><span>
</span><span id="line-5216"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPdep"><span class="hs-identifier hs-type">genPdep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5217"></span><span id="genPdep"><span class="annot"><span class="annottext">genPdep :: Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPdep"><span class="hs-identifier hs-var hs-var">genPdep</span></a></span></span><span> </span><span id="local-6989586621682858907"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858907"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682858908"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858908"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682858909"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858909"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858910"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858910"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682858911"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858911"><span class="hs-identifier hs-var">mask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5218"></span><span>  </span><span id="local-6989586621682858912"><span class="annot"><a href="#local-6989586621682858912"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-5219"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-5220"></span><span>    </span><span id="local-6989586621682858913"><span class="annot"><a href="#local-6989586621682858913"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682858912"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-5221"></span><span>    </span><span id="local-6989586621682858914"><span class="annot"><a href="#local-6989586621682858914"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858908"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-5222"></span><span>
</span><span id="line-5223"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgBmiVersion"><span class="hs-identifier hs-var">ncgBmiVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858912"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="GHC.Platform.html#BMI2"><span class="hs-identifier hs-type">BMI2</span></a></span><span>
</span><span id="line-5224"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5225"></span><span>      </span><span id="local-6989586621682858915"><span class="annot"><a href="#local-6989586621682858915"><span class="hs-identifier hs-var">code_src</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858910"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-5226"></span><span>      </span><span id="local-6989586621682858916"><span class="annot"><a href="#local-6989586621682858916"><span class="hs-identifier hs-var">code_mask</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858911"><span class="hs-identifier hs-type">mask</span></a></span><span>
</span><span id="line-5227"></span><span>      </span><span id="local-6989586621682858917"><span class="annot"><a href="#local-6989586621682858917"><span class="hs-identifier hs-var">src_r</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858914"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-5228"></span><span>      </span><span id="local-6989586621682858918"><span class="annot"><a href="#local-6989586621682858918"><span class="hs-identifier hs-var">mask_r</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858914"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-5229"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858919"><span class="annot"><a href="#local-6989586621682858919"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858913"><span class="hs-identifier hs-var">platform</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalReg -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858909"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5230"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858915"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858917"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858916"><span class="hs-identifier hs-type">code_mask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858918"><span class="hs-identifier hs-type">mask_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-5231"></span><span>          </span><span class="hs-comment">-- PDEP only supports &gt; 32 bit args</span><span>
</span><span id="line-5232"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682858908"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-type">W8</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="#local-6989586621682858908"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-type">W16</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-5233"></span><span>              </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-5234"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858914"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858917"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858917"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-5235"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858914"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858918"><span class="hs-identifier hs-type">mask_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858918"><span class="hs-identifier hs-type">mask_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5236"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#PDEP"><span class="hs-identifier hs-type">PDEP</span></a></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858918"><span class="hs-identifier hs-type">mask_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858917"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682858919"><span class="hs-identifier hs-type">dst_r</span></a></span><span>
</span><span id="line-5237"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858914"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858919"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858919"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Truncate to op width</span><span>
</span><span id="line-5238"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-5239"></span><span>            </span><span class="hs-keyword">else</span><span>
</span><span id="line-5240"></span><span>              </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#PDEP"><span class="hs-identifier hs-type">PDEP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858914"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858918"><span class="hs-identifier hs-type">mask_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858917"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682858919"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5241"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-5242"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-5243"></span><span>      </span><span class="hs-comment">-- generate C call to hs_pdepN in ghc-prim</span><span>
</span><span id="line-5244"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-type">genPrimCCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858907"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.CPrim.html#pdepLabel"><span class="hs-identifier hs-type">pdepLabel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858908"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682858909"><span class="hs-identifier hs-type">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682858910"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682858911"><span class="hs-identifier hs-type">mask</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-5245"></span><span>
</span><span id="line-5246"></span><span>
</span><span id="line-5247"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPext"><span class="hs-identifier hs-type">genPext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5248"></span><span id="genPext"><span class="annot"><span class="annottext">genPext :: Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPext"><span class="hs-identifier hs-var hs-var">genPext</span></a></span></span><span> </span><span id="local-6989586621682858922"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858922"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682858923"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858923"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682858924"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858924"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858925"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858925"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682858926"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858926"><span class="hs-identifier hs-var">mask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5249"></span><span>  </span><span id="local-6989586621682858927"><span class="annot"><a href="#local-6989586621682858927"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-5250"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgBmiVersion"><span class="hs-identifier hs-var">ncgBmiVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858927"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="GHC.Platform.html#BMI2"><span class="hs-identifier hs-type">BMI2</span></a></span><span>
</span><span id="line-5251"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5252"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858928"><span class="annot"><a href="#local-6989586621682858928"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858923"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-5253"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858929"><span class="annot"><a href="#local-6989586621682858929"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858924"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-5254"></span><span>      </span><span id="local-6989586621682858930"><span class="annot"><a href="#local-6989586621682858930"><span class="hs-identifier hs-var">code_src</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858925"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-5255"></span><span>      </span><span id="local-6989586621682858931"><span class="annot"><a href="#local-6989586621682858931"><span class="hs-identifier hs-var">code_mask</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858926"><span class="hs-identifier hs-type">mask</span></a></span><span>
</span><span id="line-5256"></span><span>      </span><span id="local-6989586621682858932"><span class="annot"><a href="#local-6989586621682858932"><span class="hs-identifier hs-var">src_r</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858928"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-5257"></span><span>      </span><span id="local-6989586621682858933"><span class="annot"><a href="#local-6989586621682858933"><span class="hs-identifier hs-var">mask_r</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858928"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-5258"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858930"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858932"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858931"><span class="hs-identifier hs-type">code_mask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858933"><span class="hs-identifier hs-type">mask_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-5259"></span><span>          </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682858923"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-type">W8</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="#local-6989586621682858923"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-type">W16</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-5260"></span><span>               </span><span class="hs-comment">-- The PEXT instruction doesn't take a r/m8 or 16</span><span>
</span><span id="line-5261"></span><span>              </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-5262"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858928"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858932"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858932"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-5263"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858928"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858933"><span class="hs-identifier hs-type">mask_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858933"><span class="hs-identifier hs-type">mask_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5264"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#PEXT"><span class="hs-identifier hs-type">PEXT</span></a></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858933"><span class="hs-identifier hs-type">mask_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858932"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682858929"><span class="hs-identifier hs-type">dst_r</span></a></span><span>
</span><span id="line-5265"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858928"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858929"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858929"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Truncate to op width</span><span>
</span><span id="line-5266"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-5267"></span><span>            </span><span class="hs-keyword">else</span><span>
</span><span id="line-5268"></span><span>              </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#PEXT"><span class="hs-identifier hs-type">PEXT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858928"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858933"><span class="hs-identifier hs-type">mask_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858932"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682858929"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5269"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-5270"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-5271"></span><span>      </span><span class="hs-comment">-- generate C call to hs_pextN in ghc-prim</span><span>
</span><span id="line-5272"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-type">genPrimCCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858922"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.CPrim.html#pextLabel"><span class="hs-identifier hs-type">pextLabel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858923"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682858924"><span class="hs-identifier hs-type">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682858925"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682858926"><span class="hs-identifier hs-type">mask</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-5273"></span><span>
</span><span id="line-5274"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genClz"><span class="hs-identifier hs-type">genClz</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5275"></span><span id="genClz"><span class="annot"><span class="annottext">genClz :: Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genClz"><span class="hs-identifier hs-var hs-var">genClz</span></a></span></span><span> </span><span id="local-6989586621682858936"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858936"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682858937"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858937"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682858938"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858938"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858939"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858939"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5276"></span><span>  </span><span id="local-6989586621682858940"><span class="annot"><a href="#local-6989586621682858940"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-5277"></span><span>  </span><span id="local-6989586621682858941"><span class="annot"><a href="#local-6989586621682858941"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span>
</span><span id="line-5278"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682858940"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621682858937"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-type">W64</span></a></span><span>
</span><span id="line-5279"></span><span>
</span><span id="line-5280"></span><span>    </span><span class="hs-keyword">then</span><span>
</span><span id="line-5281"></span><span>      </span><span class="hs-comment">-- Fallback to `hs_clz64` on i386</span><span>
</span><span id="line-5282"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-type">genPrimCCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858936"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.CPrim.html#clzLabel"><span class="hs-identifier hs-type">clzLabel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858937"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682858938"><span class="hs-identifier hs-type">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682858939"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-5283"></span><span>
</span><span id="line-5284"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5285"></span><span>      </span><span id="local-6989586621682858943"><span class="annot"><a href="#local-6989586621682858943"><span class="hs-identifier hs-var">code_src</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858939"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-5286"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858944"><span class="annot"><a href="#local-6989586621682858944"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858938"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-5287"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgBmiVersion"><span class="hs-identifier hs-var">ncgBmiVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858941"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="GHC.Platform.html#BMI2"><span class="hs-identifier hs-type">BMI2</span></a></span><span>
</span><span id="line-5288"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5289"></span><span>          </span><span id="local-6989586621682858945"><span class="annot"><a href="#local-6989586621682858945"><span class="hs-identifier hs-var">src_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858937"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5290"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-identifier hs-type">appOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858943"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858945"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682858937"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-5291"></span><span>            </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-5292"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858945"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858945"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- zero-extend to 32 bit</span><span>
</span><span id="line-5293"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LZCNT"><span class="hs-identifier hs-var">LZCNT</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858945"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span>       </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858944"><span class="hs-identifier hs-var">dst_r</span></a></span><span>         </span><span class="hs-comment">-- lzcnt with extra 24 zeros</span><span>
</span><span id="line-5294"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span>    </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">24</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858944"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- compensate for extra zeros</span><span>
</span><span id="line-5295"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-5296"></span><span>            </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-5297"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LZCNT"><span class="hs-identifier hs-var">LZCNT</span></a></span><span>  </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858945"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858944"><span class="hs-identifier hs-var">dst_r</span></a></span><span>
</span><span id="line-5298"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858944"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858944"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- zero-extend from 16 bit</span><span>
</span><span id="line-5299"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-5300"></span><span>            </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LZCNT"><span class="hs-identifier hs-var">LZCNT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858937"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858945"><span class="hs-identifier hs-var">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858944"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5301"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5302"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858947"><span class="annot"><a href="#local-6989586621682858947"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858937"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II16"><span class="hs-identifier hs-var">II16</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858937"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-5303"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858948"><span class="annot"><a href="#local-6989586621682858948"><span class="hs-identifier hs-var hs-var">bw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBits"><span class="hs-identifier hs-var">widthInBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858937"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-5304"></span><span>          </span><span id="local-6989586621682858949"><span class="annot"><a href="#local-6989586621682858949"><span class="hs-identifier hs-var">src_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858947"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-5305"></span><span>          </span><span id="local-6989586621682858950"><span class="annot"><a href="#local-6989586621682858950"><span class="hs-identifier hs-var">tmp_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858947"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-5306"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858943"><span class="hs-identifier hs-type">code_src</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858949"><span class="hs-identifier hs-type">src_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-5307"></span><span>                   </span><span class="hs-special">(</span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-type">MOVZxL</span></a></span><span>   </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858949"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858949"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621682858937"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-type">W8</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span>
</span><span id="line-5308"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#BSR"><span class="hs-identifier hs-type">BSR</span></a></span><span>      </span><span class="annot"><a href="#local-6989586621682858947"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858949"><span class="hs-identifier hs-type">src_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682858950"><span class="hs-identifier hs-type">tmp_r</span></a></span><span>
</span><span id="line-5309"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-type">II32</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span class="annot"><span class="hs-operator hs-type">*</span></span><span class="annot"><a href="#local-6989586621682858948"><span class="hs-identifier hs-type">bw</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858944"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5310"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#CMOV"><span class="hs-identifier hs-type">CMOV</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#NE"><span class="hs-identifier hs-type">NE</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621682858947"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858950"><span class="hs-identifier hs-type">tmp_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682858944"><span class="hs-identifier hs-type">dst_r</span></a></span><span>
</span><span id="line-5311"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-type">XOR</span></a></span><span>      </span><span class="annot"><a href="#local-6989586621682858947"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858948"><span class="hs-identifier hs-type">bw</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858944"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5312"></span><span>                    </span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- NB: We don't need to zero-extend the result for the</span><span>
</span><span id="line-5313"></span><span>                       </span><span class="hs-comment">-- W8/W16 cases because the 'MOV' insn already</span><span>
</span><span id="line-5314"></span><span>                       </span><span class="hs-comment">-- took care of implicitly clearing the upper bits</span><span>
</span><span id="line-5315"></span><span>
</span><span id="line-5316"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genWordToFloat"><span class="hs-identifier hs-type">genWordToFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5317"></span><span id="genWordToFloat"><span class="annot"><span class="annottext">genWordToFloat :: Label -&gt; Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genWordToFloat"><span class="hs-identifier hs-var hs-var">genWordToFloat</span></a></span></span><span> </span><span id="local-6989586621682858952"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858952"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682858953"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858953"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682858954"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858954"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858955"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858955"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-5318"></span><span>  </span><span class="hs-comment">-- TODO: generate assembly instead</span><span>
</span><span id="line-5319"></span><span>  </span><span class="annot"><span class="annottext">Label -&gt; FastString -&gt; [LocalReg] -&gt; [CmmExpr] -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-var">genPrimCCall</span></a></span><span> </span><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858952"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; FastString
</span><a href="GHC.CmmToAsm.CPrim.html#word2FloatLabel"><span class="hs-identifier hs-var">word2FloatLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858953"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858954"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858955"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-5320"></span><span>
</span><span id="line-5321"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicRead"><span class="hs-identifier hs-type">genAtomicRead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MemoryOrdering"><span class="hs-identifier hs-type">MemoryOrdering</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5322"></span><span id="genAtomicRead"><span class="annot"><span class="annottext">genAtomicRead :: Width -&gt; MemoryOrdering -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicRead"><span class="hs-identifier hs-var hs-var">genAtomicRead</span></a></span></span><span> </span><span id="local-6989586621682858957"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858957"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682858958"><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682858958"><span class="hs-identifier hs-var">_mord</span></a></span></span><span> </span><span id="local-6989586621682858959"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858959"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858960"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858960"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5323"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858961"><span class="annot"><span class="annottext">fmt :: Format
</span><a href="#local-6989586621682858961"><span class="hs-identifier hs-var hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858957"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-5324"></span><span>  </span><span id="local-6989586621682858962"><span class="annot"><a href="#local-6989586621682858962"><span class="hs-identifier hs-var">load_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Operand -&gt; Instr)
-&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#intLoadCode"><span class="hs-identifier hs-var">intLoadCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858961"><span class="hs-identifier hs-var">fmt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858960"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-5325"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858962"><span class="hs-identifier hs-type">load_code</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-type">getLocalRegReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858959"><span class="hs-identifier hs-type">dst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-5326"></span><span>
</span><span id="line-5327"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicWrite"><span class="hs-identifier hs-type">genAtomicWrite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MemoryOrdering"><span class="hs-identifier hs-type">MemoryOrdering</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5328"></span><span id="genAtomicWrite"><span class="annot"><span class="annottext">genAtomicWrite :: Width -&gt; MemoryOrdering -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAtomicWrite"><span class="hs-identifier hs-var hs-var">genAtomicWrite</span></a></span></span><span> </span><span id="local-6989586621682858963"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858963"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682858964"><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682858964"><span class="hs-identifier hs-var">mord</span></a></span></span><span> </span><span id="local-6989586621682858965"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858965"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682858966"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858966"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5329"></span><span>  </span><span id="local-6989586621682858967"><span class="annot"><a href="#local-6989586621682858967"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#assignMem_IntCode"><span class="hs-identifier hs-var">assignMem_IntCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858963"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858965"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858966"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-5330"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858968"><span class="annot"><a href="#local-6989586621682858968"><span class="hs-identifier hs-var hs-var">needs_fence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682858964"><span class="hs-identifier hs-var">mord</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-5331"></span><span>        </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="GHC.Cmm.MachOp.html#MemOrderSeqCst"><span class="hs-identifier hs-var">MemOrderSeqCst</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-5332"></span><span>        </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="GHC.Cmm.MachOp.html#MemOrderRelease"><span class="hs-identifier hs-var">MemOrderRelease</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-5333"></span><span>        </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="GHC.Cmm.MachOp.html#MemOrderAcquire"><span class="hs-identifier hs-var">MemOrderAcquire</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Bool
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genAtomicWrite: acquire ordering on write&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-5334"></span><span>        </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="GHC.Cmm.MachOp.html#MemOrderRelaxed"><span class="hs-identifier hs-var">MemOrderRelaxed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-5335"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682858968"><span class="hs-identifier hs-type">needs_fence</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="#local-6989586621682858967"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MFENCE"><span class="hs-identifier hs-type">MFENCE</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621682858967"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-5336"></span><span>
</span><span id="line-5337"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genCmpXchg"><span class="hs-identifier hs-type">genCmpXchg</span></a></span><span>
</span><span id="line-5338"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-5339"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-5340"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-5341"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5342"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5343"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5344"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5345"></span><span id="genCmpXchg"><span class="annot"><span class="annottext">genCmpXchg :: Label
-&gt; Width
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genCmpXchg"><span class="hs-identifier hs-var hs-var">genCmpXchg</span></a></span></span><span> </span><span id="local-6989586621682858974"><span class="annot"><span class="annottext">Label
</span><a href="#local-6989586621682858974"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682858975"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858975"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682858976"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858976"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858977"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858977"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682858978"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858978"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621682858979"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858979"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5346"></span><span>  </span><span id="local-6989586621682858980"><span class="annot"><a href="#local-6989586621682858980"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-5347"></span><span>  </span><span class="hs-comment">-- On x86 we don't have enough registers to use cmpxchg with a</span><span>
</span><span id="line-5348"></span><span>  </span><span class="hs-comment">-- complicated addressing mode, so on that architecture we</span><span>
</span><span id="line-5349"></span><span>  </span><span class="hs-comment">-- pre-compute the address first.</span><span>
</span><span id="line-5350"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858980"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621682858975"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-type">W64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5351"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5352"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858981"><span class="annot"><a href="#local-6989586621682858981"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858975"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-5353"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682858982"><span class="annot"><a href="#local-6989586621682858982"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span id="local-6989586621682858983"><span class="annot"><a href="#local-6989586621682858983"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSimpleAmode"><span class="hs-identifier hs-type">getSimpleAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858977"><span class="hs-identifier hs-type">addr</span></a></span><span>
</span><span id="line-5354"></span><span>      </span><span id="local-6989586621682858984"><span class="annot"><a href="#local-6989586621682858984"><span class="hs-identifier hs-var">newval</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858981"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-5355"></span><span>      </span><span id="local-6989586621682858985"><span class="annot"><a href="#local-6989586621682858985"><span class="hs-identifier hs-var">newval_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858979"><span class="hs-identifier hs-type">new</span></a></span><span>
</span><span id="line-5356"></span><span>      </span><span id="local-6989586621682858986"><span class="annot"><a href="#local-6989586621682858986"><span class="hs-identifier hs-var">oldval</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858981"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-5357"></span><span>      </span><span id="local-6989586621682858987"><span class="annot"><a href="#local-6989586621682858987"><span class="hs-identifier hs-var">oldval_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858978"><span class="hs-identifier hs-type">old</span></a></span><span>
</span><span id="line-5358"></span><span>      </span><span id="local-6989586621682858988"><span class="annot"><a href="#local-6989586621682858988"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-5359"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682858989"><span class="annot"><a href="#local-6989586621682858989"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682858988"><span class="hs-identifier hs-var">platform</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalReg -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858976"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5360"></span><span>          </span><span id="local-6989586621682858990"><span class="annot"><a href="#local-6989586621682858990"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-5361"></span><span>                     </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858981"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858986"><span class="hs-identifier hs-var">oldval</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5362"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#LOCK"><span class="hs-identifier hs-var">LOCK</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CMPXCHG"><span class="hs-identifier hs-var">CMPXCHG</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858981"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858984"><span class="hs-identifier hs-var">newval</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858982"><span class="hs-identifier hs-var">amode</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-5363"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682858981"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858989"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5364"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-5365"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858983"><span class="hs-identifier hs-type">addr_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858985"><span class="hs-identifier hs-type">newval_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858984"><span class="hs-identifier hs-type">newval</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858987"><span class="hs-identifier hs-type">oldval_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858986"><span class="hs-identifier hs-type">oldval</span></a></span><span>
</span><span id="line-5366"></span><span>          </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858990"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-5367"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-5368"></span><span>      </span><span class="hs-comment">-- generate C call to hs_cmpxchgN in ghc-prim</span><span>
</span><span id="line-5369"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genPrimCCall"><span class="hs-identifier hs-type">genPrimCCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858974"><span class="hs-identifier hs-type">bid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.CPrim.html#cmpxchgLabel"><span class="hs-identifier hs-type">cmpxchgLabel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858975"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682858976"><span class="hs-identifier hs-type">dst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682858977"><span class="hs-identifier hs-type">addr</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682858978"><span class="hs-identifier hs-type">old</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682858979"><span class="hs-identifier hs-type">new</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-5370"></span><span>      </span><span class="hs-comment">-- TODO: implement cmpxchg8b instruction</span><span>
</span><span id="line-5371"></span><span>
</span><span id="line-5372"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genXchg"><span class="hs-identifier hs-type">genXchg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5373"></span><span id="genXchg"><span class="annot"><span class="annottext">genXchg :: Width -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genXchg"><span class="hs-identifier hs-var hs-var">genXchg</span></a></span></span><span> </span><span id="local-6989586621682858992"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858992"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682858993"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858993"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682858994"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858994"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682858995"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682858995"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5374"></span><span>  </span><span id="local-6989586621682858996"><span class="annot"><a href="#local-6989586621682858996"><span class="hs-identifier hs-var">is32Bit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Bool
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#is32BitPlatform"><span class="hs-identifier hs-var">is32BitPlatform</span></a></span><span>
</span><span id="line-5375"></span><span>
</span><span id="line-5376"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682858996"><span class="hs-identifier hs-type">is32Bit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621682858992"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-type">W64</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-5377"></span><span>    </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-type">panic</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;genXchg: 64bit atomic exchange not supported on 32bit platforms&quot;</span></span><span>
</span><span id="line-5378"></span><span>
</span><span id="line-5379"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682858997"><span class="annot"><a href="#local-6989586621682858997"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span id="local-6989586621682858998"><span class="annot"><a href="#local-6989586621682858998"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSimpleAmode"><span class="hs-identifier hs-type">getSimpleAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858994"><span class="hs-identifier hs-type">addr</span></a></span><span>
</span><span id="line-5380"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682858999"><span class="annot"><a href="#local-6989586621682858999"><span class="hs-identifier hs-var">newval</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682859000"><span class="annot"><a href="#local-6989586621682859000"><span class="hs-identifier hs-var">newval_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682858995"><span class="hs-identifier hs-type">value</span></a></span><span>
</span><span id="line-5381"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682859001"><span class="annot"><a href="#local-6989586621682859001"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682858992"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-5382"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682859002"><span class="annot"><a href="#local-6989586621682859002"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682858993"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-5383"></span><span>  </span><span class="hs-comment">-- Copy the value into the target register, perform the exchange.</span><span>
</span><span id="line-5384"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682859003"><span class="annot"><a href="#local-6989586621682859003"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-5385"></span><span>                 </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682859001"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682858999"><span class="hs-identifier hs-var">newval</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682859002"><span class="hs-identifier hs-var">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5386"></span><span>                  </span><span class="hs-comment">-- On X86 xchg implies a lock prefix if we use a memory argument.</span><span>
</span><span id="line-5387"></span><span>                  </span><span class="hs-comment">-- so this is atomic.</span><span>
</span><span id="line-5388"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XCHG"><span class="hs-identifier hs-var">XCHG</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682859001"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682858997"><span class="hs-identifier hs-var">amode</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682859002"><span class="hs-identifier hs-var">dst_r</span></a></span><span>
</span><span id="line-5389"></span><span>                 </span><span class="hs-special">]</span><span>
</span><span id="line-5390"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682858998"><span class="hs-identifier hs-type">addr_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859000"><span class="hs-identifier hs-type">newval_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859003"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-5391"></span><span>
</span><span id="line-5392"></span><span>
</span><span id="line-5393"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genFloatAbs"><span class="hs-identifier hs-type">genFloatAbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5394"></span><span id="genFloatAbs"><span class="annot"><span class="annottext">genFloatAbs :: Width -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genFloatAbs"><span class="hs-identifier hs-var hs-var">genFloatAbs</span></a></span></span><span> </span><span id="local-6989586621682859005"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682859005"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682859006"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859006"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682859007"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859007"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5395"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-5396"></span><span>    </span><span id="local-6989586621682859008"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682859008"><span class="hs-identifier hs-var hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682859005"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-5397"></span><span>    </span><span id="local-6989586621682859009"><span class="annot"><span class="annottext">const :: CmmLit
</span><a href="#local-6989586621682859009"><span class="hs-identifier hs-var hs-var hs-var">const</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682859005"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-5398"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0x7fffffff</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>
</span><span id="line-5399"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0x7fffffffffffffff</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span>
</span><span id="line-5400"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; CmmLit
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genFloatAbs: invalid width&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682859005"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5401"></span><span>  </span><span id="local-6989586621682859010"><span class="annot"><a href="#local-6989586621682859010"><span class="hs-identifier hs-var">src_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859007"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-5402"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682859011"><span class="annot"><a href="#local-6989586621682859011"><span class="hs-identifier hs-var">amode</span></a></span></span><span> </span><span id="local-6989586621682859012"><span class="annot"><a href="#local-6989586621682859012"><span class="hs-identifier hs-var">amode_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#memConstant"><span class="hs-identifier hs-type">memConstant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#mkAlignment"><span class="hs-identifier hs-type">mkAlignment</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#widthInBytes"><span class="hs-identifier hs-type">widthInBytes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859005"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682859009"><span class="hs-identifier hs-type">const</span></a></span><span>
</span><span id="line-5403"></span><span>  </span><span id="local-6989586621682859013"><span class="annot"><a href="#local-6989586621682859013"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859008"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-5404"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682859014"><span class="annot"><a href="#local-6989586621682859014"><span class="hs-identifier hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859006"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-5405"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682859010"><span class="hs-identifier hs-type">src_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859014"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859012"><span class="hs-identifier hs-type">amode_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-5406"></span><span>           </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859008"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859011"><span class="hs-identifier hs-type">amode</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859013"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5407"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#AND"><span class="hs-identifier hs-type">AND</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859008"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859013"><span class="hs-identifier hs-type">tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859014"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5408"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-5409"></span><span>
</span><span id="line-5410"></span><span>
</span><span id="line-5411"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genFloatSqrt"><span class="hs-identifier hs-type">genFloatSqrt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5412"></span><span id="genFloatSqrt"><span class="annot"><span class="annottext">genFloatSqrt :: Format -&gt; LocalReg -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genFloatSqrt"><span class="hs-identifier hs-var hs-var">genFloatSqrt</span></a></span></span><span> </span><span id="local-6989586621682859015"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682859015"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span id="local-6989586621682859016"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859016"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621682859017"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859017"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5413"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682859018"><span class="annot"><span class="annottext">dst_r :: Reg
</span><a href="#local-6989586621682859018"><span class="hs-identifier hs-var hs-var hs-var">dst_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859016"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-5414"></span><span>  </span><span id="local-6989586621682859019"><span class="annot"><a href="#local-6989586621682859019"><span class="hs-identifier hs-var">src_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859017"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-5415"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682859019"><span class="hs-identifier hs-type">src_code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859018"><span class="hs-identifier hs-type">dst_r</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#SQRT"><span class="hs-identifier hs-type">SQRT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859015"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859018"><span class="hs-identifier hs-type">dst_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682859018"><span class="hs-identifier hs-type">dst_r</span></a></span><span>
</span><span id="line-5416"></span><span>
</span><span id="line-5417"></span><span>
</span><span id="line-5418"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddSubRetCarry"><span class="hs-identifier hs-type">genAddSubRetCarry</span></a></span><span>
</span><span id="line-5419"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-5420"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5421"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-5422"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span>
</span><span id="line-5423"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-5424"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-5425"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5426"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5427"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5428"></span><span id="genAddSubRetCarry"><span class="annot"><span class="annottext">genAddSubRetCarry :: Width
-&gt; (Format -&gt; Operand -&gt; Operand -&gt; Instr)
-&gt; (Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr))
-&gt; Cond
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddSubRetCarry"><span class="hs-identifier hs-var hs-var">genAddSubRetCarry</span></a></span></span><span> </span><span id="local-6989586621682859021"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682859021"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682859022"><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682859022"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621682859023"><span class="annot"><span class="annottext">Format -&gt; Maybe (Operand -&gt; Operand -&gt; Instr)
</span><a href="#local-6989586621682859023"><span class="hs-identifier hs-var">mrevinstr</span></a></span></span><span> </span><span id="local-6989586621682859024"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682859024"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682859025"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859025"><span class="hs-identifier hs-var">res_r</span></a></span></span><span> </span><span id="local-6989586621682859026"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859026"><span class="hs-identifier hs-var">res_c</span></a></span></span><span> </span><span id="local-6989586621682859027"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859027"><span class="hs-identifier hs-var">arg_x</span></a></span></span><span> </span><span id="local-6989586621682859028"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859028"><span class="hs-identifier hs-var">arg_y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5429"></span><span>  </span><span id="local-6989586621682859029"><span class="annot"><a href="#local-6989586621682859029"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">(NCGConfig -&gt; Platform) -&gt; NatM NCGConfig -&gt; NatM Platform
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-5430"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682859030"><span class="annot"><a href="#local-6989586621682859030"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682859021"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-5431"></span><span>  </span><span id="local-6989586621682859031"><span class="annot"><a href="#local-6989586621682859031"><span class="hs-identifier hs-var">rCode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#anyReg"><span class="hs-identifier hs-type">anyReg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode"><span class="hs-identifier hs-type">trivialCode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859021"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682859022"><span class="hs-identifier hs-type">instr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859030"><span class="hs-identifier hs-type">format</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5432"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682859023"><span class="hs-identifier hs-type">mrevinstr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859030"><span class="hs-identifier hs-type">format</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682859027"><span class="hs-identifier hs-type">arg_x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859028"><span class="hs-identifier hs-type">arg_y</span></a></span><span>
</span><span id="line-5433"></span><span>  </span><span id="local-6989586621682859032"><span class="annot"><a href="#local-6989586621682859032"><span class="hs-identifier hs-var">reg_tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span>
</span><span id="line-5434"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682859033"><span class="annot"><a href="#local-6989586621682859033"><span class="hs-identifier hs-var hs-var">reg_c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682859029"><span class="hs-identifier hs-var">platform</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalReg -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859026"><span class="hs-identifier hs-var">res_c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5435"></span><span>      </span><span id="local-6989586621682859034"><span class="annot"><a href="#local-6989586621682859034"><span class="hs-identifier hs-var hs-var">reg_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682859029"><span class="hs-identifier hs-var">platform</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalReg -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859025"><span class="hs-identifier hs-var">res_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5436"></span><span>      </span><span id="local-6989586621682859035"><span class="annot"><a href="#local-6989586621682859035"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682859031"><span class="hs-identifier hs-var">rCode</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682859034"><span class="hs-identifier hs-var">reg_r</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-5437"></span><span>             </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682859024"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682859032"><span class="hs-identifier hs-var">reg_tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-5438"></span><span>             </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682859032"><span class="hs-identifier hs-var">reg_tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682859033"><span class="hs-identifier hs-var">reg_c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5439"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682859035"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-5440"></span><span>
</span><span id="line-5441"></span><span>
</span><span id="line-5442"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddWithCarry"><span class="hs-identifier hs-type">genAddWithCarry</span></a></span><span>
</span><span id="line-5443"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-5444"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-5445"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-5446"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5447"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5448"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5449"></span><span id="genAddWithCarry"><span class="annot"><span class="annottext">genAddWithCarry :: Width
-&gt; LocalReg -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genAddWithCarry"><span class="hs-identifier hs-var hs-var">genAddWithCarry</span></a></span></span><span> </span><span id="local-6989586621682859036"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682859036"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682859037"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859037"><span class="hs-identifier hs-var">res_h</span></a></span></span><span> </span><span id="local-6989586621682859038"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859038"><span class="hs-identifier hs-var">res_l</span></a></span></span><span> </span><span id="local-6989586621682859039"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859039"><span class="hs-identifier hs-var">arg_x</span></a></span></span><span> </span><span id="local-6989586621682859040"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859040"><span class="hs-identifier hs-var">arg_y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5450"></span><span>  </span><span id="local-6989586621682859041"><span class="annot"><a href="#local-6989586621682859041"><span class="hs-identifier hs-var">hCode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682859036"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-5451"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682859042"><span class="annot"><a href="#local-6989586621682859042"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682859036"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-5452"></span><span>  </span><span id="local-6989586621682859043"><span class="annot"><a href="#local-6989586621682859043"><span class="hs-identifier hs-var">lCode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#anyReg"><span class="hs-identifier hs-type">anyReg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#trivialCode"><span class="hs-identifier hs-type">trivialCode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859036"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#ADD_CC"><span class="hs-identifier hs-type">ADD_CC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859042"><span class="hs-identifier hs-type">format</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5453"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#ADD_CC"><span class="hs-identifier hs-type">ADD_CC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859042"><span class="hs-identifier hs-type">format</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682859039"><span class="hs-identifier hs-type">arg_x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859040"><span class="hs-identifier hs-type">arg_y</span></a></span><span>
</span><span id="line-5454"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682859044"><span class="annot"><a href="#local-6989586621682859044"><span class="hs-identifier hs-var hs-var">reg_l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859038"><span class="hs-identifier hs-var">res_l</span></a></span><span>
</span><span id="line-5455"></span><span>      </span><span id="local-6989586621682859045"><span class="annot"><a href="#local-6989586621682859045"><span class="hs-identifier hs-var hs-var">reg_h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859037"><span class="hs-identifier hs-var">res_h</span></a></span><span>
</span><span id="line-5456"></span><span>      </span><span id="local-6989586621682859046"><span class="annot"><a href="#local-6989586621682859046"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682859041"><span class="hs-identifier hs-var">hCode</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682859045"><span class="hs-identifier hs-var">reg_h</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-5457"></span><span>             </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682859043"><span class="hs-identifier hs-var">lCode</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682859044"><span class="hs-identifier hs-var">reg_l</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Instr -&gt; InstrBlock
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-5458"></span><span>             </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#ADC"><span class="hs-identifier hs-var">ADC</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682859042"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.X86.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682859045"><span class="hs-identifier hs-var">reg_h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5459"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682859046"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-5460"></span><span>
</span><span id="line-5461"></span><span>
</span><span id="line-5462"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genSignedLargeMul"><span class="hs-identifier hs-type">genSignedLargeMul</span></a></span><span>
</span><span id="line-5463"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-5464"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-5465"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-5466"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-5467"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5468"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5469"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5470"></span><span id="genSignedLargeMul"><span class="annot"><span class="annottext">genSignedLargeMul :: Width
-&gt; LocalReg
-&gt; LocalReg
-&gt; LocalReg
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genSignedLargeMul"><span class="hs-identifier hs-var hs-var">genSignedLargeMul</span></a></span></span><span> </span><span id="local-6989586621682859047"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682859047"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682859048"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859048"><span class="hs-identifier hs-var">res_c</span></a></span></span><span> </span><span id="local-6989586621682859049"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859049"><span class="hs-identifier hs-var">res_h</span></a></span></span><span> </span><span id="local-6989586621682859050"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859050"><span class="hs-identifier hs-var">res_l</span></a></span></span><span> </span><span id="local-6989586621682859051"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859051"><span class="hs-identifier hs-var">arg_x</span></a></span></span><span> </span><span id="local-6989586621682859052"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859052"><span class="hs-identifier hs-var">arg_y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5471"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682859053"><span class="annot"><a href="#local-6989586621682859053"><span class="hs-identifier hs-var">y_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682859054"><span class="annot"><a href="#local-6989586621682859054"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegOrMem"><span class="hs-identifier hs-var">getRegOrMem</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859052"><span class="hs-identifier hs-var">arg_y</span></a></span><span>
</span><span id="line-5472"></span><span>  </span><span id="local-6989586621682859055"><span class="annot"><a href="#local-6989586621682859055"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859051"><span class="hs-identifier hs-type">arg_x</span></a></span><span>
</span><span id="line-5473"></span><span>  </span><span id="local-6989586621682859056"><span class="annot"><a href="#local-6989586621682859056"><span class="hs-identifier hs-var">reg_tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-type">II8</span></a></span><span>
</span><span id="line-5474"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682859057"><span class="annot"><a href="#local-6989586621682859057"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682859047"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-5475"></span><span>      </span><span id="local-6989586621682859058"><span class="annot"><a href="#local-6989586621682859058"><span class="hs-identifier hs-var hs-var">reg_h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859049"><span class="hs-identifier hs-var">res_h</span></a></span><span>
</span><span id="line-5476"></span><span>      </span><span id="local-6989586621682859059"><span class="annot"><a href="#local-6989586621682859059"><span class="hs-identifier hs-var hs-var">reg_l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859050"><span class="hs-identifier hs-var">res_l</span></a></span><span>
</span><span id="line-5477"></span><span>      </span><span id="local-6989586621682859060"><span class="annot"><a href="#local-6989586621682859060"><span class="hs-identifier hs-var hs-var">reg_c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859048"><span class="hs-identifier hs-var">res_c</span></a></span><span>
</span><span id="line-5478"></span><span>      </span><span id="local-6989586621682859061"><span class="annot"><a href="#local-6989586621682859061"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682859054"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-5479"></span><span>             </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682859055"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rax"><span class="hs-identifier hs-var">rax</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-5480"></span><span>             </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IMUL2"><span class="hs-identifier hs-var">IMUL2</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682859057"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682859053"><span class="hs-identifier hs-var">y_reg</span></a></span><span>
</span><span id="line-5481"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682859057"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rdx"><span class="hs-identifier hs-var">rdx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682859058"><span class="hs-identifier hs-var">reg_h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5482"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682859057"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rax"><span class="hs-identifier hs-var">rax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682859059"><span class="hs-identifier hs-var">reg_l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5483"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.X86.Cond.html#CARRY"><span class="hs-identifier hs-var">CARRY</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682859056"><span class="hs-identifier hs-var">reg_tmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5484"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II8"><span class="hs-identifier hs-var">II8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682859056"><span class="hs-identifier hs-var">reg_tmp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682859060"><span class="hs-identifier hs-var">reg_c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5485"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-5486"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682859061"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-5487"></span><span>
</span><span id="line-5488"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genUnsignedLargeMul"><span class="hs-identifier hs-type">genUnsignedLargeMul</span></a></span><span>
</span><span id="line-5489"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-5490"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-5491"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-5492"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5493"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5494"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5495"></span><span id="genUnsignedLargeMul"><span class="annot"><span class="annottext">genUnsignedLargeMul :: Width
-&gt; LocalReg -&gt; LocalReg -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genUnsignedLargeMul"><span class="hs-identifier hs-var hs-var">genUnsignedLargeMul</span></a></span></span><span> </span><span id="local-6989586621682859063"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682859063"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682859064"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859064"><span class="hs-identifier hs-var">res_h</span></a></span></span><span> </span><span id="local-6989586621682859065"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859065"><span class="hs-identifier hs-var">res_l</span></a></span></span><span> </span><span id="local-6989586621682859066"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859066"><span class="hs-identifier hs-var">arg_x</span></a></span></span><span> </span><span id="local-6989586621682859067"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859067"><span class="hs-identifier hs-var">arg_y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5496"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682859068"><span class="annot"><a href="#local-6989586621682859068"><span class="hs-identifier hs-var">y_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682859069"><span class="annot"><a href="#local-6989586621682859069"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegOrMem"><span class="hs-identifier hs-var">getRegOrMem</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859067"><span class="hs-identifier hs-var">arg_y</span></a></span><span>
</span><span id="line-5497"></span><span>  </span><span id="local-6989586621682859070"><span class="annot"><a href="#local-6989586621682859070"><span class="hs-identifier hs-var">x_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859066"><span class="hs-identifier hs-type">arg_x</span></a></span><span>
</span><span id="line-5498"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682859071"><span class="annot"><a href="#local-6989586621682859071"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682859063"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-5499"></span><span>      </span><span id="local-6989586621682859072"><span class="annot"><a href="#local-6989586621682859072"><span class="hs-identifier hs-var hs-var">reg_h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859064"><span class="hs-identifier hs-var">res_h</span></a></span><span>
</span><span id="line-5500"></span><span>      </span><span id="local-6989586621682859073"><span class="annot"><a href="#local-6989586621682859073"><span class="hs-identifier hs-var hs-var">reg_l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859065"><span class="hs-identifier hs-var">res_l</span></a></span><span>
</span><span id="line-5501"></span><span>      </span><span id="local-6989586621682859074"><span class="annot"><a href="#local-6989586621682859074"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstrBlock
</span><a href="#local-6989586621682859069"><span class="hs-identifier hs-var">y_code</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-5502"></span><span>             </span><span class="annot"><span class="annottext">Reg -&gt; InstrBlock
</span><a href="#local-6989586621682859070"><span class="hs-identifier hs-var">x_code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rax"><span class="hs-identifier hs-var">rax</span></a></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; InstrBlock -&gt; InstrBlock
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-5503"></span><span>             </span><span class="annot"><span class="annottext">[Instr] -&gt; InstrBlock
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MUL2"><span class="hs-identifier hs-var">MUL2</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682859071"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682859068"><span class="hs-identifier hs-var">y_reg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5504"></span><span>                   </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682859071"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rdx"><span class="hs-identifier hs-var">rdx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682859072"><span class="hs-identifier hs-var">reg_h</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-5505"></span><span>                   </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682859071"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rax"><span class="hs-identifier hs-var">rax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682859073"><span class="hs-identifier hs-var">reg_l</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-5506"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682859074"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-5507"></span><span>
</span><span id="line-5508"></span><span>
</span><span id="line-5509"></span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#genQuotRem"><span class="hs-identifier hs-type">genQuotRem</span></a></span><span>
</span><span id="line-5510"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-5511"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-5512"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-5513"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span>
</span><span id="line-5514"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5515"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5516"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span>
</span><span id="line-5517"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-5518"></span><span id="genQuotRem"><span class="annot"><span class="annottext">genQuotRem :: Width
-&gt; Bool
-&gt; LocalReg
-&gt; LocalReg
-&gt; Maybe CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genQuotRem"><span class="hs-identifier hs-var hs-var">genQuotRem</span></a></span></span><span> </span><span id="local-6989586621682859075"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682859075"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621682859076"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682859076"><span class="hs-identifier hs-var">signed</span></a></span></span><span> </span><span id="local-6989586621682859077"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859077"><span class="hs-identifier hs-var">res_q</span></a></span></span><span> </span><span id="local-6989586621682859078"><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859078"><span class="hs-identifier hs-var">res_r</span></a></span></span><span> </span><span id="local-6989586621682859079"><span class="annot"><span class="annottext">Maybe CmmExpr
</span><a href="#local-6989586621682859079"><span class="hs-identifier hs-var">m_arg_x_high</span></a></span></span><span> </span><span id="local-6989586621682859080"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859080"><span class="hs-identifier hs-var">arg_x_low</span></a></span></span><span> </span><span id="local-6989586621682859081"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859081"><span class="hs-identifier hs-var">arg_y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5519"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682859075"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-5520"></span><span>    </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5521"></span><span>      </span><span class="hs-comment">-- See Note [DIV/IDIV for bytes]</span><span>
</span><span id="line-5522"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682859082"><span class="annot"><span class="annottext">widen :: MachOp
</span><a href="#local-6989586621682859082"><span class="hs-identifier hs-var hs-var">widen</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682859076"><span class="hs-identifier hs-var">signed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-var">MO_SS_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span>
</span><span id="line-5523"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-var">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span>
</span><span id="line-5524"></span><span>          </span><span id="local-6989586621682859083"><span class="annot"><span class="annottext">arg_x_low_16 :: CmmExpr
</span><a href="#local-6989586621682859083"><span class="hs-identifier hs-var hs-var">arg_x_low_16</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682859082"><span class="hs-identifier hs-var">widen</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859080"><span class="hs-identifier hs-var">arg_x_low</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-5525"></span><span>          </span><span id="local-6989586621682859084"><span class="annot"><span class="annottext">arg_y_16 :: CmmExpr
</span><a href="#local-6989586621682859084"><span class="hs-identifier hs-var hs-var">arg_y_16</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682859082"><span class="hs-identifier hs-var">widen</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859081"><span class="hs-identifier hs-var">arg_y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-5526"></span><span>          </span><span id="local-6989586621682859085"><span class="annot"><span class="annottext">m_arg_x_high_16 :: Maybe CmmExpr
</span><a href="#local-6989586621682859085"><span class="hs-identifier hs-var hs-var">m_arg_x_high_16</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682859086"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859086"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682859082"><span class="hs-identifier hs-var">widen</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859086"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; CmmExpr) -&gt; Maybe CmmExpr -&gt; Maybe CmmExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe CmmExpr
</span><a href="#local-6989586621682859079"><span class="hs-identifier hs-var">m_arg_x_high</span></a></span><span>
</span><span id="line-5527"></span><span>      </span><span class="annot"><span class="annottext">Width
-&gt; Bool
-&gt; LocalReg
-&gt; LocalReg
-&gt; Maybe CmmExpr
-&gt; CmmExpr
-&gt; CmmExpr
-&gt; NatM InstrBlock
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#genQuotRem"><span class="hs-identifier hs-var">genQuotRem</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682859076"><span class="hs-identifier hs-var">signed</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859077"><span class="hs-identifier hs-var">res_q</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859078"><span class="hs-identifier hs-var">res_r</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CmmExpr
</span><a href="#local-6989586621682859085"><span class="hs-identifier hs-var">m_arg_x_high_16</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859083"><span class="hs-identifier hs-var">arg_x_low_16</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859084"><span class="hs-identifier hs-var">arg_y_16</span></a></span><span>
</span><span id="line-5528"></span><span>
</span><span id="line-5529"></span><span>    </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-5530"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682859087"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682859087"><span class="hs-identifier hs-var hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682859075"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-5531"></span><span>          </span><span id="local-6989586621682859088"><span class="annot"><span class="annottext">reg_q :: Reg
</span><a href="#local-6989586621682859088"><span class="hs-identifier hs-var hs-var hs-var">reg_q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859077"><span class="hs-identifier hs-var">res_q</span></a></span><span>
</span><span id="line-5532"></span><span>          </span><span id="local-6989586621682859089"><span class="annot"><span class="annottext">reg_r :: Reg
</span><a href="#local-6989586621682859089"><span class="hs-identifier hs-var hs-var hs-var">reg_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalReg -&gt; Reg
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getLocalRegReg"><span class="hs-identifier hs-var">getLocalRegReg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalReg
</span><a href="#local-6989586621682859078"><span class="hs-identifier hs-var">res_r</span></a></span><span>
</span><span id="line-5533"></span><span>          </span><span id="local-6989586621682859090"><span class="annot"><span class="annottext">widen :: Instr
</span><a href="#local-6989586621682859090"><span class="hs-identifier hs-var hs-var hs-var">widen</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682859076"><span class="hs-identifier hs-var">signed</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#CLTD"><span class="hs-identifier hs-var">CLTD</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682859087"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-5534"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682859087"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rdx"><span class="hs-identifier hs-var">rdx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.X86.Regs.html#rdx"><span class="hs-identifier hs-var">rdx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5535"></span><span>          </span><span id="local-6989586621682859091"><span class="annot"><span class="annottext">instr :: Format -&gt; Operand -&gt; Instr
</span><a href="#local-6989586621682859091"><span class="hs-identifier hs-var hs-var hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682859076"><span class="hs-identifier hs-var">signed</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#IDIV"><span class="hs-identifier hs-var">IDIV</span></a></span><span>
</span><span id="line-5536"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.X86.Instr.html#DIV"><span class="hs-identifier hs-var">DIV</span></a></span><span>
</span><span id="line-5537"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682859092"><span class="annot"><a href="#local-6989586621682859092"><span class="hs-identifier hs-var">y_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682859093"><span class="annot"><a href="#local-6989586621682859093"><span class="hs-identifier hs-var">y_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Operand, InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getRegOrMem"><span class="hs-identifier hs-var">getRegOrMem</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859081"><span class="hs-identifier hs-var">arg_y</span></a></span><span>
</span><span id="line-5538"></span><span>      </span><span id="local-6989586621682859094"><span class="annot"><a href="#local-6989586621682859094"><span class="hs-identifier hs-var">x_low_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-type">getAnyReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859080"><span class="hs-identifier hs-type">arg_x_low</span></a></span><span>
</span><span id="line-5539"></span><span>      </span><span id="local-6989586621682859095"><span class="annot"><a href="#local-6989586621682859095"><span class="hs-identifier hs-var">x_high_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682859079"><span class="hs-identifier hs-type">m_arg_x_high</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-5540"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682859096"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859096"><span class="hs-identifier hs-var">arg_x_high</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-5541"></span><span>                         </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
CmmExpr -&gt; NatM (Reg -&gt; InstrBlock)
</span><a href="GHC.CmmToAsm.X86.CodeGen.html#getAnyReg"><span class="hs-identifier hs-var">getAnyReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682859096"><span class="hs-identifier hs-var">arg_x_high</span></a></span><span>
</span><span id="line-5542"></span><span>                     </span><span class="annot"><span class="annottext">Maybe CmmExpr
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-5543"></span><span>                         </span><span class="annot"><span class="annottext">(Reg -&gt; InstrBlock) -&gt; NatM (Reg -&gt; InstrBlock)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Reg -&gt; InstrBlock) -&gt; NatM (Reg -&gt; InstrBlock))
-&gt; (Reg -&gt; InstrBlock) -&gt; NatM (Reg -&gt; InstrBlock)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">InstrBlock -&gt; Reg -&gt; InstrBlock
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(InstrBlock -&gt; Reg -&gt; InstrBlock)
-&gt; InstrBlock -&gt; Reg -&gt; InstrBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Instr -&gt; InstrBlock
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682859090"><span class="hs-identifier hs-var">widen</span></a></span><span>
</span><span id="line-5544"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682859093"><span class="hs-identifier hs-type">y_code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-5545"></span><span>               </span><span class="annot"><a href="#local-6989586621682859094"><span class="hs-identifier hs-type">x_low_code</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#rax"><span class="hs-identifier hs-type">rax</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-5546"></span><span>               </span><span class="annot"><a href="#local-6989586621682859095"><span class="hs-identifier hs-type">x_high_code</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#rdx"><span class="hs-identifier hs-type">rdx</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-5547"></span><span>               </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682859091"><span class="hs-identifier hs-type">instr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859087"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859092"><span class="hs-identifier hs-type">y_reg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5548"></span><span>                     </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859087"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#rax"><span class="hs-identifier hs-type">rax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859088"><span class="hs-identifier hs-type">reg_q</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-5549"></span><span>                     </span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859087"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.X86.Regs.html#rdx"><span class="hs-identifier hs-type">rdx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.X86.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859089"><span class="hs-identifier hs-type">reg_r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-5550"></span></pre></body></html>