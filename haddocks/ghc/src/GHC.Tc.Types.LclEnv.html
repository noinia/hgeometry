<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html"><span class="hs-identifier">GHC.Tc.Types.LclEnv</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-2"></span><span>    </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier">TcLclEnv</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-3"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclCtxt"><span class="hs-identifier">TcLclCtxt</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#modifyLclCtxt"><span class="hs-identifier">modifyLclCtxt</span></a></span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvArrowCtxt"><span class="hs-identifier">getLclEnvArrowCtxt</span></a></span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvThBndrs"><span class="hs-identifier">getLclEnvThBndrs</span></a></span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvTypeEnv"><span class="hs-identifier">getLclEnvTypeEnv</span></a></span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvBinderStack"><span class="hs-identifier">getLclEnvBinderStack</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvErrCtxt"><span class="hs-identifier">getLclEnvErrCtxt</span></a></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvLoc"><span class="hs-identifier">getLclEnvLoc</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvRdrEnv"><span class="hs-identifier">getLclEnvRdrEnv</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvTcLevel"><span class="hs-identifier">getLclEnvTcLevel</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvThStage"><span class="hs-identifier">getLclEnvThStage</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#setLclEnvTcLevel"><span class="hs-identifier">setLclEnvTcLevel</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#setLclEnvLoc"><span class="hs-identifier">setLclEnvLoc</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#setLclEnvRdrEnv"><span class="hs-identifier">setLclEnvRdrEnv</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#setLclEnvBinderStack"><span class="hs-identifier">setLclEnvBinderStack</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#setLclEnvErrCtxt"><span class="hs-identifier">setLclEnvErrCtxt</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#setLclEnvThStage"><span class="hs-identifier">setLclEnvThStage</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#setLclEnvTypeEnv"><span class="hs-identifier">setLclEnvTypeEnv</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#modifyLclEnvTcLevel"><span class="hs-identifier">modifyLclEnvTcLevel</span></a></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#lclEnvInGeneratedCode"><span class="hs-identifier">lclEnvInGeneratedCode</span></a></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#addLclEnvErrCtxt"><span class="hs-identifier">addLclEnvErrCtxt</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#ArrowCtxt"><span class="hs-identifier">ArrowCtxt</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#ThBindEnv"><span class="hs-identifier">ThBindEnv</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcTypeEnv"><span class="hs-identifier">TcTypeEnv</span></a></span><span>
</span><span id="line-31"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html"><span class="hs-identifier">GHC.Tc.Utils.TcType</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier">TcLevel</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html"><span class="hs-identifier">GHC.Tc.Errors.Types</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnMessage"><span class="hs-identifier">TcRnMessage</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html"><span class="hs-identifier">GHC.Core.UsageEnv</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier">UsageEnv</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html"><span class="hs-identifier">GHC.Types.Name.Reader</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#LocalRdrEnv"><span class="hs-identifier">LocalRdrEnv</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html"><span class="hs-identifier">GHC.Types.Name.Env</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier">NameEnv</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#RealSrcSpan"><span class="hs-identifier">RealSrcSpan</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#TopLevelFlag"><span class="hs-identifier">TopLevelFlag</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Error.html"><span class="hs-identifier">GHC.Types.Error</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#Messages"><span class="hs-identifier">Messages</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.BasicTypes.html"><span class="hs-identifier">GHC.Tc.Types.BasicTypes</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.TH.html"><span class="hs-identifier">GHC.Tc.Types.TH</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.TcRef.html"><span class="hs-identifier">GHC.Tc.Types.TcRef</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.ErrCtxt.html"><span class="hs-identifier">GHC.Tc.Types.ErrCtxt</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html"><span class="hs-identifier">GHC.Tc.Types.Constraint</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#WantedConstraints"><span class="hs-identifier">WantedConstraints</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                The local typechecker environment
*                                                                      *
************************************************************************

Note [The Global-Env/Local-Env story]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
During type checking, we keep in the tcg_type_env
        * All types and classes
        * All Ids derived from types and classes (constructors, selectors)

At the end of type checking, we zonk the local bindings,
and as we do so we add to the tcg_type_env
        * Locally defined top-level Ids

Why?  Because they are now Ids not TcIds.  This final GlobalEnv is
        a) fed back (via the knot) to typechecking the
           unfoldings of interface signatures
        b) used in the ModDetails of this module
-}</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">data</span><span> </span><span id="TcLclEnv"><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-var">TcLclEnv</span></a></span></span><span>           </span><span class="hs-comment">-- Changes as we move inside an expression</span><span>
</span><span id="line-77"></span><span>                        </span><span class="hs-comment">-- Discarded after typecheck/rename; not passed on to desugarer</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TcLclEnv"><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-var">TcLclEnv</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-79"></span><span>        </span><span class="hs-comment">-- The part that we sometimes restore using `restoreLclEnv`.</span><span>
</span><span id="line-80"></span><span>        </span><span id="tcl_lcl_ctxt"><span class="annot"><span class="annottext">TcLclEnv -&gt; TcLclCtxt
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_lcl_ctxt"><span class="hs-identifier hs-var hs-var">tcl_lcl_ctxt</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclCtxt"><span class="hs-identifier hs-type">TcLclCtxt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>        </span><span class="hs-comment">-- These are exactly the parts of TcLclEnv which are not set by `restoreLclEnv`.</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>        </span><span id="tcl_usage"><span class="annot"><span class="annottext">TcLclEnv -&gt; TcRef UsageEnv
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_usage"><span class="hs-identifier hs-var hs-var">tcl_usage</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.TcRef.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a></span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- Required multiplicity of bindings is accumulated here.</span><span>
</span><span id="line-85"></span><span>        </span><span id="tcl_lie"><span class="annot"><span class="annottext">TcLclEnv -&gt; TcRef WantedConstraints
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_lie"><span class="hs-identifier hs-var hs-var">tcl_lie</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.TcRef.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a></span><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- Place to accumulate type constraints</span><span>
</span><span id="line-86"></span><span>        </span><span id="tcl_errs"><span class="annot"><span class="annottext">TcLclEnv -&gt; TcRef (Messages TcRnMessage)
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_errs"><span class="hs-identifier hs-var hs-var">tcl_errs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.TcRef.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Error.html#Messages"><span class="hs-identifier hs-type">Messages</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnMessage"><span class="hs-identifier hs-type">TcRnMessage</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- Place to accumulate diagnostics</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-keyword">data</span><span> </span><span id="TcLclCtxt"><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclCtxt"><span class="hs-identifier hs-var">TcLclCtxt</span></a></span></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TcLclCtxt"><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclCtxt"><span class="hs-identifier hs-var">TcLclCtxt</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-91"></span><span>        </span><span id="tcl_loc"><span class="annot"><span class="annottext">TcLclCtxt -&gt; RealSrcSpan
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_loc"><span class="hs-identifier hs-var hs-var">tcl_loc</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-type">RealSrcSpan</span></a></span><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- Source span</span><span>
</span><span id="line-92"></span><span>        </span><span id="tcl_ctxt"><span class="annot"><span class="annottext">TcLclCtxt -&gt; [ErrCtxt]
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_ctxt"><span class="hs-identifier hs-var hs-var">tcl_ctxt</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Types.ErrCtxt.html#ErrCtxt"><span class="hs-identifier hs-type">ErrCtxt</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- Error context, innermost on top</span><span>
</span><span id="line-93"></span><span>        </span><span id="tcl_in_gen_code"><span class="annot"><span class="annottext">TcLclCtxt -&gt; Bool
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_in_gen_code"><span class="hs-identifier hs-var hs-var">tcl_in_gen_code</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- See Note [Rebindable syntax and XXExprGhcRn]</span><span>
</span><span id="line-94"></span><span>        </span><span id="tcl_tclvl"><span class="annot"><span class="annottext">TcLclCtxt -&gt; TcLevel
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_tclvl"><span class="hs-identifier hs-var hs-var">tcl_tclvl</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>        </span><span id="tcl_bndrs"><span class="annot"><span class="annottext">TcLclCtxt -&gt; TcBinderStack
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_bndrs"><span class="hs-identifier hs-var hs-var">tcl_bndrs</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.BasicTypes.html#TcBinderStack"><span class="hs-identifier hs-type">TcBinderStack</span></a></span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- Used for reporting relevant bindings,</span><span>
</span><span id="line-96"></span><span>                                           </span><span class="hs-comment">-- and for tidying type</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span>        </span><span id="tcl_rdr"><span class="annot"><span class="annottext">TcLclCtxt -&gt; LocalRdrEnv
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_rdr"><span class="hs-identifier hs-var hs-var">tcl_rdr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a></span><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- Local name envt</span><span>
</span><span id="line-99"></span><span>                </span><span class="hs-comment">-- Maintained during renaming, of course, but also during</span><span>
</span><span id="line-100"></span><span>                </span><span class="hs-comment">-- type checking, solely so that when renaming a Template-Haskell</span><span>
</span><span id="line-101"></span><span>                </span><span class="hs-comment">-- splice we have the right environment for the renamer.</span><span>
</span><span id="line-102"></span><span>                </span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span>                </span><span class="hs-comment">--   Does *not* include global name envt; may shadow it</span><span>
</span><span id="line-104"></span><span>                </span><span class="hs-comment">--   Includes both ordinary variables and type variables;</span><span>
</span><span id="line-105"></span><span>                </span><span class="hs-comment">--   they are kept distinct because tyvar have a different</span><span>
</span><span id="line-106"></span><span>                </span><span class="hs-comment">--   occurrence constructor (Name.TvOcc)</span><span>
</span><span id="line-107"></span><span>                </span><span class="hs-comment">-- We still need the unsullied global name env so that</span><span>
</span><span id="line-108"></span><span>                </span><span class="hs-comment">--   we can look up record field names</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span>        </span><span id="tcl_th_ctxt"><span class="annot"><span class="annottext">TcLclCtxt -&gt; ThStage
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_th_ctxt"><span class="hs-identifier hs-var hs-var">tcl_th_ctxt</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.TH.html#ThStage"><span class="hs-identifier hs-type">ThStage</span></a></span><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- Template Haskell context</span><span>
</span><span id="line-112"></span><span>        </span><span id="tcl_th_bndrs"><span class="annot"><span class="annottext">TcLclCtxt -&gt; ThBindEnv
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_th_bndrs"><span class="hs-identifier hs-var hs-var">tcl_th_bndrs</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#ThBindEnv"><span class="hs-identifier hs-type">ThBindEnv</span></a></span><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- and binder info</span><span>
</span><span id="line-113"></span><span>            </span><span class="hs-comment">-- The ThBindEnv records the TH binding level of in-scope Names</span><span>
</span><span id="line-114"></span><span>            </span><span class="hs-comment">-- defined in this module (not imported)</span><span>
</span><span id="line-115"></span><span>            </span><span class="hs-comment">-- We can't put this info in the TypeEnv because it's needed</span><span>
</span><span id="line-116"></span><span>            </span><span class="hs-comment">-- (and extended) in the renamer, for untyped splices</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span>        </span><span id="tcl_arrow_ctxt"><span class="annot"><span class="annottext">TcLclCtxt -&gt; ArrowCtxt
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_arrow_ctxt"><span class="hs-identifier hs-var hs-var">tcl_arrow_ctxt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#ArrowCtxt"><span class="hs-identifier hs-type">ArrowCtxt</span></a></span><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- Arrow-notation context</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span>        </span><span id="tcl_env"><span class="annot"><span class="annottext">TcLclCtxt -&gt; TcTypeEnv
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_env"><span class="hs-identifier hs-var hs-var">tcl_env</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcTypeEnv"><span class="hs-identifier hs-type">TcTypeEnv</span></a></span><span>    </span><span class="hs-comment">-- The local type environment:</span><span>
</span><span id="line-121"></span><span>                                 </span><span class="hs-comment">-- Ids and TyVars defined in this module</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvThStage"><span class="hs-identifier hs-type">getLclEnvThStage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.TH.html#ThStage"><span class="hs-identifier hs-type">ThStage</span></a></span><span>
</span><span id="line-126"></span><span id="getLclEnvThStage"><span class="annot"><span class="annottext">getLclEnvThStage :: TcLclEnv -&gt; ThStage
</span><a href="GHC.Tc.Types.LclEnv.html#getLclEnvThStage"><span class="hs-identifier hs-var hs-var">getLclEnvThStage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt -&gt; ThStage
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_th_ctxt"><span class="hs-identifier hs-var">tcl_th_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; ThStage)
-&gt; (TcLclEnv -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; ThStage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TcLclEnv -&gt; TcLclCtxt
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_lcl_ctxt"><span class="hs-identifier hs-var">tcl_lcl_ctxt</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#setLclEnvThStage"><span class="hs-identifier hs-type">setLclEnvThStage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.TH.html#ThStage"><span class="hs-identifier hs-type">ThStage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span>
</span><span id="line-129"></span><span id="setLclEnvThStage"><span class="annot"><span class="annottext">setLclEnvThStage :: ThStage -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#setLclEnvThStage"><span class="hs-identifier hs-var hs-var">setLclEnvThStage</span></a></span></span><span> </span><span id="local-6989586621682755558"><span class="annot"><span class="annottext">ThStage
</span><a href="#local-6989586621682755558"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#modifyLclCtxt"><span class="hs-identifier hs-var">modifyLclCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682755559"><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755559"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755559"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#tcl_th_ctxt"><span class="hs-identifier hs-var">tcl_th_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682755558"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvThBndrs"><span class="hs-identifier hs-type">getLclEnvThBndrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#ThBindEnv"><span class="hs-identifier hs-type">ThBindEnv</span></a></span><span>
</span><span id="line-132"></span><span id="getLclEnvThBndrs"><span class="annot"><span class="annottext">getLclEnvThBndrs :: TcLclEnv -&gt; ThBindEnv
</span><a href="GHC.Tc.Types.LclEnv.html#getLclEnvThBndrs"><span class="hs-identifier hs-var hs-var">getLclEnvThBndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt -&gt; ThBindEnv
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_th_bndrs"><span class="hs-identifier hs-var">tcl_th_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; ThBindEnv)
-&gt; (TcLclEnv -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; ThBindEnv
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TcLclEnv -&gt; TcLclCtxt
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_lcl_ctxt"><span class="hs-identifier hs-var">tcl_lcl_ctxt</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvArrowCtxt"><span class="hs-identifier hs-type">getLclEnvArrowCtxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#ArrowCtxt"><span class="hs-identifier hs-type">ArrowCtxt</span></a></span><span>
</span><span id="line-135"></span><span id="getLclEnvArrowCtxt"><span class="annot"><span class="annottext">getLclEnvArrowCtxt :: TcLclEnv -&gt; ArrowCtxt
</span><a href="GHC.Tc.Types.LclEnv.html#getLclEnvArrowCtxt"><span class="hs-identifier hs-var hs-var">getLclEnvArrowCtxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt -&gt; ArrowCtxt
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_arrow_ctxt"><span class="hs-identifier hs-var">tcl_arrow_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; ArrowCtxt)
-&gt; (TcLclEnv -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; ArrowCtxt
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TcLclEnv -&gt; TcLclCtxt
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_lcl_ctxt"><span class="hs-identifier hs-var">tcl_lcl_ctxt</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvTypeEnv"><span class="hs-identifier hs-type">getLclEnvTypeEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcTypeEnv"><span class="hs-identifier hs-type">TcTypeEnv</span></a></span><span>
</span><span id="line-138"></span><span id="getLclEnvTypeEnv"><span class="annot"><span class="annottext">getLclEnvTypeEnv :: TcLclEnv -&gt; TcTypeEnv
</span><a href="GHC.Tc.Types.LclEnv.html#getLclEnvTypeEnv"><span class="hs-identifier hs-var hs-var">getLclEnvTypeEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt -&gt; TcTypeEnv
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_env"><span class="hs-identifier hs-var">tcl_env</span></a></span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; TcTypeEnv)
-&gt; (TcLclEnv -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; TcTypeEnv
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TcLclEnv -&gt; TcLclCtxt
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_lcl_ctxt"><span class="hs-identifier hs-var">tcl_lcl_ctxt</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#setLclEnvTypeEnv"><span class="hs-identifier hs-type">setLclEnvTypeEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcTypeEnv"><span class="hs-identifier hs-type">TcTypeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span>
</span><span id="line-141"></span><span id="setLclEnvTypeEnv"><span class="annot"><span class="annottext">setLclEnvTypeEnv :: TcTypeEnv -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#setLclEnvTypeEnv"><span class="hs-identifier hs-var hs-var">setLclEnvTypeEnv</span></a></span></span><span> </span><span id="local-6989586621682755560"><span class="annot"><span class="annottext">TcTypeEnv
</span><a href="#local-6989586621682755560"><span class="hs-identifier hs-var">ty_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#modifyLclCtxt"><span class="hs-identifier hs-var">modifyLclCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682755561"><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755561"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755561"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#tcl_env"><span class="hs-identifier hs-var">tcl_env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682755560"><span class="hs-identifier hs-type">ty_env</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#setLclEnvTcLevel"><span class="hs-identifier hs-type">setLclEnvTcLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span>
</span><span id="line-144"></span><span id="setLclEnvTcLevel"><span class="annot"><span class="annottext">setLclEnvTcLevel :: TcLevel -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#setLclEnvTcLevel"><span class="hs-identifier hs-var hs-var">setLclEnvTcLevel</span></a></span></span><span> </span><span id="local-6989586621682755562"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621682755562"><span class="hs-identifier hs-var">lvl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#modifyLclCtxt"><span class="hs-identifier hs-var">modifyLclCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682755563"><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755563"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755563"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#tcl_tclvl"><span class="hs-identifier hs-var">tcl_tclvl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682755562"><span class="hs-identifier hs-type">lvl</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#modifyLclEnvTcLevel"><span class="hs-identifier hs-type">modifyLclEnvTcLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span>
</span><span id="line-147"></span><span id="modifyLclEnvTcLevel"><span class="annot"><span class="annottext">modifyLclEnvTcLevel :: (TcLevel -&gt; TcLevel) -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#modifyLclEnvTcLevel"><span class="hs-identifier hs-var hs-var">modifyLclEnvTcLevel</span></a></span></span><span> </span><span id="local-6989586621682755564"><span class="annot"><span class="annottext">TcLevel -&gt; TcLevel
</span><a href="#local-6989586621682755564"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#modifyLclCtxt"><span class="hs-identifier hs-var">modifyLclCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682755565"><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755565"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755565"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#tcl_tclvl"><span class="hs-identifier hs-var">tcl_tclvl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682755564"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#tcl_tclvl"><span class="hs-identifier hs-var">tcl_tclvl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682755565"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvTcLevel"><span class="hs-identifier hs-type">getLclEnvTcLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span>
</span><span id="line-150"></span><span id="getLclEnvTcLevel"><span class="annot"><span class="annottext">getLclEnvTcLevel :: TcLclEnv -&gt; TcLevel
</span><a href="GHC.Tc.Types.LclEnv.html#getLclEnvTcLevel"><span class="hs-identifier hs-var hs-var">getLclEnvTcLevel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt -&gt; TcLevel
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_tclvl"><span class="hs-identifier hs-var">tcl_tclvl</span></a></span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; TcLevel)
-&gt; (TcLclEnv -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; TcLevel
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TcLclEnv -&gt; TcLclCtxt
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_lcl_ctxt"><span class="hs-identifier hs-var">tcl_lcl_ctxt</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#setLclEnvLoc"><span class="hs-identifier hs-type">setLclEnvLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-type">RealSrcSpan</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span>
</span><span id="line-153"></span><span id="setLclEnvLoc"><span class="annot"><span class="annottext">setLclEnvLoc :: RealSrcSpan -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#setLclEnvLoc"><span class="hs-identifier hs-var hs-var">setLclEnvLoc</span></a></span></span><span> </span><span id="local-6989586621682755566"><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682755566"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#modifyLclCtxt"><span class="hs-identifier hs-var">modifyLclCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682755567"><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755567"><span class="hs-identifier hs-var">lenv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755567"><span class="hs-identifier hs-var">lenv</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#tcl_loc"><span class="hs-identifier hs-var">tcl_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682755566"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvLoc"><span class="hs-identifier hs-type">getLclEnvLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-type">RealSrcSpan</span></a></span><span>
</span><span id="line-156"></span><span id="getLclEnvLoc"><span class="annot"><span class="annottext">getLclEnvLoc :: TcLclEnv -&gt; RealSrcSpan
</span><a href="GHC.Tc.Types.LclEnv.html#getLclEnvLoc"><span class="hs-identifier hs-var hs-var">getLclEnvLoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt -&gt; RealSrcSpan
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_loc"><span class="hs-identifier hs-var">tcl_loc</span></a></span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; RealSrcSpan)
-&gt; (TcLclEnv -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; RealSrcSpan
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TcLclEnv -&gt; TcLclCtxt
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_lcl_ctxt"><span class="hs-identifier hs-var">tcl_lcl_ctxt</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvErrCtxt"><span class="hs-identifier hs-type">getLclEnvErrCtxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Types.ErrCtxt.html#ErrCtxt"><span class="hs-identifier hs-type">ErrCtxt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-159"></span><span id="getLclEnvErrCtxt"><span class="annot"><span class="annottext">getLclEnvErrCtxt :: TcLclEnv -&gt; [ErrCtxt]
</span><a href="GHC.Tc.Types.LclEnv.html#getLclEnvErrCtxt"><span class="hs-identifier hs-var hs-var">getLclEnvErrCtxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt -&gt; [ErrCtxt]
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_ctxt"><span class="hs-identifier hs-var">tcl_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; [ErrCtxt])
-&gt; (TcLclEnv -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; [ErrCtxt]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TcLclEnv -&gt; TcLclCtxt
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_lcl_ctxt"><span class="hs-identifier hs-var">tcl_lcl_ctxt</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#setLclEnvErrCtxt"><span class="hs-identifier hs-type">setLclEnvErrCtxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Types.ErrCtxt.html#ErrCtxt"><span class="hs-identifier hs-type">ErrCtxt</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span>
</span><span id="line-162"></span><span id="setLclEnvErrCtxt"><span class="annot"><span class="annottext">setLclEnvErrCtxt :: [ErrCtxt] -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#setLclEnvErrCtxt"><span class="hs-identifier hs-var hs-var">setLclEnvErrCtxt</span></a></span></span><span> </span><span id="local-6989586621682755568"><span class="annot"><span class="annottext">[ErrCtxt]
</span><a href="#local-6989586621682755568"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#modifyLclCtxt"><span class="hs-identifier hs-var">modifyLclCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682755569"><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755569"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755569"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#tcl_ctxt"><span class="hs-identifier hs-var">tcl_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682755568"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#addLclEnvErrCtxt"><span class="hs-identifier hs-type">addLclEnvErrCtxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.ErrCtxt.html#ErrCtxt"><span class="hs-identifier hs-type">ErrCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span>
</span><span id="line-165"></span><span id="addLclEnvErrCtxt"><span class="annot"><span class="annottext">addLclEnvErrCtxt :: ErrCtxt -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#addLclEnvErrCtxt"><span class="hs-identifier hs-var hs-var">addLclEnvErrCtxt</span></a></span></span><span> </span><span id="local-6989586621682755570"><span class="annot"><span class="annottext">ErrCtxt
</span><a href="#local-6989586621682755570"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#modifyLclCtxt"><span class="hs-identifier hs-var">modifyLclCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682755571"><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755571"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755571"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#tcl_ctxt"><span class="hs-identifier hs-var">tcl_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682755570"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#tcl_ctxt"><span class="hs-identifier hs-var">tcl_ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682755571"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#lclEnvInGeneratedCode"><span class="hs-identifier hs-type">lclEnvInGeneratedCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-168"></span><span id="lclEnvInGeneratedCode"><span class="annot"><span class="annottext">lclEnvInGeneratedCode :: TcLclEnv -&gt; Bool
</span><a href="GHC.Tc.Types.LclEnv.html#lclEnvInGeneratedCode"><span class="hs-identifier hs-var hs-var">lclEnvInGeneratedCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt -&gt; Bool
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_in_gen_code"><span class="hs-identifier hs-var">tcl_in_gen_code</span></a></span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; Bool) -&gt; (TcLclEnv -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TcLclEnv -&gt; TcLclCtxt
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_lcl_ctxt"><span class="hs-identifier hs-var">tcl_lcl_ctxt</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvBinderStack"><span class="hs-identifier hs-type">getLclEnvBinderStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.BasicTypes.html#TcBinderStack"><span class="hs-identifier hs-type">TcBinderStack</span></a></span><span>
</span><span id="line-171"></span><span id="getLclEnvBinderStack"><span class="annot"><span class="annottext">getLclEnvBinderStack :: TcLclEnv -&gt; TcBinderStack
</span><a href="GHC.Tc.Types.LclEnv.html#getLclEnvBinderStack"><span class="hs-identifier hs-var hs-var">getLclEnvBinderStack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt -&gt; TcBinderStack
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_bndrs"><span class="hs-identifier hs-var">tcl_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; TcBinderStack)
-&gt; (TcLclEnv -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; TcBinderStack
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TcLclEnv -&gt; TcLclCtxt
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_lcl_ctxt"><span class="hs-identifier hs-var">tcl_lcl_ctxt</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#setLclEnvBinderStack"><span class="hs-identifier hs-type">setLclEnvBinderStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.BasicTypes.html#TcBinderStack"><span class="hs-identifier hs-type">TcBinderStack</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span>
</span><span id="line-174"></span><span id="setLclEnvBinderStack"><span class="annot"><span class="annottext">setLclEnvBinderStack :: TcBinderStack -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#setLclEnvBinderStack"><span class="hs-identifier hs-var hs-var">setLclEnvBinderStack</span></a></span></span><span> </span><span id="local-6989586621682755572"><span class="annot"><span class="annottext">TcBinderStack
</span><a href="#local-6989586621682755572"><span class="hs-identifier hs-var">stack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#modifyLclCtxt"><span class="hs-identifier hs-var">modifyLclCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682755573"><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755573"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755573"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#tcl_bndrs"><span class="hs-identifier hs-var">tcl_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682755572"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#getLclEnvRdrEnv"><span class="hs-identifier hs-type">getLclEnvRdrEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a></span><span>
</span><span id="line-177"></span><span id="getLclEnvRdrEnv"><span class="annot"><span class="annottext">getLclEnvRdrEnv :: TcLclEnv -&gt; LocalRdrEnv
</span><a href="GHC.Tc.Types.LclEnv.html#getLclEnvRdrEnv"><span class="hs-identifier hs-var hs-var">getLclEnvRdrEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt -&gt; LocalRdrEnv
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_rdr"><span class="hs-identifier hs-var">tcl_rdr</span></a></span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; LocalRdrEnv)
-&gt; (TcLclEnv -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; LocalRdrEnv
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TcLclEnv -&gt; TcLclCtxt
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_lcl_ctxt"><span class="hs-identifier hs-var">tcl_lcl_ctxt</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#setLclEnvRdrEnv"><span class="hs-identifier hs-type">setLclEnvRdrEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span>
</span><span id="line-180"></span><span id="setLclEnvRdrEnv"><span class="annot"><span class="annottext">setLclEnvRdrEnv :: LocalRdrEnv -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#setLclEnvRdrEnv"><span class="hs-identifier hs-var hs-var">setLclEnvRdrEnv</span></a></span></span><span> </span><span id="local-6989586621682755574"><span class="annot"><span class="annottext">LocalRdrEnv
</span><a href="#local-6989586621682755574"><span class="hs-identifier hs-var">rdr_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TcLclCtxt -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#modifyLclCtxt"><span class="hs-identifier hs-var">modifyLclCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682755575"><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755575"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt
</span><a href="#local-6989586621682755575"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#tcl_rdr"><span class="hs-identifier hs-var">tcl_rdr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682755574"><span class="hs-identifier hs-type">rdr_env</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#modifyLclCtxt"><span class="hs-identifier hs-type">modifyLclCtxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclCtxt"><span class="hs-identifier hs-type">TcLclCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclCtxt"><span class="hs-identifier hs-type">TcLclCtxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span>
</span><span id="line-183"></span><span id="modifyLclCtxt"><span class="annot"><span class="annottext">modifyLclCtxt :: (TcLclCtxt -&gt; TcLclCtxt) -&gt; TcLclEnv -&gt; TcLclEnv
</span><a href="GHC.Tc.Types.LclEnv.html#modifyLclCtxt"><span class="hs-identifier hs-var hs-var">modifyLclCtxt</span></a></span></span><span> </span><span id="local-6989586621682755576"><span class="annot"><span class="annottext">TcLclCtxt -&gt; TcLclCtxt
</span><a href="#local-6989586621682755576"><span class="hs-identifier hs-var">upd</span></a></span></span><span> </span><span id="local-6989586621682755577"><span class="annot"><span class="annottext">TcLclEnv
</span><a href="#local-6989586621682755577"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682755578"><span class="annot"><span class="annottext">res :: TcLclCtxt
</span><a href="#local-6989586621682755578"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLclCtxt -&gt; TcLclCtxt
</span><a href="#local-6989586621682755576"><span class="hs-identifier hs-var">upd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcLclEnv -&gt; TcLclCtxt
</span><a href="GHC.Tc.Types.LclEnv.html#tcl_lcl_ctxt"><span class="hs-identifier hs-var">tcl_lcl_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">TcLclEnv
</span><a href="#local-6989586621682755577"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">TcLclEnv
</span><a href="#local-6989586621682755577"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#tcl_lcl_ctxt"><span class="hs-identifier hs-var">tcl_lcl_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682755578"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-keyword">type</span><span> </span><span id="TcTypeEnv"><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcTypeEnv"><span class="hs-identifier hs-var">TcTypeEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.BasicTypes.html#TcTyThing"><span class="hs-identifier hs-type">TcTyThing</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-keyword">type</span><span> </span><span id="ThBindEnv"><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#ThBindEnv"><span class="hs-identifier hs-var">ThBindEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#TopLevelFlag"><span class="hs-identifier hs-type">TopLevelFlag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.TH.html#ThLevel"><span class="hs-identifier hs-type">ThLevel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>   </span><span class="hs-comment">-- Domain = all Ids bound in this module (ie not imported)</span><span>
</span><span id="line-193"></span><span>   </span><span class="hs-comment">-- The TopLevelFlag tells if the binding is syntactically top level.</span><span>
</span><span id="line-194"></span><span>   </span><span class="hs-comment">-- We need to know this, because the cross-stage persistence story allows</span><span>
</span><span id="line-195"></span><span>   </span><span class="hs-comment">-- cross-stage at arbitrary types if the Id is bound at top level.</span><span>
</span><span id="line-196"></span><span>   </span><span class="hs-comment">--</span><span>
</span><span id="line-197"></span><span>   </span><span class="hs-comment">-- Nota bene: a ThLevel of 'outerLevel' is *not* the same as being</span><span>
</span><span id="line-198"></span><span>   </span><span class="hs-comment">-- bound at top level!  See Note [Template Haskell levels] in GHC.Tc.Gen.Splice</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">---------------------------</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- Arrow-notation context</span><span>
</span><span id="line-202"></span><span class="hs-comment">---------------------------</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">{- Note [Escaping the arrow scope]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In arrow notation, a variable bound by a proc (or enclosed let/kappa)
is not in scope to the left of an arrow tail (-&lt;) or the head of (|..|).
For example

        proc x -&gt; (e1 -&lt; e2)

Here, x is not in scope in e1, but it is in scope in e2.  This can get
a bit complicated:

        let x = 3 in
        proc y -&gt; (proc z -&gt; e1) -&lt; e2

Here, x and z are in scope in e1, but y is not.

We implement this by
recording the environment when passing a proc (using newArrowScope),
and returning to that (using escapeArrowScope) on the left of -&lt; and the
head of (|..|).

All this can be dealt with by the *renamer*. But the type checker needs
to be involved too.  Example (arrowfail001)
  class Foo a where foo :: a -&gt; ()
  data Bar = forall a. Foo a =&gt; Bar a
  get :: Bar -&gt; ()
  get = proc x -&gt; case x of Bar a -&gt; foo -&lt; a
Here the call of 'foo' gives rise to a (Foo a) constraint that should not
be captured by the pattern match on 'Bar'.  Rather it should join the
constraints from further out.  So we must capture the constraint bag
from further out in the ArrowCtxt that we push inwards.
-}</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-keyword">data</span><span> </span><span id="ArrowCtxt"><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#ArrowCtxt"><span class="hs-identifier hs-var">ArrowCtxt</span></a></span></span><span>   </span><span class="hs-comment">-- Note [Escaping the arrow scope]</span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="NoArrowCtxt"><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#NoArrowCtxt"><span class="hs-identifier hs-var">NoArrowCtxt</span></a></span></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ArrowCtxt"><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#ArrowCtxt"><span class="hs-identifier hs-var">ArrowCtxt</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.TcRef.html#TcRef"><span class="hs-identifier hs-type">TcRef</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.Constraint.html#WantedConstraints"><span class="hs-identifier hs-type">WantedConstraints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span></pre></body></html>