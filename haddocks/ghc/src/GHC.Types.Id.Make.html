<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The AQUA Project, Glasgow University, 1998


This module contains definitions for the IdInfo for things that
have a standard form, namely:

- data constructors
- record selectors
- method and superclass selectors
- primitive operations
-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-uni-patterns #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html"><span class="hs-identifier">GHC.Types.Id.Make</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-19"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#mkDictFunId"><span class="hs-identifier">mkDictFunId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#mkDictSelId"><span class="hs-identifier">mkDictSelId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#mkDictSelRhs"><span class="hs-identifier">mkDictSelRhs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#mkFCallId"><span class="hs-identifier">mkFCallId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#unwrapNewTypeBody"><span class="hs-identifier">unwrapNewTypeBody</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#wrapFamInstBody"><span class="hs-identifier">wrapFamInstBody</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#DataConBoxer"><span class="hs-identifier">DataConBoxer</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#vanillaDataConBoxer"><span class="hs-identifier">vanillaDataConBoxer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#mkDataConRep"><span class="hs-identifier">mkDataConRep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#mkDataConWorkId"><span class="hs-identifier">mkDataConWorkId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#DataConBangOpts"><span class="hs-identifier">DataConBangOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#BangOpts"><span class="hs-identifier">BangOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#unboxedUnitExpr"><span class="hs-identifier">unboxedUnitExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>        </span><span class="hs-comment">-- And some particular Ids; see below for why they are wired in</span><span>
</span><span id="line-30"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#wiredInIds"><span class="hs-identifier">wiredInIds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#ghcPrimIds"><span class="hs-identifier">ghcPrimIds</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#realWorldPrimId"><span class="hs-identifier">realWorldPrimId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#voidPrimId"><span class="hs-identifier">voidPrimId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#voidArgId"><span class="hs-identifier">voidArgId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#nullAddrId"><span class="hs-identifier">nullAddrId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#seqId"><span class="hs-identifier">seqId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#lazyId"><span class="hs-identifier">lazyId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#lazyIdKey"><span class="hs-identifier">lazyIdKey</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#coercionTokenId"><span class="hs-identifier">coercionTokenId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#coerceId"><span class="hs-identifier">coerceId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#proxyHashId"><span class="hs-identifier">proxyHashId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#nospecId"><span class="hs-identifier">nospecId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#nospecIdName"><span class="hs-identifier">nospecIdName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#noinlineId"><span class="hs-identifier">noinlineId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#noinlineIdName"><span class="hs-identifier">noinlineIdName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#noinlineConstraintId"><span class="hs-identifier">noinlineConstraintId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#noinlineConstraintIdName"><span class="hs-identifier">noinlineConstraintIdName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#coerceName"><span class="hs-identifier">coerceName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#leftSectionName"><span class="hs-identifier">leftSectionName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#rightSectionName"><span class="hs-identifier">rightSectionName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#pcRepPolyId"><span class="hs-identifier">pcRepPolyId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>        </span><span class="annot"><a href="GHC.Types.Id.Make.html#mkRepPolyIdConcreteTyVars"><span class="hs-identifier">mkRepPolyIdConcreteTyVars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.Prim.html"><span class="hs-identifier">GHC.Builtin.Types.Prim</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html"><span class="hs-identifier">GHC.Builtin.Types</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.html"><span class="hs-identifier">GHC.Core</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Arity.html"><span class="hs-identifier">GHC.Core.Opt.Arity</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Arity.html#typeOneShot"><span class="hs-identifier">typeOneShot</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Multiplicity.html"><span class="hs-identifier">GHC.Core.Multiplicity</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html"><span class="hs-identifier">GHC.Core.TyCo.Rep</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html"><span class="hs-identifier">GHC.Core.FamInstEnv</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html"><span class="hs-identifier">GHC.Core.Coercion</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Reduction.html"><span class="hs-identifier">GHC.Core.Reduction</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Make.html"><span class="hs-identifier">GHC.Core.Make</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.FVs.html"><span class="hs-identifier">GHC.Core.FVs</span></a></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.FVs.html#mkRuleInfo"><span class="hs-identifier">mkRuleInfo</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html"><span class="hs-identifier">GHC.Core.Utils</span></a></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier">exprType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html#mkCast"><span class="hs-identifier">mkCast</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html#mkDefaultCase"><span class="hs-identifier">mkDefaultCase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html#coreAltsType"><span class="hs-identifier">coreAltsType</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Unfold.Make.html"><span class="hs-identifier">GHC.Core.Unfold.Make</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.SimpleOpt.html"><span class="hs-identifier">GHC.Core.SimpleOpt</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Class.html"><span class="hs-identifier">GHC.Core.Class</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html"><span class="hs-identifier">GHC.Core.DataCon</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html"><span class="hs-identifier">GHC.Types.Literal</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SourceText.html"><span class="hs-identifier">GHC.Types.SourceText</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.RepType.html"><span class="hs-identifier">GHC.Types.RepType</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.RepType.html#countFunRepArgs"><span class="hs-identifier">countFunRepArgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.RepType.html#typePrimRep"><span class="hs-identifier">typePrimRep</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html"><span class="hs-identifier">GHC.Types.Name.Set</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html"><span class="hs-identifier">GHC.Types.Name.Env</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.ForeignCall.html"><span class="hs-identifier">GHC.Types.ForeignCall</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.html"><span class="hs-identifier">GHC.Types.Id</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.Info.html"><span class="hs-identifier">GHC.Types.Id.Info</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Demand.html"><span class="hs-identifier">GHC.Types.Demand</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Cpr.html"><span class="hs-identifier">GHC.Types.Cpr</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html"><span class="hs-identifier">GHC.Types.Unique.Supply</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>       </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#SuccessFlag"><span class="hs-identifier">SuccessFlag</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.html"><span class="hs-identifier">GHC.Types.Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#VarBndr"><span class="hs-identifier">VarBndr</span></a></span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier">Bndr</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#visArgConstraintLike"><span class="hs-identifier">visArgConstraintLike</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#tyVarName"><span class="hs-identifier">tyVarName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html"><span class="hs-identifier">GHC.Tc.Types.Origin</span></a></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html"><span class="hs-identifier">GHC.Tc.Utils.TcType</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TcType</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.List.SetOps.html"><span class="hs-identifier">GHC.Data.List.SetOps</span></a></span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">zipWith4</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">-- A bit of a shame we must import these here</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Types.html"><span class="hs-identifier">GHC.StgToCmm.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.StgToCmm.Types.html#LambdaFormInfo"><span class="hs-identifier">LambdaFormInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Runtime.Heap.Layout.html"><span class="hs-identifier">GHC.Runtime.Heap.Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Runtime.Heap.Layout.html#ArgDescr"><span class="hs-identifier">ArgDescr</span></a></span><span class="hs-special">(</span><span class="annot"><a href="GHC.Runtime.Heap.Layout.html#ArgUnknown"><span class="hs-identifier">ArgUnknown</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Wired in Ids}
*                                                                      *
************************************************************************

Note [Wired-in Ids]
~~~~~~~~~~~~~~~~~~~
A &quot;wired-in&quot; Id can be referred to directly in GHC (e.g. 'voidPrimId')
rather than by looking it up its name in some environment or fetching
it from an interface file.

There are several reasons why an Id might appear in the wiredInIds:

* ghcPrimIds: see Note [ghcPrimIds (aka pseudoops)]

* magicIds: see Note [magicIds]

* errorIds, defined in GHC.Core.Make.
  These error functions (e.g. rUNTIME_ERROR_ID) are wired in
  because the desugarer generates code that mentions them directly

In all cases except ghcPrimIds, there is a definition site in a
library module, which may be called (e.g. in higher order situations);
but the wired-in version means that the details are never read from
that module's interface file; instead, the full definition is right
here.

Note [ghcPrimIds (aka pseudoops)]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The ghcPrimIds

  * Are exported from GHC.Prim (see ghcPrimExports, used in ghcPrimInterface)
    See Note [GHC.Prim] in primops.txt.pp for the remaining items in GHC.Prim.

  * Can't be defined in Haskell, and hence no Haskell binding site,
    but have perfectly reasonable unfoldings in Core

  * Either have a CompulsoryUnfolding (hence always inlined), or
        of an EvaldUnfolding and void representation (e.g. realWorldPrimId)

  * Are (or should be) defined in primops.txt.pp as 'pseudoop'
    Reason: that's how we generate documentation for them

Note [magicIds]
~~~~~~~~~~~~~~~
The magicIds

  * Are exported from GHC.Magic

  * Can be defined in Haskell (and are, in ghc-prim:GHC/Magic.hs).
    This definition at least generates Haddock documentation for them.

  * May or may not have a CompulsoryUnfolding.

  * But have some special behaviour that can't be done via an
    unfolding from an interface file.

  * May have IdInfo that differs from what would be imported from GHC.Magic.hi.
    For example, 'lazy' gets a lazy strictness signature, per Note [lazyId magic].

  The two remaining identifiers in GHC.Magic, runRW# and inline, are not
  listed in magicIds: they have special behavior but they can be known-key and
  not wired-in.
  Similarly for GHC.Internal.IO.seq# and GHC.Internal.Exts.considerAccessible.
  runRW#:             see Note [Simplification of runRW#] in Prep,
                      runRW# code in Simplifier, Note [Linting of runRW#].
  seq#:               see Note [seq# magic]
  inline:             see Note [inlineId magic]
  considerAccessible: see Note [considerAccessible]
-}</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="annot"><a href="GHC.Types.Id.Make.html#wiredInIds"><span class="hs-identifier hs-type">wiredInIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-172"></span><span id="wiredInIds"><span class="annot"><span class="annottext">wiredInIds :: [Id]
</span><a href="GHC.Types.Id.Make.html#wiredInIds"><span class="hs-identifier hs-var hs-var">wiredInIds</span></a></span></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">[Id]
</span><a href="GHC.Types.Id.Make.html#magicIds"><span class="hs-identifier hs-var">magicIds</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><span class="annottext">[Id] -&gt; [Id] -&gt; [Id]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="GHC.Types.Id.Make.html#ghcPrimIds"><span class="hs-identifier hs-var">ghcPrimIds</span></a></span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><span class="annottext">[Id] -&gt; [Id] -&gt; [Id]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="GHC.Core.Make.html#errorIds"><span class="hs-identifier hs-var">errorIds</span></a></span><span>           </span><span class="hs-comment">-- Defined in GHC.Core.Make</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="annot"><a href="GHC.Types.Id.Make.html#magicIds"><span class="hs-identifier hs-type">magicIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- See Note [magicIds]</span><span>
</span><span id="line-178"></span><span id="magicIds"><span class="annot"><span class="annottext">magicIds :: [Id]
</span><a href="GHC.Types.Id.Make.html#magicIds"><span class="hs-identifier hs-var hs-var">magicIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#lazyId"><span class="hs-identifier hs-var">lazyId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#oneShotId"><span class="hs-identifier hs-var">oneShotId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#noinlineId"><span class="hs-identifier hs-var">noinlineId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#noinlineConstraintId"><span class="hs-identifier hs-var">noinlineConstraintId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#nospecId"><span class="hs-identifier hs-var">nospecId</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="annot"><a href="GHC.Types.Id.Make.html#ghcPrimIds"><span class="hs-identifier hs-type">ghcPrimIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- See Note [ghcPrimIds (aka pseudoops)]</span><span>
</span><span id="line-181"></span><span id="ghcPrimIds"><span class="annot"><span class="annottext">ghcPrimIds :: [Id]
</span><a href="GHC.Types.Id.Make.html#ghcPrimIds"><span class="hs-identifier hs-var hs-var">ghcPrimIds</span></a></span></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#realWorldPrimId"><span class="hs-identifier hs-var">realWorldPrimId</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#voidPrimId"><span class="hs-identifier hs-var">voidPrimId</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#nullAddrId"><span class="hs-identifier hs-var">nullAddrId</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#seqId"><span class="hs-identifier hs-var">seqId</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#coerceId"><span class="hs-identifier hs-var">coerceId</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#proxyHashId"><span class="hs-identifier hs-var">proxyHashId</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#leftSectionId"><span class="hs-identifier hs-var">leftSectionId</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#rightSectionId"><span class="hs-identifier hs-var">rightSectionId</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Data constructors}
*                                                                      *
************************************************************************

The wrapper for a constructor is an ordinary top-level binding that evaluates
any strict args, unboxes any args that are going to be flattened, and calls
the worker.

We're going to build a constructor that looks like:

        data (Data a, C b) =&gt;  T a b = T1 !a !Int b

        T1 = /\ a b -&gt;
             \d1::Data a, d2::C b -&gt;
             \p q r -&gt; case p of { p -&gt;
                       case q of { q -&gt;
                       Con T1 [a,b] [p,q,r]}}

Notice that

* d2 is thrown away --- a context in a data decl is used to make sure
  one *could* construct dictionaries at the site the constructor
  is used, but the dictionary isn't actually used.

* We have to check that we can construct Data dictionaries for
  the types a and Int.  Once we've done that we can throw d1 away too.

* We use (case p of q -&gt; ...) to evaluate p, rather than &quot;seq&quot; because
  all that matters is that the arguments are evaluated.  &quot;seq&quot; is
  very careful to preserve evaluation order, which we don't need
  to be here.

  You might think that we could simply give constructors some strictness
  info, like PrimOps, and let CoreToStg do the let-to-case transformation.
  But we don't do that because in the case of primops and functions strictness
  is a *property* not a *requirement*.  In the case of constructors we need to
  do something active to evaluate the argument.

  Making an explicit case expression allows the simplifier to eliminate
  it in the (common) case where the constructor arg is already evaluated.

Note [Wrappers for data instance tycons]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In the case of data instances, the wrapper also applies the coercion turning
the representation type into the family instance type to cast the result of
the wrapper.  For example, consider the declarations

  data family Map k :: * -&gt; *
  data instance Map (a, b) v = MapPair (Map a (Pair b v))

The tycon to which the datacon MapPair belongs gets a unique internal
name of the form :R123Map, and we call it the representation tycon.
In contrast, Map is the family tycon (accessible via
tyConFamInst_maybe). A coercion allows you to move between
representation and family type.  It is accessible from :R123Map via
tyConFamilyCoercion_maybe and has kind

  Co123Map a b v :: {Map (a, b) v ~ :R123Map a b v}

The wrapper and worker of MapPair get the types

        -- Wrapper
  $WMapPair :: forall a b v. Map a (Map a b v) -&gt; Map (a, b) v
  $WMapPair a b v = MapPair a b v `cast` sym (Co123Map a b v)

        -- Worker
  MapPair :: forall a b v. Map a (Map a b v) -&gt; :R123Map a b v

This coercion is conditionally applied by wrapFamInstBody.

It's a bit more complicated if the data instance is a GADT as well!

   data instance T [a] where
        T1 :: forall b. b -&gt; T [Maybe b]

Hence we translate to

        -- Wrapper
  $WT1 :: forall b. b -&gt; T [Maybe b]
  $WT1 b v = T1 (Maybe b) b (Maybe b) v
                        `cast` sym (Co7T (Maybe b))

        -- Worker
  T1 :: forall c b. (c ~ Maybe b) =&gt; b -&gt; :R7T c

        -- Coercion from family type to representation type
  Co7T a :: T [a] ~ :R7T a

Newtype instances through an additional wrinkle into the mix. Consider the
following example (adapted from #15318, comment:2):

  data family T a
  newtype instance T [a] = MkT [a]

Within the newtype instance, there are three distinct types at play:

1. The newtype's underlying type, [a].
2. The instance's representation type, TList a (where TList is the
   representation tycon).
3. The family type, T [a].

We need two coercions in order to cast from (1) to (3):

(a) A newtype coercion axiom:

      axiom coTList a :: TList a ~ [a]

    (Where TList is the representation tycon of the newtype instance.)

(b) A data family instance coercion axiom:

      axiom coT a :: T [a] ~ TList a

When we translate the newtype instance to Core, we obtain:

    -- Wrapper
  $WMkT :: forall a. [a] -&gt; T [a]
  $WMkT a x = MkT a x |&gt; Sym (coT a)

    -- Worker
  MkT :: forall a. [a] -&gt; TList [a]
  MkT a x = x |&gt; Sym (coTList a)

Unlike for data instances, the worker for a newtype instance is actually an
executable function which expands to a cast, but otherwise, the general
strategy is essentially the same as for data instances. Also note that we have
a wrapper, which is unusual for a newtype, but we make GHC produce one anyway
for symmetry with the way data instances are handled.

Note [Newtype datacons]
~~~~~~~~~~~~~~~~~~~~~~~
The &quot;data constructor&quot; for a newtype should have no existentials. It's
not quite a &quot;vanilla&quot; data constructor, because the newtype arising from
     class C a =&gt; D a
looks like
       newtype T:D a = C:D (C a)
so the data constructor for T:C has a single argument, namely the
predicate (C a).  That ends up in the dcOtherTheta for the data con,
which makes it not vanilla.  So the assert just tests for existentials.
The rest is checked by having a singleton arg_tys.

Note [Newtype workers]
~~~~~~~~~~~~~~~~~~~~~~
A newtype does not really have a worker. Instead, newtype constructors
just unfold into a cast. But we need *something* for, say, MkAge to refer
to. So, we do this:

* The Id used as the newtype worker will have a compulsory unfolding to
  a cast. See Note [Compulsory newtype unfolding]

* This Id is labeled as a DataConWrapId. We don't want to use a DataConWorkId,
  as those have special treatment in the back end.

* There is no top-level binding, because the compulsory unfolding
  means that it will be inlined (to a cast) at every call site.

We probably should have a NewtypeWorkId, but these Ids disappear as soon as
we desugar anyway, so it seems a step too far.

Note [Compulsory newtype unfolding]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Newtype wrappers, just like workers, have compulsory unfoldings.
This is needed so that two optimizations involving newtypes have the same
effect whether a wrapper is present or not:

(1) Case-of-known constructor.
    See Note [beta-reduction in exprIsConApp_maybe].

(2) Matching against the map/coerce RULE. Suppose we have the RULE

    {-# RULE &quot;map/coerce&quot; map coerce = ... #-}

    As described in Note [Getting the map/coerce RULE to work],
    the occurrence of 'coerce' is transformed into:

    {-# RULE &quot;map/coerce&quot; forall (c :: T1 ~R# T2).
                          map ((\v -&gt; v) `cast` c) = ... #-}

    We'd like 'map Age' to match the LHS. For this to happen, Age
    must be unfolded, otherwise we'll be stuck. This is tested in T16208.

It also allows for the possibility of representation-polymorphic newtypes
with wrappers (with -XUnliftedNewtypes):

  newtype N (a :: TYPE r) = MkN a

With -XUnliftedNewtypes, this is allowed -- even though MkN is representation-
polymorphic. It's OK because MkN evaporates in the compiled code, becoming
just a cast. That is, it has a compulsory unfolding. As long as its
argument is not representation-polymorphic (which it can't be, according to
Note [Representation polymorphism invariants] in GHC.Core), and it's saturated,
no representation-polymorphic code ends up in the code generator.
The saturation condition is effectively checked in
GHC.Tc.Gen.Head.rejectRepPolyNewtypes.

However, if we make a *wrapper* for a newtype, we get into trouble.
In that case, we generate a forbidden representation-polymorphic
binding, and we must then ensure that it is always instantiated
at a representation-monomorphic type.

The solution is simple, though: just make the newtype wrappers
as ephemeral as the newtype workers. In other words, give the wrappers
compulsory unfoldings and no bindings. The compulsory unfolding is given
in wrap_unf in mkDataConRep, and the lack of a binding happens in
GHC.Iface.Tidy.getTyConImplicitBinds, where we say that a newtype has no
implicit bindings.

Note [Records and linear types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
All the fields, in a record constructor, are linear, because there is no syntax
to specify the type of record field. There will be (see the proposal
https://github.com/ghc-proposals/ghc-proposals/blob/master/proposals/0111-linear-types.rst#records-and-projections
), but it isn't implemented yet.

Projections of records can't be linear:

  data Foo = MkFoo { a :: A, b :: B }

If we had

  a :: Foo %1 -&gt; A

We could write

  bad :: A %1 -&gt; B %1 -&gt; A
  bad x y = a (MkFoo { a=x, b=y })

There is an exception: if `b` (more generally all the fields besides `a`) is
unrestricted, then is perfectly possible to have a linear projection. Such a
linear projection has as simple definition.

  data Bar = MkBar { c :: C, d % Many :: D }

  c :: Bar %1 -&gt; C
  c MkBar{ c=x, d=_} = x

The `% Many` syntax, for records, does not exist yet. But there is one important
special case which already happens: when there is a single field (usually a
newtype).

  newtype Baz = MkBaz { unbaz :: E }

unbaz could be linear. And, in fact, it is linear in the proposal design.

However, this hasn't been implemented yet.

************************************************************************
*                                                                      *
\subsection{Dictionary selectors}
*                                                                      *
************************************************************************

Selecting a field for a dictionary.  If there is just one field, then
there's nothing to do.

Dictionary selectors may get nested forall-types.  Thus:

        class Foo a where
          op :: forall b. Ord b =&gt; a -&gt; b -&gt; b

Then the top-level type for op is

        op :: forall a. Foo a =&gt;
              forall b. Ord b =&gt;
              a -&gt; b -&gt; b

Note [Type classes and linear types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Constraints, in particular type classes, don't have attached linearity
information. Implicitly, they are all unrestricted. See the linear types proposal,
https://github.com/ghc-proposals/ghc-proposals/blob/master/proposals/0111-linear-types.rst .

When translating to core `C =&gt; ...` is always translated to an unrestricted
arrow `C % Many -&gt; ...`.

Therefore there is no loss of generality if we make all selectors unrestricted.

-}</span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="annot"><a href="GHC.Types.Id.Make.html#mkDictSelId"><span class="hs-identifier hs-type">mkDictSelId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>          </span><span class="hs-comment">-- Name of one of the *value* selectors</span><span>
</span><span id="line-476"></span><span>                             </span><span class="hs-comment">-- (dictionary superclass or method)</span><span>
</span><span id="line-477"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Class.html#Class"><span class="hs-identifier hs-type">Class</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-478"></span><span id="mkDictSelId"><span class="annot"><span class="annottext">mkDictSelId :: Name -&gt; Class -&gt; Id
</span><a href="GHC.Types.Id.Make.html#mkDictSelId"><span class="hs-identifier hs-var hs-var">mkDictSelId</span></a></span></span><span> </span><span id="local-6989586621682745251"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745251"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682745252"><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621682745252"><span class="hs-identifier hs-var">clas</span></a></span></span><span>
</span><span id="line-479"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdDetails -&gt; Name -&gt; Type -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.html#mkGlobalId"><span class="hs-identifier hs-var">mkGlobalId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Class -&gt; Bool -&gt; IdDetails
</span><a href="GHC.Types.Id.Info.html#ClassOpId"><span class="hs-identifier hs-var">ClassOpId</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621682745252"><span class="hs-identifier hs-var">clas</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682745255"><span class="hs-identifier hs-var">terminating</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745251"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745256"><span class="hs-identifier hs-var">sel_ty</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745257"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-481"></span><span>    </span><span id="local-6989586621682745258"><span class="annot"><span class="annottext">tycon :: TyCon
</span><a href="#local-6989586621682745258"><span class="hs-identifier hs-var hs-var">tycon</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Class -&gt; TyCon
</span><a href="GHC.Core.Class.html#classTyCon"><span class="hs-identifier hs-var">classTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621682745252"><span class="hs-identifier hs-var">clas</span></a></span><span>
</span><span id="line-482"></span><span>    </span><span id="local-6989586621682745260"><span class="annot"><span class="annottext">sel_names :: [Name]
</span><a href="#local-6989586621682745260"><span class="hs-identifier hs-var hs-var">sel_names</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Id -&gt; Name) -&gt; [Id] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Class -&gt; [Id]
</span><a href="GHC.Core.Class.html#classAllSelIds"><span class="hs-identifier hs-var">classAllSelIds</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621682745252"><span class="hs-identifier hs-var">clas</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>    </span><span id="local-6989586621682745263"><span class="annot"><span class="annottext">new_tycon :: Bool
</span><a href="#local-6989586621682745263"><span class="hs-identifier hs-var hs-var">new_tycon</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745258"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-484"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682745265"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745265"><span class="hs-identifier hs-var">data_con</span></a></span></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [DataCon]
</span><a href="GHC.Core.TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745258"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-485"></span><span>    </span><span id="local-6989586621682745267"><span class="annot"><span class="annottext">tyvars :: [InvisTVBinder]
</span><a href="#local-6989586621682745267"><span class="hs-identifier hs-var hs-var">tyvars</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [InvisTVBinder]
</span><a href="GHC.Core.DataCon.html#dataConUserTyVarBinders"><span class="hs-identifier hs-var">dataConUserTyVarBinders</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745265"><span class="hs-identifier hs-var">data_con</span></a></span><span>
</span><span id="line-486"></span><span>    </span><span id="local-6989586621682745269"><span class="annot"><span class="annottext">n_ty_args :: Int
</span><a href="#local-6989586621682745269"><span class="hs-identifier hs-var hs-var">n_ty_args</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder]
</span><a href="#local-6989586621682745267"><span class="hs-identifier hs-var">tyvars</span></a></span><span>
</span><span id="line-487"></span><span>    </span><span id="local-6989586621682745271"><span class="annot"><span class="annottext">arg_tys :: [Scaled Type]
</span><a href="#local-6989586621682745271"><span class="hs-identifier hs-var hs-var">arg_tys</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [Scaled Type]
</span><a href="GHC.Core.DataCon.html#dataConRepArgTys"><span class="hs-identifier hs-var">dataConRepArgTys</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745265"><span class="hs-identifier hs-var">data_con</span></a></span><span>  </span><span class="hs-comment">-- Includes the dictionary superclasses</span><span>
</span><span id="line-488"></span><span>    </span><span id="local-6989586621682745273"><span class="annot"><span class="annottext">val_index :: Int
</span><a href="#local-6989586621682745273"><span class="hs-identifier hs-var hs-var">val_index</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Assoc Name Int -&gt; Name -&gt; Int
forall a b. Eq a =&gt; String -&gt; Assoc a b -&gt; a -&gt; b
</span><a href="GHC.Data.List.SetOps.html#assoc"><span class="hs-identifier hs-var">assoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MkId.mkDictSelId&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682745260"><span class="hs-identifier hs-var">sel_names</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Int] -&gt; Assoc Name Int
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-operator hs-var">`zip`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745251"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span>    </span><span id="local-6989586621682745275"><span class="annot"><span class="annottext">pred_ty :: Type
</span><a href="#local-6989586621682745275"><span class="hs-identifier hs-var hs-var">pred_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Class -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Predicate.html#mkClassPred"><span class="hs-identifier hs-var">mkClassPred</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621682745252"><span class="hs-identifier hs-var">clas</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTys"><span class="hs-identifier hs-var">mkTyVarTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[InvisTVBinder] -&gt; [Id]
forall tv argf. [VarBndr tv argf] -&gt; [tv]
</span><a href="GHC.Types.Var.html#binderVars"><span class="hs-identifier hs-var">binderVars</span></a></span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder]
</span><a href="#local-6989586621682745267"><span class="hs-identifier hs-var">tyvars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>    </span><span id="local-6989586621682745279"><span class="annot"><span class="annottext">res_ty :: Type
</span><a href="#local-6989586621682745279"><span class="hs-identifier hs-var hs-var">res_ty</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scaled Type -&gt; Type
forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Scaled Type] -&gt; Int -&gt; Scaled Type
forall a. Outputable a =&gt; [a] -&gt; Int -&gt; a
</span><a href="GHC.Data.List.SetOps.html#getNth"><span class="hs-identifier hs-var">getNth</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682745271"><span class="hs-identifier hs-var">arg_tys</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745273"><span class="hs-identifier hs-var">val_index</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>    </span><span id="local-6989586621682745256"><span class="annot"><span class="annottext">sel_ty :: Type
</span><a href="#local-6989586621682745256"><span class="hs-identifier hs-var hs-var">sel_ty</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkInvisForAllTys"><span class="hs-identifier hs-var">mkInvisForAllTys</span></a></span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder]
</span><a href="#local-6989586621682745267"><span class="hs-identifier hs-var">tyvars</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-493"></span><span>              </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type -&gt; Type -&gt; Type
Type -&gt; Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkFunctionType"><span class="hs-identifier hs-var">mkFunctionType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745275"><span class="hs-identifier hs-var">pred_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745279"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-494"></span><span>             </span><span class="hs-comment">-- See Note [Type classes and linear types]</span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span>    </span><span id="local-6989586621682745255"><span class="annot"><span class="annottext">terminating :: Bool
</span><a href="#local-6989586621682745255"><span class="hs-identifier hs-var hs-var">terminating</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Bool
Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTerminatingType"><span class="hs-identifier hs-var">isTerminatingType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745279"><span class="hs-identifier hs-var">res_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#definitelyUnliftedType"><span class="hs-identifier hs-var">definitelyUnliftedType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745279"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-497"></span><span>                  </span><span class="hs-comment">-- If the field is unlifted, it can't be bottom</span><span>
</span><span id="line-498"></span><span>                  </span><span class="hs-comment">-- Ditto if it's a terminating type</span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span>    </span><span id="local-6989586621682745288"><span class="annot"><span class="annottext">base_info :: IdInfo
</span><a href="#local-6989586621682745288"><span class="hs-identifier hs-var hs-var">base_info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span>
</span><span id="line-501"></span><span>                </span><span class="annot"><span class="annottext">IdInfo -&gt; Int -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setArityInfo"><span class="hs-operator hs-var">`setArityInfo`</span></a></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-502"></span><span>                </span><span class="annot"><span class="annottext">IdInfo -&gt; DmdSig -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setDmdSigInfo"><span class="hs-operator hs-var">`setDmdSigInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">DmdSig
</span><a href="#local-6989586621682745292"><span class="hs-identifier hs-var">strict_sig</span></a></span><span>
</span><span id="line-503"></span><span>                </span><span class="annot"><span class="annottext">IdInfo -&gt; CprSig -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setCprSigInfo"><span class="hs-operator hs-var">`setCprSigInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">CprSig
</span><a href="GHC.Types.Cpr.html#topCprSig"><span class="hs-identifier hs-var">topCprSig</span></a></span><span>
</span><span id="line-504"></span><span>
</span><span id="line-505"></span><span>    </span><span id="local-6989586621682745257"><span class="annot"><span class="annottext">info :: IdInfo
</span><a href="#local-6989586621682745257"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682745263"><span class="hs-identifier hs-var">new_tycon</span></a></span><span>
</span><span id="line-506"></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745288"><span class="hs-identifier hs-var">base_info</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo -&gt; InlinePragma -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setInlinePragInfo"><span class="hs-operator hs-var">`setInlinePragInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="GHC.Types.Basic.html#alwaysInlinePragma"><span class="hs-identifier hs-var">alwaysInlinePragma</span></a></span><span>
</span><span id="line-507"></span><span>                     </span><span class="annot"><span class="annottext">IdInfo -&gt; Unfolding -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setUnfoldingInfo"><span class="hs-operator hs-var">`setUnfoldingInfo`</span></a></span><span>  </span><span class="annot"><span class="annottext">SimpleOpts -&gt; UnfoldingSource -&gt; Int -&gt; CoreExpr -&gt; Unfolding
</span><a href="GHC.Core.Unfold.Make.html#mkInlineUnfoldingWithArity"><span class="hs-identifier hs-var">mkInlineUnfoldingWithArity</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleOpts
</span><a href="GHC.Core.SimpleOpt.html#defaultSimpleOpts"><span class="hs-identifier hs-var">defaultSimpleOpts</span></a></span><span>
</span><span id="line-508"></span><span>                                           </span><span class="annot"><span class="annottext">UnfoldingSource
</span><a href="GHC.Types.Basic.html#StableSystemSrc"><span class="hs-identifier hs-var">StableSystemSrc</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-509"></span><span>                                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Class -&gt; Int -&gt; CoreExpr
</span><a href="GHC.Types.Id.Make.html#mkDictSelRhs"><span class="hs-identifier hs-var">mkDictSelRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621682745252"><span class="hs-identifier hs-var">clas</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745273"><span class="hs-identifier hs-var">val_index</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>                   </span><span class="hs-comment">-- See Note [Single-method classes] in GHC.Tc.TyCl.Instance</span><span>
</span><span id="line-511"></span><span>                   </span><span class="hs-comment">-- for why alwaysInlinePragma</span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-514"></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745288"><span class="hs-identifier hs-var">base_info</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo -&gt; RuleInfo -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setRuleInfo"><span class="hs-operator hs-var">`setRuleInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreRule] -&gt; RuleInfo
</span><a href="GHC.Core.FVs.html#mkRuleInfo"><span class="hs-identifier hs-var">mkRuleInfo</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CoreRule
</span><a href="#local-6989586621682745302"><span class="hs-identifier hs-var">rule</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-515"></span><span>                     </span><span class="annot"><span class="annottext">IdInfo -&gt; InlinePragma -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setInlinePragInfo"><span class="hs-operator hs-var">`setInlinePragInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="GHC.Types.Basic.html#neverInlinePragma"><span class="hs-identifier hs-var">neverInlinePragma</span></a></span><span>
</span><span id="line-516"></span><span>                     </span><span class="annot"><span class="annottext">IdInfo -&gt; Unfolding -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setUnfoldingInfo"><span class="hs-operator hs-var">`setUnfoldingInfo`</span></a></span><span>  </span><span class="annot"><span class="annottext">SimpleOpts -&gt; UnfoldingSource -&gt; Int -&gt; CoreExpr -&gt; Unfolding
</span><a href="GHC.Core.Unfold.Make.html#mkInlineUnfoldingWithArity"><span class="hs-identifier hs-var">mkInlineUnfoldingWithArity</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleOpts
</span><a href="GHC.Core.SimpleOpt.html#defaultSimpleOpts"><span class="hs-identifier hs-var">defaultSimpleOpts</span></a></span><span>
</span><span id="line-517"></span><span>                                           </span><span class="annot"><span class="annottext">UnfoldingSource
</span><a href="GHC.Types.Basic.html#StableSystemSrc"><span class="hs-identifier hs-var">StableSystemSrc</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-518"></span><span>                                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Class -&gt; Int -&gt; CoreExpr
</span><a href="GHC.Types.Id.Make.html#mkDictSelRhs"><span class="hs-identifier hs-var">mkDictSelRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621682745252"><span class="hs-identifier hs-var">clas</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745273"><span class="hs-identifier hs-var">val_index</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>                   </span><span class="hs-comment">-- Add a magic BuiltinRule, but no unfolding</span><span>
</span><span id="line-520"></span><span>                   </span><span class="hs-comment">-- so that the rule is always available to fire.</span><span>
</span><span id="line-521"></span><span>                   </span><span class="hs-comment">-- See Note [ClassOp/DFun selection] in GHC.Tc.TyCl.Instance</span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span>    </span><span class="hs-comment">-- This is the built-in rule that goes</span><span>
</span><span id="line-524"></span><span>    </span><span class="hs-comment">--      op (dfT d1 d2) ---&gt;  opT d1 d2</span><span>
</span><span id="line-525"></span><span>    </span><span id="local-6989586621682745302"><span class="annot"><span class="annottext">rule :: CoreRule
</span><a href="#local-6989586621682745302"><span class="hs-identifier hs-var hs-var">rule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.html#BuiltinRule"><span class="hs-identifier hs-type">BuiltinRule</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ru_name :: RuleName
</span><a href="GHC.Core.html#ru_name"><span class="hs-identifier hs-var">ru_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Class op &quot;</span></span><span> </span><span class="annot"><span class="annottext">RuleName -&gt; RuleName -&gt; RuleName
</span><a href="GHC.Data.FastString.html#appendFS"><span class="hs-operator hs-var">`appendFS`</span></a></span><span>
</span><span id="line-526"></span><span>                                     </span><span class="annot"><span class="annottext">OccName -&gt; RuleName
</span><a href="GHC.Types.Name.Occurrence.html#occNameFS"><span class="hs-identifier hs-var">occNameFS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; OccName
forall a. NamedThing a =&gt; a -&gt; OccName
</span><a href="GHC.Types.Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745251"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_fn :: Name
</span><a href="GHC.Core.html#ru_fn"><span class="hs-identifier hs-var">ru_fn</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745251"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-528"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_nargs :: Int
</span><a href="GHC.Core.html#ru_nargs"><span class="hs-identifier hs-var">ru_nargs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745269"><span class="hs-identifier hs-var">n_ty_args</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-529"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_try :: RuleFun
</span><a href="GHC.Core.html#ru_try"><span class="hs-identifier hs-var">ru_try</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; RuleFun
</span><a href="GHC.Types.Id.Make.html#dictSelRule"><span class="hs-identifier hs-var">dictSelRule</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745273"><span class="hs-identifier hs-var">val_index</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745269"><span class="hs-identifier hs-var">n_ty_args</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span>        </span><span class="hs-comment">-- The strictness signature is of the form U(AAAVAAAA) -&gt; T</span><span>
</span><span id="line-532"></span><span>        </span><span class="hs-comment">-- where the V depends on which item we are selecting</span><span>
</span><span id="line-533"></span><span>        </span><span class="hs-comment">-- It's worth giving one, so that absence info etc is generated</span><span>
</span><span id="line-534"></span><span>        </span><span class="hs-comment">-- even if the selector isn't inlined</span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span>    </span><span id="local-6989586621682745292"><span class="annot"><span class="annottext">strict_sig :: DmdSig
</span><a href="#local-6989586621682745292"><span class="hs-identifier hs-var hs-var">strict_sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Demand] -&gt; Divergence -&gt; DmdSig
</span><a href="GHC.Types.Demand.html#mkClosedDmdSig"><span class="hs-identifier hs-var">mkClosedDmdSig</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Demand
</span><a href="#local-6989586621682745316"><span class="hs-identifier hs-var">arg_dmd</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Divergence
</span><a href="GHC.Types.Demand.html#topDiv"><span class="hs-identifier hs-var">topDiv</span></a></span><span>
</span><span id="line-537"></span><span>    </span><span id="local-6989586621682745316"><span class="annot"><span class="annottext">arg_dmd :: Demand
</span><a href="#local-6989586621682745316"><span class="hs-identifier hs-var hs-var">arg_dmd</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682745263"><span class="hs-identifier hs-var">new_tycon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Demand
</span><a href="GHC.Types.Demand.html#evalDmd"><span class="hs-identifier hs-var">evalDmd</span></a></span><span>
</span><span id="line-538"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="GHC.Types.Demand.html#C_1N"><span class="hs-identifier hs-var">C_1N</span></a></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Card -&gt; SubDemand -&gt; Demand
Card -&gt; SubDemand -&gt; Demand
</span><a href="GHC.Types.Demand.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a></span><span> </span><span class="annot"><span class="annottext">Boxity -&gt; [Demand] -&gt; SubDemand
</span><a href="GHC.Types.Demand.html#mkProd"><span class="hs-identifier hs-var">mkProd</span></a></span><span> </span><span class="annot"><span class="annottext">Boxity
</span><a href="Language.Haskell.Syntax.Basic.html#Unboxed"><span class="hs-identifier hs-var">Unboxed</span></a></span><span> </span><span class="annot"><span class="annottext">[Demand]
</span><a href="#local-6989586621682745323"><span class="hs-identifier hs-var">dict_field_dmds</span></a></span><span>
</span><span id="line-539"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-540"></span><span>              </span><span class="hs-comment">-- The evalDmd below is just a placeholder and will be replaced in</span><span>
</span><span id="line-541"></span><span>              </span><span class="hs-comment">-- GHC.Types.Demand.dmdTransformDictSel</span><span>
</span><span id="line-542"></span><span>              </span><span id="local-6989586621682745323"><span class="annot"><span class="annottext">dict_field_dmds :: [Demand]
</span><a href="#local-6989586621682745323"><span class="hs-identifier hs-var hs-var">dict_field_dmds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745251"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745324"><span class="hs-identifier hs-var">sel_name</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Demand
</span><a href="GHC.Types.Demand.html#evalDmd"><span class="hs-identifier hs-var">evalDmd</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Demand
</span><a href="GHC.Types.Demand.html#absDmd"><span class="hs-identifier hs-var">absDmd</span></a></span><span>
</span><span id="line-543"></span><span>                                </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682745324"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745324"><span class="hs-identifier hs-var">sel_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621682745260"><span class="hs-identifier hs-var">sel_names</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span class="annot"><a href="GHC.Types.Id.Make.html#mkDictSelRhs"><span class="hs-identifier hs-type">mkDictSelRhs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Class.html#Class"><span class="hs-identifier hs-type">Class</span></a></span><span>
</span><span id="line-546"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>         </span><span class="hs-comment">-- 0-indexed selector among (superclasses ++ methods)</span><span>
</span><span id="line-547"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-548"></span><span id="mkDictSelRhs"><span class="annot"><span class="annottext">mkDictSelRhs :: Class -&gt; Int -&gt; CoreExpr
</span><a href="GHC.Types.Id.Make.html#mkDictSelRhs"><span class="hs-identifier hs-var hs-var">mkDictSelRhs</span></a></span></span><span> </span><span id="local-6989586621682745326"><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621682745326"><span class="hs-identifier hs-var">clas</span></a></span></span><span> </span><span id="local-6989586621682745327"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745327"><span class="hs-identifier hs-var">val_index</span></a></span></span><span>
</span><span id="line-549"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; CoreExpr -&gt; CoreExpr
forall b. [b] -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745329"><span class="hs-identifier hs-var">tyvars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr -&gt; CoreExpr
forall b. b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745331"><span class="hs-identifier hs-var">dict_id</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745332"><span class="hs-identifier hs-var">rhs_body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-551"></span><span>    </span><span id="local-6989586621682745333"><span class="annot"><span class="annottext">tycon :: TyCon
</span><a href="#local-6989586621682745333"><span class="hs-identifier hs-var hs-var">tycon</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Class -&gt; TyCon
</span><a href="GHC.Core.Class.html#classTyCon"><span class="hs-identifier hs-var">classTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621682745326"><span class="hs-identifier hs-var">clas</span></a></span><span>
</span><span id="line-552"></span><span>    </span><span id="local-6989586621682745334"><span class="annot"><span class="annottext">new_tycon :: Bool
</span><a href="#local-6989586621682745334"><span class="hs-identifier hs-var hs-var">new_tycon</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745333"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-553"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682745335"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745335"><span class="hs-identifier hs-var">data_con</span></a></span></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [DataCon]
</span><a href="GHC.Core.TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745333"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-554"></span><span>    </span><span id="local-6989586621682745329"><span class="annot"><span class="annottext">tyvars :: [Id]
</span><a href="#local-6989586621682745329"><span class="hs-identifier hs-var hs-var">tyvars</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [Id]
</span><a href="GHC.Core.DataCon.html#dataConUnivTyVars"><span class="hs-identifier hs-var">dataConUnivTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745335"><span class="hs-identifier hs-var">data_con</span></a></span><span>
</span><span id="line-555"></span><span>    </span><span id="local-6989586621682745337"><span class="annot"><span class="annottext">arg_tys :: [Scaled Type]
</span><a href="#local-6989586621682745337"><span class="hs-identifier hs-var hs-var">arg_tys</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [Scaled Type]
</span><a href="GHC.Core.DataCon.html#dataConRepArgTys"><span class="hs-identifier hs-var">dataConRepArgTys</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745335"><span class="hs-identifier hs-var">data_con</span></a></span><span>  </span><span class="hs-comment">-- Includes the dictionary superclasses</span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span>    </span><span id="local-6989586621682745338"><span class="annot"><span class="annottext">the_arg_id :: Id
</span><a href="#local-6989586621682745338"><span class="hs-identifier hs-var hs-var">the_arg_id</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Int -&gt; Id
forall a. Outputable a =&gt; [a] -&gt; Int -&gt; a
</span><a href="GHC.Data.List.SetOps.html#getNth"><span class="hs-identifier hs-var">getNth</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745339"><span class="hs-identifier hs-var">arg_ids</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745327"><span class="hs-identifier hs-var">val_index</span></a></span><span>
</span><span id="line-558"></span><span>    </span><span id="local-6989586621682745340"><span class="annot"><span class="annottext">pred :: Type
</span><a href="#local-6989586621682745340"><span class="hs-identifier hs-var hs-var">pred</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Class -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Predicate.html#mkClassPred"><span class="hs-identifier hs-var">mkClassPred</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621682745326"><span class="hs-identifier hs-var">clas</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTys"><span class="hs-identifier hs-var">mkTyVarTys</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745329"><span class="hs-identifier hs-var">tyvars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>    </span><span id="local-6989586621682745331"><span class="annot"><span class="annottext">dict_id :: Id
</span><a href="#local-6989586621682745331"><span class="hs-identifier hs-var hs-var">dict_id</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type -&gt; Id
</span><a href="GHC.Types.Id.html#mkTemplateLocal"><span class="hs-identifier hs-var">mkTemplateLocal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745340"><span class="hs-identifier hs-var">pred</span></a></span><span>
</span><span id="line-560"></span><span>    </span><span id="local-6989586621682745339"><span class="annot"><span class="annottext">arg_ids :: [Id]
</span><a href="#local-6989586621682745339"><span class="hs-identifier hs-var hs-var">arg_ids</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Type] -&gt; [Id]
</span><a href="GHC.Types.Id.html#mkTemplateLocalsNum"><span class="hs-identifier hs-var">mkTemplateLocalsNum</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Scaled Type -&gt; Type) -&gt; [Scaled Type] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Scaled Type -&gt; Type
forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682745337"><span class="hs-identifier hs-var">arg_tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span>    </span><span id="local-6989586621682745332"><span class="annot"><span class="annottext">rhs_body :: CoreExpr
</span><a href="#local-6989586621682745332"><span class="hs-identifier hs-var hs-var">rhs_body</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682745334"><span class="hs-identifier hs-var">new_tycon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Types.Id.Make.html#unwrapNewTypeBody"><span class="hs-identifier hs-var">unwrapNewTypeBody</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745333"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTys"><span class="hs-identifier hs-var">mkTyVarTys</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745329"><span class="hs-identifier hs-var">tyvars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>                                                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745331"><span class="hs-identifier hs-var">dict_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Id -&gt; AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Utils.html#mkSingleAltCase"><span class="hs-identifier hs-var">mkSingleAltCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745331"><span class="hs-identifier hs-var">dict_id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745331"><span class="hs-identifier hs-var">dict_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745335"><span class="hs-identifier hs-var">data_con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-565"></span><span>                                           </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745339"><span class="hs-identifier hs-var">arg_ids</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#varToCoreExpr"><span class="hs-identifier hs-var">varToCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745338"><span class="hs-identifier hs-var">the_arg_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>                                </span><span class="hs-comment">-- varToCoreExpr needed for equality superclass selectors</span><span>
</span><span id="line-567"></span><span>                                </span><span class="hs-comment">--   sel a b d = case x of { MkC _ (g:a~b) _ -&gt; CO g }</span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span class="annot"><a href="GHC.Types.Id.Make.html#dictSelRule"><span class="hs-identifier hs-type">dictSelRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#RuleFun"><span class="hs-identifier hs-type">RuleFun</span></a></span><span>
</span><span id="line-570"></span><span class="hs-comment">-- Tries to persuade the argument to look like a constructor</span><span>
</span><span id="line-571"></span><span class="hs-comment">-- application, using exprIsConApp_maybe, and then selects</span><span>
</span><span id="line-572"></span><span class="hs-comment">-- from it</span><span>
</span><span id="line-573"></span><span class="hs-comment">--       sel_i t1..tk (D t1..tk op1 ... opm) = opi</span><span>
</span><span id="line-574"></span><span class="hs-comment">--</span><span>
</span><span id="line-575"></span><span id="dictSelRule"><span class="annot"><span class="annottext">dictSelRule :: Int -&gt; Int -&gt; RuleFun
</span><a href="GHC.Types.Id.Make.html#dictSelRule"><span class="hs-identifier hs-var hs-var">dictSelRule</span></a></span></span><span> </span><span id="local-6989586621682745348"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745348"><span class="hs-identifier hs-var">val_index</span></a></span></span><span> </span><span id="local-6989586621682745349"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745349"><span class="hs-identifier hs-var">n_ty_args</span></a></span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682745350"><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682745350"><span class="hs-identifier hs-var">id_unf</span></a></span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682745351"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682745351"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682745352"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745352"><span class="hs-identifier hs-var">dict_arg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [CoreExpr] -&gt; [CoreExpr]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745349"><span class="hs-identifier hs-var">n_ty_args</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682745351"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-577"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745354"><span class="annot"><span class="annottext">[FloatBind]
</span><a href="#local-6989586621682745354"><span class="hs-identifier hs-var">floats</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DataCon
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745355"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682745355"><span class="hs-identifier hs-var">con_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt;
InScopeEnv
-&gt; CoreExpr
-&gt; Maybe (InScopeSet, [FloatBind], DataCon, [Type], [CoreExpr])
InScopeEnv
-&gt; CoreExpr
-&gt; Maybe (InScopeSet, [FloatBind], DataCon, [Type], [CoreExpr])
</span><a href="GHC.Core.SimpleOpt.html#exprIsConApp_maybe"><span class="hs-identifier hs-var">exprIsConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682745350"><span class="hs-identifier hs-var">id_unf</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745352"><span class="hs-identifier hs-var">dict_arg</span></a></span><span>
</span><span id="line-578"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FloatBind] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#wrapFloats"><span class="hs-identifier hs-var">wrapFloats</span></a></span><span> </span><span class="annot"><span class="annottext">[FloatBind]
</span><a href="#local-6989586621682745354"><span class="hs-identifier hs-var">floats</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; Int -&gt; CoreExpr
forall a. Outputable a =&gt; [a] -&gt; Int -&gt; a
</span><a href="GHC.Data.List.SetOps.html#getNth"><span class="hs-identifier hs-var">getNth</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682745355"><span class="hs-identifier hs-var">con_args</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745348"><span class="hs-identifier hs-var">val_index</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-580"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-581"></span><span>
</span><span id="line-582"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Data constructors
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span class="annot"><a href="GHC.Types.Id.Make.html#mkDataConWorkId"><span class="hs-identifier hs-type">mkDataConWorkId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-591"></span><span id="mkDataConWorkId"><span class="annot"><span class="annottext">mkDataConWorkId :: Name -&gt; DataCon -&gt; Id
</span><a href="GHC.Types.Id.Make.html#mkDataConWorkId"><span class="hs-identifier hs-var hs-var">mkDataConWorkId</span></a></span></span><span> </span><span id="local-6989586621682745358"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745358"><span class="hs-identifier hs-var">wkr_name</span></a></span></span><span> </span><span id="local-6989586621682745359"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745359"><span class="hs-identifier hs-var">data_con</span></a></span></span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745360"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-593"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdDetails -&gt; Name -&gt; Type -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.html#mkGlobalId"><span class="hs-identifier hs-var">mkGlobalId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; IdDetails
</span><a href="GHC.Types.Id.Info.html#DataConWrapId"><span class="hs-identifier hs-var">DataConWrapId</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745359"><span class="hs-identifier hs-var">data_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745358"><span class="hs-identifier hs-var">wkr_name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745362"><span class="hs-identifier hs-var">wkr_ty</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745363"><span class="hs-identifier hs-var">nt_work_info</span></a></span><span>
</span><span id="line-594"></span><span>      </span><span class="hs-comment">-- See Note [Newtype workers]</span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-597"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdDetails -&gt; Name -&gt; Type -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.html#mkGlobalId"><span class="hs-identifier hs-var">mkGlobalId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; IdDetails
</span><a href="GHC.Types.Id.Info.html#DataConWorkId"><span class="hs-identifier hs-var">DataConWorkId</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745359"><span class="hs-identifier hs-var">data_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745358"><span class="hs-identifier hs-var">wkr_name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745362"><span class="hs-identifier hs-var">wkr_ty</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745365"><span class="hs-identifier hs-var">alg_wkr_info</span></a></span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-600"></span><span>    </span><span id="local-6989586621682745360"><span class="annot"><span class="annottext">tycon :: TyCon
</span><a href="#local-6989586621682745360"><span class="hs-identifier hs-var hs-var">tycon</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; TyCon
</span><a href="GHC.Core.DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745359"><span class="hs-identifier hs-var">data_con</span></a></span><span>  </span><span class="hs-comment">-- The representation TyCon</span><span>
</span><span id="line-601"></span><span>    </span><span id="local-6989586621682745362"><span class="annot"><span class="annottext">wkr_ty :: Type
</span><a href="#local-6989586621682745362"><span class="hs-identifier hs-var hs-var">wkr_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Type
</span><a href="GHC.Core.DataCon.html#dataConRepType"><span class="hs-identifier hs-var">dataConRepType</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745359"><span class="hs-identifier hs-var">data_con</span></a></span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span>    </span><span class="hs-comment">----------- Workers for data types --------------</span><span>
</span><span id="line-604"></span><span>    </span><span id="local-6989586621682745365"><span class="annot"><span class="annottext">alg_wkr_info :: IdInfo
</span><a href="#local-6989586621682745365"><span class="hs-identifier hs-var hs-var">alg_wkr_info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span>
</span><span id="line-605"></span><span>                   </span><span class="annot"><span class="annottext">IdInfo -&gt; Int -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setArityInfo"><span class="hs-operator hs-var">`setArityInfo`</span></a></span><span>          </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745368"><span class="hs-identifier hs-var">wkr_arity</span></a></span><span>
</span><span id="line-606"></span><span>                   </span><span class="annot"><span class="annottext">IdInfo -&gt; InlinePragma -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setInlinePragInfo"><span class="hs-operator hs-var">`setInlinePragInfo`</span></a></span><span>     </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621682745369"><span class="hs-identifier hs-var">wkr_inline_prag</span></a></span><span>
</span><span id="line-607"></span><span>                   </span><span class="annot"><span class="annottext">IdInfo -&gt; Unfolding -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setUnfoldingInfo"><span class="hs-operator hs-var">`setUnfoldingInfo`</span></a></span><span>      </span><span class="annot"><span class="annottext">Unfolding
</span><a href="GHC.Core.html#evaldUnfolding"><span class="hs-identifier hs-var">evaldUnfolding</span></a></span><span>  </span><span class="hs-comment">-- Record that it's evaluated,</span><span>
</span><span id="line-608"></span><span>                                                           </span><span class="hs-comment">-- even if arity = 0</span><span>
</span><span id="line-609"></span><span>                   </span><span class="annot"><span class="annottext">IdInfo -&gt; LambdaFormInfo -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setLFInfo"><span class="hs-operator hs-var">`setLFInfo`</span></a></span><span>             </span><span class="annot"><span class="annottext">LambdaFormInfo
</span><a href="#local-6989586621682745372"><span class="hs-identifier hs-var">wkr_lf_info</span></a></span><span>
</span><span id="line-610"></span><span>          </span><span class="hs-comment">-- No strictness: see Note [Data-con worker strictness] in GHC.Core.DataCon</span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span>    </span><span id="local-6989586621682745369"><span class="annot"><span class="annottext">wkr_inline_prag :: InlinePragma
</span><a href="#local-6989586621682745369"><span class="hs-identifier hs-var hs-var">wkr_inline_prag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="GHC.Types.Basic.html#defaultInlinePragma"><span class="hs-identifier hs-var">defaultInlinePragma</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#inl_rule"><span class="hs-identifier hs-var">inl_rule</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-613"></span><span>    </span><span id="local-6989586621682745368"><span class="annot"><span class="annottext">wkr_arity :: Int
</span><a href="#local-6989586621682745368"><span class="hs-identifier hs-var hs-var">wkr_arity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Int
</span><a href="GHC.Core.DataCon.html#dataConRepArity"><span class="hs-identifier hs-var">dataConRepArity</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745359"><span class="hs-identifier hs-var">data_con</span></a></span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span>    </span><span class="hs-comment">-- See Note [LFInfo of DataCon workers and wrappers]</span><span>
</span><span id="line-616"></span><span>    </span><span id="local-6989586621682745372"><span class="annot"><span class="annottext">wkr_lf_info :: LambdaFormInfo
</span><a href="#local-6989586621682745372"><span class="hs-identifier hs-var hs-var">wkr_lf_info</span></a></span></span><span>
</span><span id="line-617"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745368"><span class="hs-identifier hs-var">wkr_arity</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; LambdaFormInfo
</span><a href="GHC.StgToCmm.Types.html#LFCon"><span class="hs-identifier hs-var">LFCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745359"><span class="hs-identifier hs-var">data_con</span></a></span><span>
</span><span id="line-618"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TopLevelFlag -&gt; Int -&gt; Bool -&gt; ArgDescr -&gt; LambdaFormInfo
</span><a href="GHC.StgToCmm.Types.html#LFReEntrant"><span class="hs-identifier hs-var">LFReEntrant</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="GHC.Types.Basic.html#TopLevel"><span class="hs-identifier hs-var">TopLevel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Type -&gt; Int
</span><a href="GHC.Types.RepType.html#countFunRepArgs"><span class="hs-identifier hs-var">countFunRepArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745368"><span class="hs-identifier hs-var">wkr_arity</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745362"><span class="hs-identifier hs-var">wkr_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">ArgDescr
</span><a href="GHC.Runtime.Heap.Layout.html#ArgUnknown"><span class="hs-identifier hs-var">ArgUnknown</span></a></span><span>
</span><span id="line-619"></span><span>                                            </span><span class="hs-comment">-- LFInfo stores post-unarisation arity</span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span>    </span><span class="hs-comment">----------- Workers for newtypes --------------</span><span>
</span><span id="line-622"></span><span>    </span><span id="local-6989586621682745380"><span class="annot"><span class="annottext">univ_tvs :: [Id]
</span><a href="#local-6989586621682745380"><span class="hs-identifier hs-var hs-var">univ_tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [Id]
</span><a href="GHC.Core.DataCon.html#dataConUnivTyVars"><span class="hs-identifier hs-var">dataConUnivTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745359"><span class="hs-identifier hs-var">data_con</span></a></span><span>
</span><span id="line-623"></span><span>    </span><span id="local-6989586621682745381"><span class="annot"><span class="annottext">ex_tcvs :: [Id]
</span><a href="#local-6989586621682745381"><span class="hs-identifier hs-var hs-var">ex_tcvs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [Id]
</span><a href="GHC.Core.DataCon.html#dataConExTyCoVars"><span class="hs-identifier hs-var">dataConExTyCoVars</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745359"><span class="hs-identifier hs-var">data_con</span></a></span><span>
</span><span id="line-624"></span><span>    </span><span id="local-6989586621682745383"><span class="annot"><span class="annottext">arg_tys :: [Scaled Type]
</span><a href="#local-6989586621682745383"><span class="hs-identifier hs-var hs-var">arg_tys</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [Scaled Type]
</span><a href="GHC.Core.DataCon.html#dataConRepArgTys"><span class="hs-identifier hs-var">dataConRepArgTys</span></a></span><span>  </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745359"><span class="hs-identifier hs-var">data_con</span></a></span><span>  </span><span class="hs-comment">-- Should be same as dataConOrigArgTys</span><span>
</span><span id="line-625"></span><span>    </span><span id="local-6989586621682745363"><span class="annot"><span class="annottext">nt_work_info :: IdInfo
</span><a href="#local-6989586621682745363"><span class="hs-identifier hs-var hs-var">nt_work_info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span>          </span><span class="hs-comment">-- The NoCaf-ness is set by noCafIdInfo</span><span>
</span><span id="line-626"></span><span>                  </span><span class="annot"><span class="annottext">IdInfo -&gt; Int -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setArityInfo"><span class="hs-operator hs-var">`setArityInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>      </span><span class="hs-comment">-- Arity 1</span><span>
</span><span id="line-627"></span><span>                  </span><span class="annot"><span class="annottext">IdInfo -&gt; InlinePragma -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setInlinePragInfo"><span class="hs-operator hs-var">`setInlinePragInfo`</span></a></span><span>     </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="GHC.Types.Id.Make.html#dataConWrapperInlinePragma"><span class="hs-identifier hs-var">dataConWrapperInlinePragma</span></a></span><span>
</span><span id="line-628"></span><span>                  </span><span class="annot"><span class="annottext">IdInfo -&gt; Unfolding -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setUnfoldingInfo"><span class="hs-operator hs-var">`setUnfoldingInfo`</span></a></span><span>      </span><span class="annot"><span class="annottext">Unfolding
</span><a href="#local-6989586621682745385"><span class="hs-identifier hs-var">newtype_unf</span></a></span><span>
</span><span id="line-629"></span><span>                               </span><span class="hs-comment">-- See W1 in Note [LFInfo of DataCon workers and wrappers]</span><span>
</span><span id="line-630"></span><span>                  </span><span class="annot"><span class="annottext">IdInfo -&gt; LambdaFormInfo -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setLFInfo"><span class="hs-operator hs-var">`setLFInfo`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; LambdaFormInfo
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkDataConWorkId: we shouldn't look at LFInfo for newtype worker ids&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>    </span><span id="local-6989586621682745387"><span class="annot"><span class="annottext">id_arg1 :: Id
</span><a href="#local-6989586621682745387"><span class="hs-identifier hs-var hs-var">id_arg1</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Scaled Type -&gt; Id
</span><a href="GHC.Types.Id.html#mkScaledTemplateLocal"><span class="hs-identifier hs-var">mkScaledTemplateLocal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Scaled Type] -&gt; Scaled Type
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="GHC.Prelude.Basic.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682745383"><span class="hs-identifier hs-var">arg_tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-632"></span><span>    </span><span id="local-6989586621682745390"><span class="annot"><span class="annottext">res_ty_args :: [Type]
</span><a href="#local-6989586621682745390"><span class="hs-identifier hs-var hs-var">res_ty_args</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Rep.html#mkTyCoVarTys"><span class="hs-identifier hs-var">mkTyCoVarTys</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745380"><span class="hs-identifier hs-var">univ_tvs</span></a></span><span>
</span><span id="line-633"></span><span>    </span><span id="local-6989586621682745385"><span class="annot"><span class="annottext">newtype_unf :: Unfolding
</span><a href="#local-6989586621682745385"><span class="hs-identifier hs-var hs-var">newtype_unf</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; (CoreExpr -&gt; Unfolding) -&gt; CoreExpr -&gt; Unfolding
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745381"><span class="hs-identifier hs-var">ex_tcvs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[Scaled Type] -&gt; Bool
forall a. [a] -&gt; Bool
</span><a href="GHC.Utils.Misc.html#isSingleton"><span class="hs-identifier hs-var">isSingleton</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682745383"><span class="hs-identifier hs-var">arg_tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745359"><span class="hs-identifier hs-var">data_con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-635"></span><span>                              </span><span class="hs-comment">-- Note [Newtype datacons]</span><span>
</span><span id="line-636"></span><span>                   </span><span class="annot"><span class="annottext">CoreExpr -&gt; Unfolding
</span><a href="GHC.Core.Unfold.Make.html#mkCompulsoryUnfolding"><span class="hs-identifier hs-var">mkCompulsoryUnfolding</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Unfolding) -&gt; CoreExpr -&gt; Unfolding
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-637"></span><span>                   </span><span class="annot"><span class="annottext">[Id] -&gt; CoreExpr -&gt; CoreExpr
forall b. [b] -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745380"><span class="hs-identifier hs-var">univ_tvs</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr -&gt; CoreExpr
forall b. b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745387"><span class="hs-identifier hs-var">id_arg1</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-638"></span><span>                   </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Types.Id.Make.html#wrapNewTypeBody"><span class="hs-identifier hs-var">wrapNewTypeBody</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745360"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745390"><span class="hs-identifier hs-var">res_ty_args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745387"><span class="hs-identifier hs-var">id_arg1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span class="hs-comment">{-
Note [LFInfo of DataCon workers and wrappers]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
As noted in Note [The LFInfo of Imported Ids] in GHC.StgToCmm.Closure, it's
crucial that saturated data con applications are given an LFInfo of `LFCon`.

Since for data constructors we never serialise the worker and the wrapper (only
the data type declaration), we never serialise their lambda form info either.

Therefore, when making data constructors workers and wrappers, we construct a
correct `LFInfo` for them right away, and put it it in the `lfInfo` field of the
worker/wrapper Id, ensuring that:

  The `lfInfo` field of a DataCon worker or wrapper is always populated with the correct LFInfo.

How do we construct a /correct/ LFInfo for workers and wrappers?
(Remember: `LFCon` means &quot;a saturated constructor application&quot;)

(1) Data constructor workers and wrappers with arity &gt; 0 are unambiguously
functions and should be given `LFReEntrant`, regardless of the runtime
relevance of the arguments.
  - For example, `Just :: a -&gt; Maybe a` is given `LFReEntrant`,
             and `HNil :: (a ~# '[]) -&gt; HList a` is given `LFReEntrant` too.

(2) A datacon /worker/ with zero arity is trivially fully saturated -- it takes
no arguments whatsoever (not even zero-width args), so it is given `LFCon`.

(3) Perhaps surprisingly, a datacon /wrapper/ can be an `LFCon`. See Wrinkle (W1) below.
A datacon /wrapper/ with zero arity must be a fully saturated application of
the worker to zero-width arguments only (which are dropped after unarisation),
and therefore is also given `LFCon`.

For example, consider the following data constructors:

  data T1 a where
    TCon1 :: {-# UNPACK #-} !(a :~: True) -&gt; T1 a

  data T2 a where
    TCon2 :: {-# UNPACK #-} !() -&gt; T2 a

  data T3 a where
    TCon3 :: T3 '[]

`TCon1`'s wrapper has a lifted argument, which is non-zero-width, while the
worker has an unlifted equality argument, which is zero-width.

`TCon2`'s wrapper has a lifted argument, which is non-zero-width, while the
worker has no arguments.

Wrinkle (W1). Perhaps surprisingly, it is possible for the /wrapper/ to be an
`LFCon` even though the /worker/ is not. Consider `T3` above. Here is the
Core representation of the worker and wrapper:

  $WTCon3 :: T3 '[]             -- Wrapper
  $WTCon3 = TCon3 @[] &lt;Refl&gt;    -- A saturated constructor application: LFCon

  TCon3 :: forall (a :: * -&gt; *). (a ~# []) =&gt; T a   -- Worker
  TCon3 = /\a. \(co :: a~#[]). TCon3 co             -- A function: LFReEntrant

For `TCon1`, both the wrapper and worker will be given `LFReEntrant` since they
both have arity == 1.

For `TCon2`, the wrapper will be given `LFReEntrant` since it has arity == 1
while the worker is `LFCon` since its arity == 0

For `TCon3`, the wrapper will be given `LFCon` since its arity == 0 and the
worker `LFReEntrant` since its arity == 1

One might think we could give *workers* with only zero-width-args the `LFCon`
LambdaFormInfo, e.g. give `LFCon` to the worker of `TCon1` and `TCon3`.
However, these workers are unambiguously functions
-- which makes `LFReEntrant`, the LambdaFormInfo we give them, correct.
See also the discussion in #23158.

Wrinkles:

(W1) Why do we panic when generating `LFInfo` for newtype workers and wrappers?

  We don't generate code for newtype workers/wrappers, so we should never have to
  look at their LFInfo (and in general we can't; they may be representation-polymorphic).

See also the Note [Imported unlifted nullary datacon wrappers must have correct LFInfo]
in GHC.StgToCmm.Types.

-------------------------------------------------
--         Data constructor representation
--
-- This is where we decide how to wrap/unwrap the
-- constructor fields
--
--------------------------------------------------
-}</span><span>
</span><span id="line-732"></span><span>
</span><span id="line-733"></span><span class="hs-keyword">type</span><span> </span><span id="Unboxer"><span class="annot"><a href="GHC.Types.Id.Make.html#Unboxer"><span class="hs-identifier hs-var">Unboxer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-734"></span><span>  </span><span class="hs-comment">-- Unbox: bind rep vars by decomposing src var</span><span>
</span><span id="line-735"></span><span>
</span><span id="line-736"></span><span class="hs-keyword">data</span><span> </span><span id="Boxer"><span class="annot"><a href="GHC.Types.Id.Make.html#Boxer"><span class="hs-identifier hs-var">Boxer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UnitBox"><span class="annot"><a href="GHC.Types.Id.Make.html#UnitBox"><span class="hs-identifier hs-var">UnitBox</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Boxer"><span class="annot"><a href="GHC.Types.Id.Make.html#Boxer"><span class="hs-identifier hs-var">Boxer</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-737"></span><span>  </span><span class="hs-comment">-- Box:   build src arg using these rep vars</span><span>
</span><span id="line-738"></span><span>
</span><span id="line-739"></span><span class="annot"><span class="hs-comment">-- | Data Constructor Boxer</span></span><span>
</span><span id="line-740"></span><span class="hs-keyword">newtype</span><span> </span><span id="DataConBoxer"><span class="annot"><a href="GHC.Types.Id.Make.html#DataConBoxer"><span class="hs-identifier hs-var">DataConBoxer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DCB"><span class="annot"><a href="GHC.Types.Id.Make.html#DCB"><span class="hs-identifier hs-var">DCB</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreBind"><span class="hs-identifier hs-type">CoreBind</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-741"></span><span>                       </span><span class="hs-comment">-- Bind these src-level vars, returning the</span><span>
</span><span id="line-742"></span><span>                       </span><span class="hs-comment">-- rep-level vars to bind in the pattern</span><span>
</span><span id="line-743"></span><span>
</span><span id="line-744"></span><span class="annot"><a href="GHC.Types.Id.Make.html#vanillaDataConBoxer"><span class="hs-identifier hs-type">vanillaDataConBoxer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#DataConBoxer"><span class="hs-identifier hs-type">DataConBoxer</span></a></span><span>
</span><span id="line-745"></span><span class="hs-comment">-- No transformation on arguments needed</span><span>
</span><span id="line-746"></span><span id="vanillaDataConBoxer"><span class="annot"><span class="annottext">vanillaDataConBoxer :: DataConBoxer
</span><a href="GHC.Types.Id.Make.html#vanillaDataConBoxer"><span class="hs-identifier hs-var hs-var">vanillaDataConBoxer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; [Id] -&gt; UniqSM ([Id], [CoreBind])) -&gt; DataConBoxer
</span><a href="GHC.Types.Id.Make.html#DCB"><span class="hs-identifier hs-var">DCB</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682745403"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745403"><span class="hs-identifier hs-var">_tys</span></a></span></span><span> </span><span id="local-6989586621682745404"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745404"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([Id], [CoreBind]) -&gt; UniqSM ([Id], [CoreBind])
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745404"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-747"></span><span>
</span><span id="line-748"></span><span class="hs-comment">{-
Note [Inline partially-applied constructor wrappers]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

We allow the wrapper to inline when partially applied to avoid
boxing values unnecessarily. For example, consider

   data Foo a = Foo !Int a

   instance Traversable Foo where
     traverse f (Foo i a) = Foo i &lt;$&gt; f a

This desugars to

   traverse f foo = case foo of
        Foo i# a -&gt; let i = I# i#
                    in map ($WFoo i) (f a)

If the wrapper `$WFoo` is not inlined, we get a fruitless reboxing of `i`.
But if we inline the wrapper, we get

   map (\a. case i of I# i# a -&gt; Foo i# a) (f a)

and now case-of-known-constructor eliminates the redundant allocation.

-}</span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span class="hs-keyword">data</span><span> </span><span id="DataConBangOpts"><span class="annot"><a href="GHC.Types.Id.Make.html#DataConBangOpts"><span class="hs-identifier hs-var">DataConBangOpts</span></a></span></span><span>
</span><span id="line-776"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="FixedBangOpts"><span class="annot"><a href="GHC.Types.Id.Make.html#FixedBangOpts"><span class="hs-identifier hs-var">FixedBangOpts</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.DataCon.html#HsImplBang"><span class="hs-identifier hs-type">HsImplBang</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-777"></span><span>    </span><span class="hs-comment">-- ^ Used for imported data constructors</span><span>
</span><span id="line-778"></span><span>    </span><span class="hs-comment">-- See Note [Bangs on imported data constructors]</span><span>
</span><span id="line-779"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SrcBangOpts"><span class="annot"><a href="GHC.Types.Id.Make.html#SrcBangOpts"><span class="hs-identifier hs-var">SrcBangOpts</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Types.Id.Make.html#BangOpts"><span class="hs-identifier hs-type">BangOpts</span></a></span><span>
</span><span id="line-780"></span><span>
</span><span id="line-781"></span><span class="hs-keyword">data</span><span> </span><span id="BangOpts"><span class="annot"><a href="GHC.Types.Id.Make.html#BangOpts"><span class="hs-identifier hs-var">BangOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BangOpts"><span class="annot"><a href="GHC.Types.Id.Make.html#BangOpts"><span class="hs-identifier hs-var">BangOpts</span></a></span></span><span>
</span><span id="line-782"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="bang_opt_strict_data"><span class="annot"><span class="annottext">BangOpts -&gt; Bool
</span><a href="GHC.Types.Id.Make.html#bang_opt_strict_data"><span class="hs-identifier hs-var hs-var">bang_opt_strict_data</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Strict fields by default</span></span><span>
</span><span id="line-783"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="bang_opt_unbox_disable"><span class="annot"><span class="annottext">BangOpts -&gt; Bool
</span><a href="GHC.Types.Id.Make.html#bang_opt_unbox_disable"><span class="hs-identifier hs-var hs-var">bang_opt_unbox_disable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Disable automatic field unboxing (e.g. if we aren't optimising)</span></span><span>
</span><span id="line-784"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="bang_opt_unbox_strict"><span class="annot"><span class="annottext">BangOpts -&gt; Bool
</span><a href="GHC.Types.Id.Make.html#bang_opt_unbox_strict"><span class="hs-identifier hs-var hs-var">bang_opt_unbox_strict</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Unbox strict fields</span></span><span>
</span><span id="line-785"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="bang_opt_unbox_small"><span class="annot"><span class="annottext">BangOpts -&gt; Bool
</span><a href="GHC.Types.Id.Make.html#bang_opt_unbox_small"><span class="hs-identifier hs-var hs-var">bang_opt_unbox_small</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Unbox small strict fields</span></span><span>
</span><span id="line-786"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-787"></span><span>
</span><span id="line-788"></span><span class="annot"><a href="GHC.Types.Id.Make.html#mkDataConRep"><span class="hs-identifier hs-type">mkDataConRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#DataConBangOpts"><span class="hs-identifier hs-type">DataConBangOpts</span></a></span><span>
</span><span id="line-789"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a></span><span>
</span><span id="line-790"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-791"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span>
</span><span id="line-792"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataConRep"><span class="hs-identifier hs-type">DataConRep</span></a></span><span>
</span><span id="line-793"></span><span id="mkDataConRep"><span class="annot"><span class="annottext">mkDataConRep :: DataConBangOpts
-&gt; FamInstEnvs -&gt; Name -&gt; DataCon -&gt; UniqSM DataConRep
</span><a href="GHC.Types.Id.Make.html#mkDataConRep"><span class="hs-identifier hs-var hs-var">mkDataConRep</span></a></span></span><span> </span><span id="local-6989586621682745412"><span class="annot"><span class="annottext">DataConBangOpts
</span><a href="#local-6989586621682745412"><span class="hs-identifier hs-var">dc_bang_opts</span></a></span></span><span> </span><span id="local-6989586621682745413"><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621682745413"><span class="hs-identifier hs-var">fam_envs</span></a></span></span><span> </span><span id="local-6989586621682745414"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745414"><span class="hs-identifier hs-var">wrap_name</span></a></span></span><span> </span><span id="local-6989586621682745415"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745415"><span class="hs-identifier hs-var">data_con</span></a></span></span><span>
</span><span id="line-794"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682745417"><span class="hs-identifier hs-var">wrapper_reqd</span></a></span><span>
</span><span id="line-795"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataConRep -&gt; UniqSM DataConRep
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DataConRep
</span><a href="GHC.Core.DataCon.html#NoDataConRep"><span class="hs-identifier hs-var">NoDataConRep</span></a></span><span>
</span><span id="line-796"></span><span>
</span><span id="line-797"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-798"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682745419"><span class="annot"><a href="#local-6989586621682745419"><span class="hs-identifier hs-var">wrap_args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Scaled Type -&gt; UniqSM Id) -&gt; [Scaled Type] -&gt; UniqSM [Id]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleName -&gt; Scaled Type -&gt; UniqSM Id
</span><a href="GHC.Types.Id.Make.html#newLocal"><span class="hs-identifier hs-var">newLocal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;conrep&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682745422"><span class="hs-identifier hs-var">wrap_arg_tys</span></a></span><span>
</span><span id="line-799"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682745423"><span class="annot"><a href="#local-6989586621682745423"><span class="hs-identifier hs-var">wrap_body</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682745424"><span class="hs-identifier hs-type">mk_rep_app</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Misc.html#dropList"><span class="hs-identifier hs-type">dropList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745426"><span class="hs-identifier hs-type">stupid_theta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745419"><span class="hs-identifier hs-type">wrap_args</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`zip`</span></span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#dropList"><span class="hs-identifier hs-type">dropList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745427"><span class="hs-identifier hs-type">eq_spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745428"><span class="hs-identifier hs-type">unboxers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-800"></span><span>                                 </span><span class="annot"><a href="#local-6989586621682745429"><span class="hs-identifier hs-type">initial_wrap_app</span></a></span><span>
</span><span id="line-801"></span><span>                        </span><span class="hs-comment">-- Drop the stupid theta arguments, as per</span><span>
</span><span id="line-802"></span><span>                        </span><span class="hs-comment">-- Note [Instantiating stupid theta] in GHC.Core.DataCon.</span><span>
</span><span id="line-803"></span><span>
</span><span id="line-804"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682745430"><span class="annot"><a href="#local-6989586621682745430"><span class="hs-identifier hs-var hs-var">wrap_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdDetails -&gt; Name -&gt; Type -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.html#mkGlobalId"><span class="hs-identifier hs-var">mkGlobalId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; IdDetails
</span><a href="GHC.Types.Id.Info.html#DataConWrapId"><span class="hs-identifier hs-var">DataConWrapId</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745415"><span class="hs-identifier hs-var">data_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745414"><span class="hs-identifier hs-var">wrap_name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745431"><span class="hs-identifier hs-var">wrap_ty</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745432"><span class="hs-identifier hs-var">wrap_info</span></a></span><span>
</span><span id="line-805"></span><span>             </span><span id="local-6989586621682745432"><span class="annot"><a href="#local-6989586621682745432"><span class="hs-identifier hs-var hs-var">wrap_info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span>
</span><span id="line-806"></span><span>                         </span><span class="annot"><span class="annottext">IdInfo -&gt; Int -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setArityInfo"><span class="hs-operator hs-var">`setArityInfo`</span></a></span><span>         </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745433"><span class="hs-identifier hs-var">wrap_arity</span></a></span><span>
</span><span id="line-807"></span><span>                             </span><span class="hs-comment">-- It's important to specify the arity, so that partial</span><span>
</span><span id="line-808"></span><span>                             </span><span class="hs-comment">-- applications are treated as values</span><span>
</span><span id="line-809"></span><span>                         </span><span class="annot"><span class="annottext">IdInfo -&gt; InlinePragma -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setInlinePragInfo"><span class="hs-operator hs-var">`setInlinePragInfo`</span></a></span><span>    </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621682745434"><span class="hs-identifier hs-var">wrap_prag</span></a></span><span>
</span><span id="line-810"></span><span>                         </span><span class="annot"><span class="annottext">IdInfo -&gt; Unfolding -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setUnfoldingInfo"><span class="hs-operator hs-var">`setUnfoldingInfo`</span></a></span><span>     </span><span class="annot"><span class="annottext">Unfolding
</span><a href="#local-6989586621682745435"><span class="hs-identifier hs-var">wrap_unf</span></a></span><span>
</span><span id="line-811"></span><span>                         </span><span class="annot"><span class="annottext">IdInfo -&gt; DmdSig -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setDmdSigInfo"><span class="hs-operator hs-var">`setDmdSigInfo`</span></a></span><span>        </span><span class="annot"><span class="annottext">DmdSig
</span><a href="#local-6989586621682745436"><span class="hs-identifier hs-var">wrap_sig</span></a></span><span>
</span><span id="line-812"></span><span>                             </span><span class="hs-comment">-- We need to get the CAF info right here because GHC.Iface.Tidy</span><span>
</span><span id="line-813"></span><span>                             </span><span class="hs-comment">-- does not tidy the IdInfo of implicit bindings (like the wrapper)</span><span>
</span><span id="line-814"></span><span>                             </span><span class="hs-comment">-- so it not make sure that the CAF info is sane</span><span>
</span><span id="line-815"></span><span>                         </span><span class="annot"><span class="annottext">IdInfo -&gt; LambdaFormInfo -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setLFInfo"><span class="hs-operator hs-var">`setLFInfo`</span></a></span><span>            </span><span class="annot"><span class="annottext">LambdaFormInfo
</span><a href="#local-6989586621682745437"><span class="hs-identifier hs-var">wrap_lf_info</span></a></span><span>
</span><span id="line-816"></span><span>
</span><span id="line-817"></span><span>             </span><span class="hs-comment">-- The signature is purely for passes like the Simplifier, not for</span><span>
</span><span id="line-818"></span><span>             </span><span class="hs-comment">-- DmdAnal itself; see Note [DmdAnal for DataCon wrappers].</span><span>
</span><span id="line-819"></span><span>             </span><span id="local-6989586621682745436"><span class="annot"><a href="#local-6989586621682745436"><span class="hs-identifier hs-var hs-var">wrap_sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Demand] -&gt; Divergence -&gt; DmdSig
</span><a href="GHC.Types.Demand.html#mkClosedDmdSig"><span class="hs-identifier hs-var">mkClosedDmdSig</span></a></span><span> </span><span class="annot"><span class="annottext">[Demand]
</span><a href="#local-6989586621682745438"><span class="hs-identifier hs-var">wrap_arg_dmds</span></a></span><span> </span><span class="annot"><span class="annottext">Divergence
</span><a href="GHC.Types.Demand.html#topDiv"><span class="hs-identifier hs-var">topDiv</span></a></span><span>
</span><span id="line-820"></span><span>
</span><span id="line-821"></span><span>             </span><span class="hs-comment">-- See Note [LFInfo of DataCon workers and wrappers]</span><span>
</span><span id="line-822"></span><span>             </span><span id="local-6989586621682745437"><span class="annot"><a href="#local-6989586621682745437"><span class="hs-identifier hs-var hs-var">wrap_lf_info</span></a></span></span><span>
</span><span id="line-823"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745433"><span class="hs-identifier hs-var">wrap_arity</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; LambdaFormInfo
</span><a href="GHC.StgToCmm.Types.html#LFCon"><span class="hs-identifier hs-var">LFCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745415"><span class="hs-identifier hs-var">data_con</span></a></span><span>
</span><span id="line-824"></span><span>               </span><span class="hs-comment">-- See W1 in Note [LFInfo of DataCon workers and wrappers]</span><span>
</span><span id="line-825"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745439"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; LambdaFormInfo
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkDataConRep: we shouldn't look at LFInfo for newtype wrapper ids&quot;</span></span><span>
</span><span id="line-826"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TopLevelFlag -&gt; Int -&gt; Bool -&gt; ArgDescr -&gt; LambdaFormInfo
</span><a href="GHC.StgToCmm.Types.html#LFReEntrant"><span class="hs-identifier hs-var">LFReEntrant</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="GHC.Types.Basic.html#TopLevel"><span class="hs-identifier hs-var">TopLevel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Type -&gt; Int
</span><a href="GHC.Types.RepType.html#countFunRepArgs"><span class="hs-identifier hs-var">countFunRepArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745433"><span class="hs-identifier hs-var">wrap_arity</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745431"><span class="hs-identifier hs-var">wrap_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">ArgDescr
</span><a href="GHC.Runtime.Heap.Layout.html#ArgUnknown"><span class="hs-identifier hs-var">ArgUnknown</span></a></span><span>
</span><span id="line-827"></span><span>                                                      </span><span class="hs-comment">-- LFInfo stores post-unarisation arity</span><span>
</span><span id="line-828"></span><span>
</span><span id="line-829"></span><span>             </span><span id="local-6989586621682745438"><span class="annot"><a href="#local-6989586621682745438"><span class="hs-identifier hs-var hs-var">wrap_arg_dmds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-830"></span><span>               </span><span class="annot"><span class="annottext">Int -&gt; Demand -&gt; [Demand]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745441"><span class="hs-identifier hs-var">theta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Demand
</span><a href="GHC.Types.Demand.html#topDmd"><span class="hs-identifier hs-var">topDmd</span></a></span><span> </span><span class="annot"><span class="annottext">[Demand] -&gt; [Demand] -&gt; [Demand]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(HsImplBang -&gt; Demand) -&gt; [HsImplBang] -&gt; [Demand]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">HsImplBang -&gt; Demand
</span><a href="#local-6989586621682745443"><span class="hs-identifier hs-var">mk_dmd</span></a></span><span> </span><span class="annot"><span class="annottext">[HsImplBang]
</span><a href="#local-6989586621682745444"><span class="hs-identifier hs-var">arg_ibangs</span></a></span><span>
</span><span id="line-831"></span><span>               </span><span class="hs-comment">-- Don't forget the dictionary arguments when building</span><span>
</span><span id="line-832"></span><span>               </span><span class="hs-comment">-- the strictness signature (#14290).</span><span>
</span><span id="line-833"></span><span>
</span><span id="line-834"></span><span>             </span><span id="local-6989586621682745443"><span class="annot"><a href="#local-6989586621682745443"><span class="hs-identifier hs-var hs-var">mk_dmd</span></a></span></span><span> </span><span id="local-6989586621682745445"><span class="annot"><span class="annottext">HsImplBang
</span><a href="#local-6989586621682745445"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HsImplBang -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isBanged"><span class="hs-identifier hs-var">isBanged</span></a></span><span> </span><span class="annot"><span class="annottext">HsImplBang
</span><a href="#local-6989586621682745445"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Demand
</span><a href="GHC.Types.Demand.html#evalDmd"><span class="hs-identifier hs-var">evalDmd</span></a></span><span>
</span><span id="line-835"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Demand
</span><a href="GHC.Types.Demand.html#topDmd"><span class="hs-identifier hs-var">topDmd</span></a></span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span>             </span><span id="local-6989586621682745434"><span class="annot"><a href="#local-6989586621682745434"><span class="hs-identifier hs-var hs-var">wrap_prag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="GHC.Types.Id.Make.html#dataConWrapperInlinePragma"><span class="hs-identifier hs-var">dataConWrapperInlinePragma</span></a></span><span>
</span><span id="line-838"></span><span>                         </span><span class="annot"><span class="annottext">InlinePragma -&gt; Activation -&gt; InlinePragma
</span><a href="GHC.Types.Basic.html#setInlinePragmaActivation"><span class="hs-operator hs-var">`setInlinePragmaActivation`</span></a></span><span> </span><span class="annot"><span class="annottext">Activation
</span><a href="GHC.Types.Basic.html#activateDuringFinal"><span class="hs-identifier hs-var">activateDuringFinal</span></a></span><span>
</span><span id="line-839"></span><span>                         </span><span class="hs-comment">-- See Note [Activation for data constructor wrappers]</span><span>
</span><span id="line-840"></span><span>
</span><span id="line-841"></span><span>             </span><span class="hs-comment">-- The wrapper will usually be inlined (see wrap_unf), so its</span><span>
</span><span id="line-842"></span><span>             </span><span class="hs-comment">-- strictness and CPR info is usually irrelevant. But this is</span><span>
</span><span id="line-843"></span><span>             </span><span class="hs-comment">-- not always the case; GHC may choose not to inline it. In</span><span>
</span><span id="line-844"></span><span>             </span><span class="hs-comment">-- particular, the wrapper constructor is not inlined inside</span><span>
</span><span id="line-845"></span><span>             </span><span class="hs-comment">-- an INLINE rhs or when it is not applied to any arguments.</span><span>
</span><span id="line-846"></span><span>             </span><span class="hs-comment">-- See Note [Inline partially-applied constructor wrappers]</span><span>
</span><span id="line-847"></span><span>             </span><span class="hs-comment">-- Passing Nothing here allows the wrapper to inline when</span><span>
</span><span id="line-848"></span><span>             </span><span class="hs-comment">-- unsaturated.</span><span>
</span><span id="line-849"></span><span>             </span><span id="local-6989586621682745435"><span class="annot"><a href="#local-6989586621682745435"><span class="hs-identifier hs-var hs-var">wrap_unf</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745439"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Unfolding
</span><a href="GHC.Core.Unfold.Make.html#mkCompulsoryUnfolding"><span class="hs-identifier hs-var">mkCompulsoryUnfolding</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745449"><span class="hs-identifier hs-var">wrap_rhs</span></a></span><span>
</span><span id="line-850"></span><span>                        </span><span class="hs-comment">-- See Note [Compulsory newtype unfolding]</span><span>
</span><span id="line-851"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Unfolding
</span><a href="GHC.Core.Unfold.Make.html#mkDataConUnfolding"><span class="hs-identifier hs-var">mkDataConUnfolding</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745449"><span class="hs-identifier hs-var">wrap_rhs</span></a></span><span>
</span><span id="line-852"></span><span>             </span><span id="local-6989586621682745449"><span class="annot"><a href="#local-6989586621682745449"><span class="hs-identifier hs-var hs-var">wrap_rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; CoreExpr -&gt; CoreExpr
forall b. [b] -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745451"><span class="hs-identifier hs-var">wrap_tvs</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-853"></span><span>                        </span><span class="annot"><span class="annottext">[Id] -&gt; CoreExpr -&gt; CoreExpr
forall b. [b] -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745419"><span class="hs-identifier hs-var">wrap_args</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-854"></span><span>                        </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Types.Id.Make.html#wrapFamInstBody"><span class="hs-identifier hs-var">wrapFamInstBody</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745439"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745452"><span class="hs-identifier hs-var">res_ty_args</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-855"></span><span>                        </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745423"><span class="hs-identifier hs-var">wrap_body</span></a></span><span>
</span><span id="line-856"></span><span>
</span><span id="line-857"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.DataCon.html#DCR"><span class="hs-identifier hs-type">DCR</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#dcr_wrap_id"><span class="hs-identifier hs-var">dcr_wrap_id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682745430"><span class="hs-identifier hs-type">wrap_id</span></a></span><span>
</span><span id="line-858"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#dcr_boxer"><span class="hs-identifier hs-var">dcr_boxer</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682745456"><span class="hs-identifier hs-type">mk_boxer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745457"><span class="hs-identifier hs-type">boxers</span></a></span><span>
</span><span id="line-859"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#dcr_arg_tys"><span class="hs-identifier hs-var">dcr_arg_tys</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682745459"><span class="hs-identifier hs-type">rep_tys</span></a></span><span>
</span><span id="line-860"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#dcr_stricts"><span class="hs-identifier hs-var">dcr_stricts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682745461"><span class="hs-identifier hs-type">rep_strs</span></a></span><span>
</span><span id="line-861"></span><span>                       </span><span class="hs-comment">-- For newtypes, dcr_bangs is always [HsLazy].</span><span>
</span><span id="line-862"></span><span>                       </span><span class="hs-comment">-- See Note [HsImplBangs for newtypes].</span><span>
</span><span id="line-863"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#dcr_bangs"><span class="hs-identifier hs-var">dcr_bangs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682745444"><span class="hs-identifier hs-type">arg_ibangs</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-864"></span><span>
</span><span id="line-865"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-866"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682745463"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745463"><span class="hs-identifier hs-var">univ_tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745464"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745464"><span class="hs-identifier hs-var">ex_tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745427"><span class="annot"><span class="annottext">[EqSpec]
</span><a href="#local-6989586621682745427"><span class="hs-identifier hs-var">eq_spec</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745441"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745441"><span class="hs-identifier hs-var">theta</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745465"><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682745465"><span class="hs-identifier hs-var">orig_arg_tys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745466"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745466"><span class="hs-identifier hs-var">_orig_res_ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-867"></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; ([Id], [Id], [EqSpec], [Type], [Scaled Type], Type)
</span><a href="GHC.Core.DataCon.html#dataConFullSig"><span class="hs-identifier hs-var">dataConFullSig</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745415"><span class="hs-identifier hs-var">data_con</span></a></span><span>
</span><span id="line-868"></span><span>    </span><span id="local-6989586621682745426"><span class="annot"><span class="annottext">stupid_theta :: [Type]
</span><a href="#local-6989586621682745426"><span class="hs-identifier hs-var hs-var">stupid_theta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [Type]
</span><a href="GHC.Core.DataCon.html#dataConStupidTheta"><span class="hs-identifier hs-var">dataConStupidTheta</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745415"><span class="hs-identifier hs-var">data_con</span></a></span><span>
</span><span id="line-869"></span><span>    </span><span id="local-6989586621682745451"><span class="annot"><span class="annottext">wrap_tvs :: [Id]
</span><a href="#local-6989586621682745451"><span class="hs-identifier hs-var hs-var">wrap_tvs</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [Id]
</span><a href="GHC.Core.DataCon.html#dataConUserTyVars"><span class="hs-identifier hs-var">dataConUserTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745415"><span class="hs-identifier hs-var">data_con</span></a></span><span>
</span><span id="line-870"></span><span>    </span><span id="local-6989586621682745452"><span class="annot"><span class="annottext">res_ty_args :: [Type]
</span><a href="#local-6989586621682745452"><span class="hs-identifier hs-var hs-var">res_ty_args</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [Type]
</span><a href="GHC.Core.DataCon.html#dataConResRepTyArgs"><span class="hs-identifier hs-var">dataConResRepTyArgs</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745415"><span class="hs-identifier hs-var">data_con</span></a></span><span>
</span><span id="line-871"></span><span>
</span><span id="line-872"></span><span>    </span><span id="local-6989586621682745439"><span class="annot"><span class="annottext">tycon :: TyCon
</span><a href="#local-6989586621682745439"><span class="hs-identifier hs-var hs-var">tycon</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; TyCon
</span><a href="GHC.Core.DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745415"><span class="hs-identifier hs-var">data_con</span></a></span><span>       </span><span class="hs-comment">-- The representation TyCon (not family)</span><span>
</span><span id="line-873"></span><span>    </span><span id="local-6989586621682745431"><span class="annot"><span class="annottext">wrap_ty :: Type
</span><a href="#local-6989586621682745431"><span class="hs-identifier hs-var hs-var">wrap_ty</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Type
</span><a href="GHC.Core.DataCon.html#dataConWrapperType"><span class="hs-identifier hs-var">dataConWrapperType</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745415"><span class="hs-identifier hs-var">data_con</span></a></span><span>
</span><span id="line-874"></span><span>    </span><span id="local-6989586621682745472"><span class="annot"><span class="annottext">ev_tys :: [Type]
</span><a href="#local-6989586621682745472"><span class="hs-identifier hs-var hs-var">ev_tys</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[EqSpec] -&gt; [Type]
</span><a href="GHC.Core.DataCon.html#eqSpecPreds"><span class="hs-identifier hs-var">eqSpecPreds</span></a></span><span> </span><span class="annot"><span class="annottext">[EqSpec]
</span><a href="#local-6989586621682745427"><span class="hs-identifier hs-var">eq_spec</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745441"><span class="hs-identifier hs-var">theta</span></a></span><span>
</span><span id="line-875"></span><span>    </span><span id="local-6989586621682745474"><span class="annot"><span class="annottext">all_arg_tys :: [Scaled Type]
</span><a href="#local-6989586621682745474"><span class="hs-identifier hs-var hs-var">all_arg_tys</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Scaled Type) -&gt; [Type] -&gt; [Scaled Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Scaled Type
forall a. a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#unrestricted"><span class="hs-identifier hs-var">unrestricted</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745472"><span class="hs-identifier hs-var">ev_tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled Type] -&gt; [Scaled Type] -&gt; [Scaled Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682745465"><span class="hs-identifier hs-var">orig_arg_tys</span></a></span><span>
</span><span id="line-876"></span><span>    </span><span id="local-6989586621682745476"><span class="annot"><span class="annottext">ev_ibangs :: [HsImplBang]
</span><a href="#local-6989586621682745476"><span class="hs-identifier hs-var hs-var">ev_ibangs</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; HsImplBang) -&gt; [Type] -&gt; [HsImplBang]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsImplBang -&gt; Type -&gt; HsImplBang
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">HsImplBang
</span><a href="GHC.Core.DataCon.html#HsLazy"><span class="hs-identifier hs-var">HsLazy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745472"><span class="hs-identifier hs-var">ev_tys</span></a></span><span>
</span><span id="line-877"></span><span>    </span><span id="local-6989586621682745479"><span class="annot"><span class="annottext">orig_bangs :: [HsSrcBang]
</span><a href="#local-6989586621682745479"><span class="hs-identifier hs-var hs-var">orig_bangs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [HsSrcBang]
</span><a href="GHC.Core.DataCon.html#dataConSrcBangs"><span class="hs-identifier hs-var">dataConSrcBangs</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745415"><span class="hs-identifier hs-var">data_con</span></a></span><span>
</span><span id="line-878"></span><span>
</span><span id="line-879"></span><span>    </span><span id="local-6989586621682745422"><span class="annot"><span class="annottext">wrap_arg_tys :: [Scaled Type]
</span><a href="#local-6989586621682745422"><span class="hs-identifier hs-var hs-var">wrap_arg_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Scaled Type) -&gt; [Type] -&gt; [Scaled Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Scaled Type
forall a. a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#unrestricted"><span class="hs-identifier hs-var">unrestricted</span></a></span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; [Scaled Type]) -&gt; [Type] -&gt; [Scaled Type]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745426"><span class="hs-identifier hs-var">stupid_theta</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745441"><span class="hs-identifier hs-var">theta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Scaled Type] -&gt; [Scaled Type] -&gt; [Scaled Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682745465"><span class="hs-identifier hs-var">orig_arg_tys</span></a></span><span>
</span><span id="line-880"></span><span>    </span><span id="local-6989586621682745433"><span class="annot"><span class="annottext">wrap_arity :: Int
</span><a href="#local-6989586621682745433"><span class="hs-identifier hs-var hs-var">wrap_arity</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Id -&gt; Bool) -&gt; [Id] -&gt; Int
forall a. (a -&gt; Bool) -&gt; [a] -&gt; Int
</span><a href="GHC.Utils.Misc.html#count"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Types.Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745464"><span class="hs-identifier hs-var">ex_tvs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">[Scaled Type] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682745422"><span class="hs-identifier hs-var">wrap_arg_tys</span></a></span><span>
</span><span id="line-881"></span><span>             </span><span class="hs-comment">-- The wrap_args are the arguments *other than* the eq_spec</span><span>
</span><span id="line-882"></span><span>             </span><span class="hs-comment">-- Because we are going to apply the eq_spec args manually in the</span><span>
</span><span id="line-883"></span><span>             </span><span class="hs-comment">-- wrapper</span><span>
</span><span id="line-884"></span><span>
</span><span id="line-885"></span><span>    </span><span id="local-6989586621682745483"><span class="annot"><span class="annottext">new_tycon :: Bool
</span><a href="#local-6989586621682745483"><span class="hs-identifier hs-var hs-var">new_tycon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745439"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-886"></span><span>    </span><span id="local-6989586621682745444"><span class="annot"><span class="annottext">arg_ibangs :: [HsImplBang]
</span><a href="#local-6989586621682745444"><span class="hs-identifier hs-var hs-var">arg_ibangs</span></a></span></span><span>
</span><span id="line-887"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682745483"><span class="hs-identifier hs-var">new_tycon</span></a></span><span>
</span><span id="line-888"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Scaled Type -&gt; HsImplBang) -&gt; [Scaled Type] -&gt; [HsImplBang]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsImplBang -&gt; Scaled Type -&gt; HsImplBang
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">HsImplBang
</span><a href="GHC.Core.DataCon.html#HsLazy"><span class="hs-identifier hs-var">HsLazy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682745465"><span class="hs-identifier hs-var">orig_arg_tys</span></a></span><span> </span><span class="hs-comment">-- See Note [HsImplBangs for newtypes]</span><span>
</span><span id="line-889"></span><span>                                        </span><span class="hs-comment">-- orig_arg_tys should be a singleton, but</span><span>
</span><span id="line-890"></span><span>                                        </span><span class="hs-comment">-- if a user declared a wrong newtype we</span><span>
</span><span id="line-891"></span><span>                                        </span><span class="hs-comment">-- detect this later (see test T2334A)</span><span>
</span><span id="line-892"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-893"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DataConBangOpts
</span><a href="#local-6989586621682745412"><span class="hs-identifier hs-var">dc_bang_opts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-894"></span><span>          </span><span class="annot"><a href="GHC.Types.Id.Make.html#SrcBangOpts"><span class="hs-identifier hs-type">SrcBangOpts</span></a></span><span> </span><span id="local-6989586621682745484"><span class="annot"><span class="annottext">BangOpts
</span><a href="#local-6989586621682745484"><span class="hs-identifier hs-var">bang_opts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Scaled Type -&gt; HsSrcBang -&gt; HsImplBang)
-&gt; [Scaled Type] -&gt; [HsSrcBang] -&gt; [HsImplBang]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BangOpts -&gt; FamInstEnvs -&gt; Scaled Type -&gt; HsSrcBang -&gt; HsImplBang
</span><a href="GHC.Types.Id.Make.html#dataConSrcToImplBang"><span class="hs-identifier hs-var">dataConSrcToImplBang</span></a></span><span> </span><span class="annot"><span class="annottext">BangOpts
</span><a href="#local-6989586621682745484"><span class="hs-identifier hs-var">bang_opts</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621682745413"><span class="hs-identifier hs-var">fam_envs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-895"></span><span>                                    </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682745465"><span class="hs-identifier hs-var">orig_arg_tys</span></a></span><span> </span><span class="annot"><span class="annottext">[HsSrcBang]
</span><a href="#local-6989586621682745479"><span class="hs-identifier hs-var">orig_bangs</span></a></span><span>
</span><span id="line-896"></span><span>          </span><span class="annot"><a href="GHC.Types.Id.Make.html#FixedBangOpts"><span class="hs-identifier hs-type">FixedBangOpts</span></a></span><span> </span><span id="local-6989586621682745487"><span class="annot"><span class="annottext">[HsImplBang]
</span><a href="#local-6989586621682745487"><span class="hs-identifier hs-var">bangs</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[HsImplBang]
</span><a href="#local-6989586621682745487"><span class="hs-identifier hs-var">bangs</span></a></span><span>
</span><span id="line-897"></span><span>
</span><span id="line-898"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682745488"><span class="annot"><span class="annottext">[[(Scaled Type, StrictnessMark)]]
</span><a href="#local-6989586621682745488"><span class="hs-identifier hs-var">rep_tys_w_strs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745489"><span class="annot"><span class="annottext">[(Unboxer, Boxer)]
</span><a href="#local-6989586621682745489"><span class="hs-identifier hs-var">wrappers</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-899"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))]
-&gt; ([[(Scaled Type, StrictnessMark)]], [(Unboxer, Boxer)])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Scaled Type
 -&gt; HsImplBang
 -&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer)))
-&gt; [Scaled Type]
-&gt; [HsImplBang]
-&gt; [([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Scaled Type
-&gt; HsImplBang
-&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
</span><a href="GHC.Types.Id.Make.html#dataConArgRep"><span class="hs-identifier hs-var">dataConArgRep</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682745474"><span class="hs-identifier hs-var">all_arg_tys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[HsImplBang]
</span><a href="#local-6989586621682745476"><span class="hs-identifier hs-var">ev_ibangs</span></a></span><span> </span><span class="annot"><span class="annottext">[HsImplBang] -&gt; [HsImplBang] -&gt; [HsImplBang]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[HsImplBang]
</span><a href="#local-6989586621682745444"><span class="hs-identifier hs-var">arg_ibangs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-900"></span><span>
</span><span id="line-901"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682745428"><span class="annot"><span class="annottext">[Unboxer]
</span><a href="#local-6989586621682745428"><span class="hs-identifier hs-var">unboxers</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745457"><span class="annot"><span class="annottext">[Boxer]
</span><a href="#local-6989586621682745457"><span class="hs-identifier hs-var">boxers</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Unboxer, Boxer)] -&gt; ([Unboxer], [Boxer])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">[(Unboxer, Boxer)]
</span><a href="#local-6989586621682745489"><span class="hs-identifier hs-var">wrappers</span></a></span><span>
</span><span id="line-902"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682745459"><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682745459"><span class="hs-identifier hs-var">rep_tys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745461"><span class="annot"><span class="annottext">[StrictnessMark]
</span><a href="#local-6989586621682745461"><span class="hs-identifier hs-var">rep_strs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Scaled Type, StrictnessMark)]
-&gt; ([Scaled Type], [StrictnessMark])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[(Scaled Type, StrictnessMark)]]
-&gt; [(Scaled Type, StrictnessMark)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[(Scaled Type, StrictnessMark)]]
</span><a href="#local-6989586621682745488"><span class="hs-identifier hs-var">rep_tys_w_strs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-903"></span><span>
</span><span id="line-904"></span><span>    </span><span class="hs-comment">-- This is True if the data constructor or class dictionary constructor</span><span>
</span><span id="line-905"></span><span>    </span><span class="hs-comment">-- needs a wrapper. This wrapper is injected into the program later in the</span><span>
</span><span id="line-906"></span><span>    </span><span class="hs-comment">-- CoreTidy pass. See Note [Injecting implicit bindings] in GHC.Iface.Tidy,</span><span>
</span><span id="line-907"></span><span>    </span><span class="hs-comment">-- along with the accompanying implementation in getTyConImplicitBinds.</span><span>
</span><span id="line-908"></span><span>    </span><span id="local-6989586621682745417"><span class="annot"><span class="annottext">wrapper_reqd :: Bool
</span><a href="#local-6989586621682745417"><span class="hs-identifier hs-var hs-var">wrapper_reqd</span></a></span></span><span>
</span><span id="line-909"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTypeDataTyCon"><span class="hs-identifier hs-var">isTypeDataTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745439"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-910"></span><span>        </span><span class="hs-comment">-- `type data` declarations never have data-constructor wrappers</span><span>
</span><span id="line-911"></span><span>        </span><span class="hs-comment">-- Their data constructors only live at the type level, in the</span><span>
</span><span id="line-912"></span><span>        </span><span class="hs-comment">-- form of PromotedDataCon, and therefore do not need wrappers.</span><span>
</span><span id="line-913"></span><span>        </span><span class="hs-comment">-- See wrinkle (W0) in Note [Type data declarations] in GHC.Rename.Module.</span><span>
</span><span id="line-914"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-915"></span><span>
</span><span id="line-916"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-917"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682745483"><span class="hs-identifier hs-var">new_tycon</span></a></span><span>
</span><span id="line-918"></span><span>                     </span><span class="hs-comment">-- (Most) newtypes have only a worker, with the exception</span><span>
</span><span id="line-919"></span><span>                     </span><span class="hs-comment">-- of some newtypes written with GADT syntax.</span><span>
</span><span id="line-920"></span><span>                     </span><span class="hs-comment">-- See dataConUserTyVarsNeedWrapper below.</span><span>
</span><span id="line-921"></span><span>         </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(HsImplBang -&gt; Bool) -&gt; [HsImplBang] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">HsImplBang -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isBanged"><span class="hs-identifier hs-var">isBanged</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[HsImplBang]
</span><a href="#local-6989586621682745476"><span class="hs-identifier hs-var">ev_ibangs</span></a></span><span> </span><span class="annot"><span class="annottext">[HsImplBang] -&gt; [HsImplBang] -&gt; [HsImplBang]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[HsImplBang]
</span><a href="#local-6989586621682745444"><span class="hs-identifier hs-var">arg_ibangs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-922"></span><span>                     </span><span class="hs-comment">-- Some forcing/unboxing (includes eq_spec)</span><span>
</span><span id="line-923"></span><span>
</span><span id="line-924"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isFamInstTyCon"><span class="hs-identifier hs-var">isFamInstTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745439"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="hs-comment">-- Cast result</span><span>
</span><span id="line-925"></span><span>
</span><span id="line-926"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="GHC.Core.DataCon.html#dataConUserTyVarsNeedWrapper"><span class="hs-identifier hs-var">dataConUserTyVarsNeedWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745415"><span class="hs-identifier hs-var">data_con</span></a></span><span>
</span><span id="line-927"></span><span>                     </span><span class="hs-comment">-- If the data type was written with GADT syntax and</span><span>
</span><span id="line-928"></span><span>                     </span><span class="hs-comment">-- orders the type variables differently from what the</span><span>
</span><span id="line-929"></span><span>                     </span><span class="hs-comment">-- worker expects, it needs a data con wrapper to reorder</span><span>
</span><span id="line-930"></span><span>                     </span><span class="hs-comment">-- the type variables.</span><span>
</span><span id="line-931"></span><span>                     </span><span class="hs-comment">-- See Note [Data con wrappers and GADT syntax].</span><span>
</span><span id="line-932"></span><span>                     </span><span class="hs-comment">--</span><span>
</span><span id="line-933"></span><span>                     </span><span class="hs-comment">-- NB: All GADTs return true from this function, but there</span><span>
</span><span id="line-934"></span><span>                     </span><span class="hs-comment">-- is one exception that we must check below.</span><span>
</span><span id="line-935"></span><span>
</span><span id="line-936"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745426"><span class="hs-identifier hs-var">stupid_theta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-937"></span><span>                     </span><span class="hs-comment">-- If the data constructor has a datatype context,</span><span>
</span><span id="line-938"></span><span>                     </span><span class="hs-comment">-- we need a wrapper in order to drop the stupid arguments.</span><span>
</span><span id="line-939"></span><span>                     </span><span class="hs-comment">-- See Note [Instantiating stupid theta] in GHC.Core.DataCon.</span><span>
</span><span id="line-940"></span><span>
</span><span id="line-941"></span><span>    </span><span id="local-6989586621682745429"><span class="annot"><span class="annottext">initial_wrap_app :: CoreExpr
</span><a href="#local-6989586621682745429"><span class="hs-identifier hs-var hs-var">initial_wrap_app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; Id
</span><a href="GHC.Core.DataCon.html#dataConWorkId"><span class="hs-identifier hs-var">dataConWorkId</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745415"><span class="hs-identifier hs-var">data_con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-942"></span><span>                       </span><span class="annot"><span class="annottext">CoreExpr -&gt; [Type] -&gt; CoreExpr
forall b. Expr b -&gt; [Type] -&gt; Expr b
</span><a href="GHC.Core.html#mkTyApps"><span class="hs-operator hs-var">`mkTyApps`</span></a></span><span>  </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745452"><span class="hs-identifier hs-var">res_ty_args</span></a></span><span>
</span><span id="line-943"></span><span>                       </span><span class="annot"><span class="annottext">CoreExpr -&gt; [Id] -&gt; CoreExpr
forall b. Expr b -&gt; [Id] -&gt; Expr b
</span><a href="GHC.Core.html#mkVarApps"><span class="hs-operator hs-var">`mkVarApps`</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745464"><span class="hs-identifier hs-var">ex_tvs</span></a></span><span>
</span><span id="line-944"></span><span>                       </span><span class="annot"><span class="annottext">CoreExpr -&gt; [Coercion] -&gt; CoreExpr
forall b. Expr b -&gt; [Coercion] -&gt; Expr b
</span><a href="GHC.Core.html#mkCoApps"><span class="hs-operator hs-var">`mkCoApps`</span></a></span><span>  </span><span class="annot"><span class="annottext">(EqSpec -&gt; Coercion) -&gt; [EqSpec] -&gt; [Coercion]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role -&gt; Type -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkReflCo"><span class="hs-identifier hs-var">mkReflCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Coercion) -&gt; (EqSpec -&gt; Type) -&gt; EqSpec -&gt; Coercion
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">EqSpec -&gt; Type
</span><a href="GHC.Core.DataCon.html#eqSpecType"><span class="hs-identifier hs-var">eqSpecType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[EqSpec]
</span><a href="#local-6989586621682745427"><span class="hs-identifier hs-var">eq_spec</span></a></span><span>
</span><span id="line-945"></span><span>
</span><span id="line-946"></span><span>    </span><span class="annot"><a href="#local-6989586621682745456"><span class="hs-identifier hs-type">mk_boxer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Id.Make.html#Boxer"><span class="hs-identifier hs-type">Boxer</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#DataConBoxer"><span class="hs-identifier hs-type">DataConBoxer</span></a></span><span>
</span><span id="line-947"></span><span>    </span><span id="local-6989586621682745456"><span class="annot"><span class="annottext">mk_boxer :: [Boxer] -&gt; DataConBoxer
</span><a href="#local-6989586621682745456"><span class="hs-identifier hs-var hs-var">mk_boxer</span></a></span></span><span> </span><span id="local-6989586621682745505"><span class="annot"><span class="annottext">[Boxer]
</span><a href="#local-6989586621682745505"><span class="hs-identifier hs-var">boxers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; [Id] -&gt; UniqSM ([Id], [CoreBind])) -&gt; DataConBoxer
</span><a href="GHC.Types.Id.Make.html#DCB"><span class="hs-identifier hs-var">DCB</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682745506"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745506"><span class="hs-identifier hs-var">ty_args</span></a></span></span><span> </span><span id="local-6989586621682745507"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745507"><span class="hs-identifier hs-var">src_vars</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-948"></span><span>                      </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682745508"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745508"><span class="hs-identifier hs-var hs-var">ex_vars</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745509"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745509"><span class="hs-identifier hs-var hs-var">term_vars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; [Id] -&gt; ([Id], [Id])
forall b a. [b] -&gt; [a] -&gt; ([a], [a])
</span><a href="GHC.Utils.Misc.html#splitAtList"><span class="hs-identifier hs-var">splitAtList</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745464"><span class="hs-identifier hs-var">ex_tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745507"><span class="hs-identifier hs-var">src_vars</span></a></span><span>
</span><span id="line-949"></span><span>                               </span><span id="local-6989586621682745511"><span class="annot"><span class="annottext">subst1 :: Subst
</span><a href="#local-6989586621682745511"><span class="hs-identifier hs-var hs-var hs-var">subst1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; [Type] -&gt; Subst
HasDebugCallStack =&gt; [Id] -&gt; [Type] -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#zipTvSubst"><span class="hs-identifier hs-var">zipTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745463"><span class="hs-identifier hs-var">univ_tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745506"><span class="hs-identifier hs-var">ty_args</span></a></span><span>
</span><span id="line-950"></span><span>                               </span><span id="local-6989586621682745513"><span class="annot"><span class="annottext">subst2 :: Subst
</span><a href="#local-6989586621682745513"><span class="hs-identifier hs-var hs-var hs-var">subst2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Subst -&gt; Id -&gt; Id -&gt; Subst) -&gt; Subst -&gt; [Id] -&gt; [Id] -&gt; Subst
forall acc a b. (acc -&gt; a -&gt; b -&gt; acc) -&gt; acc -&gt; [a] -&gt; [b] -&gt; acc
</span><a href="GHC.Utils.Misc.html#foldl2"><span class="hs-identifier hs-var">foldl2</span></a></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Id -&gt; Id -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#extendTvSubstWithClone"><span class="hs-identifier hs-var">extendTvSubstWithClone</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682745511"><span class="hs-identifier hs-var">subst1</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745464"><span class="hs-identifier hs-var">ex_tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745508"><span class="hs-identifier hs-var">ex_vars</span></a></span><span>
</span><span id="line-951"></span><span>                         </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682745516"><span class="annot"><a href="#local-6989586621682745516"><span class="hs-identifier hs-var">rep_ids</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745517"><span class="annot"><a href="#local-6989586621682745517"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; [Boxer] -&gt; [Id] -&gt; UniqSM ([Id], [CoreBind])
</span><a href="#local-6989586621682745518"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682745513"><span class="hs-identifier hs-var">subst2</span></a></span><span> </span><span class="annot"><span class="annottext">[Boxer]
</span><a href="#local-6989586621682745505"><span class="hs-identifier hs-var">boxers</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745509"><span class="hs-identifier hs-var">term_vars</span></a></span><span>
</span><span id="line-952"></span><span>                         </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682745508"><span class="hs-identifier hs-type">ex_vars</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621682745516"><span class="hs-identifier hs-type">rep_ids</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682745517"><span class="hs-identifier hs-type">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-953"></span><span>
</span><span id="line-954"></span><span>    </span><span id="local-6989586621682745518"><span class="annot"><span class="annottext">go :: Subst -&gt; [Boxer] -&gt; [Id] -&gt; UniqSM ([Id], [CoreBind])
</span><a href="#local-6989586621682745518"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Subst
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621682745519"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745519"><span class="hs-identifier hs-var">src_vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; SDoc -&gt; UniqSM ([Id], [CoreBind]) -&gt; UniqSM ([Id], [CoreBind])
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745519"><span class="hs-identifier hs-var">src_vars</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745415"><span class="hs-identifier hs-var">data_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UniqSM ([Id], [CoreBind]) -&gt; UniqSM ([Id], [CoreBind]))
-&gt; UniqSM ([Id], [CoreBind]) -&gt; UniqSM ([Id], [CoreBind])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Id], [CoreBind]) -&gt; UniqSM ([Id], [CoreBind])
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-955"></span><span>    </span><span class="annot"><a href="#local-6989586621682745518"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682745520"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682745520"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Boxer
</span><a href="GHC.Types.Id.Make.html#UnitBox"><span class="hs-identifier hs-var">UnitBox</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682745521"><span class="annot"><span class="annottext">[Boxer]
</span><a href="#local-6989586621682745521"><span class="hs-identifier hs-var">boxers</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682745522"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745522"><span class="hs-identifier hs-var">src_var</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682745523"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745523"><span class="hs-identifier hs-var">src_vars</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-956"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682745524"><span class="annot"><a href="#local-6989586621682745524"><span class="hs-identifier hs-var">rep_ids2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745525"><span class="annot"><a href="#local-6989586621682745525"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; [Boxer] -&gt; [Id] -&gt; UniqSM ([Id], [CoreBind])
</span><a href="#local-6989586621682745518"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682745520"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">[Boxer]
</span><a href="#local-6989586621682745521"><span class="hs-identifier hs-var">boxers</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745523"><span class="hs-identifier hs-var">src_vars</span></a></span><span>
</span><span id="line-957"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682745522"><span class="hs-identifier hs-type">src_var</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621682745524"><span class="hs-identifier hs-type">rep_ids2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682745525"><span class="hs-identifier hs-type">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-958"></span><span>    </span><span class="annot"><a href="#local-6989586621682745518"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682745526"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682745526"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.Make.html#Boxer"><span class="hs-identifier hs-type">Boxer</span></a></span><span> </span><span id="local-6989586621682745527"><span class="annot"><span class="annottext">Subst -&gt; UniqSM ([Id], CoreExpr)
</span><a href="#local-6989586621682745527"><span class="hs-identifier hs-var">boxer</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682745528"><span class="annot"><span class="annottext">[Boxer]
</span><a href="#local-6989586621682745528"><span class="hs-identifier hs-var">boxers</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682745529"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745529"><span class="hs-identifier hs-var">src_var</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682745530"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745530"><span class="hs-identifier hs-var">src_vars</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-959"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682745531"><span class="annot"><a href="#local-6989586621682745531"><span class="hs-identifier hs-var">rep_ids1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745532"><span class="annot"><a href="#local-6989586621682745532"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; UniqSM ([Id], CoreExpr)
</span><a href="#local-6989586621682745527"><span class="hs-identifier hs-var">boxer</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682745526"><span class="hs-identifier hs-var">subst</span></a></span><span>
</span><span id="line-960"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682745533"><span class="annot"><a href="#local-6989586621682745533"><span class="hs-identifier hs-var">rep_ids2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745534"><span class="annot"><a href="#local-6989586621682745534"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682745518"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745526"><span class="hs-identifier hs-type">subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745528"><span class="hs-identifier hs-type">boxers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745530"><span class="hs-identifier hs-type">src_vars</span></a></span><span>
</span><span id="line-961"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682745531"><span class="hs-identifier hs-type">rep_ids1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621682745533"><span class="hs-identifier hs-type">rep_ids2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#NonRec"><span class="hs-identifier hs-type">NonRec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745529"><span class="hs-identifier hs-type">src_var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745532"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621682745534"><span class="hs-identifier hs-type">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-962"></span><span>    </span><span class="annot"><a href="#local-6989586621682745518"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Boxer
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Boxer]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; UniqSM ([Id], [CoreBind])
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mk_boxer&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745415"><span class="hs-identifier hs-var">data_con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-963"></span><span>
</span><span id="line-964"></span><span>    </span><span class="annot"><a href="#local-6989586621682745424"><span class="hs-identifier hs-type">mk_rep_app</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Types.Id.Make.html#Unboxer"><span class="hs-identifier hs-type">Unboxer</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-965"></span><span>    </span><span id="local-6989586621682745424"><span class="annot"><span class="annottext">mk_rep_app :: [(Id, Unboxer)] -&gt; CoreExpr -&gt; UniqSM CoreExpr
</span><a href="#local-6989586621682745424"><span class="hs-identifier hs-var hs-var">mk_rep_app</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621682745537"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745537"><span class="hs-identifier hs-var">con_app</span></a></span></span><span>
</span><span id="line-966"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; UniqSM CoreExpr
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745537"><span class="hs-identifier hs-var">con_app</span></a></span><span>
</span><span id="line-967"></span><span>    </span><span class="annot"><a href="#local-6989586621682745424"><span class="hs-identifier hs-var">mk_rep_app</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682745538"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745538"><span class="hs-identifier hs-var">wrap_arg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745539"><span class="annot"><span class="annottext">Unboxer
</span><a href="#local-6989586621682745539"><span class="hs-identifier hs-var">unboxer</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682745540"><span class="annot"><span class="annottext">[(Id, Unboxer)]
</span><a href="#local-6989586621682745540"><span class="hs-identifier hs-var">prs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682745541"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745541"><span class="hs-identifier hs-var">con_app</span></a></span></span><span>
</span><span id="line-968"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682745542"><span class="annot"><a href="#local-6989586621682745542"><span class="hs-identifier hs-var">rep_ids</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745543"><span class="annot"><a href="#local-6989586621682745543"><span class="hs-identifier hs-var">unbox_fn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Unboxer
</span><a href="#local-6989586621682745539"><span class="hs-identifier hs-var">unboxer</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745538"><span class="hs-identifier hs-var">wrap_arg</span></a></span><span>
</span><span id="line-969"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682745544"><span class="annot"><a href="#local-6989586621682745544"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682745424"><span class="hs-identifier hs-type">mk_rep_app</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745540"><span class="hs-identifier hs-type">prs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#mkVarApps"><span class="hs-identifier hs-type">mkVarApps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745541"><span class="hs-identifier hs-type">con_app</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745542"><span class="hs-identifier hs-type">rep_ids</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-970"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682745543"><span class="hs-identifier hs-type">unbox_fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745544"><span class="hs-identifier hs-type">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-971"></span><span>
</span><span id="line-972"></span><span>
</span><span id="line-973"></span><span class="annot"><a href="GHC.Types.Id.Make.html#dataConWrapperInlinePragma"><span class="hs-identifier hs-type">dataConWrapperInlinePragma</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#InlinePragma"><span class="hs-identifier hs-type">InlinePragma</span></a></span><span>
</span><span id="line-974"></span><span class="hs-comment">-- See Note [DataCon wrappers are conlike]</span><span>
</span><span id="line-975"></span><span id="dataConWrapperInlinePragma"><span class="annot"><span class="annottext">dataConWrapperInlinePragma :: InlinePragma
</span><a href="GHC.Types.Id.Make.html#dataConWrapperInlinePragma"><span class="hs-identifier hs-var hs-var">dataConWrapperInlinePragma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="GHC.Types.Basic.html#alwaysInlineConLikePragma"><span class="hs-identifier hs-var">alwaysInlineConLikePragma</span></a></span><span>
</span><span id="line-976"></span><span>
</span><span id="line-977"></span><span class="hs-comment">{- Note [Activation for data constructor wrappers]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The Activation on a data constructor wrapper allows it to inline only in FinalPhase.
This way rules have a chance to fire if they mention a data constructor on
the left
   RULE &quot;foo&quot;  f (K a b) = ...
Since the LHS of rules are simplified with InitialPhase, we won't
inline the wrapper on the LHS either.

On the other hand, this means that exprIsConApp_maybe must be able to deal
with wrappers so that case-of-constructor is not delayed; see
Note [exprIsConApp_maybe on data constructors with wrappers] for details.

It used to activate in phases 2 (afterInitial) and later, but it makes it
awkward to write a RULE[1] with a constructor on the left: it would work if a
constructor has no wrapper, but whether a constructor has a wrapper depends, for
instance, on the order of type argument of that constructors. Therefore changing
the order of type argument could make previously working RULEs fail.

See also https://gitlab.haskell.org/ghc/ghc/issues/15840 .

Note [DataCon wrappers are conlike]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
DataCon workers are clearly ConLike --- they are the &#8220;Con&#8221; in
&#8220;ConLike&#8221;, after all --- but what about DataCon wrappers? Should they
be marked ConLike, too?

Yes, absolutely! As described in Note [CONLIKE pragma] in
GHC.Types.Basic, isConLike influences GHC.Core.Utils.exprIsExpandable,
which is used by both RULE matching and the case-of-known-constructor
optimization. It&#8217;s crucial that both of those things can see
applications of DataCon wrappers:

  * User-defined RULEs match on wrappers, not workers, so we might
    need to look through an unfolding built from a DataCon wrapper to
    determine if a RULE matches.

  * Likewise, if we have something like
        let x = $WC a b in ... case x of { C y z -&gt; e } ...
    we still want to apply case-of-known-constructor.

Therefore, it&#8217;s important that we consider DataCon wrappers conlike.
This is especially true now that we don&#8217;t inline DataCon wrappers
until the final simplifier phase; see Note [Activation for data
constructor wrappers].

For further reading, see:
  * Note [Conlike is interesting] in GHC.Core.Op.Simplify.Utils
  * Note [Lone variables] in GHC.Core.Unfold
  * Note [exprIsConApp_maybe on data constructors with wrappers]
    in GHC.Core.SimpleOpt
  * #18012

Note [Bangs on imported data constructors]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We pass Maybe [HsImplBang] to mkDataConRep to make use of HsImplBangs
from imported modules.

- Nothing &lt;=&gt; use HsSrcBangs
- Just bangs &lt;=&gt; use HsImplBangs

For imported types we can't work it all out from the HsSrcBangs,
because we want to be very sure to follow what the original module
(where the data type was declared) decided, and that depends on what
flags were enabled when it was compiled. So we record the decisions in
the interface file.

The HsImplBangs passed are in 1-1 correspondence with the
dataConOrigArgTys of the DataCon.

Note [Data con wrappers and unlifted types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider
   data T = MkT !Int#

We certainly do not want to make a wrapper
   $WMkT x = case x of y { DEFAULT -&gt; MkT y }

For a start, it's still to generate a no-op.  But worse, since wrappers
are currently injected at TidyCore, we don't even optimise it away!
So the stupid case expression stays there.  This actually happened for
the Integer data type (see #1600 comment:66)!

Note [Data con wrappers and GADT syntax]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider these two very similar data types:

  data T1 a b = MkT1 b

  data T2 a b where
    MkT2 :: forall b a. b -&gt; T2 a b

Despite their similar appearance, T2 will have a data con wrapper but T1 will
not. What sets them apart? The types of their constructors, which are:

  MkT1 :: forall a b. b -&gt; T1 a b
  MkT2 :: forall b a. b -&gt; T2 a b

MkT2's use of GADT syntax allows it to permute the order in which `a` and `b`
would normally appear. See Note [DataCon user type variable binders] in GHC.Core.DataCon
for further discussion on this topic.

The worker data cons for T1 and T2, however, both have types such that `a` is
expected to come before `b` as arguments. Because MkT2 permutes this order, it
needs a data con wrapper to swizzle around the type variables to be in the
order the worker expects.

A somewhat surprising consequence of this is that *newtypes* can have data con
wrappers! After all, a newtype can also be written with GADT syntax:

  newtype T3 a b where
    MkT3 :: forall b a. b -&gt; T3 a b

Again, this needs a wrapper data con to reorder the type variables. It does
mean that this newtype constructor requires another level of indirection when
being called, but the inliner should make swift work of that.

Note [HsImplBangs for newtypes]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Most of the time, we use the dataConSrctoImplBang function to decide what
strictness/unpackedness to use for the fields of a data type constructor. But
there is an exception to this rule: newtype constructors. You might not think
that newtypes would pose a challenge, since newtypes are seemingly forbidden
from having strictness annotations in the first place. But consider this
(from #16141):

  {-# LANGUAGE StrictData #-}
  {-# OPTIONS_GHC -O #-}
  newtype T a b where
    MkT :: forall b a. Int -&gt; T a b

Because StrictData (plus optimization) is enabled, invoking
dataConSrcToImplBang would sneak in and unpack the field of type Int to Int#!
This would be disastrous, since the wrapper for `MkT` uses a coercion involving
Int, not Int#.

Bottom line: dataConSrcToImplBang should never be invoked for newtypes. In the
case of a newtype constructor, we simply hardcode its dcr_bangs field to
[HsLazy].
-}</span><span>
</span><span id="line-1117"></span><span>
</span><span id="line-1118"></span><span class="hs-comment">-------------------------</span><span>
</span><span id="line-1119"></span><span>
</span><span id="line-1120"></span><span class="annot"><span class="hs-comment">-- | Conjure a fresh local binder.</span></span><span>
</span><span id="line-1121"></span><span class="annot"><a href="GHC.Types.Id.Make.html#newLocal"><span class="hs-identifier hs-type">newLocal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ a string which will form part of the 'Var'\'s name</span></span><span>
</span><span id="line-1122"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the type of the 'Var'</span></span><span>
</span><span id="line-1123"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-1124"></span><span id="newLocal"><span class="annot"><span class="annottext">newLocal :: RuleName -&gt; Scaled Type -&gt; UniqSM Id
</span><a href="GHC.Types.Id.Make.html#newLocal"><span class="hs-identifier hs-var hs-var">newLocal</span></a></span></span><span> </span><span id="local-6989586621682745547"><span class="annot"><span class="annottext">RuleName
</span><a href="#local-6989586621682745547"><span class="hs-identifier hs-var">name_stem</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span id="local-6989586621682745549"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745549"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682745550"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745550"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1125"></span><span>    </span><span class="annot"><span class="annottext">RuleName -&gt; Type -&gt; Type -&gt; UniqSM Id
forall (m :: * -&gt; *).
MonadUnique m =&gt;
RuleName -&gt; Type -&gt; Type -&gt; m Id
</span><a href="GHC.Types.Id.html#mkSysLocalOrCoVarM"><span class="hs-identifier hs-var">mkSysLocalOrCoVarM</span></a></span><span> </span><span class="annot"><span class="annottext">RuleName
</span><a href="#local-6989586621682745547"><span class="hs-identifier hs-var">name_stem</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745549"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745550"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1126"></span><span>         </span><span class="hs-comment">-- We should not have &quot;OrCoVar&quot; here, this is a bug (#17545)</span><span>
</span><span id="line-1127"></span><span>
</span><span id="line-1128"></span><span>
</span><span id="line-1129"></span><span class="hs-comment">-- | Unpack/Strictness decisions from source module.</span><span>
</span><span id="line-1130"></span><span class="hs-comment">--</span><span>
</span><span id="line-1131"></span><span class="hs-comment">-- This function should only ever be invoked for data constructor fields, and</span><span>
</span><span id="line-1132"></span><span class="hs-comment">-- never on the field of a newtype constructor.</span><span>
</span><span id="line-1133"></span><span class="hs-comment">-- See @Note [HsImplBangs for newtypes]@.</span><span>
</span><span id="line-1134"></span><span class="annot"><a href="GHC.Types.Id.Make.html#dataConSrcToImplBang"><span class="hs-identifier hs-type">dataConSrcToImplBang</span></a></span><span>
</span><span id="line-1135"></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#BangOpts"><span class="hs-identifier hs-type">BangOpts</span></a></span><span>
</span><span id="line-1136"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a></span><span>
</span><span id="line-1137"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1138"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#HsSrcBang"><span class="hs-identifier hs-type">HsSrcBang</span></a></span><span>
</span><span id="line-1139"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#HsImplBang"><span class="hs-identifier hs-type">HsImplBang</span></a></span><span>
</span><span id="line-1140"></span><span>
</span><span id="line-1141"></span><span id="dataConSrcToImplBang"><span class="annot"><span class="annottext">dataConSrcToImplBang :: BangOpts -&gt; FamInstEnvs -&gt; Scaled Type -&gt; HsSrcBang -&gt; HsImplBang
</span><a href="GHC.Types.Id.Make.html#dataConSrcToImplBang"><span class="hs-identifier hs-var hs-var">dataConSrcToImplBang</span></a></span></span><span> </span><span id="local-6989586621682745552"><span class="annot"><span class="annottext">BangOpts
</span><a href="#local-6989586621682745552"><span class="hs-identifier hs-var">bang_opts</span></a></span></span><span> </span><span id="local-6989586621682745553"><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621682745553"><span class="hs-identifier hs-var">fam_envs</span></a></span></span><span> </span><span id="local-6989586621682745554"><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745554"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span>
</span><span id="line-1142"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.DataCon.html#HsSrcBang"><span class="hs-identifier hs-type">HsSrcBang</span></a></span><span> </span><span id="local-6989586621682745556"><span class="annot"><span class="annottext">SourceText
</span><a href="#local-6989586621682745556"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#HsBang"><span class="hs-identifier hs-type">HsBang</span></a></span><span> </span><span id="local-6989586621682745558"><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="#local-6989586621682745558"><span class="hs-identifier hs-var">unpk</span></a></span></span><span> </span><span class="annot"><span class="annottext">SrcStrictness
</span><a href="Language.Haskell.Syntax.Basic.html#NoSrcStrict"><span class="hs-identifier hs-var">NoSrcStrict</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1143"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">BangOpts -&gt; Bool
</span><a href="GHC.Types.Id.Make.html#bang_opt_strict_data"><span class="hs-identifier hs-var">bang_opt_strict_data</span></a></span><span> </span><span class="annot"><span class="annottext">BangOpts
</span><a href="#local-6989586621682745552"><span class="hs-identifier hs-var">bang_opts</span></a></span><span> </span><span class="hs-comment">-- StrictData =&gt; strict field</span><span>
</span><span id="line-1144"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BangOpts -&gt; FamInstEnvs -&gt; Scaled Type -&gt; HsSrcBang -&gt; HsImplBang
</span><a href="GHC.Types.Id.Make.html#dataConSrcToImplBang"><span class="hs-identifier hs-var">dataConSrcToImplBang</span></a></span><span> </span><span class="annot"><span class="annottext">BangOpts
</span><a href="#local-6989586621682745552"><span class="hs-identifier hs-var">bang_opts</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621682745553"><span class="hs-identifier hs-var">fam_envs</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745554"><span class="hs-identifier hs-var">arg_ty</span></a></span><span>
</span><span id="line-1145"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceText -&gt; SrcUnpackedness -&gt; SrcStrictness -&gt; HsSrcBang
</span><a href="GHC.Core.DataCon.html#mkHsSrcBang"><span class="hs-identifier hs-var">mkHsSrcBang</span></a></span><span> </span><span class="annot"><span class="annottext">SourceText
</span><a href="#local-6989586621682745556"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="#local-6989586621682745558"><span class="hs-identifier hs-var">unpk</span></a></span><span> </span><span class="annot"><span class="annottext">SrcStrictness
</span><a href="Language.Haskell.Syntax.Basic.html#SrcStrict"><span class="hs-identifier hs-var">SrcStrict</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1146"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-comment">-- no StrictData =&gt; lazy field</span><span>
</span><span id="line-1147"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsImplBang
</span><a href="GHC.Core.DataCon.html#HsLazy"><span class="hs-identifier hs-var">HsLazy</span></a></span><span>
</span><span id="line-1148"></span><span>
</span><span id="line-1149"></span><span class="annot"><a href="GHC.Types.Id.Make.html#dataConSrcToImplBang"><span class="hs-identifier hs-var">dataConSrcToImplBang</span></a></span><span> </span><span class="annot"><span class="annottext">BangOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.DataCon.html#HsSrcBang"><span class="hs-identifier hs-type">HsSrcBang</span></a></span><span> </span><span class="annot"><span class="annottext">SourceText
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#HsBang"><span class="hs-identifier hs-type">HsBang</span></a></span><span> </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SrcStrictness
</span><a href="Language.Haskell.Syntax.Basic.html#SrcLazy"><span class="hs-identifier hs-var">SrcLazy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1150"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsImplBang
</span><a href="GHC.Core.DataCon.html#HsLazy"><span class="hs-identifier hs-var">HsLazy</span></a></span><span>
</span><span id="line-1151"></span><span>
</span><span id="line-1152"></span><span class="annot"><a href="GHC.Types.Id.Make.html#dataConSrcToImplBang"><span class="hs-identifier hs-var">dataConSrcToImplBang</span></a></span><span> </span><span id="local-6989586621682745563"><span class="annot"><span class="annottext">BangOpts
</span><a href="#local-6989586621682745563"><span class="hs-identifier hs-var">bang_opts</span></a></span></span><span> </span><span id="local-6989586621682745564"><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621682745564"><span class="hs-identifier hs-var">fam_envs</span></a></span></span><span> </span><span id="local-6989586621682745565"><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745565"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span>
</span><span id="line-1153"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.DataCon.html#HsSrcBang"><span class="hs-identifier hs-type">HsSrcBang</span></a></span><span> </span><span class="annot"><span class="annottext">SourceText
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#HsBang"><span class="hs-identifier hs-type">HsBang</span></a></span><span> </span><span id="local-6989586621682745566"><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="#local-6989586621682745566"><span class="hs-identifier hs-var">unpk_prag</span></a></span></span><span> </span><span class="annot"><span class="annottext">SrcStrictness
</span><a href="Language.Haskell.Syntax.Basic.html#SrcStrict"><span class="hs-identifier hs-var">SrcStrict</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1154"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Bool
Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scaled Type -&gt; Type
forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745565"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1155"></span><span>    </span><span class="hs-comment">-- NB: non-newtype data constructors can't have representation-polymorphic fields</span><span>
</span><span id="line-1156"></span><span>    </span><span class="hs-comment">-- so this is OK.</span><span>
</span><span id="line-1157"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsImplBang
</span><a href="GHC.Core.DataCon.html#HsLazy"><span class="hs-identifier hs-var">HsLazy</span></a></span><span>  </span><span class="hs-comment">-- For !Int#, say, use HsLazy</span><span>
</span><span id="line-1158"></span><span>            </span><span class="hs-comment">-- See Note [Data con wrappers and unlifted types]</span><span>
</span><span id="line-1159"></span><span>
</span><span id="line-1160"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682745568"><span class="annot"><span class="annottext">mb_co :: Maybe Reduction
</span><a href="#local-6989586621682745568"><span class="hs-identifier hs-var hs-var">mb_co</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FamInstEnvs -&gt; Type -&gt; Maybe Reduction
</span><a href="GHC.Core.FamInstEnv.html#topNormaliseType_maybe"><span class="hs-identifier hs-var">topNormaliseType_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621682745564"><span class="hs-identifier hs-var">fam_envs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scaled Type -&gt; Type
forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745565"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1161"></span><span>                     </span><span class="hs-comment">-- Unwrap type families and newtypes</span><span>
</span><span id="line-1162"></span><span>        </span><span id="local-6989586621682745570"><span class="annot"><span class="annottext">arg_ty' :: Scaled Type
</span><a href="#local-6989586621682745570"><span class="hs-identifier hs-var hs-var">arg_ty'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Reduction
</span><a href="#local-6989586621682745568"><span class="hs-identifier hs-var">mb_co</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1163"></span><span>                    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682745571"><span class="annot"><span class="annottext">Reduction
</span><a href="#local-6989586621682745571"><span class="hs-identifier hs-var">redn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Scaled Type -&gt; Type -&gt; Scaled Type
forall a b. Scaled a -&gt; b -&gt; Scaled b
</span><a href="GHC.Core.Type.html#scaledSet"><span class="hs-identifier hs-var">scaledSet</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745565"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reduction -&gt; Type
</span><a href="GHC.Core.Reduction.html#reductionReducedType"><span class="hs-identifier hs-var">reductionReducedType</span></a></span><span> </span><span class="annot"><span class="annottext">Reduction
</span><a href="#local-6989586621682745571"><span class="hs-identifier hs-var">redn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1164"></span><span>                    </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Maybe Reduction
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745565"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1165"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BangOpts -&gt; SrcUnpackedness -&gt; FamInstEnvs -&gt; Scaled Type -&gt; Bool
</span><a href="GHC.Types.Id.Make.html#shouldUnpackArgTy"><span class="hs-identifier hs-var">shouldUnpackArgTy</span></a></span><span> </span><span class="annot"><span class="annottext">BangOpts
</span><a href="#local-6989586621682745563"><span class="hs-identifier hs-var">bang_opts</span></a></span><span> </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="#local-6989586621682745566"><span class="hs-identifier hs-var">unpk_prag</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621682745564"><span class="hs-identifier hs-var">fam_envs</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745570"><span class="hs-identifier hs-var">arg_ty'</span></a></span><span>
</span><span id="line-1166"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">BangOpts -&gt; Bool
</span><a href="GHC.Types.Id.Make.html#bang_opt_unbox_disable"><span class="hs-identifier hs-var">bang_opt_unbox_disable</span></a></span><span> </span><span class="annot"><span class="annottext">BangOpts
</span><a href="#local-6989586621682745563"><span class="hs-identifier hs-var">bang_opts</span></a></span><span>
</span><span id="line-1167"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; HsImplBang
</span><a href="GHC.Core.DataCon.html#HsStrict"><span class="hs-identifier hs-var">HsStrict</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-comment">-- Not unpacking because of -O0</span><span>
</span><span id="line-1168"></span><span>                       </span><span class="hs-comment">-- See Note [Detecting useless UNPACK pragmas] in GHC.Core.DataCon</span><span>
</span><span id="line-1169"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Reduction
</span><a href="#local-6989586621682745568"><span class="hs-identifier hs-var">mb_co</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1170"></span><span>           </span><span class="annot"><span class="annottext">Maybe Reduction
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Coercion -&gt; HsImplBang
</span><a href="GHC.Core.DataCon.html#HsUnpack"><span class="hs-identifier hs-var">HsUnpack</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Coercion
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1171"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682745577"><span class="annot"><span class="annottext">Reduction
</span><a href="#local-6989586621682745577"><span class="hs-identifier hs-var">redn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Coercion -&gt; HsImplBang
</span><a href="GHC.Core.DataCon.html#HsUnpack"><span class="hs-identifier hs-var">HsUnpack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Maybe Coercion
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Coercion -&gt; Maybe Coercion) -&gt; Coercion -&gt; Maybe Coercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Reduction -&gt; Coercion
</span><a href="GHC.Core.Reduction.html#reductionCoercion"><span class="hs-identifier hs-var">reductionCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">Reduction
</span><a href="#local-6989586621682745577"><span class="hs-identifier hs-var">redn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1172"></span><span>
</span><span id="line-1173"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-comment">-- Record the strict-but-no-unpack decision</span><span>
</span><span id="line-1174"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; HsImplBang
</span><a href="GHC.Core.DataCon.html#HsStrict"><span class="hs-identifier hs-var">HsStrict</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1175"></span><span>
</span><span id="line-1176"></span><span class="hs-comment">-- | Wrappers/Workers and representation following Unpack/Strictness</span><span>
</span><span id="line-1177"></span><span class="hs-comment">-- decisions</span><span>
</span><span id="line-1178"></span><span class="annot"><a href="GHC.Types.Id.Make.html#dataConArgRep"><span class="hs-identifier hs-type">dataConArgRep</span></a></span><span>
</span><span id="line-1179"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1180"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#HsImplBang"><span class="hs-identifier hs-type">HsImplBang</span></a></span><span>
</span><span id="line-1181"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.DataCon.html#StrictnessMark"><span class="hs-identifier hs-type">StrictnessMark</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Rep types</span><span>
</span><span id="line-1182"></span><span>     </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.Make.html#Unboxer"><span class="hs-identifier hs-type">Unboxer</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Types.Id.Make.html#Boxer"><span class="hs-identifier hs-type">Boxer</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1183"></span><span>
</span><span id="line-1184"></span><span id="dataConArgRep"><span class="annot"><span class="annottext">dataConArgRep :: Scaled Type
-&gt; HsImplBang
-&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
</span><a href="GHC.Types.Id.Make.html#dataConArgRep"><span class="hs-identifier hs-var hs-var">dataConArgRep</span></a></span></span><span> </span><span id="local-6989586621682745579"><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745579"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsImplBang
</span><a href="GHC.Core.DataCon.html#HsLazy"><span class="hs-identifier hs-var">HsLazy</span></a></span><span>
</span><span id="line-1185"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745579"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StrictnessMark
</span><a href="GHC.Core.DataCon.html#NotMarkedStrict"><span class="hs-identifier hs-var">NotMarkedStrict</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unboxer
</span><a href="GHC.Types.Id.Make.html#unitUnboxer"><span class="hs-identifier hs-var">unitUnboxer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Boxer
</span><a href="GHC.Types.Id.Make.html#unitBoxer"><span class="hs-identifier hs-var">unitBoxer</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1186"></span><span>
</span><span id="line-1187"></span><span class="annot"><a href="GHC.Types.Id.Make.html#dataConArgRep"><span class="hs-identifier hs-var">dataConArgRep</span></a></span><span> </span><span id="local-6989586621682745583"><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745583"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.DataCon.html#HsStrict"><span class="hs-identifier hs-type">HsStrict</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1188"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745583"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StrictnessMark
</span><a href="GHC.Core.DataCon.html#MarkedStrict"><span class="hs-identifier hs-var">MarkedStrict</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unboxer
</span><a href="GHC.Types.Id.Make.html#seqUnboxer"><span class="hs-identifier hs-var">seqUnboxer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Boxer
</span><a href="GHC.Types.Id.Make.html#unitBoxer"><span class="hs-identifier hs-var">unitBoxer</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1189"></span><span>
</span><span id="line-1190"></span><span class="annot"><a href="GHC.Types.Id.Make.html#dataConArgRep"><span class="hs-identifier hs-var">dataConArgRep</span></a></span><span> </span><span id="local-6989586621682745586"><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745586"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.DataCon.html#HsUnpack"><span class="hs-identifier hs-type">HsUnpack</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Coercion
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-1191"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scaled Type -&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
</span><a href="GHC.Types.Id.Make.html#dataConArgUnpack"><span class="hs-identifier hs-var">dataConArgUnpack</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745586"><span class="hs-identifier hs-var">arg_ty</span></a></span><span>
</span><span id="line-1192"></span><span>
</span><span id="line-1193"></span><span class="annot"><a href="GHC.Types.Id.Make.html#dataConArgRep"><span class="hs-identifier hs-var">dataConArgRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span id="local-6989586621682745588"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745588"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.DataCon.html#HsUnpack"><span class="hs-identifier hs-type">HsUnpack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682745589"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682745589"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1194"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682745590"><span class="annot"><span class="annottext">co_rep_ty :: Type
</span><a href="#local-6989586621682745590"><span class="hs-identifier hs-var hs-var">co_rep_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Coercion -&gt; Type
Coercion -&gt; Type
</span><a href="GHC.Core.Coercion.html#coercionRKind"><span class="hs-identifier hs-var">coercionRKind</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682745589"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1195"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682745592"><span class="annot"><span class="annottext">[(Scaled Type, StrictnessMark)]
</span><a href="#local-6989586621682745592"><span class="hs-identifier hs-var">rep_tys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745593"><span class="annot"><span class="annottext">(Unboxer, Boxer)
</span><a href="#local-6989586621682745593"><span class="hs-identifier hs-var">wrappers</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Scaled Type -&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
</span><a href="GHC.Types.Id.Make.html#dataConArgUnpack"><span class="hs-identifier hs-var">dataConArgUnpack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745588"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745590"><span class="hs-identifier hs-var">co_rep_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1196"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Scaled Type, StrictnessMark)]
</span><a href="#local-6989586621682745592"><span class="hs-identifier hs-var">rep_tys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Type -&gt; (Unboxer, Boxer) -&gt; (Unboxer, Boxer)
</span><a href="GHC.Types.Id.Make.html#wrapCo"><span class="hs-identifier hs-var">wrapCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682745589"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745590"><span class="hs-identifier hs-var">co_rep_ty</span></a></span><span> </span><span class="annot"><span class="annottext">(Unboxer, Boxer)
</span><a href="#local-6989586621682745593"><span class="hs-identifier hs-var">wrappers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1197"></span><span>
</span><span id="line-1198"></span><span>
</span><span id="line-1199"></span><span class="hs-comment">-------------------------</span><span>
</span><span id="line-1200"></span><span class="annot"><a href="GHC.Types.Id.Make.html#wrapCo"><span class="hs-identifier hs-type">wrapCo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.Make.html#Unboxer"><span class="hs-identifier hs-type">Unboxer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#Boxer"><span class="hs-identifier hs-type">Boxer</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.Make.html#Unboxer"><span class="hs-identifier hs-type">Unboxer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#Boxer"><span class="hs-identifier hs-type">Boxer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1201"></span><span id="wrapCo"><span class="annot"><span class="annottext">wrapCo :: Coercion -&gt; Type -&gt; (Unboxer, Boxer) -&gt; (Unboxer, Boxer)
</span><a href="GHC.Types.Id.Make.html#wrapCo"><span class="hs-identifier hs-var hs-var">wrapCo</span></a></span></span><span> </span><span id="local-6989586621682745595"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682745595"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621682745596"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745596"><span class="hs-identifier hs-var">rep_ty</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682745597"><span class="annot"><span class="annottext">Unboxer
</span><a href="#local-6989586621682745597"><span class="hs-identifier hs-var">unbox_rep</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745598"><span class="annot"><span class="annottext">Boxer
</span><a href="#local-6989586621682745598"><span class="hs-identifier hs-var">box_rep</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- co :: arg_ty ~ rep_ty</span><span>
</span><span id="line-1202"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unboxer
</span><a href="#local-6989586621682745599"><span class="hs-identifier hs-var">unboxer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Boxer
</span><a href="#local-6989586621682745600"><span class="hs-identifier hs-var">boxer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1203"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1204"></span><span>    </span><span id="local-6989586621682745599"><span class="annot"><span class="annottext">unboxer :: Unboxer
</span><a href="#local-6989586621682745599"><span class="hs-identifier hs-var hs-var">unboxer</span></a></span></span><span> </span><span id="local-6989586621682745601"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745601"><span class="hs-identifier hs-var">arg_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682745602"><span class="annot"><a href="#local-6989586621682745602"><span class="hs-identifier hs-var">rep_id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleName -&gt; Scaled Type -&gt; UniqSM Id
</span><a href="GHC.Types.Id.Make.html#newLocal"><span class="hs-identifier hs-var">newLocal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cowrap_unbx&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Types.Id.html#idMult"><span class="hs-identifier hs-var">idMult</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745601"><span class="hs-identifier hs-var">arg_id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745596"><span class="hs-identifier hs-var">rep_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1205"></span><span>                        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682745604"><span class="annot"><a href="#local-6989586621682745604"><span class="hs-identifier hs-var">rep_ids</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745605"><span class="annot"><a href="#local-6989586621682745605"><span class="hs-identifier hs-var">rep_fn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682745597"><span class="hs-identifier hs-type">unbox_rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745602"><span class="hs-identifier hs-type">rep_id</span></a></span><span>
</span><span id="line-1206"></span><span>                        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682745606"><span class="annot"><a href="#local-6989586621682745606"><span class="hs-identifier hs-var hs-var">co_bind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr -&gt; CoreBind
forall b. b -&gt; Expr b -&gt; Bind b
</span><a href="GHC.Core.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745602"><span class="hs-identifier hs-var">rep_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745601"><span class="hs-identifier hs-var">arg_id</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Coercion -&gt; CoreExpr
forall b. Expr b -&gt; Coercion -&gt; Expr b
</span><a href="GHC.Core.html#Cast"><span class="hs-operator hs-var">`Cast`</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682745595"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1207"></span><span>                        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682745604"><span class="hs-identifier hs-type">rep_ids</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745606"><span class="hs-identifier hs-type">co_bind</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="#local-6989586621682745605"><span class="hs-identifier hs-type">rep_fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1208"></span><span>    </span><span id="local-6989586621682745600"><span class="annot"><span class="annottext">boxer :: Boxer
</span><a href="#local-6989586621682745600"><span class="hs-identifier hs-var hs-var">boxer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Subst -&gt; UniqSM ([Id], CoreExpr)) -&gt; Boxer
</span><a href="GHC.Types.Id.Make.html#Boxer"><span class="hs-identifier hs-var">Boxer</span></a></span><span> </span><span class="annot"><span class="annottext">((Subst -&gt; UniqSM ([Id], CoreExpr)) -&gt; Boxer)
-&gt; (Subst -&gt; UniqSM ([Id], CoreExpr)) -&gt; Boxer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682745609"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682745609"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1209"></span><span>            </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682745610"><span class="annot"><a href="#local-6989586621682745610"><span class="hs-identifier hs-var">rep_ids</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745611"><span class="annot"><a href="#local-6989586621682745611"><span class="hs-identifier hs-var">rep_expr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1210"></span><span>                    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Boxer
</span><a href="#local-6989586621682745598"><span class="hs-identifier hs-var">box_rep</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1211"></span><span>                         </span><span class="annot"><span class="annottext">Boxer
</span><a href="GHC.Types.Id.Make.html#UnitBox"><span class="hs-identifier hs-var">UnitBox</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682745612"><span class="annot"><a href="#local-6989586621682745612"><span class="hs-identifier hs-var">rep_id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleName -&gt; Scaled Type -&gt; UniqSM Id
</span><a href="GHC.Types.Id.Make.html#newLocal"><span class="hs-identifier hs-var">newLocal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cowrap_bx&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Scaled Type
forall a. a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#linear"><span class="hs-identifier hs-var">linear</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Scaled Type) -&gt; Type -&gt; Scaled Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Subst -&gt; Type -&gt; Type
Subst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">TcType.substTy</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682745609"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745596"><span class="hs-identifier hs-var">rep_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1212"></span><span>                                       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682745612"><span class="hs-identifier hs-type">rep_id</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745612"><span class="hs-identifier hs-type">rep_id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1213"></span><span>                         </span><span class="annot"><a href="GHC.Types.Id.Make.html#Boxer"><span class="hs-identifier hs-type">Boxer</span></a></span><span> </span><span id="local-6989586621682745615"><span class="annot"><span class="annottext">Subst -&gt; UniqSM ([Id], CoreExpr)
</span><a href="#local-6989586621682745615"><span class="hs-identifier hs-var">boxer</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; UniqSM ([Id], CoreExpr)
</span><a href="#local-6989586621682745615"><span class="hs-identifier hs-var">boxer</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682745609"><span class="hs-identifier hs-var">subst</span></a></span><span>
</span><span id="line-1214"></span><span>               </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682745616"><span class="annot"><a href="#local-6989586621682745616"><span class="hs-identifier hs-var hs-var">sco</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#substCoUnchecked"><span class="hs-identifier hs-var">substCoUnchecked</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682745609"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682745595"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1215"></span><span>               </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682745610"><span class="hs-identifier hs-type">rep_ids</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682745611"><span class="hs-identifier hs-type">rep_expr</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#Cast"><span class="hs-operator hs-type">`Cast`</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkSymCo"><span class="hs-identifier hs-type">mkSymCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745616"><span class="hs-identifier hs-type">sco</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1216"></span><span>
</span><span id="line-1217"></span><span class="hs-comment">------------------------</span><span>
</span><span id="line-1218"></span><span class="annot"><a href="GHC.Types.Id.Make.html#seqUnboxer"><span class="hs-identifier hs-type">seqUnboxer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#Unboxer"><span class="hs-identifier hs-type">Unboxer</span></a></span><span>
</span><span id="line-1219"></span><span id="seqUnboxer"><span class="annot"><span class="annottext">seqUnboxer :: Unboxer
</span><a href="GHC.Types.Id.Make.html#seqUnboxer"><span class="hs-identifier hs-var hs-var">seqUnboxer</span></a></span></span><span> </span><span id="local-6989586621682745619"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745619"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Id], CoreExpr -&gt; CoreExpr) -&gt; UniqSM ([Id], CoreExpr -&gt; CoreExpr)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745619"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Id -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Utils.html#mkDefaultCase"><span class="hs-identifier hs-var">mkDefaultCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745619"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745619"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1220"></span><span>
</span><span id="line-1221"></span><span class="annot"><a href="GHC.Types.Id.Make.html#unitUnboxer"><span class="hs-identifier hs-type">unitUnboxer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#Unboxer"><span class="hs-identifier hs-type">Unboxer</span></a></span><span>
</span><span id="line-1222"></span><span id="unitUnboxer"><span class="annot"><span class="annottext">unitUnboxer :: Unboxer
</span><a href="GHC.Types.Id.Make.html#unitUnboxer"><span class="hs-identifier hs-var hs-var">unitUnboxer</span></a></span></span><span> </span><span id="local-6989586621682745620"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745620"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Id], CoreExpr -&gt; CoreExpr) -&gt; UniqSM ([Id], CoreExpr -&gt; CoreExpr)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745620"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682745621"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745621"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745621"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1223"></span><span>
</span><span id="line-1224"></span><span class="annot"><a href="GHC.Types.Id.Make.html#unitBoxer"><span class="hs-identifier hs-type">unitBoxer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#Boxer"><span class="hs-identifier hs-type">Boxer</span></a></span><span>
</span><span id="line-1225"></span><span id="unitBoxer"><span class="annot"><span class="annottext">unitBoxer :: Boxer
</span><a href="GHC.Types.Id.Make.html#unitBoxer"><span class="hs-identifier hs-var hs-var">unitBoxer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Boxer
</span><a href="GHC.Types.Id.Make.html#UnitBox"><span class="hs-identifier hs-var">UnitBox</span></a></span><span>
</span><span id="line-1226"></span><span>
</span><span id="line-1227"></span><span class="hs-comment">-------------------------</span><span>
</span><span id="line-1228"></span><span>
</span><span id="line-1229"></span><span class="hs-comment">{- Note [UNPACK for sum types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Suppose we have a data type D, for example:
    data D = D1 [Int] [Bool]
           | D2

and another data type which unpacks a field of type D:
    data U a = MkU {-# UNPACK #-} !D
                   {-# UNPACK #-} !(a,a)
                   {-# UNPACK #-} !D

Then the wrapper and worker for MkU have these types

  -- Wrapper
  $WMkU :: D -&gt; (a,a) -&gt; D -&gt; U a

  -- Worker
  MkU :: (# (# [Int],[Bool] #) | (# #) #)
      -&gt; a
      -&gt; a
      -&gt; (# (# [Int],[Bool] #) | (# #) #)
      -&gt; U a

For each unpacked /sum/-type argument, the worker gets one argument.
But for each unpacked /product/-type argument, the worker gets N
arguments (here two).

Why treat them differently?  See Note [Why sums and products are treated differently].

The wrapper $WMkU looks like this:

  $WMkU :: D -&gt; (a,a) -&gt; D -&gt; U a
  $WMkU x1 y x2
    = case (case x1 of {
              D1 a b -&gt; (# (# a,b #) | #)
              D2     -&gt; (# | (# #) #) }) of { x1_ubx -&gt;
      case y of { (y1, y2) -&gt;
      case (case x2 of {
              D1 a b -&gt; (# (# a,b #) | #)
              D2     -&gt; (# | (# #) #) }) of { x2_ubx -&gt;
      MkU x1_ubx y1 y2 x2_ubx

Notice the nested case needed for sums.

This different treatment for sums and product is implemented in
dataConArgUnpackSum and dataConArgUnpackProduct respectively.

Note [Why sums and products are treated differently]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Can we handle sums like products, with each wrapper argument
occupying multiple argument slots in the worker?  No: for a sum
type the number of argument slots varies, and that's exactly what
unboxed sums are designed for.

Can we handle products like sums, with each wrapper argument occupying
exactly one argument slot (and unboxed tuple) in the worker?  Yes,
we could.  For example
   data P = MkP {-# UNPACK #-} !Q
   data Q = MkQ {-# NOUNPACK #-} !Int
                {-# NOUNPACK #-} Int

Currently could unpack P thus, taking two slots in the worker
   $WMkP :: Q -&gt; P
   $WMkP x = case x of { MkQ a b -&gt; MkP a b }
   MkP :: Int -&gt; Int -&gt; P  -- Worker

We could instead do this (uniformly with sums)

   $WMkP1 :: Q -&gt; P
   $WMkP1 x = case (case x of { MkQ a b -&gt; (# a, b #) }) of ubx_x
              MkP1 ubx_x
   MkP1 :: (# Int, Int #) -&gt; P  -- Worker

The representation of MkP and MkP1 would be identical (a constructor
with two fields).

BUT, with MkP (as with every data constructor) we record its argument
strictness as a bit-vector, actually [StrictnessMark]
   MkP strictness:  SL
This information is used in Core to record which fields are sure to
be evaluated.  (Look for calls to dataConRepStrictness.)  E.g. in Core
    case v of MkP x y -&gt; ....&lt;here x is known to be evald&gt;....

Alas, with MkP1 this information is hidden by the unboxed pair,
In Core there will be an auxiliary case expression to take apart the pair:
    case v of MkP1 xy -&gt; case xy of (# x,y #) -&gt; ...
And now we have no easy way to know that x is evaluated in the &quot;...&quot;.

Fixing this might be possible, but it'd be tricky.  So we avoid the
problem entirely by treating sums and products differently here.
-}</span><span>
</span><span id="line-1320"></span><span>
</span><span id="line-1321"></span><span class="annot"><a href="GHC.Types.Id.Make.html#dataConArgUnpack"><span class="hs-identifier hs-type">dataConArgUnpack</span></a></span><span>
</span><span id="line-1322"></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1323"></span><span>   </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#StrictnessMark"><span class="hs-identifier hs-type">StrictnessMark</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- Rep types</span><span>
</span><span id="line-1324"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.Make.html#Unboxer"><span class="hs-identifier hs-type">Unboxer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#Boxer"><span class="hs-identifier hs-type">Boxer</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1325"></span><span id="dataConArgUnpack"><span class="annot"><span class="annottext">dataConArgUnpack :: Scaled Type -&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
</span><a href="GHC.Types.Id.Make.html#dataConArgUnpack"><span class="hs-identifier hs-var hs-var">dataConArgUnpack</span></a></span></span><span> </span><span id="local-6989586621682745622"><span class="annot"><span class="annottext">scaledTy :: Scaled Type
</span><a href="#local-6989586621682745622"><span class="hs-identifier hs-var">scaledTy</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682745623"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745623"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1326"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682745624"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745624"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745625"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745625"><span class="hs-identifier hs-var">tc_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745623"><span class="hs-identifier hs-var">arg_ty</span></a></span><span>
</span><span id="line-1327"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
-&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745624"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
 -&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer)))
-&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
-&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1328"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [DataCon]
</span><a href="GHC.Core.TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745624"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1329"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682745628"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745628"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Scaled Type
-&gt; [Type]
-&gt; DataCon
-&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
</span><a href="GHC.Types.Id.Make.html#dataConArgUnpackProduct"><span class="hs-identifier hs-var">dataConArgUnpackProduct</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745622"><span class="hs-identifier hs-var">scaledTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745625"><span class="hs-identifier hs-var">tc_args</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745628"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-1330"></span><span>      </span><span id="local-6989586621682745630"><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745630"><span class="hs-identifier hs-var">cons</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Scaled Type
-&gt; [Type]
-&gt; [DataCon]
-&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
</span><a href="GHC.Types.Id.Make.html#dataConArgUnpackSum"><span class="hs-identifier hs-var">dataConArgUnpackSum</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745622"><span class="hs-identifier hs-var">scaledTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745625"><span class="hs-identifier hs-var">tc_args</span></a></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745630"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-1331"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1332"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; SDoc -&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dataConArgUnpack&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745623"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1333"></span><span>    </span><span class="hs-comment">-- An interface file specified Unpacked, but we couldn't unpack it</span><span>
</span><span id="line-1334"></span><span>
</span><span id="line-1335"></span><span class="annot"><a href="GHC.Types.Id.Make.html#dataConArgUnpackProduct"><span class="hs-identifier hs-type">dataConArgUnpackProduct</span></a></span><span>
</span><span id="line-1336"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1337"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1338"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span>
</span><span id="line-1339"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#StrictnessMark"><span class="hs-identifier hs-type">StrictnessMark</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- Rep types</span><span>
</span><span id="line-1340"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.Make.html#Unboxer"><span class="hs-identifier hs-type">Unboxer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#Boxer"><span class="hs-identifier hs-type">Boxer</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1341"></span><span id="dataConArgUnpackProduct"><span class="annot"><span class="annottext">dataConArgUnpackProduct :: Scaled Type
-&gt; [Type]
-&gt; DataCon
-&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
</span><a href="GHC.Types.Id.Make.html#dataConArgUnpackProduct"><span class="hs-identifier hs-var hs-var">dataConArgUnpackProduct</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span id="local-6989586621682745632"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745632"><span class="hs-identifier hs-var">arg_mult</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682745633"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745633"><span class="hs-identifier hs-var">tc_args</span></a></span></span><span> </span><span id="local-6989586621682745634"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745634"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1342"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
-&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; [Id]
</span><a href="GHC.Core.DataCon.html#dataConExTyCoVars"><span class="hs-identifier hs-var">dataConExTyCoVars</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745634"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
 -&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer)))
-&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
-&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1343"></span><span>    </span><span class="hs-comment">-- Note [Unpacking GADTs and existentials]</span><span>
</span><span id="line-1344"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682745635"><span class="annot"><span class="annottext">rep_tys :: [Scaled Type]
</span><a href="#local-6989586621682745635"><span class="hs-identifier hs-var hs-var">rep_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Scaled Type -&gt; Scaled Type) -&gt; [Scaled Type] -&gt; [Scaled Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Scaled Type -&gt; Scaled Type
forall a. Type -&gt; Scaled a -&gt; Scaled a
</span><a href="GHC.Core.Multiplicity.html#scaleScaled"><span class="hs-identifier hs-var">scaleScaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745632"><span class="hs-identifier hs-var">arg_mult</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Scaled Type] -&gt; [Scaled Type]) -&gt; [Scaled Type] -&gt; [Scaled Type]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [Type] -&gt; [Scaled Type]
</span><a href="GHC.Core.DataCon.html#dataConInstArgTys"><span class="hs-identifier hs-var">dataConInstArgTys</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745634"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745633"><span class="hs-identifier hs-var">tc_args</span></a></span><span>
</span><span id="line-1345"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682745635"><span class="hs-identifier hs-var">rep_tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
-&gt; [StrictnessMark] -&gt; [(Scaled Type, StrictnessMark)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-operator hs-var">`zip`</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [StrictnessMark]
</span><a href="GHC.Core.DataCon.html#dataConRepStrictness"><span class="hs-identifier hs-var">dataConRepStrictness</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745634"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-1346"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682745639"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745639"><span class="hs-identifier hs-var">arg_id</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1347"></span><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682745640"><span class="annot"><a href="#local-6989586621682745640"><span class="hs-identifier hs-var">rep_ids</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Scaled Type -&gt; UniqSM Id) -&gt; [Scaled Type] -&gt; UniqSM [Id]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleName -&gt; Scaled Type -&gt; UniqSM Id
</span><a href="GHC.Types.Id.Make.html#newLocal"><span class="hs-identifier hs-var">newLocal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unbx&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682745635"><span class="hs-identifier hs-var">rep_tys</span></a></span><span>
</span><span id="line-1348"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682745641"><span class="annot"><a href="#local-6989586621682745641"><span class="hs-identifier hs-var hs-var">r_mult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Types.Id.html#idMult"><span class="hs-identifier hs-var">idMult</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745639"><span class="hs-identifier hs-var">arg_id</span></a></span><span>
</span><span id="line-1349"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682745642"><span class="annot"><a href="#local-6989586621682745642"><span class="hs-identifier hs-var hs-var">rep_ids'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Id -&gt; Id) -&gt; [Id] -&gt; [Id]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Id -&gt; Id
</span><a href="GHC.Types.Id.html#scaleIdBy"><span class="hs-identifier hs-var">scaleIdBy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745641"><span class="hs-identifier hs-var">r_mult</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745640"><span class="hs-identifier hs-var">rep_ids</span></a></span><span>
</span><span id="line-1350"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682745644"><span class="annot"><a href="#local-6989586621682745644"><span class="hs-identifier hs-var hs-var">unbox_fn</span></a></span></span><span> </span><span id="local-6989586621682745645"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745645"><span class="hs-identifier hs-var">body</span></a></span></span><span>
</span><span id="line-1351"></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Id -&gt; AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Utils.html#mkSingleAltCase"><span class="hs-identifier hs-var">mkSingleAltCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745639"><span class="hs-identifier hs-var">arg_id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745639"><span class="hs-identifier hs-var">arg_id</span></a></span><span>
</span><span id="line-1352"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745634"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745642"><span class="hs-identifier hs-var">rep_ids'</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745645"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-1353"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682745640"><span class="hs-identifier hs-type">rep_ids</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682745644"><span class="hs-identifier hs-type">unbox_fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1354"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Subst -&gt; UniqSM ([Id], CoreExpr)) -&gt; Boxer
</span><a href="GHC.Types.Id.Make.html#Boxer"><span class="hs-identifier hs-var">Boxer</span></a></span><span> </span><span class="annot"><span class="annottext">((Subst -&gt; UniqSM ([Id], CoreExpr)) -&gt; Boxer)
-&gt; (Subst -&gt; UniqSM ([Id], CoreExpr)) -&gt; Boxer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682745646"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682745646"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1355"></span><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682745647"><span class="annot"><a href="#local-6989586621682745647"><span class="hs-identifier hs-var">rep_ids</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Scaled Type -&gt; UniqSM Id) -&gt; [Scaled Type] -&gt; UniqSM [Id]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleName -&gt; Scaled Type -&gt; UniqSM Id
</span><a href="GHC.Types.Id.Make.html#newLocal"><span class="hs-identifier hs-var">newLocal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bx&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Scaled Type -&gt; UniqSM Id)
-&gt; (Scaled Type -&gt; Scaled Type) -&gt; Scaled Type -&gt; UniqSM Id
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Subst -&gt; Scaled Type -&gt; Scaled Type
Subst -&gt; Scaled Type -&gt; Scaled Type
</span><a href="GHC.Core.TyCo.Subst.html#substScaledTyUnchecked"><span class="hs-identifier hs-var">TcType.substScaledTyUnchecked</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682745646"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621682745635"><span class="hs-identifier hs-var">rep_tys</span></a></span><span>
</span><span id="line-1356"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682745647"><span class="hs-identifier hs-type">rep_ids</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.DataCon.html#dataConWorkId"><span class="hs-identifier hs-type">dataConWorkId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745634"><span class="hs-identifier hs-type">con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1357"></span><span>                               </span><span class="annot"><a href="GHC.Core.html#mkTyApps"><span class="hs-operator hs-type">`mkTyApps`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTysUnchecked"><span class="hs-identifier hs-type">substTysUnchecked</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745646"><span class="hs-identifier hs-type">subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745633"><span class="hs-identifier hs-type">tc_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1358"></span><span>                               </span><span class="annot"><a href="GHC.Core.html#mkVarApps"><span class="hs-operator hs-type">`mkVarApps`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745647"><span class="hs-identifier hs-type">rep_ids</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1359"></span><span>
</span><span id="line-1360"></span><span class="annot"><a href="GHC.Types.Id.Make.html#dataConArgUnpackSum"><span class="hs-identifier hs-type">dataConArgUnpackSum</span></a></span><span>
</span><span id="line-1361"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1362"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1363"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1364"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#StrictnessMark"><span class="hs-identifier hs-type">StrictnessMark</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- Rep types</span><span>
</span><span id="line-1365"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.Make.html#Unboxer"><span class="hs-identifier hs-type">Unboxer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#Boxer"><span class="hs-identifier hs-type">Boxer</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1366"></span><span id="dataConArgUnpackSum"><span class="annot"><span class="annottext">dataConArgUnpackSum :: Scaled Type
-&gt; [Type]
-&gt; [DataCon]
-&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
</span><a href="GHC.Types.Id.Make.html#dataConArgUnpackSum"><span class="hs-identifier hs-var hs-var">dataConArgUnpackSum</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span id="local-6989586621682745650"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745650"><span class="hs-identifier hs-var">arg_mult</span></a></span></span><span> </span><span id="local-6989586621682745651"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745651"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682745652"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745652"><span class="hs-identifier hs-var">tc_args</span></a></span></span><span> </span><span id="local-6989586621682745653"><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745653"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1367"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745654"><span class="hs-identifier hs-var">sum_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StrictnessMark
</span><a href="GHC.Core.DataCon.html#MarkedStrict"><span class="hs-identifier hs-var">MarkedStrict</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- The idea: Unpacked variant will</span><span>
</span><span id="line-1368"></span><span>                               </span><span class="hs-comment">-- be one field only, and the type of the</span><span>
</span><span id="line-1369"></span><span>                               </span><span class="hs-comment">-- field will be an unboxed sum.</span><span>
</span><span id="line-1370"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Unboxer
</span><a href="#local-6989586621682745655"><span class="hs-identifier hs-var">unboxer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Boxer
</span><a href="#local-6989586621682745656"><span class="hs-identifier hs-var">boxer</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1371"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1372"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621682745657"><span class="annot"><span class="annottext">ubx_sum_arity :: Int
</span><a href="#local-6989586621682745657"><span class="hs-identifier hs-var hs-var">ubx_sum_arity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DataCon] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745653"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-1373"></span><span>    </span><span id="local-6989586621682745658"><span class="annot"><span class="annottext">src_tys :: [[Type]]
</span><a href="#local-6989586621682745658"><span class="hs-identifier hs-var hs-var">src_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DataCon -&gt; [Type]) -&gt; [DataCon] -&gt; [[Type]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682745659"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745659"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Scaled Type -&gt; Type) -&gt; [Scaled Type] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Scaled Type -&gt; Type
forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span> </span><span class="annot"><span class="annottext">([Scaled Type] -&gt; [Type]) -&gt; [Scaled Type] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [Type] -&gt; [Scaled Type]
</span><a href="GHC.Core.DataCon.html#dataConInstArgTys"><span class="hs-identifier hs-var">dataConInstArgTys</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745659"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745652"><span class="hs-identifier hs-var">tc_args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745653"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-1374"></span><span>    </span><span id="local-6989586621682745660"><span class="annot"><span class="annottext">sum_alt_tys :: [Type]
</span><a href="#local-6989586621682745660"><span class="hs-identifier hs-var hs-var">sum_alt_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; Type) -&gt; [[Type]] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Type
</span><a href="GHC.Types.Id.Make.html#mkUbxSumAltTy"><span class="hs-identifier hs-var">mkUbxSumAltTy</span></a></span><span> </span><span class="annot"><span class="annottext">[[Type]]
</span><a href="#local-6989586621682745658"><span class="hs-identifier hs-var">src_tys</span></a></span><span>
</span><span id="line-1375"></span><span>    </span><span id="local-6989586621682745662"><span class="annot"><span class="annottext">sum_ty_unscaled :: Type
</span><a href="#local-6989586621682745662"><span class="hs-identifier hs-var hs-var">sum_ty_unscaled</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Type
</span><a href="GHC.Builtin.Types.html#mkSumTy"><span class="hs-identifier hs-var">mkSumTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745660"><span class="hs-identifier hs-var">sum_alt_tys</span></a></span><span>
</span><span id="line-1376"></span><span>    </span><span id="local-6989586621682745654"><span class="annot"><span class="annottext">sum_ty :: Scaled Type
</span><a href="#local-6989586621682745654"><span class="hs-identifier hs-var hs-var">sum_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745650"><span class="hs-identifier hs-var">arg_mult</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745662"><span class="hs-identifier hs-var">sum_ty_unscaled</span></a></span><span>
</span><span id="line-1377"></span><span>    </span><span id="local-6989586621682745664"><span class="annot"><span class="annottext">newLocal' :: RuleName -&gt; Type -&gt; UniqSM Id
</span><a href="#local-6989586621682745664"><span class="hs-identifier hs-var hs-var">newLocal'</span></a></span></span><span> </span><span id="local-6989586621682745665"><span class="annot"><span class="annottext">RuleName
</span><a href="#local-6989586621682745665"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleName -&gt; Scaled Type -&gt; UniqSM Id
</span><a href="GHC.Types.Id.Make.html#newLocal"><span class="hs-identifier hs-var">newLocal</span></a></span><span> </span><span class="annot"><span class="annottext">RuleName
</span><a href="#local-6989586621682745665"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">(Scaled Type -&gt; UniqSM Id)
-&gt; (Type -&gt; Scaled Type) -&gt; Type -&gt; UniqSM Id
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745650"><span class="hs-identifier hs-var">arg_mult</span></a></span><span>
</span><span id="line-1378"></span><span>
</span><span id="line-1379"></span><span>    </span><span class="hs-comment">-- See Note [UNPACK for sum types]</span><span>
</span><span id="line-1380"></span><span>    </span><span class="annot"><a href="#local-6989586621682745655"><span class="hs-identifier hs-type">unboxer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#Unboxer"><span class="hs-identifier hs-type">Unboxer</span></a></span><span>
</span><span id="line-1381"></span><span>    </span><span id="local-6989586621682745655"><span class="annot"><span class="annottext">unboxer :: Unboxer
</span><a href="#local-6989586621682745655"><span class="hs-identifier hs-var hs-var">unboxer</span></a></span></span><span> </span><span id="local-6989586621682745666"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745666"><span class="hs-identifier hs-var">arg_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1382"></span><span>      </span><span id="local-6989586621682745667"><span class="annot"><a href="#local-6989586621682745667"><span class="hs-identifier hs-var">con_arg_binders</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; UniqSM [Id]) -&gt; [[Type]] -&gt; UniqSM [[Id]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; UniqSM Id) -&gt; [Type] -&gt; UniqSM [Id]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleName -&gt; Type -&gt; UniqSM Id
</span><a href="#local-6989586621682745664"><span class="hs-identifier hs-var">newLocal'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unbx&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Type]]
</span><a href="#local-6989586621682745658"><span class="hs-identifier hs-var">src_tys</span></a></span><span>
</span><span id="line-1383"></span><span>      </span><span id="local-6989586621682745668"><span class="annot"><a href="#local-6989586621682745668"><span class="hs-identifier hs-var">ubx_sum_bndr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#newLocal"><span class="hs-identifier hs-type">newLocal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-type">fsLit</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;unbx&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682745654"><span class="hs-identifier hs-type">sum_ty</span></a></span><span>
</span><span id="line-1384"></span><span>
</span><span id="line-1385"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-1386"></span><span>        </span><span class="annot"><a href="#local-6989586621682745669"><span class="hs-identifier hs-type">mk_ubx_sum_alt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a></span><span>
</span><span id="line-1387"></span><span>        </span><span id="local-6989586621682745669"><span class="annot"><a href="#local-6989586621682745669"><span class="hs-identifier hs-var hs-var">mk_ubx_sum_alt</span></a></span></span><span> </span><span id="local-6989586621682745670"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745670"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621682745671"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745671"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682745672"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745672"><span class="hs-identifier hs-var">bndr</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreAlt
forall b. AltCon -&gt; [b] -&gt; Expr b -&gt; Alt b
</span><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745671"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745672"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1388"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; [Type] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreUnboxedSum"><span class="hs-identifier hs-var">mkCoreUnboxedSum</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745657"><span class="hs-identifier hs-var">ubx_sum_arity</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745670"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745660"><span class="hs-identifier hs-var">sum_alt_tys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745672"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1389"></span><span>
</span><span id="line-1390"></span><span>        </span><span class="annot"><a href="#local-6989586621682745669"><span class="hs-identifier hs-var">mk_ubx_sum_alt</span></a></span><span> </span><span id="local-6989586621682745675"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745675"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621682745676"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745676"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621682745677"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745677"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1391"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682745678"><span class="annot"><span class="annottext">tuple :: CoreExpr
</span><a href="#local-6989586621682745678"><span class="hs-identifier hs-var hs-var">tuple</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreUnboxedTuple"><span class="hs-identifier hs-var">mkCoreUnboxedTuple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Id -&gt; CoreExpr) -&gt; [Id] -&gt; [CoreExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745677"><span class="hs-identifier hs-var">bndrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1392"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreAlt
forall b. AltCon -&gt; [b] -&gt; Expr b -&gt; Alt b
</span><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745676"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745677"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; [Type] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreUnboxedSum"><span class="hs-identifier hs-var">mkCoreUnboxedSum</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745657"><span class="hs-identifier hs-var">ubx_sum_arity</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745675"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745660"><span class="hs-identifier hs-var">sum_alt_tys</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745678"><span class="hs-identifier hs-var">tuple</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1393"></span><span>
</span><span id="line-1394"></span><span>        </span><span class="annot"><a href="#local-6989586621682745680"><span class="hs-identifier hs-type">ubx_sum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1395"></span><span>        </span><span id="local-6989586621682745680"><span class="annot"><a href="#local-6989586621682745680"><span class="hs-identifier hs-var hs-var">ubx_sum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1396"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682745681"><span class="annot"><span class="annottext">alts :: [CoreAlt]
</span><a href="#local-6989586621682745681"><span class="hs-identifier hs-var hs-var">alts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; DataCon -&gt; [Id] -&gt; CoreAlt)
-&gt; [Int] -&gt; [DataCon] -&gt; [[Id]] -&gt; [CoreAlt]
forall a b c d. (a -&gt; b -&gt; c -&gt; d) -&gt; [a] -&gt; [b] -&gt; [c] -&gt; [d]
</span><span class="hs-identifier hs-var">zipWith3</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DataCon -&gt; [Id] -&gt; CoreAlt
</span><a href="#local-6989586621682745669"><span class="hs-identifier hs-var">mk_ubx_sum_alt</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745653"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">[[Id]]
</span><a href="#local-6989586621682745667"><span class="hs-identifier hs-var">con_arg_binders</span></a></span><span>
</span><span id="line-1397"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Id -&gt; Type -&gt; [CoreAlt] -&gt; CoreExpr
forall b. Expr b -&gt; b -&gt; Type -&gt; [Alt b] -&gt; Expr b
</span><a href="GHC.Core.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745666"><span class="hs-identifier hs-var">arg_id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745666"><span class="hs-identifier hs-var">arg_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CoreAlt] -&gt; Type
</span><a href="GHC.Core.Utils.html#coreAltsType"><span class="hs-identifier hs-var">coreAltsType</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreAlt]
</span><a href="#local-6989586621682745681"><span class="hs-identifier hs-var">alts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CoreAlt]
</span><a href="#local-6989586621682745681"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-1398"></span><span>
</span><span id="line-1399"></span><span>        </span><span class="annot"><a href="#local-6989586621682745684"><span class="hs-identifier hs-type">unbox_fn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1400"></span><span>        </span><span id="local-6989586621682745684"><span class="annot"><a href="#local-6989586621682745684"><span class="hs-identifier hs-var hs-var">unbox_fn</span></a></span></span><span> </span><span id="local-6989586621682745685"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745685"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1401"></span><span>          </span><span class="annot"><span class="annottext">CoreExpr -&gt; Id -&gt; AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Utils.html#mkSingleAltCase"><span class="hs-identifier hs-var">mkSingleAltCase</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745680"><span class="hs-identifier hs-var">ubx_sum</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745668"><span class="hs-identifier hs-var">ubx_sum_bndr</span></a></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745685"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-1402"></span><span>
</span><span id="line-1403"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682745668"><span class="hs-identifier hs-type">ubx_sum_bndr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682745684"><span class="hs-identifier hs-type">unbox_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1404"></span><span>
</span><span id="line-1405"></span><span>    </span><span class="annot"><a href="#local-6989586621682745656"><span class="hs-identifier hs-type">boxer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#Boxer"><span class="hs-identifier hs-type">Boxer</span></a></span><span>
</span><span id="line-1406"></span><span>    </span><span id="local-6989586621682745656"><span class="annot"><span class="annottext">boxer :: Boxer
</span><a href="#local-6989586621682745656"><span class="hs-identifier hs-var hs-var">boxer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Subst -&gt; UniqSM ([Id], CoreExpr)) -&gt; Boxer
</span><a href="GHC.Types.Id.Make.html#Boxer"><span class="hs-identifier hs-var">Boxer</span></a></span><span> </span><span class="annot"><span class="annottext">((Subst -&gt; UniqSM ([Id], CoreExpr)) -&gt; Boxer)
-&gt; (Subst -&gt; UniqSM ([Id], CoreExpr)) -&gt; Boxer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682745687"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682745687"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1407"></span><span>              </span><span id="local-6989586621682745688"><span class="annot"><a href="#local-6989586621682745688"><span class="hs-identifier hs-var">unboxed_field_id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleName -&gt; Type -&gt; UniqSM Id
</span><a href="#local-6989586621682745664"><span class="hs-identifier hs-var">newLocal'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bx&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Subst -&gt; Type -&gt; Type
Subst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">TcType.substTy</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682745687"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745662"><span class="hs-identifier hs-var">sum_ty_unscaled</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1408"></span><span>              </span><span id="local-6989586621682745689"><span class="annot"><a href="#local-6989586621682745689"><span class="hs-identifier hs-var">tuple_bndrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682745664"><span class="hs-identifier hs-type">newLocal'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-type">fsLit</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;bx&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-type">TcType.substTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745687"><span class="hs-identifier hs-type">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682745660"><span class="hs-identifier hs-type">sum_alt_tys</span></a></span><span>
</span><span id="line-1409"></span><span>
</span><span id="line-1410"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682745690"><span class="annot"><a href="#local-6989586621682745690"><span class="hs-identifier hs-var hs-var">tc_args'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Subst -&gt; [Type] -&gt; [Type]
Subst -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Subst.html#substTys"><span class="hs-identifier hs-var">substTys</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682745687"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745652"><span class="hs-identifier hs-var">tc_args</span></a></span><span>
</span><span id="line-1411"></span><span>                  </span><span id="local-6989586621682745692"><span class="annot"><a href="#local-6989586621682745692"><span class="hs-identifier hs-var hs-var">arg_ty'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Subst -&gt; Type -&gt; Type
Subst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682745687"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745651"><span class="hs-identifier hs-var">arg_ty</span></a></span><span>
</span><span id="line-1412"></span><span>
</span><span id="line-1413"></span><span>              </span><span id="local-6989586621682745693"><span class="annot"><a href="#local-6989586621682745693"><span class="hs-identifier hs-var">con_arg_binders</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1414"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682745664"><span class="hs-identifier hs-type">newLocal'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-type">fsLit</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;bx&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-type">TcType.substTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745687"><span class="hs-identifier hs-type">subst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682745658"><span class="hs-identifier hs-type">src_tys</span></a></span><span>
</span><span id="line-1415"></span><span>
</span><span id="line-1416"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621682745694"><span class="hs-identifier hs-type">mk_sum_alt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a></span><span>
</span><span id="line-1417"></span><span>                  </span><span id="local-6989586621682745694"><span class="annot"><a href="#local-6989586621682745694"><span class="hs-identifier hs-var hs-var">mk_sum_alt</span></a></span></span><span> </span><span id="local-6989586621682745695"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745695"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621682745696"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745696"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682745697"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745697"><span class="hs-identifier hs-var">datacon_bndr</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1418"></span><span>                    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreAlt
forall b. AltCon -&gt; [b] -&gt; Expr b -&gt; Alt b
</span><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; DataCon
</span><a href="GHC.Builtin.Types.html#sumDataCon"><span class="hs-identifier hs-var">sumDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745695"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745657"><span class="hs-identifier hs-var">ubx_sum_arity</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745697"><span class="hs-identifier hs-var">datacon_bndr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1419"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; Id
</span><a href="GHC.Core.DataCon.html#dataConWorkId"><span class="hs-identifier hs-var">dataConWorkId</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745696"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; [Type] -&gt; CoreExpr
forall b. Expr b -&gt; [Type] -&gt; Expr b
</span><a href="GHC.Core.html#mkTyApps"><span class="hs-operator hs-var">`mkTyApps`</span></a></span><span>  </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745690"><span class="hs-identifier hs-var">tc_args'</span></a></span><span>
</span><span id="line-1420"></span><span>                                              </span><span class="annot"><span class="annottext">CoreExpr -&gt; [Id] -&gt; CoreExpr
forall b. Expr b -&gt; [Id] -&gt; Expr b
</span><a href="GHC.Core.html#mkVarApps"><span class="hs-operator hs-var">`mkVarApps`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745697"><span class="hs-identifier hs-var">datacon_bndr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1421"></span><span>
</span><span id="line-1422"></span><span>                  </span><span class="annot"><a href="#local-6989586621682745694"><span class="hs-identifier hs-var">mk_sum_alt</span></a></span><span> </span><span id="local-6989586621682745699"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745699"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621682745700"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745700"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621682745701"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745701"><span class="hs-identifier hs-var">tuple_bndr</span></a></span></span><span> </span><span id="local-6989586621682745702"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745702"><span class="hs-identifier hs-var">datacon_bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1423"></span><span>                    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreAlt
forall b. AltCon -&gt; [b] -&gt; Expr b -&gt; Alt b
</span><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; DataCon
</span><a href="GHC.Builtin.Types.html#sumDataCon"><span class="hs-identifier hs-var">sumDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745699"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745657"><span class="hs-identifier hs-var">ubx_sum_arity</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745701"><span class="hs-identifier hs-var">tuple_bndr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-1424"></span><span>                      </span><span class="annot"><span class="annottext">CoreExpr -&gt; Id -&gt; Type -&gt; [CoreAlt] -&gt; CoreExpr
forall b. Expr b -&gt; b -&gt; Type -&gt; [Alt b] -&gt; Expr b
</span><a href="GHC.Core.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745701"><span class="hs-identifier hs-var">tuple_bndr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745701"><span class="hs-identifier hs-var">tuple_bndr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745692"><span class="hs-identifier hs-var">arg_ty'</span></a></span><span>
</span><span id="line-1425"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreAlt
forall b. AltCon -&gt; [b] -&gt; Expr b -&gt; Alt b
</span><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Boxity -&gt; Int -&gt; DataCon
</span><a href="GHC.Builtin.Types.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Boxity
</span><a href="Language.Haskell.Syntax.Basic.html#Unboxed"><span class="hs-identifier hs-var">Unboxed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745702"><span class="hs-identifier hs-var">datacon_bndrs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745702"><span class="hs-identifier hs-var">datacon_bndrs</span></a></span><span>
</span><span id="line-1426"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; Id
</span><a href="GHC.Core.DataCon.html#dataConWorkId"><span class="hs-identifier hs-var">dataConWorkId</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745700"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; [Type] -&gt; CoreExpr
forall b. Expr b -&gt; [Type] -&gt; Expr b
</span><a href="GHC.Core.html#mkTyApps"><span class="hs-operator hs-var">`mkTyApps`</span></a></span><span>  </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745690"><span class="hs-identifier hs-var">tc_args'</span></a></span><span>
</span><span id="line-1427"></span><span>                                                    </span><span class="annot"><span class="annottext">CoreExpr -&gt; [Id] -&gt; CoreExpr
forall b. Expr b -&gt; [Id] -&gt; Expr b
</span><a href="GHC.Core.html#mkVarApps"><span class="hs-operator hs-var">`mkVarApps`</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745702"><span class="hs-identifier hs-var">datacon_bndrs</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1428"></span><span>
</span><span id="line-1429"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682745688"><span class="hs-identifier hs-type">unboxed_field_id</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-1430"></span><span>                       </span><span class="annot"><a href="GHC.Core.html#Case"><span class="hs-identifier hs-type">Case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745688"><span class="hs-identifier hs-type">unboxed_field_id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682745688"><span class="hs-identifier hs-type">unboxed_field_id</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745692"><span class="hs-identifier hs-type">arg_ty'</span></a></span><span>
</span><span id="line-1431"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">zipWith4</span></span><span> </span><span class="annot"><a href="#local-6989586621682745694"><span class="hs-identifier hs-type">mk_sum_alt</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621682745653"><span class="hs-identifier hs-type">cons</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745689"><span class="hs-identifier hs-type">tuple_bndrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682745693"><span class="hs-identifier hs-type">con_arg_binders</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1432"></span><span>
</span><span id="line-1433"></span><span class="hs-comment">-- | Every alternative of an unboxed sum has exactly one field, and we use</span><span>
</span><span id="line-1434"></span><span class="hs-comment">-- unboxed tuples when we need more than one field. This generates an unboxed</span><span>
</span><span id="line-1435"></span><span class="hs-comment">-- tuple when necessary, to be used in unboxed sum alts.</span><span>
</span><span id="line-1436"></span><span class="annot"><a href="GHC.Types.Id.Make.html#mkUbxSumAltTy"><span class="hs-identifier hs-type">mkUbxSumAltTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1437"></span><span id="mkUbxSumAltTy"><span class="annot"><span class="annottext">mkUbxSumAltTy :: [Type] -&gt; Type
</span><a href="GHC.Types.Id.Make.html#mkUbxSumAltTy"><span class="hs-identifier hs-var hs-var">mkUbxSumAltTy</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682745704"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745704"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745704"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1438"></span><span class="annot"><a href="GHC.Types.Id.Make.html#mkUbxSumAltTy"><span class="hs-identifier hs-var">mkUbxSumAltTy</span></a></span><span> </span><span id="local-6989586621682745705"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745705"><span class="hs-identifier hs-var">tys</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Boxity -&gt; [Type] -&gt; Type
</span><a href="GHC.Builtin.Types.html#mkTupleTy"><span class="hs-identifier hs-var">mkTupleTy</span></a></span><span> </span><span class="annot"><span class="annottext">Boxity
</span><a href="Language.Haskell.Syntax.Basic.html#Unboxed"><span class="hs-identifier hs-var">Unboxed</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745705"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1439"></span><span>
</span><span id="line-1440"></span><span class="annot"><a href="GHC.Types.Id.Make.html#shouldUnpackArgTy"><span class="hs-identifier hs-type">shouldUnpackArgTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#BangOpts"><span class="hs-identifier hs-type">BangOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#SrcUnpackedness"><span class="hs-identifier hs-type">SrcUnpackedness</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1441"></span><span class="hs-comment">-- True if we ought to unpack the UNPACK the argument type</span><span>
</span><span id="line-1442"></span><span class="hs-comment">-- See Note [Recursive unboxing]</span><span>
</span><span id="line-1443"></span><span class="hs-comment">-- We look &quot;deeply&quot; inside rather than relying on the DataCons</span><span>
</span><span id="line-1444"></span><span class="hs-comment">-- we encounter on the way, because otherwise we might well</span><span>
</span><span id="line-1445"></span><span class="hs-comment">-- end up relying on ourselves!</span><span>
</span><span id="line-1446"></span><span id="shouldUnpackArgTy"><span class="annot"><span class="annottext">shouldUnpackArgTy :: BangOpts -&gt; SrcUnpackedness -&gt; FamInstEnvs -&gt; Scaled Type -&gt; Bool
</span><a href="GHC.Types.Id.Make.html#shouldUnpackArgTy"><span class="hs-identifier hs-var hs-var">shouldUnpackArgTy</span></a></span></span><span> </span><span id="local-6989586621682745707"><span class="annot"><span class="annottext">BangOpts
</span><a href="#local-6989586621682745707"><span class="hs-identifier hs-var">bang_opts</span></a></span></span><span> </span><span id="local-6989586621682745708"><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="#local-6989586621682745708"><span class="hs-identifier hs-var">prag</span></a></span></span><span> </span><span id="local-6989586621682745709"><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621682745709"><span class="hs-identifier hs-var">fam_envs</span></a></span></span><span> </span><span id="local-6989586621682745710"><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745710"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span>
</span><span id="line-1447"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682745711"><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745711"><span class="hs-identifier hs-var">data_cons</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe [DataCon]
</span><a href="GHC.Types.Id.Make.html#unpackable_type_datacons"><span class="hs-identifier hs-var">unpackable_type_datacons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scaled Type -&gt; Type
forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745710"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1448"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(DataCon -&gt; Bool) -&gt; [DataCon] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="#local-6989586621682745714"><span class="hs-identifier hs-var">ok_con</span></a></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745711"><span class="hs-identifier hs-var">data_cons</span></a></span><span>                </span><span class="hs-comment">-- Returns True only if we can't get a</span><span>
</span><span id="line-1449"></span><span>                                        </span><span class="hs-comment">-- loop involving these data cons</span><span>
</span><span id="line-1450"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SrcUnpackedness -&gt; Scaled Type -&gt; [DataCon] -&gt; Bool
</span><a href="#local-6989586621682745715"><span class="hs-identifier hs-var">should_unpack</span></a></span><span> </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="#local-6989586621682745708"><span class="hs-identifier hs-var">prag</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745710"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745711"><span class="hs-identifier hs-var">data_cons</span></a></span><span> </span><span class="hs-comment">-- ...hence the call to dataConArgUnpack in</span><span>
</span><span id="line-1451"></span><span>                                        </span><span class="hs-comment">--    should_unpack won't loop</span><span>
</span><span id="line-1452"></span><span>       </span><span class="hs-comment">-- See Wrinkle (W1b) of Note [Recursive unboxing] for this loopy stuff</span><span>
</span><span id="line-1453"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1454"></span><span>
</span><span id="line-1455"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1456"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1457"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1458"></span><span>    </span><span class="annot"><a href="#local-6989586621682745714"><span class="hs-identifier hs-type">ok_con</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>      </span><span class="hs-comment">-- True &lt;=&gt; OK to unpack</span><span>
</span><span id="line-1459"></span><span>    </span><span id="local-6989586621682745714"><span class="annot"><span class="annottext">ok_con :: DataCon -&gt; Bool
</span><a href="#local-6989586621682745714"><span class="hs-identifier hs-var hs-var">ok_con</span></a></span></span><span> </span><span id="local-6989586621682745716"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745716"><span class="hs-identifier hs-var">top_con</span></a></span></span><span>                 </span><span class="hs-comment">-- False &lt;=&gt; not safe</span><span>
</span><span id="line-1460"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameSet -&gt; DataCon -&gt; Bool
</span><a href="#local-6989586621682745717"><span class="hs-identifier hs-var">ok_args</span></a></span><span> </span><span class="annot"><span class="annottext">NameSet
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745716"><span class="hs-identifier hs-var">top_con</span></a></span><span>
</span><span id="line-1461"></span><span>       </span><span class="hs-keyword">where</span><span>
</span><span id="line-1462"></span><span>         </span><span id="local-6989586621682745719"><span class="annot"><span class="annottext">top_con_name :: Name
</span><a href="#local-6989586621682745719"><span class="hs-identifier hs-var hs-var">top_con_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Name
forall a. NamedThing a =&gt; a -&gt; Name
</span><a href="GHC.Types.Name.html#getName"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745716"><span class="hs-identifier hs-var">top_con</span></a></span><span>
</span><span id="line-1463"></span><span>
</span><span id="line-1464"></span><span>         </span><span id="local-6989586621682745717"><span class="annot"><span class="annottext">ok_args :: NameSet -&gt; DataCon -&gt; Bool
</span><a href="#local-6989586621682745717"><span class="hs-identifier hs-var hs-var">ok_args</span></a></span></span><span> </span><span id="local-6989586621682745721"><span class="annot"><span class="annottext">NameSet
</span><a href="#local-6989586621682745721"><span class="hs-identifier hs-var">dcs</span></a></span></span><span> </span><span id="local-6989586621682745722"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745722"><span class="hs-identifier hs-var">con</span></a></span></span><span>
</span><span id="line-1465"></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Scaled Type, HsSrcBang) -&gt; Bool)
-&gt; [(Scaled Type, HsSrcBang)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameSet -&gt; (Scaled Type, HsSrcBang) -&gt; Bool
</span><a href="#local-6989586621682745723"><span class="hs-identifier hs-var">ok_arg</span></a></span><span> </span><span class="annot"><span class="annottext">NameSet
</span><a href="#local-6989586621682745721"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Scaled Type, HsSrcBang)] -&gt; Bool)
-&gt; [(Scaled Type, HsSrcBang)] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1466"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; [Scaled Type]
</span><a href="GHC.Core.DataCon.html#dataConOrigArgTys"><span class="hs-identifier hs-var">dataConOrigArgTys</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745722"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled Type] -&gt; [HsSrcBang] -&gt; [(Scaled Type, HsSrcBang)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-operator hs-var">`zip`</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [HsSrcBang]
</span><a href="GHC.Core.DataCon.html#dataConSrcBangs"><span class="hs-identifier hs-var">dataConSrcBangs</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745722"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1467"></span><span>             </span><span class="hs-comment">-- NB: dataConSrcBangs gives the *user* request;</span><span>
</span><span id="line-1468"></span><span>             </span><span class="hs-comment">-- We'd get a black hole if we used dataConImplBangs</span><span>
</span><span id="line-1469"></span><span>
</span><span id="line-1470"></span><span>         </span><span class="annot"><a href="#local-6989586621682745723"><span class="hs-identifier hs-type">ok_arg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#HsSrcBang"><span class="hs-identifier hs-type">HsSrcBang</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1471"></span><span>         </span><span id="local-6989586621682745723"><span class="annot"><span class="annottext">ok_arg :: NameSet -&gt; (Scaled Type, HsSrcBang) -&gt; Bool
</span><a href="#local-6989586621682745723"><span class="hs-identifier hs-var hs-var">ok_arg</span></a></span></span><span> </span><span id="local-6989586621682745725"><span class="annot"><span class="annottext">NameSet
</span><a href="#local-6989586621682745725"><span class="hs-identifier hs-var">dcs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682745726"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745726"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#HsSrcBang"><span class="hs-identifier hs-type">HsSrcBang</span></a></span><span> </span><span class="annot"><span class="annottext">SourceText
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#HsBang"><span class="hs-identifier hs-type">HsBang</span></a></span><span> </span><span id="local-6989586621682745727"><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="#local-6989586621682745727"><span class="hs-identifier hs-var">unpack_prag</span></a></span></span><span> </span><span id="local-6989586621682745728"><span class="annot"><span class="annottext">SrcStrictness
</span><a href="#local-6989586621682745728"><span class="hs-identifier hs-var">str_prag</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1472"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">SrcStrictness -&gt; Bool
</span><a href="#local-6989586621682745729"><span class="hs-identifier hs-var">strict_field</span></a></span><span> </span><span class="annot"><span class="annottext">SrcStrictness
</span><a href="#local-6989586621682745728"><span class="hs-identifier hs-var">str_prag</span></a></span><span>
</span><span id="line-1473"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682745730"><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745730"><span class="hs-identifier hs-var">data_cons</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe [DataCon]
</span><a href="GHC.Types.Id.Make.html#unpackable_type_datacons"><span class="hs-identifier hs-var">unpackable_type_datacons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FamInstEnvs -&gt; Type -&gt; Type
</span><a href="GHC.Core.FamInstEnv.html#topNormaliseType"><span class="hs-identifier hs-var">topNormaliseType</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621682745709"><span class="hs-identifier hs-var">fam_envs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745726"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1474"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SrcUnpackedness -&gt; [DataCon] -&gt; Bool
</span><a href="#local-6989586621682745732"><span class="hs-identifier hs-var">should_unpack_conservative</span></a></span><span> </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="#local-6989586621682745727"><span class="hs-identifier hs-var">unpack_prag</span></a></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745730"><span class="hs-identifier hs-var">data_cons</span></a></span><span>  </span><span class="hs-comment">-- Wrinkle (W3)</span><span>
</span><span id="line-1475"></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DataCon -&gt; Bool) -&gt; [DataCon] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameSet -&gt; DataCon -&gt; Bool
</span><a href="#local-6989586621682745733"><span class="hs-identifier hs-var">ok_rec_con</span></a></span><span> </span><span class="annot"><span class="annottext">NameSet
</span><a href="#local-6989586621682745725"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745730"><span class="hs-identifier hs-var">data_cons</span></a></span><span>                    </span><span class="hs-comment">--  of Note [Recursive unboxing]</span><span>
</span><span id="line-1476"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1477"></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>        </span><span class="hs-comment">-- NB True here, in contrast to False at top level</span><span>
</span><span id="line-1478"></span><span>
</span><span id="line-1479"></span><span>         </span><span class="hs-comment">-- See Note [Recursive unboxing]</span><span>
</span><span id="line-1480"></span><span>         </span><span class="hs-comment">--   * Do not look at the HsImplBangs to `con`; see Wrinkle (W1a)</span><span>
</span><span id="line-1481"></span><span>         </span><span class="hs-comment">--   * For the &quot;at the root&quot; comments see Wrinkle (W2)</span><span>
</span><span id="line-1482"></span><span>         </span><span id="local-6989586621682745733"><span class="annot"><span class="annottext">ok_rec_con :: NameSet -&gt; DataCon -&gt; Bool
</span><a href="#local-6989586621682745733"><span class="hs-identifier hs-var hs-var">ok_rec_con</span></a></span></span><span> </span><span id="local-6989586621682745734"><span class="annot"><span class="annottext">NameSet
</span><a href="#local-6989586621682745734"><span class="hs-identifier hs-var">dcs</span></a></span></span><span> </span><span id="local-6989586621682745735"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745735"><span class="hs-identifier hs-var">con</span></a></span></span><span>
</span><span id="line-1483"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745736"><span class="hs-identifier hs-var">dc_name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745719"><span class="hs-identifier hs-var">top_con_name</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>  </span><span class="hs-comment">-- Recursion at the root</span><span>
</span><span id="line-1484"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745736"><span class="hs-identifier hs-var">dc_name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; NameSet -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#elemNameSet"><span class="hs-operator hs-var">`elemNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">NameSet
</span><a href="#local-6989586621682745734"><span class="hs-identifier hs-var">dcs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>   </span><span class="hs-comment">-- Not at the root</span><span>
</span><span id="line-1485"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameSet -&gt; DataCon -&gt; Bool
</span><a href="#local-6989586621682745717"><span class="hs-identifier hs-var">ok_args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameSet
</span><a href="#local-6989586621682745734"><span class="hs-identifier hs-var">dcs</span></a></span><span> </span><span class="annot"><span class="annottext">NameSet -&gt; Name -&gt; NameSet
</span><a href="GHC.Types.Name.Set.html#extendNameSet"><span class="hs-operator hs-var">`extendNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745736"><span class="hs-identifier hs-var">dc_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745735"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-1486"></span><span>           </span><span class="hs-keyword">where</span><span>
</span><span id="line-1487"></span><span>             </span><span id="local-6989586621682745736"><span class="annot"><span class="annottext">dc_name :: Name
</span><a href="#local-6989586621682745736"><span class="hs-identifier hs-var hs-var">dc_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Name
forall a. NamedThing a =&gt; a -&gt; Name
</span><a href="GHC.Types.Name.html#getName"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682745735"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-1488"></span><span>
</span><span id="line-1489"></span><span>    </span><span class="annot"><a href="#local-6989586621682745729"><span class="hs-identifier hs-type">strict_field</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#SrcStrictness"><span class="hs-identifier hs-type">SrcStrictness</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1490"></span><span>    </span><span class="hs-comment">-- True &lt;=&gt; strict field</span><span>
</span><span id="line-1491"></span><span>    </span><span id="local-6989586621682745729"><span class="annot"><span class="annottext">strict_field :: SrcStrictness -&gt; Bool
</span><a href="#local-6989586621682745729"><span class="hs-identifier hs-var hs-var">strict_field</span></a></span></span><span> </span><span class="annot"><span class="annottext">SrcStrictness
</span><a href="Language.Haskell.Syntax.Basic.html#NoSrcStrict"><span class="hs-identifier hs-var">NoSrcStrict</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BangOpts -&gt; Bool
</span><a href="GHC.Types.Id.Make.html#bang_opt_strict_data"><span class="hs-identifier hs-var">bang_opt_strict_data</span></a></span><span> </span><span class="annot"><span class="annottext">BangOpts
</span><a href="#local-6989586621682745707"><span class="hs-identifier hs-var">bang_opts</span></a></span><span>
</span><span id="line-1492"></span><span>    </span><span class="annot"><a href="#local-6989586621682745729"><span class="hs-identifier hs-var">strict_field</span></a></span><span> </span><span class="annot"><span class="annottext">SrcStrictness
</span><a href="Language.Haskell.Syntax.Basic.html#SrcStrict"><span class="hs-identifier hs-var">SrcStrict</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1493"></span><span>    </span><span class="annot"><a href="#local-6989586621682745729"><span class="hs-identifier hs-var">strict_field</span></a></span><span> </span><span class="annot"><span class="annottext">SrcStrictness
</span><a href="Language.Haskell.Syntax.Basic.html#SrcLazy"><span class="hs-identifier hs-var">SrcLazy</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1494"></span><span>
</span><span id="line-1495"></span><span>    </span><span class="hs-comment">-- Determine whether we ought to unpack a field,</span><span>
</span><span id="line-1496"></span><span>    </span><span class="hs-comment">-- based on user annotations if present.</span><span>
</span><span id="line-1497"></span><span>    </span><span class="hs-comment">-- A conservative version of should_unpack that doesn't look at how</span><span>
</span><span id="line-1498"></span><span>    </span><span class="hs-comment">-- many fields the field would unpack to... because that leads to a loop.</span><span>
</span><span id="line-1499"></span><span>    </span><span class="hs-comment">-- &quot;Conservative&quot; = err on the side of saying &quot;yes&quot;.</span><span>
</span><span id="line-1500"></span><span>    </span><span class="annot"><a href="#local-6989586621682745732"><span class="hs-identifier hs-type">should_unpack_conservative</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#SrcUnpackedness"><span class="hs-identifier hs-type">SrcUnpackedness</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1501"></span><span>    </span><span id="local-6989586621682745732"><span class="annot"><span class="annottext">should_unpack_conservative :: SrcUnpackedness -&gt; [DataCon] -&gt; Bool
</span><a href="#local-6989586621682745732"><span class="hs-identifier hs-var hs-var">should_unpack_conservative</span></a></span></span><span> </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="Language.Haskell.Syntax.Basic.html#SrcNoUnpack"><span class="hs-identifier hs-var">SrcNoUnpack</span></a></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>  </span><span class="hs-comment">-- {-# NOUNPACK #-}</span><span>
</span><span id="line-1502"></span><span>    </span><span class="annot"><a href="#local-6989586621682745732"><span class="hs-identifier hs-var">should_unpack_conservative</span></a></span><span> </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="Language.Haskell.Syntax.Basic.html#SrcUnpack"><span class="hs-identifier hs-var">SrcUnpack</span></a></span><span>   </span><span class="annot"><span class="annottext">[DataCon]
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>   </span><span class="hs-comment">-- {-# NOUNPACK #-}</span><span>
</span><span id="line-1503"></span><span>    </span><span class="annot"><a href="#local-6989586621682745732"><span class="hs-identifier hs-var">should_unpack_conservative</span></a></span><span> </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="Language.Haskell.Syntax.Basic.html#NoSrcUnpack"><span class="hs-identifier hs-var">NoSrcUnpack</span></a></span><span> </span><span id="local-6989586621682745742"><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745742"><span class="hs-identifier hs-var">dcs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DataCon] -&gt; Bool
</span><a href="#local-6989586621682745743"><span class="hs-identifier hs-var">is_sum</span></a></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745742"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1504"></span><span>        </span><span class="hs-comment">-- is_sum: we never unpack sums without a pragma; otherwise be conservative</span><span>
</span><span id="line-1505"></span><span>
</span><span id="line-1506"></span><span>    </span><span class="hs-comment">-- Determine whether we ought to unpack a field,</span><span>
</span><span id="line-1507"></span><span>    </span><span class="hs-comment">-- based on user annotations if present, and heuristics if not.</span><span>
</span><span id="line-1508"></span><span>    </span><span class="annot"><a href="#local-6989586621682745715"><span class="hs-identifier hs-type">should_unpack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#SrcUnpackedness"><span class="hs-identifier hs-type">SrcUnpackedness</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1509"></span><span>    </span><span id="local-6989586621682745715"><span class="annot"><span class="annottext">should_unpack :: SrcUnpackedness -&gt; Scaled Type -&gt; [DataCon] -&gt; Bool
</span><a href="#local-6989586621682745715"><span class="hs-identifier hs-var hs-var">should_unpack</span></a></span></span><span> </span><span id="local-6989586621682745744"><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="#local-6989586621682745744"><span class="hs-identifier hs-var">prag</span></a></span></span><span> </span><span id="local-6989586621682745745"><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745745"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span> </span><span id="local-6989586621682745746"><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745746"><span class="hs-identifier hs-var">data_cons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1510"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="#local-6989586621682745744"><span class="hs-identifier hs-var">prag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1511"></span><span>        </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="Language.Haskell.Syntax.Basic.html#SrcNoUnpack"><span class="hs-identifier hs-var">SrcNoUnpack</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-comment">-- {-# NOUNPACK #-}</span><span>
</span><span id="line-1512"></span><span>        </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="Language.Haskell.Syntax.Basic.html#SrcUnpack"><span class="hs-identifier hs-var">SrcUnpack</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-comment">-- {-# UNPACK #-}</span><span>
</span><span id="line-1513"></span><span>        </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><a href="Language.Haskell.Syntax.Basic.html#NoSrcUnpack"><span class="hs-identifier hs-var">NoSrcUnpack</span></a></span><span> </span><span class="hs-comment">-- No explicit unpack pragma, so use heuristics</span><span>
</span><span id="line-1514"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[DataCon] -&gt; Bool
</span><a href="#local-6989586621682745743"><span class="hs-identifier hs-var">is_sum</span></a></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745746"><span class="hs-identifier hs-var">data_cons</span></a></span><span>
</span><span id="line-1515"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-comment">-- Don't unpack sum types automatically, but they can</span><span>
</span><span id="line-1516"></span><span>                   </span><span class="hs-comment">-- be unpacked with an explicit source UNPACK.</span><span>
</span><span id="line-1517"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-comment">-- Wrinkle (W4) of Note [Recursive unboxing]</span><span>
</span><span id="line-1518"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BangOpts -&gt; Bool
</span><a href="GHC.Types.Id.Make.html#bang_opt_unbox_strict"><span class="hs-identifier hs-var">bang_opt_unbox_strict</span></a></span><span> </span><span class="annot"><span class="annottext">BangOpts
</span><a href="#local-6989586621682745707"><span class="hs-identifier hs-var">bang_opts</span></a></span><span>
</span><span id="line-1519"></span><span>             </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BangOpts -&gt; Bool
</span><a href="GHC.Types.Id.Make.html#bang_opt_unbox_small"><span class="hs-identifier hs-var">bang_opt_unbox_small</span></a></span><span> </span><span class="annot"><span class="annottext">BangOpts
</span><a href="#local-6989586621682745707"><span class="hs-identifier hs-var">bang_opts</span></a></span><span>
</span><span id="line-1520"></span><span>                 </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682745747"><span class="hs-identifier hs-var">is_small_rep</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- See Note [Unpack one-wide fields]</span><span>
</span><span id="line-1521"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1522"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682745748"><span class="annot"><span class="annottext">[(Scaled Type, StrictnessMark)]
</span><a href="#local-6989586621682745748"><span class="hs-identifier hs-var">rep_tys</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Unboxer, Boxer)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scaled Type -&gt; ([(Scaled Type, StrictnessMark)], (Unboxer, Boxer))
</span><a href="GHC.Types.Id.Make.html#dataConArgUnpack"><span class="hs-identifier hs-var">dataConArgUnpack</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621682745745"><span class="hs-identifier hs-var">arg_ty</span></a></span><span>
</span><span id="line-1523"></span><span>
</span><span id="line-1524"></span><span>        </span><span class="hs-comment">-- Takes in the list of reps used to represent the dataCon after it's unpacked</span><span>
</span><span id="line-1525"></span><span>        </span><span class="hs-comment">-- and tells us if they can fit into 8 bytes. See Note [Unpack one-wide fields]</span><span>
</span><span id="line-1526"></span><span>        </span><span id="local-6989586621682745747"><span class="annot"><span class="annottext">is_small_rep :: Bool
</span><a href="#local-6989586621682745747"><span class="hs-identifier hs-var hs-var">is_small_rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1527"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- Neccesary to look through unboxed tuples.</span><span>
</span><span id="line-1528"></span><span>              </span><span id="local-6989586621682745749"><span class="annot"><span class="annottext">prim_reps :: [PrimRep]
</span><a href="#local-6989586621682745749"><span class="hs-identifier hs-var hs-var">prim_reps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Scaled Type, StrictnessMark) -&gt; [PrimRep])
-&gt; [(Scaled Type, StrictnessMark)] -&gt; [PrimRep]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; [PrimRep]
Type -&gt; [PrimRep]
</span><a href="GHC.Types.RepType.html#typePrimRep"><span class="hs-identifier hs-var">typePrimRep</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; [PrimRep])
-&gt; ((Scaled Type, StrictnessMark) -&gt; Type)
-&gt; (Scaled Type, StrictnessMark)
-&gt; [PrimRep]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Scaled Type -&gt; Type
forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span> </span><span class="annot"><span class="annottext">(Scaled Type -&gt; Type)
-&gt; ((Scaled Type, StrictnessMark) -&gt; Scaled Type)
-&gt; (Scaled Type, StrictnessMark)
-&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Scaled Type, StrictnessMark) -&gt; Scaled Type
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Scaled Type, StrictnessMark)] -&gt; [PrimRep])
-&gt; [(Scaled Type, StrictnessMark)] -&gt; [PrimRep]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Scaled Type, StrictnessMark)]
</span><a href="#local-6989586621682745748"><span class="hs-identifier hs-var">rep_tys</span></a></span><span>
</span><span id="line-1529"></span><span>              </span><span class="hs-comment">-- And then get the actual size of the unpacked constructor.</span><span>
</span><span id="line-1530"></span><span>              </span><span id="local-6989586621682745752"><span class="annot"><span class="annottext">rep_size :: Int
</span><a href="#local-6989586621682745752"><span class="hs-identifier hs-var hs-var">rep_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; [Int] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PrimRep -&gt; Int) -&gt; [PrimRep] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PrimRep -&gt; Int
</span><a href="GHC.Core.TyCon.html#primRepSizeW64_B"><span class="hs-identifier hs-var">primRepSizeW64_B</span></a></span><span> </span><span class="annot"><span class="annottext">[PrimRep]
</span><a href="#local-6989586621682745749"><span class="hs-identifier hs-var">prim_reps</span></a></span><span>
</span><span id="line-1531"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745752"><span class="hs-identifier hs-var">rep_size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-1532"></span><span>
</span><span id="line-1533"></span><span>    </span><span class="annot"><a href="#local-6989586621682745743"><span class="hs-identifier hs-type">is_sum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1534"></span><span>    </span><span class="hs-comment">-- We never unpack sum types automatically</span><span>
</span><span id="line-1535"></span><span>    </span><span class="hs-comment">-- (Product types, we do. Empty types are weeded out by unpackable_type_datacons.)</span><span>
</span><span id="line-1536"></span><span>    </span><span id="local-6989586621682745743"><span class="annot"><span class="annottext">is_sum :: [DataCon] -&gt; Bool
</span><a href="#local-6989586621682745743"><span class="hs-identifier hs-var hs-var">is_sum</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">DataCon
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[DataCon]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1537"></span><span>    </span><span class="annot"><a href="#local-6989586621682745743"><span class="hs-identifier hs-var">is_sum</span></a></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1538"></span><span>
</span><span id="line-1539"></span><span>
</span><span id="line-1540"></span><span>
</span><span id="line-1541"></span><span class="hs-comment">-- Given a type already assumed to have been normalized by topNormaliseType,</span><span>
</span><span id="line-1542"></span><span class="hs-comment">-- unpackable_type_datacons ty = Just datacons</span><span>
</span><span id="line-1543"></span><span class="hs-comment">-- iff ty is of the form</span><span>
</span><span id="line-1544"></span><span class="hs-comment">--     T ty1 .. tyn</span><span>
</span><span id="line-1545"></span><span class="hs-comment">-- and T is an algebraic data type (not newtype), in which no data</span><span>
</span><span id="line-1546"></span><span class="hs-comment">-- constructors have existentials, and datacons is the list of data</span><span>
</span><span id="line-1547"></span><span class="hs-comment">-- constructors of T.</span><span>
</span><span id="line-1548"></span><span class="annot"><a href="GHC.Types.Id.Make.html#unpackable_type_datacons"><span class="hs-identifier hs-type">unpackable_type_datacons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1549"></span><span id="unpackable_type_datacons"><span class="annot"><span class="annottext">unpackable_type_datacons :: Type -&gt; Maybe [DataCon]
</span><a href="GHC.Types.Id.Make.html#unpackable_type_datacons"><span class="hs-identifier hs-var hs-var">unpackable_type_datacons</span></a></span></span><span> </span><span id="local-6989586621682745756"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745756"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1550"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682745757"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745757"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745756"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1551"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745757"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Even though `ty` has been normalised, it could still</span><span>
</span><span id="line-1552"></span><span>                         </span><span class="hs-comment">-- be a /recursive/ newtype, so we must check for that</span><span>
</span><span id="line-1553"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682745758"><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745758"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe [DataCon]
</span><a href="GHC.Core.TyCon.html#tyConDataCons_maybe"><span class="hs-identifier hs-var">tyConDataCons_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745757"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1554"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DataCon] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745758"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- Don't upack nullary sums; no need.</span><span>
</span><span id="line-1555"></span><span>                         </span><span class="hs-comment">-- They already take zero bits</span><span>
</span><span id="line-1556"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(DataCon -&gt; Bool) -&gt; [DataCon] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">([Id] -&gt; Bool) -&gt; (DataCon -&gt; [Id]) -&gt; DataCon -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [Id]
</span><a href="GHC.Core.DataCon.html#dataConExTyCoVars"><span class="hs-identifier hs-var">dataConExTyCoVars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745758"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-1557"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DataCon] -&gt; Maybe [DataCon]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682745758"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="hs-comment">-- See Note [Unpacking GADTs and existentials]</span><span>
</span><span id="line-1558"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1559"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [DataCon]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1560"></span><span>
</span><span id="line-1561"></span><span class="hs-comment">{-
Note [Unpacking GADTs and existentials]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
There is nothing stopping us unpacking a data type with equality
components, like
  data Equal a b where
    Equal :: Equal a a

And it'd be fine to unpack a product type with existential components
too, but that would require a bit more plumbing, so currently we don't.

So for now we require: null (dataConExTyCoVars data_con)
See #14978

Note [Unpack one-wide fields]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The flag UnboxSmallStrictFields ensures that any field that can
(safely) be unboxed to a word-sized unboxed field, should be so unboxed.
For example:

    data A = A Int#
    newtype B = B A
    data C = C !B
    data D = D !C
    data E = E !()
    data F = F !D
    data G = G !F !F

All of these should have an Int# as their representation, except
G which should have two Int#s.

However

    data T = T !(S Int)
    data S = S !a

Here we can represent T with an Int#.

Special care has to be taken to make sure we don't mistake fields with unboxed
tuple/sum rep or very large reps. See #22309

For consistency we unpack anything that fits into 8 bytes on a 64-bit platform,
even when compiling for 32bit platforms. This way unpacking decisions will be the
same for 32bit and 64bit systems. To do so we use primRepSizeW64_B instead of
primRepSizeB. See also the tests in test case T22309.

Note [Recursive unboxing]
~~~~~~~~~~~~~~~~~~~~~~~~~
Consider
  data R = MkR {-# UNPACK #-} !S Int
  data S = MkS {-# UNPACK #-} !Int
The representation arguments of MkR are the *representation* arguments
of S (plus Int); the rep args of MkS are Int#.  This is all fine.

But be careful not to try to unbox this!
        data T = MkT {-# UNPACK #-} !T Int
Because then we'd get an infinite number of arguments.

Note that it's the *argument* type that matters. This is fine:
        data S = MkS S !Int
because Int is non-recursive.

Wrinkles:

(W1a) We have to be careful that the compiler doesn't go into a loop!
      First, we must not look at the HsImplBang decisions of data constructors
      in the same mutually recursive group.  E.g.
         data S = MkS {-# UNPACK #-} !T Int
         data T = MkT {-# UNPACK #-} !S Int
      Each of S and T must decide /independently/ whether to unpack
      and they had better not both say yes. So they must both say no.
      (We could detect when we leave the group, and /then/ we can rely on
      HsImplBangs; but that requires more plumbing.)

(W1b) Here is another way the compiler might go into a loop (test T23307b):
         data data T = MkT !S Int
         data S = MkS !T
     Suppose we call `shouldUnpackArgTy` on the !S arg of `T`.  In `should_unpack`
     we ask if the number of fields that `MkS` unpacks to is small enough
     (via rep_tys `lengthAtMost` 1).  But how many field /does/ `MkS` unpack
     to?  Well it depends on the unpacking decision we make for `MkS`, which
     in turn depends on `MkT`, which we are busy deciding. Black holes beckon.

     So we /first/ call `ok_con` on `MkS` (and `ok_con` is conservative;
     see `should_unpack_conservative`), and only /then/ call `should_unpack`.
     Tricky!

(W2) As #23307 shows,  we /do/ want to unpack the second arg of the Yes
     data constructor in this example, despite the recursion in List:
       data Stream a   = Cons a !(Stream a)
       data Unconsed a = Unconsed a !(Stream a)
       data MUnconsed a = No | Yes {-# UNPACK #-} !(Unconsed a)
     When looking at
       {-# UNPACK #-} (Unconsed a)
     we can take Unconsed apart, but then get into a loop with Stream.
     That's fine: we can still take Unconsed apart.  It's only if we
     have a loop /at the root/ that we must not unpack.

(W3) Moreover (W2) can apply even if there is a recursive loop:
       data List a = Nil | Cons {-# UNPACK #-} !(Unconsed a)
       data Unconsed a = Unconsed a !(List a)
     Here there is mutual recursion between `Unconsed` and `List`; and yet
     we can unpack the field of `Cons` because we will not unpack the second
     field of `Unconsed`: we never unpack a sum type without an explicit
     pragma (see should_unpack).

(W4) Consider
        data T = MkT !Wombat
        data Wombat = MkW {-# UNPACK #-} !S Int
        data S = MkS {-# NOUNPACK #-} !Wombat Int
     Suppose we are deciding whether to unpack the first field of MkT, by
     calling (shouldUnpackArgTy Wombat).  Then we'll try to unpack the !S field
     of MkW, and be stopped by the {-# NOUNPACK #-}, and all is fine; we can
     unpack MkT.

     If that NOUNPACK had been a UNPACK, though, we'd get a loop, and would
     decide not to unpack the Wombat field of MkT.

     But what if there was no pragma in `data S`?  Then we /still/ decide not
     to unpack the Wombat field of MkT (at least when auto-unpacking is on),
     because we don't know for sure which decision will be taken for the
     Wombat field of MkS.

     TL;DR when there is no pragma, behave as if there was a UNPACK, at least
     when auto-unpacking is on.  See `should_unpack` in `shouldUnpackArgTy`.


************************************************************************
*                                                                      *
        Wrapping and unwrapping newtypes and type families
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1694"></span><span>
</span><span id="line-1695"></span><span class="annot"><a href="GHC.Types.Id.Make.html#wrapNewTypeBody"><span class="hs-identifier hs-type">wrapNewTypeBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1696"></span><span class="hs-comment">-- The wrapper for the data constructor for a newtype looks like this:</span><span>
</span><span id="line-1697"></span><span class="hs-comment">--      newtype T a = MkT (a,Int)</span><span>
</span><span id="line-1698"></span><span class="hs-comment">--      MkT :: forall a. (a,Int) -&gt; T a</span><span>
</span><span id="line-1699"></span><span class="hs-comment">--      MkT = /\a. \(x:(a,Int)). x `cast` sym (CoT a)</span><span>
</span><span id="line-1700"></span><span class="hs-comment">-- where CoT is the coercion TyCon associated with the newtype</span><span>
</span><span id="line-1701"></span><span class="hs-comment">--</span><span>
</span><span id="line-1702"></span><span class="hs-comment">-- The call (wrapNewTypeBody T [a] e) returns the</span><span>
</span><span id="line-1703"></span><span class="hs-comment">-- body of the wrapper, namely</span><span>
</span><span id="line-1704"></span><span class="hs-comment">--      e `cast` (CoT [a])</span><span>
</span><span id="line-1705"></span><span class="hs-comment">--</span><span>
</span><span id="line-1706"></span><span class="hs-comment">-- If a coercion constructor is provided in the newtype, then we use</span><span>
</span><span id="line-1707"></span><span class="hs-comment">-- it, otherwise the wrap/unwrap are both no-ops</span><span>
</span><span id="line-1708"></span><span>
</span><span id="line-1709"></span><span id="wrapNewTypeBody"><span class="annot"><span class="annottext">wrapNewTypeBody :: TyCon -&gt; [Type] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Types.Id.Make.html#wrapNewTypeBody"><span class="hs-identifier hs-var hs-var">wrapNewTypeBody</span></a></span></span><span> </span><span id="local-6989586621682745760"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745760"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span id="local-6989586621682745761"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745761"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682745762"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745762"><span class="hs-identifier hs-var">result_expr</span></a></span></span><span>
</span><span id="line-1710"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; CoreExpr -&gt; CoreExpr
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745760"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1711"></span><span>    </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CoreExpr -&gt; Coercion -&gt; CoreExpr
CoreExpr -&gt; Coercion -&gt; CoreExpr
</span><a href="GHC.Core.Utils.html#mkCast"><span class="hs-identifier hs-var">mkCast</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745762"><span class="hs-identifier hs-var">result_expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkSymCo"><span class="hs-identifier hs-var">mkSymCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682745763"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1712"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1713"></span><span>    </span><span id="local-6989586621682745763"><span class="annot"><span class="annottext">co :: Coercion
</span><a href="#local-6989586621682745763"><span class="hs-identifier hs-var hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Role -&gt; CoAxiom Unbranched -&gt; [Type] -&gt; [Coercion] -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkUnbranchedAxInstCo"><span class="hs-identifier hs-var">mkUnbranchedAxInstCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Representational"><span class="hs-identifier hs-var">Representational</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; CoAxiom Unbranched
</span><a href="GHC.Core.TyCon.html#newTyConCo"><span class="hs-identifier hs-var">newTyConCo</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745760"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745761"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1714"></span><span>
</span><span id="line-1715"></span><span class="hs-comment">-- When unwrapping, we do *not* apply any family coercion, because this will</span><span>
</span><span id="line-1716"></span><span class="hs-comment">-- be done via a CoPat by the type checker.  We have to do it this way as</span><span>
</span><span id="line-1717"></span><span class="hs-comment">-- computing the right type arguments for the coercion requires more than just</span><span>
</span><span id="line-1718"></span><span class="hs-comment">-- a splitting operation (cf, GHC.Tc.Gen.Pat.tcConPat).</span><span>
</span><span id="line-1719"></span><span>
</span><span id="line-1720"></span><span class="annot"><a href="GHC.Types.Id.Make.html#unwrapNewTypeBody"><span class="hs-identifier hs-type">unwrapNewTypeBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1721"></span><span id="unwrapNewTypeBody"><span class="annot"><span class="annottext">unwrapNewTypeBody :: TyCon -&gt; [Type] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Types.Id.Make.html#unwrapNewTypeBody"><span class="hs-identifier hs-var hs-var">unwrapNewTypeBody</span></a></span></span><span> </span><span id="local-6989586621682745767"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745767"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span id="local-6989586621682745768"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745768"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682745769"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745769"><span class="hs-identifier hs-var">result_expr</span></a></span></span><span>
</span><span id="line-1722"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; CoreExpr -&gt; CoreExpr
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745767"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1723"></span><span>    </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CoreExpr -&gt; Coercion -&gt; CoreExpr
CoreExpr -&gt; Coercion -&gt; CoreExpr
</span><a href="GHC.Core.Utils.html#mkCast"><span class="hs-identifier hs-var">mkCast</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745769"><span class="hs-identifier hs-var">result_expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role -&gt; CoAxiom Unbranched -&gt; [Type] -&gt; [Coercion] -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkUnbranchedAxInstCo"><span class="hs-identifier hs-var">mkUnbranchedAxInstCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Representational"><span class="hs-identifier hs-var">Representational</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; CoAxiom Unbranched
</span><a href="GHC.Core.TyCon.html#newTyConCo"><span class="hs-identifier hs-var">newTyConCo</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745767"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745768"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1724"></span><span>
</span><span id="line-1725"></span><span class="hs-comment">-- If the type constructor is a representation type of a data instance, wrap</span><span>
</span><span id="line-1726"></span><span class="hs-comment">-- the expression into a cast adjusting the expression type, which is an</span><span>
</span><span id="line-1727"></span><span class="hs-comment">-- instance of the representation type, to the corresponding instance of the</span><span>
</span><span id="line-1728"></span><span class="hs-comment">-- family instance type.</span><span>
</span><span id="line-1729"></span><span class="hs-comment">-- See Note [Wrappers for data instance tycons]</span><span>
</span><span id="line-1730"></span><span class="annot"><a href="GHC.Types.Id.Make.html#wrapFamInstBody"><span class="hs-identifier hs-type">wrapFamInstBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1731"></span><span id="wrapFamInstBody"><span class="annot"><span class="annottext">wrapFamInstBody :: TyCon -&gt; [Type] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Types.Id.Make.html#wrapFamInstBody"><span class="hs-identifier hs-var hs-var">wrapFamInstBody</span></a></span></span><span> </span><span id="local-6989586621682745770"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745770"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span id="local-6989586621682745771"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745771"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682745772"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745772"><span class="hs-identifier hs-var">body</span></a></span></span><span>
</span><span id="line-1732"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682745773"><span class="annot"><span class="annottext">CoAxiom Unbranched
</span><a href="#local-6989586621682745773"><span class="hs-identifier hs-var">co_con</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe (CoAxiom Unbranched)
</span><a href="GHC.Core.TyCon.html#tyConFamilyCoercion_maybe"><span class="hs-identifier hs-var">tyConFamilyCoercion_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682745770"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-1733"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CoreExpr -&gt; Coercion -&gt; CoreExpr
CoreExpr -&gt; Coercion -&gt; CoreExpr
</span><a href="GHC.Core.Utils.html#mkCast"><span class="hs-identifier hs-var">mkCast</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745772"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkSymCo"><span class="hs-identifier hs-var">mkSymCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role -&gt; CoAxiom Unbranched -&gt; [Type] -&gt; [Coercion] -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkUnbranchedAxInstCo"><span class="hs-identifier hs-var">mkUnbranchedAxInstCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Representational"><span class="hs-identifier hs-var">Representational</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Unbranched
</span><a href="#local-6989586621682745773"><span class="hs-identifier hs-var">co_con</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745771"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1734"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1735"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745772"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-1736"></span><span>
</span><span id="line-1737"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
* Foreign calls
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1744"></span><span>
</span><span id="line-1745"></span><span class="hs-comment">-- For each ccall we manufacture a separate CCallOpId, giving it</span><span>
</span><span id="line-1746"></span><span class="hs-comment">-- a fresh unique, a type that is correct for this particular ccall,</span><span>
</span><span id="line-1747"></span><span class="hs-comment">-- and a CCall structure that gives the correct details about calling</span><span>
</span><span id="line-1748"></span><span class="hs-comment">-- convention etc.</span><span>
</span><span id="line-1749"></span><span class="hs-comment">--</span><span>
</span><span id="line-1750"></span><span class="hs-comment">-- The *name* of this Id is a local name whose OccName gives the full</span><span>
</span><span id="line-1751"></span><span class="hs-comment">-- details of the ccall, type and all.  This means that the interface</span><span>
</span><span id="line-1752"></span><span class="hs-comment">-- file reader can reconstruct a suitable Id</span><span>
</span><span id="line-1753"></span><span>
</span><span id="line-1754"></span><span class="annot"><a href="GHC.Types.Id.Make.html#mkFCallId"><span class="hs-identifier hs-type">mkFCallId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.ForeignCall.html#ForeignCall"><span class="hs-identifier hs-type">ForeignCall</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-1755"></span><span id="mkFCallId"><span class="annot"><span class="annottext">mkFCallId :: Unique -&gt; ForeignCall -&gt; Type -&gt; Id
</span><a href="GHC.Types.Id.Make.html#mkFCallId"><span class="hs-identifier hs-var hs-var">mkFCallId</span></a></span></span><span> </span><span id="local-6989586621682745775"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682745775"><span class="hs-identifier hs-var">uniq</span></a></span></span><span> </span><span id="local-6989586621682745776"><span class="annot"><span class="annottext">ForeignCall
</span><a href="#local-6989586621682745776"><span class="hs-identifier hs-var">fcall</span></a></span></span><span> </span><span id="local-6989586621682745777"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745777"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1756"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Id -&gt; Id
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfType"><span class="hs-identifier hs-var">noFreeVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745777"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Id -&gt; Id) -&gt; Id -&gt; Id
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1757"></span><span>    </span><span class="hs-comment">-- A CCallOpId should have no free type variables;</span><span>
</span><span id="line-1758"></span><span>    </span><span class="hs-comment">-- when doing substitutions won't substitute over it</span><span>
</span><span id="line-1759"></span><span>    </span><span class="annot"><span class="annottext">IdDetails -&gt; Name -&gt; Type -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.html#mkGlobalId"><span class="hs-identifier hs-var">mkGlobalId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignCall -&gt; IdDetails
</span><a href="GHC.Types.Id.Info.html#FCallId"><span class="hs-identifier hs-var">FCallId</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignCall
</span><a href="#local-6989586621682745776"><span class="hs-identifier hs-var">fcall</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745780"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745777"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745781"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-1760"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1761"></span><span>    </span><span id="local-6989586621682745782"><span class="annot"><span class="annottext">occ_str :: String
</span><a href="#local-6989586621682745782"><span class="hs-identifier hs-var hs-var">occ_str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDocContext -&gt; SDoc -&gt; String
</span><a href="GHC.Utils.Outputable.html#renderWithContext"><span class="hs-identifier hs-var">renderWithContext</span></a></span><span> </span><span class="annot"><span class="annottext">SDocContext
</span><a href="GHC.Utils.Outputable.html#defaultSDocContext"><span class="hs-identifier hs-var">defaultSDocContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignCall -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignCall
</span><a href="#local-6989586621682745776"><span class="hs-identifier hs-var">fcall</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745777"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1762"></span><span>    </span><span class="hs-comment">-- The &quot;occurrence name&quot; of a ccall is the full info about the</span><span>
</span><span id="line-1763"></span><span>    </span><span class="hs-comment">-- ccall; it is encoded, but may have embedded spaces etc!</span><span>
</span><span id="line-1764"></span><span>
</span><span id="line-1765"></span><span>    </span><span id="local-6989586621682745780"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621682745780"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; RuleName -&gt; Name
</span><a href="GHC.Types.Name.html#mkFCallName"><span class="hs-identifier hs-var">mkFCallName</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682745775"><span class="hs-identifier hs-var">uniq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682745782"><span class="hs-identifier hs-var">occ_str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1766"></span><span>
</span><span id="line-1767"></span><span>    </span><span id="local-6989586621682745781"><span class="annot"><span class="annottext">info :: IdInfo
</span><a href="#local-6989586621682745781"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span>
</span><span id="line-1768"></span><span>           </span><span class="annot"><span class="annottext">IdInfo -&gt; Int -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setArityInfo"><span class="hs-operator hs-var">`setArityInfo`</span></a></span><span>  </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745789"><span class="hs-identifier hs-var">arity</span></a></span><span>
</span><span id="line-1769"></span><span>           </span><span class="annot"><span class="annottext">IdInfo -&gt; DmdSig -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setDmdSigInfo"><span class="hs-operator hs-var">`setDmdSigInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">DmdSig
</span><a href="#local-6989586621682745790"><span class="hs-identifier hs-var">strict_sig</span></a></span><span>
</span><span id="line-1770"></span><span>           </span><span class="annot"><span class="annottext">IdInfo -&gt; CprSig -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setCprSigInfo"><span class="hs-operator hs-var">`setCprSigInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">CprSig
</span><a href="GHC.Types.Cpr.html#topCprSig"><span class="hs-identifier hs-var">topCprSig</span></a></span><span>
</span><span id="line-1771"></span><span>
</span><span id="line-1772"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682745791"><span class="annot"><span class="annottext">[PiTyVarBinder]
</span><a href="#local-6989586621682745791"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([PiTyVarBinder], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitPiTys"><span class="hs-identifier hs-var">tcSplitPiTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745777"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1773"></span><span>    </span><span id="local-6989586621682745789"><span class="annot"><span class="annottext">arity :: Int
</span><a href="#local-6989586621682745789"><span class="hs-identifier hs-var hs-var">arity</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PiTyVarBinder -&gt; Bool) -&gt; [PiTyVarBinder] -&gt; Int
forall a. (a -&gt; Bool) -&gt; [a] -&gt; Int
</span><a href="GHC.Utils.Misc.html#count"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">PiTyVarBinder -&gt; Bool
</span><a href="GHC.Types.Var.html#isAnonPiTyBinder"><span class="hs-identifier hs-var">isAnonPiTyBinder</span></a></span><span> </span><span class="annot"><span class="annottext">[PiTyVarBinder]
</span><a href="#local-6989586621682745791"><span class="hs-identifier hs-var">bndrs</span></a></span><span>
</span><span id="line-1774"></span><span>    </span><span id="local-6989586621682745790"><span class="annot"><span class="annottext">strict_sig :: DmdSig
</span><a href="#local-6989586621682745790"><span class="hs-identifier hs-var hs-var">strict_sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Divergence -&gt; DmdSig
</span><a href="GHC.Types.Demand.html#mkVanillaDmdSig"><span class="hs-identifier hs-var">mkVanillaDmdSig</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745789"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">Divergence
</span><a href="GHC.Types.Demand.html#topDiv"><span class="hs-identifier hs-var">topDiv</span></a></span><span>
</span><span id="line-1775"></span><span>    </span><span class="hs-comment">-- the call does not claim to be strict in its arguments, since they</span><span>
</span><span id="line-1776"></span><span>    </span><span class="hs-comment">-- may be lifted (foreign import prim) and the called code doesn't</span><span>
</span><span id="line-1777"></span><span>    </span><span class="hs-comment">-- necessarily force them. See #11076.</span><span>
</span><span id="line-1778"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{DictFuns and default methods}
*                                                                      *
************************************************************************

Note [Dict funs and default methods]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Dict funs and default methods are *not* ImplicitIds.  Their definition
involves user-written code, so we can't figure out their strictness etc
based on fixed info, as we can for constructors and record selectors (say).

NB: See also Note [Exported LocalIds] in GHC.Types.Id
-}</span><span>
</span><span id="line-1793"></span><span>
</span><span id="line-1794"></span><span class="annot"><a href="GHC.Types.Id.Make.html#mkDictFunId"><span class="hs-identifier hs-type">mkDictFunId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>      </span><span class="hs-comment">-- Name to use for the dict fun;</span><span>
</span><span id="line-1795"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1796"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a></span><span>
</span><span id="line-1797"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Class.html#Class"><span class="hs-identifier hs-type">Class</span></a></span><span>
</span><span id="line-1798"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1799"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-1800"></span><span class="hs-comment">-- Implements the DFun Superclass Invariant (see GHC.Tc.TyCl.Instance)</span><span>
</span><span id="line-1801"></span><span class="hs-comment">-- See Note [Dict funs and default methods]</span><span>
</span><span id="line-1802"></span><span>
</span><span id="line-1803"></span><span id="mkDictFunId"><span class="annot"><span class="annottext">mkDictFunId :: Name -&gt; [Id] -&gt; [Type] -&gt; Class -&gt; [Type] -&gt; Id
</span><a href="GHC.Types.Id.Make.html#mkDictFunId"><span class="hs-identifier hs-var hs-var">mkDictFunId</span></a></span></span><span> </span><span id="local-6989586621682745797"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745797"><span class="hs-identifier hs-var">dfun_name</span></a></span></span><span> </span><span id="local-6989586621682745798"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745798"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621682745799"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745799"><span class="hs-identifier hs-var">theta</span></a></span></span><span> </span><span id="local-6989586621682745800"><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621682745800"><span class="hs-identifier hs-var">clas</span></a></span></span><span> </span><span id="local-6989586621682745801"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745801"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-1804"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdDetails -&gt; Name -&gt; Type -&gt; Id
</span><a href="GHC.Types.Id.html#mkExportedLocalId"><span class="hs-identifier hs-var">mkExportedLocalId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; IdDetails
</span><a href="GHC.Types.Id.Info.html#DFunId"><span class="hs-identifier hs-var">DFunId</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682745804"><span class="hs-identifier hs-var">is_nt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1805"></span><span>                      </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745797"><span class="hs-identifier hs-var">dfun_name</span></a></span><span>
</span><span id="line-1806"></span><span>                      </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745805"><span class="hs-identifier hs-var">dfun_ty</span></a></span><span>
</span><span id="line-1807"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1808"></span><span>    </span><span id="local-6989586621682745804"><span class="annot"><span class="annottext">is_nt :: Bool
</span><a href="#local-6989586621682745804"><span class="hs-identifier hs-var hs-var">is_nt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Class -&gt; TyCon
</span><a href="GHC.Core.Class.html#classTyCon"><span class="hs-identifier hs-var">classTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621682745800"><span class="hs-identifier hs-var">clas</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1809"></span><span>    </span><span id="local-6989586621682745805"><span class="annot"><span class="annottext">dfun_ty :: Type
</span><a href="#local-6989586621682745805"><span class="hs-identifier hs-var hs-var">dfun_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Tc.Utils.TcType.html#tcMkDFunSigmaTy"><span class="hs-identifier hs-var">TcType.tcMkDFunSigmaTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745798"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745799"><span class="hs-identifier hs-var">theta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Class -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Predicate.html#mkClassPred"><span class="hs-identifier hs-var">mkClassPred</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621682745800"><span class="hs-identifier hs-var">clas</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682745801"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1810"></span><span>
</span><span id="line-1811"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Un-definable}
*                                                                      *
************************************************************************

These Ids can't be defined in Haskell.  They could be defined in
unfoldings in the wired-in GHC.Prim interface file, but we'd have to
ensure that they were definitely, definitely inlined, because there is
no curried identifier for them.  That's what mkCompulsoryUnfolding
does. Alternatively, we could add the definitions to mi_decls of ghcPrimIface
but it's not clear if this would be simpler.

coercionToken# is not listed in ghcPrimIds, since its type uses (~#)
which is not supposed to be used in expressions (GHC throws an assertion
failure when trying.)
-}</span><span>
</span><span id="line-1829"></span><span>
</span><span id="line-1830"></span><span>
</span><span id="line-1831"></span><span class="annot"><a href="GHC.Types.Id.Make.html#nullAddrName"><span class="hs-identifier hs-type">nullAddrName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#seqName"><span class="hs-identifier hs-type">seqName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1832"></span><span>   </span><span class="annot"><a href="GHC.Types.Id.Make.html#realWorldName"><span class="hs-identifier hs-type">realWorldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#voidPrimIdName"><span class="hs-identifier hs-type">voidPrimIdName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#coercionTokenName"><span class="hs-identifier hs-type">coercionTokenName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1833"></span><span>   </span><span class="annot"><a href="GHC.Types.Id.Make.html#coerceName"><span class="hs-identifier hs-type">coerceName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#proxyName"><span class="hs-identifier hs-type">proxyName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1834"></span><span>   </span><span class="annot"><a href="GHC.Types.Id.Make.html#leftSectionName"><span class="hs-identifier hs-type">leftSectionName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#rightSectionName"><span class="hs-identifier hs-type">rightSectionName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-1835"></span><span id="nullAddrName"><span class="annot"><span class="annottext">nullAddrName :: Name
</span><a href="GHC.Types.Id.Make.html#nullAddrName"><span class="hs-identifier hs-var hs-var">nullAddrName</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; RuleName -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nullAddr#&quot;</span></span><span class="hs-special">)</span><span>      </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#nullAddrIdKey"><span class="hs-identifier hs-var">nullAddrIdKey</span></a></span><span>      </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#nullAddrId"><span class="hs-identifier hs-var">nullAddrId</span></a></span><span>
</span><span id="line-1836"></span><span id="seqName"><span class="annot"><span class="annottext">seqName :: Name
</span><a href="GHC.Types.Id.Make.html#seqName"><span class="hs-identifier hs-var hs-var">seqName</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; RuleName -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;seq&quot;</span></span><span class="hs-special">)</span><span>            </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#seqIdKey"><span class="hs-identifier hs-var">seqIdKey</span></a></span><span>           </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#seqId"><span class="hs-identifier hs-var">seqId</span></a></span><span>
</span><span id="line-1837"></span><span id="realWorldName"><span class="annot"><span class="annottext">realWorldName :: Name
</span><a href="GHC.Types.Id.Make.html#realWorldName"><span class="hs-identifier hs-var hs-var">realWorldName</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; RuleName -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;realWorld#&quot;</span></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#realWorldPrimIdKey"><span class="hs-identifier hs-var">realWorldPrimIdKey</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#realWorldPrimId"><span class="hs-identifier hs-var">realWorldPrimId</span></a></span><span>
</span><span id="line-1838"></span><span id="voidPrimIdName"><span class="annot"><span class="annottext">voidPrimIdName :: Name
</span><a href="GHC.Types.Id.Make.html#voidPrimIdName"><span class="hs-identifier hs-var hs-var">voidPrimIdName</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; RuleName -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;void#&quot;</span></span><span class="hs-special">)</span><span>          </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#voidPrimIdKey"><span class="hs-identifier hs-var">voidPrimIdKey</span></a></span><span>      </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#voidPrimId"><span class="hs-identifier hs-var">voidPrimId</span></a></span><span>
</span><span id="line-1839"></span><span id="coercionTokenName"><span class="annot"><span class="annottext">coercionTokenName :: Name
</span><a href="GHC.Types.Id.Make.html#coercionTokenName"><span class="hs-identifier hs-var hs-var">coercionTokenName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; RuleName -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;coercionToken#&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#coercionTokenIdKey"><span class="hs-identifier hs-var">coercionTokenIdKey</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#coercionTokenId"><span class="hs-identifier hs-var">coercionTokenId</span></a></span><span>
</span><span id="line-1840"></span><span id="coerceName"><span class="annot"><span class="annottext">coerceName :: Name
</span><a href="GHC.Types.Id.Make.html#coerceName"><span class="hs-identifier hs-var hs-var">coerceName</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; RuleName -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;coerce&quot;</span></span><span class="hs-special">)</span><span>         </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#coerceKey"><span class="hs-identifier hs-var">coerceKey</span></a></span><span>          </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#coerceId"><span class="hs-identifier hs-var">coerceId</span></a></span><span>
</span><span id="line-1841"></span><span id="proxyName"><span class="annot"><span class="annottext">proxyName :: Name
</span><a href="GHC.Types.Id.Make.html#proxyName"><span class="hs-identifier hs-var hs-var">proxyName</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; RuleName -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;proxy#&quot;</span></span><span class="hs-special">)</span><span>         </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#proxyHashKey"><span class="hs-identifier hs-var">proxyHashKey</span></a></span><span>       </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#proxyHashId"><span class="hs-identifier hs-var">proxyHashId</span></a></span><span>
</span><span id="line-1842"></span><span id="leftSectionName"><span class="annot"><span class="annottext">leftSectionName :: Name
</span><a href="GHC.Types.Id.Make.html#leftSectionName"><span class="hs-identifier hs-var hs-var">leftSectionName</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; RuleName -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;leftSection&quot;</span></span><span class="hs-special">)</span><span>    </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#leftSectionKey"><span class="hs-identifier hs-var">leftSectionKey</span></a></span><span>     </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#leftSectionId"><span class="hs-identifier hs-var">leftSectionId</span></a></span><span>
</span><span id="line-1843"></span><span id="rightSectionName"><span class="annot"><span class="annottext">rightSectionName :: Name
</span><a href="GHC.Types.Id.Make.html#rightSectionName"><span class="hs-identifier hs-var hs-var">rightSectionName</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; RuleName -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rightSection&quot;</span></span><span class="hs-special">)</span><span>   </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#rightSectionKey"><span class="hs-identifier hs-var">rightSectionKey</span></a></span><span>    </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#rightSectionId"><span class="hs-identifier hs-var">rightSectionId</span></a></span><span>
</span><span id="line-1844"></span><span>
</span><span id="line-1845"></span><span class="hs-comment">-- Names listed in magicIds; see Note [magicIds]</span><span>
</span><span id="line-1846"></span><span class="annot"><a href="GHC.Types.Id.Make.html#lazyIdName"><span class="hs-identifier hs-type">lazyIdName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#oneShotName"><span class="hs-identifier hs-type">oneShotName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#nospecIdName"><span class="hs-identifier hs-type">nospecIdName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-1847"></span><span id="lazyIdName"><span class="annot"><span class="annottext">lazyIdName :: Name
</span><a href="GHC.Types.Id.Make.html#lazyIdName"><span class="hs-identifier hs-var hs-var">lazyIdName</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; RuleName -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#gHC_MAGIC"><span class="hs-identifier hs-var">gHC_MAGIC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lazy&quot;</span></span><span class="hs-special">)</span><span>           </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#lazyIdKey"><span class="hs-identifier hs-var">lazyIdKey</span></a></span><span>          </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#lazyId"><span class="hs-identifier hs-var">lazyId</span></a></span><span>
</span><span id="line-1848"></span><span id="oneShotName"><span class="annot"><span class="annottext">oneShotName :: Name
</span><a href="GHC.Types.Id.Make.html#oneShotName"><span class="hs-identifier hs-var hs-var">oneShotName</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; RuleName -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#gHC_MAGIC"><span class="hs-identifier hs-var">gHC_MAGIC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;oneShot&quot;</span></span><span class="hs-special">)</span><span>        </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#oneShotKey"><span class="hs-identifier hs-var">oneShotKey</span></a></span><span>         </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#oneShotId"><span class="hs-identifier hs-var">oneShotId</span></a></span><span>
</span><span id="line-1849"></span><span id="nospecIdName"><span class="annot"><span class="annottext">nospecIdName :: Name
</span><a href="GHC.Types.Id.Make.html#nospecIdName"><span class="hs-identifier hs-var hs-var">nospecIdName</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; RuleName -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#gHC_MAGIC"><span class="hs-identifier hs-var">gHC_MAGIC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nospec&quot;</span></span><span class="hs-special">)</span><span>         </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#nospecIdKey"><span class="hs-identifier hs-var">nospecIdKey</span></a></span><span>        </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#nospecId"><span class="hs-identifier hs-var">nospecId</span></a></span><span>
</span><span id="line-1850"></span><span>
</span><span id="line-1851"></span><span class="hs-comment">------------------------------------------------</span><span>
</span><span id="line-1852"></span><span class="annot"><a href="GHC.Types.Id.Make.html#proxyHashId"><span class="hs-identifier hs-type">proxyHashId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-1853"></span><span id="proxyHashId"><span class="annot"><span class="annottext">proxyHashId :: Id
</span><a href="GHC.Types.Id.Make.html#proxyHashId"><span class="hs-identifier hs-var hs-var">proxyHashId</span></a></span></span><span>
</span><span id="line-1854"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.Make.html#pcMiscPrelId"><span class="hs-identifier hs-var">pcMiscPrelId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Types.Id.Make.html#proxyName"><span class="hs-identifier hs-var">proxyName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745830"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1855"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo -&gt; Unfolding -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setUnfoldingInfo"><span class="hs-operator hs-var">`setUnfoldingInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">Unfolding
</span><a href="GHC.Core.html#evaldUnfolding"><span class="hs-identifier hs-var">evaldUnfolding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Note [evaldUnfoldings]</span><span>
</span><span id="line-1856"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1857"></span><span>    </span><span class="hs-comment">-- proxy# :: forall {k} (a:k). Proxy# k a</span><span>
</span><span id="line-1858"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-1859"></span><span>    </span><span class="hs-comment">-- The visibility of the `k` binder is Inferred to match the type of the</span><span>
</span><span id="line-1860"></span><span>    </span><span class="hs-comment">-- Proxy data constructor (#16293).</span><span>
</span><span id="line-1861"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682745831"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745831"><span class="hs-identifier hs-var">kv</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682745832"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745832"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type -&gt; [Type]) -&gt; [Id]
</span><a href="GHC.Builtin.Types.Prim.html#mkTemplateKiTyVar"><span class="hs-identifier hs-var">mkTemplateKiTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682745835"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745835"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745835"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1862"></span><span>    </span><span id="local-6989586621682745836"><span class="annot"><span class="annottext">kv_ty :: Type
</span><a href="#local-6989586621682745836"><span class="hs-identifier hs-var hs-var">kv_ty</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745831"><span class="hs-identifier hs-var">kv</span></a></span><span>
</span><span id="line-1863"></span><span>    </span><span id="local-6989586621682745838"><span class="annot"><span class="annottext">tv_ty :: Type
</span><a href="#local-6989586621682745838"><span class="hs-identifier hs-var hs-var">tv_ty</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745832"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1864"></span><span>    </span><span id="local-6989586621682745830"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682745830"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkInfForAllTy"><span class="hs-identifier hs-var">mkInfForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745831"><span class="hs-identifier hs-var">kv</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkSpecForAllTy"><span class="hs-identifier hs-var">mkSpecForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745832"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Builtin.Types.Prim.html#mkProxyPrimTy"><span class="hs-identifier hs-var">mkProxyPrimTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745836"><span class="hs-identifier hs-var">kv_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745838"><span class="hs-identifier hs-var">tv_ty</span></a></span><span>
</span><span id="line-1865"></span><span>
</span><span id="line-1866"></span><span class="hs-comment">------------------------------------------------</span><span>
</span><span id="line-1867"></span><span class="annot"><a href="GHC.Types.Id.Make.html#nullAddrId"><span class="hs-identifier hs-type">nullAddrId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-1868"></span><span class="hs-comment">-- nullAddr# :: Addr#</span><span>
</span><span id="line-1869"></span><span class="hs-comment">-- The reason it is here is because we don't provide</span><span>
</span><span id="line-1870"></span><span class="hs-comment">-- a way to write this literal in Haskell.</span><span>
</span><span id="line-1871"></span><span id="nullAddrId"><span class="annot"><span class="annottext">nullAddrId :: Id
</span><a href="GHC.Types.Id.Make.html#nullAddrId"><span class="hs-identifier hs-var hs-var">nullAddrId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.Make.html#pcMiscPrelId"><span class="hs-identifier hs-var">pcMiscPrelId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Types.Id.Make.html#nullAddrName"><span class="hs-identifier hs-var">nullAddrName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#addrPrimTy"><span class="hs-identifier hs-var">addrPrimTy</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745843"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-1872"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1873"></span><span>    </span><span id="local-6989586621682745843"><span class="annot"><span class="annottext">info :: IdInfo
</span><a href="#local-6989586621682745843"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo -&gt; InlinePragma -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setInlinePragInfo"><span class="hs-operator hs-var">`setInlinePragInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="GHC.Types.Basic.html#alwaysInlinePragma"><span class="hs-identifier hs-var">alwaysInlinePragma</span></a></span><span>
</span><span id="line-1874"></span><span>                       </span><span class="annot"><span class="annottext">IdInfo -&gt; Unfolding -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setUnfoldingInfo"><span class="hs-operator hs-var">`setUnfoldingInfo`</span></a></span><span>  </span><span class="annot"><span class="annottext">CoreExpr -&gt; Unfolding
</span><a href="GHC.Core.Unfold.Make.html#mkCompulsoryUnfolding"><span class="hs-identifier hs-var">mkCompulsoryUnfolding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Types.Literal.html#nullAddrLit"><span class="hs-identifier hs-var">nullAddrLit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1875"></span><span>
</span><span id="line-1876"></span><span class="hs-comment">------------------------------------------------</span><span>
</span><span id="line-1877"></span><span class="annot"><a href="GHC.Types.Id.Make.html#seqId"><span class="hs-identifier hs-type">seqId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>     </span><span class="hs-comment">-- See Note [seqId magic]</span><span>
</span><span id="line-1878"></span><span id="seqId"><span class="annot"><span class="annottext">seqId :: Id
</span><a href="GHC.Types.Id.Make.html#seqId"><span class="hs-identifier hs-var hs-var">seqId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; (Name -&gt; ConcreteTyVars) -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.Make.html#pcRepPolyId"><span class="hs-identifier hs-var">pcRepPolyId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Types.Id.Make.html#seqName"><span class="hs-identifier hs-var">seqName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745846"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConcreteTyVars
</span><a href="#local-6989586621682745847"><span class="hs-identifier hs-var">concs</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745848"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-1879"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1880"></span><span>    </span><span id="local-6989586621682745848"><span class="annot"><span class="annottext">info :: IdInfo
</span><a href="#local-6989586621682745848"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo -&gt; InlinePragma -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setInlinePragInfo"><span class="hs-operator hs-var">`setInlinePragInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621682745849"><span class="hs-identifier hs-var">inline_prag</span></a></span><span>
</span><span id="line-1881"></span><span>                       </span><span class="annot"><span class="annottext">IdInfo -&gt; Unfolding -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setUnfoldingInfo"><span class="hs-operator hs-var">`setUnfoldingInfo`</span></a></span><span>  </span><span class="annot"><span class="annottext">CoreExpr -&gt; Unfolding
</span><a href="GHC.Core.Unfold.Make.html#mkCompulsoryUnfolding"><span class="hs-identifier hs-var">mkCompulsoryUnfolding</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745850"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1882"></span><span>                       </span><span class="annot"><span class="annottext">IdInfo -&gt; Int -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setArityInfo"><span class="hs-operator hs-var">`setArityInfo`</span></a></span><span>      </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745851"><span class="hs-identifier hs-var">arity</span></a></span><span>
</span><span id="line-1883"></span><span>
</span><span id="line-1884"></span><span>    </span><span id="local-6989586621682745849"><span class="annot"><span class="annottext">inline_prag :: InlinePragma
</span><a href="#local-6989586621682745849"><span class="hs-identifier hs-var hs-var">inline_prag</span></a></span></span><span>
</span><span id="line-1885"></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="GHC.Types.Basic.html#alwaysInlinePragma"><span class="hs-identifier hs-var">alwaysInlinePragma</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma -&gt; Activation -&gt; InlinePragma
</span><a href="GHC.Types.Basic.html#setInlinePragmaActivation"><span class="hs-operator hs-var">`setInlinePragmaActivation`</span></a></span><span> </span><span class="annot"><span class="annottext">SourceText -&gt; Int -&gt; Activation
</span><a href="GHC.Types.Basic.html#ActiveAfter"><span class="hs-identifier hs-var">ActiveAfter</span></a></span><span>
</span><span id="line-1886"></span><span>                 </span><span class="annot"><span class="annottext">SourceText
</span><a href="GHC.Types.SourceText.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1887"></span><span>                  </span><span class="hs-comment">-- Make 'seq' not inline-always, so that simpleOptExpr</span><span>
</span><span id="line-1888"></span><span>                  </span><span class="hs-comment">-- (see GHC.Core.Subst.simple_app) won't inline 'seq' on the</span><span>
</span><span id="line-1889"></span><span>                  </span><span class="hs-comment">-- LHS of rules.  That way we can have rules for 'seq';</span><span>
</span><span id="line-1890"></span><span>                  </span><span class="hs-comment">-- see Note [seqId magic]</span><span>
</span><span id="line-1891"></span><span>
</span><span id="line-1892"></span><span>    </span><span class="hs-comment">-- seq :: forall (r :: RuntimeRep) a (b :: TYPE r). a -&gt; b -&gt; b</span><span>
</span><span id="line-1893"></span><span>    </span><span id="local-6989586621682745846"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682745846"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-1894"></span><span>      </span><span class="annot"><span class="annottext">Id -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkInfForAllTy"><span class="hs-identifier hs-var">mkInfForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep2TyVar"><span class="hs-identifier hs-var">runtimeRep2TyVar</span></a></span><span>
</span><span id="line-1895"></span><span>      </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#alphaTyVar"><span class="hs-identifier hs-var">alphaTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTyVar"><span class="hs-identifier hs-var">openBetaTyVar</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1896"></span><span>      </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type -&gt; Type
Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkVisFunTyMany"><span class="hs-identifier hs-var">mkVisFunTyMany</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#alphaTy"><span class="hs-identifier hs-var">alphaTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type -&gt; Type
Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkVisFunTyMany"><span class="hs-identifier hs-var">mkVisFunTyMany</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTy"><span class="hs-identifier hs-var">openBetaTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTy"><span class="hs-identifier hs-var">openBetaTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1897"></span><span>
</span><span id="line-1898"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682745863"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745863"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682745864"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745864"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Id]
</span><a href="GHC.Types.Id.html#mkTemplateLocals"><span class="hs-identifier hs-var">mkTemplateLocals</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#alphaTy"><span class="hs-identifier hs-var">alphaTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTy"><span class="hs-identifier hs-var">openBetaTy</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1899"></span><span>    </span><span id="local-6989586621682745850"><span class="annot"><span class="annottext">rhs :: CoreExpr
</span><a href="#local-6989586621682745850"><span class="hs-identifier hs-var hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; CoreExpr -&gt; CoreExpr
forall b. [b] -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep2TyVar"><span class="hs-identifier hs-var">runtimeRep2TyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#alphaTyVar"><span class="hs-identifier hs-var">alphaTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTyVar"><span class="hs-identifier hs-var">openBetaTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745863"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745864"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1900"></span><span>          </span><span class="annot"><span class="annottext">CoreExpr -&gt; Id -&gt; Type -&gt; [CoreAlt] -&gt; CoreExpr
forall b. Expr b -&gt; b -&gt; Type -&gt; [Alt b] -&gt; Expr b
</span><a href="GHC.Core.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745863"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745863"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTy"><span class="hs-identifier hs-var">openBetaTy</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreAlt
forall b. AltCon -&gt; [b] -&gt; Expr b -&gt; Alt b
</span><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745864"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1901"></span><span>
</span><span id="line-1902"></span><span>    </span><span id="local-6989586621682745847"><span class="annot"><span class="annottext">concs :: Name -&gt; ConcreteTyVars
</span><a href="#local-6989586621682745847"><span class="hs-identifier hs-var hs-var">concs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((Type, Position 'Neg), Id)] -&gt; Name -&gt; ConcreteTyVars
</span><a href="GHC.Types.Id.Make.html#mkRepPolyIdConcreteTyVars"><span class="hs-identifier hs-var">mkRepPolyIdConcreteTyVars</span></a></span><span>
</span><span id="line-1903"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTy"><span class="hs-identifier hs-var">openBetaTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Position (FlipPolarity 'Neg) -&gt; Position 'Neg
forall (p :: Polarity).
Int -&gt; Position (FlipPolarity p) -&gt; Position p
</span><a href="GHC.Tc.Types.Origin.html#Argument"><span class="hs-identifier hs-var">Argument</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Position (FlipPolarity 'Neg)
Position 'Pos
</span><a href="GHC.Tc.Types.Origin.html#Top"><span class="hs-identifier hs-var">Top</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep2TyVar"><span class="hs-identifier hs-var">runtimeRep2TyVar</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1904"></span><span>
</span><span id="line-1905"></span><span>    </span><span id="local-6989586621682745851"><span class="annot"><span class="annottext">arity :: Int
</span><a href="#local-6989586621682745851"><span class="hs-identifier hs-var hs-var">arity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-1906"></span><span>
</span><span id="line-1907"></span><span class="hs-comment">------------------------------------------------</span><span>
</span><span id="line-1908"></span><span class="annot"><a href="GHC.Types.Id.Make.html#lazyId"><span class="hs-identifier hs-type">lazyId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>    </span><span class="hs-comment">-- See Note [lazyId magic]</span><span>
</span><span id="line-1909"></span><span id="lazyId"><span class="annot"><span class="annottext">lazyId :: Id
</span><a href="GHC.Types.Id.Make.html#lazyId"><span class="hs-identifier hs-var hs-var">lazyId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.Make.html#pcMiscPrelId"><span class="hs-identifier hs-var">pcMiscPrelId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Types.Id.Make.html#lazyIdName"><span class="hs-identifier hs-var">lazyIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745869"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745870"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-1910"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1911"></span><span>    </span><span id="local-6989586621682745870"><span class="annot"><span class="annottext">info :: IdInfo
</span><a href="#local-6989586621682745870"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span>
</span><span id="line-1912"></span><span>    </span><span id="local-6989586621682745869"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682745869"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#alphaTyVar"><span class="hs-identifier hs-var">alphaTyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type -&gt; Type
Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkVisFunTyMany"><span class="hs-identifier hs-var">mkVisFunTyMany</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#alphaTy"><span class="hs-identifier hs-var">alphaTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#alphaTy"><span class="hs-identifier hs-var">alphaTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1913"></span><span>
</span><span id="line-1914"></span><span class="hs-comment">------------------------------------------------</span><span>
</span><span id="line-1915"></span><span class="annot"><a href="GHC.Types.Id.Make.html#noinlineIdName"><span class="hs-identifier hs-type">noinlineIdName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#noinlineConstraintIdName"><span class="hs-identifier hs-type">noinlineConstraintIdName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-1916"></span><span id="noinlineIdName"><span class="annot"><span class="annottext">noinlineIdName :: Name
</span><a href="GHC.Types.Id.Make.html#noinlineIdName"><span class="hs-identifier hs-var hs-var">noinlineIdName</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; RuleName -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#gHC_MAGIC"><span class="hs-identifier hs-var">gHC_MAGIC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;noinline&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1917"></span><span>                                           </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#noinlineIdKey"><span class="hs-identifier hs-var">noinlineIdKey</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#noinlineId"><span class="hs-identifier hs-var">noinlineId</span></a></span><span>
</span><span id="line-1918"></span><span id="noinlineConstraintIdName"><span class="annot"><span class="annottext">noinlineConstraintIdName :: Name
</span><a href="GHC.Types.Id.Make.html#noinlineConstraintIdName"><span class="hs-identifier hs-var hs-var">noinlineConstraintIdName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; RuleName -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#gHC_MAGIC"><span class="hs-identifier hs-var">gHC_MAGIC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;noinlineConstraint&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1919"></span><span>                                           </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#noinlineConstraintIdKey"><span class="hs-identifier hs-var">noinlineConstraintIdKey</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#noinlineConstraintId"><span class="hs-identifier hs-var">noinlineConstraintId</span></a></span><span>
</span><span id="line-1920"></span><span>
</span><span id="line-1921"></span><span class="annot"><a href="GHC.Types.Id.Make.html#noinlineId"><span class="hs-identifier hs-type">noinlineId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-comment">-- See Note [noinlineId magic]</span><span>
</span><span id="line-1922"></span><span id="noinlineId"><span class="annot"><span class="annottext">noinlineId :: Id
</span><a href="GHC.Types.Id.Make.html#noinlineId"><span class="hs-identifier hs-var hs-var">noinlineId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.Make.html#pcMiscPrelId"><span class="hs-identifier hs-var">pcMiscPrelId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Types.Id.Make.html#noinlineIdName"><span class="hs-identifier hs-var">noinlineIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745874"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745875"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-1923"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1924"></span><span>    </span><span id="local-6989586621682745875"><span class="annot"><span class="annottext">info :: IdInfo
</span><a href="#local-6989586621682745875"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span>
</span><span id="line-1925"></span><span>    </span><span id="local-6989586621682745874"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682745874"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#alphaTyVar"><span class="hs-identifier hs-var">alphaTyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1926"></span><span>          </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type -&gt; Type
Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkVisFunTyMany"><span class="hs-identifier hs-var">mkVisFunTyMany</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#alphaTy"><span class="hs-identifier hs-var">alphaTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#alphaTy"><span class="hs-identifier hs-var">alphaTy</span></a></span><span>
</span><span id="line-1927"></span><span>
</span><span id="line-1928"></span><span class="annot"><a href="GHC.Types.Id.Make.html#noinlineConstraintId"><span class="hs-identifier hs-type">noinlineConstraintId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-comment">-- See Note [noinlineId magic]</span><span>
</span><span id="line-1929"></span><span id="noinlineConstraintId"><span class="annot"><span class="annottext">noinlineConstraintId :: Id
</span><a href="GHC.Types.Id.Make.html#noinlineConstraintId"><span class="hs-identifier hs-var hs-var">noinlineConstraintId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.Make.html#pcMiscPrelId"><span class="hs-identifier hs-var">pcMiscPrelId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Types.Id.Make.html#noinlineConstraintIdName"><span class="hs-identifier hs-var">noinlineConstraintIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745877"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745878"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-1930"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1931"></span><span>    </span><span id="local-6989586621682745878"><span class="annot"><span class="annottext">info :: IdInfo
</span><a href="#local-6989586621682745878"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span>
</span><span id="line-1932"></span><span>    </span><span id="local-6989586621682745877"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682745877"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#alphaConstraintTyVar"><span class="hs-identifier hs-var">alphaConstraintTyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1933"></span><span>           </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; FunTyFlag -&gt; Type -&gt; Type -&gt; Type -&gt; Type
FunTyFlag -&gt; Type -&gt; Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="GHC.Types.Var.html#visArgConstraintLike"><span class="hs-identifier hs-var">visArgConstraintLike</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#alphaTy"><span class="hs-identifier hs-var">alphaTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#alphaConstraintTy"><span class="hs-identifier hs-var">alphaConstraintTy</span></a></span><span>
</span><span id="line-1934"></span><span>
</span><span id="line-1935"></span><span class="hs-comment">------------------------------------------------</span><span>
</span><span id="line-1936"></span><span class="annot"><a href="GHC.Types.Id.Make.html#nospecId"><span class="hs-identifier hs-type">nospecId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-comment">-- See Note [nospecId magic]</span><span>
</span><span id="line-1937"></span><span id="nospecId"><span class="annot"><span class="annottext">nospecId :: Id
</span><a href="GHC.Types.Id.Make.html#nospecId"><span class="hs-identifier hs-var hs-var">nospecId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.Make.html#pcMiscPrelId"><span class="hs-identifier hs-var">pcMiscPrelId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Types.Id.Make.html#nospecIdName"><span class="hs-identifier hs-var">nospecIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745883"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745884"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-1938"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1939"></span><span>    </span><span id="local-6989586621682745884"><span class="annot"><span class="annottext">info :: IdInfo
</span><a href="#local-6989586621682745884"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span>
</span><span id="line-1940"></span><span>    </span><span id="local-6989586621682745883"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682745883"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#alphaTyVar"><span class="hs-identifier hs-var">alphaTyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type -&gt; Type
Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkVisFunTyMany"><span class="hs-identifier hs-var">mkVisFunTyMany</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#alphaTy"><span class="hs-identifier hs-var">alphaTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#alphaTy"><span class="hs-identifier hs-var">alphaTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1941"></span><span>
</span><span id="line-1942"></span><span class="annot"><a href="GHC.Types.Id.Make.html#oneShotId"><span class="hs-identifier hs-type">oneShotId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-comment">-- See Note [oneShot magic]</span><span>
</span><span id="line-1943"></span><span id="oneShotId"><span class="annot"><span class="annottext">oneShotId :: Id
</span><a href="GHC.Types.Id.Make.html#oneShotId"><span class="hs-identifier hs-var hs-var">oneShotId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; (Name -&gt; ConcreteTyVars) -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.Make.html#pcRepPolyId"><span class="hs-identifier hs-var">pcRepPolyId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Types.Id.Make.html#oneShotName"><span class="hs-identifier hs-var">oneShotName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745886"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConcreteTyVars
</span><a href="#local-6989586621682745887"><span class="hs-identifier hs-var">concs</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745888"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-1944"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1945"></span><span>    </span><span id="local-6989586621682745888"><span class="annot"><span class="annottext">info :: IdInfo
</span><a href="#local-6989586621682745888"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo -&gt; InlinePragma -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setInlinePragInfo"><span class="hs-operator hs-var">`setInlinePragInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="GHC.Types.Basic.html#alwaysInlinePragma"><span class="hs-identifier hs-var">alwaysInlinePragma</span></a></span><span>
</span><span id="line-1946"></span><span>                       </span><span class="annot"><span class="annottext">IdInfo -&gt; Unfolding -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setUnfoldingInfo"><span class="hs-operator hs-var">`setUnfoldingInfo`</span></a></span><span>  </span><span class="annot"><span class="annottext">CoreExpr -&gt; Unfolding
</span><a href="GHC.Core.Unfold.Make.html#mkCompulsoryUnfolding"><span class="hs-identifier hs-var">mkCompulsoryUnfolding</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745889"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1947"></span><span>                       </span><span class="annot"><span class="annottext">IdInfo -&gt; Int -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setArityInfo"><span class="hs-operator hs-var">`setArityInfo`</span></a></span><span>      </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745890"><span class="hs-identifier hs-var">arity</span></a></span><span>
</span><span id="line-1948"></span><span>    </span><span class="hs-comment">-- oneShot :: forall {r1 r2} (a :: TYPE r1) (b :: TYPE r2). (a -&gt; b) -&gt; (a -&gt; b)</span><span>
</span><span id="line-1949"></span><span>    </span><span id="local-6989586621682745886"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682745886"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkInfForAllTys"><span class="hs-identifier hs-var">mkInfForAllTys</span></a></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep1TyVar"><span class="hs-identifier hs-var">runtimeRep1TyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep2TyVar"><span class="hs-identifier hs-var">runtimeRep2TyVar</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1950"></span><span>          </span><span class="annot"><span class="annottext">[Id] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#openAlphaTyVar"><span class="hs-identifier hs-var">openAlphaTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTyVar"><span class="hs-identifier hs-var">openBetaTyVar</span></a></span><span> </span><span class="hs-special">]</span><span>      </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1951"></span><span>          </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type -&gt; Type
Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkVisFunTyMany"><span class="hs-identifier hs-var">mkVisFunTyMany</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745895"><span class="hs-identifier hs-var">fun_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745895"><span class="hs-identifier hs-var">fun_ty</span></a></span><span>
</span><span id="line-1952"></span><span>    </span><span id="local-6989586621682745895"><span class="annot"><span class="annottext">fun_ty :: Type
</span><a href="#local-6989586621682745895"><span class="hs-identifier hs-var hs-var">fun_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type -&gt; Type
Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkVisFunTyMany"><span class="hs-identifier hs-var">mkVisFunTyMany</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openAlphaTy"><span class="hs-identifier hs-var">openAlphaTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTy"><span class="hs-identifier hs-var">openBetaTy</span></a></span><span>
</span><span id="line-1953"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682745898"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745898"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745899"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745899"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Id]
</span><a href="GHC.Types.Id.html#mkTemplateLocals"><span class="hs-identifier hs-var">mkTemplateLocals</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745895"><span class="hs-identifier hs-var">fun_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openAlphaTy"><span class="hs-identifier hs-var">openAlphaTy</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1954"></span><span>    </span><span id="local-6989586621682745900"><span class="annot"><span class="annottext">x' :: Id
</span><a href="#local-6989586621682745900"><span class="hs-identifier hs-var hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Id
</span><a href="GHC.Types.Id.html#setOneShotLambda"><span class="hs-identifier hs-var">setOneShotLambda</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745899"><span class="hs-identifier hs-var">x</span></a></span><span>  </span><span class="hs-comment">-- Here is the magic bit!</span><span>
</span><span id="line-1955"></span><span>    </span><span id="local-6989586621682745889"><span class="annot"><span class="annottext">rhs :: CoreExpr
</span><a href="#local-6989586621682745889"><span class="hs-identifier hs-var hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; CoreExpr -&gt; CoreExpr
forall b. [b] -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep1TyVar"><span class="hs-identifier hs-var">runtimeRep1TyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep2TyVar"><span class="hs-identifier hs-var">runtimeRep2TyVar</span></a></span><span>
</span><span id="line-1956"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#openAlphaTyVar"><span class="hs-identifier hs-var">openAlphaTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTyVar"><span class="hs-identifier hs-var">openBetaTyVar</span></a></span><span>
</span><span id="line-1957"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745898"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745900"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1958"></span><span>          </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745898"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745900"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-1959"></span><span>    </span><span id="local-6989586621682745890"><span class="annot"><span class="annottext">arity :: Int
</span><a href="#local-6989586621682745890"><span class="hs-identifier hs-var hs-var">arity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-1960"></span><span>
</span><span id="line-1961"></span><span>    </span><span id="local-6989586621682745887"><span class="annot"><span class="annottext">concs :: Name -&gt; ConcreteTyVars
</span><a href="#local-6989586621682745887"><span class="hs-identifier hs-var hs-var">concs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((Type, Position 'Neg), Id)] -&gt; Name -&gt; ConcreteTyVars
</span><a href="GHC.Types.Id.Make.html#mkRepPolyIdConcreteTyVars"><span class="hs-identifier hs-var">mkRepPolyIdConcreteTyVars</span></a></span><span>
</span><span id="line-1962"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openAlphaTy"><span class="hs-identifier hs-var">openAlphaTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Position (FlipPolarity 'Neg) -&gt; Position 'Neg
forall (p :: Polarity).
Int -&gt; Position (FlipPolarity p) -&gt; Position p
</span><a href="GHC.Tc.Types.Origin.html#Argument"><span class="hs-identifier hs-var">Argument</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Position (FlipPolarity 'Neg)
Position 'Pos
</span><a href="GHC.Tc.Types.Origin.html#Top"><span class="hs-identifier hs-var">Top</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep1TyVar"><span class="hs-identifier hs-var">runtimeRep1TyVar</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1963"></span><span>
</span><span id="line-1964"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-1965"></span><span class="hs-comment">{- Note [Wired-in Ids for rebindable syntax]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The functions leftSectionId, rightSectionId are
wired in here ONLY because they are used in a representation-polymorphic way
by the rebindable syntax mechanism. See GHC.Rename.Expr
Note [Handling overloaded and rebindable constructs].

Alas, we can't currently give Haskell definitions for
representation-polymorphic functions.

They have Compulsory unfoldings, so that the representation polymorphism
does not linger for long.
-}</span><span>
</span><span id="line-1978"></span><span>
</span><span id="line-1979"></span><span class="hs-comment">-- See Note [Left and right sections] in GHC.Rename.Expr</span><span>
</span><span id="line-1980"></span><span class="hs-comment">-- See Note [Wired-in Ids for rebindable syntax]</span><span>
</span><span id="line-1981"></span><span class="hs-comment">--   leftSection :: forall r1 r2 n (a::TYPE r1) (b::TYPE r2).</span><span>
</span><span id="line-1982"></span><span class="hs-comment">--                  (a %n-&gt; b) -&gt; a %n-&gt; b</span><span>
</span><span id="line-1983"></span><span class="hs-comment">--   leftSection f x = f x</span><span>
</span><span id="line-1984"></span><span class="hs-comment">-- Important that it is eta-expanded, so that (leftSection undefined `seq` ())</span><span>
</span><span id="line-1985"></span><span class="hs-comment">--   is () and not undefined</span><span>
</span><span id="line-1986"></span><span class="hs-comment">-- Important that is is multiplicity-polymorphic (test linear/should_compile/OldList)</span><span>
</span><span id="line-1987"></span><span class="annot"><a href="GHC.Types.Id.Make.html#leftSectionId"><span class="hs-identifier hs-type">leftSectionId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-1988"></span><span id="leftSectionId"><span class="annot"><span class="annottext">leftSectionId :: Id
</span><a href="GHC.Types.Id.Make.html#leftSectionId"><span class="hs-identifier hs-var hs-var">leftSectionId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; (Name -&gt; ConcreteTyVars) -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.Make.html#pcRepPolyId"><span class="hs-identifier hs-var">pcRepPolyId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Types.Id.Make.html#leftSectionName"><span class="hs-identifier hs-var">leftSectionName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745904"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConcreteTyVars
</span><a href="#local-6989586621682745905"><span class="hs-identifier hs-var">concs</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745906"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-1989"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1990"></span><span>    </span><span id="local-6989586621682745906"><span class="annot"><span class="annottext">info :: IdInfo
</span><a href="#local-6989586621682745906"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo -&gt; InlinePragma -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setInlinePragInfo"><span class="hs-operator hs-var">`setInlinePragInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="GHC.Types.Basic.html#alwaysInlinePragma"><span class="hs-identifier hs-var">alwaysInlinePragma</span></a></span><span>
</span><span id="line-1991"></span><span>                       </span><span class="annot"><span class="annottext">IdInfo -&gt; Unfolding -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setUnfoldingInfo"><span class="hs-operator hs-var">`setUnfoldingInfo`</span></a></span><span>  </span><span class="annot"><span class="annottext">CoreExpr -&gt; Unfolding
</span><a href="GHC.Core.Unfold.Make.html#mkCompulsoryUnfolding"><span class="hs-identifier hs-var">mkCompulsoryUnfolding</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745907"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1992"></span><span>                       </span><span class="annot"><span class="annottext">IdInfo -&gt; Int -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setArityInfo"><span class="hs-operator hs-var">`setArityInfo`</span></a></span><span>      </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745908"><span class="hs-identifier hs-var">arity</span></a></span><span>
</span><span id="line-1993"></span><span>    </span><span id="local-6989586621682745904"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682745904"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkInfForAllTys"><span class="hs-identifier hs-var">mkInfForAllTys</span></a></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep1TyVar"><span class="hs-identifier hs-var">runtimeRep1TyVar</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep2TyVar"><span class="hs-identifier hs-var">runtimeRep2TyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#multiplicityTyVar1"><span class="hs-identifier hs-var">multiplicityTyVar1</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1994"></span><span>          </span><span class="annot"><span class="annottext">[Id] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#openAlphaTyVar"><span class="hs-identifier hs-var">openAlphaTyVar</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTyVar"><span class="hs-identifier hs-var">openBetaTyVar</span></a></span><span class="hs-special">]</span><span>    </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1995"></span><span>          </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CoreExpr -&gt; Type
CoreExpr -&gt; Type
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745911"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-1996"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682745913"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745913"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682745914"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745914"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Id]
</span><a href="GHC.Types.Id.html#mkTemplateLocals"><span class="hs-identifier hs-var">mkTemplateLocals</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type -&gt; Type -&gt; Type
Type -&gt; Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkVisFunTy"><span class="hs-identifier hs-var">mkVisFunTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745916"><span class="hs-identifier hs-var">mult</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openAlphaTy"><span class="hs-identifier hs-var">openAlphaTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTy"><span class="hs-identifier hs-var">openBetaTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openAlphaTy"><span class="hs-identifier hs-var">openAlphaTy</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1997"></span><span>
</span><span id="line-1998"></span><span>    </span><span id="local-6989586621682745916"><span class="annot"><span class="annottext">mult :: Type
</span><a href="#local-6989586621682745916"><span class="hs-identifier hs-var hs-var">mult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#multiplicityTyVar1"><span class="hs-identifier hs-var">multiplicityTyVar1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span>
</span><span id="line-1999"></span><span>    </span><span id="local-6989586621682745918"><span class="annot"><span class="annottext">xmult :: Id
</span><a href="#local-6989586621682745918"><span class="hs-identifier hs-var hs-var">xmult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type -&gt; Id
</span><a href="GHC.Types.Var.html#setIdMult"><span class="hs-identifier hs-var">setIdMult</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745914"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745916"><span class="hs-identifier hs-var">mult</span></a></span><span>
</span><span id="line-2000"></span><span>
</span><span id="line-2001"></span><span>    </span><span id="local-6989586621682745907"><span class="annot"><span class="annottext">rhs :: CoreExpr
</span><a href="#local-6989586621682745907"><span class="hs-identifier hs-var hs-var">rhs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; CoreExpr -&gt; CoreExpr
forall b. [b] -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep1TyVar"><span class="hs-identifier hs-var">runtimeRep1TyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep2TyVar"><span class="hs-identifier hs-var">runtimeRep2TyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#multiplicityTyVar1"><span class="hs-identifier hs-var">multiplicityTyVar1</span></a></span><span>
</span><span id="line-2002"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#openAlphaTyVar"><span class="hs-identifier hs-var">openAlphaTyVar</span></a></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTyVar"><span class="hs-identifier hs-var">openBetaTyVar</span></a></span><span>   </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745911"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-2003"></span><span>    </span><span id="local-6989586621682745911"><span class="annot"><span class="annottext">body :: CoreExpr
</span><a href="#local-6989586621682745911"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; CoreExpr -&gt; CoreExpr
forall b. [b] -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745913"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745918"><span class="hs-identifier hs-var">xmult</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745913"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745918"><span class="hs-identifier hs-var">xmult</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2004"></span><span>    </span><span id="local-6989586621682745908"><span class="annot"><span class="annottext">arity :: Int
</span><a href="#local-6989586621682745908"><span class="hs-identifier hs-var hs-var">arity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-2005"></span><span>
</span><span id="line-2006"></span><span>    </span><span id="local-6989586621682745905"><span class="annot"><span class="annottext">concs :: Name -&gt; ConcreteTyVars
</span><a href="#local-6989586621682745905"><span class="hs-identifier hs-var hs-var">concs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((Type, Position 'Neg), Id)] -&gt; Name -&gt; ConcreteTyVars
</span><a href="GHC.Types.Id.Make.html#mkRepPolyIdConcreteTyVars"><span class="hs-identifier hs-var">mkRepPolyIdConcreteTyVars</span></a></span><span>
</span><span id="line-2007"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openAlphaTy"><span class="hs-identifier hs-var">openAlphaTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Position (FlipPolarity 'Neg) -&gt; Position 'Neg
forall (p :: Polarity).
Int -&gt; Position (FlipPolarity p) -&gt; Position p
</span><a href="GHC.Tc.Types.Origin.html#Argument"><span class="hs-identifier hs-var">Argument</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Position (FlipPolarity 'Neg)
Position 'Pos
</span><a href="GHC.Tc.Types.Origin.html#Top"><span class="hs-identifier hs-var">Top</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep1TyVar"><span class="hs-identifier hs-var">runtimeRep1TyVar</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2008"></span><span>
</span><span id="line-2009"></span><span class="hs-comment">-- See Note [Left and right sections] in GHC.Rename.Expr</span><span>
</span><span id="line-2010"></span><span class="hs-comment">-- See Note [Wired-in Ids for rebindable syntax]</span><span>
</span><span id="line-2011"></span><span class="hs-comment">--   rightSection :: forall r1 r2 r3 n1 n2 (a::TYPE r1) (b::TYPE r2) (c::TYPE r3).</span><span>
</span><span id="line-2012"></span><span class="hs-comment">--                   (a %n1 -&gt; b %n2-&gt; c) -&gt; b %n2-&gt; a %n1-&gt; c</span><span>
</span><span id="line-2013"></span><span class="hs-comment">--   rightSection f y x = f x y</span><span>
</span><span id="line-2014"></span><span class="hs-comment">-- Again, multiplicity polymorphism is important</span><span>
</span><span id="line-2015"></span><span class="annot"><a href="GHC.Types.Id.Make.html#rightSectionId"><span class="hs-identifier hs-type">rightSectionId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-2016"></span><span id="rightSectionId"><span class="annot"><span class="annottext">rightSectionId :: Id
</span><a href="GHC.Types.Id.Make.html#rightSectionId"><span class="hs-identifier hs-var hs-var">rightSectionId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; (Name -&gt; ConcreteTyVars) -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.Make.html#pcRepPolyId"><span class="hs-identifier hs-var">pcRepPolyId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Types.Id.Make.html#rightSectionName"><span class="hs-identifier hs-var">rightSectionName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745921"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConcreteTyVars
</span><a href="#local-6989586621682745922"><span class="hs-identifier hs-var">concs</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745923"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-2017"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2018"></span><span>    </span><span id="local-6989586621682745923"><span class="annot"><span class="annottext">info :: IdInfo
</span><a href="#local-6989586621682745923"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo -&gt; InlinePragma -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setInlinePragInfo"><span class="hs-operator hs-var">`setInlinePragInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="GHC.Types.Basic.html#alwaysInlinePragma"><span class="hs-identifier hs-var">alwaysInlinePragma</span></a></span><span>
</span><span id="line-2019"></span><span>                       </span><span class="annot"><span class="annottext">IdInfo -&gt; Unfolding -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setUnfoldingInfo"><span class="hs-operator hs-var">`setUnfoldingInfo`</span></a></span><span>  </span><span class="annot"><span class="annottext">CoreExpr -&gt; Unfolding
</span><a href="GHC.Core.Unfold.Make.html#mkCompulsoryUnfolding"><span class="hs-identifier hs-var">mkCompulsoryUnfolding</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745924"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-2020"></span><span>                       </span><span class="annot"><span class="annottext">IdInfo -&gt; Int -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setArityInfo"><span class="hs-operator hs-var">`setArityInfo`</span></a></span><span>      </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682745925"><span class="hs-identifier hs-var">arity</span></a></span><span>
</span><span id="line-2021"></span><span>    </span><span id="local-6989586621682745921"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682745921"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkInfForAllTys"><span class="hs-identifier hs-var">mkInfForAllTys</span></a></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep1TyVar"><span class="hs-identifier hs-var">runtimeRep1TyVar</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep2TyVar"><span class="hs-identifier hs-var">runtimeRep2TyVar</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep3TyVar"><span class="hs-identifier hs-var">runtimeRep3TyVar</span></a></span><span>
</span><span id="line-2022"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#multiplicityTyVar1"><span class="hs-identifier hs-var">multiplicityTyVar1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#multiplicityTyVar2"><span class="hs-identifier hs-var">multiplicityTyVar2</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2023"></span><span>          </span><span class="annot"><span class="annottext">[Id] -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#openAlphaTyVar"><span class="hs-identifier hs-var">openAlphaTyVar</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTyVar"><span class="hs-identifier hs-var">openBetaTyVar</span></a></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#openGammaTyVar"><span class="hs-identifier hs-var">openGammaTyVar</span></a></span><span> </span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2024"></span><span>          </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CoreExpr -&gt; Type
CoreExpr -&gt; Type
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745930"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-2025"></span><span>    </span><span id="local-6989586621682745931"><span class="annot"><span class="annottext">mult1 :: Type
</span><a href="#local-6989586621682745931"><span class="hs-identifier hs-var hs-var">mult1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#multiplicityTyVar1"><span class="hs-identifier hs-var">multiplicityTyVar1</span></a></span><span>
</span><span id="line-2026"></span><span>    </span><span id="local-6989586621682745932"><span class="annot"><span class="annottext">mult2 :: Type
</span><a href="#local-6989586621682745932"><span class="hs-identifier hs-var hs-var">mult2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#multiplicityTyVar2"><span class="hs-identifier hs-var">multiplicityTyVar2</span></a></span><span>
</span><span id="line-2027"></span><span>
</span><span id="line-2028"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682745934"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745934"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682745935"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745935"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682745936"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745936"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Id]
</span><a href="GHC.Types.Id.html#mkTemplateLocals"><span class="hs-identifier hs-var">mkTemplateLocals</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Scaled Type] -&gt; Type -&gt; Type
HasDebugCallStack =&gt; [Scaled Type] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkScaledFunTys"><span class="hs-identifier hs-var">mkScaledFunTys</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745931"><span class="hs-identifier hs-var">mult1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openAlphaTy"><span class="hs-identifier hs-var">openAlphaTy</span></a></span><span>
</span><span id="line-2029"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745932"><span class="hs-identifier hs-var">mult2</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTy"><span class="hs-identifier hs-var">openBetaTy</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openGammaTy"><span class="hs-identifier hs-var">openGammaTy</span></a></span><span>
</span><span id="line-2030"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openAlphaTy"><span class="hs-identifier hs-var">openAlphaTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTy"><span class="hs-identifier hs-var">openBetaTy</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2031"></span><span>    </span><span id="local-6989586621682745939"><span class="annot"><span class="annottext">xmult :: Id
</span><a href="#local-6989586621682745939"><span class="hs-identifier hs-var hs-var">xmult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type -&gt; Id
</span><a href="GHC.Types.Var.html#setIdMult"><span class="hs-identifier hs-var">setIdMult</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745935"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745931"><span class="hs-identifier hs-var">mult1</span></a></span><span>
</span><span id="line-2032"></span><span>    </span><span id="local-6989586621682745940"><span class="annot"><span class="annottext">ymult :: Id
</span><a href="#local-6989586621682745940"><span class="hs-identifier hs-var hs-var">ymult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type -&gt; Id
</span><a href="GHC.Types.Var.html#setIdMult"><span class="hs-identifier hs-var">setIdMult</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745936"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745932"><span class="hs-identifier hs-var">mult2</span></a></span><span>
</span><span id="line-2033"></span><span>    </span><span id="local-6989586621682745924"><span class="annot"><span class="annottext">rhs :: CoreExpr
</span><a href="#local-6989586621682745924"><span class="hs-identifier hs-var hs-var">rhs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; CoreExpr -&gt; CoreExpr
forall b. [b] -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep1TyVar"><span class="hs-identifier hs-var">runtimeRep1TyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep2TyVar"><span class="hs-identifier hs-var">runtimeRep2TyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep3TyVar"><span class="hs-identifier hs-var">runtimeRep3TyVar</span></a></span><span>
</span><span id="line-2034"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#multiplicityTyVar1"><span class="hs-identifier hs-var">multiplicityTyVar1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#multiplicityTyVar2"><span class="hs-identifier hs-var">multiplicityTyVar2</span></a></span><span>
</span><span id="line-2035"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#openAlphaTyVar"><span class="hs-identifier hs-var">openAlphaTyVar</span></a></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTyVar"><span class="hs-identifier hs-var">openBetaTyVar</span></a></span><span class="hs-special">,</span><span>    </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#openGammaTyVar"><span class="hs-identifier hs-var">openGammaTyVar</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745930"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-2036"></span><span>    </span><span id="local-6989586621682745930"><span class="annot"><span class="annottext">body :: CoreExpr
</span><a href="#local-6989586621682745930"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; CoreExpr -&gt; CoreExpr
forall b. [b] -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745934"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745940"><span class="hs-identifier hs-var">ymult</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745939"><span class="hs-identifier hs-var">xmult</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; [Id] -&gt; CoreExpr
forall b. Expr b -&gt; [Id] -&gt; Expr b
</span><a href="GHC.Core.html#mkVarApps"><span class="hs-identifier hs-var">mkVarApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745934"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745939"><span class="hs-identifier hs-var">xmult</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745940"><span class="hs-identifier hs-var">ymult</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2037"></span><span>    </span><span id="local-6989586621682745925"><span class="annot"><span class="annottext">arity :: Int
</span><a href="#local-6989586621682745925"><span class="hs-identifier hs-var hs-var">arity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-2038"></span><span>
</span><span id="line-2039"></span><span>    </span><span id="local-6989586621682745922"><span class="annot"><span class="annottext">concs :: Name -&gt; ConcreteTyVars
</span><a href="#local-6989586621682745922"><span class="hs-identifier hs-var hs-var">concs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2040"></span><span>      </span><span class="annot"><span class="annottext">[((Type, Position 'Neg), Id)] -&gt; Name -&gt; ConcreteTyVars
</span><a href="GHC.Types.Id.Make.html#mkRepPolyIdConcreteTyVars"><span class="hs-identifier hs-var">mkRepPolyIdConcreteTyVars</span></a></span><span>
</span><span id="line-2041"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openAlphaTy"><span class="hs-identifier hs-var">openAlphaTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Position (FlipPolarity 'Neg) -&gt; Position 'Neg
forall (p :: Polarity).
Int -&gt; Position (FlipPolarity p) -&gt; Position p
</span><a href="GHC.Tc.Types.Origin.html#Argument"><span class="hs-identifier hs-var">Argument</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Position (FlipPolarity 'Neg)
Position 'Pos
</span><a href="GHC.Tc.Types.Origin.html#Top"><span class="hs-identifier hs-var">Top</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep1TyVar"><span class="hs-identifier hs-var">runtimeRep1TyVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2042"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#openBetaTy"><span class="hs-identifier hs-var">openBetaTy</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Position (FlipPolarity 'Neg) -&gt; Position 'Neg
forall (p :: Polarity).
Int -&gt; Position (FlipPolarity p) -&gt; Position p
</span><a href="GHC.Tc.Types.Origin.html#Argument"><span class="hs-identifier hs-var">Argument</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Position (FlipPolarity 'Neg)
Position 'Pos
</span><a href="GHC.Tc.Types.Origin.html#Top"><span class="hs-identifier hs-var">Top</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep2TyVar"><span class="hs-identifier hs-var">runtimeRep2TyVar</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2043"></span><span>
</span><span id="line-2044"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2045"></span><span>
</span><span id="line-2046"></span><span class="annot"><a href="GHC.Types.Id.Make.html#coerceId"><span class="hs-identifier hs-type">coerceId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-2047"></span><span id="coerceId"><span class="annot"><span class="annottext">coerceId :: Id
</span><a href="GHC.Types.Id.Make.html#coerceId"><span class="hs-identifier hs-var hs-var">coerceId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; (Name -&gt; ConcreteTyVars) -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.Make.html#pcRepPolyId"><span class="hs-identifier hs-var">pcRepPolyId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Types.Id.Make.html#coerceName"><span class="hs-identifier hs-var">coerceName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745942"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConcreteTyVars
</span><a href="#local-6989586621682745943"><span class="hs-identifier hs-var">concs</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745944"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-2048"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2049"></span><span>    </span><span id="local-6989586621682745944"><span class="annot"><span class="annottext">info :: IdInfo
</span><a href="#local-6989586621682745944"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo -&gt; InlinePragma -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setInlinePragInfo"><span class="hs-operator hs-var">`setInlinePragInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="GHC.Types.Basic.html#alwaysInlinePragma"><span class="hs-identifier hs-var">alwaysInlinePragma</span></a></span><span>
</span><span id="line-2050"></span><span>                       </span><span class="annot"><span class="annottext">IdInfo -&gt; Unfolding -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setUnfoldingInfo"><span class="hs-operator hs-var">`setUnfoldingInfo`</span></a></span><span>  </span><span class="annot"><span class="annottext">CoreExpr -&gt; Unfolding
</span><a href="GHC.Core.Unfold.Make.html#mkCompulsoryUnfolding"><span class="hs-identifier hs-var">mkCompulsoryUnfolding</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682745945"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-2051"></span><span>                       </span><span class="annot"><span class="annottext">IdInfo -&gt; Int -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setArityInfo"><span class="hs-operator hs-var">`setArityInfo`</span></a></span><span>      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-2052"></span><span>    </span><span id="local-6989586621682745946"><span class="annot"><span class="annottext">eqRTy :: Type
</span><a href="#local-6989586621682745946"><span class="hs-identifier hs-var hs-var">eqRTy</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.html#coercibleTyCon"><span class="hs-identifier hs-var">coercibleTyCon</span></a></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745949"><span class="hs-identifier hs-var">tYPE_r</span></a></span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745950"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745951"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2053"></span><span>    </span><span id="local-6989586621682745952"><span class="annot"><span class="annottext">eqRPrimTy :: Type
</span><a href="#local-6989586621682745952"><span class="hs-identifier hs-var hs-var">eqRPrimTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.Prim.html#eqReprPrimTyCon"><span class="hs-identifier hs-var">eqReprPrimTyCon</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745949"><span class="hs-identifier hs-var">tYPE_r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745949"><span class="hs-identifier hs-var">tYPE_r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745950"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745951"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2054"></span><span>    </span><span id="local-6989586621682745942"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682745942"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkInvisForAllTys"><span class="hs-identifier hs-var">mkInvisForAllTys</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Specificity -&gt; InvisTVBinder
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745956"><span class="hs-identifier hs-var">rv</span></a></span><span> </span><span class="annot"><span class="annottext">Specificity
</span><a href="Language.Haskell.Syntax.Specificity.html#InferredSpec"><span class="hs-identifier hs-var">InferredSpec</span></a></span><span>
</span><span id="line-2055"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Specificity -&gt; InvisTVBinder
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745958"><span class="hs-identifier hs-var">av</span></a></span><span> </span><span class="annot"><span class="annottext">Specificity
</span><a href="Language.Haskell.Syntax.Specificity.html#SpecifiedSpec"><span class="hs-identifier hs-var">SpecifiedSpec</span></a></span><span>
</span><span id="line-2056"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Specificity -&gt; InvisTVBinder
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745960"><span class="hs-identifier hs-var">bv</span></a></span><span> </span><span class="annot"><span class="annottext">Specificity
</span><a href="Language.Haskell.Syntax.Specificity.html#SpecifiedSpec"><span class="hs-identifier hs-var">SpecifiedSpec</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2057"></span><span>                </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type -&gt; Type
Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkInvisFunTy"><span class="hs-identifier hs-var">mkInvisFunTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745946"><span class="hs-identifier hs-var">eqRTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2058"></span><span>                </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Type -&gt; Type
Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkVisFunTyMany"><span class="hs-identifier hs-var">mkVisFunTyMany</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745950"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745951"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-2059"></span><span>
</span><span id="line-2060"></span><span>    </span><span id="local-6989586621682745962"><span class="annot"><span class="annottext">bndrs :: [Id]
</span><a href="#local-6989586621682745962"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span id="local-6989586621682745956"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745956"><span class="hs-identifier hs-var">rv</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682745958"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745958"><span class="hs-identifier hs-var">av</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682745960"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745960"><span class="hs-identifier hs-var">bv</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type -&gt; [Type]) -&gt; [Id]
</span><a href="GHC.Builtin.Types.Prim.html#mkTemplateKiTyVar"><span class="hs-identifier hs-var">mkTemplateKiTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#runtimeRepTy"><span class="hs-identifier hs-var">runtimeRepTy</span></a></span><span>
</span><span id="line-2061"></span><span>                        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682745964"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745964"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkTYPEapp"><span class="hs-identifier hs-var">mkTYPEapp</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745964"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkTYPEapp"><span class="hs-identifier hs-var">mkTYPEapp</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745964"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2062"></span><span>
</span><span id="line-2063"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682745966"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745966"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745950"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745950"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745951"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745951"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTys"><span class="hs-identifier hs-var">mkTyVarTys</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745962"><span class="hs-identifier hs-var">bndrs</span></a></span><span>
</span><span id="line-2064"></span><span>    </span><span id="local-6989586621682745949"><span class="annot"><span class="annottext">tYPE_r :: Type
</span><a href="#local-6989586621682745949"><span class="hs-identifier hs-var hs-var">tYPE_r</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkTYPEapp"><span class="hs-identifier hs-var">mkTYPEapp</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745966"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2065"></span><span>
</span><span id="line-2066"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682745967"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745967"><span class="hs-identifier hs-var">eqR</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682745968"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745968"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682745969"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745969"><span class="hs-identifier hs-var">eq</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Id]
</span><a href="GHC.Types.Id.html#mkTemplateLocals"><span class="hs-identifier hs-var">mkTemplateLocals</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745946"><span class="hs-identifier hs-var">eqRTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745950"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745952"><span class="hs-identifier hs-var">eqRPrimTy</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2067"></span><span>    </span><span id="local-6989586621682745945"><span class="annot"><span class="annottext">rhs :: CoreExpr
</span><a href="#local-6989586621682745945"><span class="hs-identifier hs-var hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; CoreExpr -&gt; CoreExpr
forall b. [b] -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682745962"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; [Id] -&gt; [Id]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745967"><span class="hs-identifier hs-var">eqR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745968"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2068"></span><span>          </span><span class="annot"><span class="annottext">CoreExpr -&gt; Scaled Type -&gt; Type -&gt; [CoreAlt] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkWildCase"><span class="hs-identifier hs-var">mkWildCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745967"><span class="hs-identifier hs-var">eqR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Scaled Type
forall a. a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#unrestricted"><span class="hs-identifier hs-var">unrestricted</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745946"><span class="hs-identifier hs-var">eqRTy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745951"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">([CoreAlt] -&gt; CoreExpr) -&gt; [CoreAlt] -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2069"></span><span>          </span><span class="hs-special">[</span><span class="annot"><span class="annottext">AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreAlt
forall b. AltCon -&gt; [b] -&gt; Expr b -&gt; Alt b
</span><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#coercibleDataCon"><span class="hs-identifier hs-var">coercibleDataCon</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745969"><span class="hs-identifier hs-var">eq</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; Coercion -&gt; CoreExpr
forall b. Expr b -&gt; Coercion -&gt; Expr b
</span><a href="GHC.Core.html#Cast"><span class="hs-identifier hs-var">Cast</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745968"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkCoVarCo"><span class="hs-identifier hs-var">mkCoVarCo</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745969"><span class="hs-identifier hs-var">eq</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2070"></span><span>
</span><span id="line-2071"></span><span>    </span><span id="local-6989586621682745943"><span class="annot"><span class="annottext">concs :: Name -&gt; ConcreteTyVars
</span><a href="#local-6989586621682745943"><span class="hs-identifier hs-var hs-var">concs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((Type, Position 'Neg), Id)] -&gt; Name -&gt; ConcreteTyVars
</span><a href="GHC.Types.Id.Make.html#mkRepPolyIdConcreteTyVars"><span class="hs-identifier hs-var">mkRepPolyIdConcreteTyVars</span></a></span><span>
</span><span id="line-2072"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745958"><span class="hs-identifier hs-var">av</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Position (FlipPolarity 'Neg) -&gt; Position 'Neg
forall (p :: Polarity).
Int -&gt; Position (FlipPolarity p) -&gt; Position p
</span><a href="GHC.Tc.Types.Origin.html#Argument"><span class="hs-identifier hs-var">Argument</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Position (FlipPolarity 'Neg)
Position 'Pos
</span><a href="GHC.Tc.Types.Origin.html#Top"><span class="hs-identifier hs-var">Top</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745956"><span class="hs-identifier hs-var">rv</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2073"></span><span>
</span><span id="line-2074"></span><span class="hs-comment">{-
Note [seqId magic]
~~~~~~~~~~~~~~~~~~
'GHC.Prim.seq' is special in several ways.

a) Its fixity is set in GHC.Iface.Load.ghcPrimIface

b) It has quite a bit of desugaring magic.
   See GHC.HsToCore.Utils Note [Desugaring seq] (1) and (2) and (3)

c) There is some special rule handing: Note [User-defined RULES for seq]

Historical note:
    In GHC.Tc.Gen.Expr we used to need a special typing rule for 'seq', to handle calls
    whose second argument had an unboxed type, e.g.  x `seq` 3#

    However, with representation polymorphism we can now give seq the type
    seq :: forall (r :: RuntimeRep) a (b :: TYPE r). a -&gt; b -&gt; b
    which handles this case without special treatment in the typechecker.

Note [User-defined RULES for seq]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Roman found situations where he had
      case (f n) of _ -&gt; e
where he knew that f (which was strict in n) would terminate if n did.
Notice that the result of (f n) is discarded. So it makes sense to
transform to
      case n of _ -&gt; e

Rather than attempt some general analysis to support this, I've added
enough support that you can do this using a rewrite rule:

  RULE &quot;f/seq&quot; forall n.  seq (f n) = seq n

You write that rule.  When GHC sees a case expression that discards
its result, it mentally transforms it to a call to 'seq' and looks for
a RULE.  (This is done in GHC.Core.Opt.Simplify.trySeqRules.)  As usual, the
correctness of the rule is up to you.

VERY IMPORTANT: to make this work, we give the RULE an arity of 1, not 2.
If we wrote
  RULE &quot;f/seq&quot; forall n e.  seq (f n) e = seq n e
with rule arity 2, then two bad things would happen:

  - The magical desugaring done in Note [seqId magic] item (b)
    for saturated application of 'seq' would turn the LHS into
    a case expression!

  - The code in GHC.Core.Opt.Simplify.rebuildCase would need to actually supply
    the value argument, which turns out to be awkward.

See also: Note [User-defined RULES for seq] in GHC.Core.Opt.Simplify.


Note [lazyId magic]
~~~~~~~~~~~~~~~~~~~
lazy :: forall a. a -&gt; a

'lazy' is used to make sure that a sub-expression, and its free variables,
are truly used call-by-need, with no code motion.  Key examples:

* pseq:    pseq a b = a `seq` lazy b
  We want to make sure that the free vars of 'b' are not evaluated
  before 'a', even though the expression is plainly strict in 'b'.

* catch:   catch a b = catch# (lazy a) b
  Again, it's clear that 'a' will be evaluated strictly (and indeed
  applied to a state token) but we want to make sure that any exceptions
  arising from the evaluation of 'a' are caught by the catch (see
  #11555).

Implementing 'lazy' is a bit tricky:

* It must not have a strictness signature: by being a built-in Id,
  all the info about lazyId comes from here, not from GHC.Magic.hi.
  This is important, because the strictness analyser will spot it as
  strict!

* It must not have an unfolding: it gets &quot;inlined&quot; by a HACK in
  CorePrep. It's very important to do this inlining *after* unfoldings
  are exposed in the interface file.  Otherwise, the unfolding for
  (say) pseq in the interface file will not mention 'lazy', so if we
  inline 'pseq' we'll totally miss the very thing that 'lazy' was
  there for in the first place. See #3259 for a real world
  example.

* Suppose CorePrep sees (catch# (lazy e) b).  At all costs we must
  avoid using call by value here:
     case e of r -&gt; catch# r b
  Avoiding that is the whole point of 'lazy'.  So in CorePrep (which
  generate the 'case' expression for a call-by-value call) we must
  spot the 'lazy' on the arg (in CorePrep.cpeApp), and build a 'let'
  instead.

* lazyId is defined in GHC.Base, so we don't *have* to inline it.  If it
  appears un-applied, we'll end up just calling it.

Note [noinlineId magic]
~~~~~~~~~~~~~~~~~~~~~~~
'noinline' is used to make sure that a function f is never inlined,
e.g., as in 'noinline f x'.  We won't inline f because we never inline
lone variables (see Note [Lone variables] in GHC.Core.Unfold

You might think that we could implement noinline like this:
   {-# NOINLINE #-}
   noinline :: forall a. a -&gt; a
   noinline x = x

But actually we give 'noinline' a wired-in name for three distinct reasons:

1. We don't want to leave a (useless) call to noinline in the final program,
   to be executed at runtime. So we have a little bit of magic to
   optimize away 'noinline' after we are done running the simplifier.
   This is done in GHC.CoreToStg.Prep.cpeApp.

2. 'noinline' sometimes gets inserted automatically when we serialize an
   expression to the interface format, in GHC.CoreToIface.toIfaceVar.
   See Note [Inlining and hs-boot files] in GHC.CoreToIface

3. Given foo :: Eq a =&gt; [a] -&gt; Bool, the expression
     noinline foo x xs
   where x::Int, will naturally desugar to
      noinline @Int (foo @Int dEqInt) x xs
   But now it's entirely possible that (foo @Int dEqInt) will inline foo,
   since 'foo' is no longer a lone variable -- see #18995

   Solution: in the desugarer, rewrite
      noinline (f x y)  ==&gt;  noinline f x y
   This is done in GHC.HsToCore.Utils.mkCoreAppDs.
   This is only needed for noinlineId, not noInlineConstraintId (wrinkle
   (W1) below), because the latter never shows up in user code.

Wrinkles

(W1) Sometimes case (2) above needs to apply `noinline` to a type of kind
     Constraint; e.g.
                    noinline @(Eq Int) $dfEqInt
     We don't have type-or-kind polymorphism, so we simply have two `inline`
     Ids, namely `noinlineId` and `noinlineConstraintId`.

(W2) Note that noinline as currently implemented can hide some simplifications
     since it hides strictness from the demand analyser. Specifically, the
     demand analyser will treat 'noinline f x' as lazy in 'x', even if the
     demand signature of 'f' specifies that it is strict in its argument. We
     considered fixing this this by adding a special case to the demand
     analyser to address #16588. However, the special case seemed like a large
     and expensive hammer to address a rare case and consequently we rather
     opted to use a more minimal solution.

Note [nospecId magic]
~~~~~~~~~~~~~~~~~~~~~
The 'nospec' magic Id is used to ensure to make a value opaque to the typeclass
specialiser. In CorePrep, we inline 'nospec', turning (nospec e) into e.
Note that this happens *after* unfoldings are exposed in the interface file.
This is crucial: otherwise, we could import an unfolding in which
'nospec' has been inlined (= erased), and we would lose the benefit.

'nospec' is used:

* In the implementation of 'withDict': we insert 'nospec' so that the
  typeclass specialiser doesn't assume any two evidence terms of the
  same type are equal. See Note [withDict] in GHC.Tc.Instance.Class,
  and see test case T21575b for an example.

* To defeat the specialiser when we have incoherent instances.
  See Note [Coherence and specialisation: overview] in GHC.Core.InstEnv.

Note [seq# magic]
~~~~~~~~~~~~~~~~~
The purpose of the magic Id (See Note [magicIds])

  seq# :: forall a s . a -&gt; State# s -&gt; (# State# s, a #)

is to elevate evaluation of its argument `a` into an observable side effect.
This implies that GHC's optimisations must preserve the evaluation &quot;exactly
here&quot;, in the state thread.

The main use of seq# is to implement `evaluate`

   evaluate :: a -&gt; IO a
   evaluate a = IO $ \s -&gt; seq# a s

Its (NOINLINE) definition in GHC.Magic is simply

   seq# a s = let !a' = lazy a in (# s, a' #)

Things to note

(SEQ1)
  It must be NOINLINE, because otherwise the eval !a' would be decoupled from
  the state token s, and GHC's optimisations, in particular strictness analysis,
  would happily move the eval around.

  However, we *do* inline saturated applications of seq# in CorePrep, where
  evaluation order is fixed; see the implementation notes below.
  This is one reason why we need seq# to be known-key.

(SEQ2)
  The use of `lazy` ensures that strictness analysis does not see the eval
  that takes place, so the final demand signature is &lt;L&gt;&lt;L&gt;, not &lt;1L&gt;&lt;L&gt;.
  This is important for a definition like

    foo x y = evaluate y &gt;&gt; evaluate x

  Although both y and x are ultimately evaluated, the user made it clear
  they want to evaluate y *before* x.
  But if strictness analysis sees the evals, it infers foo as strict in
  both parameters. This strictness would be exploited in the backend by
  picking a call-by-value calling convention for foo, one that would evaluate
  x *before* y. Nononono!

  Because the definition of seq# uses `lazy`, it must live in a different module
  (GHC.Internal.IO); otherwise strictness analysis uses its own strictness
  signature for the definition of `lazy` instead of the one we wire in.

(SEQ3)
  Why does seq# return the value? Consider
     let x = e in
     case seq# x s of (# _, x' #) -&gt; ... x' ... case x' of __DEFAULT -&gt; ...
  Here, we could simply use x instead of x', but doing so would
  introduce an unnecessary indirection and tag check at runtime;
  also we can attach an evaldUnfolding to x' to discard any
  subsequent evals such as the `case x' of __DEFAULT`.

(SEQ4)
  T15226 demonstrates that we want to discard ok-for-discard seq#s. That is,
  simplify `case seq# &lt;ok-to-discard&gt; s of (# s', _ #) -&gt; rhs[s']` to `rhs[s]`.
  You might wonder whether the Simplifier could do this. But see the excellent
  example in #24334 (immortalised as test T24334) for why it should be done in
  CorePrep.

Implementing seq#.  The compiler has magic for `seq#` in

- GHC.CoreToStg.Prep.cpeRhsE: Implement (SEQ4).

- Simplify.addEvals records evaluated-ness for the result (cf. (SEQ3)); see
  Note [Adding evaluatedness info to pattern-bound variables]
  in GHC.Core.Opt.Simplify.Iteration

- GHC.Core.Opt.DmdAnal.exprMayThrowPreciseException:
  Historically, seq# used to be a primop, and the majority of primops
  should return False in exprMayThrowPreciseException, so we do the same
  for seq# for back compat.

- GHC.CoreToStg.Prep: Inline saturated applications to a Case, e.g.,

    seq# (f 13) s
    ==&gt;
    case f 13 of sat of __DEFAULT -&gt; (# s, sat #)

  This is implemented in `cpeApp`, not unlike Note [runRW magic].
  We are only inlining seq#, leaving opportunities for case-of-known-con
  behind that are easily picked up by Unarise:

    case seq# f 13 s of (# s', r #) -&gt; rhs
    ==&gt; {Prep}
    case f 13 of sat of __DEFAULT -&gt; case (# s, sat #) of (# s', r #) -&gt; rhs
    ==&gt; {Unarise}
    case f 13 of sat of __DEFAULT -&gt; rhs[s/s',sat/r]

  Note that CorePrep really allocates a CaseBound FloatingBind for `f 13`.
  That's OK, because the telescope of Floats always stays in the same order
  and won't be floated out of binders, so all guarantees of evaluation order
  provided by seq# are upheld.

Note [oneShot magic]
~~~~~~~~~~~~~~~~~~~~
In the context of making left-folds fuse somewhat okish (see ticket #7994
and Note [Left folds via right fold]) it was determined that it would be useful
if library authors could explicitly tell the compiler that a certain lambda is
called at most once. The oneShot function allows that.

'oneShot' is representation-polymorphic, i.e. the type variables can refer
to unlifted types as well (#10744); e.g.
   oneShot (\x:Int# -&gt; x +# 1#)

Like most magic functions it has a compulsory unfolding, so there is no need
for a real definition somewhere. We have one in GHC.Magic for the convenience
of putting the documentation there.

It uses `setOneShotLambda` on the lambda's binder. That is the whole magic:

A typical call looks like
     oneShot (\y. e)
after unfolding the definition `oneShot = \f \x[oneshot]. f x` we get
     (\f \x[oneshot]. f x) (\y. e)
 --&gt; \x[oneshot]. ((\y.e) x)
 --&gt; \x[oneshot] e[x/y]
which is what we want.

Also see https://gitlab.haskell.org/ghc/ghc/wikis/one-shot.

Wrinkles:
(OS1)  It is only effective if the one-shot info survives as long as possible; in
       particular it must make it into the interface in unfoldings. See Note [Preserve
       OneShotInfo] in GHC.Core.Tidy.

(OS2) (oneShot (error &quot;urk&quot;)) rewrites to
           \x[oneshot]. error &quot;urk&quot; x
      thereby hiding the `error` under a lambda, which might be surprising,
      particularly if you have `-fpedantic-bottoms` on.  See #24296.


-------------------------------------------------------------
@realWorld#@ used to be a magic literal, \tr{void#}.  If things get
nasty as-is, change it back to a literal (@Literal@).

voidArgId is a Local Id used simply as an argument in functions
where we just want an arg to avoid having a thunk of unlifted type.
E.g.
        x = \ void :: Void# -&gt; (# p, q #)

This comes up in strictness analysis

Note [evaldUnfoldings]
~~~~~~~~~~~~~~~~~~~~~~
The evaldUnfolding makes it look that some primitive value is
evaluated, which in turn makes Simplify.interestingArg return True,
which in turn makes INLINE things applied to said value likely to be
inlined.
-}</span><span>
</span><span id="line-2395"></span><span>
</span><span id="line-2396"></span><span class="annot"><a href="GHC.Types.Id.Make.html#realWorldPrimId"><span class="hs-identifier hs-type">realWorldPrimId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>   </span><span class="hs-comment">-- :: State# RealWorld</span><span>
</span><span id="line-2397"></span><span id="realWorldPrimId"><span class="annot"><span class="annottext">realWorldPrimId :: Id
</span><a href="GHC.Types.Id.Make.html#realWorldPrimId"><span class="hs-identifier hs-var hs-var">realWorldPrimId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.Make.html#pcMiscPrelId"><span class="hs-identifier hs-var">pcMiscPrelId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Types.Id.Make.html#realWorldName"><span class="hs-identifier hs-var">realWorldName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745973"><span class="hs-identifier hs-var">id_ty</span></a></span><span>
</span><span id="line-2398"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo -&gt; Unfolding -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setUnfoldingInfo"><span class="hs-operator hs-var">`setUnfoldingInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">Unfolding
</span><a href="GHC.Core.html#evaldUnfolding"><span class="hs-identifier hs-var">evaldUnfolding</span></a></span><span>    </span><span class="hs-comment">-- Note [evaldUnfoldings]</span><span>
</span><span id="line-2399"></span><span>                                  </span><span class="annot"><span class="annottext">IdInfo -&gt; OneShotInfo -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setOneShotInfo"><span class="hs-operator hs-var">`setOneShotInfo`</span></a></span><span>   </span><span class="annot"><span class="annottext">Type -&gt; OneShotInfo
</span><a href="GHC.Core.Opt.Arity.html#typeOneShot"><span class="hs-identifier hs-var">typeOneShot</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745973"><span class="hs-identifier hs-var">id_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2400"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-2401"></span><span>     </span><span id="local-6989586621682745973"><span class="annot"><span class="annottext">id_ty :: Type
</span><a href="#local-6989586621682745973"><span class="hs-identifier hs-var hs-var">id_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#realWorldStatePrimTy"><span class="hs-identifier hs-var">realWorldStatePrimTy</span></a></span><span>
</span><span id="line-2402"></span><span>
</span><span id="line-2403"></span><span class="annot"><a href="GHC.Types.Id.Make.html#voidPrimId"><span class="hs-identifier hs-type">voidPrimId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>     </span><span class="hs-comment">-- Global constant :: Void#</span><span>
</span><span id="line-2404"></span><span>                     </span><span class="hs-comment">-- The type Void# is now the same as (# #) (ticket #18441),</span><span>
</span><span id="line-2405"></span><span>                     </span><span class="hs-comment">-- this identifier just signifies the (# #) datacon</span><span>
</span><span id="line-2406"></span><span>                     </span><span class="hs-comment">-- and is kept for backwards compatibility.</span><span>
</span><span id="line-2407"></span><span>                     </span><span class="hs-comment">-- We cannot define it in normal Haskell, since it's</span><span>
</span><span id="line-2408"></span><span>                     </span><span class="hs-comment">-- a top-level unlifted value.</span><span>
</span><span id="line-2409"></span><span id="voidPrimId"><span class="annot"><span class="annottext">voidPrimId :: Id
</span><a href="GHC.Types.Id.Make.html#voidPrimId"><span class="hs-identifier hs-var hs-var">voidPrimId</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.Make.html#pcMiscPrelId"><span class="hs-identifier hs-var">pcMiscPrelId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Types.Id.Make.html#voidPrimIdName"><span class="hs-identifier hs-var">voidPrimIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#unboxedUnitTy"><span class="hs-identifier hs-var">unboxedUnitTy</span></a></span><span>
</span><span id="line-2410"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo -&gt; Unfolding -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setUnfoldingInfo"><span class="hs-operator hs-var">`setUnfoldingInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Unfolding
</span><a href="GHC.Core.Unfold.Make.html#mkCompulsoryUnfolding"><span class="hs-identifier hs-var">mkCompulsoryUnfolding</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="GHC.Types.Id.Make.html#unboxedUnitExpr"><span class="hs-identifier hs-var">unboxedUnitExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2411"></span><span>
</span><span id="line-2412"></span><span class="annot"><a href="GHC.Types.Id.Make.html#unboxedUnitExpr"><span class="hs-identifier hs-type">unboxedUnitExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-2413"></span><span id="unboxedUnitExpr"><span class="annot"><span class="annottext">unboxedUnitExpr :: CoreExpr
</span><a href="GHC.Types.Id.Make.html#unboxedUnitExpr"><span class="hs-identifier hs-var hs-var">unboxedUnitExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; Id
</span><a href="GHC.Core.DataCon.html#dataConWorkId"><span class="hs-identifier hs-var">dataConWorkId</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#unboxedUnitDataCon"><span class="hs-identifier hs-var">unboxedUnitDataCon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2414"></span><span>
</span><span id="line-2415"></span><span class="annot"><a href="GHC.Types.Id.Make.html#voidArgId"><span class="hs-identifier hs-type">voidArgId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>       </span><span class="hs-comment">-- Local lambda-bound :: Void#</span><span>
</span><span id="line-2416"></span><span id="voidArgId"><span class="annot"><span class="annottext">voidArgId :: Id
</span><a href="GHC.Types.Id.Make.html#voidArgId"><span class="hs-identifier hs-var hs-var">voidArgId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleName -&gt; Unique -&gt; Type -&gt; Type -&gt; Id
</span><a href="GHC.Types.Id.html#mkSysLocal"><span class="hs-identifier hs-var">mkSysLocal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;void&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#voidArgIdKey"><span class="hs-identifier hs-var">voidArgIdKey</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#unboxedUnitTy"><span class="hs-identifier hs-var">unboxedUnitTy</span></a></span><span>
</span><span id="line-2417"></span><span>
</span><span id="line-2418"></span><span class="annot"><a href="GHC.Types.Id.Make.html#coercionTokenId"><span class="hs-identifier hs-type">coercionTokenId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>         </span><span class="hs-comment">-- :: () ~# ()</span><span>
</span><span id="line-2419"></span><span id="coercionTokenId"><span class="annot"><span class="annottext">coercionTokenId :: Id
</span><a href="GHC.Types.Id.Make.html#coercionTokenId"><span class="hs-identifier hs-var hs-var">coercionTokenId</span></a></span></span><span> </span><span class="hs-comment">-- See Note [Coercion tokens] in &quot;GHC.CoreToStg&quot;</span><span>
</span><span id="line-2420"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.Make.html#pcMiscPrelId"><span class="hs-identifier hs-var">pcMiscPrelId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Types.Id.Make.html#coercionTokenName"><span class="hs-identifier hs-var">coercionTokenName</span></a></span><span>
</span><span id="line-2421"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.Prim.html#eqPrimTyCon"><span class="hs-identifier hs-var">eqPrimTyCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#unitTy"><span class="hs-identifier hs-var">unitTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#unitTy"><span class="hs-identifier hs-var">unitTy</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2422"></span><span>                 </span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#noCafIdInfo"><span class="hs-identifier hs-var">noCafIdInfo</span></a></span><span>
</span><span id="line-2423"></span><span>
</span><span id="line-2424"></span><span class="annot"><a href="GHC.Types.Id.Make.html#pcMiscPrelId"><span class="hs-identifier hs-type">pcMiscPrelId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Id.Info.html#IdInfo"><span class="hs-identifier hs-type">IdInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-2425"></span><span id="pcMiscPrelId"><span class="annot"><span class="annottext">pcMiscPrelId :: Name -&gt; Type -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.Make.html#pcMiscPrelId"><span class="hs-identifier hs-var hs-var">pcMiscPrelId</span></a></span></span><span> </span><span id="local-6989586621682745982"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745982"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682745983"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745983"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682745984"><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745984"><span class="hs-identifier hs-var">info</span></a></span></span><span>
</span><span id="line-2426"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Name -&gt; Type -&gt; IdInfo -&gt; Id
Name -&gt; Type -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.html#mkVanillaGlobalWithInfo"><span class="hs-identifier hs-var">mkVanillaGlobalWithInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745982"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745983"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745984"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-2427"></span><span>
</span><span id="line-2428"></span><span class="annot"><a href="GHC.Types.Id.Make.html#pcRepPolyId"><span class="hs-identifier hs-type">pcRepPolyId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTyVars"><span class="hs-identifier hs-type">ConcreteTyVars</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Id.Info.html#IdInfo"><span class="hs-identifier hs-type">IdInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-2429"></span><span id="pcRepPolyId"><span class="annot"><span class="annottext">pcRepPolyId :: Name -&gt; Type -&gt; (Name -&gt; ConcreteTyVars) -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.Make.html#pcRepPolyId"><span class="hs-identifier hs-var hs-var">pcRepPolyId</span></a></span></span><span> </span><span id="local-6989586621682745986"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745986"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682745987"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745987"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682745988"><span class="annot"><span class="annottext">Name -&gt; ConcreteTyVars
</span><a href="#local-6989586621682745988"><span class="hs-identifier hs-var">conc_tvs</span></a></span></span><span> </span><span id="local-6989586621682745989"><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745989"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2430"></span><span>  </span><span class="annot"><span class="annottext">IdDetails -&gt; Name -&gt; Type -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.html#mkGlobalId"><span class="hs-identifier hs-var">mkGlobalId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConcreteTyVars -&gt; IdDetails
</span><a href="GHC.Types.Id.Info.html#RepPolyId"><span class="hs-identifier hs-var">RepPolyId</span></a></span><span> </span><span class="annot"><span class="annottext">(ConcreteTyVars -&gt; IdDetails) -&gt; ConcreteTyVars -&gt; IdDetails
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConcreteTyVars
</span><a href="#local-6989586621682745988"><span class="hs-identifier hs-var">conc_tvs</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745986"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745986"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745987"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="#local-6989586621682745989"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-2431"></span><span>
</span><span id="line-2432"></span><span class="hs-comment">-- | Directly specify which outer forall'd type variables of a</span><span>
</span><span id="line-2433"></span><span class="hs-comment">-- representation-polymorphic 'Id' such become concrete metavariables when</span><span>
</span><span id="line-2434"></span><span class="hs-comment">-- instantiated.</span><span>
</span><span id="line-2435"></span><span class="annot"><a href="GHC.Types.Id.Make.html#mkRepPolyIdConcreteTyVars"><span class="hs-identifier hs-type">mkRepPolyIdConcreteTyVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2436"></span><span>                               </span><span class="hs-comment">-- ^ ((ty, pos), tv)</span><span>
</span><span id="line-2437"></span><span>                               </span><span class="hs-comment">-- 'ty' is the type on which the representation-polymorphism</span><span>
</span><span id="line-2438"></span><span>                               </span><span class="hs-comment">-- check is done</span><span>
</span><span id="line-2439"></span><span>                               </span><span class="hs-comment">-- 'tv' is the type variable we are checking for concreteness</span><span>
</span><span id="line-2440"></span><span>                               </span><span class="hs-comment">-- (usually the kind of 'ty')</span><span>
</span><span id="line-2441"></span><span>                               </span><span class="hs-comment">-- 'pos' is the position of 'ty' in the</span><span>
</span><span id="line-2442"></span><span>                               </span><span class="hs-comment">-- type of the 'Id'</span><span>
</span><span id="line-2443"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ 'Name' of the rep-poly 'Id'</span></span><span>
</span><span id="line-2444"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTyVars"><span class="hs-identifier hs-type">ConcreteTyVars</span></a></span><span>
</span><span id="line-2445"></span><span id="mkRepPolyIdConcreteTyVars"><span class="annot"><span class="annottext">mkRepPolyIdConcreteTyVars :: [((Type, Position 'Neg), Id)] -&gt; Name -&gt; ConcreteTyVars
</span><a href="GHC.Types.Id.Make.html#mkRepPolyIdConcreteTyVars"><span class="hs-identifier hs-var hs-var">mkRepPolyIdConcreteTyVars</span></a></span></span><span> </span><span id="local-6989586621682745991"><span class="annot"><span class="annottext">[((Type, Position 'Neg), Id)]
</span><a href="#local-6989586621682745991"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621682745992"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745992"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2446"></span><span>  </span><span class="annot"><span class="annottext">[(Name, ConcreteTvOrigin)] -&gt; ConcreteTyVars
forall a. [(Name, a)] -&gt; NameEnv a
</span><a href="GHC.Types.Name.Env.html#mkNameEnv"><span class="hs-identifier hs-var">mkNameEnv</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Name
</span><a href="GHC.Types.Var.html#tyVarName"><span class="hs-identifier hs-var">tyVarName</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745994"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Position 'Neg -&gt; ConcreteTvOrigin
</span><a href="#local-6989586621682745995"><span class="hs-identifier hs-var">mk_conc_frr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745996"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Position 'Neg
</span><a href="#local-6989586621682745997"><span class="hs-identifier hs-var">pos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2447"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682745996"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745996"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682745997"><span class="annot"><span class="annottext">Position 'Neg
</span><a href="#local-6989586621682745997"><span class="hs-identifier hs-var">pos</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621682745994"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682745994"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[((Type, Position 'Neg), Id)]
</span><a href="#local-6989586621682745991"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2448"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2449"></span><span>    </span><span id="local-6989586621682745995"><span class="annot"><span class="annottext">mk_conc_frr :: Type -&gt; Position 'Neg -&gt; ConcreteTvOrigin
</span><a href="#local-6989586621682745995"><span class="hs-identifier hs-var hs-var">mk_conc_frr</span></a></span></span><span> </span><span id="local-6989586621682745998"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745998"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682745999"><span class="annot"><span class="annottext">Position 'Neg
</span><a href="#local-6989586621682745999"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2450"></span><span>      </span><span class="annot"><span class="annottext">FixedRuntimeRepOrigin -&gt; ConcreteTvOrigin
</span><a href="GHC.Tc.Utils.TcType.html#ConcreteFRR"><span class="hs-identifier hs-var">ConcreteFRR</span></a></span><span> </span><span class="annot"><span class="annottext">(FixedRuntimeRepOrigin -&gt; ConcreteTvOrigin)
-&gt; FixedRuntimeRepOrigin -&gt; ConcreteTvOrigin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FixedRuntimeRepContext -&gt; FixedRuntimeRepOrigin
</span><a href="GHC.Tc.Types.Origin.html#FixedRuntimeRepOrigin"><span class="hs-identifier hs-var">FixedRuntimeRepOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682745998"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2451"></span><span>                  </span><span class="annot"><span class="annottext">(FixedRuntimeRepContext -&gt; FixedRuntimeRepOrigin)
-&gt; FixedRuntimeRepContext -&gt; FixedRuntimeRepOrigin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; RepPolyId -&gt; Position 'Neg -&gt; FixedRuntimeRepContext
</span><a href="GHC.Tc.Types.Origin.html#FRRRepPolyId"><span class="hs-identifier hs-var">FRRRepPolyId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682745992"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">RepPolyId
</span><a href="GHC.Tc.Types.Origin.html#RepPolyFunction"><span class="hs-identifier hs-var">RepPolyFunction</span></a></span><span> </span><span class="annot"><span class="annottext">Position 'Neg
</span><a href="#local-6989586621682745999"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-2452"></span></pre></body></html>